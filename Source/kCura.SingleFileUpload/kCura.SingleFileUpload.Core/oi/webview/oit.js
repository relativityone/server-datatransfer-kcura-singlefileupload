/*
 oit.js 
 Portions (C) 1991, 2016, Oracle Corp, and (C) 2017, Relativity ODA LLC. 
 Version 2018.4.0.389 
*/
(function(K,X){var Rb,Sb;if(K.OIT){var la=K.OIT.view;la&&(la.detach?la.detach():la.unload&&la.unload())}K.OIT=function(){var b={};Object.defineProperties(b,{uninstall:{value:function(){ic&&ic(this)},writable:!0}});return b}();var V=function(b,e){e||(e=Oc);return b.prototype=Object.create(e.prototype)},ic=function(){if(K.OIT){var b=K.OIT.view;b&&b.detach();K.OIT=void 0}},ob=function(b,e,a){Object.defineProperty(OIT,b,{value:e,writable:!!a})},y=function(){var b=/^[.#\w][-_\.\w\d]*$/,e=("oit"+Math.random()).replace(/\W/g,
""),a=[],d=1,c=function(a){if(b.test(a)){if(0===a.lastIndexOf("#",0))return c.byId(a.slice(1));if(0===a.lastIndexOf(".",0))return c.byClass(a.slice(1));if(0===a.indexOf(" "))return c.byTagName(a)}return c.bySelector(a)};Object.defineProperties(c,{html:{get:function(){return c.wrap(X.documentElement)}},body:{get:function(){return c.wrap(X.body)}},head:{get:function(){return c.wrap(c.html.childByTagName("head"))}},expando:{value:e}});c.byId=function(a){return c.wrap(X.getElementById(a))};c.byClass=
function(a){return c.wrap(X.getElementsByClassName(a))};c.byTagName=function(a){return c.wrap(X.getElementsByTagName(a))};c.bySelector=function(a){return c.wrap(X.querySelectorAll(a))};c.attach=function(a){(a=c.wrap(a))&&a.data("_elem",a);return a};c.detach=function(a){a&&c.removeData(a,"_elem")};c.query=function(a){return c.data(a,"_elem")};c.isElement=function(c){return c&&(c.dom||1===c.nodeType)};c.isText=function(c){return c&&3===c.nodeType};c.isDescendantOf=function(a,d){a=c.unwrap(a);if(d=c.unwrap(d))for(;a&&
a.parentNode;){if(a.parentNode===d)return!0;a=a.parentNode}return!1};c.nodeIndex=function(a){a=c.unwrap(a);for(var d=0;;){a=a.previousSibling;if(!a)break;++d}return d};c.unwrap=function(c){c&&c.dom&&(c=c.dom);return c};c.wrap=function(a){if(a){var d;if(!c.isElement(a)&&0<=a.length&&("function"===typeof a.item?d=[]:Array.isArray(a)&&(d=a),d)){for(var b=0;b<a.length;b++)d[b]=c.wrap(a[b]);0===d.length&&(d=null);return d}if(a.tagName&&!a.dom)return(d=c.query(a))||(d=new S(a)),d}return a};c.acceptsData=
function(a){return a&&(1===a.nodeType||9===a.nodeType)};c.data=function(b,f,k){b=c.unwrap(b);if(c.acceptsData(b)&&f){var n=b[e];if(void 0!==k){if(!n){do n=d++;while(void 0!==a[n]);Object.defineProperty(b,e,{value:n})}a[n]||(a[n]={});a[n].domNode=c.nodeToString(b);return a[n][f]=k}var l;n&&(k=a[n])&&(l=k[f]);void 0===l&&b.getAttribute&&(l=b.getAttribute("data-"+f),null===l&&(l=void 0));return l}};c.destroyData=function(b){b=c.unwrap(b);c.acceptsData(b)&&(b=b[e])&&(a[b]=void 0,b<d&&(d=b))};c.removeData=
function(d,b){d=c.unwrap(d);if(c.acceptsData(d)){var f=d[e];if(f)if(b){if(f=a[f]){delete f[b];var n;a:{for(n in f)if(Object.prototype.hasOwnProperty.call(f,n)){n=!0;break a}n=!1}n||c.removeData(d)}}else a[f]=void 0}d&&d.removeAttribute&&d.removeAttribute("data-"+b)};c.removeSubtreeData=function(a){c.removeData(a);for(a=a.firstElementChild;a;a=a.nextElementSibling)c.removeSubtreeData(a)};c.reset=function(){var b,e;for(e in a){var f=a[e];f&&(c.logUnreleasedData&&c.logUnreleasedData(f),b||(b=[]),b[e]=
f)}b?a=b:(a=[],d=1)};c.hasClass=function(a,d){if(Array.isArray(d)){for(var b=0;b<d.length;b++)if(c.hasClass(a,d[b]))return!0;return!1}if(a=c.unwrap(a)){if(a.classList)return a.classList.contains(d);if(a.getAttribute&&(b=a.getAttribute("class")))return b=" "+b+" ",d=" "+d.trim()+" ",-1!=b.indexOf(d)}return!1};var f=function(a,d){if(a.classList)a.classList.add(d);else if(a.getAttribute&&!c.hasClass(a,d)){var b=a.getAttribute("class");a.setAttribute("class",b+(" "+d))}};c.addClass=function(a,d){if((a=
c.unwrap(a))&&d){var b;if(Array.isArray(d))for(b=0;b<d.length;b++)f(a,d[b]);else if(-1!=d.indexOf(" "))for(d=d.split(" "),b=0;b<d.length;b++)f(a,d[b]);else f(a,d)}};var k=function(a,c){if(a.classList)a.classList.remove(c);else if(a.getAttribute){var d=a.getAttribute("class").replace(c,"");a.setAttribute("class",d)}};c.removeClass=function(a,d){if((a=c.unwrap(a))&&d){var b;if(Array.isArray(d))for(b=0;b<d.length;b++)k(a,d[b]);else if(-1!=d.indexOf(" "))for(d=d.split(" "),b=0;b<d.length;b++)k(a,d[b]);
else k(a,d)}};c.create=function(a,c,d,b){return new S(a,c,d,b)};c.createText=function(a){return X.createTextNode(a)};c.listen=function(){return X.addEventListener.apply(X,arguments)};c.unlisten=function(){return X.removeEventListener.apply(X,arguments)};c.cursor=function(a){void 0!==a&&(X.body.style.cursor=a);return X.body.style.cursor};c.clearSelection=function(){K.focus();if(K.getSelection){var a=K.getSelection();null!==a&&a.removeAllRanges()}};c.selectRange=function(a,c,d,b){K.focus();if(K.getSelection){var e;
Qa(a)?e=a:(e=X.createRange(),e.setStart(a,c),e.setEnd(d,b));a=K.getSelection();a.removeAllRanges();a.addRange(e)}};c.selectedText=function(){var a;if(K.getSelection){var c=K.getSelection();c&&(a=c.toString())}else X.selection&&"Control"!=X.selection.type&&(a=X.selection.createRange().text);a||(a="");return a};c.nodeToString=function(a){if((a=c.unwrap(a))&&1===a.nodeType){var d=[];d.push("<",a.tagName.toLowerCase());if(a.classList)for(var b=0;b<a.classList.length;b++)d.push(".",a.classList[b]);a.id&&
d.push("#",a.id);d.push(">");return d.join("")}};return c}(),Oc=function(){var b=function(){},e=b.prototype;e.prop=function(a,d,c,b){"string"===typeof a&&void 0!==d&&Object.defineProperty(this,a,{value:d,writable:!!c})};e.deleteAll=function(){for(var a in this)this.hasOwnProperty(a)&&delete this[a]};e.invalidArg=function(a,d,c,b){var e="",e=d?e+("Invalid value specified for argument '"+d+"'"):e+"Invalid argument";c&&(e+=": '"+Hb(c)+"'");b&&(e+=", "+b);this.logError(a,e)};e.logError=function(a,d){var c;
this.publicName&&a&&(c=this.publicName+"."+a+": ");d&&(c=(c?c+": ":"")+String(d));c&&0<c.length&&E.on.error.dispatch(c,!1)&&console.error(c)};e.logFatalError=function(a,d,c,b){var e;this.publicName&&a&&(e=this.publicName+"."+a+": ");d&&(e=(e?e+": ":"")+String(d));c&&(e=(e?e+" ":"")+String(c));e&&0<e.length&&E.on.error.dispatch(e,!0)&&("warn"!==b&&(b="error"),console[b](e),la.unload(),la.showDocumentError(d))};e.logAJAXError=function(a,d,c,b,e){b===jc?d+=" (Request aborted)":b===Tb?d+=" (Request timed out)":
void 0!==b&&(d=d+" (HTTP Status "+b+")");b=[];c&&b.push(" [",c,"]");void 0!==e&&b.push(" responseText='",e,"'");this.logFatalError(a,d,b.join(""))};return b}(),S=function(){var b=[];b[0]=b[23]="right";b[5]=b[6]="up";b[11]=b[12]="left";b[17]=b[18]="down";for(var e=function(a){void 0===a&&(a="div");if("string"==typeof a){var c=this.dom=X.createElement(a),b=1;if(b<arguments.length){var d;"string"==typeof arguments[b]?d=arguments[b++]:Array.isArray(arguments[b])&&(d=arguments[b++].join(" "));d&&d.length&&
c.setAttribute("class",d)}b<arguments.length&&"string"==typeof arguments[b]&&(c.id=arguments[b++]);b<arguments.length&&(c=y.wrap(arguments[b++]))&&y.isElement(c)&&c.append(this)}else y.isElement(a)&&(this.dom=y.unwrap(a))},a=V(e),d="clientLeft clientTop clientWidth clientHeight offsetWidth offsetHeight scrollWidth scrollHeight parentNode tagName classList".split(" "),c=function(c){Object.defineProperty(a,c,{get:function(){return this.dom[c]}})},f=0;f<d.length;f++)c(d[f]);Object.defineProperties(a,
{id:{get:function(){return this.dom.id},set:function(a){this.dom.id=a}},opacity:{get:function(){return Number(this.computedStyleProp("opacity"))},set:function(a){this.dom.style.opacity=a}},offsetLeft:{get:function(){return this.dom.offsetLeft},set:function(a){this.dom.style.left=M(a)+"px"}},offsetTop:{get:function(){return this.dom.offsetTop},set:function(a){this.dom.style.top=M(a)+"px"}},scrollLeft:{get:function(){return this.dom.scrollLeft},set:function(a){this.dom.scrollLeft=M(a)}},scrollTop:{get:function(){return this.dom.scrollTop},
set:function(a){this.dom.scrollTop=M(a)}},innerWidth:{get:function(){var a=this.computedStyleProp("width");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientWidth},set:function(a){this.dom.style.width=M(a)+"px"}},innerHeight:{get:function(){var a=this.computedStyleProp("height");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientHeight},set:function(a){this.dom.style.height=M(a)+"px"}},outerWidth:{get:function(){var a=this.dom.offsetWidth,c=K.getComputedStyle(this.dom);c.marginLeft&&c.marginRight&&
(a+=parseFloat(c.marginLeft)+parseFloat(c.marginRight));return a}},outerHeight:{get:function(){var a=this.dom.offsetHeight,c=K.getComputedStyle(this.dom);c.marginTop&&c.marginBottom&&(a+=parseFloat(c.marginTop)+parseFloat(c.marginBottom));return a}}});a.focus=function(){this.dom.focus()};a.blur=function(){this.dom.blur()};a.toString=function(){return y.nodeToString(this)};a.parent=function(){if(this.dom)return y.wrap(this.dom.parentNode)};a.firstChildElem=function(){if(this.dom)return y.wrap(this.dom.firstElementChild)};
a.nextSiblingElem=function(){if(this.dom)return y.wrap(this.dom.nextElementSibling)};a.detach=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom)}};a.destroy=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom);this.destroyChildren();y.destroyData(this.dom);this.deleteAll()}};var k=function(a){for(var c=a.firstElementChild;c;c=a){a=c.nextElementSibling;k(c);var b=y.query(c);b?b.destroy():y.removeData(c)}};a.destroyChildren=function(){k(this.dom)};a.equals=
function(a){return this.dom==y.unwrap(a)};a.html=function(a){void 0!==a&&(this.destroyChildren(),this.dom.innerHTML=a);return this.dom.innerHTML};a.text=function(a){void 0!==a&&(this.destroyChildren(),this.dom.textContent=a);return this.dom.textContent};a.data=function(a,c){return y.data(this.dom,a,c)};a.ancestorData=function(a){for(var c,b=this.dom,d=y.unwrap(v.rootNode);b;){c=y.data(b,a);if(void 0!==c)break;if(b==d)break;b=b.parentNode}return c};a.removeData=function(a){y.removeData(this.dom,a)};
a.hasClass=function(a){return y.hasClass(this.dom,a)};a.addClass=function(a){y.addClass(this.dom,a);return this};a.removeClass=function(a){y.removeClass(this.dom,a);return this};a.attr=function(a,c){var b;if(Array.isArray(a)){for(var d={},e=0;e<a.length;e++)b=a[e],d[b]=this.dom.getAttribute(b);return d}if(void 0===c){if("string"===typeof a)return this.dom.getAttribute(a);for(b in a)a.hasOwnProperty(b)&&this.dom.setAttribute(b,a[b])}else null===c?this.dom.removeAttribute(a):this.dom.setAttribute(a,
c);return this};a.css=function(a,c){var b=this.dom;if(b){var b=b.style,d;try{if(Array.isArray(a)){for(var e={},ba=0;ba<a.length;ba++)d=a[ba],e[d]=b.getPropertyValue($a[d]||d);return e}if(void 0===c)if("string"===typeof a){if(-1==a.indexOf(":"))return b.getPropertyValue($a[a]||a);(e=ib(a))&&this.css(e)}else for(d in a)a.hasOwnProperty(d)&&(ba=a[d],null===ba||void 0===ba?b.removeProperty($a[d]||d):b.setProperty($a[d]||d,ba,""));else null===c?b.removeProperty($a[a]||a):b.setProperty($a[a]||a,c,"")}catch(Ra){}}return this};
a.removeCSS=function(a){var c=this.dom;if(Array.isArray(a))for(var b=0;b<a.length;b++)c.style.removeProperty(a[b]);else if("string"===typeof a)c.style.removeProperty(a);else for(b in a)a.hasOwnProperty(b)&&c.style.removeProperty(b);return this};a.resetStyle=function(){return this.attr("style",null)};a.computedStyle=function(){return K.getComputedStyle(this.dom)};a.computedStyleProp=function(a){return this.computedStyle().getPropertyValue(a)};a.show=function(){this._hidden&&(this.css("display",null),
delete this._hidden);return this};a.hide=function(){this._hidden||(this.css("display","none"),this._hidden=!0);return this};a.isHidden=function(){return this._hidden};a.autoscroll=function(a,c){var b=this.dom;switch(arguments.length){case 0:return{left:b.scrollLeft,top:b.scrollTop};case 1:return this.autoscroll(a.left,a.top);case 2:void 0!==a&&(b.scrollLeft=a),void 0!==c&&(b.scrollTop=c)}return this};a.scroll=function(a,c){void 0===a&&void 0===c||this.cancelKinetic();return this.autoscroll.apply(this,
arguments)};a.dscroll=function(a,c){this.cancelKinetic();a&&(this.scrollLeft+=a);c&&(this.scrollTop+=c);return this};a.animate=function(a){a&&(this.finishAnimation(),this.dom&&new Pc(this,a));return this};a.finishAnimation=function(){var a=this.data("_animation");a&&a.finish();return this};a.abortAnimation=function(){var a=this.data("_animation");a&&a.abort();return this};a.append=function(){if(this.dom)for(var a=arguments,c=0;c<a.length;c++){var b=a[c];Array.isArray(b)?this.append.apply(this,b):
this.dom.appendChild(y.unwrap(b))}return this};a.insert=function(a,c){this.dom&&this.dom.insertBefore(y.unwrap(a),y.unwrap(c));return this};a.insertAfter=function(a,c){this.dom&&(a=y.unwrap(a),c=y.unwrap(c),c=c.nextSibling,this.dom.insertBefore(a,c));return this};a.insertFirst=function(a){this.dom&&this.dom.insertBefore(y.unwrap(a),this.dom.firstChild);return this};a.remove=function(a){this.dom&&this.dom.removeChild(y.unwrap(a));return this};a.clone=function(a){return this.dom?this.dom.cloneNode(!!a):
null};a.transferFrom=function(a){a=y.unwrap(a);if(this.dom&&a)for(;0<a.childNodes.length;)this.dom.appendChild(a.childNodes[0]);return this};a.forElementAndAncestors=function(a){for(var c=this,b=y.unwrap(v.rootNode);c&&!1!==a(c)&&c!=b;)c=c.parent();return this};a.forChildElements=function(a){return t.call(this,a,!1,arguments)};a.queryChildElements=function(a){return t.call(this,a,!0,arguments)};var t=function(a,c,b){for(var d=[null,-1],e=1;e<b.length;e++)d.push(b[e]);b=0;for(var q=this.dom.firstElementChild;q;q=
e,b++)if(e=q.nextElementSibling,q=!0===c?y.query(q):y.wrap(q))if(d[0]=q,d[1]=b,!1===a.apply(null,d))break;return this};a.pos=function(a){var c=this.dom;a=y.unwrap(a);if(a==c)return{left:0,top:0};for(;c&&!c.getBoundingClientRect;)c=c.parentNode;if(c)return c=c.getBoundingClientRect(),c={left:c.left,top:c.top},a&&a!==X.body&&(a=a.getBoundingClientRect(),c.left-=a.left,c.top-=a.top),c};a.size=function(){for(var a=this.dom;a&&!a.getBoundingClientRect;)a=a.parentNode;if(a)return a=a.getBoundingClientRect(),
{width:a.width,height:a.height}};a.rect=function(a){a=y.unwrap(a);for(var c=this.dom;c&&!c.getBoundingClientRect;)c=c.parentNode;if(c){var b=c.getBoundingClientRect(),b={left:b.left,top:b.top,right:b.right,bottom:b.bottom,width:b.width,height:b.height};a&&a!==X.body&&(a==c?(b.right-=b.left,b.bottom-=b.top,b.left=0,b.top=0):(a=a.getBoundingClientRect(),b.left-=a.left,b.top-=a.top,b.right-=a.left,b.bottom-=a.top));return b}};a.inRect=function(a,c){var b=this.dom;return b&&0<=a&&0<=c&&a<=b.clientWidth&&
c<=b.clientHeight};a.ancestorByClass=function(a){for(var c=this.parent(),b=v.rootNode;c&&c.hasClass;){if(c.hasClass(a))return c;if(c.equals(b))break;c=c.parent()}return null};a.childByTagName=function(a){a=a.toUpperCase();for(var c=this.dom.firstElementChild;c;c=c.nextElementSibling)if(c.tagName.toUpperCase()===a)return y.wrap(c);return null};a.childrenByTagName=function(a){var c=null;a=a.toUpperCase();for(var b=this.dom.firstElementChild;b;b=b.nextElementSibling)b.tagName.toUpperCase()===a&&(c||
(c=[]),c.push(y.wrap(b)));return c};a.childByClass=function(a){if(this)for(var c=this.firstChildElem();c;c=c.nextSiblingElem())if(c.hasClass(a))return c;return null};a.byClass=function(a){return y.wrap(this.dom.getElementsByClassName(a))};a.byId=function(a){for(var c=[y.unwrap(this.dom)];0<c.length;)for(var b=c.shift().firstElementChild;b;b=b.nextElementSibling){if(b.id===a)return y.wrap(b);c.push(b)}return null};a.byTag=function(a){a=a.toUpperCase();for(var c=[y.unwrap(this.dom)],b=[];0<c.length;)for(var d=
c.shift().firstElementChild;d;d=d.nextElementSibling)d.tagName.toUpperCase()===a?b.push(y.wrap(d)):c.push(d);if(b.length)return b};a.isDescendantOf=function(a){return y.isDescendantOf(this.dom,a)};a.mousePos=function(a){a||(a=K.event);for(var c={x:0,y:0},b=this.dom;b;b=b.offsetParent)c.x+=b.offsetLeft,c.y+=b.offsetTop;if(a.pageX||a.pageY)c.x=a.pageX-c.x,c.y=a.pageY-c.y;else if(a.clientX||a.clientY)c.x=a.clientX+X.body.scrollLeft+X.documentElement.scrollLeft-c.x,c.y=a.clientY+X.body.scrollTop+X.documentElement.scrollTop-
c.y;return c};a.touchPos=function(a){if(a){var c={identifier:a.identifier,x:0,y:0};if(a.center&&a.target){var b=y.wrap(a.target).pos(this);c.x=a.center.x+b.left;c.y=a.center.y+b.top}else{for(b=this.dom;b;b=b.offsetParent)c.x+=b.offsetLeft,c.y+=b.offsetTop;c.x=a.pageX-c.x;c.y=a.pageY-c.y}return c}};a.select=function(){K.focus();if(K.getSelection){var a=X.createRange();a.selectNodeContents(this.dom);y.selectRange(a)}else X.selection&&X.body.createTextRange&&(a=X.body.createTextRange(),a.moveToElementText(this.dom),
a.select())};var r=function(a){for(var c=!0;c;){var b=a.currentNode;if(1===b.nodeType)if("svg"===b.nodeName)c=a.skipNode();else if(b=y.data(b,"acc"),void 0!==b)if("none"===b)c=a.skipNode();else break;else break;else if(3===b.nodeType)break;else c=a.nextNode()}return c},w=function(){for(var a;!(a=this.nextSibling())&&this.parentNode(););return a},n=function(a){for(;this.currentNode!==a&&this.nextNode(););return this.currentNode===a},l=function(){return r(this)},u=function(){var a=this.nextNode();a&&
(a=r(this));return a};a.createTreeWalker=function(a,c,b){void 0===a&&(a=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);void 0===c&&(c=null);void 0===b&&(b=!1);a=X.createTreeWalker(this.dom,a,c,b);a.skipNode=w;a.skipToNode=n;a.firstACCNode=l;a.nextACCNode=u;return a};a.createCanvas=function(){return new kc(this)};a.on=function(a,c,b){void 0===b&&(b=c,c=void 0);if("function"!==typeof b)this.invalidArg("on"+a,"listener",b,"Must be a function");else{var d=Array.prototype.slice.call(arguments,2);d[0]=null;
c=c||this;var e,q=this.dom;e=a;var g=y.data(q,"_events");g||(g={},y.data(q,"_events",g));(q=g[e])||(q=g[e]=[]);e=q;for(g=0;g<e.length;g++)if(q=e[g],q.fn===b){q.ref=c;q.args=d;b=null;break}b&&(e.push({fn:b,ref:c,args:d}),1==e.length&&(d=this._events[a])&&d.add&&d.add(this,a))}return this};a.off=function(a,c,b){void 0===b&&(b=c);if("function"===typeof b&&(c=p(this.dom,a))){for(var d=0;d<c.length;d++)if(c[d].fn===b){c.splice(d,1);break}0===c.length&&(b=this._events[a])&&b.remove&&b.remove(this,a)}return this};
for(var p=function(a,c){var b=y.data(a,"_events");if(b&&(b=b[c])&&0<b.length)return b},J=function(a,c,b){a["on"+c]=function(a,b){1==arguments.length&&(b=a,a=null);if(2<arguments.length){for(var d=[c,a,b],e=2;e<arguments.length;e++)d.push(arguments[e]);return this.on.apply(this,d)}return this.on(c,a,b)};a["off"+c]=function(a,b){return this.off(c,a,b)};a._events||(a._events={});a._events[c]=b},W=function(a){var c=p(a.currentTarget,a.type);if(c){for(var b=!0,d=0;d<c.length;d++){var e=c[d];e.args[0]=
a;!1===e.fn.apply(e.ref,e.args)&&(b=!1);e.args[0]=null}b||jb(a)}},d="mouseover mouseout mouseenter mouseleave mousedown mousemove mouseup wheel touchstart touchmove touchend touchcancel click dblclick contextmenu keydown keyup keypress blur focus scroll change transitionend".split(" "),c={add:function(a,c){a.dom.addEventListener(c,W)},remove:function(a,c){a.dom.removeEventListener(c,W)}},f=0;f<d.length;f++)J(a,d[f],c);for(var d="tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
T=function(a){return"dragstart"===a||"dragmove"===a||"dragend"===a||"dragcancel"===a},G=function(a,c){var b=a.data("_gestures");!b&&c&&(b={listenerCount:0},a.data("_gestures",b));return b},c={add:function(a,c){var b=G(a,!0);b.touches||(b.touches=[],a.ontouchstart(H));b.listenerCount++;T(c)&&(b.dragCount||(b.dragCount=0,a.onmousedown(I)),b.dragCount++)},remove:function(a,c){var b=G(a);b&&(b.listenerCount--,0===b.listenerCount&&(a.removeData("_gestures"),a.offtouchstart(H)),T(c)&&0<b.dragCount&&(b.dragCount--,
b.dragCount||a.offmousedown(I)))}},f=0;f<d.length;f++)J(a,d[f],c);var Q={add:function(a,c){},remove:function(a,c){}};a.customEvent=function(a){J(this,a,Q)};a.dispatchCustom=function(a,c){var b=!0,d=p(this.dom,a);if(d)for(var e=0;e<d.length;e++){var q=d[e];q.args[0]=c;!1===q.fn.apply(q.ref,q.args)&&(b=!1);b&&c.defaultPrevented&&c.defaultPrevented()&&(b=!1);q.args[0]=null}return b};var D=function(a,c,d,e,q){for(var g=!0;a&&a.dom&&!p(a.dom,c);)a=a.parent();a&&!a.dom&&(a=null);if(a&&a.dom){var g=d.start,
B=d.current,f=g.center,l=B.center,ba=d.delta;ba||(ba=d.delta={x:0,y:0});ba.x=l.x-f.x;ba.y=l.y-f.y;if(ba.x||ba.y)d.moved=!0;var n=d.moved||!1,u=d.press?!!d.press.started:!1,h=M(Ub(f.x,f.y,l.x,l.y)),J=f.x,k=f.y,da=l.x,m=l.y,J=M(J==da&&k==m?0:Math.atan2(k-m,da-J),100),aa;0<h&&(aa=b[Math.floor((12*J/Math.PI+24)%24)]);k=1;da=0;d.touches&&1<d.touches.length&&(0<g.distance&&(k=B.distance/g.distance),da=Wb(B.angle-g.angle));d={type:c,srcEvent:e,target:a.dom,distance:h,angle:J,scale:k,rotation:da,start:f,
center:l,delta:ba,direction:aa,moved:n,press:u,kinetic:!!q};K.OILogGesture&&K.OILogGesture(c,a,d);g=a.dispatchCustom(c,d);for(a=a.parent();g&&a&&a.dom;a=a.parent())p(a.dom,c)&&(g=a.dispatchCustom(c,d))}return g},h=function(a,c,b){c.press&&(c.press.started=!0,D(a,"press",c,b))},z=function(a,c,b){c.press&&(c.press.started&&D(a,"pressup",c,b),c.press.timer&&ua(c.press.timer),delete c.press)},g=function(a,c,b,d,e,q){a=b.kinetic;var B=!1,f;if(a){b.start=e;b.current=q;var p=Date.now()-a.frameTime,p=Math.exp(-p/
325),l;a.ax&&(f=-a.ax*p,.5>Math.abs(f)&&(f=0),b.current.center.x=e.center.x+a.tx+f);a.ay&&(l=-a.ay*p,.5>Math.abs(l)&&(l=0),b.current.center.y=e.center.y+a.ty+l);if(f||l)f=b.dragCount?"dragmove":"panmove",D(c,f,b,d,!0),B=!0,a.anim=kb(g,null,c,b,d,e,q)}B||(f=b.dragCount?"dragend":"panend",D(c,f,b,d,!0),delete b.kinetic,delete b.start,delete b.current)},m=function(a,c,b){c.pan&&(D(a,"pancancel",c,b),delete c.pan)},O=function(a){if(a){var c=Date.now();if(1==a.length){var b=a[0];a={x:M(b.x),y:M(b.y)};
return{distance:0,angle:0,center:a,time:c}}if(2<=a.length){for(var d=0,e,q=a.length-1,g=0;g<q;g++)for(var B=a[g],f=g+1;f<a.length;f++){var l=a[f],l=Ub(B.x,B.y,l.x,l.y);l>d&&(d=l,e=B,b=a[f])}a:{if(a){var p,n;if(1==a.length){q=a[0];a={x:q.x,y:q.y};break a}if(2==a.length){q=a[0];p=a[1];a={x:(q.x+p.x)/2,y:(q.y+p.y)/2};break a}if(2<a.length){q={x:0,y:0};g=0;B=a.length-1;for(f=0;f<a.length;f++){p=a[f];n=f<B?a[f+1]:a[0];l=p.x;p=p.y;var u=n.x;n=n.y;var h=l*n-u*p,g=g+h;q.x+=(l+u)*h;q.y+=(p+n)*h}g*=3;q.x/=
g;q.y/=g;a=q;break a}}a=void 0}a.x=M(a.x);a.y=M(a.y);d=M(d);q=e.x;e=e.y;g=b.x;b=b.y;return{distance:d,angle:M(q==g&&e==b?0:Math.atan2(e-b,g-q),100),center:a,time:c}}}};a.kinetic=function(a){!0===a?G(this,!0).enableKinetic=!0:!1===a&&(a=G(this))&&delete a.enableKinetic};a.cancelKinetic=function(){var a=G(this);a&&a.kinetic&&(a.kinetic.anim&&Xb(a.kinetic.anim),delete a.kinetic)};var H=function(a){var c=G(this);if(c){this.cancelKinetic();var b=c.touches,d=a.changedTouches,e=v.viewNode,q=null;c.dragCount||
(q=this.pos(e));for(var g=0;g<d.length;g++){var B=e.touchPos(d[g]);q&&(B.x-=q.left,B.y-=q.top);B.ox=B.x;B.oy=B.y;b.push(B)}c.current=O(c.touches);c.start=c.current;1==b.length?(delete c.tap,c.tap={time:c.current.time},z(this,c,a),a=ea(h,500,null,this,c,a),c.press={timer:a}):1<b.length&&!c.pinch&&(delete c.tap,z(this,c,a),m(this,c,a),delete c.distance,c.pinch||(c.pinch={},D(this,"pinchstart",c,a)));Wa.setTouchCapture(N,R,ra,this);return!1}},N=function(a){var c=G(this);if(c){for(var b=c.touches,d,e=
a.changedTouches,q=c.dragCount?v.viewNode:this,g=0;g<e.length;g++)for(var B=q.touchPos(e[g]),f=0;f<b.length;f++)if(d=b[f],d.identifier===B.identifier){d.x=B.x;d.y=B.y;d.dx=B.x-d.ox;d.dy=B.y-d.oy;break}d=c.current;e=O(c.touches);if(e.distance!==d.distance||e.angle!==d.angle||e.center.x!==d.center.x||e.center.y!==d.center.y)if(c.previous=d,c.current=e,1!=b.length||c.multi)1<b.length&&(c.multi=!0,c.pinch&&(b=c.previous,d=c.current,e=c.start,0<e.distance&&(q=M(b.distance/e.distance,100),M(d.distance/
e.distance,100)!=q&&D(this,"pinchmove",c,a)),d.angle!=b.angle&&(c.rotate||(c.rotate={start:c.start.angle},D(this,"rotatestart",c,a)),D(this,"rotatemove",c,a))));else if(d=b[0],b=c.distance=Ub(d.dx,d.dy,0,0),d=e.time-c.start.time,10<b&&50<d&&(delete c.tap,c.press&&c.press.started||z(this,c,a),c.pan||(m(this,c,a),c.pan={startTime:c.current.time},c.enableKinetic&&!c.press&&(c.kinetic={vx:0,vy:0,frameTime:c.current.time,frameX:0,frameY:0}),D(this,c.dragCount?"dragstart":"panstart",c,a)),c.pan&&(D(this,
c.dragCount?"dragmove":"panmove",c,a),a=c.kinetic)))b=c.current.time,d=b-a.frameTime,e=c.delta,c.pan.moveTime=b,c=e.y-a.frameY,a.vx=1E3*(e.x-a.frameX)/(d+1)*.8+.2*a.vx,a.vy=1E3*c/(d+1)*.8+.2*a.vy,a.frameTime=b,a.frameX=e.x,a.frameY=e.y;return!1}},R=function(a){fa(this,a,!1)},ra=function(a){fa(this,a,!0)},fa=function(a,c,b){var d=G(a);if(d){var e=d.touches,q=e.length-c.changedTouches.length;try{if(1==e.length)if(b)delete d.tap,z(a,d,c),m(a,d,c);else{if(d.pan){var B=Date.now(),f=B-d.pan.startTime;b=
!1;var p,l=d.kinetic;l&&(150<B-d.pan.moveTime&&(l.vx=0,l.vy=0),10<Math.abs(l.vx)&&(l.ax=.8*l.vx,l.tx=Math.round(d.delta.x+l.ax)),10<Math.abs(l.vy)&&(l.ay=.8*l.vy,l.ty=Math.round(d.delta.y+l.ay)),l.ax||l.ay?(l.frameTime=B,l.anim=kb(g,null,a,d,c,d.start,d.current),b=!0):delete d.kinetic);b||(p=d.dragCount?"dragend":"panend",D(a,p,d,c));if(!(d.dragCount||d.press&&d.press.started)&&1E3>f){var n=d.touches[0],u=Math.abs(n.dx),h=Math.abs(n.dy);60<=u&&60>h?p=0>n.dx?"swiperight":"swipeleft":60<=h&&60>u&&(p=
0>n.dy?"swipeup":"swipedown");p&&D(a,p,d,c)}delete d.pan}z(a,d,c);d.tap&&(200>Date.now()-d.tap.time&&D(a,"tap",d,c),delete d.tap)}else 1<e.length&&1>=q&&(b?(d.rotate&&(D(a,"rotatecancel",d,c),delete d.rotate),d.pinch&&(D(a,"pinchcancel",d,c),delete d.pinch)):(d.rotate&&(D(a,"rotateend",d,c),delete d.rotate),d.pinch&&(D(a,"pinchend",d,c),delete d.pinch)))}catch(pb){E.logError(null,pb)}a=c.changedTouches;for(c=0;c<a.length;c++)for(B=a[c],f=0;f<e.length;f++)if(e[f].identifier===B.identifier){e.splice(f,
1);break}delete d.distance;0===e.length&&(delete d.start,delete d.current,delete d.previous,delete d.multi,Wa.releaseTouchCapture());return!1}},C=function(a){a=v.viewNode.mousePos(a);return{distance:0,angle:0,center:{x:a.x,y:a.y}}},I=function(a){if(0===(a.button||0)){var c=C(a),b=G(this,!0);b.start=c;b.current=c;if(!D(this,"dragstart",b,a))return Wa.setMouseCapture(q,B,this),!1}},q=function(a){var c=C(a),b=G(this,!0);if(b&&b.current){var d=b.current.center;if(c.center.x!=d.x||c.center.y!=d.y)b.current=
c,D(this,"dragmove",b,a);return!1}},B=function(a){var c=G(this,!0);D(this,"dragend",c,a);Wa.releaseMouseCapture();return!1};return e}(),Yb=function(){var b=function(a,b,c){S.call(this,"input",c);this.dom.type="button";"string"===typeof a&&(this.dom.value=a);"string"===typeof b&&(this.dom.title=b)},e=V(b,S);Object.defineProperties(e,{disabled:{get:function(){return this.dom.disabled},set:function(a){this.dom.disabled=a}}});return b}(),mc=function(){var b=function(a,b){S.call(this,"textarea",b);"string"===
typeof a&&(this.dom.value=a)},e=V(b,S);Object.defineProperties(e,{value:{get:function(){return this.dom.value},set:function(a){this.dom.value=a}}});e.moveCaret=function(a){var b=this.dom;b.createTextRange?(b=b.createTextRange(),b.move("character",a),b.select()):void 0!==b.selectionStart?(b.focus(),b.setSelectionRange(a,a)):b.focus()};return b}(),kc=function(){var b=function(a,b){S.call(this,"canvas");2===arguments.length?(this.dom.width=a,this.dom.height=b):1===arguments.length&&(this.dom.width=a.clientWidth,
this.dom.height=a.clientHeight,y.wrap(a).append(this))},e=V(b,S);Object.defineProperties(e,{width:{get:function(){return this.dom.width}},height:{get:function(){return this.dom.height}}});var a=function(a,b,d,e,r,w,n,l){this.globalAlpha=1;void 0!==r&&(this.fillStyle=r);w?(this.strokeStyle=w,this.lineWidth=n||1,this.lineCap="square",this.beginPath(),this.setLineDash(l||[]),this.rect(a,b,d,e),r&&this.fill(),this.stroke(),this.closePath()):(this.lineWidth=0,this.fillRect(a,b,d,e))},d=function(a,b,d,
e,r,w,n){void 0!==r&&(this.strokeStyle=r);this.lineWidth=w||1;this.lineCap="square";this.globalAlpha=1;this.beginPath();this.setLineDash(n||[]);this.moveTo(a,b);this.lineTo(d,e);this.stroke();this.closePath()};e.getContext=function(c){c=this.dom.getContext(c);c.oitrect=a;c.oitline=d;return c};return b}(),Xa=function(){var b=function(b,a){this.prop("list",b);this.prop("name",a)};V(b);return b}(),qb=function(){var b=function(a){this._createFn=a;this._plugins={}},e=V(b);e.item=function(a){return this._plugins[a]};
e.items=function(){return this._plugins};e.extend=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this.extend.call(this,a[c],b);else{if("string"===typeof a)return c=this._plugins[a],c||(c=this._createFn.call(this,a))&&(this._plugins[a]=c),c&&c.extend.call(c,b),c;if("object"===typeof a)for(c in a)this.extend.call(this,c,a[c])}};return b}(),v=function(){var b=new qb(function(e){return new nc(b,e)});b.reset=function(b,a){if("string"===typeof b){"boolean"!==typeof a&&(a=!0);var d=this._plugins[b];
d&&d.reset(a)}};b.resetAll=function(b){"boolean"!==typeof b&&(b=!0);for(var a in this._plugins)this._plugins[a].reset(b)};b.defaultVal=function(b){if(b=this._plugins[b])return b.defaultVal()};b.setProperty=function(b,a,d){(b=this._plugins[b])&&b.setProperty(a,d)};return b}(),nc=function(){var b=function(a,b){Xa.call(this,a,b)},e=V(b,Xa);e.extend=function(a){a=a||{};var b={_v:{value:void 0,writable:!0}};a.init&&(b.init={value:a.init});void 0!==a.def&&(b.def={value:a.def});this.list!==v&&(!0===a.pub&&
(b.pub={value:a.pub}),a.legal&&(b.legal={value:a.legal}),a.validate&&(b.validate={value:a.validate}),a.type&&(b.type={value:a.type||"boolean"},"number"===a.type||Array.isArray(a.type)&&-1!=a.type.indexOf("number")))&&("number"===typeof a.min&&(b.min={value:a.min}),"number"===typeof a.max&&(b.max={value:a.max}));Object.defineProperties(this,b);var c=this;this.list["on"+this.name]=function(a,b){return c.listen(a,b)};this.list["off"+this.name]=function(a,b){return c.unlisten(a,b)};Object.defineProperty(this.list,
this.name,{enumerable:!0,get:function(){return void 0===c._v&&(c.init&&(c._v=c.init()),void 0===c._v)?c.defaultVal():c._v},set:function(a){c.set(a)}})};e.listen=function(a,b){void 0===b&&(b=a,a=void 0);this._listeners||(this._listeners=[]);this._listeners.push({context:a,fn:b})};e.unlisten=function(a,b){if(this._listeners){void 0===b&&(b=a);for(var c=0;c<this._listeners.length;c++)if(this._listeners[c].fn==b){this._listeners.splice(c,1);break}}};e.set=function(a,b){if(a!==this._v){if(void 0!==a){var c=
!0;if(this.type){var d=null===a?"null":typeof a,c=d===this.type;!c&&Array.isArray(this.type)&&(c=-1!=this.type.indexOf(d));c||"string"!==d||(c="color"===this.type,!c&&Array.isArray(this.type)&&(c=-1!=this.type.indexOf("color")),c&&(d="color"));c&&"color"===d?Aa(a)||(this.pub&&E.invalidArg("setOptions",this.name,a,"Must be a CSS color string"),a=this._v):c||("null"===d?a=void 0:(this.pub&&(d=Array.isArray(this.type)?"Must be one of these types: "+JSON.stringify(this.type):"Must be of type "+this.type,
E.invalidArg("setOptions",this.name,a,d)),a=this._v))}c&&(this.legal&&-1==this.legal.indexOf(a)?(this.pub&&E.invalidArg("setOptions",this.name,a,"Must be one of "+JSON.stringify(this.legal)),a=this._v):void 0!==this.min&&a<this.min?(this.pub&&E.invalidArg("setOptions",this.name,a,"Using minimum value of "+this.min,!1),a=this.min):void 0!==this.max&&a>this.max?(this.pub&&E.invalidArg("setOptions",this.name,a,"Using maximum value of "+this.max,!1),a=this.max):this.validate&&(a=this.validate(this.name,
a,this._v)))}if(a!==this._v){c=this._v;if("object"===this.type){this._v={};for(var e in a)a.hasOwnProperty(e)&&(this._v[e]=a[e])}else this._v=a;if(!1!==b&&this._listeners)for(e=0;e<this._listeners.length;e++)d=this._listeners[e],d.fn.call(d.context,this._v,c,this.name)}}};e.setProperty=function(a,b){if("object"===this.type||Array.isArray(this.type)&&-1!=this.type.indexOf("object")&&(!this._v||this._v[a]!==b))if(this._v||(this._v={}),this._v[a]!==b&&(this._v[a]=b,this._listeners))for(var c=0;c<this._listeners.length;c++){var d=
this._listeners[c];d.fn.call(d.context,this._v,null,this.name)}};e.reset=function(a){this.set(void 0,a)};e.defaultVal=function(){return this.def};return b}();v.extend({URL:{init:function(){return X.URL}},baseURL:{init:function(){return x.outputBaseUrl}},viewNode:{init:function(){var b=v.rootNode;if(b)return y.attach(b.childByClass("oit-view"))}},rootNode:{init:function(){var b=y.byClass("oit-view-root");if(b&&0<b.length)return y.attach(b[0])}},deType:{},drawing:{},libversion:{},documentLoading:{def:!1},
documentLoaded:{def:!1},documentComplete:{def:!1},documentUnloading:{def:!1},dynamicContent:{def:!1},enableRawText:{},guid:{},singlePageIndex:{},isMobile:{init:function(){return oc()}},isMobileOrTablet:{init:function(){return pc()}},editingComment:{def:0},staging:{def:!1},hasHiddenText:{def:!1},hasWorksheetRevisions:{def:!1}});var x=function(){var b=new qb(function(e){return new nc(b,e)});b.isPublic=function(b){return(b=this._plugins[b])&&b.pub};b.reset=function(b){lb(this._plugins,"reset",null,b)};
b.reset=function(b,a){if("string"===typeof b){"boolean"!==typeof a&&(a=!0);var d=this._plugins[b];d&&d.reset(a)}};b.resetAll=function(b){"boolean"!==typeof b&&(b=!0);for(var a in this._plugins)this._plugins[a].reset(b)};b.defaultVal=function(b){if(b=this._plugins[b])return b.defaultVal()};b.setProperty=function(b,a,d){(b=this._plugins[b])&&b.setProperty(a,d)};return b}();x.extend({disableAnimation:{pub:!0,type:"boolean",init:function(){return!1}},memoryModel:{pub:!0,type:"string",legal:["large","small",
"micro","none"],init:function(){return v.isMobileOrTablet?"small":"large"}},detectBaseUrl:{pub:!0,type:"boolean",def:!0},outputBaseUrl:{pub:!0,type:"string",def:""},centerPages:{pub:!0,type:"boolean",def:!0},redactionColor:{pub:!0,type:"color",def:"#000"},redactionFillColor:{pub:!0,type:"color",def:null},showHighlightLabels:{pub:!0,type:"boolean",def:!0},highlightLabelFontFamily:{pub:!0,type:"string",def:null},highlightLabelFontSize:{pub:!0,type:"string",def:null},highlightActivationBoxColor:{pub:!0,
type:["color","null"],def:null},redactionMode:{pub:!0,type:"string",legal:["simple","compound","hybrid"],def:"hybrid"},contentTimeout:{pub:!0,type:"number",min:1,def:2E4},doubleClickInterval:{pub:!0,type:"number",def:500,min:1,max:1E4},removeExtraEmailHeaders:{pub:!0,type:"boolean",def:!1},emailHeaderStyle:{pub:!0,type:"object",def:null},zoom:{type:"number",def:1,min:.1,max:40},zoomMode:{type:["string","null"],legal:[null,"page","pagewidth","pageheight","mobile"],init:function(){return v.isMobileOrTablet?
"mobile":null}},rotation:{type:"number",legal:[0,90,180,270],def:0},selectionMode:{type:"string",legal:["text","rect","cell","none"],def:"text",validate:function(b,e,a){return P.validateMode(e,a)}},nochrome:{pub:!0,type:"boolean",def:!1,init:function(){return!1}},scrollMode:{pub:!0,type:"string",legal:["single","vertical","hswipe","vswipe"],def:"vertical",init:function(){return v.isMobileOrTablet?"hswipe":"vertical"}},showSlideNotes:{pub:!0,type:"boolean",def:!1},showAnnotations:{pub:!0,type:"boolean",
def:!1},presentationMode:{pub:!0,type:"string",legal:["normal","slideshow"],def:"normal"},showEmailAddresses:{pub:!0,type:"boolean",def:!1},showHiddenSheets:{pub:!0,type:"boolean",def:!1},showHiddenRows:{pub:!0,type:"boolean",def:!1},showHiddenColumns:{pub:!0,type:"boolean",def:!1},showCellTooltips:{type:"boolean",def:!1},showHiddenContentNotification:{pub:!0,type:"string",legal:["none","expanded","collapsed"],def:"collapsed"},appointmentHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",headerFields:[["ORGANIZER",
"FROM"],"IMPORTANCE","LOCATION","DTSTART","DTEND","CATEGORIES","ATTENDEES","REQATTENDEE","OPTATTENDEE"]}},contactHeader:{pub:!0,type:"object",def:{subjectField:["SUBJECT","DISPLAYAS","FILEAS","FULLNAME"],defaultSubject:!1,dateField:null,photoField:[{g:"PHOTO",id:"PHOTO"},"PHOTO"],logoField:[{g:"LOGO",id:"LOGO"},"LOGO"],headerFields:["COMPANY",[{g:"NAME",id:"FIRST"},"FIRST"],[{g:"NAME",id:"MIDDLE"},"MIDDLE"],[{g:"NAME",id:"FAMILY"},"FAMILY"],[{g:"NAME",id:"SUFFIX"},"SUFFIX"],[{g:"NAME",id:"TITLE"},
"TITLE","JOBTITLE"],{multi:!0,fields:[{g:"TELENUMBER",t:"Work",id:"TELENUMBER",l:"EMAIL_BUSINESSPHONE"},{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},"BUSINESSPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Cell",id:"TELENUMBER",l:"EMAIL_MOBILEPHONE"},"MOBILEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Pager",id:"TELENUMBER",l:"EMAIL_PAGERPHONE"},"PAGERPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Home",id:"TELENUMBER",
l:"EMAIL_HOMEPHONE"},{g:"ADDRESS",t:"Home",id:"PHONE",l:"EMAIL_HOMEPHONE"},"HOMEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Postal",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},{g:"ADDRESS",t:"Postal",id:"PHONE",l:"EMAIL_OTHERPHONE"},{g:"TELENUMBER",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},"TELENUMBER","OTHERPHONE"]},{multi:!0,fields:[{g:"EMAIL",id:"EMAIL",d:"DISPLAYAS"},"EMAIL"]},"WEBPAGE","IMADDRESS","DISPLAYAS",{title:"BUSINESSADDRESS",fields:[[{g:"ADDRESS",t:"Work",id:"POBOX"},{g:"BUSINESSADDRESS",id:"BUSINESSPOBOX"},
"BUSINESSPOBOX"],[{g:"ADDRESS",t:"Work",id:"STREET"},{g:"BUSINESSADDRESS",id:"BUSINESSSTREET"},"BUSINESSSTREET"],[{g:"ADDRESS",t:"Work",id:"CITY"},{g:"BUSINESSADDRESS",id:"BUSINESSCITY"},"BUSINESSCITY"],[{g:"ADDRESS",t:"Work",id:"STATE"},{g:"BUSINESSADDRESS",id:"BUSINESSSTATE"},"BUSINESSSTATE"],{g:"ADDRESS",t:"Work",id:"REGION"},[{g:"ADDRESS",t:"Work",id:"POSTALCODE"},{g:"BUSINESSADDRESS",id:"BUSINESSPOSTALCODE"},"BUSINESSPOSTALCODE"],[{g:"ADDRESS",t:"Work",id:"COUNTRY"},{g:"BUSINESSADDRESS",id:"BUSINESSCOUNTRY"},
"BUSINESSCOUNTRY"],[{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE2"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE2"},"BUSINESSPHONE2"],[{g:"ADDRESS",t:"Work",id:"BUSINESSFAX"},{g:"BUSINESSADDRESS",id:"BUSINESSFAX"},"BUSINESSFAX"]]},{title:"HOMEADDRESS",fields:[[{g:"ADDRESS",t:"Home",id:"POBOX"},"HOMEPOBOX"],[{g:"ADDRESS",t:"Home",id:"STREET"},"HOMESTREET"],[{g:"ADDRESS",t:"Home",id:"CITY"},"HOMECITY"],[{g:"ADDRESS",t:"Home",id:"STATE"},"HOMESTATE"],{g:"ADDRESS",t:"Home",id:"REGION"},[{g:"ADDRESS",t:"Home",id:"POSTALCODE"},
"HOMEPOSTALCODE"],[{g:"ADDRESS",t:"Home",id:"COUNTRY"},"HOMECOUNTRY"],[{g:"ADDRESS",t:"Home",id:"PHONE2"},"HOMEPHONE2"],[{g:"ADDRESS",t:"Home",id:"FAX"},"HOMEFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",t:"Postal",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",t:"Postal",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",t:"Postal",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",t:"Postal",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",t:"Postal",id:"REGION"},[{g:"ADDRESS",t:"Postal",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",
t:"Postal",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",t:"Postal",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",t:"Postal",id:"FAX"},"OTHERFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",id:"REGION"},[{g:"ADDRESS",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",
id:"FAX"},"OTHERFAX"]]}]}},distroHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:[]}},journalHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"START",headerFields:["ENTRY_TYPE","COMPANY","DURATION","CATEGORIES"]}},emailHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:["CLIENT_SUBMIT_TIME","DATE"],headerFields:["FROM","TO","CC","BCC"]}},noteHeader:{pub:!0,type:"object",def:{subjectField:null,dateField:null,headerFields:["CREATION_TIME",
"CATEGORIES"]}},postHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"CREATION_TIME",headerFields:["FROM","CLIENT_SUBMIT_TIME","CONVERSATION_TOPIC"]}},taskHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:"START_DATE STATUS DUE_DATE PRIORITY OWNER PERCENT_COMPLETE CATEGORIES".split(" ")}},annoBarWidth:{pub:!0,type:"number",init:function(){return Math.min(v.viewNode.clientWidth/2,320)}},highlightTermIntervals:{pub:!0,type:"boolean",def:!0},highlightActivationStyle:{pub:!0,
type:"string",legal:["box","opacity"],def:"opacity"},annotationSort:{pub:!0,type:"string",legal:"location date rdate author rauthor type".split(" "),def:"location"},normalizeAccentsForSearch:{pub:!0,type:"boolean",def:!0}});var Qc=function(){var b=function(a,c,b){Xa.call(this,c,b);this.prop("host",a,!1,!0)},e=V(b,Xa),a=function(a,c,b){if(a=a._int)for(var d=0;d<a.length;d++){var e=a[d];if(e.fn===c&&(void 0===b||e.context===b))return d}return-1},d=function(a,c){var b=a._pub;return b?b.indexOf(c):-1},
c=function(c,b,d,e){void 0===d&&(d=b,b=void 0);if(-1===a(c,d,b)){var f=!c.hasListeners(),l={context:b,fn:d};!0===e&&(l.listenOnce=!0);c.single&&c.hasListeners()?c.logError(null,"Only one listener may be registered for the "+c.name+" event."):(c._int||c.prop("_int",[],!0),c._int.push(l),f&&c.isSystemEvent()&&c.list.addElementListeners(c.name),c.onListen&&c.onListen.call(null,c,d,b))}},f=function(a,c){-1!=c&&(a.dispatching?(a._xint||(a._xint=[]),a._xint.push(c)):(a._int.splice(c,1),!a.hasListeners()&&
a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onUnlisten&&a.onUnlisten.call(null,a)))},k=function(a,c){-1!=c&&(a.dispatching?(a._xpub||(a._xpub=[]),a._xpub.push(c)):(a._pub.splice(c,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onRemove&&a.onRemove.call(null,a)))},t=function(){var a;this.detail&&(a=this.detail.apply(null,arguments));var c=this.systemEventName||this.name,b=X.createEvent("CustomEvent");b.initCustomEvent(c,!0,!0,a);return b},r=function(){var a=
!0,c,b;this.dispatching=!0;var d=this._int;if(d)for(c=d.length,b=0;b<c;b++){var e=d[b];!1===e.fn.apply(e.context,arguments)&&(a=!1);e.listenOnce&&f(this,b)}d=this._pub;if(a&&d){a=t.apply(this,arguments);c=d.length;for(b=0;b<c;b++)d[b].call(void 0,a);a=!a.defaultPrevented}a&&this._def&&(a=this._def.fn.apply(this._def.context,arguments));this.dispatching=!1;if(this._xint){for(b=this._xint.length-1;0<=b;b--)f(this,this._xint[b]);delete this._xint}if(this._xpub){for(b=this._xpub.length-1;0<=b;b--)k(this,
this._xpub[b]);delete this._xpub}return a};e.extend=function(a){a&&(!0===a.pub&&(this.prop("pub",!0),a.detail&&this.prop("detail",a.detail)),!0===a.systemEvent&&this.prop("systemEventName","_"+this.name),0<a.delay&&this.prop("delay",a.delay),!0===a.single&&this.prop("single",!0),this.prop("onListen",a.onListen),this.prop("onUnlisten",a.onUnlisten),this.prop("onAdd",a.onAdd),this.prop("onRemove",a.onRemove),Object.defineProperty(this.list,this.name,{enumerable:!0,value:this}))};e.enable=function(){this.disabled=
!1};e.disable=function(){this.disabled=!0};e.hasListeners=function(){return!!this._def||this._int&&0<this._int.length||this._pub&&0<this._pub.length};e.isSystemEvent=function(){return!!this.systemEventName};e.setDefaultListener=function(a,c){if(a){this._def&&this.setDefaultListener(null);var b=!this.hasListeners();this._def={context:c,fn:a};b&&this.isSystemEvent()&&this.list.addElementListeners(this.name);this.onListen&&this.onListen.call(null,this,a,c)}else this._def&&(delete this._def,!this.hasListeners()&&
this.isSystemEvent()&&this.list.removeElementListeners(this.name),this.onUnlisten&&this.onUnlisten.call(null,this))};e.listen=function(a,b){c(this,a,b,!1)};e.listenOnce=function(a,b){c(this,a,b,!0)};e.unlisten=function(c,b){void 0===b&&(b=c,c=void 0);f(this,a(this,b,c))};e.addPublicListener=function(a){var c=!1;if(this.pub&&"function"===typeof a)if(-1!==d(this,a))c=!0;else{var b=!this.hasListeners();this.single&&this.hasListeners()?this.logError(null,"Only one listener may be registered for the "+
this.name+" event."):(this._pub||this.prop("_pub",[],!0),this._pub.push(a),b&&this.isSystemEvent()&&this.list.addElementListeners(this.name),this.onAdd&&this.onAdd.call(null,this,a),c=!0)}return c};e.removePublicListener=function(a){a=d(this,a);if(-1==a)return!1;k(this,a);return!0};e.dispatch=function(){this.logDispatch&&this.logDispatch.apply(this,arguments);if(this.hasListeners()&&!this.disabled){if(!this.delay||v.documentUnloading)return r.apply(this,arguments);this._dispatchTimer&&ua(this._dispatchTimer);
this._ddArgs=arguments;this._dispatchTimer=ea(w,this.delay,this)}return!0};var w=function(){r.apply(this,this._ddArgs);delete this._ddArgs};e.dispatchTo=function(a,c){var b=t.apply(this,c);a.call(void 0,b);return!b.defaultPrevented};e.reset=function(){this._int&&(this._int=[]);this._pub&&(this._pub=[]);delete this._def};return b}(),qc=function(){var b="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel".split(" "),e=function(a){for(a=
y.unwrap(a);a;){var c=y.data(a,"dispatcherData");if(c)return c;a=a.parentNode}},a=function(a){return new Qc(this._host,this,a)},d=function(c,b){qb.call(this,a);this.name=b;this._host=c;this._eventElements=[];var d=this;this.onSystemEvent=function(a){var c=!0,b=d[a.type];if(b&&b.hasListeners()&&!b.disabled){var f=e(a.currentTarget||a.target);if(f)for(var u=0;c&&u<f.length;u++){var p=f[u];p.args[1]=a;c=b.dispatch.apply(b,p.args);p.args[1]=null}}c||jb(a);return c}},c=V(d,qb);c.enable=function(){this.disabled=
!1};c.disable=function(){this.disabled=!0};c.addElementListeners=function(a){if(this[a])if(-1!==b.indexOf(a))for(var c=0;c<this._eventElements.length;c++){var d=this._eventElements[c];d.addEventListener(a,this.onSystemEvent,!1)}else for(c=0;c<this._eventElements.length;c++)d=this._eventElements[c],y.wrap(d).on(a,this,this.onSystemEvent)};c.removeElementListeners=function(a){if(this[a])if(-1!==b.indexOf(a))for(var c=0;c<this._eventElements.length;c++)this._eventElements[c].removeEventListener(a,this.onSystemEvent);
else for(c=0;c<this._eventElements.length;c++)y.wrap(this._eventElements[c]).off(a,this,this.onSystemEvent)};c.addElement=function(a,c){if((a=y.unwrap(a))&&a.addEventListener){var d;if(-1==this._eventElements.indexOf(a))for(d in this._eventElements.push(a),this._plugins){var f=this[d];if(f.isSystemEvent()&&f.hasListeners())if(-1!==b.indexOf(d))a.addEventListener(d,this.onSystemEvent,!1);else y.wrap(a).on(d,this,this.onSystemEvent)}f={context:c,args:[y.wrap(a),null]};for(d=1;d<arguments.length;d++)f.args.push(arguments[d]);
var k=e(a);k||(k=[],y.data(a,"dispatcherData",k));var n=!1;for(d=0;d<k.length;d++)if(k[d].context===c){k[d]=f;n=!0;break}n||k.push(f)}};c.removeElement=function(a,c){a=y.unwrap(a);var d=this._eventElements.indexOf(a);if(-1!=d){var f=!0;if(void 0===c)y.removeData(a,"dispatcherData");else{var k=e(a);if(k){for(var n=0;n<k.length;n++)if(k[n].context===c){1==k.length?k=null:k.splice(n,1);break}k&&0!==k.length?f=!1:y.removeData(a,"dispatcherData")}}if(f){this._eventElements.splice(d,1);for(var l in this._plugins)d=
this[l],d.isSystemEvent()&&d.hasListeners()&&(-1!==b.indexOf(l)?a.removeEventListener(l,this.onSystemEvent):y.wrap(a).off(l,this,this.onSystemEvent))}}};c.removeAllElements=function(){for(var a=this._eventElements.length-1;0<=a;a--)this.removeElement(this._eventElements[a])};c.eventMessage=function(){if(!this._eventMessage){for(var a in this._plugins)this._eventMessage=this._eventMessage?this._eventMessage+","+a:"Must be one of ["+a;this._eventMessage&&(this._eventMessage+="]")}return this._eventMessage};
return d}(),Ua=new qc(null,"globalEvents");Ua.extend({install:{},init:{}});var ta=function(){return new qb(function(b){return new Rc(b)})}(),Rc=function(){var b="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
e=function(a){Xa.call(this,ta,a)},a=V(e,Xa),d=function(a,c){a["on"+c.name]=function(a,b){c.listen(a,b)};a["off"+c.name]=function(a,b){c.unlisten(a,b)}};a.extend=function(a){this.def=a;Ua.install.listen(this,this.install);var c=a.events;a=a.userEventDef;if(c||a){this.on||(this.on=new qc(this,this.name));if(c)for(var e in c){var f=c[e],w=this.on.extend.call(this.on,e,f);d(this,w);f&&f.pub&&(this.hasPublicEvents=!0)}a&&(a.systemEvent=!0,this.on.extend.call(this.on,b,a),a.pub&&(this.hasPublicEvents=!0))}};
a.install=function(){var a=this,c=this.def;delete this.def;c.install&&c.install(this);if(a.hasPublicEvents||c.exports&&0<c.exports.length){OIT[a.name]||(ob(a.name,{}),a.publicName="OIT."+a.name);var b={};a.hasPublicEvents&&(a.addEventListener||(b.addEventListener={value:function(c,b){var d=!1,e=a.on[c];e?d=e.addPublicListener(b):a.invalidArg("addEventListener","name",c,a.on.eventMessage());return d}}),a.removeEventListener||(b.removeEventListener={value:function(c,b){var d=!1,e=a.on[c];e?d=e.removePublicListener(b):
a.invalidArg("removeEventListener","name",c,a.on.eventMessage());return d}}));if(c.exports&&0<c.exports.length)for(var d=0;d<c.exports.length;d++){var e=c.exports[d],n=a[e];void 0!==n&&(b||(b={}),b[e]={value:n})}Object.defineProperties(OIT[a.name],b)}};var c=function(a,b){if(Array.isArray(b))for(var d=0;d<b.length;d++){if(c(a,b[d]))return!0}else{if(void 0===a)return!0;switch(b){case "null":if(null===a)return!0;break;case "function":if(null===a||Oa(a))return!0;break;case "DOMRange":if(null===a||Qa(a))return!0;
break;case "DOMSelection":if(null===a||va(a))return!0;break;case "RegExp":if(null===a||a instanceof RegExp)return!0;break;case "string":if(null===a||"string"===typeof a)return!0;break;default:if(typeof a===b)return!0}}return!1};a.processArguments=function(a,b,d){for(var e={},f=0,n=0;f<d.length;f++){var l=d[f];e&&l.def&&(e[l.name]=l.def);if(n>=b.length)l.req&&(this.logError(a,"Argument '"+l.name+"' is required"),e=null);else{var u=b[n];if(c(u,l.type)){var p=null;l.val?p=l.val(u):l.legal&&-1==l.legal.indexOf(u)&&
(p="Must be one of "+JSON.stringify(l.legal));p?(this.invalidArg(a,l.name,u,p),e=null):e&&(e[l.name]=u);n++}else l.req&&(this.invalidArg(a,l.name,u,"Must be of type "+JSON.stringify(l.type)),n++,e=null)}}return e};return e}(),wb=function(){return new qb(function(b){return new Sc(b)})}(),Sc=function(){var b=function(a){Xa.call(this,wb,a)},e=V(b,Xa);e.extend=function(a){this.def=a;Ua.install.listen(this,this.install)};e.install=function(){var a=this.def;delete this.def;a.install&&a.install(this)};e.init=
function(a){if(a.isLoaded())this.load(a);else{var b=this;a.load(!0,function(){b.load(a)})}};e.load=function(a){};e.unload=function(){};e.visiblePages=function(){return[A.activePage()]};e.saveScrollPos=function(){};e.restoreScrollPos=function(a){};e.maxPageWidth=function(){return A.maxWidth()};e.maxPageHeight=function(){return A.maxHeight()};e.padding=function(){return{left:0,top:0,right:0,bottom:0}};e.margin=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollOffset=function(){return v.viewNode.scroll()};
e.startElasticScroll=function(){};e.elasticScroll=function(a,b){};e.endElasticScroll=function(a,b){};e.getSelectedText=function(){return y.selectedText()};e.select=function(a){return!1};e.keydown=function(a){return!0};e.showHidden=function(a){};e.loadRange=function(a,b){b&&b(a)};e.expandRange=function(a){return a};e.moveto=function(a,b,c){return!1};e.pageRange=function(a,b){};e.pageRect=function(a,b,c){return A.elementRect(A.page(a),b)};e.rangeRect=function(a,b,c,e){};e.rangeFromRect=function(a,b,
c,e,k,t,r){};e.extendRange=function(a,b,c,e){};e.moveAnchor=function(a,b,c,e){return!1};e.incrementSelection=function(a,b,c,e,k){return!1};e.layoutChanged=function(a){};e.update=function(a){};return b}(),Ea=function(){var b=new qb(function(b){return new Tc(b)});b.createDisplay=function(e){if(e=b.item(e))return wb.item(e.de)};b.features=function(e){if(e=b.item(e))return e.features};return b}(),Tc=function(){var b="zoom rotate showhidden pages fitpage highlights textselection rectselection rectredaction cellselection customtextselection anchorednotes elasticScroll".split(" "),
e=function(a){Xa.call(this,Ea,a)};V(e,Xa).extend=function(a){this.de=a.de;for(var d=this.features={},c=0;c<b.length;c++){var e=b[c],k=a[e];void 0===k&&(k=!0);d[e]=k}};return e}(),$a,ib,Zb,rb,Ia,Aa,$b,xb,Y=function(b){return"number"===typeof b},Ya=function(b){return"string"===typeof b};(function(){var b={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",
brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",
darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",
khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",
maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",
paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",
tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"rgba(0,0,0,0)"},e=1/6,a=1/3,d=2/3,c=function(a,c,b){0>b?b+=1:1<b&&--b;b<e?a+=(c-a)*b*6:.5>b?a=c:b<d&&(a+=(c-a)*(d-b)*6);return 255*a|0},f=[{property:"webkit",css:"-webkit-"},{property:"Moz",css:"-moz-"},{property:"ms",css:"-ms-"},{property:"O",css:"-o-"}],k=function(a,c,b){var d=X.documentElement;
if(Ya(d.style[a]))return c;if(!1!==b)for(a=a.charAt(0).toUpperCase()+a.slice(1),b=0;b<f.length;b++)if(Ya(d.style[f[b].property+a]))return f[b].css+c},t=function(a,c){for(var b,d=X.createElement("div"),e=0;e<c.length;e++)if(d.style[a]=c[e],d.style[a]===c[e]){b=c[e];break}return b};$a={transform:k("transform","transform"),"transform-origin":k("transformOrigin","transform-origin")};Rb=t("cursor",["grab","-webkit-grab","-moz-grab","move"]);Sb=t("cursor",["grabbing","-webkit-grabbing","-moz-grabbing",
"move"]);var r=function(a,c){if(-1!=c)for(var b=a.chars;c<b.length;c++){var d=b[c];if(" "!==d&&"\n"!==d&&"\r"!==d&&"\t"!==d){"/"===d&&"*"===b[c+1]&&(b=a.string.indexOf("*/",c+2),c=-1==b?a.string.length:b+2);break}}return c},w=function(a,c,b){return-1!=c&&a.chars[c]!==b?-1:++c};ib=function(a){var c;if(a){c={};a={string:a,chars:a.split("")};for(var b=0;-1!=b&&b<a.chars.length;){var d=a,e=b,b=c,f={},k=e=r(d,e);if(-1!=k){for(var n=d.chars,e=k;e<n.length;e++){var t=n[e];if(!("a"<=t&&"z">=t||"A"<=t&&"Z">=
t||"0"<=t&&"9">=t)&&"-"!==t&&"_"!==t)break}e>k?(f.name=d.string.substring(k,e),k=e):k=-1}e=k;e=r(d,e);e=w(d,e,":");k=e=r(d,e);if(-1!=k){n=d.chars;for(e=k;e<n.length;e++){t=n[e];if("!"===t||";"===t)break;if('"'===t||"'"===t||"("===t){"("===t&&(t=")");for(var D=e+1;D<n.length;D++){var h=n[D];if(h===t){e=D;break}else if("\\"===h){h=n[++D];if("0"<=h&&"9">=h||"a"<=h&&"f">=h||"A"<=h&&"F">=h){do h=n[++D];while("0"<=h&&"9">=h||"a"<=h&&"f">=h||"A"<=h&&"F">=h)}e=D;break}}}}e>k?(f.value=d.string.substring(k,
e),k=e):k=-1}e=k;e=r(d,e);k=f;-1!=e&&"!important"===d.string.substring(e,e+10)&&(k.important=!0,e+=10);e=r(d,e);e<d.chars.length&&(e=w(d,e,";"));-1!=e&&(b[f.name]=f.value);b=e}}return c};Zb=function(a,c){var b=[];if(a)for(var d in a)a.hasOwnProperty(d)&&(c?b.push(d,":",a[d]," !important;"):b.push(d,":",a[d],";"));return b.join("")};rb=function(a,c){if(a&&Ya(a)&&Ya(c)){for(var b=0;;){b=a.indexOf(c,b);if(-1===b||0===b)break;var d=a.charAt(b-1);if(";"==d||" "==d)break;b++}if(-1!=b){for(b+=c.length;" "===
a.charAt(b);)b++;if(":"===a.charAt(b)){for(b++;" "===a.charAt(b);)b++;d=a.indexOf(";",b);-1===d&&(d=a.length);for(;d>b&&" "===a.charAt(d-1);)d--;return a.substring(b,d)}}}};Ia=function(){var a=arguments;if(1==a.length){a=a[0];if(Ya(a))a=Aa(a);else if(void 0===a.r||void 0===a.g||void 0===a.b)a=void 0;if(a)return Ia(a.r,a.g,a.b,a.a)}else if(3==a.length||4==a.length){var c=M(ma(a[0],0,255)),b=M(ma(a[1],0,255)),d=M(ma(a[2],0,255)),e=1;4==a.length&&void 0!==a[3]&&(e=ma(a[3],0,1));if(1!=e)return"rgba("+
c+","+b+","+d+","+e+")";c=c.toString(16);b=b.toString(16);d=d.toString(16);2>c.length&&(c="0"+c);2>b.length&&(b="0"+b);2>d.length&&(d="0"+d);return"#"+c+b+d}};Aa=function(d){if(d){var e,f;if(0===d.indexOf("#")){if(e={r:parseInt(d.substring(1,3),16),g:parseInt(d.substring(3,5),16),b:parseInt(d.substring(5,7),16),a:1},isNaN(e.b)){f=d.substring(1,2);var p=d.substring(2,3);d=d.substring(3,4);p+=p;d+=d;e.r=parseInt(f+f,16);e.g=parseInt(p,16);e.b=parseInt(d,16)}}else if(0===d.indexOf("rgba(")||0===d.indexOf("rgb(")){e=
d.replace(/[^\d.,]/g,"").split(",");for(f=0;f<e.length;f++)e[f]=Number(e[f]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);e={r:e[0],g:e[1],b:e[2],a:e[3]}}else if(0===d.indexOf("hsla(")||0===d.indexOf("hsl(")){e=d.replace(/[^\d.,]/g,"").split(",");for(f=0;f<e.length;f++)e[f]=Number(e[f]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);f=e[0];d=e[1];p=e[2];f/=360;d/=100;p/=100;if(0===d)p=d=f=255*p|0;else{var k=.5>p?p*(1+d):p+d-p*d,W=2*p-k,p=c(W,k,f+a);d=c(W,k,f);f=c(W,k,f-a)}e={r:p,g:d,
b:f,a:e[3]}}else if(f=b[d.toLowerCase()])return Aa(f);if(e)return e.r=ma(e.r,0,255),e.g=ma(e.g,0,255),e.b=ma(e.b,0,255),e.a=ma(e.a,0,1),e}};$b=function(a,c,b,d){1<b||(b=1);var e=Aa(a);c=Aa(c);if(!e||!c)return a;var f;!0===d?(a=(e.r+c.r*b)/(1+b),d=(e.g+c.g*b)/(1+b),f=(e.b+c.b*b)/(1+b),b=(e.a+c.a*b)/(1+b)):(c.a=1-e.a,a=e.r*e.a+c.r*c.a,d=e.g*e.a+c.g*c.a,f=e.b*e.a+c.b*c.a,b=1);return Ia(a,d,f,b)};xb=function(a){if(void 0!==a&&null!==a&&""!==a){var c=Number(a);if(!isNaN(c))return c+"px";if(a.match(/(\d|\.)+(em|ex|px|in|pt|pc|mm|cm|\%)/))return a}else return null}})();
var U;OIT.local||ob("local",{ADDED_COLUMN:"Inserted Column",ADDED_ROW:"Inserted Row",ADDED_SHEET:"Added Sheet",ANNO_CHANGE_FROM:"from",ANNO_CHANGE_TO:"to",ANNOTATIONS:"Annotations",ANNOTATION_TYPE:"Annotation Type",AUTHOR_A_TO_Z:"Author A-Z",AUTHOR_Z_TO_A:"Author Z-A",CANCEL:"Cancel",CHANGED_TEXT:"Changed Text",CLEAR_CELL:"Cleared Cell",COLUMN:"Column",COMMENT:"Comment",DEL:"DEL",DELETED_COLUMN:"Deleted Column",DELETED_ROW:"Deleted Row",DELETED_TEXT:"Deleted Text",DISCARD_CHANGES:"Discard changes",
DOCUMENT_ERROR:"Error occurred, document incomplete.",HIDDEN_SLIDE:"This slide is hidden in presentation mode",HIDDEN_TEXT:"Hidden Text",INSERTED_TEXT:"Inserted Text",LABEL_SEPARATOR:":",LOADING:"Loading",LOCATION:"Location",MODIFIED_CELL:"Modified Cell",MOVED_CELLS:"Moved Cells",NEW_CELL:"New Cell",NEWEST_FIRST:"Newest first",NO:"No",NO_SUBJECT:"(No Subject)",NOTES:"Notes",OK:"OK",OLDEST_FIRST:"Oldest first",PAGE_DOWN:"Next Page",PAGE_UP:"Previous Page",PLEASE_WAIT:"Please wait",PLEASE_WAIT_CONVERTING:"Document conversion in progress...",
PLEASE_WAIT_DOWNLOADING:"Loading document, please wait",PLEASE_WAIT_INITIALIZING:"Please wait while your<br>document is loaded...",PREPARING_TO_PRINT:"Preparing to print...",RENAMED_SHEET:"Renamed Sheet",ROW:"Row",SAVE_CHANGES:"Save changes",SHOWDETAILS:"Show Details",SORT_BY:"Sort by: ",HIDEDETAILS:"Hide Details",UNKNOWN_FIELD:"[Unknown Field]",UNSUPPORTED_CONTENT:"(Unsupported Content)",YES:"Yes",HIDDEN_CONTENT_HIDDEN:"Hidden content (Not Visible)",HIDDEN_CONTENT_PARTIAL:"Hidden content (Partially Visible)",
HIDDEN_CONTENT_VISIBLE:"Hidden content (Visible)",HIDDEN_CONTENT_NOTIFICATION:"This document contains hidden information:",HIDDEN_CONTENT_INVISIBLE:"These items are not currently visible in the viewer.",HIDDEN_CONTENT_SHOWLINK:"Show these items",HIDDEN_CONTENT_ALREADY_VISIBLE:"These items are already visible in the viewer.",HIDDEN_CONTENT_ORIGINAL_APPLICATION:"This document contains information that cannot be displayed in the browser. Open the document in the native application to view the full document content:",
HIDDEN_CONTENT_HIDELINK:"Hide these items",HIDDEN_CONTENT_ANNOTATIONS:"Annotations",HIDDEN_CONTENT_PAGES:"Hidden pages",HIDDEN_CONTENT_COLUMNS:"Hidden columns",HIDDEN_CONTENT_ROWS:"Hidden rows",HIDDEN_CONTENT_COMMENTS:"Comments",HIDDEN_CONTENT_SPEAKER_NOTES:"Speaker Notes",HIDDEN_CONTENT_SLIDES:"Hidden slides",HIDDEN_CONTENT_TEXT:"Hidden text",HIDDEN_CONTENT_TRACKED_CHANGES:"Tracked changes",HIDDEN_CONTENT_LARGE_SHEET:"The worksheet is larger than the browser can display",DOCUMENT_ERRORS:"Document Errors",
DOCUMENT_EXCEPTION_NOTIFICATION:"Errors were encountered while processing this document:",DOCEX_MISSING_MAP:"Some text could not be mapped to displayable characters",DOCEX_VERTICAL_TEXT:"Vertical text was present, but could not be displayed correctly",DOCEX_TEXT_EFFECTS:"Some text had unsupported text effects applied",DOCEX_UNSUPPORTED_COMPRESSION:"An embedded graphic used an unsupported compression",DOCEX_UNSUPPORTED_COLOR_SPACE:"An embedded graphic used an unsupported color space",DOCEX_FORMS:"Forms were present but could not be displayed correctly",
DOCEX_RIGHT_TO_LEFT_TABLES:"A table had right to left columns",DOCEX_ALIASED_FONT:"A required font was missing, but a font alias was used",DOCEX_MISSING_FONT:"A required font was not present on the system",DOCEX_SUBDOC_FAILED:"Part of the document could not be converted",DOCEX_TYPE_THREE_FONT:"An unsupported font was required by the document",DOCEX_UNSUPPORTED_SHADING:"The document used an unsupported shading type",DOCEX_INVALID_HTML:"Invalid HTML was encountered",DOCEX_VECTOR_OBJECT_LIMIT:"Not all of the vector objects could be displayed",
DOCEX_INVALID_ANNOTATIONS_NOT_APPLIED:"An invalid annotation could not be applied",DOCEX_INLINE_IMAGE_FOUND:"An embedded graphic could not be rendered",EMAIL_TO:"To",EMAIL_CC:"CC",EMAIL_BCC:"BCC",EMAIL_SUBJECT:"Subject",EMAIL_MSGFLAG:"Message Flag",EMAIL_FLAGSTS:"Flag Status",EMAIL_EXPIRES:"Expires",EMAIL_CATEGORIES:"Categories",EMAIL_IMPORTANCE:"Importance",EMAIL_SENSITIVITY:"Sensitivity",EMAIL_LOCATION:"Location",EMAIL_FULLNAME:"Full Name",EMAIL_JOBTITLE:"Job Title",EMAIL_COMPANY:"Company",EMAIL_EMAIL:"Email",
EMAIL_WEBPAGE:"Webpage",EMAIL_WORKPHONE:"Work Telephone",EMAIL_HOMEPHONE:"Telephone",EMAIL_FROM:"From",EMAIL_ATTACHMENT:"Attachments",EMAIL_RTFBODY:"RTF Embedded Body",EMAIL_RECEIVED:"Received",EMAIL_SIZE:"Size",EMAIL_LASTMODIFIED:"Last Modified",EMAIL_NEWSGROUPS:"Newsgroups",EMAIL_SUBMITTIME:"Submit Time",EMAIL_CCME:"CC Me",EMAIL_ALTERNATE_RECIPIENT_ALLOWED:"Alternate Recipient Allowed",EMAIL_CLIENT_SUBMIT_TIME:"Sent",EMAIL_CREATION_TIME:"Created",EMAIL_CONVERSATION_INDEX:"Conversation Index",EMAIL_CONVERSATION_TOPIC:"Topic",
EMAIL_MESSAGE_SUBMISSION_ID:"Message Submission ID",EMAIL_MESSAGE_CLASS:"Message Class",EMAIL_ORIGINATOR_DELIVERY_REPORT_REQUESTED:"Originator Delivery Report Requested",EMAIL_READ_RECEIPT_REQUESTED:"Read Receipt Requested",EMAIL_RCVD_REPRESENTING_ADDRTYPE:"Received Representing Address Type",EMAIL_RCVD_REPRESENTING_EMAIL_ADDRESS:"Received Representing Email",EMAIL_RCVD_REPRESENTING_ENTRYID:"Received Representing Entry ID",EMAIL_RCVD_REPRESENTING_NAME:"Received Representing Name",EMAIL_RCVD_REPRESENTING_SEARCH_KEY:"Received Representing Search Key",
EMAIL_RECEIVED_BY_ADDRTYPE:"Received By Address Type",EMAIL_RECEIVED_BY_EMAIL_ADDRESS:"Received By Email",EMAIL_RECEIVED_BY_ENTRYID:"Received By Entry ID",EMAIL_RECEIVED_BY_NAME:"Received By Name",EMAIL_RECEIVED_BY_SEARCH_KEY:"Received By Search Key",EMAIL_RTF_IN_SYNC:"RTF In Sync",EMAIL_RTF_SYNC_BODY_COUNT:"RTF Sync Body Count",EMAIL_RTF_SYNC_BODY_CRC:"RTF Sync Body CRC",EMAIL_RTF_SYNC_BODY_TAG:"RTF Sync Body Tag",EMAIL_RTF_SYNC_PREFIX_COUNT:"RTF Sync Prefix Count",EMAIL_RTF_SYNC_TRAILING_COUNT:"RTF Sync Trailing Count",
EMAIL_SEARCH_KEY:"Search Key",EMAIL_SENDER_ADDRTYPE:"Sender Address",EMAIL_SENDER_EMAIL_ADDRESS:"Sender Email",EMAIL_SENDER_ENTRYID:"Sender Entry ID",EMAIL_SENDER_NAME:"Sender Name",EMAIL_SENDER_SEARCH_KEY:"Sender Search Key",EMAIL_SENT_REPRESENTING_ADDRTYPE:"Sent Representing Addr Type",EMAIL_SENT_REPRESENTING_EMAIL_ADDRESS:"Sent Representing Email",EMAIL_SENT_REPRESENTING_ENTRYID:"Sent Representing Entry ID",EMAIL_SENT_REPRESENTING_SEARCH_KEY:"Sent Representing Search Key",EMAIL_TRANSPORT_MESSAGE_HEADERS:"Transport Message Headers",
EMAIL_PRIORITY:"Priority",EMAIL_AUTO_FORWARDED:"Auto Forwarded",EMAIL_DEFERRED_DELIVERY_TIME:"Deferred Delivery Type",EMAIL_EXPIRY_TIME:"Expiry Time",EMAIL_LATEST_DELIVERY_TIME:"Latest Delivery Time",EMAIL_RECIPIENT_REASSIGNMENT_PROHIBITED:"Recipient Reassignment Prohibited",EMAIL_REPLY_TIME:"Reply Time",EMAIL_REPORT_TAG:"Report Tag",EMAIL_RESPONSE_REQUESTED:"Response Requested",EMAIL_REPLY_REQUESTED:"Reply Requested",EMAIL_DELETE_AFTER_SUBMIT:"Delete After Submit",EMAIL_MESSAGE_LOCALE_ID:"Message Locale ID",
EMAIL_CREATOR_NAME:"Creator Name",EMAIL_CREATOR_ENTRYID:"Creator Entry ID",EMAIL_LAST_MODIFIER_NAME:"Last Modifier Name",EMAIL_LAST_MODIFIER_ENTRYID:"Last Modifier Entry ID",EMAIL_INTERNET_ARTICLE_NUMBER:"Internet Artical Number",EMAIL_NT_SECURITY_DESCRIPTOR:"NT Security Descriptor",EMAIL_TRUST_SENDER:"Trust Sender",EMAIL_INTERNET_MESSAGE_ID:"Internet Message ID",EMAIL_ATTR_HIDDEN:"Hidden",EMAIL_ATTR_SYSTEM:"System",EMAIL_ATTR_READONLY:"Read Only",EMAIL_INTERNET_CPID:"Internet CPID",EMAIL_MESSAGE_CODEPAGE:"Message Codepage",
EMAIL_SENDER_FLAGS:"Sender Flags",EMAIL_SENT_REPRESENTING_FLAGS:"Sent Representing Flags",EMAIL_RCVD_BY_FLAGS:"Recived By Flags",EMAIL_RCVD_REPRESENTING_FLAGS:"Received Representing Flags",EMAIL_INET_MAIL_OVERRIDE_FORMAT:"Internet Mail Override Format",EMAIL_MSG_EDITOR_FORMAT:"MSG Editor Format",EMAIL_PROFILE_CONNECT_FLAGS:"Profile Connect Flags",EMAIL_SENT_REPRESENTING_NAME:"Sent Representing Name",EMAIL_ENTRYID:"Entry ID",EMAIL_NORMALIZED_SUBJECT:"Normalized Subject",EMAIL_ATTENDEES:"Attendees",
EMAIL_REQATTENDEE:"Required Attendees",EMAIL_OPTATTENDEE:"Optional Attendees",EMAIL_FILEAS:"File as",EMAIL_DISPLAYAS:"Display As (E-mail)",EMAIL_TITLE:"Title",EMAIL_SUFFIX:"Suffix",EMAIL_NICKNAME:"Nickname",EMAIL_PROFESSION:"Profession",EMAIL_DEPARTMENT:"Department",EMAIL_OFFICE:"Office",EMAIL_ANNIVERSARY:"Anniversary",EMAIL_BIRTHDATE:"Birth date",EMAIL_ASSISTANTSNAME:"Assistant's Name",EMAIL_SPOUSESNAME:"Spouse's Name",EMAIL_MANAGERSNAME:"Manager's Name",EMAIL_BUSINESSADDRESS:"Business Address",
EMAIL_BUSINESSPHONE:"Telephone",EMAIL_HOMEADDRESS:"Home Address",EMAIL_OTHERADDRESS:"Other Address",EMAIL_MOBILEPHONE:"Mobile",EMAIL_BUSINESSFAX:"Fax",EMAIL_IMADDRESS:"IM",EMAIL_INTERNETFREEBUSYADDR:"Internet Free Busy Address",EMAIL_REMINDERTOPIC:"Reminder Topic",EMAIL_CONTACTS:"Contacts",EMAIL_CALLBACKPHONE:"Callback Telephone",EMAIL_FIRST:"First",EMAIL_FAMILY:"Last",EMAIL_TELENUMBER:"Telephone",EMAIL_BUSINESSPHONE2:"Telephone 2",EMAIL_RADIOPHONE:"Radio Telephone",EMAIL_CARPHONE:"Car Telephone",
EMAIL_OTHERPHONE:"Telephone",EMAIL_PAGERPHONE:"Pager",EMAIL_OTHERFAX:"Fax",EMAIL_HOMEFAX:"Fax",EMAIL_TELEXPHONE:"Telex Telephone",EMAIL_ISDN:"ISDN Telephone",EMAIL_ASSISTANTPHONE:"Assistant Telephone",EMAIL_HOMEPHONE2:"Telephone 2",EMAIL_MIDDLE:"Middle",EMAIL_TTYTTDPHONE:"TTY/TTD Telephone",EMAIL_GENDER:"Gender",EMAIL_PERSONALHOMEPAGE:"Personal Home Page",EMAIL_COMPANYPHONE:"Company Telephone",EMAIL_HOMECITY:"City",EMAIL_HOMECOUNTRY:"Country",EMAIL_POSTALCODE:"Postal Code",EMAIL_HOMESTATE:"State",
EMAIL_HOMESTREET:"Street",EMAIL_HOMEPOBOX:"PO Box",EMAIL_OTHERCITY:"City",EMAIL_OTHERCOUNTRY:"Country",EMAIL_OTHERPOSTALCODE:"Postal Code",EMAIL_OTHERSTATE:"State",EMAIL_OTHERSTREET:"Street",EMAIL_OTHERPOBOX:"PO Box",EMAIL_BUSINESSSTREET:"Street",EMAIL_BUSINESSCITY:"City",EMAIL_BUSINESSSTATE:"State",EMAIL_BUSINESSPOSTALCODE:"Postal Code",EMAIL_BUSINESSCOUNTRY:"Country",EMAIL_BUSINESSPOBOX:"PO Box",EMAIL_DISPLAYAS2:"Display As (E-mail 2)",EMAIL_EMAIL2:"Email 2",EMAIL_DISPLAYAS3:"Display As (E-mail 3)",
EMAIL_EMAIL3:"Email 3",EMAIL_DTSTART:"Start Time",EMAIL_DTEND:"End Time",EMAIL_START:"Start",EMAIL_DURATION:"Duration",EMAIL_ACCUREATTYPE1:"Accurate Type 1",EMAIL_ENTRY_TYPE:"Entry Type",EMAIL_STATUS:"Status",EMAIL_PERCENT_COMPLETE:"Percent Complete",EMAIL_START_DATE:"Start Date",EMAIL_DUE_DATE:"Due Date",EMAIL_COMPLETED:"Completed",EMAIL_ACTUALWORK:"Actual Work",EMAIL_TOTAL_WORK:"Total Work",EMAIL_OWNER:"Owner",EMAIL_BILLING:"Billing",EMAIL_MILEAGE:"Mileage",EMAIL_PROOF_OF_DELIVERY_REQUESTED:"Proof of Delivery Requested",
EMAIL_PROOF_OF_SUBMISSION_REQUESTED:"Proof of Submission Requested",EMAIL_IN_REPLY_TO_ID:"In Reply To ID",EMAIL_TASK_COMPLETE:"Task Complete",EMAIL_APPOINTMENT_DURATION:"Appointment Duration",EMAIL_RECURRENCE_TYPE:"Recurrence Type",EMAIL_RECURRENCE_RANGE:"Recurrence Range",EMAIL_ORGANIZER:"Organizer",EMAIL_CALENDAR_EXCEPTION:"Calendar Exceptions",EMAIL_RSVP:"RSVP",EMAIL_ROLE:"Role",EMAIL_ATTENDEE:"Attendee",EMAIL_ADDRESS:"Address",EMAIL_POBOX:"PO Box",EMAIL_EXTADDRESS:"Ext Address",EMAIL_STREET:"Street",
EMAIL_CITY:"City",EMAIL_REGION:"Region",EMAIL_COUNTRY:"Country",EMAIL_TYPE:"Type",EMAIL_NAME:"Name",EMAIL_LOGO:"Logo",EMAIL_PHOTO:"Photo",EMAIL_ALARM:"Alarm",EMAIL_DESCRIPTION:"Description",EMAIL_DATE:"Date"});U=OIT.local;var Ja,eb,jc=598,Tb=599;(function(){var b=[],e=Date.now(),a=function(a){return ab(b,"request",a)},d=function(c){var b=a(this);if(!b)throw"request.start(): Invalid request object";if(!b.aborted){if(void 0!==this.status)throw"request.start(): Request is already completed";if("number"!==
typeof c||0>c)throw"request.start(): fileSize must be a non-negative integer indicating the total size of the requested file in bytes";if(void 0!==b.contentLength)throw"request.start(): start should only be called once per request";b.contentLength=c;l(b,"")}},c=function(c){var b=a(this);if(!b)throw"request.loading(): Invalid request object";if(!b.aborted){if(void 0!==this.status)throw"request.loading(): Request is already completed";if("string"!==typeof c)throw"request.loading(): responseText must be a string containing the partial or complete contents of the requested file";
if(void 0!==this.contentLength&&c.length>this.contentLength)throw"request.loading(): responseText length must not exceed the size specified to request.start";b.responseText=c;void 0!==b.contentLength&&l(b,c)}},f=function(c){var d=a(this);if(!d)throw"request.done(): Invalid request object";if(!d.aborted){if("number"!==typeof c||0>=c)throw"request.done(): status must be a positive integer HTTP status code";if(0===c)d.timeout=!0;else if(200===c){if(void 0===d.responseText)throw"request.done(): request.loading() was never called";
if(void 0!==d.contentLength&&d.responseText.length!==d.contentLength)throw"request.done(): responseText length must be equal to the contentLength passed in to request.start()";}Object.defineProperty(this,"status",{value:c});d.contentLength=d.responseText.length;Object.defineProperty(this,"responseText",{value:d.responseText});Fa(b,d);n(d)}},k=function(){var c=a(this);if(!c)throw"request.abort(): Invalid request object";c.aborted=!0;n(c)},t=function(a,e){var p={};Object.defineProperties(p,{url:{value:a},
start:{value:d},loading:{value:c},done:{value:f},abort:{value:k}});e.request=p;e.isLocal=!0;b.push(e);return p},r=function(a){a.inDispatch=!0;E.on.ajax.dispatch(a.request);a.inDispatch=!1},w=function(a,c){var b=a[c];if(b){var d=Array.prototype.slice.call(arguments,2);a.args&&(d=d.concat(a.args));b.apply(a.context,d)}},n=function(a){var c="unknown"!=typeof a.request.responseText?a.request.responseText:void 0,b=a.request.status;0===b||a.aborted?(b=jc,a.aborted=!0,E.on.ajax.hasListeners()&&E.on.ajaxabort.hasListeners()&&
E.on.ajaxabort.dispatch(this)):a.timeout&&(b=Tb);a.contentLength=c.length;200===b?w(a,"success",a.url,a.contentLength,c,b):w(a,"error",a.url,a.contentLength,c,b);w(a,"complete",a.url,a.contentLength,c,b)},l=function(a,c){w(a,"loading",a.url,a.contentLength,c)};Ja=function(a){var c=a.url,d;if("string"===typeof c&&0<c.length){var f={context:null},p;for(p in a)f[p]=a[p];E.on.ajax.hasListeners()?(t(c,f),ea(r,0,null,f),d=f):K.XMLHttpRequest&&(f.request=new XMLHttpRequest,!1===a.cache&&(c=-1!=c.indexOf("?")?
c+"&":c+"?",++e,c+="_="+e),f.request.onreadystatechange=function(){if(!f.aborted)switch(f.request.readyState){case 2:f.contentLength=Number(f.request.getResponseHeader("Content-Length"));l(f,"");break;case 3:l(f,"unknown"!=typeof f.request.responseText?f.request.responseText:void 0);break;case 4:n(f),Fa(b,f)}},f.request.ontimeout=function(){f.timeout=!0;n(f)},f.request.open("GET",c,!0),f.request.send(),b.push(f),d=f)}return d};var u=function(a){a.aborted=!0;a.request&&a.request.abort()};eb=function(a){a?
(Fa(b,a),u(a)):(oa(b,u),b=[])}})();var M=function(b,e){return e&&1<e?Math.round(b*e)/e:Math.floor(0>b?b-.5:b+.5)},ma=function(b,e,a){b<e?b=e:b>a&&(b=a);return b},Ub=function(b,e,a,d){if(b==a&&e==d)return 0;b=a-b;e=d-e;return M(Math.sqrt(b*b+e*e))},Wb=function(b,e){if("deg"===e)b%=360,0>b&&(b+=360);else{var a=Math.PI,d=2*a;b%=d;b<-a?b+=d:b>a&&(b-=d)}return b},ac=function(b,e,a){void 0===a&&(a=1.01);return(b>e?Math.abs(b/e):Math.abs(e/b))<=a},bc,sb,Pa,ea,ua,kb,Xb;(function(){for(var b=[],e=[],a=[],
d=K.requestAnimationFrame,c=K.cancelAnimationFrame,f=0,k=["ms","moz","webkit","o"],t=0;t<k.length&&!d;++t)d=K[k[t]+"RequestAnimationFrame"],c=K[k[t]+"CancelAnimationFrame"]||K[k[t]+"CancelRequestAnimationFrame"];d||(d=function(a){var c=(new Date).getTime(),b=Math.max(0,16-(c-f)),d=K.setTimeout(function(){a(c+b)},b);f=c+b;return d});c||(c=function(a){K.clearTimeout(a)});bc=function(){var d;for(d=0;d<b.length;d++)K.clearInterval(b[d].id);b=[];for(d=0;d<e.length;d++)K.clearTimeout(e[d].id);e=[];for(d=
0;d<a.length;d++)c.call(K,a[d].id);a=[]};var r=function(a,c,b,d){var e=0;d={fn:a[e++],remove:!!d};c&&(d.timeout=a[e++]);d.context=a[e++];b&&(d.args=[0],d.ts=!0);a.length>e&&(a=Array.prototype.slice.call(a,e),d.args=d.args?d.args.concat(a):a);return d},w=function(a,c,b){try{a.remove&&Fa(c,a),a.ts&&(a.args[0]=b),a.fn.apply(a.context,a.args)}catch(p){K.OILogDebugError&&K.OILogDebugError("Error in asynchronous timer function: "+p.message)}};sb=function(a,c,d){var e=r(arguments,!0,!1,!1);b.push(e);e.id=
K.setInterval(function(){w(e,b)},e.timeout);return e.id};Pa=function(a){K.clearInterval(a);yb(b,"id",a)};ea=function(a,c,b){var d=r(arguments,!0,!1,!0);e.push(d);d.id=K.setTimeout(function(){w(d,e)},c);return d.id};ua=function(a){K.clearTimeout(a);yb(e,"id",a)};kb=function(c,b){for(var e,f=0;f<a.length;f++)if(e=a[f],e.fn===c&&e.context===b)return e.id;e=r(arguments,!1,!0,!0);a.push(e);e.id=d.call(K,function(c){w(e,a,c)});return e.id};Xb=function(b){c.call(K,b);yb(a,"id",b)};Ua.install.listen(function(){E.onreset(function(){bc();
b=[];e=[];a=[]})})})();var Ka,jb,Ib,La,Za,Oa,Qa,va,rc,Ma,bb,oa,zb,sc,lb,tc,uc,Fa,yb,ab,cc,Hb,Ab,vc,wc,Jb,xc,Sa,yc,zc,Ac,oc,pc;(function(){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,a=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/,
d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,c=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
f=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,k=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},r=Math.pow(2,53),w="oit-emhdrvalue oit-emhdrlabel oit-emhdrsection oit-email oit-rt oit-sn oit-comment-text oit-comment-date oit-comment-author oit-anno-text oit-anno-date oit-anno-author oit-overlay".split(" ");Ka=function(a){for(a=y.unwrap(a);a&&!y.isElement(a);)a=a.parentNode;var c;a&&(a=y.wrap(a),c=a.hasClass(w)?a:a.ancestorByClass(w));return c?c:null};jb=function(a){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()};
Ib=function(a,c,b){var d=a.indexOf(":");if(0<d){var e=Ib(a.slice(0,d),c,b);a=Ib(a.slice(d+1),c,b);e.c2=a.c1;e.r2=a.r1;return e}var e=!1,d=0,f=!1,h=0,k=0,g=a.length,l=a.charCodeAt(k);k<g&&36==l&&(e=!0,k++,l=a.charCodeAt(k));for(!1===(k<g&&65<=l&&90>=l)&&(f=e);k<g&&65<=l&&90>=l;)d=26*d+(l-65+1),k++,l=a.charCodeAt(k);k<g&&36==l&&(f=!0,k++,l=a.charCodeAt(k));for(;k<g&&48<=l&&57>=l;)h=10*h+(l-48),k++,l=a.charCodeAt(k);0<d&&d--;0<h&&h--;!e&&c&&(d+=c);!f&&b&&(h+=b);return sa(d,h,d,h)};La=function(a){if("number"==
typeof a&&!(0>a)){if(26>a)return b[a];var c=a%26,d=(a-c)/26-1;if(702>a)return b[d]+b[c];a=Math.floor(d);d=a%26;return b[(a-d)/26-1]+b[d]+b[c]}};Za=function(a){if("number"==typeof a&&!(0>a))return(a+1).toString()};Oa=function(a){return"[object Function]"==Object.prototype.toString.call(a)};Qa=function(a){return a&&void 0!==a.startContainer&&void 0!==a.startOffset&&void 0!==a.endContainer&&void 0!==a.endOffset?!0:!1};va=function(a){return a&&void 0!==a.anchorNode&&void 0!==a.anchorOffset&&void 0!==
a.focusNode&&void 0!==a.focusOffset?!0:!1};rc=function(a){return!/^(?:[a-z]+:)?\/\//i.test(a)};Ma=function(a,c){return a&&0!==a.length?c&&0!==c.length?"/"==a.charAt(a.length-1)?"/"==c.charAt(0)?a+c.substr(1):a+c:"/"==c.charAt(0)?a+c:a+"/"+c:a:c};bb=function(a){var c;if(Array.isArray(a)){c=[];for(var b=0;b<a.length;b++)c[b]=bb(a[b])}else{if(Oa(a))return null;if(null===a)c=null;else switch(typeof a){case "object":c={};for(b in a)a.hasOwnProperty(b)&&!Oa(a[b])&&(c[b]=bb(a[b]));break;case "string":c=
new String(a);break;case "number":case "boolean":case "undefined":c=a}}return c};oa=function(a,c,b){n(!1,!1,null,arguments)};zb=function(a,c){n(!1,!1,a,c)};sc=function(a,c,b){n(!1,!0,null,arguments)};lb=function(a,c,b){n(!0,!1,null,arguments)};tc=function(a,c){n(!0,!1,a,c)};var n=function(a,c,b,d){var e=0;b||(b=d[e++]);if(b&&(a||0<b.length)){var f,h=d[e++],k=d[e++],g="string"==typeof h;g||e--;d=d.length>e?Array.prototype.slice.call(d,e):void 0;g?e=u:(e=l,d||(d=[null]));if(a)for(f in b)b.hasOwnProperty(f)&&
e(b[f],h,k,d);else if(c?(f=b.length-1,c=a=-1):(f=0,a=b.length,c=1),b.item)for(;f!=a;f+=c)e(b.item(f),h,k,d);else for(;f!=a;f+=c)e(b[f],h,k,d)}},l=function(a,c,b,d){null===a||void 0===a||null!==b&&void 0!==b&&!a.filter(b)||(d[0]=a,c.apply(null,d))},u=function(a,c,b,d){a&&(null===b||void 0===b||a.filter(b))&&a[c].apply(a,d)};uc=function(a,c,b){if(a===c)return!0;if(null===a||void 0===a)return null===c||void 0===c;if(null===c||void 0===c||"[object Array]"!==Object.prototype.toString.call(a)||"[object Array]"!==
Object.prototype.toString.call(c)||a.length!=c.length)return!1;for(var d=0;d<a.length;d++)if(a[d]!==c[d])if(!0===b){if(JSON.stringify(a[d])!==JSON.stringify(c[d]))return!1}else return!1;return!0};Fa=function(a,c){var b=a.indexOf(c);-1!=b&&a.splice(b,1)};yb=function(a,c,b){c=cc(a,c,b);-1!=c&&a.splice(c,1)};ab=function(a,c,b){c=cc(a,c,b);if(-1!=c)return a[c]};cc=function(a,c,b){if(Array.isArray(a)&&"string"===typeof c)for(var d=0;d<a.length;d++){var e=a[d];if(e&&e[c]===b)return d}return-1};Hb=function(a){return Qa(a)?
"[DOM Range]":va(a)?"[DOM Selection]":y.isElement(a)?y.unwrap(a).outerHTML:y.isText(a)?'"'+a.textContent+'"':JSON.stringify(a)};Ab=function(a){a&&(a=a.replace(/[&<>"']/g,function(a){return t[a]}));return a};var p;a:{try{(new Date).toLocaleDateString("i")}catch(J){p="RangeError"===J.name;break a}p=!1}vc=function(c){if(p&&(c.match(e)||c.match(a)))try{c=(new Date(c)).toLocaleDateString()}catch(W){}return c};wc=function(c){if(p&&(c.match(e)||c.match(a)))try{c=(new Date(c)).toLocaleTimeString()}catch(W){}return c};
Jb=function(c){if(p&&(c.match(e)||c.match(a)))try{c=(new Date(c)).toLocaleString()}catch(W){}return c};xc=function(a){1073741824<a?(a=Math.floor(a/1073741824*10)/10,a=""+a+" GB"):1048576<a?(a=Math.floor(a/1048576*10)/10,a=""+a+" MB"):1024<a?(a=Math.floor(a/1024*10)/10,a=""+a+" KB"):a=""+Math.floor(a)+" B";return a};Sa=function(){if(v.isMobileOrTablet){var a=A.activePage();if(a){var c=y.create("div");a.append(c);ea(function(){c.destroy()},10)}}};yc=function(a){for(var c=a.css("width"),b=1,d=r;b<d;){var e=
Math.ceil((b+d)/2);a.css("width",e+"px");a.clientWidth!=e?d=e-1:b=e}a.css("width",c);return b};zc=function(a){for(var c=a.css("height"),b=1,d=r;b<d;){var e=Math.ceil((b+d)/2);a.css("height",e+"px");a.clientHeight!=e?d=e-1:b=e}a.css("height",c);return b};Ac=function(a){var c=!1;switch(a){case "firefox":c=-1!=navigator.userAgent.toLowerCase().indexOf("firefox")}return c};oc=function(){var a=!1,b=navigator.userAgent||navigator.vendor||K.opera;if(d.test(b)||c.test(b.substr(0,4)))a=!0;return a};pc=function(){var a=
!1,c=navigator.userAgent||navigator.vendor||K.opera;if(f.test(c)||k.test(c.substr(0,4)))a=!0;return a}})();var Bc=function(){function b(){}function e(){console.log(Array.prototype.slice.call(arguments).join(" "))}var a={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},d={icate:"ic",ative:"",alize:"al",
iciti:"ic",ical:"ic",ful:"",ness:""};return function(c,f){var k,t,r,w,n,l;l=f?e:b;if(3>c.length)return c;r=c.substr(0,1);"y"==r&&(c=r.toUpperCase()+c.substr(1));w=/^(.+?)(ss|i)es$/;t=/^(.+?)([^s])s$/;w.test(c)?(c=c.replace(w,"$1$2"),l("1a",w,c)):t.test(c)&&(c=c.replace(t,"$1$2"),l("1a",t,c));w=/^(.+?)eed$/;t=/^(.+?)(ed|ing)$/;w.test(c)?(t=w.exec(c),w=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,w.test(t[1])&&(w=/.$/,c=c.replace(w,""),l("1b",w,c))):t.test(c)&&(t=t.exec(c),k=t[1],t=/^([^aeiou][^aeiouy]*)?[aeiouy]/,
t.test(k)&&(c=k,l("1b",t,c),t=/(at|bl|iz)$/,n=/([^aeiouylsz])\1$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,t.test(c)?(c+="e",l("1b",t,c)):n.test(c)?(w=/.$/,c=c.replace(w,""),l("1b",n,c)):k.test(c)&&(c+="e",l("1b",k,c))));w=/^(.*[aeiouy].*)y$/;w.test(c)&&(t=w.exec(c),k=t[1],c=k+"i",l("1c",w,c));w=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;w.test(c)&&(t=w.exec(c),k=t[1],t=t[2],w=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
w.test(k)&&(c=k+a[t],l("2",w,c)));w=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;w.test(c)&&(t=w.exec(c),k=t[1],t=t[2],w=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,w.test(k)&&(c=k+d[t],l("3",w,c)));w=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;t=/^(.+?)(s|t)(ion)$/;w.test(c)?(t=w.exec(c),k=t[1],w=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,w.test(k)&&(c=k,l("4",w,c))):t.test(c)&&(t=t.exec(c),
k=t[1]+t[2],t=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,t.test(k)&&(c=k,l("4",t,c)));w=/^(.+?)e$/;w.test(c)&&(t=w.exec(c),k=t[1],w=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,t=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,n=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,w.test(k)||t.test(k)&&!n.test(k))&&(c=k,l("5",w,t,n,c));w=/ll$/;t=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;
w.test(c)&&t.test(c)&&(w=/.$/,c=c.replace(w,""),l("5",w,t,c));"y"==r&&(c=r.toLowerCase()+c.substr(1));return c}}(),Cc={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u1ea4":"A","\u1eae":"A","\u1eb2":"A","\u1eb4":"A","\u1eb6":"A","\u1ea6":"A","\u1eb0":"A","\u0202":"A","\u00c7":"C","\u1e08":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u1ebe":"E","\u1e16":"E","\u1ec0":"E","\u1e14":"E","\u1e1c":"E","\u0206":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I",
"\u1e2e":"I","\u020a":"I","\u00d0":"D","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u1ed0":"O","\u1e4c":"O","\u1e52":"O","\u020e":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u1ea5":"a","\u1eaf":"a","\u1eb3":"a","\u1eb5":"a","\u1eb7":"a","\u1ea7":"a","\u1eb1":"a","\u0203":"a","\u00e7":"c","\u1e09":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e",
"\u1ebf":"e","\u1e17":"e","\u1ec1":"e","\u1e15":"e","\u1e1d":"e","\u0207":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u1e2f":"i","\u020b":"i","\u00f0":"d","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u1ed1":"o","\u1e4d":"o","\u1e53":"o","\u020f":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00ff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C",
"\u0109":"c","\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0110":"D","\u0111":"d","\u0112":"E","\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u01f4":"G","\u011d":"g","\u01f5":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H","\u0125":"h","\u0126":"H","\u0127":"h","\u1e2a":"H","\u1e2b":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i",
"\u012c":"I","\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u1e30":"K","\u1e31":"k","\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u013f":"L","\u0140":"l","\u0141":"l","\u0142":"l","\u1e3e":"M","\u1e3f":"m","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0149":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0154":"R","\u0155":"r",
"\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","\u0212":"R","\u0213":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s","\u015e":"S","\u0218":"S","\u0219":"s","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u021b":"t","\u021a":"T","\u0164":"T","\u0165":"t","\u0166":"T","\u0167":"t","\u0168":"U","\u0169":"u","\u016a":"U","\u016b":"u","\u016c":"U","\u016d":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0216":"U","\u0217":"u","\u0174":"W",
"\u0175":"w","\u1e82":"W","\u1e83":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u017f":"s","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U","\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u","\u01d9":"U","\u01da":"u","\u01db":"U","\u01dc":"u","\u1ee8":"U","\u1ee9":"u","\u1e78":"U","\u1e79":"u","\u01fa":"A",
"\u01fb":"a","\u01fe":"O","\u01ff":"o","\u1e54":"P","\u1e55":"p","\u1e64":"S","\u1e65":"s","\u0403":"\u0413","\u0453":"\u0433","\u040c":"\u041a","\u045c":"\u043a","\u1ed2":"O","\u1ed3":"o","\u1e50":"O","\u1e51":"o","\u1eea":"U","\u1eeb":"u","\u1e80":"W","\u1e81":"w","\u1ef2":"Y","\u1ef3":"y","\u0200":"A","\u0201":"a","\u0204":"E","\u0205":"e","\u0208":"I","\u0209":"i","\u020c":"O","\u020d":"o","\u0210":"R","\u0211":"r","\u0214":"U","\u0215":"u","\u01e6":"G","\u01e7":"g","\u021e":"H","\u021f":"h",
"\u01e8":"K","\u01e9":"k","\u1e66":"S","\u1e67":"s","\u1e10":"D","\u1e11":"d","\u0228":"E","\u0229":"e","\u1e28":"H","\u1e29":"h"},Uc=Object.keys(Cc).join("|"),Vc=new RegExp(Uc,"g"),dc=function(b){return b.replace(Vc,function(b){return Cc[b]})},Dc=ta.extend("fonts",{events:{fontload:{}},install:function(b){var e=["serif","sans-serif","monospace","cursive","fantasy"],a={},d=0,c;b.loadWebFont=function(b){var e=a[b];if(void 0===e){var k=v.rootNode;if(k){e=y.create("div","oit-fontpreloader");e.css("font-family",
b);var w=y.create("span");e.append(w);w.html("AEIMNOTaeimnot130");k.append(e);a[b]=e}d=0;c||(c=ea(f,250))}};var f=function(){var k=!1,t=!1,r,w;c=void 0;for(r in a)if((w=a[r])&&!0!==w){for(var n=!0,l,u=0;u<e.length;u++){w.css("font-family",r+","+e[u]);var p=w.offsetWidth;if(0<u&&p!=l){n=!1;break}l=p}n?(w.destroy(),t=a[r]=!0):(w.css("font-family",r),k=!0)}if(k)if(d++,20>d)c=ea(f,250);else for(r in a)(w=a[r])&&!0!==w&&(w.destroy(),a[r]=!1);t?b.on.fontload.dispatch():0===d%2&&b.on.fontload.dispatch()};
E.onreset(function(){for(var b in a){var e=a[b];e&&!0!==e&&e.destroy()}a=[];d=0;c=void 0})}}),la=ta.extend("view",{exports:"attach detach fitToContainer height info stage load unload width hasFeature".split(" "),events:{resize:{delay:80},detach:{},update:{}},install:function(b){var e,a=0,d,c,f,k,t={},r,w=0,n=0,l,u,p,J,W,T,G;b.hasFeature=function(a){var c=!1;switch(a){case "string":case "dtsearch":case "lucene":case "phsterms":case "literal":case "literal*":case "enhancedhighlight":c=!0}return c};
var Q=function(){r&&(r.hide(),r=null)};b.dispatchResize=function(){var a=v.viewNode;a&&(f&&D(),d!=a.clientWidth||c!=a.clientHeight)&&(d=a.clientWidth,c=a.clientHeight,b.on.resize.dispatch())};var D=function(){if(f){var a=f.computedStyle(),c=f.offsetWidth-parseInt(a.borderLeftWidth,10)-parseInt(a.borderRightWidth,10),a=f.offsetHeight-parseInt(a.borderTopWidth,10)-parseInt(a.borderBottomWidth,10);v.rootNode.css({width:c+"px",height:a+"px"})}};b.dispatchScroll=function(a){var c=v.viewNode;if(c&&(b.invalidateCanvas(),
E.on.scrollupdate.dispatch(),c=c.scroll(),a||c.left!=n||c.top!=w)){a=c.left-n;var d=c.top-w;n=c.left;w=c.top;E.on.scroll.dispatch(a,c.left,d,c.top)}};var h=function(){},z=function(){},g=function(){x.nochrome?v.viewNode.addClass("oit-nochrome"):v.viewNode.removeClass("oit-nochrome")},m=function(){var c=v.rootNode;c&&(c.addClass("oit-view-root"),c=v.viewNode,c||(c=y.attach(y.create("div","oit-view")),v.viewNode=c),e="oitview"+a++,c.id=e,g(),c.attr("tabindex","-1"),c.onscroll(b.dispatchScroll),b.fitToContainer());
K.matchMedia&&(c=K.matchMedia("print"))&&c.addListener(function(a){});K.addEventListener("beforeprint",h);K.addEventListener("afterprint",z);K.addEventListener("resize",b.dispatchResize)};Ua.init.listen(function(){var a=v.rootNode;if(a){var c=a.data("json"),b=a.data("icd"),d=a.data("page");if(c||b)k=a.parent();m();ia.initializeContent(c,b,d);E.initializeDocument()}});b.attach=function(a){a&&a!==y.unwrap(f)&&(b.detach(),f=y.wrap(a),a=v.rootNode,a||(a=v.rootNode=y.attach(y.create("div"))),a.addClass("oit-view-embedded"),
f.append(a),m())};b.detach=function(){E.unload();v.viewNode&&(v.viewNode.offscroll(b.dispatchScroll),v.viewNode.removeData("_events"),y.detach(v.viewNode));v.rootNode&&y.detach(v.rootNode);y.reset();b.on.detach.dispatch();var a=v.viewNode;if(a)try{a.destroy()}catch(C){}if(a=v.rootNode)try{a.destroy()}catch(C){}K.removeEventListener("beforeprint",h);K.removeEventListener("afterprint",z);K.removeEventListener("resize",b.dispatchResize);v.rootNode=v.viewNode=null;e=f=k=void 0};b.stage=function(a){v.staging=
!0;b.load(a)};var O=function(a){b.logAJAXError("load","Timed out waiting for document to load",a)};b.load=function(a){f||k?void 0===a?v.staging&&(v.staging=!1,E.showNotifications()):(b.unload(),v.dynamicContent=!0,v.documentLoading=!0,u&&ua(u),u=ea(O,3E4,null,a),Ja({url:a,loading:H,success:N,error:R}),r=Ba.createProgressDialog(U.PLEASE_WAIT)):b.logError("load","Call OIT.view.attach before OIT.view.load")};var H=function(a,c,b){u&&ua(u);u=ea(O,3E4,null,a);a=b?b.length:0;r&&r.update(80*a/c)},N=function(a,
c,d,e){c=!0;u&&(ua(u),u=void 0);try{0===d.length?(b.logAJAXError("load","The document is empty or is still being exported",a,e,d),c=!1):c=E.installDocument(a,d)}catch(B){b.logAJAXError("load","The document could not be installed ("+B.message+")",a,e,d),c=!1}c||Q()},R=function(a,c,d,e){u&&(ua(u),u=void 0);b.logAJAXError("load","Failed to load the document index file from the server",a,e,d);Q()};b.unload=function(){E.unload();y.reset()};b.fitToContainer=function(){f&&(D(),b.dispatchResize())};b.width=
function(a){a=xb(a);null!==a&&(f&&f.css("width",a),v.rootNode.css("width",a),b.dispatchResize());return v.rootNode.offsetWidth};b.height=function(a){a=xb(a);null!==a&&(f&&f.css("height",a),v.rootNode.css("height",a),b.dispatchResize());return v.rootNode.offsetHeight};b.info=function(){var a=bb(t);a.libversion=v.libversion?bb(v.libversion):"Unknown";var c=ia.manifest();c&&(a.manifest=bb(c));return a};b.infoRaw=function(){return t};b.showDocumentError=function(a){l||(l=new Ec({title:U.DOCUMENT_ERRORS,
closeButton:!0,className:"oit-toast-error"}));l.message(a);l.expand(!1)};var ra=function(){var a=v.rootNode,c=a.clientWidth,d=a.clientHeight,e;p=void 0;T&&(J!=c||W!=d?(T.destroy(),T=null):(e=T.getContext("2d"),e.clearRect(0,0,c,d)));T||(G||(G=y.create("div","oit-viewcanvas"),a.insertFirst(G)),J=c,W=d,T=G.createCanvas());e||(e=T.getContext("2d"));b.on.update.dispatch(e)};b.invalidateCanvas=function(){!p&&b.on.update.hasListeners()&&(p=kb(ra,this))};v.onviewNode(function(a,c){c&&c.destroy();if(a){for(var b=
v.rootNode,d=b.childByClass("oit-toolframe");d;){d=d.childByClass("oit-toolcontent");if(!d)break;b=d;d=b.childByClass("oit-toolframe")}b&&b.append(a)}});E.onreset(function(){Q();l&&(l.destroy(),l=null);T&&(T.destroy(),T=null);G&&(G.destroy(),G=null);p&&(Xb(p),p=void 0);W=J=-1;c=d=void 0;t={};n=w=0});ia.ondata(function(a,c,b){if(a.info){t||(t={});for(var d in a.info)t[d]=a.info[d];t.fi||(t.fi=1999);t.fistring||(t.fistring="Unknown");t.product||(t.product="Outside In Technology");t.version||(t.version=
"Unknown")}c&&Q()});x.onnochrome(g)}}),Ba=ta.extend("dialog",{install:function(b){var e=[],a=null,d=!1,c,f=!1;b.createProgressDialog=function(a,c){var b={dialog:null,text:null,ticks:null,spinner:null,percentDone:0,active:!1,suppressed:!1,message:a,showTicks:c,display:t,update:r,hide:n};e.push(b);K.performance&&K.performance.now?(b.startTime=performance.now(),b.interval=sb(k,200,b)):b.display();return b};var k=function(){var a=performance.now()-this.startTime;0<this.percentDone?(a=100*a/this.percentDone,
a=1E3<=a):a=500<=a;a&&(Pa(this.interval),this.display())},t=function(){var a=e.indexOf(this);if(!this.active&&0===a&&!this.dialog)if(this.active=!0,E.on.showmessage.dispatch(this.message,!0,this.showTicks)){this.suppressed=!1;b.showModalOverlay(!0,200);if(a=v.rootNode){this.dialog=y.create("div","oit-dialog oit-progress-dialog");this.text=y.create("div","oit-dialog-text");this.ticks=y.create("div","oit-progress-dialog-ticks");for(var c=0;20>c;c++)this.ticks.append(y.create("div"));this.spinner=y.create("div",
"oit-pending oit-progress-dialog-ticks");this.dialog.append(this.text,this.ticks,this.spinner);a.append(this.dialog)}!1===this.showTicks?(this.ticks.css("display",null),this.spinner.css("display","block")):(this.spinner.css("display",null),this.ticks.css("display","block"));this.tickCount=void 0;this.update(this.percentDone);this.text.html(this.message);this.dialog.css({opacity:0,display:"block"});this.dialog.abortAnimation();this.dialog.animate({opacity:1,time:200,startCSS:{display:"block"}})}else this.suppressed=
!0},r=function(a){"number"===typeof a&&(0>a?a=0:100<a&&(a=100),this.percentDone=a,this.active&&(E.on.progress.dispatch(a),this.dialog&&(a=Math.floor(21*a/100),20<a&&(a=20),a!=this.tickCount&&(this.tickCount=a,this.ticks.forChildElements(w,a)))))},w=function(a,c,b){c<b?a.addClass("filled"):a.removeClass("filled")},n=function(){var a=this;a.interval&&(Pa(a.interval),a.interval=void 0);a.active&&E.on.hidemessage.dispatch();a.dialog&&(a.dialog.abortAnimation(),a.dialog.animate({opacity:0,endCSS:{display:"none"},
endFn:function(){a.dialog.destroy();a.dialog=null},time:200}),b.showModalOverlay(!1,200));Fa(e,a)};b.showModalOverlay=function(a,b){b=b||200;var d=f;if(a){if(!c){var e=v.rootNode;e&&(c=y.create("div","oit-screen"),e.append(c))}c&&!f&&(f=!0,c.abortAnimation(),c.animate({opacity:.5,time:b,startCSS:{opacity:0,display:"block"}}))}else f&&(f=!1,c.abortAnimation(),c.animate({opacity:0,time:b,endCSS:{display:null}}));f!=d&&(d=A.activeOverlay())&&d.updateCSS()};b.modalOverlayVisible=function(){return f};
b.showMessage=function(c){d&&b.hideMessage();if(E.on.showmessage.dispatch(c,!1,!1)){if(!a){var e=v.rootNode;e&&(a=y.create("div","oit-background-message"),e.append(a))}a&&(d||(a.abortAnimation(),a.animate({opacity:.8,time:200,startCSS:{opacity:0,display:"block"}})),a.html(c))}d=!0};b.hideMessage=function(){d&&(E.on.hidemessage.dispatch(),a&&(a.abortAnimation(),a.animate({opacity:0,time:200,endCSS:{display:null}})),d=!1)};b.messageVisible=function(){return d};E.onreset(function(){for(;0<e.length;)e[e.length-
1].hide();a&&a.destroy();c&&c.destroy();a=null;d=!1;c=null;f=!1})}}),na=ta.extend("rawtext",{events:{add:{}},install:function(b){function e(a){if(-1===a.indexOf("*"))return!1;for(var c=0;c<a.length;c++)if("*"!==a.charAt(c))return!1;return!0}function a(a,c,b){this.value=a;this.type=c;this.subtype=b}function d(){this.items=[];this.add=function(c,b,d){d||(d="");c=new a(c,b,d);this.addRef(c);return c};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=
function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function c(a,c){this.regEx=c;this.type=a}function f(a,c){for(var b=new d,e=a.slice(0);e;){for(var g=0;g<c.length;g++){var q=
e.match(c[g].regEx);if(q){var B=c[g].type;if("LUCENE_WITHIN"===B){var h,B=b,k=/\"(.*)\"~(\d+)/.exec(q[0]);if(k){var p=f(k[1],T);if(p&&p.items&&p.items.length){var m=0,l=0;for(h=0;h<p.items.length;h++){var z=p.items[h];"OPEN_PAREN"===z.type?l++:"CLOSE_PAREN"===z.type&&l--;if(0===l){m=h+1;break}}for(h=0;h<m;h++)B.addRef(p.items[h]);h=Number(k[2]);isNaN(h)||h++;B.add("WI"+h,"WITHIN",0);for(h=m;h<p.items.length;h++)B.addRef(p.items[h])}}}else"CONNECTOR_TILDE"===B?b.add(q[0].substring(0,q[0].length-1),
"WORD",0):b.add(q[0],B,0);e=e.slice(q[0].length);break}}g==c.length&&(e=e.slice(1))}return b}function k(a,c,b){a.push("(");!1===b&&a.push("?:");a.push(c);a.push(")")}function t(a,c,b,d){a.push("(");!1===d&&a.push("?:");r(a,c,b);a.push(")")}function r(a,c,b,d){var e;e=c.replace(/([\^\$\+\.\|\(\)\{\}\[\]\\])/g,"\\$1");x.normalizeAccentsForSearch&&(e=dc(e));e=e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]");e=e.replace(/[\u0022\u201C\u201D\u030B\u030F]/g,"[\\u0022\\u201C\\u201D\\u030B\\u030F]");
e=e.replace(/\s+/g,"\\s+");if(b)b=e.replace(/\?/g,"[\\u003F]"),b=b.replace(/\*/g,"[\\u002A]");else if(b=e.replace(/\?/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]"),b=b.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),"dtsearch"===d.searchType)if(b=b.replace(/=/g,"[=\\d]"),d.stemAll||"~"===b.substring(b.length-
1))c=0,"dtsearch"===d.searchType&&"~"===b.substring(b.length-1)&&(c=1),b=Bc(b.substring(0,b.length-c).toLowerCase()),d.stems.push(b),b+="\ue000*";else{if(d.fuzzies&&0<=b.indexOf("%")&&(c=b.indexOf("%"),0<=c)){var q=b.lastIndexOf("%")-c+1;b=b.replace(/%/g,"");b=b.toLowerCase();d.fuzzies.push({searchTerm:b,minMatch:c,maxDistance:q});0<c&&c--;b=b.slice(0,c)+"\ue001+";e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]")}}else if(d.fuzzies&&"lucene"===d.searchType&&0<=
b.indexOf("~")){c=0;q=1;e=b.lastIndexOf("~");if(e+1<b.length){var g=Number(b.slice(e+1,b.length));isNaN(g)||(q=g)}b=b.slice(0,e);b=b.toLowerCase();d.fuzzies.push({searchTerm:b,minMatch:c,maxDistance:q});b=b.slice(0,c)+"\ue001+"}a.push(b)}var w=/(\r\n|\r|\n)/g,n=/\s/g,l=[],u,p,J="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",W=[new c("NUMERICAL_PATTERN",/^(=[=\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]*)/),new c("CONNECTOR_TILDE",/^(\bNOT~(?=\s|$)|\bnot~(?=\s|\)|$))/),new c("CONNECTOR_TILDE",
/^(\bAND~(?=\s|$)|\band~(?=\s|\)|$))/),new c("CONNECTOR_TILDE",/^(\bOR~(?=\s|$)|\bor~(?=\s|\)|$))/),new c("NOT_WITHIN",/^(\bNOT\b|\bnot\b)\s+(\bw\/|\bW\/|\bw \/|\bW \/)/),new c("AND_NOT",/^(\bAND\b|\band\b)\s+(\bNOT\b|\bnot\b)/),new c("OR_NOT",/^(\bOR\b|\bor\b)\s+(\bNOT\b|\bnot\b)/),new c("AND",/^(\bAND\b|\band\b)/),new c("OR",/^(\bOR\b|\bor\b)/),new c("NOT",/^(\bNOT\b|\bnot\b)/),new c("AndAny",/^(\bAndAny\b|\bandany\b)/),new c("XFIRSTWORD",/^(\bxfirstword\b)/),new c("XLASTWORD",/^(\bxlastword\b)/),
new c("DATE",/^\bdate\(\)/),new c("DATE_WITH_PARAM",/^\bdate\([^\)]*\)/),new c("MAIL",/^\bmail\(\)/),new c("MAIL_WITH_PARAM",/^\bmail\([^\)]*\)/),new c("CREDITCARD",/^\bcreditcard\(\)/),new c("CREDITCARD_WITH_PARAM",/^\bcreditcard\([^\)]*\)/),new c("VISA_CREDIT_CARD_REGEX",/^\bvisacreditcard\(\)/),new c("WITHIN",/^(\bw\/|\bW\/|\bw \/|\bW \/|\bWI\d+|\bwi\d+)/),new c("PRE",/^(\bpre\/|\bPRE\/|\bpre \/|\bPRE \/)/),new c("OPEN_PAREN",/^\(/),new c("CLOSE_PAREN",/^\)/),new c("DTSEARCH_REGULAREXPRESSION",
/^\"##[^\"]*\"/),new c("WHITESPACE",/^\s+/),new c("PHRASE",/^"[^"]*"/),new c("WORD",/^[^\s)]+/)],T=[new c("AND",/^(\bAND\b|\s*\u0026\u0026\s*|\s*\u002B\s*)/),new c("OR",/^(\bOR\b|\s*\u007C\u007C\s*)/),new c("NOT",/^(\bNOT\b|\s*\u0021\s*|\s*\u002D\s*)/),new c("LUCENE_WITHIN",/^\"[^\"]*\"~\d+/),new c("OPEN_PAREN",/^\(/),new c("CLOSE_PAREN",/^\)/),new c("LUCENE_REGULAREXPRESSION",/^\/[^\/]*\//),new c("WHITESPACE",/^\s+/),new c("PHRASE",/^"[^"]*"/),new c("WORD",/^[^\s)]+/)],G="(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",
J="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",G="(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",Q=function(){if(void 0===u)for(var a=u=0;a<l.length;a++)l[a].text&&u++;return u};b.findStart=function(a,c,b,d,g,q){b=!1===b?"ig":"g";d={type:a,reverse:"up"===d,hits:[],hitIndex:0,lastHit:null,modifier:b,stemAll:!!q};"number"==
typeof g&&(d.startACC=g);if("string"==typeof c)if("dtsearch"===a||"lucene"===a){if(e(c))b=null;else{var B="\\S*(?:\\s+\\S+)",h=!1;g=!1;c.match(J)&&(B="(?:\\s*\\S)",h=!0);c="lucene"===a?f(c,T):f(c,W);var p=null;c&&(p=c.items);var m=[];c={searchType:a,stems:[],fuzzies:[],stemAll:d.stemAll};for(var l=[],z=0,O=q=!1,u=!0,n,C,ca,H=0;H<p.length;H++)if(C=p[H],0<z)"OPEN_PAREN"===C.type?z++:"CLOSE_PAREN"===C.type?(z--,1===z&&z--):1===z&&"WHITESPACE"!==C.type&&z--;else{n=!1;if("WORD"===C.type){n=C.value.match(J);
m.push("(");m.push("?:");n||m.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))");m.push("(");!1===u&&m.push("?:");r(m,C.value,!1,c);for(H++;H<p.length;H++)if("WHITESPACE"===p[H].type&&H+1<p.length&&"WORD"===p[H+1].type)"lucene"===a?m.push("|"):m.push("\\s+");else if("WORD"===p[H].type)r(m,p[H].value,!1,c);else{H--;break}m.push(")");
n||m.push(G);m.push(")");n=!0}else if("PHRASE"===C.type)n=C.value.match(J),m.push("("),m.push("?:"),n||m.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))"),t(m,C.value.substring(1,C.value.length-1),!0,u),n||m.push(G),m.push(")"),n=!0;else if("WHITESPACE"!==C.type)if("WITHIN"===C.type){if(H+1<p.length)if("WI"===C.value.substring(0,2)||
"wi"===C.value.substring(0,2))C=Number(C.value.slice(2,C.value.length)),isNaN(C)||(l.push(m.length),0<C&&C--,C=B+"{0,"+C+"}",h&&(C+="\\s*"),m.push(C));else if("WORD"===p[H+1].type)if(C=Number(p[H+1].value),!isNaN(C))H++,l.push(m.length),0<C&&C--,C=B+"{0,"+C+"}",h&&(C+="\\s*"),m.push(C);else if("S"===p[H+1].value||"s"===p[H+1].value)H++,l.push(m.length),m.push("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)");else if("P"===p[H+1].value||"p"===p[H+1].value)H++,l.push(m.length),m.push("(?:[^\\u000a\\u000d]*)")}else"NOT_WITHIN"===
C.type?H+1<p.length&&"WORD"===p[H+1].type&&(C=Number(p[H+1].value),isNaN(C)||(H++,l.push(m.length),u=!1,0<C&&C--,C="(?!("+B+"{0,"+C+"})",h&&(C+="\\s*"),m.push(C))):"PRE"===C.type?H+1<p.length&&"WORD"===p[H+1].type&&(C=Number(p[H+1].value),isNaN(C)||(H++,0<C&&C--,C=B+"{0,"+C+"}",h&&(C+="\\s*"),m.push(C))):"MAIL"===C.type?(k(m,'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))(@)((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',u),n=
!0):"MAIL_WITH_PARAM"===C.type?(t(m,C.value.substring(5,C.value.length-1),!1,u),n=!0):"CREDITCARD"===C.type?(k(m,"(?:\\d[ -]*?){13,16}",u),n=!0):"CREDITCARD_WITH_PARAM"===C.type?(t(m,C.value.substring(11,C.value.length-1),!1,u),n=!0):"VISA_CREDIT_CARD_REGEX"===C.type?(k(m,"(4[0-9]{12}(?:[0-9]{3})?)|(4[0-9]{3}-[0-9]{4}-[0-9]{4}-[0-9](?:[0-9]{3})?)",u),n=!0):"DATE"!==C.type&&("DATE_WITH_PARAM"===C.type?(t(m,C.value.substring(5,C.value.length-1),!1,u),n=!0):"AND"===C.type?m.push("|"):"OR"===C.type?m.push("|"):
"NOT"===C.type?z=1:"AND_NOT"===C.type?z=1:"OR_NOT"===C.type?z=1:"AndAny"===C.type?m.push("|"):"XFIRSTWORD"===C.type?(m.push("("),m.push("?:"),m.push("^\\s*"),m.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),m.push(")"),q=n=!0):"XLASTWORD"===C.type?(m.push("("),m.push("?:"),m.push("\\s*"),m.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),
m.push("\\s*$"),m.push(")"),O=n=!0):"DTSEARCH_REGULAREXPRESSION"===C.type?(m.push("("),m.push(C.value.substring(3,C.value.length-1)),m.push(")"),n=!0):"LUCENE_REGULAREXPRESSION"===C.type?(m.push("("),m.push(C.value.substring(1,C.value.length-1)),m.push(")"),n=!0):"OPEN_PAREN"===C.type?(m.push("("),m.push("?:")):"CLOSE_PAREN"===C.type?(m.push(")"),n=!0):"NUMERICAL_PATTERN"===C.type&&(m.push("("),m.push("?:"),m.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]))"),
m.push("("),!1===u&&m.push("?:"),n=m,C=C.value.replace(/([\^\(\)\[\]])/g,"\\$1"),C=C.replace(/\s+$/,""),C=C.replace(/[\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]+/g,"[\\u0020!@,:;<>\\$\\+\\-\\.\\\\\\/\\^\\{\\|\\}\\(\\)\\*\\?#~\\u2012\\u2013\\u2014\\uFE58\\uFF0D]+"),C=C.replace(/=/g,"[=\\d]"),n.push("[\\(]?"+C),m.push(")"),m.push(G),m.push(")"),n=!0));if(0<l.length&&n){var R=l[l.length-1];ca=0;n=R-1;for(var w=R+1;w<m.length;w++)"("===m[w]?ca++:")"===m[w]&&ca--;if(0===ca&&")"==m[n])for(;0<=n&&(")"===m[n]?ca++:
"("===m[n]&&ca--,0!==ca);n--);C=m[R];if(0===ca&&"(?!("===C.substring(0,4))m.push(")");else if(0===ca){g=!0;m.push(")");m.push("|");m.push("(");m.push("?:");for(var N=[],u=R+1;u<w;u++)if(m.push(m[u]),"^\\s*"===m[u])for(N.push("^\\s*"),ca=n;ca<R;ca++)N.push(m[ca]);else if("\\s*$"===m[u]){for(ca=n;ca<R;ca++)N.push(m[ca]);N.push("\\s*$")}m.push(m[R]);for(u=n;u<R;u++)if(m.push(m[u]),"^\\s*"===m[u])for(N.push("^\\s*"),ca=R+1;ca<w;ca++)N.push(m[ca]);else if("\\s*$"===m[u]){for(ca=R+1;ca<w;ca++)N.push(m[ca]);
N.push("\\s*$")}m.push(")");if(N.length)for(m.push("|"),ca=0;ca<N.length;ca++)m.push(N[ca]);m.push(")");m.push(" ");m.push(" ");m.push(" ");m.push(" ");for(u=m.length;u>n+4;u--)m[u-1]=m[u-5];m[n]="(";m[n+1]="?:";m[n+2]="(";m[n+3]="?:";if("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===C||"(?:[^\\u000a\\u000d]*)"===C)for(u=n;u<m.length;u++)if(m[u]===C)for(u++;u<m.length;u++)if("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))"===
m[u]){m[u]="(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===C?"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002D\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))":"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))";
break}l.pop();u=!0}}}m=m.join("");1==p.length&&(q?m="^\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))":O&&(m="\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))\\s*$"));console.log("RegEx: "+m);a=null;if(0!==m.length)try{a=new RegExp(m,b)}catch(db){}B=b=a;q?B=a=null:O&&(b=a=null);0===c.stems.length&&0===c.fuzzies.length&&
(c=null);b={regex:a,first:b,last:B,searchParameters:c,checkForMultipleMatches:g}}d.regex=b}else{g=null;x.normalizeAccentsForSearch&&(c=dc(c));if(!1===e(c)||"literal"===a)c=c.replace(/([\^\$\+\?\.\|\(\)\{\}\[\]\\])/g,"\\$1"),c=c.replace(/^\s+/,""),c=c.replace(/\s+$/,""),c=c.replace(/['\u0060\u00B4\u2018\u2019]/g,"['\\u0060\\u00B4\\u2018\\u2019]"),c=c.replace(/[\"\u201C\u201D\u030B\u030F]/g,'[\\"\\u201C\\u201D\\u030B\\u030F]'),c=c.replace(/\s+/g,"\\s+"),"phsterms"===a||"string"===a?(a=c.replace(/\*/g,
"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),g=c.replace(/\*/g,J+"*"),g=new RegExp("(?:^|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])("+a+")(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])|(?="+
J+")("+g+")",b)):"literal*"===a?(c=c.replace(/\*/g,"[^\\s]*"),g=new RegExp("("+c+")",b)):"literal"===a&&(c=c.replace(/\*/g,"\\*"),g=new RegExp("("+c+")",b));d.regex={regex:g}}else c instanceof RegExp&&(d.regex={regex:c});return d};var D=function(a,c,b){var d,e=null;a.lastHit=ka(b,b+c[0].length);var q=c.length;for(d=1;d<c.length;d++)void 0===c[d]&&q--;if(0<q){e={range:a.lastHit,terms:[]};for(q=1;q<c.length;q++)if(c[q]){var g=c[q],f=a.modifier;d=!!g.match(J);g=g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");
d=d?["(",g,")"].join(""):["(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))(",g,")",G].join("");d=new RegExp(d,f);for(f=null;g=d.exec(c[0]);){f||(f=g);if(0===g.index)break;if(g.index+g[0].length>=c[0].length){f=g;break}}if(f){g=f[0];d=f.index;if(f[1]){var h=f[0].indexOf(f[1]);-1!=h&&(g=f[1],d+=h)}var h=b+d,m=h+g.length,k=!1;for(d=0;d<e.terms.length;d++){var p=
e.terms[d];if(p.range.acc<m&&h<p.range.accend){h<p.range.acc&&(p.range.acc=h);m>p.range.accend&&(p.range.accend=m);k=!0;break}}!k&&(d=ka(h,m),e.terms.push({term:g,range:d}),f=f.index+f[0].length-1,0===a.nextOffset||a.nextOffset>f)&&(a.nextOffset=f)}}if(0===e.terms.length)e=null;else{a=e.terms[0].range;e.range=ga(e.terms[0].range);for(d=1;d<e.terms.length;d++)c=e.terms[d].range,c.acc<e.range.acc&&(e.range.acc=c.acc),c.accend>e.range.accend&&(e.range.accend=c.accend),c.accend>a.accend&&(a=c);e.lastTermACC=
a.acc}}return e};b.findNext=function(a){if(a.regex){if(void 0===a.blockIndex&&(void 0!==a.startACC&&(a.blockIndex=z(a.startACC)),void 0===a.blockIndex))if(a.reverse){if(ia.isPending())return;a.blockIndex=l.length-1}else a.blockIndex=0;for(;;){if(a.hitIndex>=a.hits.length){a.hits=[];a.hitIndex=0;for(var c=a.reverse?0:l.length;0===a.hits.length;){var b=l[a.blockIndex];if(!b)break;if(!b.text){g(b);break}var d,e=0;d=a.regex.searchParameters;var q=a.regex.regex;a.regex.last&&!ia.isPending()&&a.blockIndex==
l.length-1&&(q=a.regex.last);a.regex.first&&0===a.blockIndex&&(q=a.regex.first);if(q){var B=b.text;for(d&&(B=H(b.text,d));(d=q.exec(B))&&""!==d[0];){var f=b.range.acc+d.index;a.nextOffset=0;if(!a.lastHit||f>a.lastHit.acc){var h=D(a,d,f);if(h){if("dtsearch"===a.type||"lucene"===a.type){for(var m=h.lastTermACC-f,k=null;0<m;){var m=d[0].substring(0,m),p=q.source,u="";q.global&&(u+="g");q.ignoreCase&&(u+="i");q.multiline&&(u+="m");m=(new RegExp(p,u)).exec(m);if(!m||""===m[0])break;m=D(a,m,f+m.index);
if(!m)break;k||(k=[]);k.push(m);m=m.lastTermACC-f}if(k)for(f=k.length-1;0<=f;f--)a.hits.push(k[f])}a.hits.push(h)}}d.index>e&&(e=d.index);e+=a.nextOffset+1;q.lastIndex=e}}if(a.blockIndex==c)break;a.blockIndex+=a.reverse?-1:1}a.reverse&&(a.hits=a.hits.reverse())}if(a.hitIndex>=a.hits.length)break;for(;a.hitIndex<a.hits.length;)if(c=a.hits[a.hitIndex++],b=!0,void 0!==a.startACC&&(b=a.reverse?c.range.acc<=a.startACC:c.range.acc>=a.startACC),b&&A.isDocumentText(c.range.acc,c.range.accend-1))return c}}};
b.findBoundaryStart=function(a,c){var b;if(0<l.length){var d="line"===c?w:n;d.lastIndex=0;for(var e=z(a);void 0!=e;){var g=l[e];if(!g.text)break;for(var f;f=d.exec(g.text);){f=g.range.acc+f.index;if(f>a)break;b=f+1}if(void 0!==b)break;if(0===e)break;e--}}void 0===b&&(b=a);return b};b.findBoundaryEnd=function(a,c){var b;if(0<l.length){var d="line"===c?w:n;d.lastIndex=0;for(var e=z(a);void 0!=e;){var g=l[e];if(!g.text)break;for(var f;f=d.exec(g.text);)if(f=g.range.acc+f.index,f>a){b=f;break}if(void 0!==
b)break;if(e+1>=l.length)break;e++}}void 0===b&&(b=a);return b};b.firstACC=function(){if(0<l.length)return l[0].range.acc};b.lastACC=function(){if(0<l.length)return l[l.length-1].range.accend};b.hasRawText=function(){if(0<l.length)return!0;if(!ia.isPending())return!1};b.isPending=function(){return ia.isPending()?!0:Q()<l.length};b.getRawTextBlock=function(a){if(0<=a&&a<l.length)return a=l[a],a.text||g(a),a};var h=function(){var a=z(this.acc),c=z(this.accend);if(void 0===a||void 0===c)b.isPending()?
(b.onadd(this,h),ia.onadd(this,h)):(b.offadd(this,h),ia.offadd(this,h),this.callback());else{for(var d=0,e=a;e<=c;e++){var f=l[e];!f.text&&f.src?g(f,h,this):d++}d==c-a+1&&(b.offadd(this,h),ia.offadd(this,h),this.callback())}};b.loadRawText=function(a,c,b){h.call({acc:a,accend:c,callback:b})};b.getRawText=function(a,c){for(var b=z(a),d=z(c),e;b<=d;b++){var g=l[b];if(!g.text){e=void 0;break}var f=a-g.range.acc;0>f&&(f=0);var h=c-g.range.acc;h>g.text.length&&(h=g.text.length);g=g.text.substring(f,h);
e=e?e+g:g}return e};var z=function(a){for(var c=0;c<l.length;c++){var b=l[c].range;if(a>=b.acc&&a<b.accend||c==l.length-1&&(a=b.accend))return c}},g=function(a,c,b){if(!a.text&&a.src){if(c){a.callbacks||(a.callbacks=[]);for(var d=!1,e=0;e<a.callbacks.length;e++)if(a.callbacks[e].func==c&&a.callbacks[e].context==b){d=!0;break}d||a.callbacks.push({func:c,context:b})}a.loading||(c=Ma(v.baseURL,a.src),Q(),a.loading=!0,Ja({url:c,complete:m,args:[a]}))}else c&&c.call(b,a)},m=function(a,c,d,e,g){g.loading=
!1;200==e?ia.isICD(d)?ia.processContentData(d):(g.text=d,N(g)):(g.text="",b.logAJAXError(null,"Failed to load a document text block from the server",a,e,d));u++;c=l.indexOf(g);a=l[c-1];c=l[c+1];a&&a.text&&(g.text=a.text.substr(a.text.length-2048,2048)+g.text,g.range.acc-=2048);c&&c.text&&(c.text=g.text.substr(g.text.length-2048,2048)+c.text,c.range.acc-=2048);if(g.callbacks){for(a=0;a<g.callbacks.length;a++)g.callbacks[a].func.call(g.callbacks[a].context,g);delete g.callbacks}200==e&&b.on.add.dispatch(g.range.acc,
g.range.accend)};b.replaceRawText=function(a){if(a&&(p=p?p.concat(a):a,0<l.length))for(a=0;a<l.length;a++)N(l[a])};var O=function(a,c){var b=c.minMatch,d=c.searchTerm,e=c.maxDistance;if(a.length<b||d.length<b)return null;for(var g=0;g<b;g++)if(d.charAt(g)!==a.charAt(g))return null;var f=0,h=g,m,k,p,l;for(k=0;d.length-k>g&&a.length-k>g&&d.charAt(d.length-1-k)===a.charAt(a.length-1-k);)k++;for(var u=a.slice(0,a.length-k),z=d.slice(0,d.length-k);g<z.length;)if(m=z.charAt(g),d=h<u.length?u.charAt(h):
0,g++,h++,m!==d){f++;if(f>e)return null;k=g<z.length?z.charAt(g):0;p=h<u.length?u.charAt(h):0;k!==p&&(m===p?(m=g+1<z.length?z.charAt(g+1):0,l=h+1<u.length?u.charAt(h+1):0,k!==d||z.length!==u.length&&m!==l?k===p?(g++,h++):z.length-g>u.length-h?(g++,f++):h++:(g++,h++)):k===d?g++:(l=h+1<u.length?u.charAt(h+1):0,m===l&&(h+=2,f++)))}u.length>h&&(f+=u.length-h);if(f>e)return null;0<b&&b--;e=a.slice(0,b);for(h=b;h<a.length;h++)e+="\ue001";return e},H=function(a,c){function b(a,b,d,e){b=b.toLowerCase();if(c.stems)for(e=
0;e<c.stems.length;e++)if(b.charAt(0)==c.stems[e].charAt(0)&&(d=Bc(b),d===c.stems[e])){for(a=d.length;a<b.length;a++)d+="\ue000";return d}if(c.fuzzies)for(e=0;e<c.fuzzies.length;e++)if(d=O(b,c.fuzzies[e]))return d;return a}var d=/(\w+)/ig;return a?a.replace(d,b):a},N=function(a){if(p&&p.length&&a.text)for(var c,b=a.range.acc,d=a.range.acc+a.text.length,e=0;e<p.length;e++)if(c=p[e],c.acc<=d&&c.accend>=b){var g=c.acc-b;0>g&&(g=0);c=c.accend-b;c>a.text.length&&(c=a.text.length);for(var f=c-g,h="";0<
f--;)h+=" ";a.text=a.text.substr(0,g)+h+a.text.substr(c)}a.text&&x.normalizeAccentsForSearch&&(a.text=dc(a.text))};E.onreset(function(){p=u=void 0;l=[]});ia.ondata(function(a,c,b){if(a.text)for(c=0;c<a.text.length;c++){b=a.text[c];N(b);for(var d=0;d<l.length;d++)if(0===Ta(b.range,l[d].range)){l[d].text=b.text;b=null;break}b&&(l.push(b),g(b))}})}}),ec,xa,ka,Bb,Cb,sa,mb,ya,Ta,Fc,fb,ga,Gc,fc,Lb,gb,Fb;(function(){var b=function(b,a){return b.acc-a.acc};ec=function(b){return!!xa(b,!1,!1)};xa=function(b,
a,d){var c;if(b&&b.type)switch(b.type){case "text":Y(b.acc)&&Y(b.accend)&&(c=b);c&&d&&(b=A.forRange(c,0,!0))&&b.isEmailHeader()&&(b=A.findTextRange(c))&&(b=b[0].startContainer)&&(y.isText(b)||y.isElement(b))&&(b=Ka(b),b=Cb(b))&&(Array.isArray(b)&&(b=b[0]),c.acc<b.acc||c.accend>b.accend)&&(c=ga(c),c.acc<b.acc&&(c.acc=b.acc),c.accend>b.accend&&(c.accend=b.accend));break;case "cell":if(Y(b.page)&&Y(b.c1)&&Y(b.r1)&&Y(b.c2)&&Y(b.r2)&&(c=b,0>c.page?c=void 0:c.page<A.count()?(d=A.page(c.page))&&"worksheet"!==
d.type&&"database"!=d.type&&(c=void 0):c.offsets&&(Y(c.offsets.left)&&Y(c.offsets.top)&&Y(c.offsets.right)&&Y(c.offsets.bottom)||(c=void 0)),c&&!0===a&&(d=A.page(b.page)))&&(d=d.spreadsheetModel())){var e=d.colCount()-1;a=d.rowCount()-1;if(b.c1>e||0>b.c2||b.r1>a||0>b.r2)c=void 0;else{d=ma(b.c1,0,e);var e=ma(b.c2,0,e),k=ma(b.r1,0,a);a=ma(b.r2,0,a);if(d!==b.c1||e!==b.c2||k!==b.r1||a!==b.r2)c=ga(b),c.c1=d,c.c2=e,c.r1=k,c.r2=a}}break;case "rect":if(Y(b.page)&&Y(b.left)&&Y(b.top)&&Y(b.right)&&Y(b.bottom)&&
Ya(b.units)&&("px"===b.units||"tw"===b.units||"pct"===b.units)&&(c=b,"pct"!==b.units||Y(b.embedId)?0>c.page?c=void 0:void 0===b.embedId&&c.page<A.count()&&(d=A.page(c.page))&&"page"!==d.type&&"drawing"!==d.type&&"slide"!==d.type&&"chart"!==d.type&&"bitmap"!==d.type&&"email"!==d.type&&"html"!==d.type&&"rt"!==d.type&&"sn"!==d.type&&(c=void 0):c=void 0,c&&void 0===b.embedId&&!0===a&&(d=A.page(b.page))&&(a=d.pageRect())))if(b.left>a.right||b.right<a.left||b.top>a.bottom||b.bottom<a.top)c=void 0;else{var e=
ma(b.left,a.left,a.right),k=ma(b.top,a.top,a.bottom),t=ma(b.bottom,k,a.bottom),r=b.right;"html"!==d.type&&(r=ma(b.right,e,a.right));if(e!=b.left||r!=b.right||k!=b.top||t!=b.bottom)c=ga(b),c.left=e,c.right=r,c.top=k,c.bottom=t}}return c};ka=function(){var b=arguments,a,d;switch(b.length){case 2:Y(b[0])&&Y(b[1])&&(a=b[0],d=b[1]);break;case 1:if(Y(b[0]))a=b[0],d=b[0];else if(Qa(b[0])||va(b[0])){if(b=Cb(b[0]))Array.isArray(b)?(a=b[0].acc,d=b[b.length-1].accend):(a=b.acc,d=b.accend)}else if((b=xa(b[0]))&&
"cell"===b.type){var c=A.page(b.page);if(c&&("worksheet"===c.type||"database"===c.type)&&(c=c.spreadsheetModel()))return c.mapToText(b)}}var f;Y(a)&&Y(d)&&(f=new OIT.TextRange(a,d));return f};Bb=function(b,a){b=y.unwrap(b);a=a||0;var d;a:{if(1===b.nodeType&&b.childNodes&&(d=b.childNodes[a]))break a;d=void 0}d&&(b=d,a=0);var c;d=v.viewNode;for(var e=b;e;e=e.parentNode){var k=y.data(e,"acc");if(void 0!==k){"none"!==k&&(c=y.wrap(e));break}if(e===d)break}if(d=c){c=parseInt(d.data("acc"),10);if(!d.equals(b))for(d=
d.createTreeWalker(),e=d.firstACCNode();e;){e=d.currentNode;if(e===b)break;1===e.nodeType?(e=y.data(e,"acc"))&&(c=parseInt(e,10)):3===e.nodeType&&(c+=e.nodeValue.length);e=d.nextACCNode()}return c+a}};Cb=function(b){var a;Qa(b)?a=b:va(b)&&"number"===typeof b.rangeCount&&0<b.rangeCount?a=b.getRangeAt(0):y.isElement(b)&&(a=X.createRange(),a.selectNode(y.unwrap(b)));if(a){b=a.startContainer;var d=a.startOffset,c=a.endContainer,e=a.endOffset,k,t;if(b===c){k=Bb(b,d);if(d===e)return ka(k,k);if(y.isText(b))return ka(k,
k+e-d)}for(var r=a.commonAncestorContainer;r&&!y.isElement(r);)r=r.parentNode;r=y.wrap(r);a=Bb(r);var w=[],n,r=r.createTreeWalker();k=r.firstACCNode();for(var l=!1,u=!1,p=!1;k;){var J=r.currentNode;J===b&&y.isText(b)?l=!0:l||J.parentNode!==b||(u=!0,0!==d&&y.nodeIndex(J)!=d)||(l=!0);u&&!l&&(y.isDescendantOf(J,b)||(l=!0));if(p&&!y.isDescendantOf(J,c))break;1===J.nodeType?(k=y.data(J,"acc"))&&(a="none"===k?void 0:Number(k)):3===J.nodeType&&void 0!==a&&(l&&0<J.nodeValue.length&&(k=a,J===b&&(k+=d),t=a+
J.nodeValue.length,J===c&&(t=a+e),n&&n.accend!=a&&n.accend!=a-1&&(n=null),n?n.accend=t:(n=ka(k,t),w.push(n))),a+=J.nodeValue.length);if(J===c&&y.isText(c))break;else if(J.parentNode===c&&(p=!0,0===e||y.nodeIndex(J)>=e))break;k=r.nextACCNode()}w=Gc(w);0===w.length?w=void 0:1==w.length&&(w=w[0]);return w}};sa=function(){var b,a,d,c,f,k,t,r=arguments;switch(r.length){case 9:a=r[0];d=r[1];c=r[2];f=r[3];k=r[4];t={left:r[5],top:r[6],right:r[7],bottom:r[8]};break;case 5:a=r[0];d=r[1];c=r[2];f=r[3];k=r[4];
break;case 4:d=r[0];c=r[1];f=r[2];k=r[3];break;case 3:a=r[0];d=r[1];c=r[2];f=r[1];k=r[2];break;case 2:d=r[0];c=r[1];f=r[0];k=r[1];break;case 1:if((r=xa(r[0]))&&"text"===r.type&&(b=A.forRange(r))&&("worksheet"===b.type||"database"===b.type)&&(b=b.spreadsheetModel()))return b.mapToCells(r)}if(void 0===a)a=A.current();else if(Ya(a)){if(b=A.byName(a))a=b.index}else if(Y(a)){if(0>a||a>=A.count())a=void 0}else a=void 0;var w;Y(a)&&Y(d)&&Y(c)&&Y(f)&&Y(k)?w=new OIT.CellRange(a,d,c,f,k,t):E.invalidArg("cellRange");
return w};mb=function(){var b,a,d,c,f,k,t="px",r=arguments;if(2<=r.length&&6>=r.length){var w=0;if(Ya(r[w])){var n=A.byName(r[w]);n&&(a=n.index,w++)}for(var n=0,l=w;l<r.length;l++)if(Y(r[l]))n++;else break;switch(n){case 6:b=r[w++];case 5:a=r[w++];case 4:d=r[w++];c=r[w++];f=r[w++];k=r[w++];break;case 3:a=r[w++];case 2:d=r[w++],c=r[w++],f=d,k=c}w<r.count&&Ya(r[w])&&(t=r[w++])}if(void 0===a)a=A.current();else if(Y(a)){if(0>a||a>=A.count())a=void 0}else a=void 0;var u;Y(a)&&Y(d)&&Y(c)&&Y(f)&&Y(k)&&("px"===
t||"tw"===t||"pct"===t)?u=new OIT.RectRange(b,a,d,c,f,k,t):E.invalidArg("rectRange");return u};ya=function(b,a){if(b&&"rect"===b.type&&b.units!==a){var d,c,e;switch(a){case "px":"tw"===b.units?(d=A.page(b.page))&&d.dpi&&(b.left=M(b.left*d.dpi/1440,1E4),b.top=M(b.top*d.dpi/1440,1E4),b.right=M(b.right*d.dpi/1440,1E4),b.bottom=M(b.bottom*d.dpi/1440,1E4),b.units="px"):"pct"===b.units&&void 0!==b.embedId&&(d=A.page(b.page))&&(d=d.embeddingRect(b.embedId))&&(c=d.width/100,e=d.height/100,b.left=M(b.left*
c,1E4),b.right=M(b.right*c,1E4),b.top=M(b.top*e,1E4),b.bottom=M(b.bottom*e,1E4),b.units="px");break;case "tw":"px"===b.units&&(d=A.page(b.page))&&d.dpi&&(b.left=M(1440*b.left/d.dpi,1E4),b.top=M(1440*b.top/d.dpi,1E4),b.right=M(1440*b.right/d.dpi,1E4),b.bottom=M(1440*b.bottom/d.dpi,1E4),b.units="tw");break;case "pct":if("px"===b.units&&(d=A.page(b.page))){if(void 0!==b.embedId){if(d=d.embeddingRect(b.embedId))c=100/d.width,e=100/d.height}else e=d.pageRect(),c=100/e.width,e=100/e.height;void 0!==c&&
(b.units="pct",b.left=M(b.left*c,1E4),b.right=M(b.right*c,1E4),b.top=M(b.top*e,1E4),b.bottom=M(b.bottom*e,1E4))}}}};Ta=function(b,a){if(!b)return a?-1:0;if(!a)return 1;if(b.page<a.page)return-1;if(b.page>a.page)return 1;if(b.type===a.type)switch(b.type){case "text":return b.acc<a.acc?-1:a.acc<b.acc?1:b.accend<a.accend?-1:a.accend<b.accend?1:0;case "cell":if(b.r1<a.r1)return-1;if(a.r1<b.r1)return 1;if(b.c1<a.c1)return-1;if(a.c1<b.c1)return 1;if(b.r2<a.r2)return-1;if(a.r2<b.r2)return 1;if(b.c2<a.c2)return-1;
if(a.c2<b.c2)return 1;if(b.offsets)if(a.offsets){if(b.offsets.top<a.offsets.top)return-1;if(b.offsets.top>a.offsets.top)return 1;if(b.offsets.left<a.offsets.left)return-1;if(b.offsets.left>a.offsets.left)return 1;if(b.offsets.bottom<a.offsets.bottom)return-1;if(b.offsets.bottom>a.offsets.bottom)return 1;if(b.offsets.right<a.offsets.right)return-1;if(b.offsets.right>a.offsets.right)return 1}else return 1;else if(a.offsets)return-1;return 0;case "rect":return b.units!=a.units&&(a=ga(a),ya(a,b.units)),
b.top<a.top?-1:a.top<b.top?1:b.left<a.left?-1:a.left<b.left?1:b.bottom<a.bottom?-1:a.bottom<b.bottom?1:b.right<a.right?-1:a.right<b.right?1:0}};Fc=function(b,a){if(b.type===a.type)switch(b.type){case "text":return a.acc>=b.acc&&a.accend<=b.accend}return!1};fb=function(b,a){if(b&&a&&a.type===b.type)switch(a.type){case "text":return b.accend>a.acc&&b.acc<a.accend;case "cell":return b.c2>=a.c1&&b.c1<=a.c2&&b.r2>=a.r1&&b.r1<=a.r2;case "rect":return b.right>=a.left&&b.left<=a.right&&b.bottom>=a.top&&b.top<=
a.bottom}return!1};ga=function(b){var a;if(b)switch(b.type){case "text":a=new OIT.TextRange(b.acc,b.accend);break;case "cell":a=new OIT.CellRange(b.page,b.c1,b.r1,b.c2,b.r2);!0===b.selectingCols&&(a.selectingCols=!0);!0===b.selectingRows&&(a.selectingRows=!0);b.offsets&&(a.offsets={left:b.offsets.left,top:b.offsets.top,right:b.offsets.right,bottom:b.offsets.bottom});break;case "rect":a=new OIT.RectRange(b.embedId,b.page,b.left,b.top,b.right,b.bottom,b.units,b.section)}return a};Fb=function(b,a){if(a)if(Array.isArray(a))for(var d=
0;d<a.length;d++)b=Fb(a[d],b);else if(!b)b=ga(a);else if(b.type===a.type)switch(b.type){case "cell":a.c1<b.c1&&(b.c1=a.c1);a.r1<b.r1&&(b.r1=a.r1);a.c2>b.c2&&(b.c2=a.c2);a.r2>b.r2&&(b.r2=a.r2);break;case "text":a.acc<b.acc&&(b.acc=a.acc),a.accend>b.accend&&(b.accend=a.accend)}return b};Gc=function(e){if(e&&1<e.length){e.sort(b);for(var a=[],d,c=0;c<e.length;c++){var f=e[c];d&&3>f.acc-d.accend?f.accend>d.accend&&(d.accend=f.accend):(d=f,a.push(f))}e=a}return e};fc=function(b){if(1===b.length)return b[0];
if(1<b.length){var a=b[0],d=X.createRange();d.setStart(a.startContainer,a.startOffset);d.setEnd(a.endContainer,a.endOffset);for(var a=Ka(a.startContainer),c=1;c<b.length;c++){var e=b[c],k=Ka(e.endContainer);y.unwrap(k)==y.unwrap(a)&&d.setEnd(e.endContainer,e.endOffset)}return d}};Lb=function(b){if(b=xa(b))switch(b.type){case "text":return b.acc==b.accend;case "cell":return!1;case "rect":return b.left==b.right||b.top==b.bottom}return!0};gb=function(b){if(b)switch(b.type){case "cell":var a=[];a.push(La(b.c1),
b.r1+1);b.c2==b.c1&&b.r2==b.r1||a.push(":",La(b.c2),b.r2+1);return a.join("")}}})();var F=ta.extend("display",{events:{displayload:{},displayunload:{}},install:function(b){var e={zoom:!1,rotate:!1,showhidden:!1,pages:!1,fitpage:!1,highlights:!1,textselection:!1,rectselection:!1,rectredaction:!1,cellselection:!1,customtextselection:!1,anchorednotes:!1},a=null,d=null,c=e,f=!1,k;b.loadDisplay=function(e){b.unloadDisplay();var f=e.type;e.overlay&&e.overlay.firstPage&&(f=e.overlay.firstPage.type);if(a=
Ea.createDisplay(f))d=e.overlay,v.deType=f,c=Ea.features(f),v.drawing.resetOrigin(),a.init(e),b.on.displayload.dispatch(d.firstPage,d.lastPage)};b.unloadDisplay=function(){a&&(b.on.displayunload.dispatch(d.firstPage,d.lastPage),a.unload(),d=a=null,v.deType=null);c=e};b.features=function(){var a=c;if("vertical"!==x.scrollMode){var b=A.activePage();b&&(a=Ea.features(b.type))}return a};b.isSelectionModeSupported=function(a){var c=!1;switch(a){case "none":c=!0;break;case "text":b.features().textselection&&
(c=!0);break;case "rect":b.features().rectselection&&(c=!0);break;case "cell":b.features().cellselection&&(c=!0)}return c};b.isHighlightModeSupported=function(a){var c=b.isSelectionModeSupported(a);c||"text"!==a||"worksheet"!==v.deType&&"database"!==v.deType||(c=!0);return c};b.visiblePages=function(){return a?a.visiblePages():[]};b.startElasticScroll=function(){if(a)return a.startElasticScroll()};b.elasticScroll=function(b,c){if(a)return a.elasticScroll(b,c)};b.endElasticScroll=function(b,c){if(a)return a.endElasticScroll(b,
c)};b.saveScrollPos=function(){if(a)return a.saveScrollPos()};b.restoreScrollPos=function(b){a&&a.restoreScrollPos(b)};b.maxPageWidth=function(){if(a)return a.maxPageWidth()};b.maxPageHeight=function(){if(a)return a.maxPageHeight()};b.padding=function(){if(a)return a.padding()};b.margin=function(){if(a)return a.margin()};b.scrollOffset=function(){if(a)return a.scrollOffset()};b.keydown=function(b){return a?a.keydown(b):!0};b.showHidden=function(b){a&&a.showHidden(b)};b.loadRange=function(b,c){a&&
a.loadRange(b,c)};b.expandRange=function(b){a&&(b=a.expandRange(b));return b};b.moveto=function(b,c,d){return a?a.moveto(b,c,d||{}):!1};b.getSelectedText=function(){return a?a.getSelectedText():""};b.select=function(b){return a?a.select(b):!1};b.pageRange=function(b,c){if(a&&d.containsPage(b))return a.pageRange(b,c)};b.pageRect=function(b,c){if(a&&d.containsPage(b))return a.pageRect(b,c)};b.rangeRect=function(b,c,e,f){if(a&&("text"===b.type||d.containsPage(b.page)))return a.rangeRect(b,c,e,f)};b.rangeFromRect=
function(b,c,e,f,k,u,p,J){if(a&&d.containsPage(b))return a.rangeFromRect(b,c,e,f,k,u,p,J)};b.extendRange=function(b,c,d,e){if(a)return a.extendRange(b,c,d,e)};b.moveAnchor=function(b,c,d,e){return a?a.moveAnchor(b,c,d,e):!1};b.incrementSelection=function(b,c,d,e,f){return a?a.incrementSelection(b,c,d,e,f):!1};b.suspendUpdate=function(){f||(f=!0)};b.resumeUpdate=function(){f&&(f=!1,b.update())};b.layoutChanged=function(b){a&&a.layoutChanged(b)};b.update=function(c,d){if(!f)if(!0===d)k&&ua(k),k=ea(b.update,
50,this,c,!1);else if(a)return a.update(c);return!1};b.activeOverlay=function(){return d};E.onreset(b.unloadDisplay);Dc.onfontload(function(){b.update(!0)})}}),P=ta.extend("selection",{events:{beginselection:{},selectionchanged:{}},install:function(b){var e=null,a=!0,d,c=null,f=!0,k=!1,t=!0,r=!1,w,n,l,u,p,J,W,T,G,Q,D,h=0,z,g,m,O=0,H,N,R=0,ra=0,fa,C,I,q=[],B,ba,aa,da;b.reset=function(){b.select(null);x.selectionMode=b.validateMode(x.selectionMode)};b.style=function(a,b){f=!1===b?!1:!0;null!==a&&"string"!==
typeof a||a===c||(c=a,e=ib(c),Ca(),Z());return c};b.isSelecting=function(){return r};var Ca=function(a){if(!a&&e){a="";e.color&&(a+="color:"+e.color+";");var b=e["background-color"];b&&(a+="background-color:"+b+";")}a&&0<a.length?(B||(B=y.create("style"),B.type="text/css",y.byTagName("head")[0].append(B)),B.html(".oit-view ::selection, .oit-annopane ::selection { "+a+"}")):B&&B.html("")},Z=function(){if(n){var a=n.selectionRect();a.resetStyle();e?(a.removeClass("oit-sel-rect"),a.css(e)):a.addClass("oit-sel-rect");
a.update()}};b.textSelection=function(){if(l){if("text"===l.type)return ga(l);if("cell"===l.type)return ka(l)}};b.cellSelection=function(){if(l&&"cell"===l.type)return ga(l)};b.rectSelection=function(){if(l&&"rect"===l.type)return ga(l)};b.selectionType=function(){return l?l.type:"none"};b.hide=function(c){a=!1;d=c;Ac("firefox")?b.select(null):d?Ca(d):Ca("background-color: rgba(255,255,255,0);");n&&n.showSelectionRect(!1)};b.select=function(c,e,g,q){var f=!1;a=!0;d=null;if(null===c)f=!!l,ha(),b.update();
else if(c)if(va(c)||Qa(c))f=b.select(ka(c));else if(c=xa(c),!c||c.selectingRows||c.selectingCols||!1===c.autoExpand||(c=F.expandRange(c)),c&&0!==Ta(c,l)){var B=A.forRange(c,0,!0);B&&(f=!0,b.on.beginselection.dispatch(c),ha(),n=B,l=ga(c),w=ga(c),Z(),b.update())}if(f||e!==da)b.on.selectionchanged.dispatch(l,!0),da=e,E.on.select.dispatch(l,g||null,q||null,Lb(l),e)&&(v.drawing&&v.drawing.update(!0),l&&void 0===e&&(c=F.rangeRect(l,"view"),"text"===l.type&&b.update(),c&&L.activateNearest(c.left,c.top)));
return f};b.saveSelection=function(){if(!l)return null;var b={range:ga(l)};a||(b.visible=!1,b.hideStyle=d);return b};b.restoreSelection=function(a){if(a){var c=a.range,d=A.forRange(c,0,!0);d&&(b.on.beginselection.dispatch(c),ha(),n=d,l=ga(c),w=ga(c),Z(),b.update(),a.visible||b.hide(a.hideStyle))}};b.startRectSelection=function(c,e,g){ha();A.deactivateAnnotation();r=!0;F.isSelectionModeSupported("text")||L.startSelection();g=A.mapToPage(c,e,null,!0);b.logRect&&b.logRect(g.page,g.x,g.y,!0);u={x:c,y:e};
n=g.page;W=g.x;T=g.y;G=c;Q=e;a=J=!0;d=null;l=F.rangeFromRect(n.index,W,T,W,T,n,"select");"cell"!==l.type||k||delete l.offsets;w=ga(l);b.on.beginselection.dispatch(l);Z();b.update();b.on.selectionchanged.dispatch(l,!1);return!0};b.extendRectSelection=function(a,c,d){w&&(J&&(d=Math.abs(c-Q),2<Math.abs(a-G)||2<d)&&(J=!1,F.isSelectionModeSupported("text")&&L.startSelection()),Ra(p,a,c),a=A.mapToPage(a,c,n,!0),b.logRect&&b.logRect(a.page,a.x,a.y),l=F.extendRange(w,a.x,a.y,a.page),t&&(l=xa(l,!0)),b.update(),
b.on.selectionchanged.dispatch(l,!1))};b.endRectSelection=function(a,c,d){pa();r=!1;b.extendRectSelection(a,c);b.on.selectionchanged.dispatch(l,!0);var e={x:a,y:c},g=J;da=void 0;E.on.select.dispatch(l,u,e,J)&&"rect"===x.selectionMode&&b.select(null);g&&d&&(e=y.wrap(d.target),e.isDescendantOf(A.activeOverlay())||e.isDescendantOf(v.drawing))&&((e=A.activePage())&&e.isSpreadsheet()?L.activateNearest(a,c,d,!0):(a=L.findNearest(a,c))&&0===a.distance.ax&&0===a.distance.ay||L.deactivate());L.endSelection()};
b.cancelRectSelection=function(a,c){pa();b.select(null)};b.startTouchTextSelection=function(c,e){a=!0;d=null;ba&&b.abortTouchTextSelection();r=!0};b.updateTouchTextSelection=function(){var a=K.getSelection();!a.anchorNode||aa&&aa.anchorNode==a.anchorNode&&aa.anchorOffset==a.anchorOffset&&aa.focusNode==a.focusNode&&aa.focusOffset==a.focusOffset||(aa||(aa={}),aa.anchorNode=a.anchorNode,aa.anchorOffset=a.anchorOffset,aa.focusNode=a.focusNode,aa.focusOffset=a.focusOffset,ba=ka(a))};b.abortTouchTextSelection=
function(){ba=null;r=!1};b.startTextSelection=function(c,e,q,f){ha();r=!0;m=D=null;p=y.wrap(f.target);a=!0;d=null;u={x:c,y:e};J=!0;G=c;Q=e;if(!F.features().customtextselection)return!1;c=A.mapToPage(c,e,null,!0,!0);c.inAnnotation||A.deactivateAnnotation();e=c.page.mapPointToText(c.x,c.y,null,c.inAnnotation);if(!e||!e.overlaps)return!1;N=c;g=Ka(e.node);var B;if("line"===q||"word"===q)B=c.page.findTextBoundary(e.node,e.offset,q);B?(H=q,z=B,D=z.startContainer,h=z.startOffset,m=z.endContainer,O=z.endOffset):
(H=void 0,D=e.node,h=e.offset,m=e.node,O=e.offset);if(D&&m&&(b.update(),y.selectRange(D,h,m,O),q=K.getSelection(),q.anchorNode&&q.focusNode))if(q=ka(q))b.on.beginselection.dispatch(q);else return m=D=null,!1;return!0};b.extendTextSelection=function(a,b,c){if(!F.features().customtextselection)return!1;J&&(c=Math.abs(b-Q),2<Math.abs(a-G)||2<c)&&(J=!1,F.isSelectionModeSupported("text")&&L.startSelection());Ra(p,a,b);c=null;var d=!1;N&&N.inAnnotation&&(c=N.page,d=!0);a=A.mapToPage(a,b,c,!0,!0,d);b=a.page.mapPointToText(a.x,
a.y,g,a.inAnnotation);if(!b)return!1;if(b.node!=m||b.offset!=O){if(H){if(b=a.page.findTextBoundary(b.node,b.offset,H))a=b.compareBoundaryPoints(Range.START_TO_START,z),-1==a?(m=b.startContainer,O=b.startOffset,D=z.endContainer,h=z.endOffset):(D=z.startContainer,h=z.startOffset,m=b.endContainer,O=b.endOffset)}else m=b.node,O=b.offset;D&&m&&(D==m?h>O?y.selectRange(m,O,D,h):y.selectRange(D,h,m,O):(a=D.compareDocumentPosition(m),2==a?y.selectRange(m,O,D,h):y.selectRange(D,h,m,O)))}return!0};b.endTextSelection=
function(a,c,d){pa();r=!1;N=p=null;if("text"==x.selectionMode){var e,g=J;H&&(g=!1);ba?(e=ba,ba=null):(e=K.getSelection(),e=e.anchorNode&&e.focusNode?ka(e):null);if(!e)ha(),L.autoHighlight()&&y.clearSelection();else if(0!==Ta(e,l)){e.acc!==e.accend&&(g=!1);var q=A.forRange(e);q&&(J=!1,Q=G=T=W=void 0,n=q,l=e,w=ga(e),b.on.selectionchanged.dispatch(l,!0),e={x:a,y:c},da=void 0,E.on.select.dispatch(l,u,e,Lb(l)))}g&&d&&(d=y.wrap(d.target),d.isDescendantOf(A.activeOverlay())||d.isDescendantOf(v.drawing))&&
((a=L.findNearest(a,c))&&0===a.distance.ax&&0===a.distance.ay||L.deactivate());D=void 0;h=0;m=z=void 0;O=0;H=void 0}L.endSelection()};b.incrementSelection=function(a,c,d){var e=!1;l&&(e=F.incrementSelection(w,l,a,c,d))&&(b.update(),b.on.selectionchanged.dispatch(l,!0));return e};b.moveAnchor=function(a,c,d){var e=!1;w&&(e=F.moveAnchor(w,a,c,d))&&(l=ga(w),b.update(),b.on.selectionchanged.dispatch(l,!0));return e};b.update=function(){if(l)if("text"===l.type){y.clearSelection();b.logUpdate&&b.logUpdate(l);
var c=A.findTextRange(l);c&&y.selectRange(fc(c))}else{if(n)if(c=F.rangeRect(l,"overlay",!0),b.logUpdate&&b.logUpdate(l,c),!c)n.showSelectionRect(!1);else if(n.hasSelectionRect()){var d=n.selectionRect();d.move(c.left,c.top,c.width,c.height);d.show(a&&(!J||f)&&("rect"===l.type||"cell"===l.type))}}else y.clearSelection();F.select(l)&&F.update()};var ha=function(){y.clearSelection();n&&n.showSelectionRect(!1);r=!1;a=!0;d=null;J=!1;Q=G=T=W=void 0;l=w=n=null;Ca();Z()};b.validateMode=function(a,c){F.isSelectionModeSupported(a)||
("rect"===a?F.features().rectredaction&&"redaction"==OIT.highlights.autoHighlight()||(a=void 0):a=void 0);a||(c?a=b.validateMode(c):F.isSelectionModeSupported("text")?a="text":F.isSelectionModeSupported("rect")?a="rect":F.isSelectionModeSupported("cell")&&(a="cell"));return a};b.addAutoscrollRoot=function(a){q.push(y.wrap(a))};var Ra=function(a,b,c){if(b!=fa||c!=C){var d=v.viewNode;fa=b;for(C=c;a&&-1==q.indexOf(a);){if(a===d||!(a instanceof S)){a=null;break}a=a.parent()}var e;a?(e=a.pos(d),b-=e.left,
c-=e.top,e=a.clientWidth*x.zoom,d=a.clientHeight*x.zoom):(a=d,e=d.clientWidth,d=d.clientHeight);1>=b?(R=b-1,-30<R&&(R=-30)):b>=e-1?(R=b-(e-1),30>R&&(R=30)):R=0;1>=c?(ra=c-1,-30<ra&&(ra=-30)):c>=d-1?(ra=c-(d-1),30>ra&&(ra=30)):ra=0;R||ra?I||(I=sb(qa,100,null,a)):pa()}},qa=function(a){a.dscroll(R,ra);D?b.extendTextSelection(fa,C):b.extendRectSelection(fa,C)},pa=function(){I&&(Pa(I),I=void 0,ra=R=0)};b.enableCellOffsets=function(a){k=!!a};b.bindSelectionToPage=function(a){t=!!a};ha();x.onselectionMode(function(a){b.select(null);
(a=A.activeOverlay())&&a.updateCSS()});E.onreset(function(){b.reset();q=[]});F.ondisplayload(b.reset);la.ondetach(function(){c=e=null;B&&(B.destroy(),B=null)});E.onzoom(function(a,c,d){b.update()})}}),Wa=ta.extend("user",{events:{beginscroll:{},endscroll:{},beginpinchzoom:{},endpinchzoom:{}},install:function(b){var e=!1,a=!1,d=!1,c=!1,f,k,t=null,r,w,n,l=null,u,p,J,W,T,G,Q,D,h,z=0,g=0,m=0,O=0;E.onload(function(){var a=v.rootNode;a.onmousedown(R);a.onwheel(fa);K.addEventListener("mouseup",ra,!1);K.addEventListener("keydown",
H,!1);v.isMobileOrTablet&&(a=v.viewNode,a.kinetic(!0),a.ontap(Ra),a.onpress(qa),a.onpressup(pa),a.onpanstart(ca),a.onpanmove(Da),a.onpanend(Eb),a.onpancancel(Eb),a.onpinchstart(vb),a.onpinchmove(pb),a.onpinchend(db),a.onpinchcancel(db),a.onrotatestart(M),a.onrotatemove(U),a.onrotateend(S),a.onrotatecancel(S))});E.onreset(function(){var a=v.rootNode;a&&(a.offmousedown(R),a.offwheel(fa));K.removeEventListener("mouseup",ra);K.removeEventListener("keydown",H);v.isMobileOrTablet&&(a=v.viewNode)&&(a.offtap(Ra),
a.offpress(qa),a.offpressup(pa),a.offpanstart(ca),a.offpanmove(Da),a.offpanend(Eb),a.offpancancel(Eb),a.offpinchstart(vb),a.offpinchmove(pb),a.offpinchend(db),a.offpinchcancel(db),a.offrotatestart(M),a.offrotatemove(U),a.offrotateend(S),a.offrotatecancel(S))});var H=function(a){var c,d;b.logKeydown&&b.logKeydown(a);if(b.isViewEventTarget(a.target)||e&&a.target==X.body){if((d=E.on.keydown.dispatch(a))&&!v.editingComment&&(d=F.keydown(a))){c=v.viewNode;var g=L.active(),q=0,f=0;switch(a.keyCode){case 33:F.features().pages&&
(c.finishAnimation(),A.updateActivePage(),0<c.scrollTop?c.dscroll(void 0,-c.clientHeight):A.movetoPrev(),d=!1);break;case 34:F.features().pages&&(c.finishAnimation(),A.updateActivePage(),c.scrollTop<Math.max(c.clientHeight,c.scrollHeight,c.offsetHeight)-c.innerHeight?c.dscroll(void 0,c.clientHeight):A.movetoNext(),d=!1);break;case 35:c.scroll(c.scrollWidth,c.scrollHeight);d=!1;break;case 36:c.scroll(0,0);d=!1;break;case 37:q=-1;break;case 38:f=-1;break;case 39:q=1;break;case 40:f=1;break;case 45:void 0!==
g&&L.getOption(g,"enableUserComment")&&(L.showComment(g,{mode:"edit",removeOnCancel:!1}),d=!1);break;case 46:void 0!==g&&L.getOption(g,"enableUserDelete")&&(L.remove(),g=void 0,d=!1);break;case 48:a.ctrlKey&&(E.zoom(1),d=!1);break;case 187:a.ctrlKey&&(E.zoomIn(),d=!1);break;case 189:a.ctrlKey&&(E.zoomOut(),d=!1)}if(q||f){var B;void 0!==g&&(c=L.range(g))&&(B=c.type);B||(B=x.selectionMode);if("cell"===B||"rect"===B)if(B=a.ctrlKey,void 0!==g){if(a.shiftKey){var h=c=0,m=0,k=0;d=x.rotation;switch(d){case 0:m=
q;k=f;break;case 90:k=q;c=-f;break;case 180:c=-q;h=-f;break;case 270:h=-q,m=f}L.move(g,c,h,m,k,B)}else{d=x.rotation;if(0!==d)switch(c=q,h=f,d){case 90:q=-h;f=c;break;case 180:q=-c;f=-h;break;case 270:q=h,f=-c}L.move(g,q,f,q,f,B)}(c=L.range(g))&&A.moveto(c);d=!1}else d=a.shiftKey?!P.incrementSelection(q,f,B):!P.moveAnchor(q,f,B)}}!1===d&&jb(a);return d}},N=function(a){(a.button||0)==T&&(b.releaseMouseCapture(),b.on.endscroll.dispatch());T=void 0},R=function(g){e=!1;b.logMouse&&b.logMouse(g);if(!v.editingComment){var q=
v.viewNode,f=q.mousePos(g);if(b.isViewEventTarget(g.target)){var B=g.button||0,h=q.inRect(f.x,f.y);if(1==B||0===B&&!h)b.on.beginscroll.dispatch(),T=B,b.setMouseCapture(null,N);else{h=!0;q.focus();e=!0;if(0===B){q=x.selectionMode;if("rect"===q||"cell"===q)P.startRectSelection(f.x,f.y,g)&&(d=!0,b.setMouseCapture(Ca)),h=!1;else if("text"==q){var m,q=1;if(void 0!==u){var k;if(g.pageX||g.pageY)m=g.pageX,k=g.pageY;else if(g.clientX||g.clientY)m=g.clientX,k=g.clientY;m=Math.abs(m-p.x);k=Math.abs(k-p.y);
3>=m&&3>=k&&((new Date).getTime()-u<=x.doubleClickInterval&&(q=J+1),u=void 0)}m=q;var l;2===m?l="word":m=1;if(P.startTextSelection(f.x,f.y,l,g))if(c=!0,b.setMouseCapture(Z),f=m,u=(new Date).getTime(),J=f,g.pageX||g.pageY)p={x:g.pageX,y:g.pageY};else if(g.clientX||g.clientY)p={x:g.clientX,y:g.clientY};h=!1}a=!0}!1===h&&jb(g);return h}}}},ra=function(e){var g;b.logMouse&&b.logMouse(e);if(k)g=k.call(t,e);else if(a){g=!0;if(!v.editingComment){var q=v.viewNode.mousePos(e);0===(e.button||0)&&(d?(d=!1,b.releaseMouseCapture(),
P.endRectSelection(q.x,q.y,e)):(c&&(c=!1,b.releaseMouseCapture()),P.endTextSelection(q.x,q.y,e)),g=!1)}a=!1}!1===g&&jb(e);return g},fa=function(a){if(!v.editingComment&&b.isViewEventTarget(a.target))if(a.ctrlKey){if(!x.browserZoom)return 0<a.wheelDelta?OIT.document.zoomIn():0>a.wheelDelta&&OIT.document.zoomOut(),jb(a),!1}else b.on.beginscroll.dispatch(),void 0!==W&&ua(W),W=ea(C,500)},C=function(){W=void 0;b.on.endscroll.dispatch()};b.setMouseCapture=function(a,c,d){b.releaseMouseCapture();"function"===
typeof a&&(K.addEventListener("mousemove",I,!0),f=a);"function"===typeof c&&(k=c);if(f||k)y.body.onmouseover(q),y.body.onmouseout(B);t=d};var I=function(a){if(f&&!1===f.call(t,a))return jb(a),!1},q=function(a){if(G){var b=ha(a);if(b!==G.buttons&&G.buttons&1&&!(b&1)){var b=G,c;X.createEvent?(c=X.createEvent("MouseEvent"),c.initMouseEvent("mouseup",!0,!0,K,null,b.screenX,b.screenY,b.clientX,b.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.relatedTarget)):c=new MouseEvent("mouseup",{screenX:b.screenX,
screenY:b.screenY,clientX:b.clientX,clientY:b.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:0,buttons:a.buttons,relatedTarget:a.relatedTarget,region:a.region});ra(c)}G=void 0}},B=function(a){G={buttons:ha(a),screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}};b.releaseMouseCapture=function(){f&&(K.removeEventListener("mousemove",f,!1),f=null);k=null;y.body.offmouseover(q);y.body.offmouseout(B)};b.setTouchCapture=function(a,c,d,e){b.releaseTouchCapture();
"function"===typeof a&&(y.listen("touchmove",ba,{capture:!0,passive:!1}),r=a);"function"===typeof c&&(y.listen("touchend",aa,{capture:!0,passive:!1}),w=c);"function"===typeof d&&(y.listen("touchcancel",da,{capture:!0,passive:!1}),n=d);l=e};var ba=function(a){r&&r.call(l,a)},aa=function(a){w&&w.call(l,a)},da=function(a){n&&n.call(l,a)};b.releaseTouchCapture=function(){r&&(y.unlisten("touchmove",ba,!1),r=null);l=n=w=null};var Ca=function(a){if(d){var b=v.viewNode.mousePos(a);P.extendRectSelection(b.x,
b.y,a);return!1}return!0},Z=function(a){if(c){var b=v.viewNode.mousePos(a);P.extendTextSelection(b.x,b.y,a);return!1}return!0};b.isViewEventTarget=function(a){for(var b=v.viewNode;a;){if(b.equals(a))return!0;if("TEXTAREA"===a.tagName||"SELECT"===a.tagName)break;if("oit-em_allheaders"===a.id)break;if(y.hasClass(a,"oit-emheadervalues")||y.hasClass(a,"oit-em_allheaders")||y.hasClass(a,"oit-note-icons")||y.hasClass(a,"oit-ssoverlay"))return!0;if(y.hasClass(a,"oit-button")||y.hasClass(a,"oit-note")||y.hasClass(a,
"oit-expander"))break;a=a.parentNode}return!1};var ha=function(a){var b;if(void 0!==a.buttons)b=a.buttons;else switch(a.button){case 0:b=1;break;case 1:b=4;break;case 2:b=2;break;case 3:b=8;break;case 4:b=16}return b},Ra=function(a){"text"===P.selectionType()&&P.select(null);A.deactivateAnnotation();var b=a.center;L.activateNearest(b.x,b.y,a.srcEvent)},qa=function(a){e=!1;if(!v.editingComment){var b=a.center;v.viewNode.focus();e=!0;var g=x.selectionMode;"rect"===g||"cell"===g?(d=!0,P.startRectSelection(b.x,
b.y)):"text"==g&&P.startTextSelection(b.x,b.y,"word",a)&&(c=!0)}},pa=function(a){var b;if(d||c)d?(d=!1,b=a.center,P.endRectSelection(b.x,b.y,a.srcEvent)):c&&(c=!1,b=a.center,P.endTextSelection(b.x,b.y,a.srcEvent))},ca=function(a){a.press||(a=v.viewNode,Q=a.scroll(),g=z=0,m=a.scrollWidth-a.clientWidth,O=a.scrollHeight-a.clientHeight,F.startElasticScroll())},Da=function(a){if(a.press)d?(a=a.center,P.extendRectSelection(a.x,a.y)):c&&(a=a.center,P.extendTextSelection(a.x,a.y));else if(Q){var b=v.viewNode,
e=a.delta,q=Q.left-e.x,e=Q.top-e.y,f=ma(q,0,m),B=ma(e,0,O);b.autoscroll(f,B);a.kinetic||(z=q-f,g=e-B,(z||g)&&F.elasticScroll(z,g))}},Eb=function(a){a.press||(Q=void 0,F.endElasticScroll(z,g),g=z=0)},vb=function(a){D=x.zoom;b.on.beginpinchzoom.dispatch()},pb=function(a){D&&E.zoom(D*a.scale,a.center,!0)},db=function(a){D=void 0;b.on.endpinchzoom.dispatch()},M=function(a){h=x.rotation},U=function(a){if(void 0!==h){var b=h;a=Wb(180*a.rotation/Math.PI,"deg");60<a&&300>a&&(b=135>a?b+90:225>a?b+180:b+270);
E.rotate(b)}},S=function(a){h=void 0}}}),ia=ta.extend("content",{events:{data:{},add:{},first:{},last:{}},install:function(b){var e=!1,a=!0,d=!1,c=[],f=[],k,t,r,w=0,n=!1,l=!1,u=null,p=[],J=function(){k&&(k.hide(),k=null)},W=function(a){a&&(f.push({data:a}),e&&!r&&(r=ea(m,0)),(a=c.shift())&&a.destroy())},T=function(a){a={url:a,cache:!0,retryDelay:0,pendingText:""};a.ajax=Ja({url:a.url,cache:a.cache,complete:h,args:[a]});f.push(a)};b.isPending=function(){return 0<f.length||0<p.length||!v.documentComplete};
b.manifest=function(){return u};b.initializeContent=function(a,b,c){OIT.content&&(W(OIT.content),delete OIT.content);c?(v.singlePageIndex=Number(c),b&&v.dynamicContent&&Q(b)):b?(v.dynamicContent=!0,Q(b)):a&&"none"!==a&&(v.dynamicContent=!0,D(a));e=!0;0<f.length&&!r&&(r=ea(m,0))};var G=function(a){if(!t&&a){if((void 0===x.outputBaseUrl||null===x.outputBaseUrl||""===x.outputBaseUrl)&&x.detectBaseUrl&&"/"!=a[0]&&0!==a.search(/http/i)){var b=v.URL.lastIndexOf("/");if(-1!=b){b=v.URL.substr(0,b+1);if(0===
b.search(/http/i)){var c=X.createElement("a");c.href=b;b=c.pathname||c.pathName;"/"!=b[0]&&(b="/"+b)}0!==a.indexOf(b)&&(v.baseURL=b||null)}}t=v.baseURL}return t},Q=function(a){if(a){var b=G(a);b&&"/"!=a.charAt(0)&&(a=Ma(b,a));0===v.URL.indexOf("file://")?(b=y.create("script"),b.attr("src",a),y.head.append(b),c.push(b)):T(a)}},D=function(a){if(a&&"none"!==a){var b=G(a);b&&"/"!=a.charAt(0)&&(a=Ma(b,a));T(a)}},h=function(c,d,e,g,m){m.status=g;404===g&&(e="");200===g||404==g?0===e.length||0===e.indexOf("%")?
(e!==m.pendingText&&(m.pendingText=e,m.retryDelay=0),m.retryDelay>x.contentTimeout?(J(),b.logAJAXError(null,"Timed out while loading the document content data from the server",c,Tb),eb(),f=[]):(a&&(k||(k=Ba.createProgressDialog(U.PLEASE_WAIT_INITIALIZING,!1))),m.cache=!1,m.retryDelay+=200,ea(function(){m.ajax=Ja({url:m.url,cache:m.cache,complete:h,args:[m]})},200))):(z(m,e),J()):(J(),b.logAJAXError(null,"Failed to load the document content data from the server",c,g,e),eb(),f=[])};b.isICD=function(a){return"if(window.OIT&&OIT.icd)OIT.icd("==
a.substring(0,31)};var z=function(a,c){var d,e=c.indexOf("else OIT.content={");-1!=e?(e+=18,d=c.lastIndexOf("}"),-1!=d&&(c="{"+c.substring(e,d)+"}")):b.isICD(c)&&(e=31,d=c.lastIndexOf(");"),-1!=d&&(c=c.substring(e,d)));try{var g=JSON.parse(c);a.data=g;r||(r=ea(m,0))}catch(C){b.logAJAXError(null,"Document data is corrupt ("+C+")",a.url,a.status,c)}},g=function(a){Ja({url:a,complete:function(a,c,d,e){if(200==e)try{u=JSON.parse(d);var g=u.files?u.files.content:null;if(g){for(c=1;c<g.length;c++)p.push(g[c].url);
m()}}catch(I){b.logAJAXError(null,"The document manifest is corrupt ("+I+")",a,e,d),l=!1,u=null}else b.logAJAXError(null,"Failed to load the document manifest from the server",a,e,d),l=!1,u=null}})},m=function(){r=void 0;if(e&&!n&&0<f.length&&f[0].data){for(var c=a;0<f.length&&f[0].data;){var h=f.shift();if(h.data.info&&h.data.info.manifest&&v.dynamicContent){var m=h.data.info.manifest,k=G(m);k&&"/"!=m.charAt(0)&&(m=Ma(k,m));g(m);l=!0}O(h.data);a=!1;void 0===v.singlePageIndex?h.data.nextContent?l||
Q(h.data.nextContent):h.data.nextData?l||D(h.data.nextData):d=!0:d=!0}c&&b.on.first.dispatch();b.on.add.dispatch();d&&b.on.last.dispatch()}for(;20>f.length&&0<p.length;)D(p.shift())},O=function(c){if(c){if(c.info&&c.info.version){var d=c.info.version.split("."),e=parseInt(d[0],10),g=parseInt(d[1],10),d=parseInt(d[2],10);0<e&&0<=g&&9>=g&&0<=d&&9>=d&&(w=e+g/10+d/100)}b.on.data.dispatch(c,a,w)}};b.processICD=function(a,c,d){if(b.isICD(a)){var e=a.lastIndexOf(");");if(-1!=e){a=a.substring(31,e);try{a=
JSON.parse(a),O(a)}catch(fa){b.logAJAXError(null,"ICD data is corrupt ("+fa+")",c,d,a)}}}};E.onreset(function(){r&&ua(r);J();e=!1;a=!0;d=!1;c=[];f=[];r=t=k=void 0;w=0;l=n=!1;u=null;p=[];v.singlePageIndex=void 0;b.on.add.reset()});Wa.onbeginscroll(function(){n=!0});Wa.onendscroll(function(){n=!1;m()});ob("icd",W)}}),E=ta.extend("document",{exports:"cellRange cellSelection externalData externalValue find findAll getOptions getRawText getSelectedText highlight print properties rectRange rectSelection removeExtraEmailHeaders rotate select selection selectionMode selectionStyle selectionType setOptions showHidden textRange textSelection updateViewSize zoom zoomIn zoomOut".split(" "),
events:{load:{pub:!0,detail:function(){return{url:v.URL}},onAdd:function(b,e){v.documentLoaded&&ea(function(){b.dispatchTo(e)},0)}},reset:{},unload:{pub:!0},zoom:{pub:!0,detail:function(b,e,a){return{zoom:b,mode:e}}},rotate:{pub:!0,detail:function(b){return{angle:b}}},resize:{},idle:{pub:!0,onListen:function(){E.resetIdleTimer()},onUnlisten:function(){E.resetIdleTimer()},onAdd:function(){E.resetIdleTimer()},onRemove:function(){E.resetIdleTimer()}},error:{pub:!0,detail:function(b,e){return{message:b,
fatal:!!e}}},select:{pub:!0,detail:function(b,e,a,d,c){b={selection:b,empty:d};e&&a&&(b.start=e,b.end=a);void 0!==c&&(b.highlightid=c);return b}},scroll:{pub:!0,detail:function(b,e,a,d){e=v.viewNode;b=A.mapToPage(0,0);e=A.mapToPage(e.clientWidth,e.clientHeight);return b&&e?{viewUpperLeft:{pageIndex:b.page.index,x:b.x,y:b.y},viewLowerRight:{pageIndex:e.page.index,x:e.x,y:e.y}}:{viewUpperLeft:{pageIndex:0,x:0,y:0},viewLowerRight:{pageIndex:0,x:0,y:0}}}},scrollupdate:{delay:200},keydown:{pub:!0,detail:function(b){return{srcEvent:b}}},
optionschanged:{pub:!0,detail:function(b){return b}},showmessage:{pub:!0,detail:function(b,e,a){return{message:b||"",modal:e||!1,progress:a||!1}}},progress:{pub:!0,detail:function(b){return{percentDone:b||0}}},hidemessage:{pub:!0},done:{pub:!0},hiddencontent:{pub:!0,detail:function(b,e){var a={},d,c;for(c=0;c<e.length;c++)d=e[c],d.supported&&b[d.name]&&(x[d.option]!==d.optionValue?(a.supportedNotVisible||(a.supportedNotVisible=[]),a.supportedNotVisible.push(U[d.message])):(a.supportedVisible||(a.supportedVisible=
[]),a.supportedVisible.push(U[d.message])));for(c=0;c<e.length;c++)d=e[c],!d.supported&&b[d.name]&&(a.unsupported||(a.unsupported=[]),a.unsupported.push(U[d.message]));return a}},ajax:{pub:!0,single:!0,detail:function(b){return{request:b}}},ajaxabort:{pub:!0,single:!0,detail:function(b){return{request:b}}},highlight:{pub:!0,detail:function(b,e,a,d){return{highlights:b,searchTerm:e,style:a,properties:d}}}},install:function(b){var e=[.1,.25,.5,.75,1,1.25,1.5,2,3,5,10,20,40],a=e[0],d=e[e.length-1],c=
["rows","columns","all","none"],f=[{name:"hidden-pages",supported:!0,message:"HIDDEN_CONTENT_PAGES",option:"showHiddenSheets",optionValue:!0},{name:"hidden-columns",supported:!0,message:"HIDDEN_CONTENT_COLUMNS",option:"showHiddenColumns",optionValue:!0},{name:"hidden-rows",supported:!0,message:"HIDDEN_CONTENT_ROWS",option:"showHiddenRows",optionValue:!0},{name:"hidden-text",supported:!0,message:"HIDDEN_CONTENT_TEXT",option:"showAnnotations",optionValue:!0},{name:"comments",supported:!0,message:"HIDDEN_CONTENT_COMMENTS",
option:"showAnnotations",optionValue:!0},{name:"tracked-changes",supported:!0,message:"HIDDEN_CONTENT_TRACKED_CHANGES",option:"showAnnotations",optionValue:!0},{name:"speaker-notes",supported:!0,message:"HIDDEN_CONTENT_SPEAKER_NOTES",option:"showSlideNotes",optionValue:!0},{name:"hidden-slides",supported:!0,message:"HIDDEN_CONTENT_SLIDES",option:"presentationMode",optionValue:"normal"},{name:"comments-unsupported",supported:!1,message:"HIDDEN_CONTENT_COMMENTS"},{name:"hidden-text-unsupported",supported:!1,
message:"HIDDEN_CONTENT_TEXT"},{name:"tracked-changes-unsupported",supported:!1,message:"HIDDEN_CONTENT_TRACKED_CHANGES"},{name:"large-sheet-unsupported",supported:!1,message:"HIDDEN_CONTENT_LARGE_SHEET"}],k=!1,t,r,w,n=!1,l,u,p={},J={},W,T,G,Q={},D,h=[],z={},g,m=!1,O,H=0,N;b.properties=function(){if(v.documentLoaded)return bb(p)};b.externalValue=function(a){if(v.documentLoaded)return J[a]};b.externalData=function(){if(v.documentLoaded)return J};b.revisions=function(){return N};b.getOptions=function(a){if(void 0===
a){a=x.items();var b={},c;for(c in a)x.isPublic(c)&&(b[c]=x[c]);b.showSlideComments=b.showAnnotations;return b}if(a&&"string"==typeof a&&("showSlideComments"===a&&(a="showAnnotations"),x.isPublic(a)))return x[a]};b.setOptions=function(a){if(a){for(var b in a){"showSlideComments"===b&&(b="showAnnotations");var c=a[b];x.isPublic(b)&&x[b]!=c&&(x[b]=c)}qa()}};Wa.onbeginpinchzoom(function(a,b){k=!0});Wa.onendpinchzoom(function(){k=!1;b.dispatchPageEvents(!0);Sa()});var R=function(b){b<a?b=a:b>d&&(b=d);
return b};b.zoom=function(a,c,d){if("number"===typeof a){var e=R(a);e!=a&&(d||b.invalidArg("zoom","zoom",a,"using fallback zoom factor "+e,!1),a=e);if(x.zoomMode||a!=x.zoom)x.zoom=a,x.zoomMode=null,b.dispatchPageEvents(!1,c)}else"string"===typeof a?a!=x.zoomMode&&(x.zoomMode=a,b.dispatchPageEvents(!1,c)):"undefined"===typeof a||d||b.invalidArg("zoom","zoom",a);return x.zoom};b.zoomIn=function(){for(var a=0;a<e.length;a++)if(e[a]>x.zoom){b.zoom(e[a]);break}return x.zoom};b.zoomOut=function(){for(var a=
e.length-1;0<=a;a--)if(e[a]<x.zoom){b.zoom(e[a]);break}return x.zoom};b.rotate=function(a){"number"===typeof a?x.rotation=Wb(a,"deg"):void 0!==a&&b.invalidArg("rotate","angle",a,"Angle must be an integer multiple of 90 degrees.");return x.rotation};b.showHidden=function(a){v.documentLoaded&&!v.documentUnloading&&F.features().showhidden&&(void 0!==a&&-1==c.indexOf(a)?b.invalidArg("showHidden","mode",a,"Must be one of "+JSON.stringify(c)):F.showHidden(a))};var ra=[{name:"searchTerm",type:["string",
"RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"direction",type:"string",legal:["up","down"],def:"down"},{name:"startACC",type:"number"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];b.find=function(a,c,d,e,g){if(v.documentLoaded&&!v.documentUnloading){var q=b.processArguments("find",arguments,ra);q&&ea(aa,0,{finder:na.findStart(q.searchType,q.searchTerm,q.caseSensitive,
q.direction,g),callbackFn:q.callbackFn})}};var fa=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"searchType",type:"string",legal:"string dtsearch lucene phsterms literal literal*".split(" "),def:"string"}];b.findAll=function(a,c,d){if(v.documentLoaded&&!v.documentUnloading){var e=b.processArguments("findAll",arguments,fa);e&&b.findAllArgs(e)}};b.findAllArgs=function(a){v.documentLoaded&&!v.documentUnloading&&
a&&ea(da,0,{finder:na.findStart(a.searchType,a.searchTerm,a.caseSensitive),callbackFn:function(c){var d=!0;if(!c){if(a.callbackFn)try{a.callbackFn.call(null)}catch(vb){b.logError("findAll","Exception in callback function: "+vb)}d=!1}else if(a.callbackFn)try{d=a.callbackFn.call(null,c.range)}catch(vb){b.logError("findAll","Exception in callback function: "+vb),d=!1}!1!==d&&(d=!0);return d},startIterationFn:null,endIterationFn:null})};b.getRawText=function(a){v.documentLoaded&&(Oa(a)?ea(Ca,0,{callbackFn:a,
textBlockIndex:0}):b.invalidArg("getRawText","callbackFunction",a,"must be a function"))};var C=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"style",type:"string",req:!0},{name:"callbackFn",type:"function"},{name:"caseSensitive",type:"boolean",def:!0},{name:"properties",type:"object"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];b.highlight=function(a,c,d,e,g){if(v.documentLoaded)if(!1===na.hasRawText())b.logError("highlight",
"Search functionality has been disabled for this document");else if(L)if(!1===F.features().highlights)b.logError("highlight","Highlighting functionality is not available for this document type");else if("object"===typeof c){var q=c,q={searchTerm:a,style:q.style,searchType:q.mode||"string",properties:q.properties,callbackFn:q.callbackFn,caseSensitive:!1!==q.caseSensitive,visible:!1!==q.visible,enableUserDelete:!1!==q.enableUserDelete,enableUserMove:!1!==q.enableUserMove,enableUserResize:!1!==q.enableUserResize,
enableUserComment:!1!==q.enableUserComment,stemAll:!0===q.stemAll};b.highlightArgs(q)}else(q=b.processArguments("highlight",arguments,C))&&b.highlightArgs(q);else b.logError("highlight","Highlighting functionality has been disabled for this document")};b.highlightArgs=function(a){v.documentLoaded&&a&&(a.batchStarted=!1,a.highlights=[],a.complete=!1,a.iteration=0,ea(da,0,{finder:na.findStart(a.searchType,a.searchTerm,a.caseSensitive,"down",void 0,a.stemAll),callbackFn:function(c){var d=!0;if(c){var e;
if(c.terms){e=[];for(var g=0;g<c.terms.length;g++)e.push(c.terms[g].range);e=L.add(a.style,e,a.properties)}else e=L.add(a.style,c.range,a.properties);a.highlights.push(e);!1===a.visible&&L.hide(e);if(!1===a.enableUserDelete||!1===a.enableUserMove||!1===a.enableUserResize||!1===a.enableUserComment)g={},!1===a.enableUserDelete&&(g.enableUserDelete=!1),!1===a.enableUserMove&&(g.enableUserMove=!1),!1===a.enableUserResize&&(g.enableUserResize=!1),!1===a.enableUserComment&&(g.enableUserComment=!1),L.setOptions(e,
g);if(a.callbackFn)try{d=a.callbackFn.call(null,c.range,e,a.highlights,a.searchTerm,a.style,a.properties)}catch(db){b.logError("findAll","Exception in callback function: "+db),d=!1}}else{if(a.callbackFn)try{a.callbackFn.call(null,null,null,a.highlights,a.searchTerm,a.style,a.properties)}catch(db){b.logError("findAll","Exception in callback function: "+db)}d=!1}!1!==d&&(d=!0);d||(a.batchStarted&&L.endBatch(),a.complete=!0,b.on.highlight.dispatch(a.highlights,a.searchTerm,a.style,a.properties));return d},
startIterationFn:function(b){F.suspendUpdate();a.iteration++},endIterationFn:function(){!a.complete&&!a.batchStarted&&2<=a.iteration&&(L.beginBatch(),a.batchStarted=!0);F.resumeUpdate()}}))};b.select=function(a,c){if(v.documentLoaded){var d=!1;if(!1===na.hasRawText())b.logError("select","Javascript selection functionality has been disabled for this document");else if(null===a)d=P.select(null);else if(va(a)||Qa(a))d=P.select(a);else{var e=xa(a,!0,!0);e?(d=b.selection(),d=0!==Ta(e,d),!1!==c?A.movetoEx(e,
{callbackFn:function(){P.select(e)},animate:!1}):P.select(e)):b.invalidArg("select","range",a,"must be a valid text range, cell range, or rect range")}return d}};b.selectionType=function(){if(v.documentLoaded)return P.selectionType()};b.selectionMode=function(a){a&&(x.selectionMode=a);return x.selectionMode};b.selectionStyle=function(a){var c;void 0!==a&&null!==a&&"string"!==typeof a?b.invalidArg("selectionStyle","style",a,"Must be a valid CSS string"):c=P.style(a);return c};b.selection=function(){var a;
if(v.documentLoaded)switch(P.selectionType()){case "text":a=P.textSelection();break;case "cell":a=P.cellSelection();break;case "rect":a=P.rectSelection()}return a};b.textSelection=function(){if(v.documentLoaded)return P.textSelection()};b.cellSelection=function(){if(v.documentLoaded)return P.cellSelection()};b.rectSelection=function(){if(v.documentLoaded)return P.rectSelection()};b.getSelectedText=function(){if(v.documentLoaded)return F.getSelectedText()};b.textRange=function(){return ka.apply(this,
arguments)};b.cellRange=function(){return sa.apply(this,arguments)};b.rectRange=function(){return mb.apply(this,arguments)};b.updateViewSize=function(){la.dispatchResize()};var I=function(){if(F.features().fitpage){var a=90==x.rotation||270==x.rotation,b,c=F.padding();b=F.margin();var d=c.left+c.right+b.left+b.right,c=c.top+c.bottom+b.top+b.bottom;a?(a=F.maxPageHeight(),b=F.maxPageWidth()):(a=F.maxPageWidth(),b=F.maxPageHeight());var a=a+A.annotationPaneWidth(),e=v.viewNode;return{w:R((e.clientWidth-
d)/a),h:R((e.clientHeight-c)/b)}}};b.dispatchPageEvents=function(a,c){!1!==a&&(a=!0);if(v.documentLoaded&&!m){var d;if(x.zoomMode){var e=1;if(d=I()){switch(x.zoomMode){case "page":e=Math.min(d.w,d.h);break;case "pagewidth":e=d.w;break;case "pageheight":e=d.h;break;case "mobile":switch(v.deType){case "page":e=d.h<d.w&&d.h>=.9*d.w?d.h:d.w;break;case "drawing":e=(e=la.infoRaw())&&1557===e.fi?d.w:Math.min(d.w,d.h);break;case "slide":case "chart":case "bitmap":e=Math.min(d.w,d.h)}}e=R(e)}x.zoom=e}else if(v.nochrome||
v.isMobile)if(d=I())d=Math.min(d.w,d.h),x.zoom<d&&(x.zoom=d);d=x.zoom;var e=W!=d||T!=x.zoomMode,g=G!=x.rotation;if(a||e||g)F.layoutChanged(c),la.invalidateCanvas(),v.drawing&&v.drawing.update(!0);if(a||e)W=d,T=x.zoomMode,b.on.zoom.dispatch(d,x.zoomMode,k);if(a||g)G=x.rotation,b.on.rotate.dispatch(x.rotation);la.dispatchScroll(a)}};var q=function(){b.dispatchPageEvents(!0)};b.resetIdleTimer=function(){var a;t&&(ua(t),t=null);r&&(Pa(r),r=null);b.on.idle.hasListeners()&&v.documentLoaded&&!v.documentUnloading?
(n||(a=b.resetIdleTimer,y.listen("mousemove",a,!0),y.listen("touchmove",a,!0),y.listen("keydown",a,!0),b.onscroll(a),n=!0),t=ea(function(){r=sb(function(){b.on.idle.dispatch(!1)},50,b.on.idle)},200),w||(w=sb(function(){b.on.idle.dispatch(!0)},500,b.on.idle))):(w&&(Pa(w),w=null),a=b.resetIdleTimer,y.unlisten("mousemove",a),y.unlisten("touchmove",a),y.unlisten("keydown",a),b.offscroll(a))};var B=function(){var a=F.pageRect(A.count()-1,"overlay");a&&(a=a.bottom-20*(A.count()-1),b.printCSS(".oit-view-root",
"height:"+a+"px;"));for(;void 0!==H;)if(A.on.change.disable(),a=A.page(H))if(a.overlay&&!a.overlay.isHidden()){a.load(!0,ba);H=void 0;break}else H++;else{if(!v.documentComplete)break;b.logFatalError(null,"No visible pages were found in the document");H=void 0;break}},ba=function(a){A.moveto(a.index);v.documentLoaded=!0;b.on.load.dispatch();v.documentLoading=!1;A.on.change.enable();A.dispatchChange(void 0,!0);b.dispatchPageEvents(!0);v.documentComplete&&b.on.done.dispatch();b.resetIdleTimer()};b.installDocument=
function(a,c){var d=!0,e=y.create("div");e.html(c);(e=e.byClass("oit-view-root"))&&0<e.length&&(e=e[0]);var g,q,f;e&&(g=e.data("icd"),q=e.data("json"),f=e.data("page"));if(!g&&!q||"none"==q)d="This document can't be loaded into the web view.",la.logFatalError("load","none"==q?d+" \nThe html file must be created in Ajax mode.":d+" \nThe html file does not appear to have been created by Web View Export.",c),d=!1;else{if(rc(a)){var e=X.URL,B=e.indexOf("//");if(-1===B)v.URL=a;else{var B=B+2,h=e.lastIndexOf("/"),
e=-1!=h&&h>B?e.substr(0,h+1):e+"/";"/"===a[0]&&(B=e.indexOf("/",B)+1,e=e.substr(0,B));v.URL=Ma(e,a)}}else v.URL=a;ia.initializeContent(q,g,f);b.initializeDocument()}return d};b.unload=function(){var a=v.documentLoaded;v.documentUnloading=!0;F.suspendUpdate();b.resetIdleTimer();try{F.unloadDisplay()}catch(Da){b.logError("unload","Error while unloading display ("+Da+")")}v.documentLoaded=!1;v.documentComplete=!1;v.hasHiddenText=!1;v.hasWorksheetRevisions=!1;try{P.reset()}catch(Da){b.logError("unload",
"Error while resetting selection ("+Da+")")}try{L.clear()}catch(Da){b.logError("unload","Error while clearing highlights ("+Da+")")}try{bc()}catch(Da){b.logError("unload","Error while aborting timers ("+Da+")")}try{eb()}catch(Da){b.logError("unload","Error while aborting AJAX requests ("+Da+")")}try{b.on.reset.dispatch()}catch(Da){b.logError("unload","Error while resetting view ("+Da+")")}a&&b.on.unload.dispatch();x.zoom=1;x.zoomMode=null;k=!1;H=0;t&&(Pa(t),t=null);r&&(Pa(r),r=null);w&&(Pa(w),w=null);
p={};J={};h=[];v.documentLoading=!1;z={};m=!1;N=null;g&&(g.destroy(),g=null);O&&(O.destroy(),O=null);v.drawing&&(v.drawing.destroy(),v.drawing=void 0);l&&(l.destroy(),l=void 0);u&&(u.destroy(),u=void 0);(a=v.viewNode)&&a.html("");v.URL=X.URL;ia.onadd(B);v.documentUnloading=!1;F.resumeUpdate()};b.initializeDocument=function(){v.viewNode&&(v.drawing=new Wc(v.viewNode),u=new Db("screen"),0<A.count()&&b.updateViewSize())};b.screenCSS=function(a,b){if(u)if(null===b)u.deleteRule(a);else if("string"==typeof b)u.setRule(a+
"{"+b+"}",a);else if("object"==typeof b){var c=a+"{",d;for(d in b)c+=d+":"+b[d]+";";u.setRule(c+"}",a)}};b.printCSS=function(a,b){l||(l=new Db("print"));if(null===b)l.deleteRule(a);else if("string"==typeof b)l.setRule(a+"{"+b+"}",a);else if("object"==typeof b){var c=a+"{",d;for(d in b)c+=d+":"+b[d]+";";l.setRule(c+"}",a)}};var aa=function(){var a=na.findNext(this.finder);a||!ia.isPending()&&!na.isPending()?(a?this.callbackFn.call(null,a.range):this.callbackFn.call(null),ia.offadd(aa),na.offadd(aa)):
(ia.onadd(this,aa),na.onadd(this,aa))},da=function(){var a=!0,b=!1;if(!this.aborted){this.curACC||(this.curACC=0);if(this.startIterationFn){var c=100*this.curACC/na.lastACC();this.startIterationFn(c)}for(c=0;100>c;c++){var d=na.findNext(this.finder);if(d){if(this.curACC=d.range.acc,!1===this.callbackFn.call(null,d)){a=!1;b=!0;break}}else{ia.isPending()||na.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}}if(a)ea(da,50,this);else if(b)ia.offadd(da),na.offadd(da),this.aborted=!0;else if(ia.isPending()||
na.isPending())ia.onadd(this,da),na.onadd(this,da);this.endIterationFn&&this.endIterationFn()}},Ca=function(){for(var a=!0,b=!1,c=0;10>c;c++){var d=na.getRawTextBlock(this.textBlockIndex);if(d)if(d.text){var e=d.text,g=d.range.acc;if(void 0!==this.acc){var q=this.acc-d.range.acc;0<q&&(e=e.substring(q),g+=q)}this.acc=d.range.accend;if(!1===this.callbackFn.call(null,e,g)){a=!1;b=!0;break}this.textBlockIndex++}else{a=!1;break}else{ia.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}}a?ea(Ca,
50,this):b?(ia.offadd(Ca),na.offadd(Ca)):(ia.onadd(this,Ca),na.onadd(this,Ca))};b.removeExtraEmailHeaders=function(){x.removeExtraEmailHeaders=!0};b.externalLinks=function(){return h};var Z=function(a,c){m=!0;b.setOptions({showHiddenSheets:c,showHiddenColumns:c,showHiddenRows:c,showAnnotations:c,showSlideNotes:c,presentationMode:c?"normal":"slideshow"});m=!1;A.updateShowSlideNotes();b.dispatchPageEvents(!0);ha();g.collapse();return!1};b.supressHiddenContentUpdate=function(){return m};var ha=function(){var a,
b;if("none"===x.showHiddenContentNotification)g&&g.css("display","none");else if(!v.staging&&g&&!m){var c=[],d=!1,e=!1;for(b=0;b<f.length;b++)a=f[b],a.supported&&z[a.name]&&(c.push("<li>",U[a.message],"</li>"),x[a.option]!==a.optionValue?d=!0:e=!0);var q=[];0<c.length&&(q.push(U.HIDDEN_CONTENT_NOTIFICATION,"<div><ul>"),Array.prototype.push.apply(q,c),q.push("</ul>"),d?q.push(U.HIDDEN_CONTENT_INVISIBLE,'</div><div><a class="oit-showhiddenlink">',U.HIDDEN_CONTENT_SHOWLINK,"</a></div>"):q.push(U.HIDDEN_CONTENT_ALREADY_VISIBLE,
'</div><div><a class="oit-hidehiddenlink">',U.HIDDEN_CONTENT_HIDELINK,"</a></div>"));var c=[],B=!1;for(b=0;b<f.length;b++)a=f[b],!a.supported&&z[a.name]&&(c.push("<li>",U[a.message],"</li>"),B=!0);0<c.length&&(0<q.length&&q.push("<div>&nbsp;</div>"),q.push(U.HIDDEN_CONTENT_ORIGINAL_APPLICATION,"<div><ul>"),Array.prototype.push.apply(q,c),q.push("</ul></div>"));q=q.join("");g.message(q);g.css("display",null);d||B?e?g.title(U.HIDDEN_CONTENT_PARTIAL):g.title(U.HIDDEN_CONTENT_HIDDEN):g.title(U.HIDDEN_CONTENT_VISIBLE);
"expanded"===x.showHiddenContentNotification?g.expand(!1):g.collapse(!1);if(d){if(a=g.byClass("oit-showhiddenlink"))a[0].onclick(null,Z,!0),a[0].ontap(null,Z,!0)}else if(a=g.byClass("oit-hidehiddenlink"))a[0].onclick(null,Z,!1),a[0].ontap(null,Z,!1)}x.showAnnotations?v.viewNode.addClass("oit-showannotations"):v.viewNode.removeClass("oit-showannotations")};b.hiddenContent=function(a){z[a]||(z[a]=!0,g||(g=new Ec({title:U.HIDDEN_CONTENT_HIDDEN,collapseButton:!0}),g.onexpand(function(){x.showHiddenContentNotification=
"expanded"}),g.oncollapse(function(){x.showHiddenContentNotification="collapsed"})),ha(),b.on.hiddencontent.dispatch(z,f))};b.documentException=function(a){};b.showNotifications=function(){ha()};var Ra=function(a,b,c){Q[c]=a;D||(D=ea(qa,50))},qa=function(){if(D){var a=Q;Q={};ua(D);D=void 0;b.on.optionschanged.dispatch(a)}};b.print=function(){K.print()};ia.onadd(B);ia.ondata(function(a,c,d){var e;if(a.properties)for(e in a.properties)p[e]=a.properties[e];if(a.external)for(e in a.external)J[e]=a.external[e];
if(a.options){for(var g in a.options)if(c=a.options[g],d=g.indexOf("."),0<d){var q=g.substring(0,d);g=g.substring(d+1);if("glob"==q||"opt"==q)d="glob"==q?v:x,d.hasOwnProperty(g)&&(d[g]=c)}v.hasHiddenText&&b.hiddenContent("hidden-text-unsupported");v.hasWorksheetRevisions&&b.hiddenContent("tracked-changes-unsupported")}if(a.info&&a.info.status)for(e in a.info.status)a.info.status[e]&&b.documentException(e);a.xlinks&&(h=h.concat(a.xlinks));a.revisions&&(N=N?N.concat(a.revisions):a.revisions.slice(0))});
ia.onlast(function(){if(N){for(var a=!1,c=!1,d=!1,e=!1,g=0;g<N.length;g++){var q=N[g],f=!0;c&&e||"add"!==q.type&&"delete"!==q.type?a&&d||"hidden"!=q.type||(f=!1):f=!1;if(!f){var B;q.range&&(B=A.forRange(q.range),B||(f=A.lastPage(),q.range.acc>f.accend&&(B=f)));B&&"page"===B.type?"add"===q.type||"delete"===q.type?c=!0:"hidden"===q.type&&(a=!0):"add"===q.type||"delete"===q.type?e=!0:"hidden"===q.type&&(d=!0)}}a&&b.hiddenContent("hidden-text");c&&b.hiddenContent("tracked-changes");d&&b.hiddenContent("hidden-text-unsupported");
e&&b.hiddenContent("tracked-changes-unsupported")}v.documentComplete=!0;v.documentLoaded&&b.on.done.dispatch()});la.onresize(function(){v.editingComment?L.alignComment():b.dispatchPageEvents(!0)});A.onchange(function(){1!=A.activeOverlay().length&&"vertical"==x.scrollMode||b.dispatchPageEvents(!0)});x.oncenterPages(q);x.onrotation(q);x.onshowHiddenSheets(ha);x.onshowHiddenColumns(ha);x.onshowHiddenRows(ha);x.onshowAnnotations(ha);x.onshowSlideNotes(ha);x.onpresentationMode(ha);x.onshowHiddenContentNotification(ha);
var q=x.items(),pa;for(pa in q)if(x.isPublic(pa))x["on"+pa](Ra)}}),A=ta.extend("pages",{exports:"count current info moveto movetoNext movetoPrev pageName ranges".split(" "),events:{change:{pub:!0,detail:function(b){return A.info(b.index)}},add:{pub:!0,detail:function(b){return{startPage:b}}},pageload:{},pageunload:{},overlayshow:{},overlayhide:{}},install:function(b){var e=[],a=[],d=null,c=null,f=null,k=0,t=1,r,w,n,l=0,u=0,p=0,J,W,T,G={},Q={},D,h;b.firstPage=function(){var b,c;for(c in a){b=a[c];
break}return b};b.lastPage=function(){var b,c;for(c in a)b=a[c];return b};b.current=function(){return c?c.index:0};b.pageName=function(c){void 0===c&&(c=b.current());if(c=a[c])return c.name};b.count=function(){return a.length};b.each=function(b,c){zb(a,arguments)};b.eachOverlay=function(a,b){zb(e,arguments)};b.moveto=function(a,c){var d;Oa(c)&&(d={callbackFn:c});return b.movetoEx(a,d)};var z=function(a){b.updateActivePage(a.pageIndex);a.callbackFn&&a.callbackFn.call(null,c.index)};b.movetoEx=function(a,
d){d=d||{};v.viewNode.cancelKinetic();if("number"===typeof a)return d.pageIndex=a,m(d);if("object"===typeof a){if(y.isElement(a)||y.isText(a)){d.gotoNode=a;var e=d,g=b.forNode(e.gotoNode);g?(e.pageIndex=N(g.index),e.pageIndex!=g.index&&(e.gotoNode=null),m(e)):(b.logError("moveto","The specified node was not found on any page in the document."),z(e));return c.index}if(e=xa(a))return d.range=ga(e),O(d);if("number"===typeof a.left&&"number"===typeof a.top&&"number"===typeof a.right&&"number"===typeof a.bottom)return d.rect=
a,H(d)}b.logError("moveto","Invalid destination: "+Hb(a));return c.index};var g=function(a,c){var e=a.overlay,g=e!==d;if(!c&&!g)return!1;if(g){L.deactivate();P.select(null);F.unloadDisplay();var q=d,f=v.viewNode;q&&(q.saveScroll=f.scroll(),q.undisplay());e.display()}a.load(!1,function(){d=e;b.updateActivePage(a.index);F.loadDisplay(a)});e.show();e.hasClass("oit-pagestream")?v.viewNode.addClass("oit-pagestream"):v.viewNode.removeClass("oit-pagestream");e.hasClass("oit-emailfill")?v.viewNode.addClass("oit-emailfill"):
v.viewNode.removeClass("oit-emailfill");q=a.css("background")||null;v.viewNode.css("background",q);e.saveScroll?(f.scroll(e.saveScroll),delete e.saveScroll):g&&f.scroll(0,0);e.display();b.updateActivePage();return!0},m=function(e){var q=N(e.pageIndex);if(a[q])if(e.force||e.gotoNode||!c||q!=c.index){var f=a[q];b.touchPage(q);if(f.isLoaded()){q=g(f,e.force);"sn"==f.type&&(x.showSlideNotes=!0);if("vertical"!=x.scrollMode||q)e.animate=!1;b.updateActivePage(f.index);"email"!==f.type&&F.moveto(c.index,
z,e)||z(e)}else f.load(!0,function(){e.force=!0;m(e)}),"email"!==f.type&&f.overlay===d?F.moveto(f.index,null,{animate:!1}):d||g(f)}else e.pageIndex=c.index,z(e);else 0<=q&&ia.isPending()?ia.on.add.listenOnce(function(){m(e)}):(b.logError("moveto","Invalid page index: "+q),void 0!==v.singlePageIndex&&(e.pageIndex=v.singlePageIndex),z(e));if(c)return c.index},O=function(a){if(v.documentLoading)ea(O,0,null,a);else{var d=b.nearestForRange(a.range);if(d)if(d.isPending())g(d),d.load(!0,function(){O(a)});
else if(!c||d.overlay!==c.overlay||"vertical"!=x.scrollMode&&d!==c)d.overlay.show(),m({pageIndex:d.index,callbackFn:function(){O(a)}});else{if("sn"==d.type){x.showSlideNotes=!0;var e=b.page(d.index-1);"slide"==e.type&&e.hiddenFromSlideshow&&(x.presentationMode="normal")}else"slide"==d.type&&d.hiddenFromSlideshow&&(x.presentationMode="normal");F.loadRange(a.range,function(){if(!F.moveto(a.range,z,a))if(b.inAnnotation(a.range)){var c=d.annotationPane();c&&c.activate(a.range,!0,!1,a.callbackFn)}else(c=
F.rangeRect(a.range,"view"))?(a.rect=c,H(a)):(a.pageIndex=d.index,m(a))})}else ia.isPending()?ia.on.add.listenOnce(function(){O(a)}):(b.logError("moveto","The specified range was not found in the document: "+Hb(a.range)),z(a))}return c.index},H=function(a){var b=a.rect,d=v.viewNode,e=d.scroll(),g=b.left+e.left,q=b.right+e.left,f=b.top+e.top,h=b.bottom+e.top,m=e.left,k=e.left+d.clientWidth,p=e.top,l=e.top+d.clientHeight,b=e.left,u=e.top;!0===a.moveToTop?u=f:f<p?(h-=d.clientHeight,0>h&&(h=0),u=f-20,
u<h&&(u=h)):h>l&&(u=h+20-d.clientHeight,u>f&&(u=f));g<m?(q=g-d.clientWidth,0>q&&(q=0),b=g-20,b<q&&(b=q)):q>k&&(b=q+20-d.clientWidth,b>g&&(b=g));b!=e.left||u!=e.top?(E.on.scrollupdate.disable(),e=v.deType,e=!a.moveToTop&&"worksheet"!=e&&"database"!=e,a.animate||(e=!1),e=e?150:0,d.abortAnimation(),d.animate({scrollLeft:b,scrollTop:u,time:e,endFn:function(){E.on.scrollupdate.enable();E.on.scrollupdate.dispatch();z(a)}})):z(a);return c.index};b.movetoPrev=function(a){var d=b.prev();d?b.moveto(d.index,
a):a&&a.call(null,c.index);return c.index};b.movetoNext=function(a){var d=b.next();d?b.moveto(d.index,a):a&&a.call(null,c.index);return c.index};b.info=function(c){void 0===c&&(c=b.current());if(a[c])return a[c].info()};b.next=function(b,d){var e;void 0===b&&(b=c.index);var g=b+1;!1!==d&&a[g]&&"email"==a[b].type&&"rt"==a[g].type&&g++;if(a[g])for(;g<a.length;g++){var q=a[g];if(q&&q.isEnabled()&&!q.overlay.isHidden()&&("sn"!=q.type||x.showSlideNotes)){e=q;break}}return e};b.prev=function(b,d){var e;
void 0===b&&(b=c.index);var g=b-1;!1!==d&&a[g]&&a[g-1]&&"email"==a[g-1].type&&"rt"==a[g].type&&g--;if(a[g])for(;0<=g;g--){var q=a[g];if(q&&q.isEnabled()&&!q.overlay.isHidden()&&("sn"!=q.type||x.showSlideNotes)){e=q;break}}return e};var N=function(b){var c,d;for(d=b;d<a.length;d++)if((c=a[d])&&c.isEnabled()&&!c.overlay.isHidden())return d;for(d=b;0<d;d--)if((c=a[d])&&c.isEnabled()&&!c.overlay.isHidden())return d;return 0};b.loadNextPageFromServer=function(){var b,c;c=F.visiblePages();if(0===c.length)return!1;
var e=c[0].index,g=c[c.length-1].index;0>t?(e-=3,g+=1):g+=3;0>e&&(e=0);g>=a.length&&(g=a.length-1);if(0>t){if(void 0===r||r>g)r=g;for(;r>=e;r--)(c=a[r])&&c.overlay===d&&c.isPending()&&(c.load(!1),b=!0)}else{if(void 0===r||r<e)r=e;for(;r<=g;r++)(c=a[r])&&c.overlay===d&&c.isPending()&&(c.load(!1),b=!0)}return b};b.updateActivePage=function(a){if(d){var e=c,g=v.viewNode.scroll().top;void 0!==a?e=b.page(a)||c:1==d.length?e=d.firstPage:"vertical"==x.scrollMode&&void 0===v.singlePageIndex&&g!=k&&(a=b.mapToPage(10,
20,void 0,!0))&&(e=a.page);g!=k&&(t=g<k?-1:1,k=g);if(e!=c){c=e;d=c.overlay;e=F.visiblePages();for(g=0;g<e.length;g++)b.touchPage(e[g].index);b.dispatchChange(c)}}};b.page=function(b){return a[b]};b.byName=function(b){var c,d;for(d in a)if(a[d].name===b){c=a[d];break}return c};b.forNode=function(a){return y.wrap(a).ancestorData("page")};b.nearestForRange=function(c){var d,e,g,q=b.pagesForRange(c);if(!q&&"text"===c.type)for(e=0;e<a.length;e++)if((g=a[e])&&"drawing"===g.type&&c.accend>=g.acc&&c.acc<=
g.accend){q=[g];break}if(q)if(1==q.length)d=q[0];else if((e=F.visiblePages())&&0<e.length){var f=e[0].index,h=e[e.length-1].index,m;for(e=0;e<q.length;e++)if(g=q[e],g.isEnabled()){var k=g.index,p=0;k<f?p=f-k:k>h&&(p=k-h);!d||p<m?(d=g,m=p):0===p&&(k=F.rangeRect(c,"view"))&&0>k.bottom&&(d=g,m=p)}}return d};b.forRange=function(b,c,d){var e;if(b)switch(c=c||0,!0!==d&&(d=!1),b.type){case "text":for(;c<a.length;c++){var g=a[c];if(g&&b.accend>=g.acc&&b.acc<=g.accend&&(!0!==d||"worksheet"!==g.type&&"database"!==
g.type&&"email"!==g.type||g.isLoaded()||g.load(),g.containsRange(b))){e=g;break}}break;case "cell":case "rect":b.page>=c&&b.page<a.length&&(e=a[b.page])}return e};b.inAnnotation=function(b){var c=!1;if("text"==b.type)for(var d=0;d<a.length;d++){var e=a[d];if(e&&b.accend>=e.acc&&b.acc<=e.accend&&e.inAnnotation(b)){c=!0;break}}return c};b.pagesForRange=function(c,d){for(var e,g=0;g<a.length;){g=b.forRange(c,g,d);if(!g)break;e||(e=[]);e.push(g);g=g.index+1}return e};b.top=function(){var a=F.visiblePages();
if(a&&0<a.length)return a[0].index};b.bottom=function(){var a=F.visiblePages();if(a&&0<a.length)return a[a.length-1].index};b.mapToPage=function(e,g,f,h,m,k){var q;if(f)q=f.pageRect("view");else if(c){f=c;if(f.isHidden()||"sn"===f.type&&!x.showSlideNotes)(f=b.next(c.index))||(f=b.prev(c.index));var B=!0;!0!==h&&"email"==f.type&&(B=!1,0===f.index&&(f=2<=a.length?a[1]:null));f&&(q=f.pageRect("view"));if("vertical"==x.scrollMode&&void 0===v.singlePageIndex&&1<d.length)for(;q;)if(g<q.top){h=b.prev(f.index,
!1)||f;if(h===f||0===f.index||!B&&0===h.index)break;if(h.overlay!=f.overlay)break;var p=h.pageRect("view");if(g>p.bottom){q.top-g>g-p.bottom&&(f=h,q=p);break}f=h;q=p}else if(g>q.bottom){if(f.index==a.length-1)break;h=b.next(f.index,!1)||f;if(h===f||h.overlay!=f.overlay)break;p=h.pageRect("view");if(g<p.top){p.top-g<g-q.bottom&&(f=h,q=p);break}f=h;q=p}else break}B=!1;if(f){if(m&&(e>q.right||e>v.viewNode.clientWidth)&&f.annotationPane()){m=v.viewNode;p=m.pos(y.body);h=e+p.left;var p=g+p.top,l=f.annotationPane().contentRect(y.body);
l&&(h=h+m.scrollLeft-l.left,p=p+m.scrollTop-l.top,k||0<=h&&0<=p&&h<=l.width&&p<=l.height)&&(e=h,g=p,B=!0)}if(!B&&(q&&(e-=q.left,g-=q.top),F.features().zoom&&(q=x.zoom,1!=q&&(e=M(e/q),g=M(g/q))),F.features().rotate&&(k=x.rotation,0!==k)))switch(q=f.pageRect(),m=e,h=g,k){case 90:e=q.width-h;g=m;break;case 180:e=q.width-m;g=q.height-h;break;case 270:e=h,g=q.height-m}return{page:f,x:e,y:g,inAnnotation:B}}};b.elementRect=function(a,b){var c;c=new ja(a.rect(v.viewNode),"view");c.origin=b;return c};b.findTextRange=
function(b){if("text"===b.type){var e;if("vertical"!=x.scrollMode||void 0!==v.singlePageIndex)void 0!==c.acc&&b.acc<=c.accend&&b.accend>=c.acc&&(e=c.findTextRange(b));else for(var g in a){var q=a[g];if(q.overlay===d&&q.isLoaded()&&q.isEnabled()&&void 0!==q.acc&&b.acc<=q.accend&&b.accend>=q.acc&&(q=q.findTextRange(b)))if(e)for(var f=0;f<q.length;f++)e.push(q[f]);else e=q}return e}};var R=function(a,b,c){var d=!1;if(c)if(Array.isArray(c))for(var e=0;e<c.length&&!(d=R(a,b,c[e]));e++);else c.range&&"text"===
c.range.type&&a<=c.range.accend&&b>=c.range.acc&&(d=!0);return d};b.isAnnotationText=function(a,c,d){var e=!1;if(d)for(var g=0;!e&&g<d.length;g++)e=d[g],e=R(a,c,e.text)||R(a,c,e.oldtext)||R(a,c,e.author)||R(a,c,e.author_short)||R(a,c,e.last_save_date)||R(a,c,e.create_date)||R(a,c,e.date);else(d=E.revisions())&&(e=b.isAnnotationText(a,c,d)),!e&&h&&(e=b.isAnnotationText(a,c,h.revisions));return e};b.isDocumentText=function(a,c){return b.forRange(ka(a,c),0,!0)?!0:b.isAnnotationText(a,c)};b.maxWidth=
function(){if(d)return"vertical"!=x.scrollMode||void 0!==v.singlePageIndex?c.width:d.maxWidth};b.maxHeight=function(){if(d)return"vertical"!=x.scrollMode||void 0!==v.singlePageIndex?c.height:d.maxHeight};b.decomposeRange=function(b,c){var d;if(void 0!==b.page){var e=a[b.page];if(e){if("rect"===b.type)d=e.mapRectRangeToText(b);else if("cell"===b.type){var g=e.spreadsheetModel();g&&(d=g.decomposeRange(b,c))}(e=e.mapRangeToEmbeds(b))&&(d=d?d.concat(e):e)}}return d};b.ranges=function(c){var d={};void 0===
c&&(c=b.current());a[c]&&(c=a[c].textRanges())&&0<c.length&&(d.text=c);return d};var A=function(){if(v.dynamicContent){switch(x.memoryModel){case "none":p=u=0;break;case "large":u=5242880;p=100;break;case "small":u=1048576;p=20;break;case "micro":u=524288;p=10;break;default:v.isMobile?(u=1048576,p=20):(u=5242880,p=100)}b.applyMemoryLimit()}else p=u=0};b.applyMemoryLimit=function(a){var c,d=0;if(J)for(c=J;c;)0<c.loadedSize&&d++,c=c.nextNewer;void 0!==a&&(l+=a,b.logMemory&&b.logMemory(l,u,d,p));if(0<
u&&l>u||0<p&&d>p){if(J){c=J;var e=a=-1,g=F.visiblePages();0<g.length&&(a=g[0].index,e=g[g.length-1].index);for(;c;){g=c.nextNewer;if(0<c.loadedSize&&!c.locked&&(c.index<a||c.index>e)&&(l-=c.loadedSize,c.unload(),d--,l<=u&&d<p))break;c=g}}b.logMemory&&b.logMemory(l,u,d,p)}};b.touchPage=function(b){(b=a[b])&&b!=W&&(void 0===W?J=b:(b==J&&(J=b.nextNewer),b.nextNewer&&(b.nextNewer.nextOlder=b.nextOlder),b.nextOlder&&(b.nextOlder.nextNewer=b.nextNewer),W.nextNewer=b,b.nextOlder=W,b.nextNewer=void 0),W=
b)};var fa=function(){var a,c;c=(c=b.firstPage())&&c.isSpreadsheet();if(void 0===v.singlePageIndex&&(c||1<e.length)){w||(w=new Xc,w.addPrevNext(function(){b.movetoPrev()},function(){b.movetoNext()}));for(c=w.length();c<e.length;c++){a=e[c];var g=a.firstPage;if(!g)break;w.addTab(a.name,a.hidden,b.moveto,g.index);a.isHidden()&&w.hideTab(a.index)}w.show();d&&w.setActiveTab(d.index);if(h){g=[];if(x.showAnnotations)for(c=0;c<h.revisions.length;c++)a=h.revisions[c],!a.page&&a.ref&&void 0!==a.ref.sheet&&
(a.page=b.page(a.ref.sheet)),a.page&&("add_sheet"==a.type?g[a.page.overlay.index]="oit-anno-add":g[a.page.overlay.index]||(g[a.page.overlay.index]="oit-anno-change"));for(c=0;c<e.length;c++){var f=g[c];f||(a=e[c],1==a.length&&a.firstPage.comments()&&(f="oit-anno-change"));w.tabClass(c,f)}}}else w&&(w.destroy(),w=null)};b.dispatchChange=function(a,d){a||(a=c);if(a==f&&!d)return!0;f=a;w&&w.setActiveTab(a.overlay.index);a.annotationPane()&&a.supportsAnnotationBar()&&b.createAnnotationBar();return b.on.change.dispatch(a)};
b.overlayById=function(a){return ab(e,"id",a)};b.pageById=function(b){return ab(a,"id",b)};b.createAnnotationBar=function(){n||(n=new Yc)};b.activeOverlay=function(){return d};b.activePage=function(){return c};b.ssRevisions=function(){return h};var C=function(){fa();k=void 0};b.updateShowSlideNotes=function(){if(!E.supressHiddenContentUpdate()){var a=F.saveScrollPos();x.showSlideNotes?E.screenCSS(".oit-sn","display:block;"):(E.screenCSS(".oit-sn",null),c&&"sn"==c.type&&(L.deactivate(),P.select(null)));
b.updateActivePage();F.layoutChanged();F.restoreScrollPos(a)}};b.overlayTabRect=function(a){if(w)return w.tabRect(a.index)};b.activeAnnotationPane=function(a){if(void 0!==a&&a!==D){var b=D;D=null;b&&b.deactivate();D=a}return D};b.deactivateAnnotation=function(){b.activeAnnotationPane(null)};b.scrollToAnnotationPane=function(a){if(x.showAnnotations&&b.activePage()&&b.activePage().supportsAnnotationPane()){var c=v.viewNode;c.animate({scrollLeft:c.scrollWidth-c.clientWidth,endFn:a})}else a&&a()};b.annotationPaneWidth=
function(){return x.showAnnotations&&d&&d.hasAnnotations()&&d.firstPage.supportsAnnotationPane()?338:0};var I=function(){!0===x.showHiddenSheets?b.eachOverlay(function(a){a.firstPage&&"worksheet"==a.firstPage.type&&a.show()}):!1===x.showHiddenSheets&&b.eachOverlay(function(a){a.hidden&&a.firstPage&&"worksheet"==a.firstPage.type&&a.hide()})};x.onmemoryModel(A);x.onnochrome(C);x.onshowSlideNotes(b.updateShowSlideNotes);x.onscrollMode(function(){k=void 0});x.onshowHiddenSheets(I);x.onshowSlideNotes(function(){!1===
x.showSlideNotes&&"vertical"!==x.scrollMode&&"sn"===b.activePage().type&&b.movetoPrev()});x.onshowAnnotations(fa);x.onannotationSort(function(){d&&d.each(function(a){(a=a.annotationPane())&&a.applySort()})});E.onreset(function(){for(var b in a){var g=a[b],m=g;l-=m.loadedSize;m.unload();g.destroy()}a=[];oa(e,"destroy");e=[];f=c=d=null;k=0;t=1;w&&(w.destroy(),w=null);n&&(n.destroy(),n=null);T&&(T.destroy(),T=void 0,G={},Q={});u=l=0;h=W=J=r=void 0});ia.ondata(function(c,d,g){var f;if(g=c.style){T||(T=
new Db);var m=[],q=[];for(d=0;d<g.length;d++){var k=g[d];if("string"===typeof k)q.push(k);else if(k.s&&k.p){var p=k.s,k=k.p;"@font-face"===p?G.hasOwnProperty(k)||(G[k]=!0,m.push(p,"{",k,"}")):Q.hasOwnProperty(p)||(Q[p]=!0,q.push(p,"{",k,"}"))}}0<m.length&&T.addCSSText(m.join(""));0<q.length&&T.addCSSText(q.join(""))}if(c.overlays)for(d=0;d<c.overlays.length;d++)g=c.overlays[d],b.overlayById(g.oid)||e.push(new Hc(e.length,g));if(c.pages){f=a.length;for(d=0;d<c.pages.length;d++){g=c.pages[d];m=null;
"email"===g.type&&(v.singlePageIndex=void 0);if(void 0!==g.index){if(q=parseInt(g.index,10),void 0===v.singlePageIndex||v.singlePageIndex===q)a[q]||(a[q]=new cb(q,g.type,g.id)),m=a[q]}else m=new cb(a.length,g.type,g.id),a.push(m);m&&m.processData(g)}b.applyMemoryLimit()}c.attachments&&(d=b.page(0))&&(d._attachments=c.attachments.slice(0));if(c.ssrevisions&&c.ssrevisions.revisions){h=c.ssrevisions;h.revisions.sort(function(a,b){return a.seq-b.seq});g=null;for(d=0;d<h.revisions.length;d++)if(m=h.revisions[d],
void 0!==Mb[m.type]&&E.hiddenContent("tracked-changes"),m.cells)for(q=0;q<m.cells.length;q++)if(p=m.cells[q],p.text)for(k=0;k<p.text.length;k++)g=Fb(g,p.text[k].range);g?na.loadRawText(g.acc,g.accend,function(){b.each("processSSRevisions");fa()}):(b.each("processSSRevisions"),fa())}c.revisions&&b.each("processRevisions");I();fa();void 0!==f&&a.length>f&&b.on.add.dispatch(f)});ia.onadd(function(){b.updateActivePage()});E.onscrollupdate(b.updateActivePage);E.onload(function(){A();C();b.updateShowSlideNotes()});
Wa.onendscroll(b.updateActivePage);P.onselectionchanged(function(a,c){if(x.showAnnotations){var d=b.activeAnnotationPane();if(a){var e=b.nearestForRange(a);e&&e.annotationPane()&&(d=e.annotationPane())}d&&c&&d.activate(a,!1,!1)}});b.onoverlayshow(function(a){w&&w.showTab(a.index)});b.onoverlayhide(function(a){w&&w.hideTab(a.index);!c||c.isEnabled()&&!c.overlay.isHidden()||(a=N(c.index),b.moveto(a))})}}),L=ta.extend("highlights",{exports:"activate active add addMultiple addNote addStamp apply autoHighlight autoHighlightOptions clear comment current deactivate defineStamp first getJSON hide hideComment isHidden label last logVisibleHighlights moveto movetoNext movetoPrev next prev properties property range redact remove serialize setOptions show showComment style type validateStyles".split(" "),
events:{activate:{pub:!0,detail:function(b,e,a){return{highlightid:b?b.id:void 0,before:e,after:a}}},add:{pub:!0,detail:function(b){return{highlightid:b.id}}},remove:{pub:!0,detail:function(b){return{highlightid:b.id}}},move:{pub:!0,detail:function(b){return{highlightid:b.id}}},comment:{pub:!0,detail:function(b){return{highlightid:b.id}}},mode:{pub:!0,detail:function(b){return{autohighlight:b,autooptions:L.autoHighlightOptions(),selectionmode:E.selectionMode()}}}},userEventDef:{pub:!0,detail:function(b,
e,a){return{highlightid:a.id,srcEvent:e}}},install:function(b){var e={},a=function(a){var b=a.toLowerCase();e[a]={w:"border"+a+"Width",c:"border"+a+"Color",wp:"border-"+b+"-width",cp:"border-"+b+"-color",sp:"border-"+b+"-style"}};a("Top");a("Right");a("Bottom");a("Left");var d=0,c=[],f=0,k=0,t,r,w,n,l=-1,u=-1,p,J,W=!1,T=!1,G,Q=!1,D=!1,h,z={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0},g=!0,m=
[],O=!1,H={x:0,y:0},N=[];b.add=function(){var a=arguments,b=1,c={};ma(0,a,c,"add");c.invalid||(b=ja(b,a,c,"add"));c.invalid||(Array.isArray(c.range)?c.type="hl-"+c.range[0].type:Qa(c.range)||va(c.range)?c.type="hl-text":c.type="hl-"+c.range.type,na(0,a,c,"add"));c.invalid||(b=sa(b,a,c,"properties","add"),b=ua(b,a,c,"comment","add"));c.invalid||ta(b,a,c,"add");if(!c.invalid)return pa(c)};b.addMultiple=function(a,c,d,e){var g=arguments,f=1,h={},m,q;ma(0,g,h,"addMultiple");if(!h.invalid){if(Array.isArray(c)){for(q=
0;q<c.length;q++){if(!xa(c[q])){h.invalid=!0;break}if(m&&m!=c[q].type){h.invalid=!0;break}m=c[q].type}f++}else h.invalid=!0;m||(h.invalid=!0);h.invalid&&b.invalidArg("addMultiple","rangeList",null,"Must be an array of ranges")}h.invalid||(h.type="hl-"+m.type,na(0,g,h,"addMultiple"));h.invalid||sa(f,g,h,"properties","addMultiple");if(!h.invalid){g=[];b.beginBatch();for(q=0;q<c.length;q++)h.range=xa(c[q]),f=pa(h),g.push(f),e&&b.setOptions(f,e);b.endBatch();return g}};b.addNote=function(){var a=arguments,
c=1,d={type:"note"};ma(0,a,d,"addNote");d.invalid||(c=ja(c,a,d,"addNote"));d.invalid||("cell"!==d.range.type&&"rect"!==d.range.type&&(b.invalidArg("addNote","range",d.range,"Anchored notes may only be added to rect or cell ranges"),d.invalid=!0),na(0,a,d,"addNote"));d.invalid||(c=sa(c,a,d,"properties","addNote"),c=ua(c,a,d,"comment","addNote"));d.invalid||ta(c,a,d,"addNote");if(!d.invalid)return pa(d)};b.redact=function(){var a,b=arguments,d={type:"redaction"};a=ja(0,b,d,"redact");d.invalid||(a=sa(a,
b,d,"properties","redact"),a=ua(a,b,d,"label","redact"));d.invalid||ta(a,b,d,"redact");if(!d.invalid){if("compound"===x.redactionMode||"hybrid"===x.redactionMode&&"cell"===d.range.type)d.compound=!0;a:{a=d;b=!1;a.range.embedId?b=!1:"hybrid"===x.redactionMode?b="rect"===a.range.type:"simple"===x.redactionMode&&(b="rect"===a.range.type||"cell"===a.range.type);if(b){var e=A.decomposeRange(a.range);if(e){var d=[],g=a.range,f=A.page(g.page),h=F.rangeRect(g,f),m=a.activate;a.activate=!1;for(b=0;b<e.length;b++){a.range=
e[b];var q=ca(a);-1==d.indexOf(q)&&d.push(q)}if("drawing"===f.type||"slide"===f.type||"chart"===f.type){e=0===d.length;if(!e)for(b=0;b<d.length;b++)if(q=c[d[b]].range,"rect"!==q.type){e=!0;break}else if(q=F.rangeRect(q,f),!q||!q.equals(h)){e=!0;break}e&&(a.range=g,d.unshift(ca(a)))}if(0<d.length){m&&V(d[0]);1==d.length&&(d=d[0]);a=d;break a}}}a=pa(a)}return a}};b.apply=function(a,c){if(!Array.isArray(a)){try{a=JSON.parse(a)}catch(Zc){b.invalidArg("apply","highlights",a,"Error parsing JSON string: "+
Zc.message);return}a&&a.range&&"object"==typeof a.range&&(a=[a])}if(Array.isArray(a))if(v.documentLoaded){c=Oa(c)?c:null;for(var d=0;d<a.length;d++){var e=a[d];if("sdef"==e.type)b.defineStamp(e.stamp,e.url);else{var g=ea();if(!c||c(g,e.properties))if(xa(e.range))if(g=[],"stamp"==e.type){var f={name:e.stamp};e.opacity&&(f.opacity=e.opacity);e.sizing&&(f.sizing=e.sizing);g.push(f);g.push(e.range);e.hasOwnProperty("properties")&&g.push(e.properties);e.hasOwnProperty("comment")&&g.push(e.comment);b.addStamp.apply(void 0,
g)}else pa(e);else b.invalidArg("apply","highlight["+d+"]",e)}}}else t=t?a.concat(t):a};b.remove=function(a,c){if(Array.isArray(a)){b.beginBatch();for(var d=0;d<a.length;d++)b.remove(a[d]);b.endBatch()}else(d=wa(a,p,"remove"))&&R(d,c)};var R=function(a,d){var e=a.id;void 0===d&&(d=!0);b.on.remove.dispatch(a);var g,h=!1,m=!1;e==p?(S(d),p=void 0,void 0!=a.prevId?(g=a.prevId,m=!0):void 0!=a.nextId&&(g=a.nextId,h=!0)):d=!1;b.hideComment(e);b.unmap(a);a.destroy();c[e]=null;f--;e<k&&(k=e);void 0!==g&&V(g,
h,m,d,!1,!1)};b.removeFromRange=function(a){Array.isArray(a)?oa(a,b.removeFromRange):"text"===a.type&&b.each(ra,null,a)};var ra=function(a,c){var d=a.range;"text"===d.type&&d.accend>=c.acc&&d.acc<=c.accend&&b.remove(a.id,!1)};b.count=function(){return f};b.clear=function(a){a=Oa(a)?a:null;S();b.each(R,a,!1);a||(p=void 0,c=[],k=f=0,N=[])};a=function(){var a=x.highlightLabelFontFamily,c=x.highlightLabelFontSize,d="";a&&(d+="font-family:"+a+";");c&&(d+="font-size:"+c+";");E.screenCSS(".oit-highlight-label",
d);b.each("showLabel",null,x.showHighlightLabels)};b.setOptions=function(a,b){b&&Y(a,p,"setOptions",null,[b])};b.getOption=function(a,b){return Y(a,p,"getOption",null,[b])};b.style=function(a,c){var d,e=wa(a,p,"style");if(e)if(c){var g=ha(c,"hl-text"!=e.type);g?d=e.style(g):b.invalidArg("style","style",c)}else d=e.style();return d};b.comment=function(a,c,d){if(a=wa(a,p,"comment")){var e=a.comment();void 0!==c&&c!==e&&(d||a.id!==b.active()||a.isNote()?e=a.comment(c):(b.hideComment(),e=a.comment(c),
b.showComment()),b.on.comment.dispatch(a));return e}};var fa=function(a){if("scale"==a||"stretch"==a||"image"==a)return a},C=function(a){if(a&&!isNaN(a)&&(a=Number(a),0<=a&&1>=a))return a},I=function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y))return{x:Math.round(a.x),y:Math.round(a.y)}},q=function(a){a.img=new Image;a.img.src=a.url;a.img.onload=function(){a.height=this.height;a.width=this.width;a.defaultSize&&(this.style.width=a.defaultSize.x,this.style.height=a.defaultSize.y);delete a.img}};b.stamp=function(a){if(n)return n[a]};
b.label=function(a,b){return Y(a,p,"label",null,[b])};b.defineStamp=function(a,b,c){n||(n={});b?(c=c||{},b={url:b},c.sizing&&(b.sizing=fa(c.sizing)),c.opacity&&(b.opacity=C(c.opacity)),c.defaultSize&&(b.defaultSize=I(c.defaultSize)),n[a]=b,q(n[a])):delete n[a]};var B=function(a){var b;if(a){var c;if(a instanceof String||"string"==typeof a)c={name:a};else{c={};for(var d in a)c[d]=a[d]}c.name&&n&&n[c.name]&&(c.type="stamp",c.stamp=n[c.name],b=c)}return b};b.addStamp=function(){var a,c=arguments,d=B(c[0]);
if(d){d.sizing=fa(d.sizing)||d.stamp.sizing||"scale";d.opacity=C(d.opacity)||d.stamp.opacity||1;d.defaultSize=I(d.defaultSize)||d.stamp.defaultSize;var e;e=ja(1,c,d,"addStamp");var g=d.range;g&&"rect"!=g.type&&"cell"!=g.type?(b.invalidArg("addStamp","range",g),d.invalid=!0):"rect"===g.type&&Lb(g)?d.range=Ca(g.left,g.top,"rect",d):"cell"===g.type&&g.c1==g.c2&&g.r1==g.r2&&(d.range=Ca(g.c1,g.r1,"cell",d));d.invalid||(e=sa(e,c,d,"properties","addStamp"),e=ua(e,c,d,"comment","addStamp"));ta(e,c,d,"addStamp");
d.invalid||(a=pa(d))}else b.invalidArg("addStamp","stamp",c[0],"Must be the name of a defined stamp");return a};b.getJSON=function(a){if(a=wa(a,p,"getJSON"))return JSON.stringify(a.serialize())};b.serialize=function(a){var c=[],d,e;Oa(a)?d=a:Array.isArray(a)?e=a:"number"===typeof a&&(e=[a]);b.each(ba,d,c,{},e);return JSON.stringify(c,null,!1)};var ba=function(a,c,b,d){d&&-1==d.indexOf(a.id)||(a=a.serialize(),a.stamp&&!b[a.stamp]&&(c.push({type:"sdef",stamp:a.stamp,url:n[a.stamp].url}),b[a.stamp]=
!0),c.push(a))};b.properties=function(a,c){return Y(a,p,"properties",null,[c])};b.property=function(a,c,b){return Y(a,p,"property",null,[c,b])};b.current=function(){return p};b.active=function(){if(!W&&!T)return p};b.moveto=function(a){(a=wa(a,p,"moveto"))&&V(a.id,!1,!1,!0,!0,!0);return p};b.movetoNext=function(a){if(void 0===p)void 0!==r&&b.moveto(r);else{var d=p;if(W&&c[d].filter(a)&&Z(d))return b.moveto(d);for(;;){d=c[d].nextId;if(void 0===d)break;var e=c[d];if(e.filter(a)&&(e=A.nearestForRange(e.range)))return e.isLoaded()?
V(d):A.moveto(e.index,function(){b.movetoNext(a)}),d}}return p};b.movetoPrev=function(a){if(void 0===p)void 0!==w&&b.moveto(w);else{var d=p;if(T&&c[d].filter(a)&&Z(d))return b.moveto(d);for(;;){d=c[d].prevId;if(void 0===d)break;var e=c[d];if(e.filter(a)&&(e=A.nearestForRange(e.range)))return e.isLoaded()?V(d):A.moveto(e.index,function(){b.movetoPrev(a)}),d}}return p};b.type=function(a){if(a=wa(a,p,"type"))switch(a.type){case "note":case "redaction":case "stamp":return a.type;default:return"highlight"}};
b.range=function(a){if(a=wa(a,p,"range"))return a.range};b.show=function(a){if(void 0===a||Oa(a))b.each("show",a);else if(Array.isArray(a)){b.beginBatch();for(var c=0;c<a.length;c++)b.show(a[c]);b.endBatch()}else Y(a,p,"show")};b.hide=function(a){if(void 0===a||Oa(a))b.each("hide",a);else if(Array.isArray(a)){b.beginBatch();for(var c=0;c<a.length;c++)b.hide(a[c]);b.endBatch()}else Y(a,p,"hide");b.alignHighlight()};b.isHidden=function(a){return Y(a,p,"isHidden")};b.logVisibleHighlights=function(){var a=
b.first();if(void 0===a)console.log("No visible highlights.");else for(;void 0!==a;){var d=c[a];console.log("["+d.id+"]: range="+JSON.stringify(d.range)+", key="+JSON.stringify(d.key));a=b.next(a)}};b.showComment=function(a,d){Array.isArray(a)&&(a=a[0]);var e=wa(a,p,"showComment");if(e){d=d||{};d.mode||(d.mode="view");var g=b.active();if(void 0!==g&&(g=c[g],g.isNote()&&g.isEditing()))return;if(e.isNote())switch(d.mode){case "view":e.show();e.endEditText(!0);break;case "edit":e.beginEditText(!1);break;
case "new":e.beginEditText(!0)}else e.dialog(d.mode)}};b.hideComment=function(a){(a=wa(a,p,"hideComment"))&&(a.isNote()?a.collapse():a.hideDialog())};b.first=function(){return r};b.last=function(){return w};b.next=function(a){if(a=wa(a,p,"next"))return a.nextId};b.prev=function(a){if(a=wa(a,p,"prev"))return a.prevId};b.activate=function(a){(a=wa(a,p,"activate"))&&V(a.id)};b.deactivate=function(){S(!0)};var aa=function(a){if(a)for(var c in z)void 0!==a[c]&&(z[c]=a[c]);P.enableCellOffsets("note"===
Q||"stamp"===Q);da();b.on.mode.dispatch(Q)};b.autoHighlightOptions=function(a){void 0!==a&&aa(a);a={};for(var c in z)a[c]=z[c];return a};b.autoHighlight=function(a,c){var d;if(!1===a){P.select(null);if(h){d=F.features();switch(h){case "text":d.textselection||(h=null);break;case "rect":d.rectselection||(h=null);break;case "cell":d.cellselection||(h=null);break;default:h=null}h&&(E.selectionMode(h),h=null)}Q=!1;aa()}else if("selection"===a||"note"===a||"redaction"===a||"stamp"===a){c=c||{};z.comment=
null;z.sticky=!1;z.properties=null;P.select(null);if("stamp"===a){if(!B(c.stamp))return b.invalidArg("autoHighlight","options.stamp",c.stamp),Q=!1}else if(("selection"===a||"note"===a)&&!ha(c.style,!0))return b.invalidArg("autoHighlight","options.style",c.style),Q=!1;Q=a;h||(h=E.selectionMode());if("note"===a||"redaction"===a||"stamp"===a)d=F.features(),d.rectselection||"redaction"===a&&d.rectredaction?E.selectionMode("rect"):d.cellselection&&E.selectionMode("cell");aa(c)}return Q};b.pauseAutoHighlight=
function(a){D=!!a};b.beginBatch=function(){d++};b.endBatch=function(){0<d&&d--};b.batchMode=function(){return 0<d};var da=function(){if("selection"===Q||"note"===Q)P.style(z.style,!1);else if("redaction"===Q){var a;x.redactionFillColor&&"compound"===x.redactionMode&&"rect"===E.selectionMode()?a=x.redactionFillColor:(a=Aa(x.redactionColor),.7<a.a&&(a.a=.7),a=Ia(a.r,a.g,a.b,a.a));P.style("background-color:"+a+";",!1)}else if("stamp"===Q)if(n&&(a=n[z.stamp]),a){var c="background:url("+a.url+") no-repeat";
"number"===typeof a.opacity&&1!=a.opacity&&(c+=";opacity:"+a.opacity);"scale"==a.sizing?c+=";background-size:contain":"stretch"==a.sizing&&(c+=";background-size:100% 100%");P.style(c)}else P.style(null);else P.style(null)},Ca=function(a,c,b,d){var e,g;d&&(d.defaultSize&&(e=d.defaultSize.x,g=d.defaultSize.y),e||(e=d.width),g||(g=d.height));e||(e=200);g||(g=200);a=A.mapToPage(a,c);d&&(a.x-=Math.floor(e/2),a.y-=Math.floor(g/2));return F.rangeFromRect(a.page.index,a.x,a.y,a.x+e,a.y+g,a.page,"move")},
Z=function(a){return"slideshow"!=x.presentationMode?!0:(a=xa(c[a].range))&&A.nearestForRange(a)?!0:!1};b.startSelection=function(){J=b.active();S(!1)};b.endSelection=function(){J=void 0};E.onselect(function(a,d,e,g,f){var h=!0;if(a&&Q&&!D){var m=a,q="note"===Q,k="stamp"===Q;if(q&&!F.features().anchorednotes||(q||k)&&"text"===m.type&&!g)return!0;a=q||!0===z.comment;if(g)if((q||k)&&e&&void 0===J){var p;k&&((d=B(z.stamp))?p=d.stamp:m=null);m&&(d=F.features(),m=d.rectselection?Ca(e.x,e.y,"rect",p):d.cellselection?
Ca(e.x,e.y,"cell",p):null);m||P.select(null)}else P.select(null),m=null;else q&&d&&e&&"rect"===m.type&&(p=m.bottom-m.top,100>m.right-m.left&&(d.x<e.x?m.right=m.left+100:m.left=m.right-100),80>p&&(d.y<e.y?m.bottom=m.top+80:m.top=m.bottom-80));if(m&&void 0===f){var l;"text"===m.type&&(m=X.getSelection());"redaction"===Q?l=b.redact(m,z.properties,z.label):k?!B(z.stamp)||"rect"!==m.type&&"cell"!==m.type?P.select(null):l=b.addStamp(z.stamp,m,z.properties):q?"rect"===m.type||"cell"===m.type?l=b.addNote(z.style,
m,z.properties):P.select(null):l=b.add(z.style,m,z.properties);if(void 0!==l){e=Array.isArray(l)?l:[l];f="string"===typeof z.comment?z.comment:void 0;for(h=0;h<e.length;h++)l=c[e[h]],l.setOptions(z),f&&l.comment(f);P.select(null);b.activate(e[0]);a&&b.showComment(e,{mode:"new"});h=!1;z.sticky||b.autoHighlight(!1)}}}return h});b.alignComment=function(){b.each("alignDialog")};F.ondisplayload(function(a,c){l=a.index;u=c.index;b.each("addToPage",null,l);u>l&&L(l+1,u)});F.ondisplayunload(function(a,c){b.each("destroyDialog");
u=l=-1});A.onpageload(function(a){-1!=u&&a.index>u&&(u=A.activeOverlay().lastPage.index);0<c.length&&a.index>=l&&a.index<=u&&b.each("addToPage",null,a.index)});A.onpageunload(function(a){a.index>=l&&a.index<=u&&(b.each("removeFromPage",null,a.index),a.highlightLayer=void 0)});b.onEmailHeaderResize=function(a){b.each("addToPage",null,a);b.positionAll(A.activeOverlay())};b.alignHighlight=function(){void 0==p||W||T||V(p,!1,!1,!1,!1,!0)};b.move=function(a,c,b,d,e,g){var f;c=c||0;d=d||0;b=b||0;e=e||0;
g=g||!1;if((a=wa(a))&&(c||d||b||e)&&a.getOption("enableUserMove")){var h=ga(a.range);if("rect"===h.type){g=g?1:10;var m=F.pageRange(h.page,h.type);h.left+=c*g;h.top+=b*g;h.right+=d*g;h.bottom+=e*g;g=h.right-h.left;f=h.bottom-h.top;c&&(0>h.left?(h.left=0,d&&(h.right=g)):h.left>=h.right&&(h.left=h.right-1));d&&(h.right<=h.left?h.right=h.left+1:h.right>m.right&&(h.right=m.right,c&&(h.left=h.right-g,0>h.left&&(h.left=0))));b&&(0>h.top?(h.top=0,e&&(h.bottom=h.top+f)):h.top>=h.bottom&&(h.top=h.bottom-1));
e&&(h.bottom<=h.top?h.bottom=h.top+1:h.bottom>m.bottom&&(h.bottom=m.bottom,b&&(h.top=h.bottom-f,0>h.top&&(h.top=0))))}else"cell"===h.type&&(m=F.pageRange(h.page,h.type),h.c1+=c,h.r1+=b,h.c2+=d,h.r2+=e,g=h.c2-h.c1,f=h.r2-h.r1,c&&(h.c1<m.c1?(h.c1=m.c1,d&&(h.c2=h.c1+g)):h.c1>h.c2&&(h.c1=h.c2)),d&&(h.c2<h.c1?h.c2=h.c1:h.c2>m.c2&&(h.c2=m.c2,c&&(h.c1=h.c2-g,h.c1<m.c1&&(h.c1=m.c1)))),b&&(h.r1<m.r1?(h.r1=m.r1,e&&(h.r2=h.r1+f)):h.r1>h.r2&&(h.r1=h.r2)),e&&(h.r2<h.r1?h.r2=h.r1:h.r2>m.r2&&(h.r2=m.r2,b&&(h.r1=
h.r2-f,h.r1<m.r1&&(h.r1=m.r1)))));a.setRange(h)}};var ha=function(a,c){if(!g)return a;var b;if("string"==typeof a){b=[];var d=rb(a,"color");d&&b.push("color:",d,";");(d=rb(a,"background-color"))&&b.push("background-color:",d,";");if(!c)(d=rb(a,"text-decoration"))&&b.push("text-decoration:",d,";");else if(c&&-1!=a.indexOf("border")){d=y.create("div");d.attr("style",a);d.css("display","none");y.body.append(d);var e=d.computedStyle(d),h=Ra(e,"Top"),f=Ra(e,"Left"),m=Ra(e,"Bottom"),q=Ra(e,"Right");h.w&&
h.w==m.w&&h.w==f.w&&h.w==q.w&&h.c==m.c&&h.c==f.c&&h.c==q.c?b.push("border:",h.w," solid ",h.c,";"):(qa(e,h,b),qa(e,f,b),qa(e,m,b),qa(e,q,b));d.destroy()}b=0===b.length?void 0:b.join("")}return b},Ra=function(a,c){c=e[c];return{e:c,w:a[c.w],c:a[c.c]}},qa=function(a,c,b){c.w&&b.push(c.e.wp,",",c.w,";",c.e.sp,":solid;",c.e.cp,":",c.c,";")};b.map=function(a){if("text"===a.range.type){var c=N[a.range.acc];void 0!==c?c instanceof Array?c.push(a.id):N[a.range.acc]=[c,a.id]:N[a.range.acc]=a.id}};b.unmap=
function(a){if("text"===a.range.type){var c=N[a.range.acc];void 0!==c&&(c instanceof Array?1==c.length&&c[0]==a.id?delete N[a.range.acc]:Fa(c,a.id):c===a.id&&delete N[a.range.acc])}};var pa=function(a){var c,b,d,e,g;if(Array.isArray(a.range)){g=a.range;a.compound=g;e=g[0].acc;b=g[0].accend;for(c=1;c<g.length;c++)d=g[c],d.acc<e&&(e=d.acc),d.accend>b&&(b=d.accend);a.range=ka(e,b)}else if(Qa(a.range)||va(a.range)){g=Cb(a.range);if(!g)return;if(!Array.isArray(g))return a.range=g,pa(a);a.compound=g;e=
g[0].acc;b=g[0].accend;for(c=1;c<g.length;c++)d=g[c],d.acc<e&&(e=d.acc),d.accend>b&&(b=d.accend);a.range=ka(e,b)}if("text"===a.range.type){if((g=A.pagesForRange(a.range))&&2<=g.length){d=a.range;e=[];var h,f;for(c=0;c<g.length;c++)b=g[c],b.overlay!=f?(h=ka(b.acc,b.accend),e.push(h),f=b.overlay):(b.acc<h.acc&&(h.acc=b.acc),b.accend>h.accend&&(h.accend=b.accend));if(1<e.length){h=[];for(c=0;c<e.length;c++)a.range=e[c],a.range.acc<d.acc&&(a.range.acc=d.acc),a.range.accend>d.accend&&(a.range.accend=d.accend),
f=ca(a),-1==h.indexOf(f)&&h.push(f);return 0===h.length?void 0:1==h.length?h[0]:h}}}else if("rect"===a.range.type&&(b=A.page(a.range.page))&&b.isEmailHeader())return;return ca(a)},ca=function(a){var d;if("text"===a.range.type){var e,g=a.properties,h=a.comment,q=a.label;null===g&&(g=void 0);null===h&&(h=void 0);null===q&&(q=void 0);var k=N[a.range.acc];if(void 0!==k)if(k instanceof Array)for(var p=0;p<k.length;p++){if(e=c[k[p]],e.matches(a.style,a.range,g,h,q)){d=e;break}}else e=c[k],e.matches(a.style,
a.range,g,h,q)&&(d=e)}else d=void 0;if(!d){"text"===P.selectionType()&&P.select(null);e="rect"===a.range.type||"cell"===a.range.type;g=ea();switch(a.type){case "redaction":d=new $c(g,a);break;case "note":e&&(d=new ad(g,a));break;case "stamp":e&&(d=new bd(g,a));break;default:d=new hb(g,a)}if(!d)return;c[g]=d;f++;if(b.batchMode())m.push({highlight:d}),M();else if(e=d,e.addToDocument(),(g=la.infoRaw())&&1557===g.fi&&"text"==e.range.type)for(g=A.count(),h=0;h<g;h++)(q=A.page(h))&&!q.isLoaded()&&q.containsRange(e.range)&&
K(h,!0,e);b.link(d)}b.on.add.dispatch(d);!0===a.activate?V(d.id):H&&(b.activateNearest(H.x,H.y,null,!1),H=null);return d.id},M=function(){O||(O=!0,E.onidle(U))},L=function(a,d){if(0!==c.length&&!b.batchMode())for(var e=a;e<=d;e++){var g=A.page(e);g&&g.isLoaded()&&(m.push({pageIndex:e,loadPage:!1}),M())}},K=function(a,c,b){m.push({pageIndex:a,loadPage:!!c,highlight:b});M()},U=function(){if(!b.batchMode()){F.suspendUpdate();for(var a=[],d=0;20>d&&0<m.length;d++){var e=m.shift();if(void 0!==e.pageIndex){var g=
A.page(e.pageIndex);if(g.isLoaded())if(void 0===e.highlight){if(g&&g.isLoaded())for(var h=0;h<c.length;h++){var f=c[h];f&&g.containsRange(f.range)&&K(e.pageIndex,!1,f)}}else e.highlight.addToPage(e.pageIndex);else if(!0===e.loadPage){var q=e;g.load(!1,function(){m.unshift(q);M()})}}else void 0!==e.highlight&&(e.highlight.addToDocument(!1),a.push(e.highlight))}for(d=0;d<a.length;d++)b.link(a[d]);0===m.length&&O&&(O=!1,E.offidle(U));F.resumeUpdate()}};b.findNearest=function(a,b){if(void 0!==r){var d=
A.mapToPage(a,b,null,!0,!0);if(d){var e=d.page;a=d.x;b=d.y;for(var g,h,f,m=0;m<c.length;m++){var q=c[m];if(q&&!q.isHidden()&&q.isOnPage(e.index)){var k=q.distanceFromPoint(e.index,a,b,d.inAnnotation);void 0!==k&&(0===k.x&&0===k.y?(g||(g=[]),g.push(q),h=k):!g&&(void 0===h||k.ay<h.ay||k.ay==h.ay&&k.ax<h.ax)&&(h=k,f=q))}}if(g)return{highlights:g,distance:h};if(f)return{highlights:[f],distance:h}}}};b.activateNearest=function(a,d,e,g){var h=p,f=T,m=W;!1!==g&&(g=!0);if(void 0===r)H&&(H.x=a,H.y=d);else{var q=
b.findNearest(a,d);if(q)if(h=void 0,m=f=!1,1<q.highlights.length){var k=b.active();if(void 0!==k)for(var l=0;l<q.highlights.length;l++)if(q.highlights[l].id==k){++l>=q.highlights.length&&(l=0);h=q.highlights[l].id;break}void 0===h&&(h=q.highlights[0].id)}else h=q.highlights[0].id,f=q.distance,m=0>f.y||0===f.y&&0>f.x,f=0<f.y||0===f.y&&0<f.x;else{if(q=A.mapToPage(a,d,null,!0,!0))for(l=q.page,h=r;void 0!==h;h=c[h].nextId)if((q=A.forRange(c[h].range))&&q.index>=l.index){k=q;break}k||(h=w,k=A.forRange(c[h].range));
k.index<l.index?f=!0:m=!0}}if(h!=p||f!=T||m!=W)return!1!==g||m||f?e||m||f||(m=!0):m=!0,V(h,m,f,!0,!1),b.active()};var S=function(a){V(void 0,!1,!1,a)},V=function(a,d,e,g,h,f){var m;if(!G&&(a=(m=wa(a))?m.id:void 0,!0!==d&&(d=!1),!0!==e&&(e=!1),!1!==h&&(h=!0),(m=a!=p||d!=W||e!=T)&&(f=!1),m||f)){void 0!==a&&b.isHidden(a)&&(a=void 0);if(!f){if(m=c[p])m.hideDialog(),m.deactivate();m=p;p=a;void 0!==m&&c[m]&&c[m].isEmptyRedaction()&&b.remove(m,!0);W=d;T=e}if(void 0!==p&&!d&&!e&&c[p]){m=c[p];if(h){A.moveto(m.range,
function(){V(a,d,e,g,!1,!0)});return}if(m.isNote())P.select(null);else{G=m;P.select(m.range,m.id);h=ib(m.style());var q;h.color&&(q="color:"+h.color+";background-color: rgba(255,255,255,0);");P.hide(q);G=null}v.viewNode.focus();m.activate(f);m.comment()&&!m.isNote()&&b.showComment(m.id,{mode:"view"})}!1!==g&&(m=wa(p),b.on.activate.dispatch(m,W,T))}},Y=function(a,c,b,d,e){d=d||b;if(a=wa(a,c,b))return"string"==typeof d?a[d].apply(a,e):d.apply(null,e)},wa=function(a,d,e){var g;void 0===a&&(a=d);"number"===
typeof a&&c[a]?g=c[a]:e&&b.invalidArg(e,"id",a);return g};b.link=function(a){var d=a.id;b.unlink(a,!0);if(!a.isHidden()){var e=a.generateKey();if(e)if(void 0===r)w=r=d;else for(var g=r;;){var h=c[g],f=h.key,m=!1;e.page<f.page?m=!0:e.page==f.page&&(e.y<f.y?m=!0:e.y==f.y&&(e.x<f.x?m=!0:e.x==f.x&&d<g&&(m=!0)));if(m){g===r?r=d:(a.prevId=h.prevId,c[a.prevId].nextId=d);a.nextId=g;h.prevId=d;break}if(g===w){a.prevId=g;w=h.nextId=d;break}g=h.nextId}}};b.unlink=function(a,b){!0!==b&&a.id==p&&(S(),p=void 0);
if(void 0!==a.prevId||void 0!==a.nextId||r==a.id){var d=void 0!==a.prevId?c[a.prevId]:null,e=void 0!==a.nextId?c[a.nextId]:null;d?d.nextId=a.nextId:r=a.nextId;a.nextId=void 0;e?e.prevId=a.prevId:w=a.prevId;a.prevId=void 0}};b.positionAll=function(a){b.each("positionAll",a);b.alignHighlight()};b.validateStyles=function(a){void 0!==a&&(g=!1!==a);return g};b.updateHighlights=function(){L(l,u);b.positionAll(A.activeOverlay())};var ea=function(){for(;k<c.length&&c[k];)k++;k>=c.length&&(k=c.length,c.push(null));
return k};b.each=function(a,b){zb(c,arguments)};var ja=function(a,c,d,e){if(a<c.length){c=c[a];if(Array.isArray(c)){d.range=c;for(var g=0;g<c.length;g++)xa(c[g])||(d.range=null)}else Qa(c)||va(c)?d.range=c:d.range=xa(c);d.range&&a++}d.range||("text"===E.selectionType()&&(d.range=X.getSelection(),d.range&&d.range.isCollapsed&&(d.range=void 0)),d.range||(d.range=E.selection()),d.range?d.activate=!0:(b.invalidArg(e,"range",null,"A range was not specified and nothing is currently selected"),d.invalid=
!0));return a},ma=function(a,c,d,e){if(1>c.length||"string"!==typeof c[0])b.invalidArg(e,"style",null,"A highlight style must be specified"),d.invalid=!0},na=function(a,c,d,e){var g;a<c.length&&"string"===typeof c[a]&&(g=c[a]);d.style=ha(g,"hl-text"!=d.type);d.style?a++:(b.invalidArg(e,"style",g),d.invalid=!0);return a},sa=function(a,c,b,d,e){a<c.length&&(c=c[a],c instanceof Object||"object"==typeof c?(b[d]=c,a++):null!==c&&void 0!==c||a++);return a},ua=function(a,c,b,d,e){a<c.length&&(c=c[a],c instanceof
String||"string"==typeof c?(b[d]=c,a++):null!==c&&void 0!==c||a++);return a},ta=function(a,c,d,e){for(;a<c.length&&void 0===c[a];)a++;a<c.length&&(b.invalidArg(e,null,null,"Unexpected argument(s)"),d.invalid=!0);return a},ya=function(){b.each("updateStyle","isRedaction");da()};x.onredactionColor(ya);x.onredactionFillColor(ya);x.onnochrome(function(){b.positionAll(A.activeOverlay())});x.onshowSlideNotes(b.updateHighlights);x.onshowHighlightLabels(function(a){b.each("showLabel",null,a)});x.onhighlightLabelFontFamily(a);
x.onhighlightLabelFontSize(a);x.onhighlightActivationBoxColor(function(a){if(null===a)E.screenCSS(".oit-highlight-active .oit-activation","display:none;"),E.screenCSS(".oit-highlight-embed","display:none;"),E.screenCSS(".oit-highlight-active .oit-resize div","display:none;"),E.screenCSS(".oit-text-handle div:nth-child(2)","display:none;"),E.screenCSS(".oit-text-handle div:first-child","display:none;"),E.screenCSS(".oit-text-handle",null);else if(a=Aa(a)){var c="rgb("+a.r+","+a.g+","+a.b+")",b="border:2px solid "+
c+";opacity:"+a.a+";";E.screenCSS(".oit-highlight-active .oit-activation",b);b="border:1px solid "+c+";opacity:"+a.a+";";E.screenCSS(".oit-highlight-embed",b);b="background-color:"+c+";";E.screenCSS(".oit-highlight-active .oit-resize div",b);E.screenCSS(".oit-text-handle div:nth-child(2)",b);E.screenCSS(".oit-text-handle div:first-child","border-bottom: 7px solid "+c+";");b="opacity:"+a.a+";";E.screenCSS(".oit-text-handle",b)}});a=function(a,c,d){if((a=A.activePage())&&a.isSpreadsheet()&&!d.inAnnotation())return!0;
a="tap"===c.type?v.viewNode.touchPos(c):v.viewNode.mousePos(c);void 0===b.activateNearest(a.x,a.y,c,!0)&&d&&b.activate(d.id);return void 0!==b.active()?!1:!0};b.on.click.setDefaultListener(a);b.on.tap.setDefaultListener(a);E.onscroll(function(){b.alignComment()});E.onreset(function(){b.on.removeAllElements();b.clear();d=0;c=[];k=f=0;n=w=r=t=void 0;u=l=-1;J=p=void 0;T=W=!1;G=void 0;D=Q=!1;h=void 0;z={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,
enableUserResize:!0,enableUserMove:!0};m=[];O&&(O=!1,E.offidle(U));H={x:0,y:0};N=[]});E.onload(function(){if(t){var a=t;t=null;b.apply(a)}});E.onzoom(function(a,c,d){b.positionAll(A.activeOverlay())});ia.ondata(function(a,c,d){a.highlights&&b.apply(a.highlights);if(a.stamps)for(var e in a.stamps)n[e]=a.stamps[e]})}}),Ic=ta.extend("hyperlinks",{userEventDef:{pub:!0,detail:function(b,e,a){b={srcEvent:e,url:a.url};a.range&&(b.range=ga(a.range));a.alt&&(b.alt=a.alt);b.external=0!==b.url.indexOf("#");
return b}},install:function(b){var e,a,d={},c=0,f=!1,k=null,t=null,r,w=function(a,c,d){if(c){var e=d+10;e>c.length&&(e=c.length);for(;d<e;d++){var f=c[d],h=f.range;if(h)if("text"===h.type)J(a,f);else if("rect"==h.type&&h.page===a.index){if(!a.linkMap){var k=a.childByClass("oit-svg"),g=k.byClass("oit-svg-text");if(g&&0<g.length){g=g[0];a.linkMap=y.create("div","oit-area-hyperlinks");a.linkMap.attr("style",g.attr("style"));if(g.classList)for(var m=0;m<g.classList.length;m++){var p=g.classList.item(m);
"oit-svg-text"!==p&&a.linkMap.addClass(p)}k.append(a.linkMap)}}a.linkMap&&(h="left:"+h.left+"px;top:"+h.top+"px;width:"+(h.right-h.left)+"px;height:"+(h.bottom-h.top)+"px;",k=y.create("div"),k.attr("style",h),a.linkMap.append(k),b.on.addElement(k,f),h={anchorNode:k,page:a},f.anchors||(f.anchors=[]),f.anchors.push(h))}}}return d},n=function(a,c,b){if(c){var d=b+10;d>c.length&&(d=c.length);for(;b<d;b++){var e=c[b],h=e.range;if(h&&"text"===h.type){var f=a.findRange(h.acc,h.accend);f&&oa(f,"addDataToRange",
null,h,e)}}}return b},l=function(a,c,b){a=0;c&&(a=c.button||0);if(0!==a||!b.targetId)return!0;k=null;(c=d[b.targetId])?(b=y.byId(b.targetId)||c.range||c.page,void 0!==b&&A.movetoEx(b,{force:!0,moveToTop:!0}),f&&(Ba.hideMessage(),f=!1)):ia.isPending()?(f||(Ba.showMessage(OIT.local.PLEASE_WAIT_INITIALIZING),f=!0),k=b,ia.on.add.listenOnce(function(){k&&l(null,null,k)})):f&&(Ba.hideMessage(),f=!1);return!1};b.on.click.setDefaultListener(l);b.on.tap.setDefaultListener(l);ia.ondata(function(b,f,k){var p;
if(b.hyperlinks){e=e?e.concat(b.hyperlinks):b.hyperlinks;for(f=0;f<b.hyperlinks.length;f++)k=b.hyperlinks[f],k.type="hyperlink",k.id="oit-hl-"+ ++c,p=k.url,0===p.indexOf("#")&&(k.targetId=p.substring(1)+"."+y.expando,k.url="#"+k.targetId);k=A.count();for(p=0;p<k;p++)(f=A.page(p))&&f.isLoaded()&&!f.isHidden()&&w(f,b.hyperlinks,0)}if(b.bookmarks){a=a?a.concat(b.bookmarks):b.bookmarks;for(f=0;f<b.bookmarks.length;f++)k=b.bookmarks[f],p=k.name,k.type="bookmark",k.id=p+"."+y.expando,d[k.id]||(d[k.id]=
k);k=A.count();for(p=0;p<k;p++)(f=A.page(p))&&f.isLoaded()&&n(f,b.bookmarks,0)}});var u=function(){if(t){for(var c,b=0;b<t.length;b++){var d=t[b];if(d.page.isLoaded()){var f=!0;d.page.isHidden()?f=!1:(e&&(d.hindex=w(d.page,e,d.hindex),d.hindex<e.length&&(f=!1)),a&&(d.bindex=n(d.page,a,d.bindex),d.bindex<a.length&&(f=!1)));f||(c||(c=[]),c.push(d))}}t=c}t||(r&&(Pa(r),r=void 0),E.offidle(u))},p=function(a,c,b){a.addDataToRange(c,b);"OIT.ihs(event)"==a.attr("onmouseover")&&a.attr("onmouseover",null);
"OIT.ihs(event)"==a.attr("ontouchstart")&&a.attr("ontouchstart",null)},J=function(a,c){var b=c.range,d=a.findRange(b.acc,b.accend);d&&oa(d,p,null,b,c)};A.onpageload(function(a,c){t||(t=[]);if(-1==t.indexOf(a)&&(t.push({page:a,hindex:0,bindex:0}),1==t.length))if("rt"!=a.type&&"sn"!=a.type||r)r=sb(u,75);else E.onidle(u)});A.onpageunload(function(a){if(e)for(var c=0;c<e.length;c++){var d=e[c];if(d.anchors)for(var f=d.anchors.length-1;0<=f;f--){var k=d.anchors[f];if(k.page===a){b.on.removeElement(k.anchorNode);
1==d.anchors.length?d.anchors=void 0:d.anchors.splice(f,1);break}}}delete a.linkMap});E.onreset(function(){b.on.removeAllElements();a=e=void 0;d={};c=0;t=k=null;r&&(Pa(r),r=void 0)});ob("ihs",function(a){if(e)for(var c=Cb(a.currentTarget),b,d=0;d<e.length;d++){var f=e[d];fb(c,f.range)&&(b||(b=A.forNode(a.currentTarget)),b&&J(b,f))}})}}),tb=ta.extend("attachments",{exports:["describe","setOptions"],userEventDef:{pub:!0,detail:function(b,e,a){(b=tb.describe(a))?b.attachment=a:b={};b.srcEvent=e;return b},
onListen:function(){tb.onListen()},onUnlisten:function(){tb.onUnlisten()},onAdd:function(){tb.onListen()},onRemove:function(){tb.onUnlisten()}},install:function(b){var e=[],a,d=0;b.item=function(a){return e[a]};b.describe=function(a){var c;0===arguments.length?c=bb(e):isNaN(a)||0<=a&&a<e.length&&(c=bb(e[a]));return c};b.setOptions=function(c){c&&(a||(a=new Db),c.hasOwnProperty("cursor")&&a.setRule(".oit-attachedFile {cursor:"+c.cursor+"}","cursor"),c.hasOwnProperty("color")&&a.setRule(".oit-attachedFile {color:"+
c.color+"}","color"))};b.onListen=function(){0===d&&v.viewNode&&v.viewNode.addClass("oit-attachevents");d++};b.onUnlisten=function(){0<d&&0===--d&&v.viewNode&&v.viewNode.removeClass("oit-attachevents")};E.onload(function(){0<d?v.viewNode.addClass("oit-attachevents"):v.viewNode.removeClass("oit-attachevents")});E.onreset(function(){e=[];a&&(a.destroy(),a=void 0)});ia.ondata(function(a,b,d){if(a.attachments)for(d=0;d<a.attachments.length;d++)b=a.attachments[d],b.id=e.length,e.push(b);if(a.pages)for(var c=
0;c<a.pages.length;c++){var f=a.pages[c].attachments;if(f)for(d=0;d<f.length;d++)b=f[d],b.id=e.length,e[b.id]=b}})}}),Jc=ta.extend("archive",{userEventDef:{pub:!0,detail:function(b,e,a){return{nodeid:a,name:b.text(),srcEvent:e}}}}),Ha=ta.extend("toolbars",{exports:["add","hide","remove","setSize","show"],events:{add:{pub:!0,detail:function(b,e){return{id:b,edge:e}}},remove:{pub:!0,detail:function(b,e){return{id:b,edge:e}}},show:{pub:!0,detail:function(b,e,a,d){return{id:b,edge:e,width:a,height:d}}},
hide:{pub:!0,detail:function(b,e){return{id:b,edge:e}}},resize:{pub:!0,detail:function(b,e,a,d){return{id:b,edge:e,width:a,height:d}}},resizeinternal:{}},install:function(b){var e=["left","top","right","bottom"],a=[],d,c,f=function(){lb(a,"refresh");la.dispatchResize()};la.onresize(f);A.onchange(function(){var a=A.activeOverlay();a!=c&&(c=a,f())});b.add=function(c,f,k){var n;if(-1===e.indexOf(c))b.invalidArg("add","edge",c,"Must be one of "+JSON.stringify(MEMORY_MODELS));else if(y.isElement(f)){var l,
u=!1,p=!1,t=!1,r;k&&(k.size&&((l="auto"===k.size?k.size:xb(k.size))||b.invalidArg("add","options.size",k.size,"Must be a valid CSS length or 'auto'")),!0===k.visible&&(u=!0),!0===k.overlay&&(p=!0),!0===k.resizable&&(t=!0),k.border&&(r=k.border));var w;d?(w=a[d],n=++d):n=d=1;k=v.viewNode;var G=k.scroll();f=new Nb(n,c,y.wrap(f),r,w);p&&f.overlay(!0);t&&f.resizable(!0);a[n]=f;l&&f.setSize(l);k.scroll(G);b.on.add.dispatch(n,c);u&&b.show(n)}else b.invalidArg("add","elem",f,"Must be a valid DOM Element");
return n};b.addInternal=function(c,b){a[c]=b};b.removeInternal=function(c){var b=a[c];b&&(b.remove(),delete a[c])};b.internalParent=function(c){var b,d;for(d in a)d=Number(d),d>c&&(void 0===b||d<b)&&(b=d);if(void 0!==b)return a[b]};b.remove=function(c){lb(a,k,c);f()};var k=function(c){var b=c.id;c.remove();for(a[b]=void 0;!a[d];)if(0>=--d){d=void 0;break}return!0};b.setSize=function(c,d){c=Number(c);var e=a[c];e&&!e.isInternal()||b.invalidArg("setSize","id",c,"Must be a valid toolbar id returned by OIT.toolbars.add");
var k="auto"===d?d:xb(d);k?e&&(e.setSize(k),f()):b.invalidArg("setSize","size",d,"Must be a valid CSS length or 'auto'")};b.show=function(c,b){lb(a,"show",c,b||{});f()};b.hide=function(c){lb(a,"hide",c);f()}}}),Gb,Ob,Pb,Kc;(function(){var b=null,e={},a=0;Gb=function(a,c,b,e,t,r){if(b&&"text"===c.type&&c.accend>c.acc&&(t=a.findRange(c.acc,c.accend,t))&&0<t.length)return e={type:"style",id:e,priority:r||0},"string"===typeof b?e.className=b:e.props=b,!b.color&&t[0].hasClass("oit-tt")&&(r=t[0].computedStyle().color,
r=Aa(r),r.a=1,b.color=Ia(r)),oa(t,"addDataToRange",null,c,e),a.pageLayoutChanged(),t};Pb=function(a,c,b,e){b&&a&&0<a.length&&(c={type:"style",id:c,priority:e||0},"string"===typeof b?c.className=b:c.props=b,!b.color&&a[0].hasClass("oit-tt")&&(e=a[0].computedStyle().color,e=Aa(e),e.a=1,b.color=Ia(e)),oa(a,"changeData",null,c))};Ob=function(a,c){oa(a,"removeData",null,"style",c)};Kc=function(d){d=Zb(d,!0);var c=e[d];c||(c="oit-ss"+ ++a,e[d]=c,b||(b=new Db),b.addCSSText("."+c+" {"+d+"}"));return c};E.onreset(function(){b&&
(b.destroy(),b=null);e={};a=0})})();Ea.extend(["page","drawing","slide","chart"],{de:"page",showhidden:!1,cellselection:!1});Ea.extend("bitmap",{de:"page",showhidden:!1,textselection:!1,cellselection:!1,customtextselection:!1});Ea.extend("html",{de:"page",rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1,elasticScroll:!1});Ea.extend("email",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});Ea.extend("rt",
{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});Ea.extend("sn",{de:"page",showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1});wb.extend("page",{install:function(b){var e,a=1,d=null,c,f,k,t,r,w=v.isMobileOrTablet?10:20,n=!1,l,u=0,p=0,J;b.load=function(h){e=h.overlay;a=1;d=null;c=h.type;f=void 0;if(!v.isMobile&&void 0===v.singlePageIndex)E.onidle(g);W(h);A.onadd(b,T);A.onchange(b,
m);P.onbeginselection(b,q);E.onscroll(b,B);if("email"===c)la.onresize(b,O);x.onremoveExtraEmailHeaders(b,ra);x.onscrollMode(b,fa);x.onpresentationMode(b,C);x.onnochrome(b,I);x.onshowEmailAddresses(b,ba);x.onshowAnnotations(b,aa);I(x.nochrome);z(h.index);aa();m()};b.unload=function(){E.screenCSS(".oit-annopane",null);A.offadd(T);A.offchange(m);P.offbeginselection(q);E.offscroll(B);la.offresize(O);x.offremoveExtraEmailHeaders(ra);x.offscrollMode(fa);x.offpresentationMode(C);x.offnochrome(I);x.offshowEmailAddresses(ba);
x.offshowAnnotations(aa);v.isMobile||E.offidle(g);f&&(f.destroy(),f=void 0);d&&d.hideStickyHeader();e=null;a=1;d=null;k=f=r=t=c=void 0;w=v.isMobileOrTablet?10:20};b.visiblePages=function(){var a=[];if("email"===c)e.each(function(c){a.push(c)});else if("vertical"==x.scrollMode&&void 0===v.singlePageIndex){var b=A.count(),d,g,h,f=A.current();for(d=f-1;0<=d;d--)if((g=A.page(d))&&g.isEnabled()){if(g.overlay!=e)break;h=g.pageRect("view");if(0>=h.bottom)break;f=d}a.push(A.page(f));var m=v.viewNode.clientHeight-
10;for(d=f+1;d<b;d++)if((g=A.page(d))&&g.isEnabled()){if(g.overlay!=e)break;h=g.pageRect("view");if(h.top>m)break;10<h.bottom&&a.push(g)}}else a.push(A.activePage());return a};b.saveScrollPos=function(){var a=A.page(b.visiblePages()[0]);if(a){var c=a.pageRect("view");return{page:a,offset:c.top/c.height}}};b.restoreScrollPos=function(a){if(a&&a.page&&void 0!==a.offset){var c=a.page.pageRect("view");(a=c.top-a.offset*c.height)&&v.viewNode.dscroll(void 0,a)}};b.margin=function(){return{left:w,top:w,
right:w,bottom:w}};var W=function(a){if(a._emailHeader){d=a._emailHeader;d.applyShowEmailAddresses();var c=a.overlay.firstPage,b=A.page(c.index+1);c&&c.load(!0,function(){b?b.load(!0,function(){b.parent()!=c.parent()&&c.parent().append(b);O()}):O()})}};b.layoutChanged=function(c){if(e){var b=v.viewNode,d=x.zoom;c||(c={x:0,y:0});var g=b.scroll(),h=null,f=null,q;q=w/x.zoom;1!=d&&(h=["scale(",d,",",d,")"].join(""),f="left top");q=2*q+A.annotationPaneWidth();q="vertical"==x.scrollMode?q+e.maxWidth:q+
A.activePage().width;e.css({transform:h,"transform-origin":f,"min-width":q+"px"});G();h=d/a;b.scroll((c.x+g.left)*h-c.x,(c.y+g.top)*h-c.y);a=d;m()}};var T=function(a){J||(J=ea(function(){J=void 0;G(!0);z()},500))},G=function(a){if(e){var b=x.rotation,d={yOffset:0,maxWidth:0,height:0},g=A.top(),h=[],m=x.centerPages,q=w/x.zoom;if("email"===c)m=!1,h.push(".oit-emailbk{"),h.push("margin:",q,"px"),h.push("}"),h.push(".oit-email-stickyheader{"),h.push("left:",q,"px"),h.push("}");else if("html"===c||"rt"===
c)m=!1;if(m){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");h.push("margin:",q,"px 0 ",q/2,"px 0");h.push("}");h.push(".oit-sn{");h.push("margin:0 0 ",2*q,"px 0");h.push("}");if(!x.nochrome&&0!==b){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");switch(b){case 90:h.push("box-shadow:-1px 1px 5px 0 rgba(0,0,0,.25) !important");break;case 180:h.push("box-shadow:-1px -1px 5px 0 rgba(0,0,0,.25) !important");break;case 270:h.push("box-shadow:1px -1px 5px 0 rgba(0,0,0,.25) !important")}h.push("}")}h.push(".oit-page:last-of-type,.oit-bitmap:last-of-type,.oit-drawing:last-of-type,.oit-slide:last-of-type,.oit-chart:last-of-type,.oit-sn:last-of-type{margin-bottom:",
q,"px;}")}"vertical"==x.scrollMode?e.each(Q,null,h,b,m,q,d):Q(A.activePage(),h,b,m,q,d);0===d.maxWidth?e.css("width",null):(d.maxWidth+=w+w,e.css("width",d.maxWidth+"px"));0===d.height?e.css("height",null):(d.height+=w,e.css("height",d.height+"px"));h=h.join("");f||(f=new Db);f.setCSSText(h);!g||k||a||"vertical"!=x.scrollMode||void 0!==v.singlePageIndex||(a=x.disableAnimation,x.disableAnimation=!0,A.moveto(g),x.disableAnimation=a);e.each(function(a){a.pageLayoutChanged();a.positionAnnotations()});
L.positionAll(e)}},Q=function(a,b,d,e,g,h){var f=0,m=0,q,k=v.viewNode.clientWidth,p=A.annotationPaneWidth();a.resetCache();if("sn"==a.type)e&&(f=(k/x.zoom-(a.offsetWidth+p))/2,f<g&&(f=g)),m=h.yOffset;else{if("email"===c||"html"===c||"rt"===c)d=0;switch(d){case 0:e&&(f=(k/x.zoom-(a.offsetWidth+p))/2,f<g&&(f=g));break;case 90:e&&(m=(k/x.zoom-(a.offsetHeight+p))/2,m<g&&(m=g));f=-h.yOffset-a.offsetWidth;h.yOffset=h.yOffset-a.offsetHeight+a.offsetWidth;a.offsetHeight>h.maxWidth&&(h.maxWidth=a.offsetHeight);
h.height+=a.offsetWidth+w;q="rotate(270deg) ";break;case 180:e&&(f=-((k/x.zoom-(a.offsetWidth+p))/2),f>-g&&(f=-g));f-=a.offsetWidth;m=-a.offsetHeight;q="rotate(180deg) ";break;case 270:e&&(m=-((k/x.zoom-(a.offsetHeight+p))/2),m>-g&&(m=-g)),m-=a.offsetHeight,f=h.yOffset,h.yOffset=h.yOffset-a.offsetHeight+a.offsetWidth,a.offsetHeight>h.maxWidth&&(h.maxWidth=a.offsetHeight),h.height+=a.offsetWidth+w,q="rotate(90deg) "}}f=M(f);m=M(m);if(0!==f||0!==m||q){b.push("#",a.id.replace(/\./g,"\\."));b.push(" {");
if(0!==f||0!==m||q)b.push($a.transform,":"),q&&b.push(q),0===f&&0===m||b.push("translate(",f,"px,",m,"px)"),b.push(";");b.push("}")}};b.moveto=function(a,b,e){var g=!1,h;e=e||{};if(ec(a))if(d)g=d.moveto(a,b,e);else{if("slide"==c&&(h=A.forRange(a))&&h.annotationPane()){var f=h.annotationPane().range();fb(f,a)&&h.annotationPane().activate(a,!0,!0,b,e)}}else"number"===typeof a&&(g=v.viewNode,h=A.page(a),z(h.index),(a=e.gotoNode)&&a!==h?a=A.elementRect(a,"overlay"):(a=h.pageRect("overlay").clone(),a.top-=
w),h=g.scroll().top,a=h+(a.top-h),0>a&&(a=0),a!=h?(E.on.scrollupdate.disable(),g.abortAnimation(),h=!1!==e.animate?150:0,k=!0,g.animate({scrollTop:a,time:h,endFn:D,args:[b,e]})):b&&b(e),g=!0);return g};var D=function(a,c,b){k=!1;E.on.scrollupdate.enable();E.on.scrollupdate.dispatch();c&&c(b)},h=function(a){"sn"!=a.type&&(r&&a.hiddenFromSlideshow?a.hide():a.show())},z=function(a){var b=!1;"vertical"===x.scrollMode&&void 0===v.singlePageIndex?v.viewNode.removeClass("oit-single"):v.viewNode.addClass("oit-single");
if("vertical"==x.scrollMode&&void 0===v.singlePageIndex||"email"===c||"html"===c||"rt"===c)void 0!==t&&(e.showPages(),t=void 0,b=!0,r=!1),a="slideshow"==x.presentationMode,a!=r&&(r=a,b=!0,e.each(h));else if(a=a||A.current(),a!=t){var d=A.page(a);if(d){var g;void 0===t?e.hidePages(d.index):(g=A.page(t),d.addClass("oit-noshadow"));d.show({insertLast:!0,animate:!0,endFn:function(){d.removeClass("oit-noshadow");g&&g.hide()}});t=a;b=!0;v.isMobileOrTablet&&e.css("min-height",d.height+w+w+"px")}}b&&(E.dispatchPageEvents(!0),
L.positionAll(e))};b.pageRange=function(a,c){if("rect"===c){var b=A.page(a);if(b)return b=b.pageRect(),mb(a,0,0,b.width,b.height)}};b.rangeRect=function(a,c,b,d){var e;if("text"===a.type){var g=A.forRange(a);g&&(e=g.textBoundingRect(a,d))}else"rect"===a.type&&(e=new ja(a),void 0!==a.embedId&&((d=A.page(a.page))&&(g=d.embeddingRect(a.embedId)),g?e.offset(g.left,g.top):e=void 0));e&&(e.origin=c);return e};b.rangeFromRect=function(a,c,b,d,e,g,h,f){var m;if(a=A.page(a))c=new ja(c,b,d,e,g),c.origin=a,
b=void 0!==f?a.embeddingRect(f):a.pageRect(),"html"!==a.type&&"rt"!==a.type&&"sn"!==a.type&&("move"===h?c.constrain(b):"select"!==h&&c.intersect(b)),void 0!==f?(c.offset(-b.left,-b.top),m=c.toRange(a),m.embedId=f,ya(m,"pct")):m=c.toRange(a);return m};b.extendRange=function(a,c,d,e){var g=b.rangeRect(a,e);return b.rangeFromRect(a.page,g.left,g.top,c,d,e,"extend")};var g=function(a){if(!a)return A.loadNextPageFromServer()||E.offidle(g),!1},m=function(){if(!v.isMobile&&void 0===v.singlePageIndex)E.onidle(g);
v.viewNode.scroll();for(var a=F.visiblePages(),c=0;c<a.length;c++){var b=a[c];b&&b.isPending()&&b.load(!1)}},O=function(){e.each(R);d&&d.applyViewSize()},H=function(){if("email"===c){var a=v.viewNode.clientWidth-146;30>a&&(a=30);return a}},N=function(){if(this.hasClass("oit-ximage"))this.css("max-width",null),this.removeClass("oit-ximage"),this.addClass("oit-cimage");else if(this.hasClass("oit-cimage")){var a=H();this.css("max-width",""+a+"px");this.addClass("oit-ximage");this.removeClass("oit-cimage")}O();
A.each("pageLayoutChanged")},R=function(a){if(a.hasClass("oit-rt")&&a.isLoaded()){var c=H();if(c!==a.pageContentMaxWidth){a.pageContentMaxWidth=c;for(var b,d,e=0;;e++){var g=a.embeddingByIndex(e);if(!g)break;var h=y.byId(g.id);if(h&&(c&&(g.w>c?(h.hasClass("oit-cimage")||(h.css("max-width",""+c+"px"),h.addClass("oit-ximage")),h.onclick(N),h.ontap(N)):(h.css("max-width",null),h.removeClass("oit-ximage"),h.removeClass("oit-cimage"),h.offclick(N),h.offtap(N))),g=A.elementRect(h,a))){if(void 0===b||g.right>
b)b=g.right;if(void 0===d||g.bottom>d)d=g.bottom}}void 0!==b&&a.css("min-width",b+10+"px");void 0!==d&&a.css("min-height",d+10+"px");if(c&&(b=a.childByTagName("div"))&&(b=b.childrenByTagName("TABLE")))for(d=0;d<b.length;d++)b[d].css("max-width",""+c+"px");a.pageLayoutChanged()}}},ra=function(a){d&&a&&d.removeExtraEmailHeaders()},fa=function(){e&&(z(),v.viewNode.scroll(0,0),A.updateActivePage())},C=function(){e&&z()},I=function(a){e&&(w=a?0:v.isMobileOrTablet?10:20,z())},q=function(){d&&d.beginSelection()};
b.startElasticScroll=function(){var a=x.scrollMode;"hswipe"!==a&&"vswipe"!==a||!F.features().elasticScroll||(v.viewNode.css("overflow","hidden"),n=!0,p=u=0)};b.elasticScroll=function(a,c){if(n){var b=x.scrollMode,d="hswipe"===b,b="vswipe"===b,g=0,h=0;void 0!==a&&d&&(u=g=-a,e.css("left",g+"px"));void 0!==c&&b&&(p=h=-c,e.css("top",h+"px"));if(g||h){v.viewNode.cancelKinetic();var b=A.activePage(),f=b.annotationPane();f&&f.hide();var m;if(0<g||0<h)m=A.prev(A.current());else if(0>g||0>h)m=A.next(A.current());
m&&m!==l&&(l&&(l.hide(),l.css({left:null,top:null,position:null}),l=void 0),m.overlay==b.overlay&&(h=g=0,m.index<b.index?d?g=b.pos(e).left/x.zoom-w-m.width:h=b.pos(e).top/x.zoom-w-m.height:d?g=b.rect(e).right/x.zoom+w:h=b.rect(e).bottom/x.zoom+w,m.css({left:g+"px",top:h+"px",position:"absolute",transform:"none"}),m.show({animate:!1}),(f=m.annotationPane())&&f.hide(),l=m))}Sa()}};b.endElasticScroll=function(a,c){if(n){n=!1;v.viewNode.css("overflow",null);var b="hswipe"===x.scrollMode;v.viewNode.cancelKinetic();
var d,g=A.activePage();b?(b=a/(g.width*x.zoom),d=a/v.viewNode.clientWidth):(b=c/(g.height*x.zoom),d=c/v.viewNode.clientHeight);d=Math.max(b,d);var h=b=0,f=g;-.25>d?f=A.prev(g.index)||g:.25<d&&(f=A.next(g.index)||g);f!==g&&(b=(v.viewNode.clientWidth-f.width*x.zoom)/2,b<w&&(b=w),d=w,h=f.pos(v.viewNode),b=u+b-h.left,h=p+d-h.top);e.animate({offsetLeft:b,offsetTop:h,time:100,transition:f!==g?"ease-in":"ease-out",endFn:function(){l&&(l!==f&&l.hide(),l.css({left:null,top:null,transform:null}),l=void 0);
e.css({left:null,top:null});f!==g&&(A.deactivateAnnotation(),v.viewNode.scroll(0,0),A.movetoEx(f.index,{animate:!1}),L.each("addToPage",null,f.index));if(x.showAnnotations){var a=f.annotationPane();a&&a.show()}Sa()}});Sa()}};var B=function(){if(d)d.onScroll()},ba=function(){d&&d.applyShowEmailAddresses()},aa=function(){var a=x.showAnnotations;if(a){var c=A.activePage();c&&!c.supportsAnnotationBar()&&E.screenCSS(".oit-annopane","width:338px !important;");A.scrollToAnnotationPane(L.updateHighlights)}else A.deactivateAnnotation(),
E.screenCSS(".oit-annopane",null);e.each(function(c){(c=c.annotationPane())&&(a?c.show():c.hide())});E.dispatchPageEvents()}}});Ea.extend(["worksheet","database"],{de:"ss",rotate:!1,textselection:!1,rectselection:!1,customtextselection:!1});wb.extend("ss",{install:function(b){var e,a,d,c,f=!1;b.load=function(f){e=f;c=d=a=null;if(a=f.spreadsheetModel())d=new cd(a,e),(f=a.showHidden())?(f={columns:f.columns,rows:f.rows},b.showHidden(f)):d.showHidden(x.showHiddenColumns,x.showHiddenRows),d.doUpdate();
x.onshowHiddenRows(b,k);x.onshowHiddenColumns(b,t);x.onshowAnnotations(b,r);r()};b.unload=function(){x.offshowHiddenRows(k);x.offshowHiddenColumns(t);x.offshowAnnotations(r);c&&ua(c);d&&d.unload();c=d=a=null};b.maxPageWidth=function(){if(d)return d.maxPageWidth()};b.maxPageHeight=function(){if(d)return d.maxPageHeight()};b.padding=function(){if(d)return d.padding()};b.scrollOffset=function(){if(d)return d.scrollOffset()};b.getSelectedText=function(){return a?a.getSelectedText():""};b.select=function(c){return a?
a.select(c):!1};b.keydown=function(c){var b=!0;if(d)switch(c.keyCode){case 33:v.viewNode.dscroll(0,-(d.visibleHeight()+1));if(c=P.cellSelection())b=d.visibleRange(),b=b.r2-b.r1+1,c.c2=c.c1,c.r1-=b,0>c.r1&&(c.r1=0),c.r2=c.r1,P.select(c);b=!1;break;case 34:v.viewNode.dscroll(0,d.visibleHeight()+1);if(c=P.cellSelection())b=d.visibleRange(),b=b.r2-b.r1+1,c.c2=c.c1,c.r1+=b,b=a.rowCount()-1,c.r1>b&&(c.r1=b),c.r2=c.r1,P.select(c);b=!1;break;case 35:f=!f;b=!1;break;case 36:d.scrollToRange(0,0,0,0);c=sa(e.index,
0,0);P.select(c);b=f=!1;break;case 27:d.hidePopup(!0);b=f=!1;break;case 37:case 38:case 39:case 40:break;default:f=!1}return b};b.loadRange=function(c,b){a&&a.loadRange(c,b)};b.expandRange=function(c){a&&(c=a.expandRange(c));return c};b.moveto=function(a,c,b){return d?d.moveto(a,c,b):!1};b.showHidden=function(c){void 0===c&&(c="all");var b=a.showHidden(c);"string"===typeof c&&(c=b);d&&d.showHidden(c.columns,c.rows)};var k=function(){d&&d.showHidden(void 0,x.showHiddenRows)},t=function(){d&&d.showHidden(x.showHiddenColumns,
void 0)},r=function(){P.select(null);a&&a.showAnnotations(x.showAnnotations);d&&(d.showHidden(x.showHiddenColumns,x.showHiddenRows),d.update())};b.pageRange=function(c,b){if("cell"===b&&c==e.index)return sa(c,0,0,a.colCount()-1,a.rowCount()-1)};b.pageRect=function(a,c){if(d)return d.pageRect(a,c)};b.rangeRect=function(a,c,b){if(d)return d.rangeRect(a,c,b)};b.rangeFromRect=function(a,c,b,e,f,k,n,t){if(d)return d.rangeFromRect(a,c,b,e,f,k,n,t)};b.extendRange=function(a,c,b,e){if(d)return d.extendRange(a,
c,b,e)};var w=function(c,b){var d=ma(c+b,0,a.colCount()-1);if(0!==b&&a.colHidden(d)){var e=a.colCount()-1;do if(d+=b,0>d){for(d=0;d<=e&&a.colHidden(d);d++);break}else if(d>e){for(d=e;0<=d&&a.colHidden(d);d--);break}while(a.colHidden(d))}return d},n=function(c,b){var d=ma(c+b,0,a.rowCount()-1);if(0!==b&&a.rowHidden(d)){var e=a.rowCount()-1;do if(d+=b,0>d){for(d=0;d<=e&&a.rowHidden(d);d++);break}else if(d>e){for(d=e;0<=d&&a.rowHidden(d);d--);break}while(a.rowHidden(d))}return d};b.moveAnchor=function(c,
b,e,k){k=!1;f&&(0>b?b=-a.colCount():0<b&&(b=a.colCount()),0>e?e=-a.rowCount():0<e&&(e=a.rowCount()),f=!1);b=w(c.c1,b);e=n(c.r1,e);c.c1!=b&&(c.c1=b,k=!0);c.c2!=b&&(c.c2=b,k=!0);c.r1!=e&&(c.r1=e,k=!0);c.r2!=e&&(c.r2=e,k=!0);k&&d.scrollToRange(c.c1,c.r1,c.c1,c.r1);return k};b.incrementSelection=function(c,b,e,k,t){t=!1;f&&(0>e?e=-a.colCount():0<e&&(e=a.colCount()),0>k?k=-a.rowCount():0<k&&(k=a.rowCount()),f=!1);b.c2==c.c1?(e=w(b.c1,e),e!=b.c1&&(e<=b.c2?b.c1=e:(b.c1=b.c2,b.c2=e),t=!0)):(e=w(b.c2,e),e!=
b.c2&&(e>=b.c1?b.c2=e:(b.c2=b.c1,b.c1=e),t=!0));b.r2==c.r1?(k=n(b.r1,k),k!=b.r1&&(k<=b.r2?b.r1=k:(b.r1=b.r2,b.r2=k),t=!0)):(k=n(b.r2,k),k!=b.r2&&(k>=b.r1?b.r2=k:(b.r2=b.r1,b.r1=k),t=!0));t&&(k=b.c2==c.c1?b.c1:b.c2,c=b.r2==c.r1?b.r1:b.r2,d.scrollToRange(k,c,k,c));return t};b.layoutChanged=function(a){d&&d.layoutChanged(a)};b.update=function(a){d&&d.update(a)}}});Ea.extend(["archive","emailarchive"],{de:"arc",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,highlights:!1,rectselection:!1,cellselection:!1,
anchorednotes:!1});wb.extend("arc",{install:function(b){var e,a,d,c,f=function(a){a.preventDefault();n(this.parentNode.parentNode.parentNode,this)},k=function(a){n(this.parentNode.parentNode.parentNode,this)},t=function(b){c=a.scroll()},r=function(b){a.autoscroll(c.left-b.delta.x,c.top-b.delta.y)},w=function(){var c=a.scroll().left;c!=d&&(d=c,0===d?e.css("margin-left",null):e.css("margin-left",-d+"px"))};b.load=function(c){e=c.childByClass("oit-tree-head");a=c.childByClass("oit-tree-nodes");d=0;a.kinetic(!0);
var b=y.byClass("oit-open-close");b&&(oa(b,"onclick",null,f),oa(b,"ontap",null,k));if(b=y.byClass("oit-tree-nname"))for(c=0;c<b.length;c++){var p=b[c],u=p.attr("data-nodeid");null!==u&&""!==u&&(u=Number(u),isNaN(u)||Jc.on.addElement(p,u))}if(b=e.byClass("oit-col-header"))for(c=0;c<b.length;c++)b[c].ctrl=new l(b[c],e),b[c].ctrl.colClass="f"+c;c=e;var n;a:{try{for(var h=X.styleSheets,b=0;b<h.length;b++){var z=h[b].cssRules||h[b].rules;if(0<z.length&&"div.f0"==z[0].selectorText){n=b;break a}}}catch(g){}n=
null}c.ssIndex=n;a.onscroll(w);a.onpanstart(t);a.onpanmove(r)};b.unload=function(){Jc.on.removeAllElements()};var n=function(a,c){var b=a.nextElementSibling;"none"!=b.style.display?(b.style.display="none",c&&c.addClass("closed")):(b.style.display="block",c&&c.removeClass("closed"))},l=function(a,c){S.call(this,"div","oit-col-dragger");this.append(y.create("div"));this.headerbar=c;var b=a.nextSiblingElem();b?e.insert(this,b):e.append(this);this.header=a;this.ondragstart(u);this.ondragmove(p);this.ondragend(J);
this.ondragcancel(J)};V(l,S);var u=function(a){this.orgwidth=this.header.clientWidth;this.overlay||(a=v.viewNode,this.overlay=y.create("div","oit-tree-overlay"),this.overlay.css({height:a.clientHeight-this.headerbar.clientHeight+"px",top:this.headerbar.clientHeight+2+"px",left:this.header.offsetLeft-3+"px"}),this.overlay.innerWidth=this.orgwidth+6,this.header.parent().append(this.overlay));return!1},p=function(a){a=this.orgwidth+a.delta.x-3;1>a&&(a=1);this.header.innerWidth=a;this.overlay.innerWidth=
a+9;return!1},J=function(a){this.overlay.destroy();delete this.overlay;this.header.css("width",null);var c=this.orgwidth+a.delta.x-3;1>c&&(c=1);c+="px";if(null!==this.headerbar.ssIndex){var b=X.styleSheets[this.headerbar.ssIndex].cssRules,d="div."+this.colClass;for(a=0;a<b.length;a++)if(b[a].selectorText==d){b[a].style.width=c;break}}else for(b=this.headerbar.parent().byClass(this.colClass),a=0;a<b.length;a++)b[a].css("width",c);return!1}}});var ja=function(){var b=function(){var a=arguments;if(1===
a.length)a=a[0],void 0!==a.units?("px"!==a.units&&(a=ga(a),ya(a,"px")),this.l=a.left,this.t=a.top,this.r=a.right,this.b=a.bottom,this.o=A.page(a.page)):a.o&&(this.l=a.l,this.t=a.t,this.r=a.r,this.b=a.b,this.o=a.o);else if(2===a.length){var b=a[0];this.l=b.left;this.t=b.top;this.r=b.right;this.b=b.bottom;this.o=a[1]}else this.l=a[0],this.t=a[1],this.r=a[2],this.b=a[3],this.o=a[4];a=this.o&&("view"===this.o||"overlay"===this.o||this.o instanceof S);if(!(Y(this.l)&&Y(this.t)&&Y(this.r)&&Y(this.b)&&a))throw"Invalid Rectangle";
this.l=M(this.l,1E4);this.t=M(this.t,1E4);this.r=M(this.r,1E4);this.b=M(this.b,1E4);this.l>this.r&&(a=this.l,this.l=this.r,this.r=a);this.t>this.b&&(a=this.t,this.t=this.b,this.b=a);this.w=this.r-this.l;this.h=this.b-this.t},e=V(b);Object.defineProperties(e,{left:{enumerable:!0,get:function(){return this.l},set:function(a){this.verifyMutable();this.l=M(a,1E4);this.r=this.l+this.w}},top:{enumerable:!0,get:function(){return this.t},set:function(a){this.verifyMutable();this.t=M(a,1E4);this.b=this.t+
this.h}},right:{enumerable:!0,get:function(){return this.r},set:function(a){this.verifyMutable();this.r=M(a,1E4);this.l=this.r-this.w}},bottom:{enumerable:!0,get:function(){return this.b},set:function(a){this.verifyMutable();this.b=M(a,1E4);this.t=this.b-this.h}},width:{enumerable:!0,get:function(){return this.w},set:function(a){this.verifyMutable();0>a&&(a=0);this.w=M(a,1E4);this.r=this.l+this.w}},height:{enumerable:!0,get:function(){return this.h},set:function(a){this.verifyMutable();0>a&&(a=0);
this.h=M(a,1E4);this.b=this.t+this.h}},origin:{enumerable:!0,get:function(){return this.o},set:function(a){this.verifyMutable();this.convert(a)}}});var a=function(a,b,d){return"number"===typeof d&&(d=M(d,1E4),d!==a[b])?(a[b]=d,!0):!1};e.move=function(b,d,e,t){this.verifyMutable();b=a(this,"l",b);b|=a(this,"t",d);b|=a(this,"r",e);if(b|=a(this,"b",t))this.w=this.r-this.l,this.h=this.b-this.t;return b};e.movesize=function(b,d,e,t){this.verifyMutable();b=a(this,"l",b);b|=a(this,"t",d);b|=a(this,"w",e);
if(b|=a(this,"h",t))this.r=this.l+this.w,this.b=this.t+this.h;return b};e.offset=function(a,b){this.verifyMutable();void 0!==a&&(this.left+=a);void 0!==b&&(this.top+=b)};e.size=function(a,b){this.verifyMutable();void 0!==a&&(this.width=a);void 0!==b&&(this.height=b)};e.scale=function(a){void 0!==a&&(this.verifyMutable(),this.left*=a,this.top*=a,this.width*=a,this.height*=a)};var d=function(a,b){return a===b?!0:.999<(a>b?b/a:a/b)};e.equals=function(a){return d(this.l,a.left)&&d(this.t,a.top)&&d(this.r,
a.right)&&d(this.b,a.bottom)};e.overlaps=function(a){return this.l<a.right&&this.r>a.left&&this.t<a.bottom&&this.b>a.top};e.contains=function(a){return a.left>=this.l&&a.right<=this.r&&a.top>=this.t&&a.bottom<=this.b};e.containsPoint=function(a,b){return a>=this.l&&a<=this.r&&b>=this.t&&b<=this.b};e.union=function(a,b,d,e){if(1==arguments.length){var c=arguments[0];this.union(c.left,c.top,c.right,c.bottom)}else this.verifyMutable(),a=M(a,1E4),b=M(b,1E4),d=M(d,1E4),e=M(e,1E4),a<this.l&&(this.l=a),
b<this.t&&(this.t=b),d>this.r&&(this.r=d),e>this.b&&(this.b=e),this.w=this.r-this.l,this.h=this.b-this.t};e.intersect=function(a,b,d,e){if(1==arguments.length){var c=arguments[0];this.intersect(c.left,c.top,c.right,c.bottom)}else this.verifyMutable(),a=M(a,1E4),b=M(b,1E4),d=M(d,1E4),e=M(e,1E4),this.l=ma(this.l,a,d),this.r=ma(this.r,a,d),this.t=ma(this.t,b,e),this.b=ma(this.b,b,e),this.w=this.r-this.l,this.h=this.b-this.t};e.constrain=function(a,b,d,e){if(1==arguments.length){var c=arguments[0];this.constrain(c.left,
c.top,c.right,c.bottom)}else{this.verifyMutable();a=M(a,1E4);b=M(b,1E4);d=M(d,1E4);e=M(e,1E4);var c=d-a,f=e-b;this.width>=c?(this.l=a,this.r=d,this.w=c):this.left<a?this.left=a:this.right>d&&(this.right=d);this.height>=f?(this.t=b,this.b=e,this.h=f):this.t<b?this.top=b:this.b>e&&(this.bottom=e)}};e.clone=function(){return new b(this.left,this.top,this.right,this.bottom,this.origin)};e.toRange=function(a){var b=this;this.o!==a&&(b=this.clone(),b.origin=a);return mb(a.index,b.left,b.top,b.right,b.bottom)};
e.readonly=function(a){"boolean"===typeof a&&(this._readonly=a);return!!this._readonly};e.verifyMutable=function(){if(this._readonly)throw"Attempted to modify a read-only Rectangle";};e.distanceFrom=function(a,b,d,e,r){a=M(a,1E4);b=M(b,1E4);switch(d){case "left":a-=this.l;break;case "center":a-=(this.l+this.r)/2;break;case "right":a-=this.r;break;case "none":a=0;break;default:a=a<this.l?a-this.l:a>this.r?a-this.r:0}switch(e){case "top":b-=this.t;break;case "middle":b-=(this.t+this.b)/2;break;case "bottom":b-=
this.b;break;case "none":b=0;break;default:b=b<this.t?b-this.t:b>this.b?b-this.b:0}if("xy"===r)r={x:a,y:b,ax:Math.abs(a),ay:Math.abs(b)};else if(0===a&&0===b)r=0;else if(r=M(Math.sqrt(a*a+b*b),10),0>b||0===b&&0>a)r=-r;return r};e.convert=function(a){var b=this.o;if(a!==b){var c,d=x.rotation,e=x.zoom;if(a instanceof cb)if("view"===b||"overlay"===b){if(c=a,(b=c.pagePos(b))&&this.offset(-b.left,-b.top),c.features().zoom&&1!=e&&this.move(this.l/e,this.t/e,this.r/e,this.b/e),c.features().rotate&&0!==d)switch(d){case 90:this.move(c.width-
this.b,this.l,c.width-this.t,this.r);break;case 180:this.move(c.width-this.r,c.height-this.b,c.width-this.l,c.height-this.t);break;case 270:this.move(this.t,c.height-this.r,this.b,c.height-this.l)}}else if(b instanceof cb)b=b.pageRect(),c=a.pageRect(),this.offset(c.left-b.left,c.top-b.top);else throw"Unsupported Rectangle conversion";else if(b instanceof cb)if("view"===a||"overlay"===a){c=b;if(c.features().rotate&&0!==d)switch(d){case 90:this.move(this.t,c.width-this.r,this.b,c.width-this.l);break;
case 180:this.move(c.width-this.r,c.height-this.b,c.width-this.l,c.height-this.t);break;case 270:this.move(c.height-this.b,this.l,c.height-this.t,this.r)}c.features().zoom&&"email"!==c.type&&"rt"!==c.type&&1!=e&&this.move(this.l*e,this.t*e,this.r*e,this.b*e);(b=c.pagePos(a))&&this.offset(b.left,b.top)}else throw"Unsupported Rectangle conversion";else if("view"===a||"overlay"===a||a instanceof S)if("view"===b)b=F.padding(),c=F.scrollOffset(),this.left=this.left-b.left+c.left,this.top=this.top-b.top+
c.top,a instanceof S&&(b=(c=a.ancestorByClass("oit-overlay"))?a.pos(c):a.pos(v.viewNode),this.left-=b.left,this.top-=b.top);else{if("overlay"===b||b instanceof S)b instanceof S&&(b=(c=b.ancestorByClass("oit-overlay"))?b.pos(c):b.pos(v.viewNode),this.left+=b.left,this.top+=b.top),"view"===a&&(b=F.padding(),c=F.scrollOffset(),this.left=this.left+b.left-c.left,this.top=this.top+b.top-c.top)}else throw"Unsupported Rectangle conversion";this.o=a}return this};return b}(),gc=function(){var b=function(a){this._rects=
[];this.add(a)},e=V(b);Object.defineProperties(e,{length:{enumerable:!0,get:function(){return this._rects.length}},left:{enumerable:!0,get:function(){return this.boundingRectangle().left}},top:{enumerable:!0,get:function(){return this.boundingRectangle().top}},right:{enumerable:!0,get:function(){return this.boundingRectangle().right}},bottom:{enumerable:!0,get:function(){return this.boundingRectangle().bottom}},width:{enumerable:!0,get:function(){return this.boundingRectangle().width}},height:{enumerable:!0,
get:function(){return this.boundingRectangle().height}}});e.item=function(a){return this._rects[a]};e.add=function(a){if(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._rects.push(a[b]);else this._rects.push(a);this._boundingRect=null}return this};e.convert=function(a){oa(this._rects,"convert",null,a);this._boundingRect=null;return this};e.boundingRect=function(){if(!this._boundingRect){for(var a=this._rects,b=a[0],c=b.left,e=b.top,k=b.right,t=b.bottom,r=1;r<a.length;r++)b=a[r],b.left<c&&
(c=b.left),b.top<e&&(e=b.top),b.right>k&&(k=b.right),b.bottom>t&&(t=b.bottom);this._boundingRect=new ja(c,e,k,t,a[0].origin)}return this._boundingRect};e.interiorRect=function(a,b){for(var c=this._rects,d=null,e=0,t=0;t<c.length;t++){var r=c[t];if(r.width>=a.width&&r.height>=a.height){d=r;break}else if(!d||r.width>d.width||r.height>d.height){var w=r.width/a.width,n=r.height/a.height,l=Math.min(w,n);b&&(w=r.height/a.width,n=r.width/a.height,l=Math.max(l,Math.min(w,n)));if(!d||l>e)d=r,e=l}}if(d)return d.clone()};
return b}(),Db=function(){var b=function(a){S.call(this,"style");a&&this.attr("media",a);this.append(y.createText(""));y.head.append(this);this.rulecount=0;this.indexLookup={};Object.defineProperty(this,"sheet",{get:function(){return this.dom.sheet}})},e=V(b,S);e.addCSSText=function(a){this.html(this.html()+a)};e.setCSSText=function(a){this.html(a)};e.setRule=function(a,b){if(b&&this.indexLookup.hasOwnProperty(b))return this.updateRuleByIndex(a,this.indexLookup[b]);try{return this.sheet.insertRule(a,
this.rulecount),b&&(this.indexLookup[b]=this.rulecount),this.rulecount++}catch(c){this.logError("setRule","Error inserting style rule: "+c.message)}};e.updateRuleByIndex=function(a,b){if(!isNaN(b)){try{this.sheet.deleteRule(b),this.sheet.insertRule(a,b)}catch(c){this.logError("updateRuleByIndex","Error updating style rule: "+c.message)}return b}};e.updateRule=function(a,b){this.indexLookup.hasOwnProperty(b)?this.updateRuleByIndex(a,this.indexLookup[b]):this.updateRuleByIndex(a,b)};e.removeFromNames=
function(a){for(var b in this.indexLookup)this.indexLookup[b]==a?delete this.indexLookup[b]:this.indexLookup[b]>a&&--this.indexLookup[b]};e.deleteRule=function(a){a=this.indexLookup.hasOwnProperty(a)?this.indexLookup[a]:a;!isNaN(a)&&a<this.rulecount&&(this.sheet.deleteRule(a),this.removeFromNames(a),this.rulecount--)};e.hasRule=function(a){return this.indexLookup.hasOwnProperty(a)};return b}(),Pc=function(){var b=function(a,b){a/=b/2;if(1>a)return.5*a*a;a--;return-.5*(a*(a-2)-1)},e={ease:b,"ease-in-out":b,
"ease-in":function(a,b){a/=b;return a*a*a},"ease-out":function(a,b){a/=b;a--;return a*a*a+1},linear:function(a,b){return a/b}},a="opacity offsetLeft offsetTop innerWidth innerHeight scrollLeft scrollTop".split(" "),d={scrollLeft:!1,scrollTop:!1},c=[],f=function(a){sc(c,"step",null,a);0<c.length&&kb(f)},k=function(a){var b=a.elem;b&&b.dom&&(b.data("_animation")===a&&b.removeData("_animation"),b.removeClass("oit-animating"));Fa(c,a)};E.onreset(function(){oa(c,"finish");c=[];for(var a in d)d.hasOwnProperty(a)&&
(d[a]=!1)});var t=function(a,b,c){b=b[a];void 0!==b&&(c[a]=b)},r=function(a,b,c){b=b[a];Oa(b)&&(c[a]=b)},w=function(a,b){var c=a[b];c&&(a.args?c.apply(a.context,a.args):c.call(a.context,a.elem))},n=function(a,b){var c=a[b];c&&a.elem&&a.elem.dom&&a.elem.css(c)},l=function(k,l){this.elem=k;this.time=void 0!==l.time?l.time:120;r("startFn",l,this);r("stepFn",l,this);r("endFn",l,this);t("context",l,this);l.args&&(this.args=Array.prototype.slice.call(l.args,0),this.args.unshift(k));t("startCSS",l,this);
t("endCSS",l,this);this.transFn=e[l.transition]||b;for(var p=x.disableAnimation||0>=this.time,u=0;u<a.length;u++){var n=a[u],w=l[n];if(void 0!==w){var D=k[n];D!=w&&(this.props||(this.props={}),this.props[n]={start:D,end:w},p|=d[n])}}p||!this.props?this.finish():(c.push(this),k.data("_animation",this),k.addClass("oit-animating"),kb(f))},u=V(l);u.isEmpty=function(){return 0>=this.time||!this.props};u.step=function(a){var b=!1,c=this.elem;c&&c.dom&&void 0===this.startTime&&(n(this,"startCSS"),w(this,
"startFn"),this.startTime=a,this.steps=0,c=this.elem);if(c&&c.dom&&(this.steps++,a-=this.startTime,a=a>=this.time?1:this.transFn(a,this.time),1>a)){var b=this.props,d;for(d in b){var e=b[d];c[d]=e.start+(e.end-e.start)*a}w(this,"stepFn");b=!0}b||this.finish();return b};u.finish=function(){var a=this.elem;if(a){var b=this.props,c;if(this.steps&&4>this.steps)for(c in b)d.hasOwnProperty(c)&&(d[c]=!0);k(this);void 0===this.startTime&&(n(this,"startCSS"),w(this,"startFn"));if(a.dom)for(c in b)a[c]=b[c].end;
n(this,"endCSS");w(this,"endFn");this.deleteAll()}};u.abort=function(){this.elem&&(k(this),this.deleteAll())};return l}(),Lc=function(){var b=[],e=OIT.DialogBox=function(a){S.call(this,"div","oit-dialog");a=a||{};this._resizable=this._moveable=this._modal=this._visible=!1;b.push(this);this.css("opacity",0);this._form=y.create("form",this);this.move(a.x,a.y,a.width,a.height);void 0!==a.className&&this.addClass(a.className);void 0!==a.moveable&&this.moveable(a.moveable);void 0!==a.resizable&&this.resizable(a.resizable);
void 0!==a.modal&&this.modal(a.modal);void 0!==a.resultFn&&(this._resultFn=a.resultFn);void 0!==a.destroyFn&&(this._destroyFn=a.destroyFn);void 0!==a.title&&this.title(a.title);void 0!==a.textColor&&this.css("color",a.textColor);void 0!==a.backgroundColor&&this._form.css("background-color",a.backgroundColor);a.cancel&&(k(this,U.CANCEL,this.cancel),this.onkeydown(t));a.ok&&k(this,U.OK,this.ok);a.no&&k(this,U.NO,this.no);a.yes&&k(this,U.YES,this.yes);v.rootNode.append(this)},a=V(e,S),d=function(a){a=
this.pos();this._dragX=a.left;this._dragY=a.top;this._header.css("cursor",Sb);return!1},c=function(a){this.move(this._dragX+a.delta.x,this._dragY+a.delta.y);this._header.css("cursor",Sb);return!1},f=function(a){this._header.css("cursor",Rb);return!1},k=function(a,b,c){a._footer||(a._footer=y.create("footer",a),a._footerVisible=!0);b=new Yb(b);a._footer.append(b);b.onclick(a,c);b.ontap(a,c)},t=function(a){return 27==a.keyCode?!1:!0},r=function(a){var b=0;a._header&&(a._header.css("cursor",a._moveable?
Rb:null),b=a._header.offsetHeight);if(a._footer&&a._footerVisible)a._footer.css("display",null),a._form.css({height:null,position:"absolute",top:b+"px",left:"0px",right:"0px",bottom:a._footer.offsetHeight+"px"});else{a._footer&&a._footer.css("display","none");var c=null;0<b&&(c=a.clientHeight-b+"px");a._form.css({position:null,left:null,right:null,top:null,bottom:null,height:c})}};a.destroy=function(){this.cancel();this.show(!1,{animate:!1});this._destroyFn&&this._destroyFn(this);Fa(b,this);S.prototype.destroy.call(this)};
a.exit=function(){this.cancel();this.show(!1,{endFn:this.destroy,context:this})};a.moveable=function(a){if(!0===a||!1===a)this._moveable=a,r(this);return this._moveable};a.resizable=function(a,b,c){if((!0===a||!1===a)&&a!=this._resizable){this._resizable=a;var d,e;this._resizable?(this.addClass("oit-dialog-resizable"),void 0!==b&&(d=b+"px"),void 0!==c&&(e=c+"px")):this.removeClass("oit-dialog-resizable");this.css({"min-width":d,"min-height":e})}return this._resizable};a.modal=function(a){!0!==a&&
!1!==a||a===this._modal||(this._modal=a,Ba.showModalOverlay(this._modal));return this._modal};a.title=function(a){if(a){var b;this._header||(this._header=y.create("header"),this.insert(this._header,this.firstChildElem()),this._header.ondragstart(this,d),this._header.ondragmove(this,c),this._header.ondragend(this,f),this._header.ondragcancel(this,f));b=this._header;this._title||(this._title=y.create(),b.append(this._title));this._title.html(a);this._title.css("display",null);b.addClass("oit-dialog-header-shaded");
r(this)}else null===a&&(this._title&&(this._title.destroy(),delete this._title),this._header&&(this._header.destroy(),delete this._header),r(this));return this._title?this._title.text():void 0};a.resetForm=function(){this._form.html("")};a.addLabel=function(a,b){var c=y.create("label",this._form);c.html(a);b&&b.style&&c.css(b.style);return c};a.addTextArea=function(a,b){a&&(this.addLabel(a),y.create("br",this._form));var c=new mc;this._form.append(c);b&&(b.style&&c.css(b.style),b.placeholder&&c.attr("placeholder",
b.placeholder));return c};a.show=function(a,b){!1!==a&&(a=!0);a&&(this._result=void 0);this.finishAnimation();if(this._visible==a)b&&(b.startFn&&b.startFn.call(b.context,this),b.endFn&&b.endFn.call(b.context,this));else{b=b||{};var c=0;!1!==b.animate&&(c=200);a?(this.startFn=b.startFn,this.startContext=b.context,this.animate({opacity:1,time:c,startCSS:{opacity:0,display:"block"},startFn:w,endFn:b.endFn,context:this}),this._visible=!0,this._modal&&Ba.showModalOverlay(!0,c)):(this.animate({opacity:0,
time:c,startFn:b.startFn,endCSS:{display:null},endFn:b.endFn,context:b.context}),this._visible=!1,this._modal&&Ba.showModalOverlay(!1,c))}return this._visible};var w=function(){r(this);this.startFn&&this.call(this.startContext,this);delete this.startFn;delete this.startContext};a.showFooter=function(a){!0!==a&&!1!==a||a===this._footerVisible||(this._footerVisible=!1!==a,r(this));return this._footerVisible};a.move=function(a,b,c,d,e){var f=v.viewNode,k=f.size(),f=f.pos();void 0===c&&(c=this.offsetWidth);
var h=k.width-10-10;c>h&&(c=h);void 0===d&&(d=this.offsetHeight);h=k.height-10-10;d>h&&(d=h);void 0!==a&&(h=f.left+k.width-10-c,a>h&&(a=h),a=M(a));void 0!==b&&(k=f.top+k.height-10-d,b>k&&(b=k),b=M(b));this._visible&&a!==this.offsetLeft||b!==this.offsetTop||c!==this.innerWidth||d!=this.innerHeight?(k=e&&!0===e.animate?200:0,e&&(this.moveOptions=e),this.css("overflow","hidden"),this.animate({offsetLeft:a,offsetTop:b,innerWidth:c,innerHeight:d,time:k,endCSS:{overflow:null},endFn:n,context:this})):e&&
e.endFn&&e.endFn.call(e.context,this)};var n=function(){r(this);var a=this.moveOptions;a&&a.endFn&&a.endFn.call(a.context,this);delete this.moveOptions};a.autoSize=function(a,b,c,d,e){(c=this.hasClass("oit-animating"))&&this.removeClass("oit-animating");var f=["width","height","display","opacity"];d=this.css(f);this.removeCSS(f);this.css("display","block");this.css("opacity","1");var f=this.offsetWidth,k=this.offsetHeight;this.css(d);c&&this.addClass("oit-animating");this.move(a,b,f,k,e)};a.maxsize=
function(a,b){var c={};void 0!=a&&(c["max-width"]=0===a?null:a+"px");void 0!=b&&(c["max-height"]=0===b?null:b+"px");this.css(c)};var l=function(a,b){a._visible||a.css("display","block");var c=a[b];a._visible||a.css("display",null);return c};a.width=function(){return l(this,"offsetWidth")};a.height=function(){return l(this,"offsetHeight")};var u=function(a,b){void 0===a._result&&(a._result=b,a._resultFn&&a._resultFn(a,b))};a.cancel=function(){u(this,!1)};a.ok=function(){u(this,!0)};a.no=function(){u(this,
0)};a.yes=function(){u(this,1)};a.result=function(){return this._result};E.onreset(function(){for(;0<b.length;)b.shift().destroy()});return e}();ob("TextRange",function(b,e){if(b>e){var a=b;b=e;e=a}this.type="text";this.acc=b;this.accend=e});ob("CellRange",function(b,e,a,d,c,f,k,t,r){var w;e>d&&(w=e,e=d,d=w);a>c&&(w=a,a=c,c=w);this.type="cell";this.page=b;this.section=A.page(b).section;this.c1=e;this.r1=a;this.c2=d;this.r2=c;void 0!==f&&(this.offsets="number"===typeof f?{left:f,top:k,right:t,bottom:r}:
{left:f.left,top:f.top,right:f.right,bottom:f.bottom})});ob("RectRange",function(b,e,a,d,c,f,k,t){var r;a>c&&(r=a,a=c,c=r);d>f&&(r=d,d=f,f=r);this.type="rect";void 0!==b&&(this.embedId=b);this.page=e;this.left=a;this.top=d;this.right=c;this.bottom=f;this.units=k;if(void 0!==t)this.section=t;else if(b=A.page(e))this.section=b.section});var Qb=function(){var b=function(a,b,e){S.call(this,"div",b);this._layer=a;this._visible=!0;e?e.append(this):a.append(this);y.attach(this);"none"===this.computedStyleProp("display")&&
(this._visible=!1);this.changed()},e=V(b,S);e.createChild=function(a){return new Ga(this,a)};e.layer=function(){return this._layer};e.moveToTop=function(){this.parent().append(this)};e.addClass=function(a){this.hasClass(a)||(S.prototype.addClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.removeClass=function(a){this.hasClass(a)&&(S.prototype.removeClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.defaultSize=function(){if(!this._defaultSize){var a=
["transform","display","width","height"],b=this.css(a);this.removeCSS(a);this._defaultSize={width:this.offsetWidth,height:this.offsetHeight};this.css(b)}return this._defaultSize};e.setDefaultSize=function(a){this._defaultSize=a};e.resetDefaultSize=function(){this._defaultSize&&(this._defaultSize=null)};e.setTitle=function(a){this.attr("title",a)};e.show=function(a){!1!==a&&(a=!0);a!==this._visible&&((this._visible=a)?(this.css("display","block"),this.changed()):this.css("display","none"));return this};
e.hide=function(){return this.show(!1)};e.visible=function(){return this._visible&&this._layer.visible()};e.layoutObject=function(){if(!this._animating&&this.visible()){var a=this.position();if(a){var b={};b.left=a.left;this._borderOffset&&(b.left-=this._borderOffset.left);b.left+="px";b.top=a.top;this._borderOffset&&(b.top-=this._borderOffset.top);b.top+="px";b.width=a.width+"px";b.height=a.height+"px";this.css(b);this._borderOffset||(this._borderOffset={left:this.clientLeft,top:this.clientTop},
this._borderOffset.left&&this.css("left",a.left-this._borderOffset.left+"px"),this._borderOffset.top&&this.css("top",a.top-this._borderOffset.top+"px"))}}return this};e.changed=function(){this._dirty||(this._dirty=!0,this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.childChanged=function(a){this._dirty||(this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.update=function(b){this._dirty&&(b=!0,this._dirty=
!1);b&&this.layoutObject();this.queryChildElements(a,b);return this};var a=function(a,b,e){a.update&&a.update(e)};return b}(),Ga=function(){var b=function(a,b){b=b||{};Qb.call(this,a.layer(),b.classList,a);this._parentObject=a;b.title&&this.setTitle(b.title);var c=b.margin||0;this._margin={left:c,top:c,right:c,bottom:c};void 0!==b.hpos&&(this._hpos=b.hpos);void 0!==b.vpos&&(this._vpos=b.vpos);!0===b.inheritMoveable&&(this.inheritMoveable=!0)},e=V(b,Qb);e.resize=function(a,b){void 0!==a||void 0!==
b?this._size&&this._size.width===a&&this._size.height===b||(this._size={width:a,height:b},this.changed()):this._size&&(delete this._size,this.changed());return this};e.setMargin=function(a,b,c,e){var d=!1;void 0!==a&&a!==this._margin.left&&(this._margin.left=a,d=!0);void 0!==b&&b!==this._margin.top&&(this._margin.top=b,d=!0);void 0!==c&&c!==this._margin.right&&(this._margin.right=c,d=!0);void 0!==e&&e!==this._margin.bottom&&(this._margin.bottom=e,d=!0);d&&(this._pos&&(this._pos=void 0),this.changed());
return this};e.position=function(){if(this._parentObject){var a=this._parentObject.position()||this._parentObject.defaultSize();if(this._pos&&a.width!=this._parentWidth||a.height!=this._parentHeight)this._pos=void 0;if(void 0===this._pos){this._parentWidth=a.width;this._parentHeight=a.height;var b,c,e,k;if("fill"===this._hpos)b=this._margin.left,e=a.width-this._margin.left-this._margin.right;else if(void 0!==this._hpos)if(e=this._size&&0<this._size.width?this._size.width:this.defaultSize().width,
"number"===typeof this._hpos)b=0<=this._hpos?this._margin.left+this._hpos:a.width-this._margin.right-e+this._hpos;else switch(this._hpos){case "left":b=this._margin.left;break;case "center":b=(a.width-e)/2;break;case "right":b=a.width-this._margin.right-e}if("fill"===this._vpos)c=this._margin.top,k=a.height-this._margin.top-this._margin.bottom;else if(void 0!==this._vpos)if(k=this._size&&0<this._size.height?this._size.height:this.defaultSize().height,"number"===typeof this._vpos)c=0<=this._vpos?this._margin.top+
this._vpos:a.height-this._margin.bottom-k+this._vpos;else switch(this._vpos){case "top":c=this._margin.top;break;case "middle":c=(a.height-k)/2;break;case "bottom":c=a.height-this._margin.bottom-k}void 0!==b||void 0!==c||void 0!==e||void 0!==k?(void 0===b&&(b=0),void 0===c&&(c=0),void 0===e&&(e=this.defaultSize().width),void 0===k&&(k=this.defaultSize().height),this._pos=new ja(b,c,b+e,c+k,"overlay")):this._pos=null}}return this._pos};return b}(),dd=function(){var b=function(a){Ga.call(this,a,{hpos:"center",
vpos:"middle",classList:"oit-highlight-label",inheritMoveable:!0})},e=V(b,Ga);e.destroy=function(){this._parentObject&&this._parentObject.attr("title",null);Ga.prototype.destroy.call(this)};e.setText=function(a){this._labelText=a=a||"";this.html(a);this.setTitle(a);this.resetDefaultSize();this.changed()};e.setColor=function(a,b){this.css("color",a)};e.setBoundingRect=function(a){a?this._parentRect=a.clone():delete this._parentRect;this.show()};e.position=function(){if(this._parentObject){var a=this._parentRect||
this._parentObject.position();this.css("transform",null);this.showLabelText=!0;this.html(this._labelText);var b="",c=this.defaultSize(),e=c.width+4,k=c.height+4,t=!1;if(e>a.width||k>a.height){if(e>k&&a.width<a.height||e<k&&a.width>a.height)c={width:c.height,height:c.width},e=c.width+4,k=c.height+4,b="rotate(270deg)",t=!0;if(e>a.width||k>a.height){var r=M(Math.min(a.width/e,a.height/k),1E3);.4>r?(b="",this.html(""),this.showLabelText=!1):(b+="scale("+r+","+r+")",e=c.width*r+4,k=c.height*r+4)}}this.css("transform",
b);if(this.showLabelText)return b=a.left+(a.width-e)/2,a=a.top+(a.height-k)/2,t&&(a+=k),e=b+e,k=a+k,this.show(),new ja(b,a,e,k,"overlay");this.hide()}};return b}(),ed=function(){var b=function(a){Ga.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation",inheritMoveable:!0})},e=V(b,Ga);e.setResizable=function(b){if(b){this._resizable||(this.addClass("oit-resize"),a(this,"oit-resize-n",!1,!0,!1,!1),a(this,"oit-resize-s",!1,!1,!1,!0),a(this,"oit-resize-e",!1,!1,!0,!1),a(this,"oit-resize-w",
!0,!1,!1,!1),a(this,"oit-resize-ne",!1,!0,!0,!1),a(this,"oit-resize-nw",!0,!0,!1,!1),a(this,"oit-resize-se",!1,!1,!0,!0),a(this,"oit-resize-sw",!0,!1,!1,!0));var c=b.margin||0;0>c&&this.setMargin(c,c,c,c);this._resizable=b}else this._resizable&&(this._resizeHandles&&(oa(this._resizeHandles,"destroy"),delete this._resizeHandles),delete this._resizable,this.removeClass("oit-resize"))};var a=function(a,b,d,e,l,u){b=y.create("div",b);b.ondragstart(a,c,d,e,l,u);b.ondragmove(a,f);b.ondragend(a,k);b.ondragcancel(a,
k);a.append(b);a._resizeHandles||(a._resizeHandles=[]);a._resizeHandles.push(b)},d=function(a,b,c){b=b._parentObject;b.dispatchCustom(a,{drawingRect:b,newRect:c.curRect,moved:c.resized})},c=function(a,b,c,e,f){a=this._parentObject.position();this.resizeInfo=b={left:b,top:c,right:e,bottom:f,startRect:a.clone(),curRect:a.clone(),resized:!1};d("resizestart",this,b);return!1},f=function(a){var b=this.resizeInfo;this.calculateResize(b,a);b.resized=!0;d("resizemove",this,b);if(!this._resizable.bindToObject){a=
this._parentObject.position();var c=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(c+b.curRect.left-a.left,c+b.curRect.top-a.top,c+a.right-b.curRect.right,c+a.bottom-b.curRect.bottom)}return!1},k=function(a){a=this.resizeInfo;if(!this._resizable.bindToObject){var b=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(b,b,b,b)}d("resizeend",this,a);delete this.resizeInfo;return!1};e.calculateResize=function(a,b){var c=b.delta.x,d=b.delta.y,
e=a.startRect.left,f=a.startRect.top,k=a.startRect.right,t=a.startRect.bottom;a.left?(e+=c,k-e<this._resizable.minWidth&&(e=k-this._resizable.minWidth)):a.right&&(k+=c,k-e<this._resizable.minWidth&&(k=e+this._resizable.minWidth));a.top?(f+=d,t-f<this._resizable.minHeight&&(f=t-this._resizable.minHeight)):a.bottom&&(t+=d,t-f<this._resizable.minHeight&&(t=f+this._resizable.minHeight));return e!=a.curRect.left||f!=a.curRect.top||k!=a.curRect.right||t!=a.curRect.bottom?(a.curRect.move(e,f,k,t),!0):!1};
return b}(),fd=function(){var b,e=function(a){Ga.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation"});this._range=ga(a._range);this._startHandle=d(this,c);this._endHandle=d(this,f)},a=V(e,Ga),d=function(a,b){var c=new Ga(a,{hpos:0,vpos:0,classList:"oit-text-handle"});c.append(y.create("div")).append(y.create("div")).ondragstart(a,b).ondragmove(a,t).ondragend(a,r).ondragcancel(a,r);return c};a.showHandles=function(a){a=!1!==a?null:"none";this._startHandle.css("display",a);this._endHandle.css("display",
a)};var c=function(a){var b=this._range;return k(this,this._startHandle,a,b.accend,b.acc)},f=function(a){var b=this._range;return k(this,this._endHandle,a,b.acc,b.accend)},k=function(a,b,c,d,e){a._anchor=d;a._focus=e;b=b.pos(v.viewNode);c=c.center;a._adjust={x:16-(c.x-b.left),y:-(c.y-b.top)};return!1},t=function(a){var b=a.center;if(b&&(a=this._parentObject,b=A.mapToPage(b.x+this._adjust.x,b.y+this._adjust.y,null,!0,!0))){if(void 0===this._textAnchorRoot){var c=b.page.findACC(a._range.acc);this._textAnchorRoot=
c?Ka(c[0]):null}if(c=b.page.mapPointToText(b.x,b.y,this._textAnchorRoot))c=c.acc,c!=this._focus&&(this._focus=c,this._focus>=this._anchor?(this._range.acc=this._anchor,this._range.accend=this._focus):(this._range.acc=this._focus,this._range.accend=this._anchor),this.changed(),a.setRange(this._range),a.dispatchCustom("textmove",{range:this._range,page:b.page}))}return!1},r=function(a){a=this._parentObject;a.setRange(this._range);a.dispatchCustom("textmoveend",{range:this._range});delete this._anchor;
delete this._focus;delete this._adjust;return!1};a.layoutObject=function(){if(this.visible()){var a=this._parentObject;Ga.prototype.layoutObject.call(this);b||(b=this._startHandle.defaultSize());var c=this._parentObject.position();if(c){this.show();var d=w(this._startHandle,c,a.startHandleRect()),c=w(this._endHandle,c,a.endHandleRect());d||c||(d=A.pagesForRange(a._range),this.show(d&&-1!=d.indexOf(a._page)))}else this.hide()}};var w=function(a,c,d){d?(a.setMargin(d.left-c.left-b.width/2,d.bottom-
c.top-1),a.resize(b.width,b.height),a.show()):a.hide();return d};return e}(),Va=function(){var b=function(a,b,d){Qb.call(this,b,d);this._pos=new ja(0,0,0,0,"overlay")},e=V(b,Qb);e.setLabel=function(a,b,d){if(a){if(d=d||"#FFF",a!==this._labelText||b!=this._labelColor||d!=this._backgroundColor)if(this._labelText=a,this._labelColor=b||"#000",this._labelBackground=d||"#FFF",this.setTitle(this._labelText),this._labels)for(a=0;a<this._labels.length;a++)b=this._labels[a],b.setText(this._labelText),b.setColor(this._labelColor,
this._labelBackground)}else this._labelText&&(delete this._labelText,delete this._labelColor,delete this._labelBackground,this.setTitle(""),this._labels&&(oa(this._labels,"destroy"),delete this._labels));this.changed()};e.allocateLabelChildren=function(a){this._labels||(this._labels=[]);for(;this._labels.length<a;){var b=new dd(this);this._labels.push(b);b.setText(this._labelText);b.setColor(this._labelColor,this._labelBackground)}for(;this._labels.length>a;)this._labels.pop().destroy();return this._labels};
e.labelChildCount=function(){return this._labels?this._labels.length:0};e.getLabelChild=function(a){if(this._labels)return this._labels[a]};e.move=function(b,e,k,t,r){this._pos.movesize(b,e,k,t)&&(this.changed(),this.finishAnimation(),r&&(b=this.position(),r.stepFn&&(this.stepMoveFn=r.stepFn),r.endFn&&(this.endMoveFn=r.endFn),r={offsetLeft:b.left,offsetTop:b.top,innerWidth:b.width,innerHeight:b.height,transition:r.transition||"ease",time:r.timems,startFn:r.startFn,stepFn:a,endFn:d,context:this},this._animating=
!0,this.animate(r)));return this};var a=function(a){this.update(!0);this.stepMoveFn&&this.stepMoveFn(this)},d=function(a){delete this._animating;this.changed();this.endMoveFn&&this.endMoveFn(this);delete this.stepMoveFn;delete this.endMoveFn};e.resize=function(a,b){return this.move(void 0,void 0,a,b)};e.position=function(){return this._pos};return b}(),ub=function(){var b=function(a,b,c){Va.call(this,a,b,c)},e=V(b,Va);e.customEvent("resizestart");e.customEvent("resizemove");e.customEvent("resizeend");
e.activate=function(a,b){this._rectActivation||(this._rectActivation=new ed(this),b&&this.insertFirst(this._rectActivation),this._resizable&&this._rectActivation.setResizable(this._resizable));this.moveToTop();return this};e.deactivate=function(){this._rectActivation&&(this._rectActivation.destroy(),delete this._rectActivation);return this};e.resizable=function(a,b){if(!0===a){b=b||{};var c=!0,d=b.minWidth||0,e=b.minHeight||0,t=b.margin||0;!1===b.bindToObject&&(c=!1);this._resizable&&this._resizable.bindToObject==
c&&this._resizable.onResizeStart==b.onResizeStart&&this._resizable.onResize==b.onResize&&this._resizable.onResizeEnd==b.onResizeEnd&&this._resizable.onResizeCancel==b.onResizeCancel&&this._resizable.context===b.context&&this._resizable.minWidth==d&&this._resizable.minHeight==e&&this._resizable.margin==t||(this._resizable={bindToObject:c,minWidth:d,minHeight:e,margin:t},b.onResizeStart&&(this._resizable.onResizeStart=b.onResizeStart),b.onResize&&(this._resizable.onResize=b.onResize),b.onResizeEnd&&
(this._resizable.onResizeEnd=b.onResizeEnd),b.onResizeCancel&&(this._resizable.onResizeCancel=b.onResizeCancel),this._resizable.context=b.context||this,this._rectActivation&&this._rectActivation.setResizable(this._resizable))}else this._resizable&&!1===a&&(delete this._resizable,this._rectActivation&&this._rectActivation.setResizable(null));return this};e.layoutObject=function(){if(this.visible()&&!this._animating&&(Va.prototype.layoutObject.call(this),this._labelText)){var a=this.position().clone();
a.left=0;a.top=0;this.allocateLabelChildren(1)[0].setBoundingRect(a)}return this};return b}(),gd=function(){var b=function(a,b,c){Va.call(this,a,b,c);a=this.defaultSize();this.move(void 0,void 0,a.width,a.height)},e=V(b,Va);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return b}(),hd=function(){var b=function(a,b,c,e){var d=["oit-badge"];c&&d.push(c);Va.call(this,a,b,d);this.resize(20,20);this.text(e)},
e=V(b,Va);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return b}(),id=function(){var b=function(a,b,e){Va.call(this,a,b,e);this._page=A.page(a)},e=V(b,Va);e.customEvent("textmove");e.customEvent("textmoveend");e.activate=function(a){this._textActivation||(this._textActivation=new fd(this));this._textActivation.showHandles(this._showHandles);this.moveToTop();return this};e.deactivate=function(){this._textActivation&&
(this._textActivation.destroy(),delete this._textActivation);return this};e.setRange=function(a){if(a&&"text"===a.type)if(!this._range)this._range=ga(a),this.changed();else if(this._range.acc!=a.acc||this._range.accend!==a.accend)this._range.acc=a.acc,this._range.accend=a.accend,this.changed();return this};e.showTextHandles=function(){this._showHandles=!0;this._textActivation&&this._textActivation.showHandles(!0);return this};e.hideTextHandles=function(){this._showHandles=!1;this._textActivation&&
this._textActivation.showHandles(!1);return this};e.layoutObject=function(){if(this.visible()&&!this._animating){var a=this._page.textBoundingRect(this._range);a&&(a.origin="overlay",this.move(a.left,a.top,a.width,a.height));Va.prototype.layoutObject.call(this);if(this._labelText){var b=this._page.textRects(this._range,"overlay"),a=this._page.textBoundingRect(this._range);if(b&&a&&(a.origin="overlay",this.allocateLabelChildren(b.length),0<this._labels.length))for(var e=this.getLabelChild(0).defaultSize(),
k=0;k<this._labels.length;k++){var t=this.getLabelChild(k);t.setDefaultSize(e);this._moveable?t.addClass("oit-moveable"):t.removeClass("oit-moveable");var r=b[k].interiorRect(e,!0);r&&r.offset(-a.left,-a.top);t.setBoundingRect(r)}}}return this};var a=function(a,b,e){var c=a._page.accRect(b,"overlay");if(!c)for(var d=0<e?1:-1,f=d;!(c=a._page.accRect(b+f,"overlay"))&&f!=e;f+=d);c&&(c.width=0);return c};e.startHandleRect=function(){if(this._range)return a(this,this._range.acc,1)};e.endHandleRect=function(){if(this._range)return a(this,
this._range.accend,-2)};return b}(),jd=function(){var b=function(a,b,e){S.call(this,"div","oit-drawinglayer oit-drawinglayer-"+b,e);this._drawing=a;this._name=b;this._visible=!0;y.attach(this);a.append(this);this.show()},e=V(b,S);e.drawing=function(){return this._drawing};e.show=function(a,b){void 0===a&&(a=!0);a!==this._visible&&(!0===a?(this._visible=!0,this.css("display",null),!1!==b&&this.update(!0)):!1===a&&(this._visible=!1,this.css("display","none")))};e.hide=function(){this.show(!1)};e.visible=
function(){return this._visible};e.update=function(b){this.queryChildElements(a,b)};var a=function(a,b,e){a.update&&a.update(e)};e.changed=function(){this._drawing.changed()};return b}(),Wc=function(){var b=function(a){S.call(this,"div","oit-drawingpanel");y.attach(this);this._origin=null;a.append(this);a.onscroll(this,this.updateScroll)},e=V(b,S);e.destroy=function(){var a=this.parent();a&&a.offscroll(this.updateScroll);S.prototype.destroy.call(this)};e.update=function(b){!0!==b&&(b=!1);this._animationFrame&&
(this._animationFrame=null);this.queryChildElements(a,b)};var a=function(a,b,e){a.update&&a.update(e)};e.changed=function(){this._animationFrame||(this._animationFrame=kb(this.update,this))};e.setOrigin=function(a,b){if(!this._origin)this._origin={x:a,y:b},this.updateScroll();else if(this._origin.x!=a||this._origin.y!=b)this._origin.x=a,this._origin.y=b,this.updateScroll()};e.resetOrigin=function(){this._origin&&(this._origin=null,this.css({left:null,top:null}))};e.updateScroll=function(){if(this._origin){var a=
this.parent().scroll();this.css({left:this._origin.x+a.left+"px",top:this._origin.y+a.top+"px"})}};return b}(),nb=function(){var b=function(a,b,d){S.call(this,a);this.acc=b;this.accend=d;void 0===this.accend&&(a=y.data(this,"accend"))&&(this.accend=Number(a));void 0===this.accend&&(this.accend=b+this.text().length)},e=V(b,S);e.destroy=function(){this.unload();S.prototype.destroy.call(this)};e.unload=function(){d(this,null,null)};e.text=function(a){if(void 0!==a){var b=this._anchor||this;b.destroyChildren();
b.dom.textContent=a}return this.dom.textContent};e.textNode=function(){return(this._anchor||this).dom.firstChild};e.createSplit=function(a){var c=new b("span",this.acc,a);this.copyDataTo(c);var d=this.text(),e=a-this.acc;c.text(d.substring(0,e));this.text(d.substring(e));this.acc=a;this._changed=!0;return c};e.mergeSplit=function(a){var b=this.text()+a.text();this.text(b);this.accend=a.accend;this._changed=!0;a.destroy()};e.dataEquals=function(a){var b=!1,c=this._data;a=a._data;if(!c)b=!a;else if(a&&
c.length==a.length)for(var b=!0,d=0;d<c.length;d++){var e=c[d],w=a[d];if(e.type!==w.type||e.id!==w.id){b=!1;break}}return b};e.addData=function(a){this._data||(this._data=[]);"hyperlink"===a.type?this._data.unshift(a):this._data.push(a);this._changed=!0};e.changeData=function(a){if(this._data)for(var b=0;b<this._data.length;b++){var c=this._data[b];if(c.type===a.type&&c.id===a.id){this._data[b]=a;this._changed=!0;break}}};e.removeData=function(a,b){if(this._data)for(var c=0;c<this._data.length;c++){var d=
this._data[c];if(d.type===a&&d.id===b){this._data.splice(c,1);0===this._data.length&&delete this._data;this._changed=!0;break}}};e.copyDataTo=function(a){this._data&&(a._data=a._data?a._data.concat(this._data):this._data.slice(0),a._changed=!0)};e.moveDataTo=function(b){this._data&&(a(this,null,null,null,null),b._data=b._data?b._data.concat(this._data):this._data,delete this._data,this._changed=!0,b._changed=!0)};e.updateData=function(){if(this._changed){var b=null,d=null,e=null,t=null,r=void 0;if(this._data)for(var w=
0,n=0;n<this._data.length;n++){var l=this._data[n];if("style"===l.type){if(l.className&&(t||(t=[]),t.push(l.className)),l.props)for(var u in l.props)if(l.props.hasOwnProperty(u)){var p=l.props[u];if("background-color"==u){var v=l.priority||0;void 0===r||v>r?(r=v,w=1,e||(e={}),e[u]=p):v==r&&(e[u]=$b(p,e[u],w,!0),w++)}else e||(e={}),e[u]=p}}else"hyperlink"===l.type?b=l:"bookmark"===l.type&&(d=l)}a(this,e,t,b,d);this._changed=!1}};var a=function(a,b,e,t,r){b?(b=Kc(b),b!=a._splitClass&&(a._splitClass&&
a.removeClass(a._splitClass),a.addClass(b),a._splitClass=b)):a._splitClass&&(a.removeClass(a._splitClass),delete a._splitClass);a._appliedClasses&&(a.removeClass(a._appliedClasses),delete a._appliedClasses);e&&(a.addClass(e),a._appliedClasses=e);d(a,t,r)},d=function(a,b,d){var c=a._anchor;if(b){var e=b&&0===b.url.indexOf("#");c||(c=e?a._anchor=y.create("span"):a._anchor=y.create("a"),c.text(a.text()),a.html(""),a.append(c));b&&(a.addClass("oit-hyperlink"),e||c.attr("href",b.url),Ic.on.addElement(c,
b));d&&c.attr("id",d.id)}else d?a.attr("id",d.id):c&&(Ic.on.removeElement(c),b=c.text(),c.destroy(),delete a._anchor,a.removeClass("oit-hyperlink"),a.html(b))};return b}(),kd=function(){var b=RegExp("^[^\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]*?[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]"),e=function(a,b,c){nb.call(this,a,b);this._origin=c},a=V(e,nb);a.unload=function(){this.discardLayout();oa(this._splits,"unload");nb.prototype.unload.call(this)};a.discardLayout=
function(){delete this._charRects;delete this._spanRect};a.distanceFromPoint=function(a,b){var c=this.findClosestChar(a,b);if(c)return c.distance};a.overlapRange=function(a){var b=this.spanRect();if(b.overlaps(a)){if(a.contains(b))return ka(this.acc,this.accend);if(b=f(this)){for(var c,d,e=0;e<b.length;e++)a.overlaps(b[e])&&(d=this.acc+e,void 0===c&&(c=d),d+=1);if(void 0!==c)return ka(c,d)}}};a.spanRect=function(){var a=this._spanRect;a||(a=A.elementRect(this,this._origin),0<a.width&&0<a.height&&
(this._spanRect=a));return a};a.textAngle=function(){void 0===this._angle&&(this._angle=this.ancestorData("angle"),this._angle=void 0!==this._angle?Number(this._angle)*Math.PI/180:0);return this._angle};a.rtl=function(){void 0===this._rtl&&(this._rtl=!!b.test(this.text()));return this._rtl};a.findClosestChar=function(a,b){var c=f(this),d,e,k;for(d=0;d<c.length;d++){var u=Math.abs(c[d].distanceFrom(a,b,"left","middle"));if(void 0===e||u<k)e=d,k=u,d==c.length-1&&(u=c[d].distanceFrom(a,b,"center","none"),
0<u&&e++)}var p,t;if(this._splits){c=this._splits;for(d=u=0;d<c.length;d++){var W=c[d].textNode(),T=u+W.textContent.length;if(e>=u&&e<T){p=W;t=e-u;break}u=T}p||(p=c[c.length-1].textNode(),t=p.textContent.length)}else p=this.textNode(),t=e;return{node:p,offset:t,acc:this.acc+e,distance:k}};a.textRect=function(a){var b=this.spanRect();if(this.hasClass("oit-hiddentext"))return new ja(b);if(0===b.width||0===b.height)return null;if(!a||a.acc<=this.acc&&a.accend>=this.accend)return new ja(b);if(a.acc<this.accend&&
a.accend>this.acc){var c=this.text(),b=a.acc-this.acc;0>b&&(b=0);a=a.accend-this.acc;a>c.length&&(a=c.length);if(c=f(this,b,a)){var d;d=new ja(c[b],this._origin);a==b&&(d.width=0);for(b+=1;b<a;b++)d.union(c[b]);return d}}};a.findTextRange=function(a,b){var c,d,e,f,k=this._splits;if(k){if(a.acc<=this.acc&&(c=k[0].textNode(),d=0),a.accend>=this.accend&&(e=k[k.length-1].textNode(),f=e.textContent.length),!c||!e)for(var p=0;p<k.length;p++){var t=k[p];if(a.accend<t.acc)break;if(!c&&a.acc<t.accend&&(c=
t.textNode(),d=a.acc-t.acc,0>d&&(d=0),e))break;if(c&&!e&&a.accend<=t.accend){e=t.textNode();f=a.accend-t.acc;0>f&&(f=0);break}}}else c=e=this.textNode(),d=0,a.acc>this.acc&&(d+=a.acc-this.acc),f=this.text().length,a.accend<this.accend&&(f-=this.accend-a.accend);k=X.createRange();k.setStart(c,d);k.setEnd(e,f);b.push(k)};var d=function(a,b,c,d){c._charRects.push(new ja(a.rect(d),d))},c=function(a,b,d,e,f,l,u,p,v){var k;a=y.unwrap(a);if(3==a.nodeType){if(k=a.textContent.length,b<=v&&b+k>=p)for(p-=b,
0>p&&(p=0),v-=b,v>k&&(v=k),k=p;k<v;k++)u[k+b]||(l.setStart(a,k),l.setEnd(a,k+1),p=l.getBoundingClientRect(),p=new ja(p.left-f.left,p.top-f.top,p.right-f.left,p.bottom-f.top,e),p.origin=d._origin,u[k+b]=p)}else for(k=0;k<a.childNodes.length&&b<=v;k++){var n=a.childNodes[k],t=b+n.textContent.length;p<=t&&b<=v&&c(n,b,d,e,f,l,u,p,v);b=t}},f=function(a,b,e){b||(b=0);e||(e=a.text().length);var f=X.createRange?X.createRange():null;if(f&&f.getBoundingClientRect)try{var k,l;a._origin instanceof S&&!(a._origin instanceof
cb)?(k=a._origin,l=k.rect()):(k="view",l=v.viewNode.rect());var u=a._charRects||[];c(a,0,a,k,l,f,u,b,e);a._charRects=u}catch(p){}else if(!a._charRects){f=a.text();e=new S;e.transferFrom(a);k=[];for(b=0;b<f.length;b++)k.push("<span>"),k.push(f[b]),b+1<f.length&&(l=f.charCodeAt(b),u=f.charCodeAt(b+1),1536<=l&&1791>=l&&1536<=u&&1791>=u&&k.push("&zwj;")),k.push("</span>");a.html(k.join(""));a._charRects=[];a.forChildElements(d,a,a._origin);b=new ja(a.rect(a._origin),a._origin);a.html("");a.transferFrom(e);
f=a.spanRect();if(f.width!=b.width&&(e=f.width/b.width,!ac(e,1)))for(f=f.left,b=0;b<a._charRects.length;b++)k=a._charRects[b],l=(k.left-f)*e+f,k.move(l,void 0,l+k.width*e,void 0)}return a._charRects};a.createSplit=function(){var a=new nb("span",this.acc,this.accend);this.moveDataTo(a);a.transferFrom(this);return a};a.updateData=function(){var a=this._splits;a?oa(a,"updateData"):nb.prototype.updateData.call(this)};a.split=function(a){if(!a)return this._splits;if(!this._splits){if(a.acc<=this.acc&&
a.accend>=this.accend||this.hasClass("oit-hiddentext"))return[this];var b=this.createSplit();this.append(b);this._splits=[b]}for(var b=this._splits,c=[],d=0;d<b.length;d++){var e=b[d],f;if(!(a.acc>=e.accend)){if(a.accend<=e.acc)break;a.acc>e.acc&&(f=e.createSplit(a.acc),b.splice(d++,0,f),this.insert(f,e));a.accend<e.accend&&(f=e.createSplit(a.accend),b.splice(d++,0,f),this.insert(f,e),e=f);c.push(e)}}return c};a.join=function(){var a=this._splits;if(a){for(var b,c=a[a.length-1],d=a.length-2;0<=d;d--)b=
a[d],b.dataEquals(c)&&(b.mergeSplit(c),a.splice(d+1,1)),c=b;1==a.length&&(b=a[0],b.moveDataTo(this),this.text(b.text()),b.destroy(),delete this._splits)}};a.addDataToRange=function(a,b){var c=this.split(a);c&&(oa(c,"addData",null,b),this.join(),this.updateData(),"hyperlink"===b.type&&f(this))};a.changeData=function(a){nb.prototype.changeData.call(this,a);oa(this._splits,"changeData",null,a);this.updateData()};a.removeData=function(a,b){nb.prototype.removeData.call(this,a,b);oa(this._splits,"removeData",
null,a,b);this.join();this.updateData()};return e}(),Mc=function(){var b=function(a,b){this._page=a;this._contentRoot=b||a;this._spans=[];if(1024<this._contentRoot.text().length)for(var c=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),d=c.firstACCNode();d;){for(var e=c.currentNode,t=!0,d=e.firstChild;d;d=d.nextSibling)if(3!==d.nodeType){t=!1;break}if(t&&1024<e.textContent.length){(d=c.skipNode())&&(d=c.firstACCNode());for(var t=e.textContent,r=[],w=0;w<t.length;w+=1024){var n=t.substring(w,
w+1024),n=Ab(n);r.push("<span>",n,"</span>")}e.innerHTML=r.join("");e.textContent.length!=t.length&&(e.textContent=t)}else d=c.nextACCNode()}for(var l,c=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),d=c.firstACCNode();d;){e=c.currentNode;(d=y.data(e,"acc"))&&(l=Number(d));t=!0;for(d=e.firstChild;d;d=d.nextSibling)if(3==d.nodeType){t=!1;break}t||void 0===l?d=c.nextACCNode():(e=new kd(e,l,this._contentRoot),this._spans.push(e),l=e.accend,(d=c.skipNode())&&(d=c.firstACCNode()))}this._layoutSettings=
{};if(!a.checkedACCRange){if(c=this.getTextRange())c.acc<a.acc&&(a.acc=c.acc),c.accend>a.accend&&(a.accend=c.accend);a.checkedACCRange=!0}},e=V(b);e.destroy=function(){oa(this._spans,"unload");this.deleteAll()};e.discardLayout=function(){oa(this._spans,"discardLayout")};e.getTextRange=function(){for(var a,b=0;b<this._spans.length;b++){var c=this._spans[b];a?(c.acc<a.acc&&(a.acc=c.acc),c.accend>a.accend&&(a.accend=c.accend)):a=ka(c.acc,c.accend)}return a};e.textRanges=function(){for(var a=[],b,c=this._page.isEmailHeader(),
e=0;e<this._spans.length;e++){var k=this._spans[e];!c&&b&&b.accend+1>=k.acc?k.accend>b.accend&&(b.accend=k.accend):(b=ka(k.acc,k.accend),a.push(b))}return a};e.mapPointToSpan=function(a,b,c){if(0<this._spans.length){var d,e,t,r;this._page.pushShow();var w=[],n;for(r=0;r<this._spans.length;r++)if(t=this._spans[r],!t.hasClass("oit-hiddentext")&&(!c||t.equals(c)||t.isDescendantOf(c))&&(e=t.spanRect())&&0<e.width&&0<e.height){e=b<e.top?e.top-b:b>e.bottom?b-e.bottom:0;if(void 0===n||e<n)w.length=0,n=e;
e==n&&w.push(t)}n=void 0;if(1==w.length)d=w[0];else for(r=0;r<w.length;r++)if(t=w[r],e=Math.abs(t.distanceFromPoint(a,b)),void 0===n||e<n)d=t,n=e;this._page.popShow();return d}};e.findOverlappingText=function(a){if(0<this._spans.length){var b=[];this._page.pushShow();for(var c=0;c<this._spans.length;c++){var e=this._spans[c].overlapRange(a);e&&b.push(e)}this._page.popShow();if(0<b.length)return b}};e.findRange=function(a,b){for(var c=[],d=0;d<this._spans.length;d++){var e=this._spans[d];e.acc<=b&&
e.accend>a&&c.push(e)}if(0<c.length)return c};e.findACC=function(a){for(var b=[],c=0;c<this._spans.length;c++){var e=this._spans[c];a>=e.acc&&a<e.accend&&b.push(e)}if(0<b.length)return b};return b}(),cb=function(){var b=/\S/,e=function(a,b,c){var d=X.getElementById(c);d?S.call(this,d):S.call(this,"div","oit-section oit-"+b+" oit-pending",c);this.prop("index",a);this.data("page",this);this._needArrange=!0;this._staticContent=!!this.firstChildElem()},a=V(e,S);a.processData=function(a){var b=this.isEmailHeader(),
c={},e=!1,g=!1,h;for(h in a){var f=a[h],k=null,z=!1;switch(h){case "embeds":case "frames":case "fields":case "attachments":case "comments":k="_"+h;break;case "data":case "src":k="_"+h+"URL";break;case "section":case "name":case "type":case "dpi":case "autodpi":case "hiddenFromSlideshow":k=h;break;case "acc":case "accend":k=h;z=!0;break;case "w":b||this.css("width",f);k="width";f=parseInt(f,10);z=!0;break;case "h":b||this.css("height",f);k="height";f=parseInt(f,10);z=!0;break;case "oid":(f=A.overlayById(a.oid))&&
f!==this.overlay&&(k="overlay",g=!0);break;case "background":this.css("background",f)}k&&!this.hasOwnProperty(k)&&(c[k]={value:f,writable:z,enumerable:!1},e=!0)}"sn"!==this.type||this.width||(b=A.page(this.index-1))&&b.width&&(c.width={value:b.width,writable:!1,enumerable:!1},e=!0,this.css("width",b.css("width")),F.layoutChanged());e&&Object.defineProperties(this,c);g&&this.overlay.add(this);a.content&&!this.isLoaded()&&(!0===this.deferContent?this.deferredContent=a.content:d(this,a.content));!this._ssmodel&&
a.ssdata&&(this._ssmodel=new ld(a.ssdata,this._embeds,this));if(a.comments){if(this.supportsAnnotations()){e=c=!1;la.infoRaw();for(g=0;g<a.comments.length;g++)b=a.comments[g],b.range&&b.text?c=!0:e=!0;c&&E.hiddenContent("comments");e&&E.hiddenContent("comments-unsupported")}else E.hiddenContent("comments-unsupported");this.overlay.hasAnnotations(!0)}"sn"===a.type&&E.hiddenContent("speaker-notes");a.hiddenFromSlideshow&&E.hiddenContent("hidden-slides");a.hidden_columns&&E.hiddenContent("hidden-columns");
a.hidden_rows&&E.hiddenContent("hidden-rows");this._staticContent&&(w(this,!1),W(this))};a.supportsAnnotations=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":case "worksheet":case "database":return!0}return!1};a.supportsAnnotationPane=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":return!0}return!1};a.supportsAnnotationBar=function(){switch(this.type){case "worksheet":case "database":return!0}return!1};
var d=function(a,b){var c=y.create("div");c.html(b);var d=c.byClass("oit-view");if(d&&0<d.length)for(c=0;c<d.length;c++){var e=d[c].byClass("oit-section");if(e)for(var g=0;g<e.length;g++){var h=e[g],m=A.pageById(h.id);m&&!m.firstChildElem()&&(v.baseURL&&n(h),m.transferFrom(h),m.addClass(h.attr("class")))}}else v.baseURL&&n(c),a.transferFrom(c),a._needArrange=!0};a.destroy=function(){this.unload();S.prototype.destroy.call(this)};a.unload=function(){var a=this.isLoaded();this.abortLoad();this._needArrange=
!0;this._selRect&&(this._selRect.destroy(),delete this._selRect);this._ssmodel&&(this._ssmodel.unload(),delete this._ssmodel);this._spanMap&&(this._spanMap.destroy(),delete this._spanMap);this._annotationPane&&(this._annotationPane.destroy(),delete this._annotationPane);0<this.loadedSize&&(this.pageContentChanged(),this.html(""),this.addClass("oit-pending"),this.loadedSize=0);this.logUnload&&this.logUnload();a&&A.on.pageunload.dispatch(this)};a.show=function(a){var b;if(this.isHidden()){a=a||{};this.finishAnimation();
a.animate&&this.css("opacity",0);if(!this.parent()){var c;if(!a.insertLast)for(var d=this.index+1;;d++){b=A.page(d);if(!b||b.overlay!==this.overlay)break;if(!b.isHidden()){c=b;break}}c?this.overlay.insert(this,c):this.overlay.append(this);this._annotationPane&&this._annotationPane.show()}a.animate?(void 0===a.time&&(a.time=a.animate?150:0),a.opacity=1,this.animate(a)):a&&a.endFn&&a.endFn();"vertical"===x.scrollMode&&(b=A.page(this.index+1))&&"sn"===b.type&&x.showSlideNotes&&b.show()}else a&&a.endFn&&
a.endFn();return this};a.hide=function(){var a=y.unwrap(this).parentNode;a&&(this.finishAnimation(),a.removeChild(this.dom),this._annotationPane&&this._annotationPane.hide(),"vertical"===x.scrollMode&&(a=A.page(this.index+1))&&"sn"===a.type&&a.hide());return this};a.pushShow=function(){this._showState?this._showState.count++:(this._showState={count:1},this.parent()||(this._showState.pageHidden=!0,this.show(),this._annotationPane&&this._annotationPane.show()),this.overlay.isDisplayed()||(this._showState.overlayUndisplayed=
!0,this.overlay.display()),this.overlay.isHidden()&&(this._showState.overlayHidden=!0,this.overlay.show()),"none"===this.computedStyle().display&&(this._showState.pageDisplayNone=!0,this.css("display","block")))};a.popShow=function(){this._showState&&(this._showState.count--,0>=this._showState.count&&(this._showState.pageDisplayNone&&this.css("display",null),this._showState.overlayHidden&&this.overlay.hide(),this._showState.overlayUndisplayed&&this.overlay.undisplay(),this._showState.pageHidden&&
(this.hide(),this._annotationPane&&this._annotationPane.hide()),delete this._showState))};a.isHidden=function(){return this._hidden||!this.parent()||!this.overlay||this.overlay.isHidden()||!this.overlay.isDisplayed()};a.filter=function(a){return a!==this.index};a.info=function(){var a={page:this.index,type:this.type,typeEx:this.type,features:Ea.features(this.type),comments:!!this._annotationPane};if("slide"==a.type){var b=A.page(this.index+1);b&&"sn"===b.type?a.notes=!0:y.byId(this.id+".note")?a.notes=
!0:a.notes=!1}else"rt"==a.type?(0<this.index&&"email"==A.page(this.index-1).type&&(a.type="email"),"rt"==a.type&&(a.type="html")):"sn"==a.type&&(a.type="slide",a.notes=!0);void 0!=this.hiddenFromSlideshow&&(a.hiddenFromSlideshow=this.hiddenFromSlideshow);void 0!==this.acc&&(a.acc=this.acc,void 0!==this.accend&&(a.accend=this.accend));this.width&&this.height&&(a.width=this.width,a.height=this.height);return a};a.features=function(){return Ea.features(this.type)};a.isEmailHeader=function(){return this.hasClass("oit-emailheaderpage")||
"emailheader"===this.id||"emailheader.1"===this.id};a.isPending=function(){return this.hasClass("oit-pending")};a.isLoading=function(){return this.hasClass("oit-loading")};a.isLoaded=function(){return!this.hasClass("oit-pending")&&!this.hasClass("oit-loading")};a.isEnabled=function(){return"slideshow"!=x.presentationMode?!0:"slide"!=this.type||!this.hiddenFromSlideshow};a.mapPointToText=function(a,b,c,d){var e;d?e=this.annotationPane().mapPointToSpan(a,b,c):(d=this.getSpanMap())&&(e=d.mapPointToSpan(a,
b,c));if(e){var g=e.textAngle();c=e.spanRect();d=c.left;var h=c.top,m=c.right,f=c.bottom;if(0!==g){c=[{x:d,y:h},{x:m,y:h},{x:m,y:f},{x:d,y:f}];d=Math.cos(g);h=Math.sin(g);for(m=0;m<c.length;m++)f=c[m].x-a,g=c[m].y-b,c[m].x=a+f*d+g*h,c[m].y=b+-f*h+g*d;d=m=c[0].x;h=f=c[0].y;for(g=1;4>g;g++){var k=c[g];k.x<d?d=k.x:k.x>m&&(m=k.x);k.y<h?h=k.y:k.y>f&&(f=k.y)}}e=e.findClosestChar(a,b);e.overlaps=a>=d-2&&a<=m+2&&b>=h-2&&b<=f+2;return e}};a.findTextBoundary=function(a,b,c){a=Bb(a);if(na&&void 0!==a&&(a+=b,
b=na.findBoundaryStart(a,c),c=na.findBoundaryEnd(b,c),void 0!==b&&void 0!==c)){c=ka(b,c);if(this._frames){var d,e;for(b=0;b<this._frames.length;b++){var g=this._frames[b];a>=g.acc&&a<g.accend&&(void 0===d?(d=g.acc,e=g.accend):(g.acc<d&&(d=g.acc),g.accend>e&&(e=g.accend)))}c.acc<d&&(c.acc=d);c.accend>e&&(c.accend=e)}if(d=this.findTextRange(c))return fc(d)}};a.resetCache=function(){delete this._cachedRects;if(this._annotationPane)this._annotationPane.onResize(!0)};var c=function(a){var b=a._cachedRects;
b||(b=a._cachedRects={});var c=v.viewNode,d=c.clientWidth,e=c.clientHeight,g=c.scroll(),c=g.left,g=g.top,h=a.offsetLeft;a=a.offsetTop;var f=x.zoom,k=x.rotation;if(b.viewWidth!=d||b.viewHeight!=e||b.scrollLeft!=c||b.scrollTop!=g||b.offsetLeft!=h||b.offsetTop!=a||b.zoom!=f||b.rotation!=k)b.view=null,b.overlay=null,b.pos=null,b.viewWidth=d,b.viewHeight=e,b.scrollLeft=c,b.scrollTop=g,b.offsetLeft=h,b.offsetTop=a,b.zoom=f,b.rotation=k;return b};a.pageRect=function(a){var b=c(this);if("view"===a||"overlay"===
a){var d=b[a];d||((d=F.pageRect(this.index,a))&&d.readonly(!0),b[a]=d);return d}b.page||(b.page=F.pageRect(this.index,this));return b.page};a.pagePos=function(a){if("overlay"===a)return a=c(this),a.pos||(a.pos=this.pos(this.overlay)),a.pos;if("view"===a){a=this.pagePos("overlay");a={left:a.left,top:a.top};var b=F.padding();b&&(a.left+=b.left,a.top+=b.top);if(b=F.scrollOffset())a.left-=b.left,a.top-=b.top;return a}};a.inAnnotation=function(a){var b=!1;if("text"===a.type&&!this.findRange(a.acc,a.accend,
"page")){var c;this._annotationPane&&(c=this._annotationPane.findRange(a.acc,a.accend));if(c)b=!0;else if(this._comments)for(c=0;c<this._comments.length;c++){var d=this._comments[c];if(d.text){for(var e=0;e<d.text.length;e++){var g=d.text[e].range;if(g&&fb(a,g)){b=!0;break}}if(b)break}}}return b};a.containsRange=function(a){if("text"!==a.type)return a.page==this.index;var b=!1,c;if(a.acc<=this.accend&&a.accend>=this.acc){switch(this.type){case "worksheet":case "database":(b=this.spreadsheetModel())&&
!b.hasPendingContent()?(b=b.containsRange(a.acc,a.accend),b||(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)))):b=!0;break;default:if(this._frames)for(c=0;c<this._frames.length;c++){var d=this._frames[c];if(a.acc<=d.accend&&a.accend>=d.acc){b=!0;break}}!b&&this.isLoaded()&&(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)));b||this._frames||this.isLoaded()||(b=!0)}!b&&this._comments&&
(b=A.isAnnotationText(a.acc,a.accend,this._comments))}return b};var f=function(a,b){return a.acc-b.acc},k=function(a,b){if(b&&0<b.length){b.sort(f);for(var c=[],d,e=a.isEmailHeader(),g=0;g<b.length;g++){var h=b[g];void 0!==h.acc&&(!e&&d&&d.accend+1>=h.acc?h.accend>d.accend&&(d.accend=h.accend):(d=ka(h.acc,h.accend),c.push(d)))}return c}};a.mapRectRangeToText=function(a){if("rect"===a.type){var b=this.getSpanMap();if(b)return a=new ja(a,this),k(this,b.findOverlappingText(a))}};a.textRanges=function(){var a=
this.getSpanMap();if(a)return k(this,a.textRanges())};a.mapRangeToEmbeds=function(a){var b;if(this._embeds&&("rect"===a.type||"cell"===a.type)&&(a=F.rangeRect(a,this)))for(var c=0;c<this._embeds.length;c++){var d=this._embeds[c],e=this.embeddingRect(d.uid);if(e&&e.overlaps(a)){var g=e.left,h=e.top;e.intersect(a);e.offset(-g,-h);b||(b=[]);d=mb(d.uid,this.index,e.left,e.top,e.right,e.bottom);ya(d,"pct");b.push(d)}}return b};a.embeddingByIndex=function(a){var b;this._embeds&&0<=a&&a<this._embeds.length&&
(b=this._embeds[a]);return b};a.embeddingByUID=function(a){var b;this._embeds&&(b=ab(this._embeds,"uid",a));return b};a.embeddingRect=function(a){if(this._embeds&&(a=ab(this._embeds,"uid",a))){var b;if(a.position)b=a.position,b=new ja(b.left,b.top,b.right,b.bottom,this);else{var c=a.x,d=a.y;if(void 0===c||void 0===d){var e=y.byId(a.id);e&&(e=A.elementRect(e,this),void 0===c&&(c=e.left),void 0===d&&(d=e.top))}void 0!=c&&void 0!=d&&(b=new ja(c,d,c+a.w,d+a.h,this))}return b}};a.textBoundingRect=function(a,
b){if(this.isLoaded()&&"text"===a.type){var c;if(this.isSpreadsheet())A.activeOverlay()==this.overlay&&(c=F.rangeRect(a,this));else{this.pushShow();var d=this.findRange(a.acc,a.accend,b);if(d&&0<d.length){for(var e=Ka(d[0]),g=0;g<d.length;g++){var h=d[g].textRect(a);if(h){var f=Ka(d[g]);y.unwrap(f)===y.unwrap(e)&&(c?c.union(h):c=h)}}c||1!=d.length||(c=d[0],e=ga(a),e.accend==c.acc&&e.accend++,c=d[0].textRect(e))}this.popShow()}return c}};a.frameForRange=function(a){var b;if(this.isLoaded()&&this._frames&&
"text"===a.type)for(var c=0;c<this._frames.length;c++){var d=this._frames[c];if(a.accend>=d.acc&&a.acc<d.accend){b=y.byId(d.id);break}}return b};a.textRects=function(a,b,c){if(c||"text"!==a.type)Array.isArray(c)&&(c=c.slice());else{if(this.isSpreadsheet()&&A.activeOverlay()==this.overlay){var d=F.rangeRect(a,b);d&&(e=[new gc(d)])}c=this.findRange(a.acc,a.accend)}if(c&&0<c.length){var e;this.pushShow();c.sort(function(a,b){var c=a.spanRect(),d=b.spanRect(),e=c.top-d.top;e||(e=c.left-d.left);return e});
for(var g,h=[],d=0;d<c.length;d++){var f=c[d].textRect(a);f&&(g&&ac(f.top,g.top)&&ac(f.bottom,g.bottom)&&f.left<=g.right+1?g.union(f):(g=f,h.push(g)))}this.popShow();if(0<h.length)for(e||(e=[]),a=new gc(h[0]),e.push(a),d=1;d<h.length;d++)if(c=h[d],8>c.width||8>c.height)a.add(c);else{for(var f=c.left-5,m=c.right+5,k=c.top-2,q=c.bottom+2,B=a.length-1;0<=B;B--)if(g=a.item(B),m>=g.left&&f<=g.right&&q>=g.top&&k<=g.bottom){a.add(c);c=null;break}c&&(a=new gc(c),e.push(a))}e&&("overlay"!==b&&"view"!==b||
oa(e,"convert",null,b));return e}};a.accRect=function(a,b){var c,d=ka(a,a+1);if(this.isSpreadsheet())c=F.rangeRect(d,b);else{var e=this.findACC(a);if(e&&0<e.length){this.pushShow();for(var g=Ka(e[0]),h=0;h<e.length;h++){var f=e[h].textRect(d);if(f){var m=Ka(e[h]);y.unwrap(m)===y.unwrap(g)&&(c?c.union(f):c=f)}}c&&(c.origin=b);this.popShow()}}return c};a.findTextRange=function(a){if("text"===a.type&&a.acc<=this.accend&&a.accend>=this.acc&&this.isLoaded()){var b=[],c=!1;if(this._frames&&"email"!==this.type)for(var d=
0;d<this._frames.length;d++){var e=this._frames[d];if(a.acc<=e.accend&&a.accend>=e.acc)if((e=X.getElementById(e.id))&&0===e.childNodes.length){var g=X.createRange();g.setStart(e,0);g.setEnd(e,0);b.push(g)}else c=!0}else c=!0;c&&(c=a.acc===a.accend?this.findACC(a.acc):this.findRange(a.acc,a.accend))&&oa(c,"findTextRange",null,a,b);if(0<b.length)return b}};a.layer=function(a){if(this.overlay)return this.selectionRect(),this.overlay.layer(a)};a.hasSelectionRect=function(){return!!this._selRect};a.selectionRect=
function(){if(!this._selRect){var a=this.overlay?this.overlay.layer("selection"):void 0;this._selRect=new ub(this.index,a,"oit-sel-rect");this._selRect.hide()}return this._selRect};a.showSelectionRect=function(a){this._selRect&&this._selRect.show(a)};a.findRange=function(a,b,c){var d;c=c||"all";if("all"===c||"page"===c){var e=this.getSpanMap();e&&(d=e.findRange(a,b))}!this._annotationPane||"all"!==c&&"annotations"!==c||(a=this._annotationPane.findRange(a,b))&&(d=d?d.concat(a):a);return d};a.findACC=
function(a){var b,c=this.getSpanMap();c&&(b=c.findACC(a));this._annotationPane&&(a=this._annotationPane.findACC(a))&&(b=b?b.concat(a):a);return b};a.pageContentChanged=function(){delete this._cachedRects;this._spanMap&&(this._spanMap.destroy(),delete this._spanMap)};a.pageLayoutChanged=function(){delete this._cachedRects;this._spanMap&&this._spanMap.discardLayout();if(this._annotationPane)this._annotationPane.onResize(!0)};a.isSpreadsheet=function(){return this._ssmodel||this._dataURL};a.spreadsheetModel=
function(){return this._ssmodel};a.getSpanMap=function(){void 0===this._spanMap&&this.isLoaded()&&(this.isSpreadsheet()?this._spanMap=null:this._spanMap=new Mc(this));return this._spanMap};var t=function(a){if(a.showProgressDialog&&void 0!==a.srcSize&&void 0!==a.dataSize){var b=a.srcSize+a.dataSize;262144<=b&&(b=100*(a.srcLoaded+a.dataLoaded)/b,a.progressDialog||(a.progressDialog=Ba.createProgressDialog(U.PLEASE_WAIT_INITIALIZING,!0)),a.progressDialog&&a.progressDialog.update(b))}},r=function(a){if(void 0===
a.srcRequest&&void 0===a.dataRequest&&a.isLoading()){a.logLoad&&a.logLoad();a.removeClass("oit-loading");a.pageContentChanged();A.touchPage(a.index);a.loadedSize=0;a.dataSize&&(a.loadedSize+=a.dataSize);a.srcSize&&(a.loadedSize+=a.srcSize);A.applyMemoryLimit(a.loadedSize);a.deferredContent&&(d(a,a.deferredContent),delete a.deferredContent,delete a.deferContent);w(a,!0);a.progressDialog&&(a.progressDialog.hide(),delete a.progressDialog);delete a.showProgressDialog;if(a.completionFuncs){for(var b=0;b<
a.completionFuncs.length;b++)a.completionFuncs[b](a);delete a.completionFuncs}delete a.locked;W(a)}},w=function(a,b){var c;a&&"email"==a.type&&(c=a.childByClass("oit-emailheader"),c||(c=a.byId("oit-emailheader"))&&c.addClass("oit-emailheader"),c&&(a.addClass("oit-emailheaderpage"),c=new md(c),a._emailHeader=c));(c=a.childByClass("oit-email_page"))&&!c.firstChildElem()&&c.css("display","none");if("sn"===a.type){c=y.create("div","oit-noteheader");c.html('<span class="oit-notesicon"></span><span class="oit-unselectable"> '+
U.NOTES+"</span>");var d=a.firstChildElem();d.addClass("oit-sn-content");a.insert(c,d)}a.hiddenFromSlideshow&&(c=y.create("div","oit-hiddenpage"),c.attr("title",U.HIDDEN_SLIDE),a.append(c));z(a,a._comments);a.processRevisions();a.processSSRevisions();a.positionAnnotations();A.on.pageload.dispatch(a,!!b)},n=function(a){a=y.wrap(a);if(v.baseURL){a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT);for(var b;b=a.nextNode();)if("IMG"===b.tagName){var c=b.getAttribute("src");c&&("/"!=c.charAt(0)&&(c=Ma(v.baseURL,
c)),b.setAttribute("src",c))}else"image"===b.tagName&&(c=b.getAttribute("xlink:href"))&&("/"!=c.charAt(0)&&(c=Ma(v.baseURL,c)),b.setAttribute("xlink:href",c))}};a.abortLoad=function(){this.isLoading()&&(this.srcRequest&&(eb(this.srcRequest),delete this.srcRequest),this.dataRequest&&(eb(this.dataRequest),delete this.dataRequest),this.removeClass("oit-loading"),this.addClass("oit-pending"))};a.load=function(a,b){var c=this.isPending(),d=this.isLoading();(c||d)&&(this._srcURL||this._dataURL)?d?b&&this.completionFuncs.push(b):
(this.srcLoaded=this.srcSize=this.dataLoaded=this.dataSize=0,this.completionFuncs=[],b&&this.completionFuncs.push(b),this.removeClass("oit-pending"),this.addClass("oit-loading"),this.locked=!0,!0===a&&(this.showProgressDialog=!0),c=v.baseURL,this._dataURL&&(d=this._dataURL,c&&"/"!=d.charAt(0)&&(d=Ma(c,d)),this.dataRequest=Ja({url:d,context:this,loading:l,complete:u})),this._srcURL&&(d=this._srcURL,c&&"/"!=d.charAt(0)&&(d=Ma(c,d)),this.srcRequest=Ja({url:d,context:this,loading:p,complete:J}))):(c&&
(this.removeClass("oit-pending"),w(this,!1)),b&&b(this))};var l=function(a,b,c){this.dataSize=b;c&&(this.dataLoaded=c.length);t(this)},u=function(a,b,c,d){this.dataSize=b;c&&(this.dataLoaded=c.length,t(this));if(200===d)try{var e=JSON.parse(c);this.processData({ssdata:e})}catch(R){this.logAJAXError(null,"The data for page "+(this.index+1)+" is corrupt",a,d,c)}else this.logAJAXError(null,"Failed to load the data for page "+(this.index+1)+" from the server",a,d,c);delete this.dataRequest;r(this)},p=
function(a,b,c){this.srcSize=b;c&&(this.srcLoaded=c.length);t(this)},J=function(a,b,c,d){this.srcSize=b;c&&(this.srcLoaded=c.length,t(this));200===d?(this.deferContent=!0,ia.isICD(c)?ia.processICD(c,a,d):this.processData({content:c})):this.logAJAXError(null,"Failed to load the content for page "+(this.index+1)+" from the server",a,d,c);delete this.srcRequest;r(this)},W=function(a){var b=la.infoRaw();if(b&&1557===b.fi){var c=(b=a.firstChildElem())?b.firstChildElem():null,d=c?c.nextSiblingElem():null,
e=d?d.nextSiblingElem():null,g=e?e.nextSiblingElem():null,h=c?c.firstChildElem():null,f=h?h.firstChildElem():null,k=d?d.firstChildElem():null,z=e?e.firstChildElem():null,q=z?z.firstChildElem():null,B=q?q.firstChildElem():null,l=B?B.firstChildElem():null;if(f&&!f.nextSiblingElem()&&k&&!k.nextSiblingElem()&&l&&!l.nextSiblingElem()){var u=z.size(),p=l.size(),n=!0;u&&p&&0<u.width&&0<u.height&&0<p.width&&0<p.height&&(n=p.height/u.height,n=.9<=p.width/u.width&&.9<=n);"DIV"==b.tagName&&b.hasClass("oit-svg")&&
"DIV"==c.tagName&&c.hasClass("oit-svg-layer")&&"DIV"==d.tagName&&d.hasClass("oit-frame")&&"DIV"==e.tagName&&e.hasClass("oit-svg-layer")&&"svg"==h.tagName&&"rect"==f.tagName&&"DIV"==k.tagName&&k.hasClass("oit-svg-text")&&"svg"==z.tagName&&"g"==q.tagName&&q.hasClass("oit-pagescale")&&"g"==B.tagName&&B.hasClass("oit-framescale")&&"image"==l.tagName&&!g&&n&&(a="#"+a.id.replace(".","\\.")+" .oit-svg-text",E.screenCSS(a+" div","color:rgba(0,0,0,0);"),E.screenCSS(a+" span","color:rgba(0,0,0,0);"),b.append(d))}}};
a.comments=function(){return this._comments};var T=function(a,b){if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)T(a[c],b);else if(a.range&&"text"===a.range.type){if(void 0===b.acc||a.range.acc<b.acc)b.acc=a.range.acc;if(void 0===b.accend||a.range.accend>b.accend)b.accend=a.range.accend}},G=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)G(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=na.getRawText(a.range.acc,a.range.accend))},Q=function(a){var b="";if(a)if(Array.isArray(a))for(var c=
0;c<a.length;c++)b+=Q(a[c]);else a.range&&"text"===a.range.type&&a.text&&(b=a.text);return b},D=function(a,b){if(a.isEmpty())b._annotationPane.destroy(),delete b._annotationPane;else{b.supportsAnnotationBar()&&A.createAnnotationBar();var c=a.range();c&&(c.acc<b.acc&&(b.acc=c.acc),c.accend>b.accend&&(b.accend=c.accend));x.showAnnotations&&a.layout()}},h=function(a,b){a._annotationPane||(a._annotationPane=new nd(a),x.showAnnotations?a._annotationPane.show():a._annotationPane.hide(),P.addAutoscrollRoot(a._annotationPane.scrollPane()));
a._annotationPane.processAnnotations(b,D,a)},z=function(a,b,c){if(b&&a.supportsAnnotations()){for(var d={},e=0;e<b.length;e++){var g=b[e];T(g.text,d);T(g.author,d);T(g.author_short,d);T(g.last_save_date,d);T(g.create_date,d);T(g.date,d)}void 0!==d.acc?na.loadRawText(d.acc,d.accend,function(){for(var d=0;d<b.length;d++){var e=b[d];G(e.text);G(e.author);G(e.author_short);G(e.last_save_date);G(e.create_date);G(e.date)}c&&(b=c(a,b));h(a,b)}):(c&&(b=c(a,b)),h(a,b))}};a.processRevisions=function(){if(this.isLoaded()&&
this.supportsAnnotations()){var a=E.revisions();if(a){for(var c=[],d=0;d<a.length;d++){var e=a[d];e.range&&this.findRange(e.range.acc,e.range.accend,"page")&&c.push(e)}c.length&&z(this,c,function(a,c){for(var d=0;d<c.length;d++){var e=c[d],g=c[d-1];if(g&&e.range&&g.range&&("add"===e.type&&"delete"===g.type||"delete"===e.type&&"add"===g.type)){var h=Q(e.author),f=Q(g.author),m=Q(e.last_save_date||e.create_date),k=Q(g.last_save_date||g.create_date);h===f&&m===k&&(g.range.acc==e.range.acc&&g.range.accend==
e.range.accend?"add"===g.type?c.splice(d-1,1):c.splice(d,1):(h=Q(e.text),f=Q(g.text),g.range.accend===e.range.acc&&b.test(h)&&b.test(f)&&(h=c[d-1]={type:"change",id:e.id,author:e.author,last_save_date:e.last_save_date,create_date:e.create_date},"add"===e.type?(h.range=e.range,h.text=e.text,h.oldtext=g.text):(h.range=g.range,h.text=g.text,h.oldtext=e.text),c.splice(d,1))))}}return c})}}};a.processSSRevisions=function(){var a=A.ssRevisions();this._ssmodel&&a&&!this.processedSSRevisions&&(this.processedSSRevisions=
!0,this._ssmodel.processRevisions(a,function(){z(this,this._ssmodel.revisions())},this))};a.positionAnnotations=function(){this._annotationPane&&x.showAnnotations&&this._annotationPane.layout()};a.annotationPane=function(){return this._annotationPane};return e}(),Hc=function(){var b=function(a,b){var c={index:{value:a},length:{get:function(){return this.firstPage?this.lastPage.index-this.firstPage.index+1:0}}};b.name&&(c.name={value:b.name});b.hidden&&(c.hidden={value:!0},E.hiddenContent("hidden-pages"));
Object.defineProperties(this,c);(c=X.getElementById(b.oid))?S.call(this,c):(c="oit-overlay",b.cls&&(c=-1==b.cls.indexOf(c)?c+(" "+b.cls):b.cls),S.call(this,"article",c,b.oid));v.viewNode.append(this);this.undisplay();this.hidden?this.hide():this.show()},e=V(b,S);e.updateCSS=function(){"text"!==x.selectionMode||Ba.modalOverlayVisible()?this.addClass("oit-unselectable"):this.removeClass("oit-unselectable");"rect"===x.selectionMode?this.css("cursor","crosshair"):this.css("cursor",null)};e.item=function(a){if(this.firstPage)return A.page(this.firstPage.index+
a)};e.add=function(a){this.append(a);this.firstPage||(this.firstPage=a);this.lastPage=a;if(!this.maxWidth||a.width>this.maxWidth)this.maxWidth=a.width;if(!this.maxHeight||a.height>this.maxHeight)this.maxHeight=a.height;this._pagesHidden&&a.hide()};e.containsPage=function(a){return A.page(a).overlay==this};e.display=function(){if(this.layers){var a=F.activeOverlay()===this;lb(this.layers,"show",null,a)}this.css("display","block");this.updateCSS()};e.undisplay=function(){this.layers&&lb(this.layers,
"hide");this.css("display",null)};e.isDisplayed=function(){return"block"===this.css("display")};e.show=function(){!1!==this._isHidden&&(this._isHidden=!1,A.on.overlayshow.dispatch(this))};e.hide=function(){!0!==this._isHidden&&(this._isHidden=!0,this.undisplay(),A.on.overlayhide.dispatch(this))};e.isHidden=function(){return void 0!==this._isHidden?this._isHidden:this.hidden};e.showPages=function(a){this.each("show",a);this._pagesHidden=!1};e.hidePages=function(a){this.each("hide",a);this._pagesHidden=
!0};e.hasAnnotations=function(a){void 0!==a&&(this._hasAnnotations=!!a);return!!this._hasAnnotations||!!E.revisions()};e.each=function(a,b){zb(this,arguments)};e.layer=function(a){var b;this.layers&&(b=this.layers[a]);b||(b=new jd(v.drawing,a,this.id+"."+a),this.layers||(this.layers={}),this.layers[a]=b);return b};return b}(),hb=function(){var b=function(a,b){this.id=a;this.range=ga(b.range);this.type=b.type;b.style&&(this._style=b.style);b.cls&&(this._class=b.cls);b.comment&&(this._comment=b.comment);
b.label&&(this._label=b.label);b.properties&&(this._properties=b.properties);b.options&&this.setOptions(b.options);if(b.compound&&(this._compound=!0,Array.isArray(b.compound))){this._cRanges=[];for(var c=0;c<b.compound.length;c++){var d=ga(b.compound[c]);"rect"===d.type&&ya(d,"px");this._cRanges.push(d)}}this._pageInfo=[];"rect"===this.range.type&&(void 0!==this.range.embedId?ya(this.range,"pct"):ya(this.range,"px"));this.range=xa(this.range,!0);L.map(this)},e=V(b);e.isNote=function(){return!1};e.isRedaction=
function(){return!1};e.isCompoundRedaction=function(){return!1};e.isEmptyRedaction=function(){return!1};e.setRange=function(a){return void 0!==a&&0!==Ta(a,this.range)?("cell"==this.range.type&&this.eachPage(function(a,b){z(b,A.page(a.index))},null,this),L.unmap(this),this.range=ga(a),L.map(this),delete this._cRanges,"text"==a.type&&this._compound&&(this._cRanges=[a]),this.updateStyle(),L.alignHighlight(),L.on.move.dispatch(this),!0):!1};e.updateStyle=function(){this._hidden||this.eachPage(a,null,
this)};var a=function(a,b){var c=a.index;b.removeFromPage(a);b.addToPage(c)};e.filter=function(a){if(a){if("string"===typeof a)return this[a]();if(a instanceof cb)return this.isOnPage(a.index);if(a instanceof Hc)return this.isInOverlay(a);if(!a(this.id,this._properties))return!1}return!0};e.properties=function(a){void 0!==a&&(this._properties=a);return this._properties};e.property=function(a,b){void 0!==b&&(this._properties||(this._properties={}),this._properties[a]=b);if(this._properties)return this._properties[a]};
e.style=function(a){a&&(this._style=a,this.updateStyle());return this._style};e.highlightStyle=function(){var a=this.style();this._active||"opacity"!==x.highlightActivationStyle||(a=this.highlightStyleProps(),a=Zb(a));return a};e.highlightStyleProps=function(){var a=ib(this.style());if(!this._active&&"opacity"===x.highlightActivationStyle){var b=a["background-color"];b&&(b=Aa(b))&&(b.a*=.4,a["background-color"]=Ia(b))}return a};e.intervalStyleProps=function(){var a=this.highlightStyleProps()["background-color"];
a&&(a=Aa(a));if(a)return a.a*=.25,a=Ia(a),{"background-color":a}};e.fillStyle=function(){if("text"!==this.range.type)return this._style};e.css=function(a){return rb(this._style,a)};e.matches=function(a,b,c,d,e){return this._style===a&&0===Ta(this.range,b)&&this._properties===c&&this._comment===d&&this._label===e};var d=function(a,b){b&&b.autodpi?ya(a,"pct"):b&&"bitmap"===b.type?ya(a,"px"):ya(a,"tw")};e.serialize=function(){var a={type:this.type},b,c;a.range=ga(this.range);"rect"===a.range.type&&(void 0!==
a.range.embedId?ya(a.range,"pct"):(b=A.page(a.range.page),d(a.range,b)));if(this.ttrects){var e=[],g;for(g in this.ttrects){var h=this.ttrects[g];if(h){b=A.page(g);for(var f=0;f<h.length;f++)c=h[f].toRange(b),d(c,b),e.push(c)}}a.ttrects=[].concat.apply([],e)}this._style&&(a.style=this._style);this._properties&&(a.properties=this._properties);"string"===typeof this._comment&&(a.comment=this._comment);this._label&&(a.label=this._label);this._options&&(a.options=this._options);if(this._cRanges)for(a.compound=
[],b=0;b<this._cRanges.length;b++)c=ga(this._cRanges[b]),"rect"===c.type&&(void 0!==c.embedId?ya(c,"pct"):ya(c,"tw")),a.compound.push(c);return a};e.destroy=function(){this.destroyDialog();this.eachPage(c,null,this);L.unlink(this);this.deleteAll()};var c=function(a,b){b.removeFromPage(a)};e.getOption=function(a){if("text"==this.range.type){if("enableUserMove"===a)return!1;if("enableUserResize"===a)for(var b in this._pageInfo){if(A.page(Number(b)).isSpreadsheet())return!1;break}}return(b=this._options)&&
void 0!==b[a]?b[a]:!0};e.setOptions=function(a){if(a&&(g(this,"enableUserDelete",a,!0),g(this,"enableUserComment",a,!0),g(this,"enableUserResize",a,!0),"text"!==this.range.type&&g(this,"enableUserMove",a,!0),this._options)){a=!1;for(var b in this._options)if(this._options.hasOwnProperty(b)){a=!0;break}a||delete this._options}};e.comment=function(a){void 0!==a&&(this._comment=null===a?void 0:String(a),this.updateComment(void 0,this._comment));return this._comment};e.dialog=function(a){var b=this._dialog;
b?(b.abortAnimation(),b.show(!0)):b=this._dialog=new od(this);b.loadComment();b.setMode(a);b.align();return b};e.alignDialog=function(a){this._dialog&&this._dialog.align(a)};e.hideDialog=function(){var a=this._dialog;a&&a.show(!1,{endFn:a.close,context:a})};e.exitDialog=function(){this._dialog&&this._dialog.exit()};e.destroyDialog=function(){this._dialog&&this._dialog.destroy()};e.onDialogDestroy=function(a){a===this._dialog&&delete this._dialog};e.label=function(a){void 0!==a&&(this._label=null===
a||""===a?void 0:String(a),this.eachPage(f,null,this));return this._label};var f=function(a,b){b.applyLabel(a)};e.showLabel=function(a){this._label&&(!1===a?this._labelVisible=!1:delete this._labelVisible,this.eachPage(f,null,this))};e.isOnPage=function(a){return!!this._pageInfo[a]};e.isInOverlay=function(a){var b=a.lastPage.index;for(a=a.firstPage.index;a<=b;a++)if(this.isOnPage(a))return!0;return!1};var k=function(a,b){var c=a._pageInfo[b];c||(a._pageInfo[b]=c={index:b});return c};e.eachPage=function(a,
b){tc(this._pageInfo,arguments)};e.activate=function(a){this.inAnnotation()&&(x.showAnnotations=!0);this.addToDocument();this._hidden&&(this.show(),this._autohide=!0,F.update());this._active=!0;this.eachPage(r,null,this);this.positionAll()};var t=function(a,b){if("text"===b.range.type&&"opacity"===x.highlightActivationStyle){var c=A.page(a.index).spreadsheetModel();if(c&&!b.inAnnotation())c.updateHighlight(b);else{var d=1,c=-2;b._active&&(d=2,c=-1);var e=b.highlightStyleProps();a.spanList&&Pb(a.spanList,
b.id,e,d);a.compoundSpanList&&oa(a.compoundSpanList,function(a,b){Pb(a.spans,b,e,d)},null,b.id);if(a.intervalSpanList){var g=b.intervalStyleProps();g&&oa(a.intervalSpanList,Pb,null,b.id|1E9,g,c)}}}},r=function(a,b){var c=a.drawingRect;b.oldFocusPage=void 0;if("text"===b.range.type)"opacity"===x.highlightActivationStyle?t(a,b):c&&(c.addClass("oit-highlight-active"),c.setRange(b.range),b.getOption("enableUserResize")?c.ontextmove(b,w).ontextmoveend(b,l).showTextHandles():c.offtextmove(w).offtextmoveend(l).hideTextHandles(),
c.activate());else if(c){c.addClass("oit-highlight-active");var d="cell"!==b.range.type;b.updateMoveable(!0,c);b.updateResizable({bindToObject:d,minWidth:10,minHeight:10},c);c.activate()}a.embedRect&&a.embedRect.show()};e.updateMoveable=function(a,b,c){c=c||b;if(!1!==a&&this.getOption("enableUserMove"))b.addClass("oit-moveable").ondragstart(this,N,c).ondragmove(this,R,c).ondragend(this,E,c).ondragcancel(this,fa,c);else b.removeClass("oit-moveable").offdragstart(N).offdragmove(R).offdragend(E).offdragcancel(fa)};
e.updateResizable=function(a,b,c){c=c||b;if(a&&this.getOption("enableUserResize"))c.resizable(!0,a).onresizemove(this,C).onresizeend(this,I);else c.resizable(!1).offresizemove(C).offresizeend(I)};var w=function(a){var b=a.range;a=a.page;var c=A.pagesForRange(b);a!=this.oldFocusPage&&(this.oldFocusPage=a,this.eachPage(n,null,c,this));this._pageInfo[a.index]||this.addToPage(a.index,!0);this._cRanges&&(this._cRanges=[b]);h(this,a,this.highlightStyle(),b);this.alignDialog({animate:!1})},n=function(a,
b,c){a.spanList&&(a=a.index,ab(b,"index",a)||z(c,A.page(a)))},l=function(a){this.setRange(a.range)};e.deactivate=function(){this._active&&(delete this._active,this.eachPage(u,null,this),this._autohide&&(this.hide(),delete this._autohide,F.update()))};var u=function(a,b){var c=a.drawingRect;c&&c.removeClass("oit-highlight-active").deactivate();"text"===b.range.type?"opacity"===x.highlightActivationStyle&&t(a,b):c&&(b.updateMoveable(!1,c),b.updateResizable(!1,c));a.embedRect&&a.embedRect.hide()};e.show=
function(){if(void 0!==this._hidden){var a=this._hidden;delete this._hidden;if(0<a.length){for(var b=0;b<a.length;b++)this.addToPage(a[b]);L.link(this)}else this.addToDocument()}delete this._autohide};e.hide=function(){this._hidden||(this._hidden=[],this.eachPage(p,null,this),L.unlink(this))};var p=function(a,b){b._hidden.push(a.index);b.removeFromPage(a)};e.collapse=function(){};e.isHidden=function(){return!(!this._hidden&&!this._autohide)};var v=function(a,b){var c,d=a._pageInfo[b.index];if(d){if(!d.boundingRects)if(d.spanList||
d.compoundSpanList){var e;if(d.spanList)e=b.textRects(a.range,b,d.spanList);else{var g=[];for(c=0;c<d.compoundSpanList.length;c++)Array.prototype.push.apply(g,d.compoundSpanList[c].spans);for(c=0;c<a._cRanges.length;c++){var h=b.textRects(a._cRanges[c],b,g);e?Array.prototype.push.apply(e,h):e=h}}if(e)for(c=0;c<e.length;c++)for(g=e[c],h=0;h<g.length;h++){var f=g.item(h).clone();f.readonly(!0);d.boundingRects||(d.boundingRects=[]);d.boundingRects.push(f.clone())}}else"text"===a.range.type&&(c=b.textBoundingRect(a.range)),
c||(c=F.rangeRect(a.range,b)),c&&(c=c.clone(),c.readonly(!0),d.boundingRects=[c]);return d.boundingRects}},W=function(a,b,c){var d;if(b){c=c||b;if("text"===a.range.type){var e=v(a,b);if(e){d=e[0].clone();for(var g=1;g<e.length;g++)d.union(e[g]);d.origin=c}}d||(d=F.rangeRect(a.range,c||b))}return d};e.boundingRectList=function(a){var b=[];this.eachPage(T,null,a,b,this);if(0<b.length)return b};var T=function(a,b,c,d){(a=W(d,A.page(a.index),b))&&c.push(a)};e.addToDocument=function(a){if(!this._hidden){var b=
A.pagesForRange(this.range);if(b){for(var c=0;c<b.length;c++)this.addToPage(b[c].index,!1,a);!1!==a&&L.link(this)}}};var G=function(a){a.highlightLayer||(Q(a),a.highlightLayer=a.layer("highlights"));return a.highlightLayer},Q=function(a){a.compoundHighlightLayer||(a.compoundHighlightLayer=a.layer("chighlights"));return a.compoundHighlightLayer};e.addToPage=function(a,b,c){var d=A.page(a),e=this._pageInfo[a];e&&b&&(this.removeFromPage(e),e=null);if(!this._hidden&&(!e||e.needRect||e.needApply)&&d&&
d.isLoaded()&&!d.isHidden()&&(b||d.containsRange(this.range))){var g;delete this._inComment;d.pushShow();e&&e.needApply||(e=h(this,d,this.highlightStyle(),this.range));e&&delete e.boundingRects;if(L.batchMode())e&&(e.needApply=!0);else{b="text"!==this.range.type||"opacity"!==x.highlightActivationStyle;var f=!1;b&&(g=W(this,d,"overlay"),g||(e&&(e.needRect=!0),f=!0));if(!f){e?(delete e.needRect,delete e.needApply):e=k(this,a);void 0===this.range.embedId||e.embedRect||(e.embedRect=new ub(a,G(d)),e.embedRect.addClass("oit-highlight-embed"),
e.embedRect.hide());if(b&&!e.drawingRect&&(e.drawingRect=this.createDrawingRect(d.index,G(d)),e.drawingRect&&(L.on.addElement(e.drawingRect,this),d.inAnnotation(this.range))))e.drawingRect.onwheel(this,function(a){var b=d.annotationPane();if(b)return b.scrollPane().redirectEvent(a)});(b=this.fillStyle())?(e.styleDiv||(e.styleDiv=y.create("div","oit-highlight-style"),e.drawingRect&&e.drawingRect.append(e.styleDiv)),e.styleDiv.attr("style",b)):e.styleDiv&&(e.styleDiv.destroy(),delete e.styleDiv);this._label&&
this.applyLabel(e);D(this._pageInfo[a],this,g);this.updateComment(e,this._comment)}}!1!==c&&L.link(this);F.update(!1,!0);d.popShow()}};e.removeFromPage=function(a){"number"==typeof a&&(a=this._pageInfo[a]);if(a){var b=a.index;z(this,A.page(b));a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag);a.drawingRect&&(L.on.removeElement(a.drawingRect,this),a.drawingRect.destroy());a.embedRect&&a.embedRect.destroy();this._pageInfo[b]=null;F.update(!1,!0)}};e.createDrawingRect=function(a,b){var c;
"text"===this.range.type?"opacity"!==x.highlightActivationStyle&&(c=new id(a,b),c.setRange(this.range)):c=new ub(a,b);return c};e.distanceFromPoint=function(a,b,c,d){var e;a=A.page(a);if(a=v(this,a))for(var g=0;g<a.length;g++){var h=a[g];if(!(h.origin instanceof cb)==d&&(h=h.distanceFrom(b,c,"nearest","nearest","xy"),void 0===e||h.ay<e.ay||h.ay==e.ay&&h.ax<e.ax)&&(e=h,0===e.x&&0===e.y))break}return e};var D=function(a,b,c){var d;if(a){d=a.index;var e=A.page(d);if(e.isHidden()||!e.isEnabled()){a.drawingRect&&
a.drawingRect.hide();a.embedRect&&a.embedRect.hide();if(a.cRects)for(d=0;d<a.cRects.length;d++)a.cRects[d].rect.hide();a.needRect=!0}else if("text"===b.range.type)a.drawingRect&&a.drawingRect.show().changed();else if(c||(c=W(b,e,"overlay")),c){a.drawingRect&&a.drawingRect.show().move(c.left,c.top,c.width,c.height);a.embedRect&&(c=A.page(d).embeddingRect(b.range.embedId))&&(c.origin="overlay",a.embedRect.show().move(c.left,c.top,c.width,c.height));if(a.cRects)for(d=0;d<a.cRects.length;d++)e=a.cRects[d],
(c=F.rangeRect(e.range,"overlay"))&&e.rect.show().move(c.left,c.top,c.width,c.height);b.updateComment(a,b._comment)}}};e.positionAll=function(){this.eachPage(D,null,this)};e.generateKey=function(){var a,b=A.forRange(this.range,0);if(b&&void 0===this.prevId&&void 0===this.nextId){this.key&&this.key.page!=b.index&&delete this.key;this.key||(this.key={page:b.index,x:0,y:0});if(this.inAnnotation())this.key.x=this.range.acc,this.key.y=9999999;else if(b.isEmailHeader()&&"text"===this.range.type)this.key.x=
this.range.acc;else if(b.spreadsheetModel()){var c;"cell"===this.range.type?(c=this.range,this.key.x=0):"text"===this.range.type&&(c=b.spreadsheetModel().mapToCells(this.range),Array.isArray(c)&&(c=c[0]),this.key.x=this.range.acc);c?this.key.y=c.r1*b.spreadsheetModel().colCount()+c.c1:delete this.key}else{var d;if(b&&(a=v(this,b))){d=a[0].left;b=a[0].top;for(c=1;c<a.length;c++){var e=a[c];if(e.top<b||e.top==b&&e.left<d)d=e.left,b=e.top}d={left:d,top:b}}if(a=d)this.key.x=a.left,this.key.y=a.top}a=
this.key}else delete this.key;return a};e.inAnnotation=function(){void 0===this._inComment&&(this._inComment=A.inAnnotation(this.range));return this._inComment};e.applyLabel=function(a){if(a&&a.drawingRect)if(this._label&&!1!==this._labelVisible){var b=this.css("background-color"),c;a:{if(b&&(c=Aa(b))){c.r=255-c.r;c.g=255-c.g;c.b=255-c.b;c=Ia(c.r,c.g,c.b);break a}c=void 0}c||(b=null);a.drawingRect.setLabel(this._label,c,b)}else a.drawingRect.setLabel(null)};var h=function(a,b,c,d){var e=null,g=0,
h,f,m,q,l,u;a._active?g=2:"opacity"===x.highlightActivationStyle&&(g=1);var p=P.saveSelection();z(a,b);if(a._compound){if(a._cRanges||(a._cRanges=A.decomposeRange(d,!0)),a._cRanges){(q=b.spreadsheetModel())&&q.addHighlight(a)&&(e||(e=k(a,b.index)));var n="rect"===d.type,C;for(q=0;q<a._cRanges.length;q++){l=a._cRanges[q];if("text"===l.type){if(m||(m=ib(c)),m&&(f=Gb(b,l,m,a.id,void 0,g))){e||(e=k(a,b.index));e.compoundSpanList||(e.compoundSpanList=[]);for(var B=0;B<f.length;B++)if(h=f[B].split(l))for(u=
0;u<h.length;u++)L.on.addElement(h[u],a);e.compoundSpanList.push({spans:f,range:l})}}else if(f=F.rangeRect(l,"overlay"))h=new ub(b.index,Q(b)),c&&(u=y.create("div","oit-highlight-style"),u.attr("style",c),h.append(u)),h.move(f.left,f.top,f.width,f.height),e||(e=k(a,b.index)),e.cRects||(e.cRects=[]),e.cRects.push({range:l,rect:h});n&&(l="text"===d.type?b.textBoundingRect(l):F.rangeRect(l,b))&&(C?C.union(l):C=l)}if(x.highlightTermIntervals&&"text"===a.range.type&&1<a._cRanges.length&&(g=-2,a._active&&
(g=-1),d=a.intervalStyleProps())){c=[];f=a.acc;for(q=0;q<a._cRanges.length;q++)l=a._cRanges[q],l.acc>f&&c.push(ka(f,l.acc)),f=l.accend;for(q=0;q<c.length;q++)if(l=c[q],f=Gb(b,l,d,a.id|1E9,void 0,g))e||(e=k(a,b.index)),e.intervalSpanList||(e.intervalSpanList=[]),e.intervalSpanList.push(f)}C&&(b=F.rangeFromRect(b.index,C.left,C.top,C.right,C.bottom,b,"highlight"))&&(a.range=b)}}else if("text"===d.type&&((q=b.spreadsheetModel())&&q.addHighlight(a)&&(e=k(a,b.index)),m=ib(c))&&(f=Gb(b,d,m,a.id))){e||(e=
k(a,b.index));e.spanList=f;for(q=0;q<f.length;q++)if(h=f[q].split(d))for(u=0;u<h.length;u++)L.on.addElement(h[u],a);if((q=la.infoRaw())&&1557===q.fi)for(a.ttrects||(a.ttrects=[]),a=a.ttrects[b.index]=[],q=0;q<f.length;q++)f[q].hasClass("oit-tt")&&(b=f[q].textRect(d))&&a.push(b)}p&&P.restoreSelection(p);return e},z=function(a,b){var c,d=a._pageInfo[b.index];if(d){var e=P.saveSelection(),g=b.spreadsheetModel();g&&("text"===a.range.type||a._compound)&&g.removeHighlight(a);if(d.spanList){for(c=0;c<d.spanList.length;c++)if(g=
d.spanList[c].split(a.range))for(var h=0;h<g.length;h++)L.on.removeElement(g[h],a);Ob(d.spanList,a.id);delete d.spanList;b.pageLayoutChanged()}d.compoundSpanList&&(oa(d.compoundSpanList,function(b,d){var e=b.range,g=b.spans;for(c=0;c<g.length;c++){var h=g[c].split(e);if(h)for(var f=0;f<h.length;f++)L.on.removeElement(h[f],a)}Ob(g,d)},null,a.id),delete d.compoundSpanList,b.pageLayoutChanged());d.intervalSpanList&&(oa(d.intervalSpanList,Ob,null,a.id|1E9),delete d.intervalSpanList,b.pageLayoutChanged());
if(d.cRects){for(c=0;c<d.cRects.length;c++)if(g=d.cRects[c].rect)L.on.removeElement(g,a),g.destroy();delete d.cRects}e&&P.restoreSelection(e)}},g=function(a,b,c,d){var e=!1;c=c[b];void 0!==c&&(c==d?(d=a._options)&&void 0!==d[b]&&(delete d[b],e=!0,a.optionChanged(b)):(a._options||(a._options={}),a._options[b]=!!c,e=!0,a.optionChanged(b)));return e};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.id===L.active()&&this.activate(!0)}};var m=function(a,b,c){c.updateComment(a,
b)};e.updateComment=function(a,b){a?a.drawingRect&&(b?(a.commentFlag||(a.drawingRect.onmouseenter(this,O).onmouseleave(this,H),a.commentFlag||(a.commentFlag=new Ga(a.drawingRect,{hpos:"right",vpos:"top",margin:2,classList:"oit-comment-flag"}))),a.commentFlag.show()):a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag)):this.eachPage(m,null,b,this)};var O=function(a){this.id!=L.active()&&L.showComment(this.id)},H=function(a){this.id!=L.active()&&L.hideComment(this.id)},N=function(a,b){if(this.getOption("enableUserMove")){var c=
b.position();this._moveable={startRect:c.clone(),curRect:c.clone()};return!1}return!0},R=function(a,b){if(this._moveable){var c=this.range,d,e=this._moveable.startRect;d=this._moveable.curRect;var g=a.delta;d.left=e.left+g.x;d.top=e.top+g.y;"cell"!==c.type||c.offsets?d=F.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId):(this.moveOriginalRect||(this.moveOriginalRect=F.rangeRect(c,d.origin)),e=this.moveOriginalRect.clone(),e.left=d.left,e.top=d.top,d=F.rangeFromRect(c.page,
e.left,e.top,e.right,e.bottom,e.origin,"move",c.embedId),e=c.c2-c.c1,g=c.r2-c.r1,d.c2-d.c1<e&&(d.c2=d.c1+e),d.r2-d.r1<g&&(d.r2=d.r1+g),delete d.offsets);0!==Ta(d,c)&&(d=F.rangeRect(d,"overlay"),b.move(d.left,d.top,d.width,d.height),this._active&&this._comment&&this._dialog&&this._dialog.align({rect:d,animate:!1}))}return!1},E=function(a,b){if(this._moveable){var c=this.range,d=this._moveable.curRect,d=F.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId);if("cell"===d.type&&
!c.offsets){delete this.moveOriginalRect;var e=c.c2-c.c1,c=c.r2-c.r1;d.c2-d.c1<e&&(d.c2=d.c1+e);d.r2-d.r1<c&&(d.r2=d.r1+c);delete d.offsets}this.setRange(d);delete this._moveable}return!1},fa=function(a,b){if(this._moveable){var c=a.center;L.activateNearest(c.x,c.y,a.srcEvent);delete this._moveable}return!1},C=function(a){var b=this.range,c=a.drawingRect;a=a.newRect;var d=F.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==d.type||b.offsets||delete d.offsets;
if(d=xa(d,!0))b=F.rangeRect(d,"overlay"),"rect"===d.type&&(a=b),c.move(b.left,b.top,b.width,b.height);this._active&&this._comment&&this._dialog&&this._dialog.align({rect:a,animate:!1})},I=function(a){var b=this.range;a=a.newRect;a=F.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==a.type||b.offsets||delete a.offsets;a=xa(a,!0);this.setRange(a)};return b}(),$c=function(){var b=function(a,b){hb.call(this,a,b)},e=V(b,hb);e.isRedaction=function(){return!0};e.isCompoundRedaction=
function(){return!0===this._compound};e.isEmptyRedaction=function(){return!0===this._compound&&!this._cRanges};e.style=function(a){a=x.redactionColor;return"color:"+a+";background-color:"+a+";"};e.fillStyle=function(){if("text"!==this.range.type){var a;if(a=!this._compound||"rect"!==this.range.type&&"cell"!==this.range.type?x.redactionColor:x.redactionFillColor)return"background-color:"+a+";"}};e.css=function(a){if("color"===a||"background-color"===a)return x.redactionColor};return b}(),ad=function(){var b=
function(a,b){hb.call(this,a,b);this._newNote=!0;this._state="oit-note-pinned";this._pinned=!0;this._hidden=this._hover=this._active=this._editing=!1},e=V(b,hb);e.isNote=function(){return!0};e.isEditing=function(){return this._editing};e.isHidden=function(){return this._hidden};e.removeFromPage=function(a){this.endEditText(!1);hb.prototype.removeFromPage.call(this,a)};e.activate=function(a){if(!this._active||a)this._active=!0,this.updateState(a)};e.deactivate=function(){this._active&&(this._active=
!1,this.updateState())};e.show=function(){this._hidden&&(this._hidden=!1,this.updateState())};e.hide=function(){this._hidden||(this._hidden=!0,this.updateState())};e.pin=function(){this._pinned||(this._pinned=!0,this.updateState())};e.unpin=function(){this._pinned&&(this.endEditText(!0),L.active()==this.id&&L.deactivate(),this._pinned=!1,this.updateState())};e.beginEditText=function(a){void 0!==a&&(this._newNote=a);this._editing||(this._editing=!0,v.editingComment++,this.updateState())};e.endEditText=
function(a){this._editing&&(!1===a&&(this.buttons.textArea.value=L.comment(this.id)),this._editing=!1,v.editingComment--,this.updateState(),this._newNote&&(a?delete this._newNote:L.remove(this.id)))};e.ok=function(){this.endEditText(!0);return!1};e.cancel=function(){this.endEditText(!1);return!1};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.updateState(!0)}};var a=function(){this.addClass("oit-note-expanding")},d=function(){this.removeClass("oit-note-expanding")},
c=function(){this.addClass("oit-note-collapsing")},f=function(){this.removeClass("oit-note-collapsing")};e.updateState=function(b){var e;e=this._editing?"oit-note-editing":this._active?this._pinned?"oit-note-active":"oit-note-shown":this._hidden?"oit-note-hidden":this._pinned?"oit-note-pinned":this._hover?"oit-note-hover":"oit-note-iconic";var k=this.noteRect;if(k){if(e!=this._state||b){var l=this._state;this._state=e;k.removeClass(l).addClass(e);switch(l){case "oit-note-editing":L.comment(this.id,
this.buttons.textArea.value);Ba.showModalOverlay(!1);this.buttons.iconBar.focus();k.layer().removeClass("oit-note-layer-edit");k.removeClass("oit-highlight-active").deactivate();break;case "oit-note-hidden":k.show();break;case "oit-note-iconic":"oit-note-hidden"!==e&&(b=this.originalRect,k.move(b.left,b.top,b.width,b.height,{timems:200,startFn:a,endFn:d}));break;case "oit-note-active":k.removeClass("oit-highlight-active").deactivate();case "oit-note-pinned":"oit-note-active"!==e&&"oit-note-pinned"!==
e&&(this.updateMoveable(!1,this.buttons.iconBar,k),this.updateResizable(!1,k))}this.positionAll();switch(e){case "oit-note-hidden":k.hide();break;case "oit-note-iconic":this.originalRect=k.position().clone();b=this.collapsedRect={left:this.originalRect.right-20,top:this.originalRect.top,width:20,height:20};"oit-note-hidden"===l?k.move(b.left,b.top,b.width,b.height):k.move(b.left,b.top,b.width,b.height,{timems:200,startFn:c,endFn:f});break;case "oit-note-editing":k.layer().addClass("oit-note-layer-edit");
k.addClass("oit-highlight-active").activate(!1,!0);L.activate(this.id);Ba.showModalOverlay(!0);e=this.buttons.textArea;e.blur();e.focus();this._newNote&&e.moveCaret(e.value.length||0);break;case "oit-note-active":k.addClass("oit-highlight-active").activate(!1,!0);case "oit-note-pinned":this.updateMoveable(!0,this.buttons.iconBar,k),this.updateResizable({bindToObject:"cell"!==this.range.type,minWidth:60,minHeight:45,margin:-5},k)}}k.update()}};e.createDrawingRect=function(a,b){var c=new ub(a,b),d=
{};this.noteRect=c;this.buttons=d;c.addClass("oit-note").addClass("oit-note-pinned");d.iconBar=new Ga(c,{classList:"oit-note-icons",inheritMoveable:!0});d.iconBar.attr("tabindex","-1");d.cancel=new Ga(d.iconBar,{classList:"oit-note-cancel",title:U.DISCARD_CHANGES});d.cancel.onclick(this,this.cancel).ontap(this,this.cancel);d.ok=new Ga(d.iconBar,{classList:"oit-note-ok",title:U.SAVE_CHANGES});d.ok.onclick(this,this.ok).ontap(this,this.ok);d.pin=new Ga(c,{classList:"oit-note-pin"});d.pin.onmouseenter(this,
k).onmouseleave(this,t).onclick(this,r).ontap(this,r);d.textArea=new mc;d.textArea.onfocus(this,n).ontap(this,w);d.textForm=y.create("form");d.textForm.append(d.textArea);c.append(d.textForm);this.updateState(!0);return c};var k=function(a){this._hover=!0;this.updateState()},t=function(a){this._hover=!1;this.updateState()},r=function(a){this._pinned?this.unpin():this.pin();return!1},w=function(a){this.buttons.textArea.blur();this.buttons.textArea.focus()},n=function(a){this.getOption("enableUserComment")?
this.beginEditText():this.buttons.textArea.blur()},l=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?this._hidden||this._editing||!this.buttons||(this.buttons.textArea.value=b||""):this.eachPage(l,null,b,this)};return b}(),bd=function(){var b=function(b,a){hb.call(this,b,a);a.name&&(this._name=a.name);a.sizing&&(this._sizing=a.sizing);a.opacity&&(this._opacity=a.opacity);if(!this._style){var d="background:url("+L.stamp(this._name).url+") no-repeat";1!=this._opacity&&(d+=";opacity:"+
this._opacity);"scale"===this._sizing?d+=";background-size:contain":"stretch"===this._sizing&&(d+=";background-size:100% 100%");this._style=d}};V(b,hb).serialize=function(){var b=hb.prototype.serialize.call(this);b.stamp=this._name;b.opacity=this._opacity;b.sizing=this._sizing;delete b.style;return b};return b}(),od=function(){var b=200,e=150,a=function(a){var b="#000",d=a.css("background-color");d&&(d=$b(d,"#FFFFFF"));if(d){var e=Aa(d);128>e.r&&128>e.g&&128>e.b&&(b="#FFF")}Lc.call(this,{ok:!0,cancel:!0,
className:"oit-dialog-comment",resultFn:c,destroyFn:f,textColor:b,backgroundColor:d});this._highlight=a},d=V(a,Lc),c=function(a,c){"view"!==a._mode&&(b=a.width(),e=a.height(),"new"!==a._mode||c&&a._textarea.value?(c&&a.saveComment(),L.active()===a._highlight.id?a.setMode("view"):a._highlight.exitDialog()):(L.remove(a._highlight.id),P.select(null)))},f=function(a){a.setMode(null);a._highlight.onDialogDestroy(a)};d.setMode=function(a){if(a!==this._mode){if("edit"===this._mode||"new"===this._mode)v.editingComment--,
this.removeClass("oit-comment-edit");this._mode=a;switch(a){case "view":this._highlight.comment()?(this._textarea&&(this._textarea.destroy(),delete this._textarea),this._label||(this._label=this.addLabel(null),this._label.onclick(this,k).ontap(this,k).onmouseenter(this,t).onmouseleave(this,r)),this.resizable(!1),this.modal(!1),this.showFooter(!1),this.maxsize(b,e),this._mode=a,this.loadComment(),this.align(),this.show()):this._highlight.exitDialog();break;case "edit":case "new":v.editingComment++,
this.addClass("oit-comment-edit"),this.modal(!0),this.align({endFn:w,context:this})}}};var k=function(){this._highlight.getOption("enableUserComment")&&this.setMode("edit")},t=function(){L.showComment(this._highlight.id)},r=function(){var a=this._highlight.id,b=L.active();a!=b&&(L.hideComment(a),void 0!==b&&L.showComment(b))},w=function(){this.show(!0,{endFn:n,context:this})},n=function(){this._label&&(this._label.destroy(),delete this._label);this._textarea||(this.resetForm(),this._textarea=this.addTextArea(null),
this._textarea.onfocus(this,l));this.loadComment();this.resizable(!0,180,100);this.showFooter(!0);this.maxsize(0,0);this._textarea&&this._textarea.focus&&this._textarea.focus()},l=function(){var a=this._textarea;a&&("number"==typeof a.selectionStart?a.selectionStart=a.selectionEnd=a.value.length:"undefined"!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select()))};d.loadComment=function(){var a=this._highlight.comment()||"";this._textarea?this._textarea.value=a:this._label&&
this._label.text(a)};d.saveComment=function(){this._textarea&&L.comment(this._highlight.id,this._textarea.value,!0)};d.align=function(a){var c;a:{var d=a?a.rect:null;if(this){var f=this._highlight,k=f.isNote(),l,n,u;if(d)"view"!==d.origin&&(d=d.clone(),d.origin="view"),k?(c=d.left,l=d.top,n=d.right-d.left,u=d.bottom-d.top):(c=d.right+10,l=d.top);else if(d=f.boundingRectList("view"))for(f=0;f<d.length;f++){var h=d[f];k?(c=h.left,l=h.top,n=h.right-h.left,u=h.bottom-h.top):(c=h.right+10,l=h.top);0>l&&
0<=h.bottom&&(l=0);if(0<=c&&0<=l)break}if(void 0!=c){10>c&&(c=10);10>l&&(l=10);k=v.viewNode.pos();c+=k.left;l+=k.top;if(n&&u){c={left:c,top:l,width:n,height:u};break a}c={left:c,top:l};break a}}c=void 0}c&&(l=c.width||b,n=c.height||e,"view"===this._mode?this.autoSize(c.left,c.top,l,n,a):this.move(c.left,c.top,l,n,a))};return a}(),Nb=function(){var b=function(a,b,c,d,e){this.prop("id",a);this._edge=b;this._visible=!1;this._autoSize=!0;this._resizable=this._overlay=!1;this._height=this._width=void 0;
switch(this._edge){case "top":this._dimension="height";this._border="borderBottom";this._direction=1;break;case "bottom":this._dimension="height";this._border="borderTop";this._direction=-1;break;case "left":this._dimension="width";this._border="borderRight";this._direction=1;break;case "right":this._dimension="width",this._border="borderLeft",this._direction=-1}this._frame=y.create("div","oit-toolframe");this._toolbar=y.create("div","oit-toolbar oit-toolbar-"+this._edge);this._toolsParent=y.create("div",
"oit-toolbar-tool");this._toolsElem=c;this._content=y.create("div","oit-toolcontent");this._toolbar.append(this._toolsParent);this._toolsParent.append(this._toolsElem);this._frame.append(this._toolbar,this._content);d&&(y.unwrap(this._toolbar).style[this._border]=d);a=e?e._content:v.rootNode;this._content.transferFrom(a);a.append(this._frame)},e=V(b);e.filter=function(a){return a===this.id};e.refresh=function(){this.applySize()};e.isInternal=function(){return 0>this.id};var a=function(a){this._startSize=
this.size();return!1},d=function(a){var b=this._startSize;switch(this._edge){case "top":b+=a.delta.y;break;case "bottom":b-=a.delta.y;break;case "left":b+=a.delta.x;break;case "right":b-=a.delta.x}this.setSize(b);return!1},c=function(a){delete this._startSize;return!1};e.overlay=function(a){"boolean"===typeof a&&((this._overlay=a)?this._toolbar.addClass("oit-toolbar-overlay"):this._toolbar.removeClass("oit-toolbar-overlay"),this._visible&&(this.hide(),this.show()));return this._overlay};e.resizable=
function(b,e,t,r){"boolean"===typeof b&&((this._resizable=b)?("number"==typeof e&&"number"==typeof t&&"string"==typeof r&&(this._collapseSize=e,this._minSize=t,this._collapseHeader=y.create("div","oit-toolcollapse"),this._collapseHeader.html(r),this._toolbar.append(this._collapseHeader)),this._toolbar.addClass("oit-toolbar-resizable"),this._resizeHandle||(this._resizeHandle=y.create("div","oit-toolresize"),this._resizeHandle.html("<div></div>"),this._resizeHandle.ondragstart(this,a),this._resizeHandle.ondragmove(this,
d),this._resizeHandle.ondragend(this,c),this._resizeHandle.ondragcancel(this,c),this._resizeHandle.kinetic(!1),this._toolbar.append(this._resizeHandle))):(this._collapseHeader&&this._collapseHeader.destroy(),delete this._collapseSize,delete this._minSize,delete this._collapseHeader,this._toolbar.removeClass("oit-toolbar-resizable"),this._resizeHandle&&(this._resizeHandle.destroy(),delete this._resizeHandle)),this._visible&&(this.hide(),this.show()));return this._resizable};e.remove=function(){var a=
this._frame.parent();a&&(a.transferFrom(this._content),this._frame.destroy());this.isInternal()||Ha.on.remove.dispatch(this.id,this._edge)};e.isVisible=function(){return this._visible};e.show=function(a){var b=this._toolbar;a=a||{};if(!this._visible){this._autoSize=this._visible=!0;this._toolbar.css("display","block");if(void 0===this._borderSize&&(this._borderSize=0,y.unwrap(this._toolbar).style[this._border])){var c=this._toolbar.computedStyle();c&&(this._borderSize=parseInt(c[this._border+"Width"],
10))}this.applySize(a.size,!0);this.isInternal()||Ha.on.show.dispatch(this.id,this._edge,b.offsetWidth,b.offsetHeight)}this.dispatchSize(a.refresh)};e.hide=function(){this._visible&&(this._visible=!1,this._toolbar.css("display",null),this.applySize(),this.isInternal()||Ha.on.hide.dispatch(this.id,this._edge))};e.size=function(){return"width"===this._dimension?this._toolbar.innerWidth:this._toolbar.innerHeight};e.setSize=function(a){if("auto"===a)this._toolbar.css(this._dimension,null),this._autoSize=
!0,this.applySize();else{this._visible&&void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._toolbar.css(this._dimension,a);this._autoSize=!1;switch(this._edge){case "top":case "bottom":this._resizeHandle&&(a-=this._resizeHandle.offsetHeight);break;case "left":case "right":this._resizeHandle&&(a-=this._resizeHandle.offsetWidth)}this.applySize(a)}};e.applySize=function(a,b,c){if(void 0!==a||void 0===this._startSize){var d=this._toolbar,e=this._content,f=this._toolsElem,k=this._frame;if(this._visible){this._autoSize&&
d.removeCSS(["bottom","top","right","left",this._dimension]);if(void 0===a){switch(this._edge){case "top":case "bottom":this._autoSize?this._size=f.offsetHeight:(this._size=d.offsetHeight,this._resizeHandle&&(this._size-=this._resizeHandle.offsetHeight));break;case "left":case "right":this._autoSize?this._size=f.offsetWidth:(this._size=d.offsetWidth,this._resizeHandle&&(this._size-=this._resizeHandle.offsetWidth))}a=this._size}void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._collapseSize&&
(a<this._collapseSize?this._collapsed||(this._collapseHeader.css("display","block"),this._toolsParent.css("display","none"),this._collapsed=!0):this._collapsed&&(this._collapseHeader.css("display",null),this._toolsParent.css("display",null),this._collapsed=!1));void 0!==this._borderSize&&(a+=this._borderSize);var f=k.clientWidth,k=k.clientHeight,u=v.rootNode.clientWidth-10,p=v.rootNode.clientHeight-10;switch(this._edge){case "top":this._visible&&this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,
a>p&&(a=p));d.css("bottom",k-a+"px");this._overlay||e.css("top",a+"px");break;case "bottom":this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>p&&(a=p));d.css("top",k-a+"px");this._overlay||e.css("bottom",a+"px");break;case "left":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,a>u&&(a=u));d.css("right",f-a+"px");this._overlay||e.css("left",a+"px");break;case "right":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,a>u&&(a=u)),d.css("left",f-a+"px"),this._overlay||e.css("right",
a+"px")}}else if(!this._overlay)switch(this._edge){case "top":e.css("top",0);break;case "bottom":e.css("bottom",0);break;case "left":e.css("left",0);break;case "right":e.css("right",0)}!0!==b&&this.dispatchSize(c)}};e.dispatchSize=function(a){var b=0,c=0;this._visible&&(this._collapsed?(b=this._collapseHeader.clientWidth,c=this._collapseHeader.clientHeight):(b=this._toolsParent.clientWidth,c=this._toolsParent.clientHeight));if(a||b!=this._width||c!=this._height)this._width=b,this._height=c,la.dispatchResize(),
this.isInternal()?Ha.on.resizeinternal.dispatch(this.id,this._edge,b,c,this._collapsed):Ha.on.resize.dispatch(this.id,this._edge,b,c)};return b}(),Xc=function(){return function(){var b,e,a,d,c,f=[],k,t,r,w;this.show=function(){b&&b.show()};this.hide=function(){b&&b.hide()};this.length=function(){return f.length};this.addPrevNext=function(b,f){if(!d){d=new Yb("\u25c4",U.PAGE_UP);b&&(d.onclick(b),d.ontap(b));c=new Yb("\u25ba",U.PAGE_DOWN);f&&(c.onclick(f),c.ontap(f));var k=y.create("div","oit-tab-nextprev");
k.append(d,c);e.append(k);(k=k.size())&&k.width&&a.css("right",k.width+"px")}};this.addTab=function(b,c,d,e){var k=y.create("div","oit-tab");k.html("<div>"+b+"</div>");c&&k.addClass("oit-hidden");a.append(k);f.push(k);if(d instanceof Function)k.on("click",null,n,d,e).on("tap",null,n,d,e);return f.length-1};var n=function(a,b,c){b(c)};this.showTab=function(a){0<=a&&a<f.length&&(f[a].css("display",null),l())};this.hideTab=function(a){0<=a&&a<f.length&&(f[a].css("display","none"),l())};this.tabClass=
function(a,b){if(0<=a&&a<f.length){if(f[a].customClass){if(f[a].customClass===b)return;f[a].removeClass(f[a].customClass);delete f[a].customClass}b&&(f[a].addClass(b),f[a].customClass=b)}};this.setActiveTab=function(b){if(0<=b&&b<f.length&&b!=k&&(void 0!=k&&f[k].removeClass("oit-tab-selected"),k=b,f[k].addClass("oit-tab-selected"),l(),void 0!==k)){b=f[k].rect(e);var c=a.rect(e),d=c.left;b.right>c.right?d-=b.right-c.right:0>b.left&&(d-=b.left);0<=d?a.css("left",null):a.css("left",d+"px")}};this.tabRect=
function(a){if(0<=a&&a<f.length){a=f[k].rect(v.rootNode);a=new ja(a,"view");var b=v.viewNode.rect(v.rootNode);a.offset(-b.left,-b.top);return a}};this.destroy=function(){b&&Ha.removeInternal(-2);e&&e.destroy();f=c=d=a=e=b=null};var l=function(){if(d){for(var a,b,e=0;e<f.length;e++)"none"!==f[e].css("display")&&(b=e,void 0===a&&(a=e));d.disabled=k<=a;c.disabled=k>=b}};e=y.create("div","oit-tab-bar");a=y.create("div","oit-tab-list");e.append(a);a.kinetic(!0);a.ondragstart(function(b){b=a.rect(e);t=
b.left;r=b.right;w=f[f.length-1].rect(e).right;return!1});a.ondragmove(function(b){var c=b.delta.x;b=t+c;0>b&&(c=w+c,c<r&&(b+=r-c));0<b&&(b=0);a.css("left",b+"px");return!1});b=new Nb(-2,"bottom",e,null,Ha.internalParent(-2));Ha.addInternal(-2,b);b.show()}}(),pd=function(){return function(){var b,e,a;this.show=function(){b&&b.show()};this.hide=function(){b&&b.hide()};this.enable=function(){a.attr("disabled",null)};this.disable=function(){a.attr("disabled","disabled")};this.setText=function(b){b?a.attr("value",
b):a.attr("value","")};this.destroy=function(){b&&Ha.removeInternal(-4);e&&e.destroy();a=e=b=null};e=y.create("div","oit-formula-bar");var d=y.create("div","oit-formula-padding");a=y.create("input","oit-formula-text");a.attr("type","text");a.attr("readonly","readonly");d.append(a);e.append(d);b=new Nb(-4,"top",e,null,Ha.internalParent(-4));Ha.addInternal(-4,b);b.show()}}(),za=function(){var b=function(a,b,e){this._size=b;this._hidden=!1;a?(this._hidden=!0===a.hidden,void 0!==a.h?this._size=a.h:void 0!==
a.w&&(this._size=a.w),this._title=void 0!==a.t?a.t:e,void 0!==a.st&&(this._styleIndex=a.st),this._acc=a.acc,this._accend=a.accend):this._title=e;this._originalHidden=this._hidden;this._originalSize=this._size},e=V(b);e.clone=function(){var a=new b(null,this._size,this._title);a._size=this._size;a._originalSize=this._originalSize;a._hidden=this._hidden;a._originalHidden=this._originalHidden;a._title=this._title;void 0!==this._styleIndex&&(a._styleIndex=this._styleIndex);void 0!==this._acc&&(a._acc=
this._acc);void 0!==this._accend&&(a._accend=this._accend);void 0!==this._revisions&&(a._revisions=this._revisions);void 0!==this._deleted&&(a._deleted=this._deleted);this._data&&(a._data=this._data.slice(0));a.clonedFrom=this;return a};e.title=function(){return this._title};e.style=function(){return this._styleIndex};e.revision=function(a){void 0!==a&&(this._revisions||(this._revisions=[],this.clonedFrom&&(this.clonedFrom._revisions=this._revisions)),this._revisions.push(a),"delete_col"===a.type||
"delete_row"===a.type)&&(this._deleted=!0);return this._revisions};e.setCellData=function(a){var b;this._data=a;if(void 0===this._acc){for(a=0;a<this._data.length;a++)if((b=this._data[a])&&b.t&&void 0!==b.a){this._acc=b.a;break}if(void 0!=this._acc)for(a=this._data.length-1;0<=a;a--)if((b=this._data[a])&&b.t&&void 0!==b.a){this._accend=b.a+b.t.length-1;break}}};e.hidden=function(){return this._hidden};e.originalHidden=function(){return this._originalHidden};e.deleted=function(){return!!this._deleted};
e.show=function(a){return this._hidden||5>this._size?(this._hidden=!1,5>this._size&&(this._size=a),!0):!1};e.reset=function(){var a=!1;void 0!=this._originalSize&&(this._size=this._originalSize,a=!0);!this._hidden&&this._originalHidden&&(a=this._hidden=!0);return a};e.size=function(){return this._hidden?0:this._size};e.setSize=function(a){if("number"!==typeof a)throw"Invalid argument to setSize";this._size=a;this._hidden=0===a};e.getCellsForRange=function(a,b){if(this._data&&void 0!==this._acc&&a<=
this._accend&&b>=this._acc){for(var c,d=0;d<this._data.length;d++){var e=this._data[d];e&&e.t&&void 0!==e.a&&a<=e.a+e.t.length&&b>=e.a&&(c||(c=[]),c.push(e))}return c}};e.getIndexForCell=function(a){if(this._data){for(var b=0,d=0;d<this._data.length;d++){var e=this._data[d];if(e&&e==a)break;e&&e.e?b+=e.e:b++}return b}};var a=function(a,b){if(a._data){if(void 0===a._getCellIndex||b<a._getCellIndex)if(a._cellDataIndex=0,a._getCellIndex=0,a._getCellEmpty=0,0<a._data.length){var c=a._data[0];c?c.e&&(a._getCellEmpty=
c.e):a._getCellEmpty=1}for(;a._getCellIndex<b;){0<a._getCellEmpty&&a._getCellEmpty--;if(0===a._getCellEmpty){a._cellDataIndex++;if(a._cellDataIndex>=a._data.length){a._getCellIndex=b;return}c=a._data[a._cellDataIndex];a._getCellEmpty=c?c.e||0:1}a._getCellIndex++}if(a._cellDataIndex<a._data.length)return a._cellDataIndex}};e.getCell=function(b){b=a(this,b);if(void 0!==b)return this._data[b]};e.insertCell=function(b){this._data&&void 0!==a(this,b)&&this._data.splice(this._cellDataIndex,0,null)};return b}(),
ld=function(){var b={add_row:!0,delete_row:!0},e={add_col:!0,delete_col:!0},a={add_row:!0,delete_row:!0,add_col:!0,delete_col:!0,new_cell:!0,clear_cell:!0,modify_cell:!0,move_cells:!0},d=function(a,b,c){this._page=c;this._top=this._left=null;this._extRowCount=this._extColCount=this._bottom=this._right=void 0;this._merged=null;this._ajaxLoading=this._ajaxPending=0;this._hideMsg=!1;this._cellGridChanged=!0;this._showAnnotations=!1;this._fonts=a.sheet.fonts;this._styles=a.styles;a.formulas&&(this._formulas=
a.formulas);a.sheet.hasOwnProperty("s")?this._sheetStyle=this.cellStyle(a.sheet.s):this._sheetStyle={};this._colMajor="colmajor"===a.sheet.order;this._defColWidth=a.sheet.defcw||80;this._defRowHeight=a.sheet.defrh||20;a.cols||(a.cols=[]);a.rows||(a.rows=[]);this._colCount=0<a.sheet.c?a.sheet.c:a.cols.length;this._rowCount=0<a.sheet.r?a.sheet.r:a.rows.length;this._cols=[];for(var d=0;d<a.cols.length;d++){var e=a.cols[d];if(void 0!==e.s)for(var g=e.e||e.s,h=e.s;h<=g;h++)c=La(h),this._cols[h]=new za(e,
this._defColWidth,c);else c=La(d),this._cols[d]=new za(e,this._defColWidth,c)}this._rows=[];for(d=0;d<a.rows.length;d++)if(e=a.rows[d],void 0!==e.s)for(g=e.e||e.s,h=e.s;h<=g;h++)c=Za(h),this._rows[h]=new za(e,this._defRowHeight,c);else c=Za(d),this._rows[d]=new za(e,this._defRowHeight,c);a.cells&&k(this,a.cells);if(a.data)for(this._data=a.data,a=0;a<this._data.length;a++)c=this._data[a],c.f&&this._ajaxPending++,c.iend=a+1<this._data.length?this._data[a+1].i-1:this._colMajor?this._colCount:this._rowCount;
this._embeds=b},c=V(d);c.showAnnotations=function(a){if(void 0!==a){var b=!1;!0!==a&&(a=!1);!0===a&&(this._annoRows||this._annoCols)?(this._annoRows&&this._rows!==this._annoRows&&(this._rows=this._annoRows,this._rowCount=this._annoRowCount,b=!0),this._annoCols&&this._cols!==this._annoCols&&(this._cols=this._annoCols,this._colCount=this._annoColCount,b=!0)):(this._normalRows&&this._rows!==this._normalRows&&(this._rows=this._normalRows,this._rowCount=this._normalRowCount,b=!0),this._normalCols&&this._cols!==
this._normalCols&&(this._cols=this._normalCols,this._colCount=this._normalColCount,b=!0));b&&(this._top=this._left=null,this._extRowCount=this._extColCount=this._bottom=this._right=void 0,this._cellGridChanged=!0,this._showAnnotations=a)}return this._showAnnotations};c.cellGridChanged=function(a){void 0!==a&&(this._cellGridChanged=!!a);return this._cellGridChanged};c.getCellText=function(a,b){var c=this.getCell(a,b);return c?c.t||c.v||"":""};c.getCellComments=function(a,b,c){var d,e=this._page.comments();
if(e)for(var g=0;g<e.length;g++){var h=e[g];if("cell"===h.type&&h.range&&"cell"===h.range.type){var f=h.range;this._showAnnotations&&h.annoRange&&(f=h.annoRange);a>=f.c1&&a<=f.c2&&b>=f.r1&&b<=f.r2&&(!c||f.c2==a&&f.r1==b)&&(d||(d=[]),d.push(h))}}return d};c.updateDimensions=function(){this._right=this.colLeft(this._colCount);this._bottom=this.rowTop(this._rowCount);this._extColCount=this._colCount;this._extRowCount=this._rowCount;var a=this.embeddingCount();if(a){for(var b=0;b<a;b++){var c=this.embed(b);
if(c){if(!c.expansionApplied){var d=this.embed(b);if(d.node&&!d.originApplied){d.originApplied=!0;d.adjustX=0;d.adjustY=0;var e=d.node.data("origin");e&&(e=e.split(","),2==e.length&&(d.adjustX=Number(e[0]),d.adjustY=Number(e[1])))}}var f=this.colWidth(c.c1),k=this.rowHeight(c.r1),l=c.x1,n=c.y1;l>f&&(l=f);n>k&&(n=k);d=this.colLeft(c.c1)+l;e=this.rowTop(c.r1)+n;c.position={left:d,top:e};void 0===c.c2?(c.position.right=d+c.w,c.position.bottom=e+c.h):(f=this.colWidth(c.c2),k=this.rowHeight(c.r2),l=c.x2,
n=c.y2,l>f&&(l=f),n>k&&(n=k),f=this.colLeft(c.c2)+l,n=this.rowTop(c.r2)+n,f<d&&(f=d),n<e&&(n=e),c.position.right=f,c.position.bottom=n);c.position.right>this._right&&(this._right=c.position.right);c.position.bottom>this._bottom&&(this._bottom=c.position.bottom)}}this._extColCount=this.colFromX(this._right)+1;this._extRowCount=this.rowFromY(this._bottom)+1;this._right=this.colLeft(this._extColCount);this._bottom=this.rowTop(this._extRowCount)}};c.unload=function(){oa(this._data,function(a){a.ajax&&
eb(a.ajax)});this._embeds=this._styles=this._fonts=this._sheetStyle=this._merged=this._rows=this._cols=this._data=null};c.sheetStyle=function(){return this._sheetStyle};c.webFonts=function(){return this._fonts};c.getFormulaText=function(a,b){var c=this.getCell(a,b);if(c){if(!c.fa&&void 0!==c.fm){var d;a:{if(this._formulas&&(d=this.getCell(a,b))&&"number"==typeof d.fm&&0<=d.fm&&d.fm<this._formulas.length){d=this._formulas[d.fm];break a}d=void 0}if(d){var e,h=b,f=d.f,k=0,z=0;e=a;if(this._showAnnotations)for(var l=
0;l<e;l++){var n=this._cols[l];n&&n.title()==U.DEL&&e--}if(this._showAnnotations)for(l=0;l<h;l++)(n=this._rows[l])&&n.title()==U.DEL&&h--;c.fr||(k=e-d.c,z=h-d.r);d=qd(f,k,z,E.externalLinks());c.fa="="+d;c.fr&&(c.fa="{"+c.fa+"}")}}return c.fa}};c.showHidden=function(a){if(a){this._showHidden||(this._showHidden={columns:!1,rows:!1});if("string"===typeof a)switch(a){case "all":this._showHidden.columns=!0;this._showHidden.rows=!0;break;case "none":this._showHidden.columns=!1;this._showHidden.rows=!1;
break;case "columns":this._showHidden.columns=!0;break;case "rows":this._showHidden.rows=!0}else void 0!==a.sheets&&void 0!==a.columns&&void 0!==a.rows&&(this._showHidden.columns=a.columns,this._showHidden.rows=a.rows);this.cellGridChanged(!0)}return this._showHidden};c.embeddingCount=function(){return this._embeds?this._embeds.length:0};c.embed=function(a){if(this._embeds&&0<=a&&a<this._embeds.length)return(a=this._embeds[a])&&!a.node&&(a.node=y.byId(a.id),!a.node||a.node.hasClass("oit-svg-embed")||
a.node.hasClass("oit-image-embed")||(a.node=a.node.parent())),a};c.embedByUID=function(a){return ab(this._embeds,"uid",a)};c.getCell=function(a,b){var c,d;this._colMajor?(d=this._cols[a])&&(c=d.getCell(b)):((d=this._rows[b])&&(c=d.getCell(a)),!c&&this._showAnnotations&&(d=this._cols[a])&&(c=d.getCell(b)));return c||null};c.cellFromPos=function(a,b,c){this._right&&this._bottom||this.updateDimensions();a=this.colFromX(a);b=this.rowFromY(b);a>=this._extColCount&&(a=this._extColCount-1);b>=this._extRowCount&&
(b=this._extRowCount-1);!1!==c&&(c=this.getMergedCell(a,b))&&(a=c.range.c1,b=c.range.r1);return sa(a,b)};c.prevTextCell=function(a,b){var c,d,e,h=a-50;0>h&&(h=0);if(this._colMajor)for(e=a-1;e>=h;e--){if((d=this._cols[e])&&(d=d.getCell(b))&&(d.t||d.v)){c=e;break}}else{var f=this._rows[b];if(f)for(e=a-1;e>=h;e--)if((d=f.getCell(e))&&(d.t||d.v)){c=e;break}}return c};c.cellStyle=function(a){return this._styles&&void 0!==a&&0<=a&&a<this._styles.length?this._styles[a]:{}};c.rowCount=function(){void 0===
this._bottom&&this.updateDimensions();return this._extRowCount};c.colCount=function(){void 0===this._right&&this.updateDimensions();return this._extColCount};c.eachRow=function(a){for(var b in this._rows)a(Number(b))};c.eachCol=function(a){for(var b in this._cols)a(Number(b))};c.rowHeight=function(a){return(a=this._rows[a])?a.size():this._defRowHeight};c.colWidth=function(a){return(a=this._cols[a])?a.size():this._defColWidth};c.setRowHeight=function(a,b){var c=this._rows[a];c||(c=Za(a),this._rows[a]=
c=new za(null,this._defRowHeight,c));c.setSize(b);this._top=null;this._right=void 0;this.cellGridChanged(!0)};c.setColWidth=function(a,b){var c=this._cols[a];c||(c=La(a),this._cols[a]=c=new za(null,this._defColWidth,c));c.setSize(b);this._left=null;this._bottom=void 0;this.cellGridChanged(!0)};c.showRow=function(a){return(a=this._rows[a])&&a.show(this._defRowHeight)?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};c.showCol=function(a){return(a=this._cols[a])&&a.show(this._defColWidth)?
(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};c.resetRow=function(a){return(a=this._rows[a])&&a.reset()?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};c.resetCol=function(a){return(a=this._cols[a])&&a.reset()?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};c.colHidden=function(a){return(a=this._cols[a])?a.hidden():!1};c.colOriginalHidden=function(a){return(a=this._cols[a])?a.originalHidden():!1};c.rowHidden=function(a){return(a=this._rows[a])?
a.hidden():!1};c.rowOriginalHidden=function(a){return(a=this._rows[a])?a.originalHidden():!1};c.colDeleted=function(a){return(a=this._cols[a])?a.deleted():!1};c.rowDeleted=function(a){return(a=this._rows[a])?a.deleted():!1};c.colStyle=function(a){return(a=this._cols[a])?this.cellStyle(a.style()):{}};c.rowTop=function(a){if(!this._top){this._top=[];for(var b=0,c=0;c<=this._rows.length;c++){this._top.push(b);var d=this._rows[c],b=d?b+d.size():b+this._defRowHeight}}if(a<this._top.length)return this._top[a];
b=this._top.length-1;return this._top[b]+(a-b)*this._defRowHeight};c.rowBottom=function(a){return this.rowTop(a+1)};c.rowFromY=function(a){for(var b=0;a>this.rowBottom(b);)b++;for(;!this.rowHeight(b)&&0<b;)b--;return b};c.colLeft=function(a){if(!this._left){this._left=[];for(var b=0,c=0;c<=this._cols.length;c++){this._left.push(b);var d=this._cols[c],b=d?b+d.size():b+this._defColWidth}}if(a<this._left.length)return this._left[a];b=this._left.length-1;return this._left[b]+(a-b)*this._defColWidth};
c.colRight=function(a){return this.colLeft(a+1)};c.colFromX=function(a){for(var b=0;a>this.colRight(b);)b++;for(;!this.colWidth(b)&&0<b;)b--;return b};c.sheetRight=function(){void 0===this._right&&this.updateDimensions();return this._right};c.sheetBottom=function(){void 0===this._bottom&&this.updateDimensions();return this._bottom};c.colTitle=function(a,b){var c,d=this._cols[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedCols&&a>=this._colCount&&(a-=this._deletedCols),!1!==b&&(c=La(a)));
return c};c.rowTitle=function(a,b){var c,d=this._rows[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedRows&&a>=this._rowCount&&(a-=this._deletedRows),!1!==b&&(c=Za(a)));return c};c.colType=function(a){var b;(a=this._cols[a])&&(b=a.type());return b};c.rowType=function(a){var b;(a=this._rows[a])&&(b=a.type());return b};c.getMergedCell=function(a,b){var c;if(this._merged)for(var d=0;d<this._merged.length;d++){var e=this._merged[d].range;if(a>=e.c1&&a<=e.c2&&b>=e.r1&&b<=e.r2){c=this._merged[d];
break}}return c};c.containsRange=function(a,b){if(this._colMajor)for(var c in this._cols){var d=this._cols[Number(c)];if(d&&d.getCellsForRange(a,b))return!0}else for(d in this._rows)if((c=this._rows[Number(d)])&&c.getCellsForRange(a,b))return!0;return!1};c.getCellsForRange=function(a,b){var c,d;if(this._colMajor)for(var e in this._cols){var h=this._cols[Number(e)];h&&(d=h.getCellsForRange(a,b))&&(c=c?c.concat(d):d)}else for(h in this._rows)(e=this._rows[Number(h)])&&(d=e.getCellsForRange(a,b))&&(c=
c?c.concat(d):d);return c};c.select=function(a){var b=!1,c,d;if(a&&"text"===a.type){if(0!==Ta(a,this._selectedRange)&&(this.select(null),c=this._selectedCells=this.getCellsForRange(a.acc,a.accend))){this._selectedRange=ga(a);for(d=0;d<c.length;d++)b=c[d],b.selection=a,b.highlightsChanged=!0;b=!0}}else if(this._selectedCells){c=this._selectedCells;delete this._selectedCells;delete this._selectedRange;for(d=0;d<c.length;d++)b=c[d],delete b.selection,b.highlightsChanged=!0;b=!0}return b};c.addHighlight=
function(a){var b=!1,c,d;if(a)if("text"===a.range.type){var e=this.getCellsForRange(a.range.acc,a.range.accend);if(e){for(d=0;d<e.length;d++)c=e[d],c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);b=!0}!b&&this.hasPendingContent()&&(this.loadRange(a.range),b=!0)}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(e=this.mapToText(a.range)))for(d=0;d<e.length;d++)if(c=e[d],c=this.getCell(c.cell.c,c.cell.r))c.highlights?
-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);return b};c.updateHighlight=function(a){var b;if(a)if("text"===a.range.type){var c=this.getCellsForRange(a.range.acc,a.range.accend);if(c)for(a=0;a<c.length;a++)c[a].highlightsChanged=!0}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(c=this.mapToText(a.range)))for(a=0;a<c.length;a++)if(b=c[a],b=this.getCell(b.cell.c,b.cell.r))b.highlightsChanged=!0};c.removeHighlight=function(a){if(a){var b,
c;if("text"==a.range.type){var d=this.getCellsForRange(a.range.acc,a.range.accend);if(d){for(c=0;c<d.length;c++)b=d[c],b.highlights&&(Fa(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0);return!0}}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(d=this.mapToText(a.range)))for(c=0;c<d.length;c++)b=d[c],(b=this.getCell(b.cell.c,b.cell.r))&&b.highlights&&(Fa(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0)}return!1};c.expandRange=
function(a){a=ga(a);if(this._merged){var b;do{b=!1;for(var c=0;c<this._merged.length;c++){var d=this._merged[c];a.c1<=d.range.c2&&a.c2>=d.range.c1&&a.r1<=d.range.r2&&a.r2>=d.range.r1&&(d.range.c1<a.c1&&(a.c1=d.range.c1,b=!0),d.range.r1<a.r1&&(a.r1=d.range.r1,b=!0),d.range.c2>a.c2&&(a.c2=d.range.c2,b=!0),d.range.r2>a.r2&&(a.r2=d.range.r2,b=!0))}}while(b)}return a};c.getHoverText=function(){if(!x.showCellTooltips||this.isRangeSelected())return null;var a=P.cellSelection();return(a=this.getCell(a.c1,
a.r1))&&a.clipped?a.t||a.v:null};c.isRangeSelected=function(){var a=!1,b=P.cellSelection();if(b&&(b.c1!=b.c2||b.r1!=b.r2)&&(a=!0,this._merged))for(var c=0;c<this._merged.length;c++){var d=this._merged[c];if(b.c1==d.range.c1&&b.c2==d.range.c2&&b.r1==d.range.r1&&b.r2==d.range.r2){a=!1;break}}return a};c.getSelectedText=function(){var a="",b;switch(P.selectionType()){case "text":if(this._selectedCells){b=P.textSelection();for(var c=this._selectedCells,d=0;d<c.length;d++){var e=c[d];if(e.t){var f=b.acc-
e.a;0>f&&(f=0);var k=b.accend-e.a;k>f&&(a&&(a+="\t"),a+=e.t.substring(f,k))}}}break;case "cell":if(b=P.cellSelection(),this.isRangeSelected())for(c=0,d=b.r1;d<=b.r2;d++){e=0;for(f=b.c1;f<=b.c2;f++){if(k=this.getCellText(f,d)){if(0<c)for(1E3<c&&(c=1E3);0<c;c--)a+="\r\n";if(0<e)for(1E3<e&&(e=1E3);0<e;e--)a+="\t";a+=k}e++}c++}else a=this.getCellText(b.c1,b.r1)||""}return a};c.mapToCells=function(a){if("text"==a.type){var b=[],c=a.acc;a=a.accend;if(this._colMajor)for(var d in this._cols){var e=Number(d),
h=e,e=this._cols[e],f=b;if(e){var k=e.getCellsForRange(c,a);if(k)for(var l=0;l<k.length;l++){var n=e.getIndexForCell(k[l]),C=this.getMergedCell(h,n);C?f.push(ga(C.range)):f.push(sa(h,n))}}}else for(h in this._rows)if(d=e=Number(h),e=this._rows[e],f=b,e&&(k=e.getCellsForRange(c,a)))for(l=0;l<k.length;l++)n=e.getIndexForCell(k[l]),(C=this.getMergedCell(n,d))?f.push(ga(C.range)):f.push(sa(n,d));return b}};c.mapToText=function(a){if("cell"==a.type){var b;a=f(a);for(var c=a.r1;c<=a.r2;c++)for(var d=a.c1;d<=
a.c2;d++){var e=this.getCell(d,c);if(e&&e.t&&void 0!==e.a){var h=e.a+e.t.length;b||(b=[]);e=ka(e.a,h);e.cell={c:d,r:c};b.push(e)}}return b}};c.decomposeRange=function(a,b){if("cell"==a.type){a=f(a);var c=this.mapToText(a);if(b)c?c.push(a):c=[a];else{for(var d=[],e=a.r1;e<=a.r2;e++)for(var h=null,k=a.c1;k<=a.c2;k++){var l=this.getCell(k,e);l&&l.v&&(h&&h.c2==k-1?h.c2=k:(h=sa(a.page,k,e,k,e),d.push(h)))}if(0<d.length)for(c||(c=[]),e=0;e<d.length;e++)if(h=d[e]){for(k=e+1;k<d.length;k++)(l=d[k])&&l.r1==
h.r2+1&&l.c1==h.c1&&l.c2==h.c2&&(h.r2=l.r2,d[k]=null);c.push(h)}}return c}};var f=function(a){var b=a;if("cell"==a.type&&a.offsets){var b=a.c1,c=a.c2,d=a.r1,e=a.r2,h;b>c&&(h=b,b=c,c=h);d>e&&(h=d,d=e,e=h);0>a.offsets.left&&0<b&&b--;0<a.offsets.right&&c++;0>a.offsets.top&&0<d&&d--;0<a.offsets.bottom&&e++;b=sa(a.page,b,d,c,e)}return b},k=function(a,b){var c,d,e,h=a._colMajor?a._cols:a._rows;c=0;var f,k=[];for(e=0;e<b.length;e++){var l=b[e];l instanceof Array?f=c:(c=l.i,f=l.e||l.i,l=l.d);var n;n=a._colMajor?
new za(null,a._defColWidth,null):new za(null,a._defRowHeight,null);for(var C=c;C<=f;C++){h[C]||(h[C]=n);h[C].setCellData(l);for(var z=0,q=0;z<l.length;z++){d=l[z];d.fr&&k.push(d);if(d.mh||d.mv)a._merged||(a._merged=[]),c=a._colMajor?sa(C,q,C,q):sa(q,C,q,C),d.mh&&(c.c2+=d.mh),d.mv&&(c.r2+=d.mv),a._merged.push({cell:d,range:c});d.e?q+=d.e:q++}}c=f+1}for(e=0;e<k.length;e++)for(d=k[e],c=Ib(d.fr),h=c.c1;h<=c.c2;h++)for(f=c.r1;f<=c.r2;f++)(l=a.getCell(h,f))&&l!==d&&(l.fr=d.fr,l.fm=d.fm)},t=function(a,b,
c,d,e,f,l){f.loaded=!0;delete f.ajax;0===--e._ajaxLoading&&e._hideMsg&&(Ba.hideMessage(),e._hideMsg=!1);if(200===d){var g=JSON.parse(c);g.cells&&(k(e,g.cells),L.each(function(a){e.addHighlight(a);L.link(a)},e._page),F.update(!0))}else e.logAJAXError(null,"Failed to load the spreadsheet data for sheet "+(e._page+1)+" from the server",a,d,c);if(l){for(var g=[e],h=7;h<arguments.length;h++)g.push(arguments[h]);l.apply(null,g)}},r=function(a,b,c){if(b.f&&!b.loaded&&!b.ajax){var d=b.f;"/"!=d.charAt(0)&&
(d=Ma(v.baseURL,d));b.ajax=Ja({url:d,context:a,complete:t,args:Array.prototype.slice.call(arguments)});a._ajaxPending--;a._ajaxLoading++;1!=a._ajaxLoading||Ba.messageVisible()||(Ba.showMessage(U.PLEASE_WAIT_DOWNLOADING),a._hideMsg=!0)}};c.hasPendingContent=function(){return this._data||0<this._ajaxPending||0<this._ajaxLoading};c.loadRange=function(a,b){if(this._data)switch(a.type){case "text":var c=this.mapToCells(a);c&&0!==c.length||ea(w,0,this,this,a,b);break;case "cell":this.loadDataForCells(a.c1,
a.r1,a.c2,a.r2,!1,b)}b&&b(a)};var w=function(a,b,c){var d=a.mapToCells(b);if(d&&0<d.length)c&&c(b);else for(d=0;d<a._data.length;d++){var e=a._data[d];if(e&&!e.loaded&&!e.ajax){r(a,e,w,b,c);break}}};c.loadDataForCells=function(a,b,c,d,e,f){if(void 0===a||void 0===b||void 0===c||void 0===d)f&&f();else if(this._data){this._colMajor||(a=b,c=d);e&&this._deferredTimer&&(ua(this._deferredTimer),delete this._deferredTimer);var g;for(d=0;d<this._data.length;d++)if((b=this._data[d])&&!b.loaded&&!b.ajax){if(b.i>
c)break;if(b.iend>=a){var h=!1;if(this._colMajor)for(var k=b.i;k<=b.iend;k++){if(!this.colHidden(k)){h=!0;break}}else for(k=b.i;k<=b.iend;k++)if(!this.rowHidden(k)){h=!0;break}h&&(g||(g=[]),g.push(b))}}g?e?this._deferredTimer=ea(n,200,this,g,f):n.call(this,g,f):f&&f()}else f&&f()};var n=function(a,b){for(var c=0;c<a.length;c++)r(this,a[c],b)},l=function(a){var b;if(a&&void 0!==a.sheet){var c=A.page(a.sheet);if(c&&c.isLoaded()){var d=c.spreadsheetModel();if(d){b=a.c1;var e=a.r1,f=a.c2,h=a.r2,k=a=!1;
void 0===b?(b=0,f=d.colCount()-1,a=!0):void 0===f&&(f=b);void 0===e?(e=0,h=d.rowCount()-1,k=!0):void 0===h&&(h=e);b=sa(c.index,b,e,f,h);a&&(b.selectingRows=!0);k&&(b.selectingCols=!0)}}}return b},u=function(a,b,c){for(a=0;a<b.cells.length;a++){c=b.cells[a];var d=l(c.ref);d&&(delete c.ref,c.range=d)}},p=function(a){for(var b={t:""},c=0;c<a.text.length;c++){var d=a.text[c];if(d.range){var e=na.getRawText(d.range.acc,d.range.accend);e&&(b.t+=e,b.a||(b.a=d.range.acc))}else d.text&&(b.t+=d.text,delete b.a)}return b},
J=function(a,b,c){b.resolved||(b.ref&&(void 0===b.ref.sheet||b.page||(b.page=A.page(b.ref.sheet)),b.range=l(b.ref),b.range&&delete b.ref),b.oldref&&(b.oldrange=l(b.oldref),b.oldrange&&delete b.oldref),b.user&&(c&&(b.author=c[b.user]),delete b.user),b.ref||b.oldref||(b.resolved=!0));b.resolved&&b.page&&b.page===a._page&&(a._revisions||(a._revisions=[]),-1==a._revisions.indexOf(b)&&(a._revisions.push(b),"delete_row"===b.type?a._deletedRows++:"delete_col"===b.type&&a._deletedCols++))},W=function(a,b){var c=
b.indexOf(a);if(-1==c)for(var d in b){var e=b[d];if(e&&e.clonedFrom&&e.clonedFrom===a){c=parseInt(d,10);break}}return c},T=function(a,b){if(b&&(b.col||b.row)){var c=ga(b),d,e=c.c1==c.c2,f=c.r1==c.r2;b.col&&(a._annoCols&&(d=W(b.col,a._annoCols),-1!=d&&(c.c1=d)),delete b.col);b.col2?(a._annoCols&&(d=W(b.col2,a._annoCols),-1!=d&&(c.c2=d)),delete b.col2):e&&(c.c2=c.c1);b.row&&(a._annoRows&&(d=W(b.row,a._annoRows),-1!=d&&(c.r1=d)),delete b.row);b.row2?(a._annoRows&&(d=W(b.row2,a._annoRows),-1!=d&&(c.r2=
d)),delete b.row2):f&&(c.r2=c.r1);return c}};c.processRevisions=function(a,b,c){var d=!1;if(a&&a.revisions){var e=this,g;e._deletedCols=0;for(g=e._deletedRows=0;g<a.revisions.length;g++)J(e,a.revisions[g],a.users);if(e._revisions){a=sa(e._page.index,0,0,0,0);for(g=0;g<e._revisions.length;g++)d=e._revisions[g],Fb(a,d.range),Fb(a,d.oldrange);e.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,function(){var a,d=e._cols.slice(0),g=e._rows.slice(0);e._normalColCount=e._colCount;e._annoColCount=e._colCount+e._deletedCols;
e._normalCols=e._cols;e._annoCols=e._cols.slice(0);e._normalRowCount=e._rowCount;e._annoRowCount=e._rowCount+e._deletedRows;e._normalRows=e._rows;e._annoRows=e._rows.slice(0);for(a=e._revisions.length-1;0<=a;a--){var f=e._revisions[a],h,k,l,m=e;k=f;f=f.range;h=d;var n=g;if(f)switch(k.type){case "add_row":f.row=n[f.r1];f.row||(l=Za(f.r1),f.row=n[f.r1]=new za(null,m._defRowHeight,l),m._annoRows[f.r1]||(m._annoRows[f.r1]=f.row));f.col=h[f.c1];f.col2=h[f.c2];f.row.revision(k);n.splice(f.r1,1);break;case "add_col":f.col=
h[f.c1];f.col||(l=La(f.c1),f.col=h[f.c1]=new za(null,m._defColWidth,l),m._annoCols[f.c1]||(m._annoCols[f.c1]=f.col));f.row=n[f.r1];f.row2=n[f.r2];f.col.revision(k);h.splice(f.c1,1);break;case "delete_row":l=f;var z=m,r=k,D=new za(null,z._defRowHeight,U.DEL);D.revision(r);r.target=D;u(z,r,D);for(var z=0,t=[],G=0;G<r.cells.length;G++){var w=r.cells[G];w.range.c1>z&&(t.push({e:w.range.c1-z}),z=w.range.c1);t.push(p(w));z++}D.setCellData(t);l.row=D;f.col=h[f.c1];f.col2=h[f.c2];for(f.row.revision(k);f.r1>
n.length;)n.push(null);n.splice(f.r1,0,f.row);h=0<f.r1?(h=n[f.r1-1])?m._annoRows.indexOf(h)+1:f.r1:(h=n[f.r1+1])?m._annoRows.indexOf(h):f.r1;for(;h>m._annoRows.length;)m._annoRows.push(null);m._annoRows.splice(h,0,f.row);if(m._colMajor)for(l=0;l<m._annoCols.length;l++)if(h=m._annoCols[l])k=m._normalCols.indexOf(h),-1!=k&&(k=h,h=k.clone(),m._annoCols[l]=h,k=n.indexOf(k),-1!=k&&(n[k]=h)),h.insertCell(f.r1);break;case "delete_col":l=f;z=m;r=k;D=new za(null,z._defColWidth,U.DEL);D.revision(r);r.target=
D;u(z,r,D);z=0;t=[];for(G=0;G<r.cells.length;G++)w=r.cells[G],w.range.r1>z&&(t.push({e:w.range.r1-z}),z=w.range.r1),t.push(p(w)),z++;D.setCellData(t);l.col=D;f.row=n[f.r1];f.row2=n[f.r2];for(f.col.revision(k);f.c1>h.length;)h.push(null);h.splice(f.c1,0,f.col);h=0<f.c1?(h=h[f.c1-1])?m._annoCols.indexOf(h)+1:f.c1:(h=h[f.c1+1])?m._annoCols.indexOf(h):f.c1;for(;h>m._annoCols.length;)m._annoCols.push(null);m._annoCols.splice(h,0,f.col);if(!m._colMajor)for(l=0;l<m._annoRows.length;l++)if(h=m._annoRows[l])k=
m._normalRows.indexOf(h),-1!=k&&(k=h,h=k.clone(),m._annoRows[l]=h,k=n.indexOf(k),-1!=k&&(n[k]=h)),h.insertCell(f.c1);break;case "clear_cell":for(;f.c2>=h.length;)l=La(h.length),k=new za(null,m._defColWidth,l),h.push(k),m._annoCols.push(k);for(;f.r2>=n.length;)l=Za(n.length),k=new za(null,m._defRowHeight,l),n.push(k),m._annoCols.push(k);case "new_cell":case "modify_cell":case "move_cells":f.col=h[f.c1],f.row=n[f.r1],f.c2!=f.c1&&(f.col2=h[f.c2]),f.r2!=f.r1&&(f.row2=n[f.r2])}}for(a=0;a<e._revisions.length;a++){g=
e;d=e._revisions[a];if(m=T(g,d.range))d.annoRange=m;if(g=T(g,d.oldrange))d.oldAnnoRange=g}if(a=e._page.comments())for(d=0;d<a.length;d++)f=a[d],"cell"===f.type&&f.range&&"cell"===f.range.type&&(g=f,m=e,f=f.range,m._normalCols&&m._normalRows?(f.col=m._normalCols[f.c1],f.row=m._normalRows[f.r1],f.c2!=f.c1&&(f.col2=m._normalCols[f.c2]),f.r2!=f.r1&&(f.row2=m._normalRows[f.r2]),m=T(m,f)):m=void 0,g.annoRange=m);e.showAnnotations(x.showAnnotations);delete e._revisionMap;b&&b.call(c)});d=!0}}return d};c.revisions=
function(){return this._revisions};c.rowRevisions=function(a){if(a=this._rows[a])return a.revision()};c.colRevisions=function(a){if(a=this._cols[a])return a.revision()};var G=function(a,b,c){a[b]?(Array.isArray(a[b])||(a[b]=[a[b]]),a[b].push(c)):a[b]=c},Q=function(a,b,c){for(var d=b.r1;d<=b.r2;d++)for(var e=b.c1;e<=b.c2;e++){var f=e,g=c,h=a[d];h||(h=a[d]=[]);h[f]?(Array.isArray(h[f])||(h[f]=[h[f]]),h[f].push(g)):h[f]=g}},D=function(a,b){a&&(b||(b=[]),Array.isArray(a)?Array.prototype.push.apply(b,
a):b.push(a));return b};c.getCellRevisions=function(c,d){var f;if(this._revisions){if(!this._revisionMap){for(var h=this._revisions,k={cols:[],rows:[],cells:[]},l=0;l<h.length;l++){var n=h[l],p=n.annoRange||n.range,u=n.oldAnnoRange||n.oldrange;b[n.type]?(p&&G(k.rows,p.r1,n),u&&G(k.rows,u.r1,n)):e[n.type]?(p&&G(k.rows,p.c1,n),u&&G(k.rows,u.c1,n)):a[n.type]&&(p&&Q(k.cells,p,n),u&&Q(k.cells,u,n))}this._revisionMap=k}f=D(this._revisionMap.cols[c],f);f=D(this._revisionMap.rows[d],f);(h=this._revisionMap.cells[d])&&
(f=D(h[c],f))}return f};return d}(),rd=function(){var b={f:"_font",s:"_fontSize",fs:"_fontStyle",fw:"_fontWeight",d:"_textdec",ba:"_baseline",ta:"_angle",c:"_color",w:"_wrap",a:"_align",i:"_indent",v:"_valign",bdr:"_bdr",b:"_fill",bb:"_fillBg",bh:"_fillHatch"},e=function(a,c,d,e){this._data=a;this._model=c;this._style=a.s?c.cellStyle(a.s):{};a.t?this._text=a.t:a.v&&(this._text=a.v);var f=this._style,h=a.c?c.colStyle(d):{},k=c.sheetStyle();this._font="Arial";this._fontSize=10;this._align="g";this._indent=
0;this._valign="b";for(var g in b)if(b.hasOwnProperty(g)){var l=f[g]||h[g]||k[g];void 0!==l&&(this[b[g]]=l)}a.c&&(this._color=a.c);if(this._angle&&"vertical"!==this._angle){for(;0>this._angle;)this._angle+=360;for(;360<=this._angle;)this._angle-=360;0===this._angle?this._angle=null:(this._angle=(360-this._angle)*Math.PI/180,this._align="l",this._valign="b",this._indent=0)}this._bdr&&(this._topBorder=this._bdr[0],this._rightBorder=this._bdr[1],this._bottomBorder=this._bdr[2],this._leftBorder=this._bdr[3],
a.bs&&(-1!=a.bs.indexOf("t")&&(this._topBorder=null),-1!=a.bs.indexOf("r")&&(this._rightBorder=null),-1!=a.bs.indexOf("b")&&(this._bottomBorder=null),-1!=a.bs.indexOf("l")&&(this._leftBorder=null)),delete this._bdr);2>this._indent&&(this._indent=2);this._clearLeft=this._textRight=this._textLeft=0;this._clearRight=void 0;if(a=c.getCellComments(d,e,!0))this._comments=a;if(c=c.getCellRevisions(d,e))for(a=0;a<c.length;a++)if(f=c[a],f.range&&f.range.c1==d&&f.range.r1==e||f.oldrange&&f.oldrange.c1==d&&
f.oldrange.r1==e){this._hasRevision=!0;break}},a=V(e);a.hasText=function(){return this._text&&0<this._text.length};a.textRight=function(){return this._textRight};a.horizontalMerge=function(){return this._data.mh||0};a.verticalMerge=function(){return this._data.mv||0};a.horizontalAlign=function(){return this._align};a.leftBorder=function(){return this._leftBorder||null};a.topBorder=function(){return this._topBorder||null};a.rightBorder=function(){return this._rightBorder||null};a.bottomBorder=function(){return this._bottomBorder||
null};a.rangeRect=function(a){var b=this._wrappedText;if("text"===a.type&&b){var c,d=a.acc-this._data.a;a=a.accend-this._data.a;0>d&&(d=0);a>this._text.length&&(a=this._text.length);for(var e=0;e<b.length;e++)for(var f=b[e],k=f.x,g=f.y,l=f.o,n=0;n<f.spans.length;n++){var p=f.spans[n],u=l+p.t.length;if(u>d&&l<a){var l=k+p.w,r=g+f.h;c?(k<c.left&&(c.left=k),g<c.top&&(c.top=g),l>c.right&&(c.right=l),r>c.bottom&&(c.bottom=r)):c={left:k,top:g,right:l,bottom:r}}k+=p.w;l=u}return c}};a.drawTextBackground=
function(a,b,c,d,e,f,k){if(0>this._textLeft||this._textRight>f)b=d+this._textLeft,d+=this._textRight,b<this._clearLeft&&(b=this._clearLeft),void 0!==this._clearRight&&d>=this._clearRight&&(d=this._clearRight-1),a.oitrect(b+1,e+1,d-b-1,k-1,"#ffffff")};a.drawBackground=function(a,b,c,d,e,f,k){if(this._fill||this.horizontalMerge()||this.verticalMerge())if(this._fillHatch){b=new kc(8,8);c=b.getContext("2d");this._fillBg&&c.oitrect(0,0,8,8,this._fillBg);c.strokeStyle=this._fill||"#ffffff";c.lineCap="square";
"d"==this._fillHatch.charAt(0)?c.lineWidth=2:c.lineWidth=1;switch(this._fillHatch){case "lv":case "dv":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);break;case "lh":case "dh":c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "ldd":case "ddd":c.oitline(-.5,-.5,8.5,8.5);break;case "lud":case "dud":c.oitline(8.5,-.5,-.5,8.5);break;case "lg":case "dg":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "lt":case "dt":c.oitline(0,0,8,8),c.oitline(8,
0,0,8)}b=a.createPattern(y.unwrap(b),"repeat");a.fillStyle=b;a.globalAlpha=1;a.fillRect(d+.5,e+.5,f+.5,k+.5)}else a.oitrect(d+.5,e+.5,f+.5,k+.5,this._fill||"#ffffff")};var d=function(a,b,c,d,e){c||(c=1);var f=2*c;switch(b){case "dotted":b=[f,f];break;case "dashed":b=[2*f,f];break;case "dashdot":b=[2*f,f,f,f];break;case "dashdotdot":b=[2*f,f,f,f,f,f];break;case "double":b=[];c=Math.floor(c/3);1>c&&(c=1);break;default:b=[]}for(var k=f=0;k<b.length;k++)f+=b[k];e%=f;a.strokeStyle=d||"black";a.fillStyle=
d||"black";a.lineWidth=c;a.setLineDash?(a.setLineDash(b),a.lineDashOffset=e):(a.mozDash=b,a.mozDashOffset=e)},c=function(a){var b=Math.floor(a.w/3);1>b&&(b=1);a=a.w-(b+b);1>a&&(a=1);b=(b+a)/2;return[-b,b]},f=function(a,b){var d=0,e=0,f;a&&"double"===a.s&&(f=c(a),d=-f[0]);b&&"double"===b.s&&(f=c(b),e=f[1]);return d&&e?d>e?-d:-e:d?d:e},k=function(a,b){var d=0,e=0,f;a&&"double"===a.s&&(f=c(a),d=-f[0]);b&&"double"===b.s&&(f=c(b),e=f[1]);return d&&e?[-d,-e]:d?[-d,d]:[e,-e]},t=function(a,b,e,l,n,h,p,g,
m){d(a,n.s,n.w,n.c,b);"double"===n.s?(n=c(n),h=k(h,p),g=k(g,m),h[0]||(h[0]=-.5),h[1]||(h[1]=-.5),g[0]||(g[0]=.5),g[1]||(g[1]=.5),a.beginPath(),a.moveTo(b-h[0],e+n[0]),a.lineTo(l+g[0],e+n[0]),a.moveTo(b-h[1],e+n[1]),a.lineTo(l+g[1],e+n[1])):(n=f(h,p),g=f(g,m),n||(n=-.5),g||(g=.5),a.beginPath(),a.moveTo(b-n,e+.5),a.lineTo(l+g,e+.5));a.stroke()},r=function(a,b,e,l,n,h,p,g,m){d(a,n.s,n.w,n.c,e);"double"===n.s?(n=c(n),h=k(h,p),g=k(g,m),h[0]||(h[0]=-.5),h[1]||(h[1]=-.5),g[0]||(g[0]=.5),g[1]||(g[1]=.5),
a.beginPath(),a.moveTo(b+n[0],e-h[0]),a.lineTo(b+n[0],l+g[0]),a.moveTo(b+n[1],e-h[1]),a.lineTo(b+n[1],l+g[1])):(n=f(h,p),g=f(g,m),n||(n=-.5),g||(g=.5),a.beginPath(),a.moveTo(b+.5,e-n),a.lineTo(b+.5,l+g));a.stroke()},w=function(a,b){var c=null;a&&(c=a.bottomBorder());if(b){var d=b.topBorder();d&&(!c||d.w>c.w)&&(c=d)}return c},n=function(a,b){var c=null;a&&(c=a.rightBorder());if(b){var d=b.leftBorder();d&&(!c||d.w>c.w)&&(c=d)}return c};a.drawBorder=function(a,b,c,e,f,h,k,g){if(this._topBorder||this._rightBorder||
this._bottomBorder||this._leftBorder){var l=e+h;k=f+k;a.lineCap="square";a.lineJoin="miter";a.globalAlpha=1;var p;this._leftBorder&&0<=this._textLeft&&0<b&&(b=w(g[0][0],g[1][0]),p=w(g[1][0],g[2][0]),r(a,e,f,k,this._leftBorder,b,this._topBorder,p,this._bottomBorder));this._topBorder&&0<c&&(b=n(g[0][0],g[0][1]),c=n(g[0][1],g[0][2]),t(a,e,f,l,this._topBorder,b,this._leftBorder,c,this._rightBorder));this._rightBorder&&this._textRight<=h&&(c=w(g[0][2],g[1][2]),h=w(g[1][2],g[2][2]),r(a,l,f,k,this._rightBorder,
this._topBorder,c,this._bottomBorder,h));this._bottomBorder&&(p=n(g[2][0],g[2][1]),h=n(g[2][1],g[2][2]),t(a,e,k,l,this._bottomBorder,this._leftBorder,p,this._rightBorder,h));d(a,null)}};var l=function(a,b,c,d){if(c||d){var e={s:{},o:-1,oend:-1};"text"===b.type?(e.o=b.acc-a._data.a,0>e.o&&(e.o=0),e.oend=b.accend-a._data.a):(e.o=0,e.oend=a._text.length);c&&(e.s.c=c);d&&(e.s.bg=Ia(d));return e}};a.layoutText=function(a,b,c,d,e,f,k){if(this.hasText()){var g,h,n;c=!1;var r=null;g=this._data.selection;
var t=this._data.highlights;if(g||t&&0<t.length){r=[];g&&(n=P.style()||"background-color:#3399FF;",h=rb(n,"color"),n=rb(n,"background-color"),(h=l(this,g,h,n))&&r.push(h));if(t)for(g=0;g<t.length;g++){var z=t[g];n=z.highlightStyleProps();h=n.color;n=n["background-color"];(h=l(this,z.range,h,n))&&r.push(h)}delete this._data.highlightsChanged}this._wrappedText&&uc(r,this._highlightSpecs,!0)||(this._highlightSpecs&&!r?delete this._highlightSpecs:this._highlightSpecs=r,this._wrappedText=null);this.horizontalMerge()||
this.verticalMerge()?(this._clearLeft=b,this._clearRight=b+d):(this._clearLeft=f,this._clearRight=k);d!=this._layoutWidth&&(this._wrappedText=null);e!=this._layoutHeight&&(this._wrappedText=null,c=!0);if(!this._wrappedText&&(this._textLeft=0,this._layoutWidth=this._textRight=d,"l"==this._align?this._textLeft=this._indent:"r"==this._align&&(this._textRight=d-this._indent),g=this._textRight-this._textLeft,c=!0,this._wrap||this._angle?this._wrappedText=this.wrapText(a,g,e):this._data.cs||-1!=this._text.indexOf("\n")?
this._wrappedText=this.wrapText(a,void 0,e):(b=this.createLine(0,this._text.length,null),u(a,b,this),p(a,b,this),this._wrappedText=[b]),a=this._wrappedText))if(g=void 0!==this._data.v,g="r"==this._align||"rs"==this._align||g&&"g"==this._align,"c"==this._align||"cs"==this._align)for(g=0;g<a.length;g++)b=a[g],b.x=(d-b.w)/2,f=b.x+b.w,b.x<this._textLeft&&(this._textLeft=b.x),f>this._textRight&&(this._textRight=f);else if(g)for(g=0;g<a.length;g++)b=a[g],b.x=d-2-b.w-this._indent,b.x<this._textLeft&&(this._textLeft=
b.x);else for(g=0;g<a.length;g++)b=a[g],b.x=this._indent,f=b.x+b.w,f>this._textRight&&(this._textRight=f);this._layoutHeight=e;if(c)for(a=this._wrappedText,d=a[a.length-1],d=d.y+d.h-a[0].y,c=0,"c"==this._valign?c=(e-d)/2:"b"==this._valign&&(c=e-d-2),g=0;g<a.length;g++)b=a[g],b.y=c,c+=b.h}};a.drawText=function(a,b,c,d,e,f,k){if(b=this._wrappedText){c=!1;var g=b[b.length-1],g=g.y+g.h-b[0].y;this._data.clipped=!1;if(0>this._textLeft||this._textRight>f||g>k){f=d+this._textLeft;var h=d+this._textRight;
if(f<this._clearLeft||void 0!==this._clearRight&&h>this._clearRight||g>k)f<this._clearLeft&&(f=this._clearLeft),void 0!==this._clearRight&&h>this._clearRight&&(h=this._clearRight),a.save(),c=!0,a.beginPath(),a.fillStyle="black",a.rect(f,e,h-f,k),a.clip(),this._data.clipped=!0}a.globalAlpha=1;a.textAlign="left";a.textBaseline="alphabetic";this._angle&&"vertical"!==this._angle&&0<b.length&&(c||(a.save(),c=!0),a.translate(d+b[0].x,e+b[0].y),d=-b[0].x,e=-b[0].y,a.rotate(this._angle));for(f=0;f<b.length;f++){g=
b[f];if(g.y>k)break;for(var h=d+g.x,l=e+g.y,n=0;n<g.spans.length;n++){var p=g.spans[n],u=this._font,r=this._fontSize,t=this._fontStyle,C=this._fontWeight,z=this._color,q=this._textdec,B=this._baseline,w=null;p.s&&(p.s.f&&(u=p.s.f),p.s.s&&(r=p.s.s),p.s.fs&&(t=p.s.fs),p.s.fw&&(C=p.s.fw),p.s.c&&(z=p.s.c),p.s.d&&(q=p.s.d),p.s.ba&&(B=p.s.ba),p.s.bg&&(w=p.s.bg));p.hs&&(p.hs.c&&(z=p.hs.c),p.hs.bg&&(w=p.hs.bg));var v=M(l+g.a);B&&("sup"===B?(v+=-.35*g.a,r*=.65):"sub"===B&&(v+=.141*g.a,r*=.65));if(w){B=w;w=
1;if(0===B.indexOf("rgba(")||0===B.indexOf("rgb(")){var D=Aa(B);D&&(B=Ia(D.r,D.g,D.b),w=D.a)}a.fillStyle=B;a.globalAlpha=w;a.fillRect(h-1,v-g.a,p.w+2,g.h+2)}a.font=x(u,r,t,C);a.fillStyle=z||"black";a.globalAlpha=1;a.fillText(p.t,h,v);if(q){var y,G,A;switch(q){case "u":A=1;y=v+A;break;case "d":A=1;y=v+A;G=y+A+A;break;case "l":A=1,y=v-.25*p.a}void 0!==y&&(y=M(y)+.5,a.strokeStyle=z,a.lineWidth=A,a.beginPath(),a.moveTo(h,y),a.lineTo(h+p.w,y),void 0!==G&&(G=M(G)+.5,a.moveTo(h,G),a.lineTo(h+p.w,G)),a.stroke(),
a.closePath())}h+=p.w}}c&&a.restore()}};a.drawFlags=function(a,b,c,e,f,h,k){void 0!==this._data.fm&&(b=f+k,a.lineCap="square",a.lineJoin="miter",a.globalAlpha=1,a.strokeStyle="rgba(52,113,183,0.5)",a.fillStyle="rgba(52,113,183,0.5)",a.lineWidth=1,a.beginPath(),a.moveTo(e,b),a.lineTo(e,b-6),a.lineTo(e+6,b),a.lineTo(e,b),a.fill(),d(a,null));this._comments&&(e+=h,a.lineCap="square",a.lineJoin="miter",a.globalAlpha=1,a.strokeStyle="rgb(255,0,0)",a.fillStyle="rgb(255,0,0)",a.lineWidth=1,a.beginPath(),
a.moveTo(e,f),a.lineTo(e,f+6),a.lineTo(e-6,f),a.lineTo(e,f),a.fill(),d(a,null))};a.createLine=function(a,b,c){var d={x:0,y:0,w:0,h:0,spans:[],o:a},e,f,k,g;if(c){g=a;for(var l,n=0;n<c.length;n++){e=c[n];if(e.o>g&&(f=e.o,f>b&&(f=b),g=this._text.substring(g,f),d.spans.push({t:g,w:0,s:l}),g=f,g>=b))break;l=this._model.cellStyle(e.s)}g<b&&(g=this._text.substring(g,b),d.spans.push({t:g,w:0,s:l}))}else g=this._text.substring(a,b),d.spans.push({t:g,w:0});if(this._highlightSpecs)for(b=0;b<this._highlightSpecs.length;b++)for(c=
this._highlightSpecs[b],g=a,l=0;l<d.spans.length;l++)n=d.spans[l],f=g+n.t.length,c.o<f&&c.oend>g&&(e=c.o-g,0<e&&(f=n.t.substring(0,e),k=n.t.substring(e),e={t:f,w:0},n.s&&(e.s=n.s),n.hs&&(e.hs={},n.hs.c&&(e.hs.c=n.hs.c),n.hs.bg&&(e.hs.bg=n.hs.bg)),d.spans.splice(l,0,e),l++,n.t=k,g+=f.length,f=g+n.t.length),e=c.oend-g,e<n.t.length&&(f=n.t.substring(0,e),k=n.t.substring(e),e={t:k,w:0},n.s&&(e.s=n.s),n.hs&&(e.hs={},n.hs.c&&(e.hs.c=n.hs.c),n.hs.bg&&(e.hs.bg=n.hs.bg)),d.spans.splice(l+1,0,e),n.t=f,f=g+
n.t.length),n.hs||(n.hs={}),c.s.c&&(n.hs.c=c.s.c),c.s.bg&&(n.hs.bg=c.s.bg)),g=f;return d};var u=function(a,b,c){for(var d=b.w=0;d<b.spans.length;d++){var e=b.spans[d],f=c._font,k=c._fontSize,g=c._fontStyle,l=c._fontWeight,n=c._baseline;e.s&&(e.s.f&&(f=e.s.f),e.s.s&&(k=e.s.s),e.s.fs&&(g=e.s.fs),e.s.fw&&(l=e.s.fw),e.s.baseline&&(n=e.s.baseline));n&&("sup"===n?k*=.65:"sub"===n&&(k*=.65));a.font=x(f,k,g,l);e.w=a.measureText(e.t).width;b.w+=e.w}return b.w},p=function(a,b,c){Na||(Na=y.create("div","oit-textmeasure"),
v.rootNode.append(Na));b.h=0;b.a=0;Na.css("display","inline");for(a=0;a<b.spans.length;a++){var d=b.spans[a],e=c._font,f=c._fontSize,k=c._fontStyle,g=c._fontWeight;d.s&&(d.s.f&&(e=d.s.f),d.s.s&&(f=d.s.s),d.s.fs&&(k=d.s.fs),d.s.fw&&(g=d.s.fw));Na.text(d.t);var l=y.create("span");Na.append(l);Na.css("font",x(e,f,k,g));Na.offsetHeight>b.h&&(b.h=Na.offsetHeight);d.a=l.offsetTop+1;d.a>b.h&&(d.a=b.h);d.a>b.a&&(b.a=d.a)}Na.html("");Na.attr("style","");Na.css("display",null)};a.wrapText=function(a,b,c){var d=
[];void 0!==b&&(b-=4);var e=0,f=0,k=0;if("vertical"===this._angle)b=0;else if(this._angle)if(this._angle===Math.PI/2||this._angle===3*Math.PI/2)b=this._layoutHeight;else{var g=Math.tan(this._angle),l=-this._layoutHeight-g,n=2*this._layoutHeight+g,g=Math.min(Math.min(Math.sqrt(l*l),Math.sqrt(g*g+this._layoutHeight*this._layoutHeight)),Math.sqrt(this._layoutHeight*this._layoutHeight+n*n));g<b&&(b=g)}g=this._text;g=this._data.cs||void 0!==b?g.replace(/\s/g,"\ufffd"):g.replace(/\n/g,"\ufffd");for(l=0;e<
this._text.length;){k=g.indexOf("\ufffd",k);-1==k&&(k=g.length);n=this.createLine(e,k,this._data.cs);u(a,n,this);var r=void 0!==b&&n.w>b;if(r||"\n"==this._text[k]||k>=this._text.length){if(r)if(f>e)k=f,n=this.createLine(e,k,this._data.cs),u(a,n,this);else for(r=e+1;k>r&&!(k--,n=this.createLine(e,k,this._data.cs),u(a,n,this),n.w<=b););p(a,n,this);n.y=l;l+=n.h;d.push(n);if(void 0!==c&&l>=c)break;k<this._text.length&&(e=this._text[k]," "!=e&&"\t"!=e&&"\n"!=e||k++);e=k}else f=k++}if(0!==d.length)return d};
var x=function(a,b,c,d){0>=b&&(b=10);var e="";c&&"normal"!==c&&(e+=c+" ");d&&"normal"!=d&&(e+=d+" ");return e+(b+"px "+a)};return e}(),Na=null,cd=function(){return function(b,e){var a=this,d=b,c=e,f,k,t,r,w,n,l,u,p,J,F,T,G,Q,D,h=[],z,g,m,O,H=0,N=0,R=40,K=22,fa,C,I,q,B=x.zoom,ba="database"!==e.type,aa,da=-1,S=-1,Z=-1,ha=-1,Ra=!1,qa,pa,ca;this.unload=function(){ca&&(ua(ca),ca=null);a.hidePopup(!0);qa&&(qa.destroy(),qa=null);E.offscroll(V);P.offselectionchanged(X);A.offpageload(U);la.offresize(Y);Q&&
Q.destroy();for(var b=d.embeddingCount(),e=0;e<b;e++)d.embed(e).node=void 0;J&&(c.append(J),J=void 0);w&&w.destroy();l&&l.destroy();p&&p.destroy();f&&f.destroy();Na&&(Na.destroy(),Na=null);z=h=D=Q=F=J=p=u=l=n=w=r=f=c=d=a=null};this.layoutChanged=function(b){x.zoom!=B&&(a.hidePopup(),Y())};var U=function(a){J&&(c.append(J),F=J=void 0);Y()};this.maxPageWidth=function(){var a=d.sheetRight();void 0!==aa&&aa>a&&(a=aa);return a};this.maxPageHeight=function(){return d.sheetBottom()};this.padding=function(){return{left:R,
top:K,right:0,bottom:0}};this.visibleRange=function(){return sa(N,H,q,I)};this.visibleHeight=function(){return Ja(I)-Ya(H)};this.scrollOffset=function(a,b){void 0===a&&(a=N);void 0===b&&(b=H);var c=M(d.colLeft(a)*B)+1,e=M(d.rowTop(b)*B)+1;return{left:c,top:e}};var V=function(b,c,e,f,g){var h=H;f/=B;if(0<e)for(;!(d.rowBottom(h)>=f);)h++;else if(0>e)for(e=H;0<=e;e--)if(d.rowTop(e)<=f){h=e;break}e=N;f=c/B;if(0<b)for(;!(d.colRight(e)>=f);)e++;else if(0>b)for(b=N;0<=b;b--)if(d.colLeft(b)<=f){e=b;break}if(e!=
N||h!=H)N=e,H=h,!1!==g&&(a.update(),a.hidePopup())},X=function(a,b){if(b){if(D){var e=d.getSelectedText();D.html(e);D.select()}if(d.isRangeSelected())qa.disable(),qa.setText(void 0);else if(e=E.cellSelection()){var f=d.getFormulaText(e.c1,e.r1);f||(f=d.getCellText(e.c1,e.r1))&&"="==f[0]&&(f="'"+f);qa.enable();qa.setText(f)}else qa.setText(void 0);if(x.showAnnotations){var g,e=E.cellSelection(),f=c.annotationPane();if(e&&f){g=!d.isRangeSelected();!pa||pa.c==e.c1&&pa.r==e.r1||(pa=null);var h=pa?pa.anno:
null,k=null,l=d.getCellComments(e.c1,e.r1),n=d.getCellRevisions(e.c1,e.r1);h&&g&&(l&&(g=l.indexOf(h),-1!=g&&((k=l[g+1])||(k=n?n[0]:l[0]))),!k&&n&&(g=n.indexOf(h),-1!=g&&((k=n[g+1])||(k=l?l[0]:n[0]))));k||((k=za(l,e))||(k=za(n,e)),k||(l?k=l[0]:n&&(k=n[0])));k&&(pa={anno:k,c:e.c1,r:e.r1},f.activate(k))}}}ia();na()};this.showHidden=function(b,e){if(d){var f=!1;!0===b?d.eachCol(function(a){d.showCol(a)&&(f=!0)}):!1===b&&d.eachCol(function(a){d.resetCol(a)&&(f=!0)});!0===e?d.eachRow(function(a){d.showRow(a)&&
(f=!0)}):!1===e&&d.eachRow(function(a){d.resetRow(a)&&(f=!0)});f&&(aa=void 0,L.deactivate(),P.update(),a.update(),L.positionAll(c),E.dispatchPageEvents())}};var Y=function(b){var c=v.viewNode;r&&k==c.clientWidth&&t==c.clientHeight&&B==x.zoom||(k=c.clientWidth,t=c.clientHeight,B=x.zoom,M(k/B),M(t/B),(c=hb())&&(1==B?c.css("transform",null):c.css("transform","scale("+B+","+B+")")),r&&(r.destroy(),n.destroy(),u.destroy()),w||(w=y.create("div","oit-ssgrid"),l=y.create("div","oit-sscolheader"),l.onmousemove(Oa),
l.ondragstart(Qa),l.ondragmove(Ia),l.ondragend(Fa),l.ondragcancel(Fa),l.onpress(Pa),l.onpressup(Ma),p=y.create("div","oit-ssrowheader"),p.onmousemove(Xa),p.ondragstart(va),p.ondragmove(Ka),p.ondragend(Va),p.ondragcancel(Va),p.onpress(Wa),p.onpressup(Ua),f.append(w,l,p)),f.css({width:k+"px",height:t+"px"}),R=p.offsetWidth,K=l.offsetHeight,r=w.createCanvas(),n=l.createCanvas(),u=p.createCanvas(),d.updateDimensions(),!1!==b&&a.update())};this.pageRect=function(a,b){if("view"===b||"overlay"===b||b===
c){var e=0,f=0,g=d.sheetRight(),h=d.sheetBottom();if("view"===b||"overlay"===b){var k=x.zoom;1!=k&&(e*=k,f*=k,g*=k,h*=k);"view"===b&&(k=this.scrollOffset(),e+=R-k.left,f+=K-k.top,g+=R-k.left,h+=K-k.top)}return new ja(e,f,g,h,b)}};this.rangeRect=function(a,b,e){var f;if("cell"===a.type){f=a.r1;var k=a.r2,l=a.c1,n=a.c2,q=a.offsets;a.offsets?f=new ja(d.colLeft(l)+q.left,d.rowTop(f)+q.top,d.colLeft(n)+q.right,d.rowTop(k)+q.bottom,c):(a.selectingRows&&(l=0,n=d.colCount()-1),a.selectingCols&&(f=0,k=d.rowCount()-
1),f=new ja(d.colLeft(l)+1,d.rowTop(f)+1,d.colRight(n),d.rowBottom(k),c))}else if("rect"===a.type)"px"!==a.units&&(a=ga(a),ya(a,"px")),f=new ja(a),void 0!==a.embedId&&(k=d.embedByUID(a.embedId),a=c.embeddingRect(a.embedId),k&&a&&f.offset(a.left,a.top));else if("text"==a.type)for(k=d.mapToCells(a),l=0;l<k.length;l++){var p=k[l],n=d.colLeft(p.c1),q=d.rowTop(p.r1),C;a:{C=p.c1;var u=p.r1;if(C>=z.c1&&C<=z.c2&&u>=z.r1&&u<=z.r2){var B=h[u-z.r1];if(B){C=B[C-z.c1];break a}}C=g&&C==m&&u==O?g:void 0}u=!1;C||
(C=Ha(p.c1,p.r1),u=!0);u&&(u=r.getContext("2d"),u.save(),u.font="12px Arial,Helvetica,sans-serif",xa(u,p.c1,p.r1,C),u.restore());if(p=C.rangeRect(a))p.left+=n,p.right+=n,p.top+=q,p.bottom+=q,f?f.union(p):f=new ja(p,c)}if(f)return!0===e&&(e=v.viewNode,e=new ja(0,0,e.clientWidth,e.clientHeight,"view"),e.origin=f.origin,f.intersect(e.left-100,e.top-100,e.right+100,e.bottom+100),0===f.width||0===f.height)&&(f=void 0),f&&b&&(f.origin=b),f};this.rangeFromRect=function(b,f,g,h,k,l,n,q,m,p){b=new ja(f,g,
h,k,l);b.origin=c;if(void 0!==q)return m=e.embeddingRect(q),"move"===n?b.constrain(m):b.intersect(m),b.offset(-m.left,-m.left),f=b.toRange(),f.embedId=q,ya(f,"pct"),f;"move"!==n&&"resize"!==n&&"extend"!==n&&("view"===l&&(f-=R,g-=K),p|=f<d.colLeft(N),m|=g<d.rowTop(H));q=new ja(0,0,d.sheetRight(),d.sheetBottom(),c);"move"===n?b.constrain(q):b.intersect(q);q=!p&&!m;f=d.cellFromPos(b.left,b.top,q);q=d.cellFromPos(b.right,b.bottom,q);p?(f.c1=0,f.c2=d.colCount()-1,f.selectingRows=!0):f.c2=q.c1;m?(f.r1=
0,f.r2=d.rowCount()-1,f.selectingCols=!0):f.r2=q.r1;if("move"===n||"resize"===n)n=a.rangeRect(f,c,!1),b.left-1>n.left&&f.c1<f.c2&&(f.c1+=1),b.top-1>n.top&&f.r1<f.r2&&(f.r1+=1),b.right<n.right&&f.c1<f.c2&&--f.c2,b.bottom<n.bottom&&f.r1<f.r2&&--f.r2;p||m?(p&&(f.selectingRows=!0),m&&(f.selectingCols=!0)):(f.offsets={left:b.left-d.colLeft(f.c1),top:b.top-d.rowTop(f.r1),right:b.right-d.colLeft(f.c2),bottom:b.bottom-d.rowTop(f.r2)},f=d.expandRange(f));return f};this.extendRange=function(b,c,d,e){var f=
a.rangeRect(b,e,!1),g=f.left,f=f.top,g=b.selectingRows?g-R:g+1,f=b.selectingCols?f-K:f+1;c=a.rangeFromRect(b.page,g,f,c,d,e,"extend",void 0,b.selectingCols,b.selectingRows);c.offsets&&!b.offsets&&delete c.offsets;return c};this.update=function(a){ca||(ca=ea(this.doUpdate,0,this,a))};this.doUpdate=function(a){ca&&(ua(ca),ca=null);var b=v.viewNode;if(!Ra){Ra=!0;var e=d.webFonts();if(e&&0<e.length)for(var f=e.length-1;0<=f;f--)Dc.loadWebFont(e[f])}var g=M(-d.colLeft(N)*B),l=M(-d.rowTop(H)*B);v.drawing.setOrigin(g+
R,l+K);C=N;q=void 0;for(var n=R;C<d.colCount();){if(!d.colHidden(C)&&(n+=M(d.colWidth(C)*B),n>=b.clientWidth)){n==b.clientWidth?q=C:(q=C-1,q<N&&(q=N));break}C++}void 0===q&&(q=C);fa=H;I=void 0;for(var m=K;fa<d.rowCount();){if(!d.rowHidden(fa)&&(m+=M(d.rowHeight(fa)*B),m>=b.clientHeight)){m==b.clientHeight?I=fa:(I=fa-1,I<H&&(I=H));break}fa++}void 0===I&&(I=fa);d.loadDataForCells(N,H,C,fa,!0);var p=fb();if(p){var u=v.viewNode,t=u.pos(u.parent());p.css({left:t.left+R+"px",top:t.top+K+"px",width:u.clientWidth-
R+"px",height:u.clientHeight-K+"px"});hb().css({left:g+"px",top:l+"px"});for(var w=d.embeddingCount(),y=0;y<w;y++){var A=d.embed(y);if(A&&A.node&&A.position)if(void 0===A.c2)A.node.css({left:A.position.left-A.adjustX+"px",top:A.position.top-A.adjustY+"px"});else if(A.position.left===A.position.right||A.position.top===A.position.bottom)A.node.css("display","none");else{var D=(A.position.right-A.position.left)/A.w,hc=(A.position.bottom-A.position.top)/A.h,Q,J;if(1!=D||1!=hc)Q="scale("+D+","+hc+")",
J="left top";A.node.css({display:null,left:A.position.left-A.adjustX*D+"px",top:A.position.top-A.adjustY*hc+"px",transform:Q,"transform-origin":J})}}}var Z=r.getContext("2d");Z.clearRect(0,0,r.width,r.height);Z.save();var ha,F=z,O,da;d.cellGridChanged()?(h=F=z=null,d.cellGridChanged(!1)):!0===a&&(z=null);var qa=N;if(0<N)for(O=H;O<=fa;O++)if(!d.rowHidden(O)&&(ha=d.getCell(N,O),!ha||!ha.t&&!ha.v)){var pa=d.prevTextCell(N,O);void 0!==pa&&pa<qa&&(qa=pa)}if(z&&(z.c1!=qa||z.c2!=C||z.r1!=H||z.r2!=fa)){if(qa>
z.c2||C<z.c1||H>z.r2||fa<z.r1)h=F=null;z=null}if(!z){z=sa(qa,H,C,fa);var L=h;h=[];for(O=z.r1;O<=z.r2;O++)d.rowHidden(O)||(h[O-z.r1]=[]);var W=null,S=null;for(O=z.r1;O<=z.r2;O++)if(!d.rowHidden(O))for(da=z.c1;da<=z.c2;da++){ha=d.getCell(da,O);var U=d.colStyle(da),V=d.getCellComments(da,O),Ca=d.getCellRevisions(da,O),X=V||Ca||ha!==W||null!==U?null:S;if(ha&&!X){if(F){var Da=O-F.r1;if(0<=Da&&Da<L.length&&L[Da]){var ra=da-F.c1;0<=ra&&ra<L[Da].length&&(X=L[Da][ra])}}X||(X=Ha(da,O,ha))}h[O-z.r1][da-z.c1]=
X;W=ha;S=X}}Z.font="12px Arial,Helvetica,sans-serif";var ga=M((d.colRight(d.colCount()-1)-d.colLeft(N))*B),pb=M((d.rowBottom(d.rowCount()-1)-d.rowTop(H))*B),ea=v.viewNode,ja=ea.clientWidth,ka=ea.clientHeight;ba||(ja>ga&&(ja=ga),ka>pb&&(ka=pb));Z.oitrect(0,0,ja,ka,"#ffffff");Z.fillStyle=ba?"#f3f3f3":"#eaeaea";ea.clientWidth>ga&&Z.fillRect(ga,0,ea.clientWidth-ga,ea.clientHeight);ea.clientHeight>pb&&Z.fillRect(0,pb,ea.clientWidth,ea.clientHeight-pb);Z.oitline(.5,0,.5,ka,"#d0d0d0");for(var la=!1,ma=N+
1;;ma++){var Eb=d.colHidden(ma);if(!Eb||!la){var db=bb(ma);if(db>ja)break;var vb=db+.5;Z.oitline(vb,0,vb,ka,"#e0e0e0")}la=Eb}Z.oitline(0,.5,ja,.5,"#d0d0d0");for(var la=!1,Vb=H+1;;Vb++){var ya=d.rowHidden(Vb);if(!ya||!la){var Aa=Ya(Vb);if(Aa>ka)break;var Ba=Aa+.5;Z.oitline(0,Ba,ja,Ba,"#e0e0e0")}la=ya}var Ga=aa;d.colLeft(N);d.rowTop(H);for(var Ea=0,za=0;za<h.length;za++){var Na=h[za],Oa=za+z.r1,Ja=d.rowHeight(Oa);if(0<Ja){var Fa=0;z.c1!=N&&(Fa=d.colLeft(z.c1)-d.colLeft(N));for(var Qa=Fa,Ia=0;Ia<Na.length;Ia++){var Pa=
Ia+z.c1,La=d.colWidth(Pa);if(0<La){var Ma=Na[Ia];if(Ma&&Ma.hasText()){xa(Z,Pa,Oa,Ma,Qa,Fa,Ea,La,Ja);var Sa=d.colLeft(Pa)+Ma.textRight();if(void 0===aa||Sa>aa)aa=Sa;Qa=Fa+La}Fa+=La}}Ea+=Ja}}var Va=b.clientWidth,Xa=b.clientHeight,va,Ka=d.sheetRight(),Ta=d.sheetBottom();void 0!==aa&&aa>Ka&&(Ka=aa);c.width=Ka;c.height=Ta;var Wa=v.viewNode,Ua=Wa.clientWidth/B,Za=Wa.clientHeight/B,$a=20/B,jb=R/B,lb=K/B,ab=Ka+jb+$a;if(ab>Ua){for(var cb=d.colCount()-1;d.colLeft(cb)<Ka;)cb++;for(var ob=cb,ib=d.colWidth(ob),
kb=ob-1;0<=kb;kb--){var qb=ib+d.colWidth(kb);if(qb>Ua)break;ib=qb}va=Ua-ib;0>va&&(va=0);va+=$a;var rb=d.colRight(cb)+jb+va;rb>ab&&(ab=rb)}var eb=Ta+lb+$a;if(eb>Za){for(var gb=d.rowCount()-1;d.rowTop(gb)<Ta;)gb++;for(var tb=gb,nb=d.rowHeight(tb),sb=tb-1;0<=sb;sb--){var Db=nb+d.rowHeight(sb);if(Db>Za)break;nb=Db}va=Za-nb;0>va&&(va=0);va+=$a;var lc=d.rowBottom(gb)+lb+va;lc>eb&&(eb=lc)}void 0===T&&(T=yc(c),G=zc(c));var wb=Math.ceil(ab*B),xb=Math.ceil(eb*B);wb>T&&(E.hiddenContent("large-sheet-unsupported"),
wb=T);xb>G&&(E.hiddenContent("large-sheet-unsupported"),xb=G);c.css({width:wb+"px",height:xb+"px"});if(aa!=Ga||Va!=b.clientWidth||Xa!=b.clientHeight)Z.restore(),k=-1,Y();else{Z.scale(B,B);ta(Z,"drawTextBackground");ta(Z,"drawBackground");ta(Z,"drawBorder",!0);Z.restore();Z.save();var zb=d.revisions();if(zb&&x.showAnnotations){Z.save();for(var Cb=0;Cb<zb.length;Cb++){var mb=zb[Cb],Kb=mb.annoRange||mb.range,Fb=mb.oldAnnoRange||mb.oldrange;switch(mb.type){case "new_cell":wa(Z,Kb,null,"rgba(44,156,58,0.5)");
break;case "modify_cell":wa(Z,Kb,null,"rgba(148,57,174,0.5)");break;case "clear_cell":wa(Z,Kb,null,"rgba(213,61,61,0.5)");break;case "delete_row":var Gb=Z,ub=Kb.r1;if(ub<=fa&&ub>=H){var Hb=sa(c.index,0,ub,d.colCount()-1,ub),yb=oa(Hb);Gb.oitrect(yb.left,yb.top,yb.width,yb.height,"rgba(234,158,158,0.1)")}break;case "delete_col":var Ib=Z,Ab=Kb.c1;if(Ab<=C&&Ab>=N){var Jb=sa(c.index,Ab,0,Ab,d.rowCount()-1),Bb=oa(Jb);Ib.oitrect(Bb.left,Bb.top,Bb.width,Bb.height,"rgba(234,158,158,0.1)")}break;case "move_cells":wa(Z,
Fb,null,"rgba(213,61,61,0.5)"),wa(Z,Kb,null,"rgba(44,156,58,0.5)")}}Z.restore()}Z.scale(B,B);ta(Z,"drawText");ta(Z,"drawFlags");Z.restore();ia();na();P.update()}};this.hidePopup=function(a){};this.moveto=function(a,b,c){var e=!1;if(ec(a))if("text"===a.type)(a=d.mapToCells(a))&&0<a.length&&(e=this.moveto(a[0],b,c));else if("cell"===a.type){for(e=a.c1;e<=a.c2;e++)if(d.colHidden(e)){x.showHiddenColumns=!0;break}for(e=a.r1;e<=a.r2;e++)if(d.rowHidden(e)){x.showHiddenRows=!0;break}a.selectingRows||a.selectingCols||
(a=d.expandRange(a));e=v.viewNode.scroll();this.scrollToRange(a.c1,a.r1,a.c2,a.r2);a=v.viewNode.scroll();V(a.left-e.left,a.left,a.top-e.top,a.top,!0);b&&b(c);e=!0}return e};this.scrollToRange=function(a,b,c,e){var f=v.viewNode,g,h;if(a<N)g=a;else if(c>q){var k=f.clientWidth-R;for(g=c;0<=g;){k-=M(d.colWidth(g)*B);if(0===k)break;if(0>k){g++;break}if(0===g)break;g--}a<g&&(g=a)}if(b<H)h=b;else if(e>I){a=f.clientHeight-K;for(h=e+1;0<=h;){a-=M(d.rowHeight(h)*B);if(0===a)break;if(0>a){h++;break}if(0===h)break;
h--}b<h&&(h=b)}b=this.scrollOffset(g,h);var l,n;void 0!==g&&(l=b.left);void 0!==h&&(n=b.top);f.scroll(l,n)};var ia=function(){var a=n.getContext("2d");a.save();a.oitrect(0,0,l.clientWidth,l.clientHeight,"#eaeaea");a.oitrect(0,0,R,K,"#eaeaea");a.oitrect(R-11.5,K-11.5,8,8,"#d0d0d0","#e0e0e0");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var b=12;1<=B?a.font="12px Arial,Helvetica,sans-serif":(b*=B,8>b&&(b=8),a.font=b+"px Arial,Helvetica,sans-serif");for(var b=E.cellSelection(),c=
K/2,e=0,f=!1,g=N,h=N;ba||h<=d.colCount();h++){var k=0;d.colHidden(h)?e++:(k=M(d.colWidth(h)*B),0===k?e++:e&&(e=0,f=!0));if(1>=e){var q=bb(h)+R+.5;if(q>l.clientWidth)break;f&&(q+=2,f=!1);var m=null;if(x.showAnnotations){var p=d.colRevisions(h);if(p){for(var u=!1,C=!1,r=0;r<p.length;r++)"add_col"==p[r].type?u=!0:C=!0;u&&C?m="rgba(201,156,214,0.5)":u?m="rgba(149,205,156,0.5)":C&&(m="rgba(234,158,158,0.5)")}}!m&&b&&h>=b.c1&&h<=b.c2&&(m="#d0d0d0");m&&(a.oitrect(q,0,k,K,"#FFF"),a.oitrect(q,0,k,K,m),a.fillStyle=
"black");a.strokeStyle=b&&h>b.c1&&h<=b.c2?"#c1c1c1":"#d0d0d0";a.oitline(q,0,q,K,a.strokeStyle);if(!ba&&h>=d.colCount())break;0<k&&(a.save(),a.beginPath(),a.rect(q,0,k,K),a.clip(),(m=d.colTitle(h,!1))||(m=La(g)),a.measureText(m).width>=k?(k=q+1,a.textAlign="left"):(k=q+k/2,a.textAlign="center"),d.colOriginalHidden(h)?a.fillStyle="#b2b2b2":a.fillStyle="#000",a.fillText(m,k,c),a.restore())}d.colDeleted(h)||g++}b=.5;a.oitline(0,b,l.clientWidth,b,"#d0d0d0");b=K+.5;a.oitline(0,b,l.clientWidth,b,"#d0d0d0");
a.restore()},na=function(){var a=u.getContext("2d");a.save();a.oitrect(0,0,p.clientWidth,p.clientHeight,"#eaeaea");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var b=12;1<=B?a.font="12px Arial,Helvetica,sans-serif":(b*=B,8>b&&(b=8),a.font=b+"px Arial,Helvetica,sans-serif");for(var b=E.cellSelection(),c=R/2,e=0,f=!1,g=H,h=H;ba||h<=d.rowCount();h++){var k=0;d.rowHidden(h)?e++:(k=M(d.rowHeight(h)*B),0===k?e++:e&&(e=0,f=!0));if(1>=e){var l=Ya(h)+.5;if(l>p.clientHeight)break;f&&(l+=
2,f=!1);var n=null;if(x.showAnnotations){var q=d.rowRevisions(h);if(q){for(var m=!1,C=!1,r=0;r<q.length;r++)"add_row"==q[r].type?m=!0:C=!0;m&&C?n="rgba(201,156,214,0.5)":m?n="rgba(149,205,156,0.5)":C&&(n="rgba(234,158,158,0.5)")}}!n&&b&&h>=b.r1&&h<=b.r2&&(n="#d0d0d0");n&&(a.oitrect(0,l,R,k,"#FFF"),a.oitrect(0,l,R,k,n),a.fillStyle="black");a.strokeStyle=b&&h>b.r1&&h<=b.r2?"#c1c1c1":"#d0d0d0";a.oitline(0,l,R,l,a.strokeStyle);if(!ba&&h>=d.rowCount())break;0<k&&(a.save(),a.beginPath(),a.rect(0,l,R,k),
a.clip(),(n=d.rowTitle(h,!1))||(n=Za(g)),k=l+k/2,d.rowOriginalHidden(h)?a.fillStyle="#b2b2b2":a.fillStyle="#000",a.fillText(n,c,k,R),a.restore())}d.rowDeleted(h)||g++}b=R+.5;a.oitline(b,0,b,p.clientHeight,"#d0d0d0");a.restore()},oa=function(a){var b={left:0,top:0,right:0,bottom:0};b.left=bb(a.c1);b.right=Sa(a.c2);b.top=Ya(a.r1);b.bottom=Ja(a.r2);a=v.viewNode.clientWidth;var c=v.viewNode.clientHeight;b.left=ma(b.left,-100,a+100);b.right=ma(b.right,-100,a+100);b.top=ma(b.top,-100,c+100);b.bottom=ma(b.bottom,
-100,c+100);b.width=b.right-b.left;b.height=b.bottom-b.top;return b},wa=function(a,b,c,d){b&&b.c1<=C&&b.c2>=N&&b.r1<=fa&&b.r2>=H&&(b=oa(b),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,null,"#FFF",2),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,c,d,2,[1,6]))},ka=function(a,b){return!a||0>b||b>=a.length?null:a[b]},ta=function(a,b,c){var e=0,f,g;c&&(f=[[null,null,null],[null,null,null],[null,null,null]]);for(var k,l=null,n=0<h.length?h[0]:null,q=0;q<h.length;q++){k=l;var l=n,n=q+1<h.length?h[q+
1]:null,m=q+z.r1,p=d.rowHeight(m);if(0<p){var C=0;z.c1!=N&&(C=d.colLeft(z.c1)-d.colLeft(N));for(var u=0;u<l.length;u++){var r=u+z.c1,B=d.colWidth(r),t=l[u];if(0<B&&t){var w=t.horizontalMerge(),v=t.verticalMerge(),y=B,x=p;for(g=1;g<=w;g++)y+=d.colWidth(r+g);for(g=1;g<=v;g++)x+=d.rowHeight(m+g);!0===c&&(f[0][0]=ka(k,u-1),f[0][1]=ka(k,u),f[0][2]=ka(k,u+1),f[1][0]=ka(l,u-1),f[1][1]=t,f[1][2]=ka(l,u+1),f[2][0]=ka(n,u-1),f[2][1]=ka(n,u),f[2][2]=ka(n,u+1));t[b](a,r,m,C,e,y,x,f)}C+=B}e+=p}}},xa=function(a,
b,c,e,f,g,h,k,l){var n,q;void 0===g&&(g=d.colLeft(b)-d.colLeft(N));void 0===h&&(h=d.rowTop(c)-d.rowTop(H));void 0===k&&(k=d.colWidth(b));void 0===l&&(l=d.rowHeight(c));if(void 0===f)for(f=g,n=b-1;0<=n;n--){var m=d.getCell(n,c);if(m&&(m.t||m.v))break;f=d.colLeft(n)-d.colLeft(N)}var m=e.horizontalMerge(),p=e.verticalMerge();if((n="cs"===e.horizontalAlign())||0<m)for(q=1;(n||q<=m)&&!(n&&(n=d.getCell(b+q,c),n=!n||n.t||n.v?!1:"cs"===d.cellStyle(n.s).a,!n&&q>m));)k+=d.colWidth(b+q),q++;for(q=1;q<=p;q++)l+=
d.rowHeight(c+q);m=d.colLeft(N);p=d.colRight(C)-m;q=void 0;ba||(q=d.colRight(b)-m);for(b+=1;;b++){n=d.getCell(b,c);if(!n)break;if(n.t||n.v){q=d.colLeft(b)-m;break}n=d.colRight(b)-m;if(n>p)break;ba||(q=n)}e.layoutText(a,g,h,k,l,f,q)},Ha=function(a,b,c){c||(c=d.getCell(a,b));if(c)return g=c=new rd(c,d,a,b),m=a,O=b,c},Aa=function(a){var b;if(a>=R){a-=R;for(var c=N;c<d.colCount();){var e=Sa(c),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(b=c,a<=e))break;c++}}return b},Ba=function(a){var b;if(a>=R)for(a-=
R,b=N;!(a<Sa(b));b++);return b},Ga=function(a){var b;if(a>=K){a-=K;for(var c=H;c<d.rowCount();){var e=Ja(c),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(b=c,a<=e))break;c++}}return b},Ea=function(a){var b;if(a>=K)for(a-=K,b=H;!(a<Ja(b));b++);return b},za=function(a,b){var c;if(a)for(var d=0;d<a.length;d++){var e=a[d];if(0===Ta(e.range,b)){c=e;break}if(e.oldrange&&0===Ta(e.oldrange,b)){c=e;break}}return c},Oa=function(a){-1==ha&&-1==S&&(a=v.viewNode.mousePos(a),a=void 0!==Aa(a.x)?"col-resize":null,
n.css("cursor",a))},Qa=function(a){return-1==ha&&(a=Aa(a.center.x),void 0!==a)?(S=a,!1):!0},Ia=function(b){if(-1!=ha)b=Ba(b.center.x),P.select(sa(c.index,ha,0,b,d.rowCount()-1));else if(-1!=S){b=M((b.center.x-R)/B)+d.colLeft(N);var e=d.colLeft(S);b=b>=e?b-e:0;b!=d.colWidth(S)&&(d.setColWidth(S,b),P.update(),a.update(),L.positionAll(c))}return!1},Fa=function(a){-1!=S&&(S=-1,Y(),L.positionAll(c));return!1},Pa=function(a){ha=Ba(a.center.x);P.select(sa(c.index,ha,0,ha,d.rowCount()-1))},Ma=function(a){ha=
-1},Xa=function(a){-1==Z&&-1==da&&(a=v.viewNode.mousePos(a),a=void 0!==Ga(a.y)?"row-resize":null,u.css("cursor",a))},va=function(a){return-1==Z&&(a=Ga(a.center.y),void 0!==a)?(da=a,!1):!0},Ka=function(b){if(-1!=Z)b=Ea(b.center.y),P.select(sa(c.index,0,Z,d.colCount()-1,b));else if(-1!==da){b=M((b.center.y-K)/B)+d.rowTop(H);var e=d.rowTop(da);b=b>=e?b-e:0;b!=d.rowHeight(da)&&(d.setRowHeight(da,b),P.update(),a.update(),L.positionAll(c))}return!1},Va=function(a){-1!==da&&(da=-1,Y(),L.positionAll(c));
return!1},Wa=function(a){Z=Ea(a.center.y);P.select(sa(c.index,0,Z,d.colCount()-1,Z))},Ua=function(a){Z=-1},Ya=function(a){return M((d.rowTop(a)-d.rowTop(H))*B)},Ja=function(a){return M((d.rowBottom(a)-d.rowTop(H))*B)},bb=function(a){return M((d.colLeft(a)-d.colLeft(N))*B)},Sa=function(a){return M((d.colRight(a)-d.colLeft(N))*B)},fb=function(){void 0===J&&(J=c.childByClass("oit-sheet-embedpane"))&&v.viewNode.parent().append(J);return J},hb=function(){if(void 0===F){var a=fb();F=a?a.childByClass("oit-sheet-embedlist"):
null}return F};(function(){var a=v.viewNode;f=a.parent().childByClass("oit-ssoverlay");f||(f=y.create("div","oit-ssoverlay"),a.parent().insert(f,a));f.html("");Q=c.overlay.childByClass("oit-sel-text");Q||(Q=y.create("div"),c.overlay.append(Q));D=y.create("pre");Q.addClass("oit-sel-text");Q.html("");Q.append(D);qa=new pd;qa.show();E.onscroll(V);P.onselectionchanged(X);A.onpageload(U);la.onresize(Y);a=a.scroll();V(a.left,a.left,a.top,a.top,!1);Y(!1)})()}}(),qd=function(){function b(a,b,c){this.value=
a;this.type=b;this.subtype=c}function e(){this.items=[];this.add=function(a,c,d){d||(d="");a=new b(a,c,d);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?
null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function a(){this.items=[];this.pushToken=function(a,c,d){this.items.push(new b(a,c,d))};this.push=function(a){this.items.push(a)};this.pop=function(){var a=this.items.pop();return new b(a.value,a.type,x)};this.token=function(){return 0<this.items.length?this.items[this.items.length-1]:null};this.value=function(){return this.token()?this.token().value:""};this.type=function(){return this.token()?
this.token().type:""};this.subtype=function(){return this.token()?this.token().subtype:""}}function d(a,b,c,d){var e=!1,f=0,g=!1,h=0;a=a.replace(q,"");a=a.replace(ba,"@");a=a.replace(aa,"");var k=a.length,l=a.indexOf("!")+1,n="";0<l&&(n=a.slice(0,l-1));var m=a.slice(l,a.length),p=n.match(B);if(p&&d){var u=""+p[0],p="'";u.charCodeAt(0)==I&&(u=u.slice(1,u.length),p="");u=u.slice(1,u.length-1);u=parseInt(u,10);0<u&&u--;if(u<d.length){d=d[u];d=d.replace(P,"\\");var u=d.lastIndexOf("\\"),r;0<=u?(r=d.slice(u+
1,d.length),d=d.slice(0,u+1)):(r=d,d="");0===d.indexOf("file:\\\\\\")&&(d=d.slice(8,d.length));n="'"+n.replace(B,d+"["+r+"]")+p;n=n.replace(da," ")}}p=a.charCodeAt(l);l<k&&p==F&&(e=!0,l++,p=a.charCodeAt(l));for((d=l<k&&p>=L&&p<=M)||(g=e);l<k&&p>=L&&p<=M;)f=26*f+(p-L+1),l++,p=a.charCodeAt(l);16172<f&&(d=!1);l<k&&p==F&&(g=!0,l++,p=a.charCodeAt(l));for(u=l<k&&p>=K&&p<=C;l<k&&p>=K&&p<=C;)h=10*h+(p-K),l++,p=a.charCodeAt(l);e||(f+=b);g||(h+=c);0<f&&f--;""!==n&&(n+="!");return l==k&&(d||u)?n+(d?(e?"$":"")+
La(f):"")+(u?(g?"$":"")+h:""):n+m}function c(b){for(var c=new e,d=new a,C=0,B=function(){return b.substr(C,1)},I="",G=!1,aa=!1,J=!1,ba=!1;0<b.length;)if(" "==b.substr(0,1))b=b.substr(1);else{"="==b.substr(0,1)&&(b=b.substr(1));break}for(var O=/^[1-9]{1}(\.[0-9]+)?E{1}$/;!(C>=b.length);)if(G)'"'==B()?'"'==b.substr(C+1,1)?(I+='"',C+=1):(G=!1,c.add('"'+I+'"',k,A),I=""):I+=B(),C+=1;else if(aa)"'"==B()?"'"==b.substr(C+1,1)?(I+="'",C+=1):(I+=B(),aa=!1):I+=B(),C+=1;else if(J)"]"==B()&&(J=!1),I+=B(),C+=1;
else if(ba)I+=B(),C+=1,-1!=",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+I+",")&&(ba=!1,c.add(I,k,h),I="");else if(-1!="+-".indexOf(B())&&1<I.length&&I.match(O))I+=B(),C+=1;else if('"'==B())0<I.length&&(c.add(I,v),I=""),G=!0,C+=1;else if("'"==B())0<I.length?(c.add(I,v),I=""):I+=B(),aa=!0,C+=1;else if("["==B())J=!0,I+=B(),C+=1;else if("#"==B())0<I.length&&(c.add(I,v),I=""),ba=!0,I+=B(),C+=1;else if("{"==B())0<I.length&&(c.add(I,v),I=""),c.add("{",t,y),d.pushToken("}",t,x),c.add("",
t,y),d.pushToken("",t,x),C+=1;else if(";"==B())0<I.length&&(c.add(I,k),I=""),c.addRef(d.pop()),c.add(";",w),c.add("",t,y),d.pushToken("",t,x),C+=1;else if("}"==B())0<I.length&&(c.add(I,k),I=""),c.addRef(d.pop()),c.addRef(d.pop()),C+=1;else if(" "==B())for(0<I.length&&(c.add(I,k),I=""),c.add("",p),C+=1;" "==B()&&!(C>=b.length);)C+=1;else-1!=",>=,<=,<>,".indexOf(","+b.substr(C,2)+",")?(0<I.length&&(c.add(I,k),I=""),c.add(b.substr(C,2),l,D),C+=2):(-1!="+-*/^&=><".indexOf(B())?(0<I.length&&(c.add(I,k),
I=""),c.add(B(),l)):-1!="%".indexOf(B())?(0<I.length&&(c.add(I,k),I=""),c.add(B(),u)):"("==B()?0<I.length?(c.add(I.replace(q,"")+"(",t,y),d.pushToken(")",t,x),I=""):(c.add("(",r,y),d.pushToken(")",r,x)):","==B()?(0<I.length&&(c.add(I,k),I=""),d.type()!=t?c.add(B(),l,H):c.add(B(),w)):")"==B()?(0<I.length&&(c.add(I,k),I=""),c.addRef(d.pop())):I+=B(),C+=1);0<I.length&&c.add(I,k);for(d=new e;c.moveNext();)I=c.current(),I.type==p?c.BOF()||c.EOF()||(c.previous().type==t&&c.previous().subtype==x||c.previous().type==
r&&c.previous().subtype==x||c.previous().type==k)&&(c.next().type==t&&c.next().subtype==y||c.next().type==r&&c.next().subtype==y||c.next().type==k)&&d.add(" ",l,E):d.addRef(I);for(;d.moveNext();)I=d.current(),I.type==l&&"-"==I.value?d.BOF()?I.type=n:d.previous().type==t&&d.previous().subtype==x||d.previous().type==r&&d.previous().subtype==x||d.previous().type==u||d.previous().type==k?I.subtype=g:I.type=n:I.type==l&&"+"==I.value?d.BOF()?I.type=f:d.previous().type==t&&d.previous().subtype==x||d.previous().type==
r&&d.previous().subtype==x||d.previous().type==u||d.previous().type==k?I.subtype=g:I.type=f:I.type==l&&0===I.subtype.length?-1!="<>=".indexOf(I.value.substr(0,1))?I.subtype=D:I.subtype="&"==I.value?m:g:I.type==k&&0===I.subtype.length?isNaN(parseFloat(I.value))?I.subtype="TRUE"==I.value||"FALSE"==I.value?D:z:I.subtype=Q:I.type==t&&"@"==I.value.substr(0,1)&&(I.value=I.value.substr(1));d.reset();for(c=new e;d.moveNext();)d.current().type!=f&&c.addRef(d.current());c.reset();return c}var f="noop",k="operand",
t="function",r="subexpression",w="argument",n="operator-prefix",l="operator-infix",u="operator-postfix",p="white-space",v="unknown",y="start",x="stop",A="text",Q="number",D="logical",h="error",z="range",g="math",m="concatenate",E="intersect",H="union",F=36,L=65,M=90,K=48,C=57,I=39,q=/\u005F[^\u002E]*\u002E/,B=/^'?\u005B[0-9]+\u005D/,ba=/\u005B\u0023This Row\u005D/,aa=/\u005B\u005D/,da=/%20/g,P=/\u002F/g;return function(a,b,e,f){a=c(a);for(var g="",h;a.moveNext();){var k=a.current();if(k.subtype!=
H&&k.type!=w||!h||h.subtype!=z||64!=h.value.charCodeAt(h.value.length-1)){if(k.subtype==z){h=k;var l;l=k.value;var n=b,q=e,m=f,p=l.lastIndexOf(":");l=0<p?d(l.slice(0,p),n,q,m)+":"+d(l.slice(p+1),n,q,m):d(l,n,q,m);h.value=l}g+=k.value}h=k}return g}}(),md=function(){var b={ATTACHMENTS:"ATTACHMENT",BADDRESS:"BUSINESSADDRESS",BPHONE:"BUSINESSPHONE",CALENDAREXCEPTIONS:"CALENDAR_EXCEPTION",CATEGORY:"CATEGORIES",CREATED:"CREATION_TIME",DUEDATE:"DUE_DATE",ENDDATE:"DTEND",ENDTIME:"DTEND",ENTRYTYPE:"ENTRY_TYPE",
FAX:"BUSINESSFAX",HADDRESS:"HOMEADDRESS",HPHONE:"HOMEPHONE",IM:"IMADDRESS",LAST:"FAMILY",NAME:"FULLNAME",MOBILE:"MOBILEPHONE",OPTATTEND:"OPTATTENDEE",PERCENT:"PERCENT_COMPLETE",RECURRANGE:"RECURRENCE_RANGE",RECURTYPE:"RECURRENCE_TYPE",REQATTEND:"REQATTENDEE",STARTDATE:"START_DATE",STARTTIME:"DTSTART",TOPIC:"CONVERSATION_TOPIC"},e={FI_OUTLOOK_MSG_APPT:"calendarentry",FI_OUTLOOK_MSG_CDSMAIL:"msg",FI_OUTLOOK_MSG_CONTACT:"contact",FI_OUTLOOK_MSG_DISTLIST:"contactgroup",FI_OUTLOOK_MSG_JOURNAL:"journal",
FI_OUTLOOK_MSG_MAIL:"msg",FI_OUTLOOK_MSG_NDR:"msg",FI_OUTLOOK_MSG_NOTE:"note",FI_OUTLOOK_MSG_ODSMAIL:"msg",FI_OUTLOOK_MSG_POST:"note",FI_OUTLOOK_MSG_TASK:"task",FI_OUTLOOK_OFT_APPT:"calendarentry",FI_OUTLOOK_OFT_CDSMAIL:"msg",FI_OUTLOOK_OFT_CONTACT:"contact",FI_OUTLOOK_OFT_DISTLIST:"contactgroup",FI_OUTLOOK_OFT_JOURNAL:"journal",FI_OUTLOOK_OFT_MAIL:"msg",FI_OUTLOOK_OFT_NDR:"msg",FI_OUTLOOK_OFT_NOTE:"note",FI_OUTLOOK_OFT_ODSMAIL:"msg",FI_OUTLOOK_OFT_POST:"note",FI_OUTLOOK_OFT_TASK:"task",ai:"vector",
bmp:"image",cdr:"vector",cgm:"vector",chtml:"ie",cur:"image",dcx:"image",dgn:"vector",doc:"doc",docx:"doc",drw:"vector",dwg:"vector",dxf:"vector",emf:"vector",eml:"msg",fft:"text",gdf:"vector",gem:"vector",gif:"image",hdml:"ie",hpgl:"vector",htm:"ie",html:"ie",ico:"image",ics:"calendar",img:"image",indd:"image",jpg:"image",lwp:"text",mhtml:"ie",mpg:"video",mpp:"project",msg:"msg",odg:"vector",odi:"image",odt:"text",oft:"text",pbm:"image",pcd:"image",pct:"image",pcx:"image",pdf:"pdf",pdfi:"image",
pgm:"image",pic:"vector",pif:"vector",png:"image",ppm:"image",ppt:"ppt",pptx:"ppt",ps:"vector",psd:"image",psp:"image",pst:"msg",rtf:"text",sdw:"image",svg:"vector",tga:"image",tif:"image",txt:"text",vsd:"vsd",wbmp:"image",wmf:"vector",wml:"ie",wmv:"video",wpd:"text",wpg:"image",xbm:"image",xhtml:"ie",xlc:"xls",xls:"xls",xlsb:"xls",xlsx:"xls",xml:"ie",xmp:"ie",xpm:"image",yim:"text",zip:"zip"},a=function(a){S.call(this,a);y.attach(this);this._page=A.forNode(a);if(!this._page._fields&&(a=(a=this.byClass("oit-maildata"))?
a[0]:y.byId("oit-maildata"))){var d=this.byClass("oit-emhdrlabel"),D=this.byClass("oit-emhdrvalue"),h=[];if(d&&D&&d.length==D.length)for(var z=0;z<d.length;z++){var g=d[z],m=D[z];if("oit-email_attachments"!=g.id){var G={},H;g.id&&0===g.id.indexOf("oit-email_")&&(H=g.id.substring(10).toUpperCase(),G.id=b[H]||H);if(!G.id)for(H=0;;H++){var F=g.classList.item(H);if(!F)break;if(0===F.indexOf("oit-email_")){H=F.substring(10).toUpperCase();G.id=b[H]||H;break}}G.id||(G.label=g.html());g=m.attr("data-acc");
1==m.dom.childElementCount?m=m.firstChildElem():(H=y.create("div"),H.transferFrom(m),m=H);g&&(m.attr("data-acc",g),"none"===g&&m.addClass("oit-noacc"));G.value=m.dom.outerHTML;h.push(G)}}this._page._fields=h;a.destroy()}this.html('<div class="oit-headerpadding"><table class="oit-maildata"></table><div class="oit_attachments oit-noacc" data-acc="none"></div></div><div class="oit-emextra"><div class="oit-em_allheaders"><table class="oit-emheadervalues"></table></div></div>');this._hdrtable=this.byClass("oit-maildata")[0];
a=this.parent().parent();a.hasClass("oit-emailstream")&&(d=y.create("div","oit-emailbk"),d.transferFrom(a),a.append(d),a.addClass("oit-emailfill"));d=this._page._fields;a=this.byClass("oit-em_allheaders")[0];if(x.removeExtraEmailHeaders||v.isMobile)a.destroy(),a=null;c(d);switch(this.data("subtype")){case "journal":D=x.journalHeader;break;case "contact":D=x.contactHeader;break;case "note":D=x.noteHeader;break;case "appt":D=x.appointmentHeader;break;case "task":D=x.taskHeader;break;case "post":D=x.postHeader;
break;case "dist":D=x.distroHeader;break;default:D=x.emailHeader}h=this._page._fields;if(D.subjectField)if(G=u(h,D.subjectField),z=u(h,D.dateField),!D.subjectField&&!D.dateField||G||!1===D.defaultSubject||(G=new Nc({id:"SUBJECT",value:'<div class="oit-emhdrvalue oit-textfield"><div><span></span></div></div>'})),G){if(G.addedToHeader=!0,m=this.subjectBar=y.create("div","oit-email-subjectbar"),g=G.clone(),g.addContainerClass("oit-email-subject"),g.appendAsDiv(m),g.labelElem.html(""),this.fixedSubjectField=
g,g.valueElem.text()||(g.valueElem.addClass("oit-nosubject"),g.valueElem.text(U.NO_SUBJECT)),g=this._hdrtable.parent(),g.insert(m,g.firstChildElem()),G.hide(),z&&(this.headerDateField=z,G=z.clone(),G.addContainerClass("oit-email-date"),G.appendAsDiv(m),this.fixedDateField=G,z.appendAsRow(this._hdrtable),z.hide()),!v.isMobile&&(z=m.clone(!0)))this.stickyHeader=y.create("div","oit-email-stickyheader"),this.stickyHeader.append(z),this.stickyHeader.onmouseover(this,p),this.stickyHeader.onmouseout(this,
J),this.stickyHeader.ontap(this,E),v.viewNode.parent().append(this.stickyHeader),this.stickyHeaderVisible=!1,this.stickyDateFixedField=this.stickyHeader.byClass("oit-email-date"),Array.isArray(this.stickyDateFixedField)&&(this.stickyDateFixedField=this.stickyDateFixedField[0])}else this.addClass("oit-nosubject");D.photoField&&(z=u(h,D.photoField))&&(z.addContainerClass("oit-email-photo"),z.insertAsDiv(this._hdrtable.parent(),this._hdrtable),z.labelElem.html(""));D.logoField&&(z=u(h,D.logoField))&&
(z.addContainerClass("oit-email-logo"),z.insertAsDiv(this._hdrtable.parent(),this._hdrtable),z.labelElem.html(""));if(D.headerFields)for(m=y.create("tbody"),G=0;G<D.headerFields.length;G++)if(g=D.headerFields[G],"string"==typeof g||Array.isArray(g))(H=u(h,g))&&H.appendAsRow(this._hdrtable);else if(g.fields)if(g.multi){H=[];for(z=0;z<g.fields.length;z++)l(h,g.fields[z],null,H);for(z=0;z<H.length;z++)H[z].appendAsRow(this._hdrtable)}else if(g.title){F=[];for(z=0;z<g.fields.length;z++)if(H=u(h,g.fields[z]))H.showType(!1),
F.push(H);if(0<F.length)for(m.html('<tr><td class="oit-emhdrsection" colspan="3"><span data-acc="none" class="oit-noacc">'+U["EMAIL_"+g.title]+U.LABEL_SEPARATOR+"</span></td></tr>"),this._hdrtable.append(m.firstChildElem()),z=0;z<F.length;z++)F[z].appendAsRow(this._hdrtable)}if(this.stickyHeader){this.stickyHeaderDetail=y.create("div","oit-shdetail");this.stickyHeaderDetailShown=!1;D=y.wrap(this._hdrtable.clone(!0));z=!1;m=0;for(G=D.firstChildElem();G;G=h)h=G.nextSiblingElem(),m++,z||(20<m?z=!0:G.firstChildElem().hasClass("oit-emhdrsection")&&
(z=!0)),z&&G.destroy();this.stickyHeaderDetail.append(D);this.stickyHeader.append(this.stickyHeaderDetail);this.stickyDateHeaderField=D.byClass("DATE");this.stickyDateHeaderField||(this.stickyDateHeaderField=D.byClass("RECEIVED"));Array.isArray(this.stickyDateHeaderField)&&(this.stickyDateHeaderField=this.stickyDateHeaderField[0]);this.stickyDateHeaderField&&(this.stickyDateHeaderField=this.stickyDateHeaderField.parent());n(this.stickyHeader)}f(d)&&(this._emailExpander=y.create("div","oit-showemail"),
this._emailExpander.onclick(this,w),this._emailExpander.ontap(this,w),this._hdrtable.parent().insert(this._emailExpander,this._hdrtable),x.showEmailAddresses?t.call(this):r.call(this));if(a)if(D=a.firstChildElem(),d=k(D,d))for(this.allHeaders=new sd(this,a,"oit-email_gear_icon",18,18,U.SHOWDETAILS,U.HIDEDETAILS),this.byClass("oit-headerpadding")[0].append(this.allHeaders),D=0;D<d.length;D++)d[D].tab=this.allHeaders;else a.destroy(),a=null;a||this.removeExtraEmailHeaders();if((a=this._page._attachments)&&
0<a.length){d=this.byClass("oit_attachments")[0];D=y.create("div");for(h=0;h<a.length;h++)z=a[h],z.ext||(m=z.name,G=m.lastIndexOf("."),z.ext="",-1!=G&&(z.ext=m.substring(G+1).toLowerCase())),(m=e[z.file_id]||e[z.ext])||(m="generic"),m=['<div class="oit-attached-file" data-index="',z.id,'">','<div class="oit-ficon oit-ficon-',m,'"><div></div></div>','<div class="oit-attinfo">',"<div>",z.displayName||z.name,"</div>"],z.size&&(m.push("<div>"),z.size&&m.push(xc(z.size)),m.push("</div>")),m.push("</div></div>"),
D.html(m.join("")),m=D.firstChildElem(),d.append(m),tb.on.addElement(m,z.id);D.html('<div style="clear:both;"></div>');d.append(D.firstChildElem())}this._page.pageContentChanged();this.applyShowEmailAddresses();this.onStyleChanged()},d=V(a,S);d.destroy=function(){tb.on.removeAllElements();this.stickyHeader&&this.stickyHeader.destroy();S.prototype.destroy.call(this)};var c=function(a,b){if(a)for(var d=0;d<a.length;d++){var e=a[d];e.appendAsRow||(a[d]=new Nc(e,b));e.subfields&&c(e.subfields,a[d])}},
f=function(a){var b=!1;if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d.addedToHeader&&d.hasEmailAddresses){b=!0;break}if(d.subfields&&(b=f(d.subfields)))break}return b},k=function(a,b,c){c||(c=[]);if(b){var d,e;for(d=0;d<b.length;d++)e=b[d],e.subfields||e.addedToHeader||!e.hasValue()||(e.appendToExtra(a),e.extra=!0,c.push(e));for(d=0;d<b.length;d++)if(e=b[d],e.subfields){var f=a,l=c,n=e.subfields;if(n)for(var p=!0,u=0;u<n.length;u++){var r=n[u];if(!r.addedToHeader&&(r.hasValue()||r.subfields)){if(e&&
p){var t=U["EMAIL_"+e.fieldId];if(t||e.fieldDef.label){var w,p=[];p.push('<tr><td class="oit-emhdrsection" colspan="2">');e.fieldType&&(w=e.fieldType.substring(1,e.fieldType.length-1));t?p.push('<span data-acc="none" class="oit-noacc">',t):p.push(e.fieldDef.label,'<span data-acc="none" class="oit-noacc">');w&&p.push(" (",w,")");p.push(U.LABEL_SEPARATOR,"</span></td><td></td></tr>");p=p.join("");t=y.create("tbody");t.html(p);f.append(t.firstChildElem())}p=!1}r.appendToExtra(f);l.push(r)}r.subfields&&
k(f,r.subfields,l)}}}return 0===c.length?null:c};d.applyShowEmailAddresses=function(){this._emailExpander&&(x.showEmailAddresses?t.call(this):r.call(this),this.applyViewSize(!0))};var t=function(){this._emailExpander&&(this._page.addClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.addClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-showemail").addClass("oit-hideemail"),A.each("pageLayoutChanged"))},r=function(){this._emailExpander&&(this._page.removeClass("oit-email-addr-visible"),
this.stickyHeader&&this.stickyHeader.removeClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-hideemail").addClass("oit-showemail"),A.each("pageLayoutChanged"))},w=function(){x.showEmailAddresses=!x.showEmailAddresses},n=function(a){a.attr("data-acc")&&a.attr("data-acc","none");for(a=a.firstChildElem();a;a=a.nextSiblingElem())n(a)},l=function(a,b,c,d){if(b&&a){var e,f;if(Array.isArray(b))for(e=0;e<b.length;e++)l(a,b[e],null,d);else if(b.g)for(c=b.t?";"+b.t+";":null,e=0;e<a.length;e++)f=
a[e],f.subfields&&f.fieldId==b.g&&(c?f.fieldType&&-1!=f.fieldType.indexOf(c)&&l(f.subfields,b.id,b.d,d):l(f.subfields,b.id,b.d,d));else if("string"==typeof b)for(e=0;e<a.length;e++)if(f=a[e],f.fieldId==b&&!f.addedToHeader&&(f.hasValue()||f.isCompound())){d.push(f);var h=null;if(c&&"string"==typeof c)for(var k=0;k<a.length;k++){var n=a[k];if(n.hasValue()&&!n.addedToHeader&&n.fieldId==c){h=n;break}}f.setDisplayField(h)}}},u=function(a,b){if(a&&b){var c=[];l(a,b,null,c);if(1<=c.length)return c[0]}},
p=function(){if(this.stickyHeaderDetail&&!P.isSelecting()){var a=this.stickyHeaderDetail.firstChildElem().outerHeight;this.stickyHeaderDetail.css("height",""+a+"px");this.stickyHeaderDetailShown=!0}},J=function(){this.stickyHeaderDetail&&(this.stickyHeaderDetail.css("height",null),this.stickyHeaderDetailShown=!1)},E=function(){this.stickyHeaderDetailShown?J.call(this):p.call(this)};d.applyViewSize=function(a){var b;this.stickyHeader&&this.stickyHeader.css("width",null);this.fixedSubjectField&&(a=
this.fixedSubjectField.containerWidth(),this.fixedDateField&&(this.fixedDateField.show(),a+=this.fixedDateField.containerWidth()),b=v.viewNode.clientWidth,x.nochrome||(b-=42),a>b?(this.fixedDateField&&this.fixedDateField.hide(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display","none"),this.headerDateField&&this.headerDateField.show(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display",null)):(this.fixedDateField&&this.fixedDateField.show(),this.stickyDateFixedField&&
this.stickyDateFixedField.css("display",null),this.headerDateField&&this.headerDateField.hide(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display","none")));this.stickyHeader&&(a=this._page.parent().offsetWidth,b=v.viewNode.clientWidth,x.nochrome||(a-=2,b-=21),a>b&&(a=b),this.stickyHeader.css("width",a+"px"));if(!this._page.isHidden())L.onEmailHeaderResize(this._page.index);this._page.overlay.each("pageLayoutChanged")};d.finishAnimation=function(){this._page&&this._page.finishAnimation()};
d.showStickyHeader=function(){if(this.stickyHeader&&this.subjectBar&&(this.stickyHeaderVisible||(this.stickyHeader.addClass("oit-email-shvisible"),x.nochrome?this.stickyHeader.addClass("oit-nochrome"):this.stickyHeader.removeClass("oit-nochrome"),this.stickyHeaderVisible=!0),this.stickyHeaderVisible&&!x.nochrome)){var a=v.viewNode.scrollLeft;0===a?this.stickyHeader.css("left",null):this.stickyHeader.css("left",21-a+"px")}};d.hideStickyHeader=function(){this.stickyHeader&&this.subjectBar&&this.stickyHeaderVisible&&
(this.stickyHeader.removeClass("oit-email-shvisible"),this.stickyHeaderVisible=!1)};d.onScroll=function(){this.stickyHeader&&this.subjectBar&&(0>this.subjectBar.pos(this.stickyHeader.parent()).top?this.showStickyHeader():this.hideStickyHeader())};d.beginSelection=function(a){this._selectionPos=null;this.showEmailHeader(a)};d.getEmailFieldForRange=function(a){var b;if(a&&"text"==a.type){var c=this._page._fields,d;for(d in c){var e=c[d];if("custom"===d)for(var f=0;f<e.length;f++){if(b=e[f].subfieldByRange(a))return b}else if(b=
e.subfieldByRange(a))return b}}};d.moveto=function(a,b,c){return(a=this.showEmailHeader(a,b,c))&&a.tab?!0:!1};d.showEmailHeader=function(a,b,c){if(a&&"text"==a.type){var d=this.getEmailFieldForRange(a);if(d)if(d.field&&this.hideStickyHeader(),d.tab)c=c||{},d.tab.activate(null,!0),d.tab.scrollToRange(a),b&&b(c),this._selectionPos="tab";else{for(var e=d.addresses;!e&&d.groupField;)d=d.groupField,e=d.addresses;if(e&&!x.showEmailAddresses)for(var f=0;f<e.length;f++){var k=e[f].address;if(k){var l=k.acc;
if(l+k.text.length>=a.acc&&l<=a.accend){x.showEmailAddresses=!0;break}}}b&&b(c)}return d}};d.onStyleChanged=function(){this.applyEmailHeaderStyles()};d.applyEmailHeaderStyles=function(){try{this._headerStyle&&this.css(this._headerStyle),this.applyViewSize()}catch(G){this.logError("email header style","An error occurred setting email header style")}};var F=function(a,b){var c=!1;if(a.subfields)for(var d=a.subfields.length-1;0<=d;d--)F(a.subfields[d],b)&&a.subfields.splice(d,1);if(!a.addedToHeader||
a.extra)a.range&&b.push(a.range),c=!0;return c};d.removeExtraEmailHeaders=function(){this.allHeaders&&this.allHeaders.activate(null,!1);var a=this._page._fields;if(a){for(var b=[],c=a.length-1;0<=c;c--)F(a[c],b)&&a.splice(c,1);b.length&&(na.replaceRawText(b),L.removeFromRange(b))}this.allHeaders&&(this.allHeaders.destroy(),delete this.allHeaders)};return a}(),sd=function(){var b=function(b,d,e,t,r,w,n){S.call(this,"div","oit-button");y.attach(this);e&&this.addClass(e);this._header=b;this._minHeight=
this._fullHeight=r;this._clientDiv=d;this._active=!1;this._utip=w;n&&(this._atip=n);w&&this.attr("title",w);if(this._clientDiv)this._clientDiv.on("scroll",null,a,this);this.on("click",this,this.activate,"toggle");this.on("tap",this,this.activate,"toggle")},e=V(b,S);e.destroy=function(){this._clientDiv&&(this._clientDiv.offscroll(a),delete this._clientDiv);this.offclick(this.activate);this.offtap(this.activate);S.prototype.destroy.call(this)};var a=function(a,b){var c=b._clientDiv.scroll();b._scroll&&
c.left==b._scroll.left&&c.top==b._scroll.top||(b._scroll=c,c=A.page(0),L.deactivate(),c.pageLayoutChanged(),L.positionAll(c))};e.isActive=function(){return this._active};e.containsRange=function(a){var b=y.wrap(a.startContainer);a=y.wrap(a.endContainer);var c=y.isDescendantOf(b,this._clientDiv);if(c||y.isDescendantOf(a,this._clientDiv))return{tab:this,rangeElem:c?b:a}};e.scrollToRange=function(b){if(this._clientDiv.childByClass("oit-emheadervalues")&&(b=F.rangeRect(b,"view"))){var c=0,d=0,e=v.viewNode.clientWidth,
r=v.viewNode.clientHeight;0>b.left?c=b.left-10:b.right>e&&(c=b.right+10-e);0>b.top?d=b.top-10:b.bottom>r&&(d=b.bottom+10-r);if(c||d)v.viewNode.dscroll(c,d),a(null,this)}};var d=function(a,b,d){(b=b.getEmailFieldForRange(a.range))&&b.tab&&(a.id==L.active()&&L.deactivate(),a.removeFromPage(d))};e.activate=function(a,b){var c=this._active;"toggle"==b?c=!c:"boolean"===typeof b&&(c=b);if(c!==this._active){var e=this._header._page;this._header.finishAnimation();(this._active=c)||"tab"!==this._selectionPos||
P.select(null);c||(L.each(d,e,this._header,e.index),v.viewNode.scroll(0,0));c?(this.addClass("oit-activetab"),this._clientDiv.parent().addClass("oit-activetab"),this._atip&&this.attr("title",this._atip)):(this.removeClass("oit-activetab"),this._clientDiv.parent().removeClass("oit-activetab"),this._utip&&this.attr("title",this._utip));this._header.applyViewSize()}};return b}(),Nc=function(){var b="TO CC BCC FROM EMAIL EMAIL2 EMAIL3 RCVD_REPRESENTING_ADDRESS RECEIVED_BY_EMAIL_ADDRESS SENDER_EMAIL_ADDRESS SENT_REPRESENTING_EMAIL_ADDRESS".split(" "),
e=["ORGANIZER","ATTENDEES"],a=function(a,b){S.call(this);this.fieldDef=a;a.id&&(this.fieldId=a.id);a.type&&(this.fieldType=";"+a.type+";");a.subfields&&(this.subfields=a.subfields);a.range&&(this.range=a.range);this.container=y.create("div");b&&(this.groupField=b,this.showGroupType=!0);this.addedToHeader=!1},d=V(a,S);d.clone=function(){return new a(this.fieldDef)};d.isCompound=function(){return this.subfields&&0<this.subfields.length&&-1!=e.indexOf(this.fieldId)};d.show=function(){this.container.css("display",
null);this.container.attr("data-acc",null)};d.hide=function(){this.container.css("display","none");this.container.attr("data-acc","none")};d.showType=function(a){this.showGroupType=!!a};d.subfieldById=function(a){var b,c;if(a)if(Array.isArray(a))for(c=0;c<a.length&&!(b=this.subfieldById(a[c]));c++);else for(c=0;c<this.subfields.length;c++){var d=this.subfields[c];if(d.fieldId==a){b=d;break}}return b};d.subfieldByRange=function(a){var b;if(this.subfields)for(var c in this.subfields){var d=this.subfields[c];
if("custom"==c)for(var e=0;e<d.length&&!(b=d[e].subfieldByRange(a));e++);else b=d.subfieldByRange(a);if(b)break}b||this.range&&Fc(this.range,a)&&(b=this);return b};d.toTagName=function(a,b){var c=f(this.container,a);if(this.labelElem){var d=f(this.labelElem,b);d.transferFrom(this.labelElem);c.append(d);this.labelElem=d}this.valueElem&&(d=f(this.valueElem,b),d.transferFrom(this.valueElem),c.append(d),this.valueElem=d);(d=this.container.parent())&&d.insert(c,this.container);this.container.destroy();
this.container=c};d.containerWidth=function(){return this.container.offsetWidth};d.addContainerClass=function(a){this.container.addClass(a)};d.prepForMainHeader=function(){this.addedToHeader||(this.addedToHeader=!0,this.parseEmailAddresses(),this.buildFieldValue())};d.appendAsRow=function(a){this.prepForMainHeader();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};d.appendAsDiv=function(a){this.prepForMainHeader();
"DIV"!==this.container.tagName&&this.toTagName("div","div");a.append(this.container)};d.insertAsDiv=function(a,b){this.prepForMainHeader();"DIV"!==this.container.tagName&&this.toTagName("div","div");a.insert(this.container,b)};d.appendToExtra=function(a){this.addedToHeader=!0;this.buildFieldValue();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};d.parseEmailAddresses=function(){this.addresses||(this.isCompound()?
(this.addresses=[],c(this,this.addresses),0===this.addresses.length&&delete this.addresses):this.fieldDef.value&&-1!=b.indexOf(this.fieldId)&&this.parseStandardEmailAddresses())};d.parseStandardEmailAddresses=function(){if(this.range){var a=y.create("div");a.html(this.fieldDef.value);for(var b,c=a.createTreeWalker(),d=c.firstACCNode(),a=[],e;d;){d=c.currentNode;if(1===d.nodeType)(d=y.data(d,"acc"))&&(b="none"===d?void 0:Number(d));else if(3===d.nodeType&&0<d.nodeValue.length&&void 0!==b){var f=b+
d.nodeValue.length;e&&e.accend!=b&&(e=null);e?e.accend=f:(e={text:d.nodeValue,acc:b,accend:f},a.push(e));b+=d.nodeValue.length}d=c.nextACCNode()}for(c=b=0;c<a.length;c++){e=a[c];d=e.text;e=e.acc;var f=[],k=d.toUpperCase(),t=(d.match(/@/g)||[]).length,v=(k.match(/CN=/g)||[]).length,k=(k.match(/((\[([^\[\]])*\/CN([^\[\]])*\])+)/g)||[]).length,t=0===v?t+k:0===k?t+v:t+Math.min(v,k);if(0===t)d=f;else{var x=w(d,/((?:[^;"']|"[^"]*"|'[^']*')+)/g,t),v=w(d,/((?:[^;"]|"[^"]*")+)/g,t),k=w(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,
t),t=w(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,t);if(!x||v.diff<x.diff)x=v;if(!x||k.diff<x.diff)x=k;if(!x||t.diff<x.diff)x=t;if(x){if(t=x.list)for(var h=0,v=0;v<t.length;v++){k=t[v];h=d.indexOf(k,h);if(-1==h)break;var x=e+h,h=h+k.length,z=null,g=null,m=-1,A=-1,E=k.lastIndexOf("<"),F=k.lastIndexOf(">"),L=k.lastIndexOf("["),M=k.lastIndexOf("]"),K=void 0,C=void 0;0<=E&&F>E?(K=E,C=F):0<=L&&M>L&&(K=L,C=M);void 0!==K&&C+1<k.length&&(K=void 0);void 0!==K?(z=k.substring(0,K),m=x,g=k.substring(K+1,C),A=x+K+1):
(F=k.toUpperCase(),E=F.indexOf("CN="),0<E&&"/"!==F.charAt(E-1)&&(E=-1),0<=E?(g=k,A=x,z=k.indexOf("/",E),-1==z&&(z=k.length),z=k.substring(E+3,z),m=x+E+3):-1!=k.indexOf("@")?(g=k,A=x):(z=k,m=x));z=r(z,m);g=r(g,A);z||(z=g,g=null);(z||g)&&f.push({name:z,address:g})}d=f}else d=void 0}d&&0<d.length&&(b++,this.addresses=this.addresses?this.addresses.concat(d):d)}b!=a.length&&delete this.addresses}};d.markAddedToHeader=function(a){this.addedToHeader=!0;if(a&&this.subfields)for(var b=0;b<this.subfields.length;b++)this.subfields[b].markAddedToHeader(a)};
var c=function(a,b){switch(a.fieldId){case "ORGANIZER":case "ATTENDEE":var d=a.subfieldById("DISPLAYAS"),e=a.subfieldById("EMAIL")||a.subfieldById("ORGANIZER");if(d&&d.fieldDef&&d.fieldDef.value&&d.fieldDef.range&&e&&e.fieldDef&&e.fieldDef.value&&e.fieldDef.range){var f=y.create("div");f.html(d.fieldDef.value);var k=f.text();f.html(e.fieldDef.value);f=f.text();k=r(k,d.fieldDef.range.acc);f=r(f,e.fieldDef.range.acc);k&&f&&(b.push({name:k,address:f}),a.markAddedToHeader(!0))}break;case "ATTENDEES":for(d=
0;d<a.subfields.length;d++)c(a.subfields[d],b)}};d.setDisplayField=function(a){if(a&&this.fieldDef.value&&this.range&&a.fieldDef.value&&a.range){var b=y.create("div");b.html(a.fieldDef.value);var c=r(b.text(),a.range.acc);b.html(this.fieldDef.value);b=r(b.text(),this.range.acc);c&&b&&(this.displayField=a,this.displayField.addedToHeader=!0,this.addresses=[{name:c,address:b}])}else delete this.displayField,delete this.addresses};d.hasValue=function(){return"string"==typeof this.fieldDef.imageurl||"string"==
typeof this.fieldDef.value};d.buildFieldValue=function(){var a=this.fieldDef,b;this.container.html("");if(!this.labelElem){var c;a.id&&(c=U["EMAIL_"+a.id])&&(a.label=c);var d=y.create("div","oit-emhdrlabel");b=[];c||("string"==typeof a.label?b.push(a.label):b.push(U.UNKNOWN_FIELD));b.push('<span data-acc="none" class="oit-noacc">');c&&b.push(a.label);this.groupField&&this.showGroupType&&this.groupField.fieldDef.type&&b.push(" (",this.groupField.fieldDef.type,")");a.label&&-1!=a.label.indexOf(U.LABEL_SEPARATOR)||
b.push(U.LABEL_SEPARATOR);b.push("</span>");d.html(b.join(""));this.labelElem=d}if(!this.valueElem){if("string"==typeof a.imageurl)b='<img src="'+a.imageurl+'"/>',this.valueElem=y.create("div","oit-fieldimage"),this.valueElem.html(b);else if(this.addresses){this.valueElem=y.create("div");this.valueElem.html(a.value);b=[];for(c=0;c<this.addresses.length;c++)d=this.addresses[c],b.push('<span class="oit-email-a">'),0<c&&k(", ",b),d.name&&t(d.name.text,d.name.acc,"oit-email-aname",d.address?d.address.text:
null,null,null,b),d.address&&(t(d.address.text,d.address.acc,"oit-email-aaddr",null," [","]",b),this.hasEmailAddresses=!0),b.push("</span>");this.valueElem.html(b.join(""));this.valueElem.removeData("acc")}else"string"==typeof a.value&&(this.valueElem=y.create("div"),this.valueElem.html(a.value));if(this.valueElem&&(this.valueElem.addClass("oit-emhdrvalue"),a.id&&(a=a.id,this.groupField&&(a=this.groupField.fieldDef.id+"/"+a),this.valueElem.attr("data-fieldid",a)),this.valueElem.hasClass("oit-noacc"))){var e;
this.valueElem.hasClass("oit-datetime-field")?e=Jb(this.valueElem.text()):this.valueElem.hasClass("oit-date-field")?e=vc(this.valueElem.text()):this.valueElem.hasClass("oit-time-field")&&(e=wc(this.valueElem.text()));e&&this.valueElem.text(e)}}this.labelElem&&this.container.append(this.labelElem);this.valueElem&&this.container.append(this.valueElem)};var f=function(a,b){var c=y.create(b);c.addClass(a.attr("class"));var d=a.attr("data-acc");d&&c.attr("data-acc",d);(d=a.attr("data-fieldid"))&&c.attr("data-fieldid",
d);return c},k=function(a,b){b.push('<span class="oit-noacc" data-acc="none">',a,"</span>")},t=function(a,b,c,d,e,f,r){a=Ab(a);d=Ab(d);r.push("<span");d&&r.push(' title="',d,'"');0>b&&(c=c?c+" oit-noacc":"oit-noacc");c&&r.push(' class="',c,'"');e||f?(r.push(">"),e&&(0>b?r.push(e):k(e,r)),r.push("<span",' data-acc="'),0<b?r.push(b):r.push("none"),r.push('">',a,"</span>"),f&&(0>b?r.push(f):k(f,r))):(r.push(' data-acc="'),0<b?r.push(b):r.push("none"),r.push('">',a));r.push("</span>")},r=function(a,b){if(a){for(var c=
0;c<a.length&&/\s/.test(a[c]);c++)b++;a=a.trim();if(2<=a.length){var c=a.charAt(0),d=a.charAt(a.length-1);'"'!=c&&"'"!=c||c!=d||(b++,a=a.substring(1,a.length-1),(c=r(a,b))?(a=c.text,b=c.acc):a=null)}}return a?{text:a,acc:b}:null},w=function(a,b,c){if(a=a.match(b)){for(b=0;b<a.length;b++);b=0;if(a)for(var d=0;d<a.length;d++)(0<a[d].indexOf("@")||0<=a[d].indexOf("CN="))&&b++;if(0<b)return{list:a,count:b,diff:Math.abs(b-c)}}};return a}(),td=function(){var b=function(){S.call(this,"div","oit-scrollpane");
this.addClass("oit-scrollpanebar");this.html('<div class="oit-scrollpanecontent"></div><div class="oit-scrollbar"><div></div></div><div class="oit-scrollpaneup oit-fade"></div><div class="oit-scrollpanedn oit-fade"></div><div class="oit-scrollpaneup oit-ellip">&#x2022; &#x2022; &#x2022;</div><div class="oit-scrollpanedn oit-ellip">&#x2022; &#x2022; &#x2022;</div>');this.prop("scrollbar",this.childByClass("oit-scrollbar"),!1,!0);this.prop("scrollthumb",this.scrollbar.firstChildElem(),!1,!0);this.prop("scrollup",
this.byClass("oit-scrollpaneup"),!1,!0);this.prop("scrolldown",this.byClass("oit-scrollpanedn"),!1,!0);v.isMobileOrTablet&&(this.kinetic(!0),this.onpanstart(this,r),this.onpanmove(this,w));this.scrollbar.onclick(this,d);this.scrollbar.ontap(this,d);this.scrollthumb.ondragstart(this,c);this.scrollthumb.ondragmove(this,f);this.scrollthumb.ondragend(this,k);this.scrollthumb.ondragcancel(this,k);this.scrollthumb.onclick(this,t);this.prop("content",this.childByClass("oit-scrollpanecontent"),!1,!0);this.content.onwheel(this,
a);this.onmouseover(this,function(){this.addClass("oit-hover")});this.onmouseout(this,function(){this.removeClass("oit-hover")});y.attach(this)},e=V(b,S);Object.defineProperties(e,{scrollLeft:{get:function(){return 0},set:function(a){}},scrollTop:{get:function(){return-this.content.offsetTop},set:function(a){this.setScrollTop(a,!0)}},minScroll:{get:function(){return 0}},maxScroll:{get:function(){var a=this.content.outerHeight-this.clientHeight;0>a&&(a=0);return a}},contentHeight:{get:function(){return this.content.outerHeight}},
visibleHeight:{get:function(){return this.clientHeight}},enabled:{get:function(){return this.content.outerHeight>this.clientHeight}}});e.setScrollTop=function(a,b){if("number"===typeof a){var c=this.minScroll,d=this.maxScroll;a<c?a=c:a>d&&(a=d);this.content.offsetTop!=-a?(this.content.offsetTop=-a,!1!==b&&this.update(a),"function"===typeof K.UIEvent?c=new UIEvent("scroll"):(c=X.createEvent("UIEvents"))&&c.initUIEvent&&c.initUIEvent("scroll",!0,!1,K,null,2),c&&this.dispatchCustom("scroll",c)):!1!==
b&&this.update(a);return a}};e.scrollIntoView=function(a){var b;a instanceof S?b=a.rect(this.content):a instanceof ja&&(b=a);b&&(a=this.scrollTop,b.bottom>=a+this.visibleHeight&&(a=b.bottom+11-this.visibleHeight),b.top<=a&&(a=b.top-11),this.scrollTop=a)};e.isVisible=function(a){var b;a instanceof ja?b=a:a instanceof S&&(b=a.rect(this.content));return b?(a=this.scrollTop*x.zoom,b.top<a+this.visibleHeight*x.zoom&&b.bottom>a):!1};e.update=function(a){if(void 0===a)this.setScrollTop(this.scrollTop);else{if(this.scrollbar){var b=
this.content.outerHeight,c=this.clientHeight;c>=b?(this.scrollbar.css("display","none"),this.removeClass("oit-scrollable")):(c=100*c/b,1>c&&(c=1),this.scrollthumb.css({top:100*a/b+"%",height:c+"%"}),this.scrollbar.css("display",null),this.addClass("oit-scrollable"))}if(this.scrollup){b=0<a;c=a<this.maxScroll;for(a=0;a<this.scrollup.length;a++)this.scrollup[a].css("opacity",b?null:0);for(a=0;a<this.scrolldown.length;a++)this.scrolldown[a].css("opacity",c?null:0)}}};var a=function(a){if(!a.ctrlKey&&
this.enabled){var b=a.deltaY;if(1==a.deltaMode||2==a.deltaMode)b*=12;this.scrollTop+=b;return!1}},d=function(a){if(a.offsetY){var b=this.content.outerHeight,c=this.clientHeight,d=this.scrollTop/b;a=a.offsetY/this.clientHeight;a<d?this.scrollTop-=c:a>d+c/b&&(this.scrollTop+=c)}},c=function(a){this.scrollthumb._topPercent=100*this.scrollTop/this.content.outerHeight;this.scrollbar.css("opacity",.1);return!1},f=function(a){var b=this.content.outerHeight,c=100*(b-this.clientHeight)/b;a=this.scrollthumb._topPercent+
100*a.delta.y/this.clientHeight;0>a?a=0:a>c&&(a=c);this.scrollTop=a*b/100;return!1},k=function(a){delete this.scrollthumb._topPercent;this.scrollbar.css("opacity",null);return!1},t=function(a){return!1},r=function(a){return!1},w=function(a){this.scrollTop-=a.delta.y;return!1};e.redirectEvent=function(b){var c=!0;"wheel"==b.type&&(a.call(this,b),c=!1);return c};return b}(),Mb={paragraph:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,
title:"COMMENT"},slide:{requireText:!1,skipIfNoText:!1,showIcon:!0,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},page:{requireText:!1,skipIfNoText:!1,showIcon:!0,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},cell:{requireText:!0,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},add:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,
textCls:"oit-anno-add",badgeCls:null,title:"INSERTED_TEXT"},"delete":{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:null,title:"DELETED_TEXT"},change:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!0,checkRanges:!0,textCls:"oit-anno-change",badgeCls:null,title:"CHANGED_TEXT"},hidden:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:"oit-badge-delete",title:"HIDDEN_TEXT"},
add_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_ROW"},delete_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_ROW"},add_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_COLUMN"},delete_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,
textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_COLUMN"},new_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"NEW_CELL"},modify_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MODIFIED_CELL"},clear_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"CLEAR_CELL"},move_cells:{requireText:!1,
skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MOVED_CELLS"},add_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_SHEET"},rename_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"RENAMED_SHEET"}},nd=function(){var b=/\S/,e="#ffbc2b #9439ae #61b34a #de2f40 #43bee6 #ef5f11 #0078ff".split(" "),
a=['<div class="oit-annoblock"><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable oit-annotitle"> ',U.ANNOTATIONS,'</span><span class="oit-sortselect"><span class="oit-unselectable">',U.SORT_BY,'</span><select name="oit-sort" class="oit-sort"><option value="location">',U.LOCATION,'</option><option value="author">',U.AUTHOR_A_TO_Z,'</option><option value="rauthor">',U.AUTHOR_Z_TO_A,'</option><option value="date">',U.OLDEST_FIRST,'</option><option value="rdate">',
U.NEWEST_FIRST,'</option><option value="type">',U.ANNOTATION_TYPE,"</option></select></span></div></div>"].join(""),d=function(b){S.call(this,"div","oit-annopane");this._page=b;this._annos=[];this._groups=[];this._newGroups=[];this._groupOffsets=[];this._badgeColorIndex=0;this._authorColors={};this._showLeader=!0;this._batches=[];this._needLayout=!0;this.html(a);this._block=this.byClass("oit-annoblock")[0];this._header=this.byClass("oit-annoheader")[0];this._title=this.byClass("oit-annotitle")[0];
this._commentIcon=this.byClass("oit-commentsicon")[0];this._sortSpan=this.byClass("oit-sortselect")[0];this._sortSelect=this.byClass("oit-sort")[0];this._scrollPane=new td;this._block.append(this._scrollPane);this.onclick(A.deactivateAnnotation);this.ontap(A.deactivateAnnotation);this._sortSelect.onchange(this,D);this._scrollPane.onscroll(this,Y);la.onresize(this,Y);E.onzoom(this,Y);this._isHidden=!0;this.css("display","none");this.attach()},c=V(d,S);c.destroy=function(){this._scrollPane.offscroll(this,
Y);E.offzoom(this,Y);la.offresize(this,Y);E.offidle(this,l);E.offidle(this,R);for(var a=0;a<this._newGroups.length;a++)this._newGroups[a].groupDiv.destroy();S.prototype.destroy.call(this)};c.update=function(){this.isHidden()||this._resizeTimer||(Y.call(this),this.layout(),this.scrollPane().update())};var f=function(a){var b=100;0<a._batches.length?b=0:0<a._newGroups.length&&(b=a._groups.length/(a._newGroups.length+a._groups.length),b=Math.floor(100*b));100<=b?a._title.text(U.ANNOTATIONS):a._title.text(U.LOADING+
" ("+b+"%)")};c.isLoading=function(){return 0<this._batches.length||0<this._newGroups.length};c.isEmpty=function(){return 0===this._annos.length&&0===this._batches.length&&0===this._newGroups.length};c.toolbarMode=function(a){!0===a?this._toolbarMode=!0:delete this._toolbarMode};c.attach=function(){if(!this.parent()){var a=this._page;if(a.supportsAnnotationPane()){var b=a.parent();b&&(a.nextSiblingElem()?b.insert(this,a.nextSiblingElem()):b.append(this))}}};c.range=function(){return this._range};
var k=function(a,b){var c=!1;if(a)if(Array.isArray(a))for(var d=0;d<a.length&&!(c=k(a[d],b));d++);else a.range&&(c=fb(a.range,b));return c},t=function(a,b){var c=a.anno;return k(c.text,b)||k(c.oldtext,b)||k(c.last_save_date||c.create_date||c.date,b)||k(c.author,b)},r=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)r(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=na.getRawText(a.range.acc,a.range.accend))},w=function(a,b,c,d){var e=null,f;if("string"===typeof b)e=y.create("p"),
c.append(e),f=y.create("span"),e.append(f),n(a,b,f);else if(Array.isArray(b))for(var g=!0,h=0;h<b.length;h++){var k=b[h];k.range&&d&&(g=a._page.containsRange(k.range));g&&(e||(e=y.create("p"),c.append(e)),r(k),k.text?(f=y.create("span"),e.append(f),n(a,k,f)):e=null)}},n=function(a,b,c){b&&("string"===typeof b?(c.attr("data-acc","none"),c.addClass("oit-noacc"),c.text(b)):b.text&&(b.range&&b.range.acc?(c.attr("data-acc",b.range.acc),a._range?(b.range.acc<a._range.acc&&(a._range.acc=b.range.acc),b.range.accend>
a._range.accend&&(a._range.accend=b.range.accend)):a._range=ga(b.range)):(c.attr("data-acc","none"),c.addClass("oit-noacc")),c.text(b.text),b.b&&c.css("font-weight","bold"),b.i&&c.css("font-style","italic")))},l=function(){if(0<this._batches.length){var a=this._batches.shift();if(a&&0<a.length){for(var c=this._page,d=c.overlay?c.overlay.layer("comments"):void 0,g,k=0;k<a.length;k++){var p=a[k],r=Mb[p.type],u=!!r;if(r&&r.skipIfNoText){var t=p,v=!1;if(t.text)for(g=0;g<t.text.length;g++){var x=t.text[g];
if(x.text&&b.test(x.text)){v=!0;break}}v||(u=!1)}if(u&&p.range){t=u=null;if(p.parentid)for(v=0;v<this._annos.length;v++)if(g=this._annos[v],g.anno.id==p.parentid){u=g;t=g.groupInfo;break}t||(t={groupDiv:y.create("div","oit-annogroup"),annos:[]},this._newGroups.push(t));v=y.create("div","oit-anno");v.attr("id","oita"+p.id);g=y.create("div","oit-anno-text");if(x=r.title)switch(x=U[x],p.type){case "add_row":x+=" "+Za(p.range.r1);break;case "delete_row":x+=" "+Za(p.range.r1);break;case "add_col":x+=" "+
La(p.range.c1);break;case "delete_col":x+=" "+La(p.range.c1);break;case "cell":x+=" "+gb(p.range);break;case "new_cell":x+=" "+gb(p.range);break;case "modify_cell":x+=" "+gb(p.range);break;case "clear_cell":x+=" "+gb(p.range);break;case "move_cells":x+=" "+gb(p.oldrange)+" to "+gb(p.range)}if(p.oldtext){if(r.showFromTo){var z=y.create("div","oit-anno-change-sep oit-noacc");z.attr("data-acc","none");z.text(U.ANNO_CHANGE_FROM);g.append(z)}w(this,p.oldtext,g,r.checkRanges);r.showFromTo&&(z=y.create("div",
"oit-anno-change-sep oit-noacc"),z.attr("data-acc","none"),z.text(U.ANNO_CHANGE_TO),g.append(z))}if(p.text)w(this,p.text,g,r.checkRanges);else if(r.requireText){z=y.create("p","oit-noacc oit-unsupportedcontent");z.attr("data-acc","none");var A=y.create("span");A.text(U.UNSUPPORTED_CONTENT);z.append(A);g.append(z)}z=y.create("div","oit-anno-meta");if(A=p.last_save_date||p.create_date||p.date){var D=null;"string"===typeof A?D=Jb(A):A.text&&(D=Jb(A.text));if(D){var F=y.create("span","oit-anno-date");
D===A.text?n(this,A,F):(F.text(D),F.addClass("oit-noacc"),F.attr("data-acc","none"));z.append(F)}}D="";A=null;p.author&&(D=y.create("span","oit-anno-author"),n(this,p.author,D),z.append(D),D=D.text().trim(),0<D.length&&(A=this._authorColors[D],A||(this._authorColors[D]=A=e[this._badgeColorIndex++],this._badgeColorIndex>=e.length&&(this._badgeColorIndex=0)),D=D.charAt(0).toUpperCase()));if(x){F=y.create("div","oit-anno-type oit-noacc");F.attr("data-acc","none");if(D){var G=y.create("div","oit-badge");
A&&G.css("background",A);G.text(D);F.append(G)}G=y.create("span");G.text(x);F.append(G);v.append(F)}v.append(g,z);t.groupDiv.append(v);g={anno:p,annoDiv:v,groupInfo:t};t.annos.push(g);v.onclick(this,m,g);v.ontap(this,m,g);"text"===p.range.type?(g.spans=Gb(c,p.range,r.textCls,p.id,"page"),u||(g.badge=new hd(c.index,d,r.badgeCls,D),A&&g.badge.css("background",A),g.badge.onclick(this,O,g),g.badge.ontap(this,O,g),g.badge.onmouseover(this,H,g),g.badge.onmouseout(this,N,g),g.badge.hide())):r.showIcon&&
(u?(g.parent=u,g.icon=u.icon,u.icon.removeClass("oit-commenticon"),u.icon.addClass("oit-commenticonmulti"),u.icon.resetDefaultSize(),p=u.icon.defaultSize(),u.icon.move(void 0,void 0,p.width,p.height)):(p=new gd(c.index,d,"oit-commenticon"),t.groupDiv.data("commenticon",p),p.data("comment",t.groupDiv),p.onclick(this,O,g),p.ontap(this,O,g),p.onmouseover(this,H,g),p.onmouseout(this,N,g),g.icon=p,p.hide()));g.index=this._annos.length;this._annos.push(g)}}X(this)}h(this,!0);this.update()}0===this._batches.length&&
(E.offidle(this,l),this._processingBatches=!1,this.layout(),this._processBatchCallbackFn&&(this._processBatchCallbackFn(this,this._processBatchCallbackArg),delete this._processBatchCallbackFn,delete this._processBatchCallbackArg));f(this)};c.processAnnotations=function(a,b,c){if(a){if(500>=a.length)this._batches.push(a);else for(var d=0;d<a.length;d+=500){var e=d+500;e>a.length&&(e=a.length);e=a.slice(d,e);this._batches.push(e)}this._processingBatches||(this._processingBatches=!0,b&&(this._processBatchCallbackFn=
b,this._processBatchCallbackArg=c),E.onidle(this,l),l.call(this));f(this)}};c.show=function(){this.attach();if(this.parent()){this._isHidden=!1;this.css("display",null);for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&("slide"!==b.anno.type&&b!==this._activeAnno||b.icon.show());b.badge&&b.badge.show();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.onclick(this,O,b);d.ontap(this,O,b);d.onmouseover(this,H,b);d.onmouseout(this,N,b)}}X(this);h(this);
this.update()}};c.hide=function(){this._isHidden=!0;this.css("display","none");for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&b.icon.hide();b.badge&&b.badge.hide();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.offclick(this,O);d.offtap(this,O);d.offmouseover(this,H);d.offmouseout(this,N)}}z(this)};c.isHidden=function(){return!!this._isHidden};c.panelRect=function(a){return A.elementRect(this._scrollPane,a)};c.contentRect=function(a){return A.elementRect(this._scrollPane.content,
a)};c.getSpanMap=function(){this._spanMap||(this._spanMap=new Mc(this._page,this._scrollPane.content));return this._spanMap};c.scrollPane=function(){return this._scrollPane};c.findACC=function(a){var b=this.getSpanMap();if(b)return b.findACC(a)};c.findRange=function(a,b){var c=this.getSpanMap();if(c)return c.findRange(a,b)};c.mapPointToSpan=function(a,b,c){var d=this.getSpanMap();if(d)return d.mapPointToSpan(a,b,c)};c.containsRange=function(a){var b=!1;"text"===a.type&&this._range&&a.acc<=this._range.accend&&
a.accend>=this._range.acc&&(a.acc===a.accend?b=!!this.findACC(a.acc):(a=this.findRange(a.acc,a.accend),void 0!==a&&0<a.length&&(b=!0)));return b};c.annoRect=function(a,b,c){var d=null,e;c||(c=a.anno.annoRange||a.anno.range);if(a.spans||a.anno.embeds){if(a.spans)for(var f=0;f<a.spans.length;f++)(e=a.spans[f].textRect(c))&&(d?b?e.bottom>d.bottom?d=e:e.bottom==d.bottom&&d.union(e):d.union(e):d=e);if(a.anno.embeds)for(b=0;b<a.anno.embeds.length;b++)(e=this._page.embeddingRect(a.anno.embeds[b].uid))&&
(d?d.union(e):d=e)}else if(a.icon)(e=a.icon.isHidden())&&a.icon.show(),d=new ja(a.icon.rect(v.viewNode),"view"),e&&a.icon.hide();else if("cell"===c.type)switch(a.anno.type){case "add_sheet":case "rename_sheet":d=A.overlayTabRect(this._page.overlay);break;case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":d=F.rangeRect(c,"view");break;default:d=F.expandRange(c),d=F.rangeRect(d,"view")}else d=F.rangeRect(c,"view",
!1,"page"),d||"text"!==c.type||(a=this._page.frameForRange(c))&&(a=a.firstChildElem())&&"DIV"===a.tagName&&(d=a.rect(v.viewNode),d=new ja(d,"view"),d.width=0,d.height=0);return d};c.annoTextHeight=function(a,b){var c=0;if(a.spans){for(var d,e=0;e<a.spans.length;e++){var f=a.spans[e].textRect(a.anno.range);f&&(!d||f.bottom>d.bottom?d=f:f.bottom==d.bottom&&d.union(f))}d&&(d.origin=b,c=d.height)}return c};var u=function(a,b){var c=a.annos[0],d=b.annos[0],c=Ta(c.anno.annoRange||c.anno.range,d.anno.annoRange||
d.anno.range);0===c&&(c=J(a,b));return c},p=function(a,b){return-u(a,b)},J=function(a,b){var c=a.annos[0].anno,d=b.annos[0].anno,c=c.last_save_date||c.create_date||c.date,d=d.last_save_date||d.create_date||d.date;c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=a.annos[0].index-b.annos[0].index);return e},K=function(a,b){return-J(a,b)},M=function(a,b){var c=a.annos[0].anno.author,d=b.annos[0].anno.author;c&&c.text&&
(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=J(a,b));return e},G=function(a,b){return-M(a,b)},Q=function(a,b){var c=a.annos[0].anno.type,d=b.annos[0].anno.type,e=Mb[c],f=Mb[d];e&&e.title&&(c=U[e.title]);f&&f.title&&(d=U[f.title]);e=0;c&&d&&(e=c.localeCompare(d));0===e&&(e=u(a,b));return e},D=function(){var a=y.unwrap(this._sortSelect),a=a.item(a.selectedIndex);x.annotationSort=a?a.value:"index"};c.applySort=function(a){var b=
x.annotationSort;if(!this.isLoading()&&(a||b!==this._sort)){this._sort=b;switch(b){case "date":a=J;break;case "rdate":a=K;break;case "rlocation":a=p;break;case "author":a=M;break;case "rauthor":a=G;break;case "type":a=Q;break;default:a=u}this._groups.sort(a);for(a=this._groups.length-1;0<=a;a--)this._groups[a].groupDiv.detach();for(a=0;a<this._groups.length;a++)this._scrollPane.content.append(this._groups[a].groupDiv);y.unwrap(this._sortSelect).value=b;delete this._spanMap;this._groupOffsets=[];this.update()}};
var h=function(a,b){if(!a.isHidden())if(a.isLoading()||2>a._annos.length)a._showSort=!1,delete a._headerWidth,a._sortSpan.css("display","none");else{var c=a._header.clientWidth;if(b||!a._headerWidth||a._showSort&&c<a._headerWidth||!a._showSort&&c>a._headerWidth){a._sortSpan.css("display",null);var c=a._sortSpan.pos(a._header),d=a._commentIcon.rect(a._header),e=!0;c.top>=d.bottom&&(e=!1);e||a._sortSpan.css("display","none");a._showSort=e}}};c.onResize=function(a){var b=this._header.clientWidth;if(!0===
a||b!=this._headerWidth){this._headerWidth=b;if(this._resizeTimer)ua(this._resizeTimer);else for(a=0;a<this._groups.length;a++)b=this._groups[a],b.visible&&b.groupDiv.css("height",null);this._resizeTimer=ea(function(){this._groupOffsets=[];for(var a=0;a<this._groups.length;a++){var b=this._groups[a];b.height&&(b.groupDiv.css("height",null),delete b.height)}this._spanMap&&this._spanMap.discardLayout();h(this);delete this._resizeTimer;this.update()},100,this)}};c.layout=function(){var a=this._page,
b=a.pageRect("overlay");if(!a.parent()||!this.parent()||this.isHidden())this.css("display","none");else if(this&&b){delete this._needLayout;var c,d,e=x.zoom;this._toolbarMode?this.css({top:null,left:null,height:null,display:null}):(this.css({top:b.top/e+"px",left:b.right/e+"px",height:b.height/e+"px",display:null}),150>b.height?(this._header.css("display","none"),this._scrollPane.css("top","0")):(this._header.css("display",null),this._scrollPane.css("top",null)));this._scrollPane.update();a.pagePos("overlay");
for(e=0;e<this._annos.length;e++){var f=this._annos[e];if(f.badge){var g=this.annoRect(f,!1);if(g){g.origin="overlay";c=b.left+5;d=(g.top+g.bottom)/2-10;var g=b.bottom-20-5,h;do{if(d>g)break;for(var k=h=0;k<e;k++)if(k!=e&&this._annos[k].badge){var l=this._annos[k].badge.position(),m=l.bottom- -2;d>l.top-l.height+-2&&d<m&&(d=m,h++)}}while(h&&20>=h);d>g||20<h?(f.badge.destroy(),delete f.badge):(f.badge.show(),f.badge.move(c,d))}else f.badge.hide()}if(f.icon&&!f.parent){if(f.anno.range)switch(f.anno.range.type){case "rect":c=
f.anno.range.left;d=f.anno.range.top;break;case "text":if(g=F.rangeRect(f.anno.range,a))c=g.left,d=g.top,f.icon.css("opacity",.3)}else c=f.anno.x,d=f.anno.y;void 0!==c&&void 0!==d&&(g=new ja(c,d,c+20,d+20,a),0>g.left?g.left=0:g.right>a.width&&(g.right=a.width),0>g.top?g.top=0:g.bottom>a.height&&(g.bottom=a.height),g.origin="overlay",f.icon.move(g.left,g.top),this._isHidden||"slide"!==f.anno.type&&f!==this._activeAnno||f.icon.show())}}}};var z=function(a){a._hasUpdateListener||(la.onupdate(a,g),a._hasUpdateListener=
!0);la.invalidateCanvas()};c.showLeader=function(a){!1!==a&&(a=!0);a!==this._showLeader&&(this._showLeader=!1!==a,la.invalidateCanvas())};var g=function(a){if(!this._isHidden&&x.showAnnotations&&this._activeAnno){var b=this._activeAnno;if(b&&this._showLeader){var c;if(b.anno.oldrange&&"cell"===b.anno.oldrange.type){var d=P.cellSelection(),e=b.anno.annoRange||b.anno.range,f=b.anno.oldrange;d&&!fb(d,e)&&fb(d,f)&&(c=f)}if(d=this.annoRect(b,!0,c)){e=v.rootNode;f=v.viewNode;c=f.rect(e);d.origin="view";
d.offset(c.left,c.top);var g=d.left,h=d.top,k=d.right,l=d.bottom;0>g&&0<k&&(g=0);k>f.clientWidth&&g<f.clientWidth&&(k=f.clientWidth);0>h&&0<l&&(h=0);l>f.clientHeight&&h<f.clientHeight&&(l=f.clientHeight);d.move(g,h,k,l);k=b.annoDiv.rect(e);0===k.height&&(k=b.groupInfo.groupDiv.rect(e));F.padding();var m=10;b.spans&&(m=.7*this.annoTextHeight(b,"view"),10>m?m=10:40<m&&(m=40));var n,p,r;n="cell"===b.anno.range.type;p="add_sheet"===b.anno.type||"rename_sheet"===b.anno.type;var h=!1,l=!0,u=k.top+20,t=
k.bottom-20,f=k.left,g=u,b=f-10;if(n)h=!0,p?(m=(d.right+d.left)/2,n=d.top,p=m,r=n-10,l=!1):(m=d.right+2,n=d.top+d.height/2,p=m+10,p>b&&(p=m),r=n);else{var w=d.top-m;r=d.bottom+m;m=(d.right+d.left)/2;n=d.bottom;p=m;var y=this._page.pageRect("view").clone();y.offset(c.left,c.top);if(r>=y.bottom||g<n&&w>y.top)n=d.top,r=w;g=r>t?t:r<u?u:r}e=this._scrollPane.rect(e);g<e.top?g=e.top:g>e.bottom&&(g=e.bottom);d=!0;g<k.top?(g=e.bottom,d=!1):g>k.bottom&&(g=e.top,d=!1);l&&p>=b&&(p=m,r=n,b=f);if(m<f||!l)a.save(),
e=v.rootNode.rect(),e=e.right-e.left-c.left,a.beginPath(),a.rect(c.left,c.top,e,c.bottom-c.top),a.clip(),a.beginPath(),h&&a.arc(m,n,2,0,2*Math.PI,!0),a.moveTo(m,n),a.lineTo(p,r),a.lineTo(b,g),d&&a.lineTo(f,g),a.strokeStyle="rgba(255,255,255,0.1)",a.lineWidth=9,a.stroke(),a.strokeStyle="rgba(255,255,255,0.3)",a.lineWidth=7,a.stroke(),a.strokeStyle="rgba(255,255,255,0.5)",a.lineWidth=5,a.stroke(),a.strokeStyle="rgba(0,0,0,0.25)",a.lineWidth=3,a.stroke(),a.restore()}}}};c.deactivate=function(a,b){this.activate(null,
!1,!1,a,b)};c.activate=function(a,b,c,d,e){var f=this;if(f._activating)d&&d(e);else if(f._annos){!1!==b&&(b=!0);var g,k,h;if(a)if(k=xa(a))for(h=0;h<f._annos.length;h++){if(t(f._annos[h],k)){g=f._annos[h];break}}else if(a.anno&&a.groupInfo.groupDiv)g=a;else if(a.id)for(h=0;h<f._annos.length;h++)if(f._annos[h].anno===a){g=f._annos[h];break}if(g)A.deactivateAnnotation(),f._activating=g,x.showAnnotations||(x.showAnnotations=!0),A.movetoEx(this._page.index,{animate:!0,callbackFn:function(){A.scrollToAnnotationPane(function(){f._activeAnno=
g;A.activeAnnotationPane(f);if(g.spans||g.anno.embeds){if(g.spans)for(var a=0;a<g.spans.length;a++)g.spans[a].addClass("oit-active")}else g.icon&&(g.icon.show(),g.icon.activate());z(f);g.annoDiv.addClass("oit-active");if(b){var h;k&&(h=f.getSpanMap().findRange(k.acc,k.accend));if(h){for(var l,a=0;a<h.length;a++){var m=h[a].textRect(k);m&&(l?l.union(m):l=m)}l&&(l.origin=f._scrollPane.content,l.scale(1/x.zoom),f._scrollPane.scrollIntoView(l))}else f._scrollPane.scrollIntoView(g.groupInfo.groupDiv),
f._scrollPane.scrollIntoView(g.annoDiv)}if(h=g.anno.annoRange||g.anno.range)if(F.moveto(h),c&&"cell"===h.type&&"add_sheet"!==g.anno.type&&"rename_sheet"!=g.anno.type){h=(l=P.cellSelection())&&g.anno.oldrange&&!fb(l,h)&&fb(l,g.anno.oldrange)?ga(g.anno.oldrange):ga(h);switch(g.anno.type){case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":h.autoExpand=!1}L.pauseAutoHighlight(!0);P.select(h);L.pauseAutoHighlight(!1)}d&&
d(e);delete f._activating})}});else{a=f._activeAnno;f._activeAnno=null;if(a){if(a.spans||a.anno.embeds){if(a.spans)for(h=0;h<a.spans.length;h++)a.spans[h].removeClass("oit-active")}else a.icon&&(a.icon.deactivate(),"slide"!==a.anno.type&&a.icon.hide());z(f);a.annoDiv.removeClass("oit-active");A.activeAnnotationPane(null);a=null}d&&d(e)}}};var m=function(a,b){this.activate(b,!1,!0);return!1},O=function(a,b){if(0===y.selectedText().length)return L.deactivate(),P.reset(),this.activate(b,!0,!0),!1},H=
function(a,b){b.groupInfo.groupDiv.addClass("oit-hover")},N=function(a,b){b.groupInfo.groupDiv.removeClass("oit-hover")},R=function(){if(!this.isHidden()&&!this._needLayout){for(var a=0;30>a;a++){var b=this._newGroups.shift();if(!b)break;this._scrollPane.content.append(b.groupDiv);this._groups.push(b)}this._scrollPane.update();f(this);Y.call(this);0===this._newGroups.length&&(this._processingGroups=!1,E.offidle(this,R),h(this,!0),this.applySort(!0),L.each("addToPage",null,this._page.index,!0))}},
X=function(a){!a._processingGroups&&0<a._newGroups.length&&!a.isHidden()&&(a._processingGroups=!0,a._addGroupInterval=E.onidle(a,R),f(a),R.call(a))},Y=function(){if(!this._isHidden){var a,b,c;c=-1;for(a=0;a<this._groups.length;a++)if(b=this._groups[a],!b.height&&(-1==c&&(c=a),!b.visible)){b.visible=!0;for(var d=0;d<b.annos.length;d++)b.annos[d].annoDiv.css("display",null)}d=0;if(-1!=c){var e=x.zoom;for(a=c;a<this._groups.length;a++)b=this._groups[a],void 0===b.height&&(c=b.groupDiv.rect(this._scrollPane.content),
this._groupOffsets[a]=c.top,d++,0<c.height&&(b.height=this._toolbarMode?c.height-1:c.height/e-1,b.groupDiv.css("height",b.height+"px")))}if(d<this._groups.length)for(a=0;a<this._groups.length;a++)void 0===this._groupOffsets[a]&&(b=this._groups[a],c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top);this._groupOffsets[this._groups.length]=this._scrollPane.content.outerHeight;c=this.clientHeight;d=this._scrollPane.scrollTop;this._toolbarMode||(c*=x.zoom,d*=x.zoom);for(a=0;a<this._groups.length;a++)if(b=
this._groups[a],e=this._groupOffsets[a]-d,e=0<this._groupOffsets[a+1]-d&&e<c,e!=b.visible)for(var e=(b.visible=e)?null:"none",f=0;f<b.annos.length;f++)b.annos[f].annoDiv.css("display",e);z(this)}};return d}(),Yc=function(){return function(){var b='<div><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable"> '+U.ANNOTATIONS+"</span></div></div>",e,a,d;this.show=function(){if(e&&d){var a=x.annoBarWidth;0<a?e.show({size:a}):e.show();d.show()}};this.hide=function(){e&&
(d&&d.hide(),e.hide())};this.destroy=function(){Ha.offresizeinternal(this,f);A.offchange(this,c);x.offshowAnnotations(this,c);x.offannoBarWidth(this,c);e&&Ha.removeInternal(-3);a&&a.destroy();a=e=null};var c=function(){var b=A.activePage(),b=b?b.annotationPane():null;b!==d&&(d&&(d.css("width",null),d.hide(),A.activeAnnotationPane(null),a.remove(d),d.toolbarMode(!1),d=null),d=b)&&(A.activeAnnotationPane(d),a.append(d),d.toolbarMode(!0),d.scrollPane().setScrollTop(0,!0));b=x.annoBarWidth;0>=b&&(b=void 0);
e.applySize(b,void 0,!0);d&&x.showAnnotations?this.show():this.hide()},f=function(b,c,e,f,n){-3===b&&a&&d&&(0<e&&(x.annoBarWidth=e,e+="px",a.css("width",e),d.css("width",e)),d.showLeader(!n),d.onResize(),la.invalidateCanvas())};a=y.create("div","oit-annobar");e=new Nb(-3,"right",a,null,Ha.internalParent(-3));e.resizable(!0,60,30,b);Ha.addInternal(-3,e);Ha.onresizeinternal(this,f);A.onchange(this,c);x.onshowAnnotations(this,c);x.onannoBarWidth(this,c);c.call(this)}}(),Ec=function(){var b,e=function(){if(b){var a=
v.viewNode,a=a.offsetHeight-a.clientHeight;0===a?b.css("bottom",null):b.css("bottom",a+"px")}};la.onresize(e);E.onzoom(e);var a=function(a){a=a||{};S.call(this,"div","oit-toast");a.className&&this.addClass(a.className);var c=[];a.collapseButton&&c.push('<input class="oit-collapsebutton" type="button" value="&#x25bc;">');a.closeButton&&c.push('<input class="oit-closebutton" type="button" value="x">');c.push('<div class="oit-title"></div><div class="oit-body"></div>');this.html(c.join(""));a.collapseButton&&
(this.prop("collapseButton",this.childByClass("oit-collapsebutton")),this.collapseButton.onclick(this,w),this.collapseButton.ontap(this,w));a.closeButton&&(this.prop("closeButton",this.childByClass("oit-closebutton")),this.closeButton.onclick(this,l),this.closeButton.ontap(this,l));this.prop("titletext",this.childByClass("oit-title"));this.prop("messagetext",this.childByClass("oit-body"));this._collapsed=!0;this.onclick(this,n);this.ontap(this,n);this.onmouseenter(this,f);this.onmouseleave(this,k);
y.attach(this);b||(b=y.create("div","oit-toastpane"),v.viewNode.parent().append(b),e());c=b.firstChildElem();a.collapseButton||!c?b.append(this):b.insert(this,c);a.title&&this.title(a.title);a.content&&this.message(a.content)},d=V(a,S);d.customEvent("expand");d.customEvent("collapse");var c=function(a){a._collapsed?a._colSize&&a.css({width:a._colSize.width+"px",height:a._colSize.height+"px"}):a._expSize&&a.css({width:a._expSize.width+"px",height:a._expSize.height+"px"})};d.title=function(a){if(void 0!==
a){this.titletext.html(a);a=this.attr("class");var b=this.css("display");this.attr("class","oit-toast");this.css("display",null);this.css({width:null,height:null});this._colSize={width:this.innerWidth,height:this.innerHeight};c(this);this.attr("class",a);this.css("display",b)}return this.titletext.html()};d.message=function(a){if(void 0!==a){this.messagetext.html(a);a=this.attr("class");var b=this.css("display");this.attr("class","oit-toast oit-expanded");this.css("display",null);this.css({width:null,
height:null});this._expSize={width:this.innerWidth,height:this.innerHeight};c(this);this.attr("class",a);this.css("display",b)}return this.messagetext.html()};d.isCollapsed=function(){return this._collapsed};d.hide=function(a){this._hidden||this._pendingHidden?a&&a():(this._pendingHidden=!0,this._hideCallback=a)};d.hideNow=function(){this._hidden=!0;this._pendingHidden=!1;this.animate({opacity:0,time:300,endCSS:{display:"none"},endFn:this._hideCallback})};d.show=function(){if(this._hidden||this._pendingHidden)this._pendingHidden=
this._hidden=!1,this.css("display",null),delete this._hideCallback};var f=function(){this._mouse=!0},k=function(){this._mouse=!1;this._pendingHidden&&this.hideNow()},t=function(){this.offtransitionend(t);this._tto&&(ua(this._tto),delete this._tto);this.removeClass("oit-collapsing");this.dispatchCustom("collapse",{});Sa()};d.collapse=function(a){if(this._collapsed)return!1;this._tto&&ua(this._tto);this._collapsed=!0;!1===a?(this.removeClass("oit-expanded"),c(this),this.dispatchCustom("collapse",{})):
(this.addClass("oit-collapsing"),this.removeClass("oit-expanded"),this.ontransitionend(t),ea(function(){c(this)},0,this),this._tto=ea(function(){delete this._tto;t.call(this)},400,this));Sa();return!0};var r=function(){this.offtransitionend(r);this._tto&&(ua(this._tto),delete this._tto);this.addClass("oit-expanded");this.removeClass("oit-expanding");this.dispatchCustom("expand",{});Sa()};d.expand=function(a){if(!this._collapsed)return!1;this._tto&&ua(this._tto);this._collapsed=!1;!1===a?(this.addClass("oit-expanded"),
c(this),this.dispatchCustom("expand",{})):(this.addClass("oit-expanding"),this.ontransitionend(r),c(this),this._tto=ea(function(){delete this._tto;r.call(this)},400,this));Sa();return!0};var w=function(a){if(this.collapse())return!1},n=function(a){if(this.expand())return!1},l=function(a){this.hideNow()};E.onreset(function(){b&&(b.destroy(),b=null)});return a}();v.libversion="2018.4.0.389";(function(b){Ua.install.dispatch();Ua.install.reset();K.addEventListener("load",function(){Ua.init.dispatch();
Ua.init.reset()})})(!1)})(window,document);
//# sourceURL=oit.js 
