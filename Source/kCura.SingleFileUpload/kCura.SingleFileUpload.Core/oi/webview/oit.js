/*
 oit.js 
 Portions (C) 1991, 2016, Oracle Corp, and (C) 2017, Relativity ODA LLC. 
 Version 2018.7.0.494 
*/
(function(R,V){var Wb,Xb;if(R.OIT){var ha=R.OIT.view;ha&&(ha.detach?ha.detach():ha.unload&&ha.unload())}R.OIT=function(){var d={};Object.defineProperties(d,{uninstall:{value:function(){nc&&nc(this)},writable:!0}});return d}();var W=function(d,e){e||(e=Tc);return d.prototype=Object.create(e.prototype)},nc=function(){if(R.OIT){var d=R.OIT.view;d&&d.detach();R.OIT=void 0}},pb=function(d,e,b){Object.defineProperty(OIT,d,{value:e,writable:!!b})},y=function(){var d=/^[.#\w][-_\.\w\d]*$/,e=("oit"+Math.random()).replace(/\W/g,
""),b=[],a=1,c=function(a){if(d.test(a)){if(0===a.lastIndexOf("#",0))return c.byId(a.slice(1));if(0===a.lastIndexOf(".",0))return c.byClass(a.slice(1));if(0===a.indexOf(" "))return c.byTagName(a)}return c.bySelector(a)};Object.defineProperties(c,{html:{get:function(){return c.wrap(V.documentElement)}},body:{get:function(){return c.wrap(V.body)}},head:{get:function(){return c.wrap(c.html.childByTagName("head"))}},expando:{value:e}});c.byId=function(a){return c.wrap(V.getElementById(a))};c.byClass=
function(a){return c.wrap(V.getElementsByClassName(a))};c.byTagName=function(a){return c.wrap(V.getElementsByTagName(a))};c.bySelector=function(a){return c.wrap(V.querySelectorAll(a))};c.attach=function(a){(a=c.wrap(a))&&a.data("_elem",a);return a};c.detach=function(a){a&&c.removeData(a,"_elem")};c.query=function(a){return c.data(a,"_elem")};c.isElement=function(c){return c&&(c.dom||1===c.nodeType)};c.isText=function(c){return c&&3===c.nodeType};c.isDescendantOf=function(a,b){a=c.unwrap(a);if(b=c.unwrap(b))for(;a&&
a.parentNode;){if(a.parentNode===b)return!0;a=a.parentNode}return!1};c.nodeIndex=function(a){a=c.unwrap(a);for(var b=0;;){a=a.previousSibling;if(!a)break;++b}return b};c.unwrap=function(c){c&&c.dom&&(c=c.dom);return c};c.wrap=function(a){if(a){var b;if(!c.isElement(a)&&0<=a.length&&("function"===typeof a.item?b=[]:Array.isArray(a)&&(b=a),b)){for(var d=0;d<a.length;d++)b[d]=c.wrap(a[d]);0===b.length&&(b=null);return b}if(a.tagName&&!a.dom)return(b=c.query(a))||(b=new T(a)),b}return a};c.acceptsData=
function(c){return c&&(1===c.nodeType||9===c.nodeType)};c.data=function(d,f,h){d=c.unwrap(d);if(c.acceptsData(d)&&f){var v=d[e];if(void 0!==h){if(!v){do v=a++;while(void 0!==b[v]);Object.defineProperty(d,e,{value:v})}b[v]||(b[v]={});b[v].domNode=c.nodeToString(d);return b[v][f]=h}var p;v&&(h=b[v])&&(p=h[f]);void 0===p&&d.getAttribute&&(p=d.getAttribute("data-"+f),null===p&&(p=void 0));return p}};c.destroyData=function(d){d=c.unwrap(d);c.acceptsData(d)&&(d=d[e])&&(b[d]=void 0,d<a&&(a=d))};c.removeData=
function(a,d){a=c.unwrap(a);if(c.acceptsData(a)){var f=a[e];if(f)if(d){if(f=b[f]){delete f[d];var v;a:{for(v in f)if(Object.prototype.hasOwnProperty.call(f,v)){v=!0;break a}v=!1}v||c.removeData(a)}}else b[f]=void 0}a&&a.removeAttribute&&a.removeAttribute("data-"+d)};c.removeSubtreeData=function(a){c.removeData(a);for(a=a.firstElementChild;a;a=a.nextElementSibling)c.removeSubtreeData(a)};c.reset=function(){var d,e;for(e in b){var f=b[e];f&&(c.logUnreleasedData&&c.logUnreleasedData(f),d||(d=[]),d[e]=
f)}d?b=d:(b=[],a=1)};c.hasClass=function(a,b){if(Array.isArray(b)){for(var d=0;d<b.length;d++)if(c.hasClass(a,b[d]))return!0;return!1}if(a=c.unwrap(a)){if(a.classList)return a.classList.contains(b);if(a.getAttribute&&(d=a.getAttribute("class")))return d=" "+d+" ",b=" "+b.trim()+" ",-1!=d.indexOf(b)}return!1};var f=function(a,b){if(a.classList)a.classList.add(b);else if(a.getAttribute&&!c.hasClass(a,b)){var d=a.getAttribute("class");a.setAttribute("class",d+(" "+b))}};c.addClass=function(a,b){if((a=
c.unwrap(a))&&b){var d;if(Array.isArray(b))for(d=0;d<b.length;d++)f(a,b[d]);else if(-1!=b.indexOf(" "))for(b=b.split(" "),d=0;d<b.length;d++)f(a,b[d]);else f(a,b)}};var h=function(a,c){if(a.classList)a.classList.remove(c);else if(a.getAttribute){var b=a.getAttribute("class").replace(c,"");a.setAttribute("class",b)}};c.removeClass=function(a,b){if((a=c.unwrap(a))&&b){var d;if(Array.isArray(b))for(d=0;d<b.length;d++)h(a,b[d]);else if(-1!=b.indexOf(" "))for(b=b.split(" "),d=0;d<b.length;d++)h(a,b[d]);
else h(a,b)}};c.create=function(a,c,b,d){return new T(a,c,b,d)};c.createText=function(a){return V.createTextNode(a)};c.listen=function(){return V.addEventListener.apply(V,arguments)};c.unlisten=function(){return V.removeEventListener.apply(V,arguments)};c.cursor=function(a){void 0!==a&&(V.body.style.cursor=a);return V.body.style.cursor};c.clearSelection=function(){R.focus();if(R.getSelection){var a=R.getSelection();null!==a&&a.removeAllRanges()}};c.selectRange=function(a,c,b,d){R.focus();if(R.getSelection){var e;
Ia(a)?e=a:(e=V.createRange(),e.setStart(a,c),e.setEnd(b,d));a=R.getSelection();a.removeAllRanges();a.addRange(e)}};c.selectedText=function(){var a;if(R.getSelection){var c=R.getSelection();c&&(a=c.toString())}else V.selection&&"Control"!=V.selection.type&&(a=V.selection.createRange().text);a||(a="");return a};c.nodeToString=function(a){if((a=c.unwrap(a))&&1===a.nodeType){var b=[];b.push("<",a.tagName.toLowerCase());if(a.classList)for(var d=0;d<a.classList.length;d++)b.push(".",a.classList[d]);a.id&&
b.push("#",a.id);b.push(">");return b.join("")}};return c}(),Tc=function(){var d=function(){},e=d.prototype;e.prop=function(b,a,c,d){"string"===typeof b&&void 0!==a&&Object.defineProperty(this,b,{value:a,writable:!!c})};e.deleteAll=function(){for(var b in this)this.hasOwnProperty(b)&&delete this[b]};e.invalidArg=function(b,a,c,d){var e="",e=a?e+("Invalid value specified for argument '"+a+"'"):e+"Invalid argument";c&&(e+=": '"+wb(c)+"'");d&&(e+=", "+d);this.logError(b,e)};e.logError=function(b,a){var c;
this.publicName&&b&&(c=this.publicName+"."+b+": ");a&&(c=(c?c+": ":"")+String(a));c&&0<c.length&&F.on.error.dispatch(c,!1)&&console.error(c)};e.logFatalError=function(b,a,c,d){var e;this.publicName&&b&&(e=this.publicName+"."+b+": ");a&&(e=(e?e+": ":"")+String(a));c&&(e=(e?e+" ":"")+String(c));e&&0<e.length&&F.on.error.dispatch(e,!0)&&("warn"!==d&&(d="error"),console[d](e),ha.unload(),ha.showDocumentError(a))};e.logAJAXError=function(b,a,c,d,e){d===oc?a+=" (Request aborted)":d===Yb?a+=" (Request timed out)":
void 0!==d&&(a=a+" (HTTP Status "+d+")");d=[];c&&d.push(" [",c,"]");void 0!==e&&d.push(" responseText='",e,"'");this.logFatalError(b,a,d.join(""))};return d}(),T=function(){var d=[];d[0]=d[23]="right";d[5]=d[6]="up";d[11]=d[12]="left";d[17]=d[18]="down";for(var e=function(a){void 0===a&&(a="div");if("string"==typeof a){var c=this.dom=V.createElement(a),b=1;if(b<arguments.length){var d;"string"==typeof arguments[b]?d=arguments[b++]:Array.isArray(arguments[b])&&(d=arguments[b++].join(" "));d&&d.length&&
c.setAttribute("class",d)}b<arguments.length&&"string"==typeof arguments[b]&&(c.id=arguments[b++]);b<arguments.length&&(c=y.wrap(arguments[b++]))&&y.isElement(c)&&c.append(this)}else y.isElement(a)&&(this.dom=y.unwrap(a))},b=W(e),a="clientLeft clientTop clientWidth clientHeight offsetWidth offsetHeight scrollWidth scrollHeight parentNode tagName classList".split(" "),c=function(a){Object.defineProperty(b,a,{get:function(){return this.dom[a]}})},f=0;f<a.length;f++)c(a[f]);Object.defineProperties(b,
{id:{get:function(){return this.dom.id},set:function(a){this.dom.id=a}},opacity:{get:function(){return Number(this.computedStyleProp("opacity"))},set:function(a){this.dom.style.opacity=a}},offsetLeft:{get:function(){return this.dom.offsetLeft},set:function(a){this.dom.style.left=L(a)+"px"}},offsetTop:{get:function(){return this.dom.offsetTop},set:function(a){this.dom.style.top=L(a)+"px"}},scrollLeft:{get:function(){return this.dom.scrollLeft},set:function(a){this.dom.scrollLeft=L(a)}},scrollTop:{get:function(){return this.dom.scrollTop},
set:function(a){this.dom.scrollTop=L(a)}},innerWidth:{get:function(){var a=this.computedStyleProp("width");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientWidth},set:function(a){this.dom.style.width=L(a)+"px"}},innerHeight:{get:function(){var a=this.computedStyleProp("height");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientHeight},set:function(a){this.dom.style.height=L(a)+"px"}},outerWidth:{get:function(){var a=this.dom.offsetWidth,c=R.getComputedStyle(this.dom);c.marginLeft&&c.marginRight&&
(a+=parseFloat(c.marginLeft)+parseFloat(c.marginRight));return a}},outerHeight:{get:function(){var a=this.dom.offsetHeight,c=R.getComputedStyle(this.dom);c.marginTop&&c.marginBottom&&(a+=parseFloat(c.marginTop)+parseFloat(c.marginBottom));return a}}});b.focus=function(){this.dom.focus()};b.blur=function(){this.dom.blur()};b.toString=function(){return y.nodeToString(this)};b.parent=function(){if(this.dom)return y.wrap(this.dom.parentNode)};b.firstChildElem=function(){if(this.dom)return y.wrap(this.dom.firstElementChild)};
b.nextSiblingElem=function(){if(this.dom)return y.wrap(this.dom.nextElementSibling)};b.detach=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom)}};b.destroy=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom);this.destroyChildren();y.destroyData(this.dom);this.deleteAll()}};var h=function(a){for(var c=a.firstElementChild;c;c=a){a=c.nextElementSibling;h(c);var b=y.query(c);b?b.destroy():y.removeData(c)}};b.destroyChildren=function(){h(this.dom)};b.equals=
function(a){return this.dom==y.unwrap(a)};b.html=function(a){void 0!==a&&(this.destroyChildren(),this.dom.innerHTML=a);return this.dom.innerHTML};b.text=function(a){void 0!==a&&(this.destroyChildren(),this.dom.textContent=a);return this.dom.textContent};b.data=function(a,c){return y.data(this.dom,a,c)};b.ancestorData=function(a){for(var c,b=this.dom,d=y.unwrap(w.rootNode);b;){c=y.data(b,a);if(void 0!==c)break;if(b==d)break;b=b.parentNode}return c};b.removeData=function(a){y.removeData(this.dom,a)};
b.hasClass=function(a){return y.hasClass(this.dom,a)};b.addClass=function(a){y.addClass(this.dom,a);return this};b.removeClass=function(a){y.removeClass(this.dom,a);return this};b.attr=function(a,c){var b;if(Array.isArray(a)){for(var d={},e=0;e<a.length;e++)b=a[e],d[b]=this.dom.getAttribute(b);return d}if(void 0===c){if("string"===typeof a)return this.dom.getAttribute(a);for(b in a)a.hasOwnProperty(b)&&this.dom.setAttribute(b,a[b])}else null===c?this.dom.removeAttribute(a):this.dom.setAttribute(a,
c);return this};b.css=function(a,c){var b=this.dom;if(b){var b=b.style,d;try{if(Array.isArray(a)){for(var e={},n=0;n<a.length;n++)d=a[n],e[d]=b.getPropertyValue(ib[d]||d);return e}if(void 0===c)if("string"===typeof a){if(-1==a.indexOf(":"))return b.getPropertyValue(ib[a]||a);(e=qb(a))&&this.css(e)}else for(d in a)a.hasOwnProperty(d)&&(n=a[d],null===n||void 0===n?b.removeProperty(ib[d]||d):b.setProperty(ib[d]||d,n,""));else null===c?b.removeProperty(ib[a]||a):b.setProperty(ib[a]||a,c,"")}catch(Ba){}}return this};
b.removeCSS=function(a){var c=this.dom;if(Array.isArray(a))for(var b=0;b<a.length;b++)c.style.removeProperty(a[b]);else if("string"===typeof a)c.style.removeProperty(a);else for(b in a)a.hasOwnProperty(b)&&c.style.removeProperty(b);return this};b.resetStyle=function(){return this.attr("style",null)};b.computedStyle=function(){return R.getComputedStyle(this.dom)};b.computedStyleProp=function(a){return this.computedStyle().getPropertyValue(a)};b.show=function(){this._hidden&&(this.css("display",null),
delete this._hidden);return this};b.hide=function(){this._hidden||(this.css("display","none"),this._hidden=!0);return this};b.isHidden=function(){return this._hidden};b.autoscroll=function(a,c){var b=this.dom;switch(arguments.length){case 0:return{left:b.scrollLeft,top:b.scrollTop};case 1:return this.autoscroll(a.left,a.top);case 2:void 0!==a&&(b.scrollLeft=a),void 0!==c&&(b.scrollTop=c)}return this};b.scroll=function(a,c){void 0===a&&void 0===c||this.cancelKinetic();return this.autoscroll.apply(this,
arguments)};b.dscroll=function(a,c){this.cancelKinetic();a&&(this.scrollLeft+=a);c&&(this.scrollTop+=c);return this};b.animate=function(a){a&&(this.finishAnimation(),this.dom&&new Uc(this,a));return this};b.finishAnimation=function(){var a=this.data("_animation");a&&a.finish();return this};b.abortAnimation=function(){var a=this.data("_animation");a&&a.abort();return this};b.append=function(){if(this.dom)for(var a=arguments,c=0;c<a.length;c++){var b=a[c];Array.isArray(b)?this.append.apply(this,b):
this.dom.appendChild(y.unwrap(b))}return this};b.insert=function(a,c){this.dom&&this.dom.insertBefore(y.unwrap(a),y.unwrap(c));return this};b.insertAfter=function(a,c){this.dom&&(a=y.unwrap(a),c=y.unwrap(c),c=c.nextSibling,this.dom.insertBefore(a,c));return this};b.insertFirst=function(a){this.dom&&this.dom.insertBefore(y.unwrap(a),this.dom.firstChild);return this};b.remove=function(a){this.dom&&this.dom.removeChild(y.unwrap(a));return this};b.clone=function(a){return this.dom?this.dom.cloneNode(!!a):
null};b.transferFrom=function(a){a=y.unwrap(a);if(this.dom&&a)for(;0<a.childNodes.length;)this.dom.appendChild(a.childNodes[0]);return this};b.forElementAndAncestors=function(a){for(var c=this,b=y.unwrap(w.rootNode);c&&!1!==a(c)&&c!=b;)c=c.parent();return this};b.forChildElements=function(a){return q.call(this,a,!1,arguments)};b.queryChildElements=function(a){return q.call(this,a,!0,arguments)};var q=function(a,c,b){for(var d=[null,-1],e=1;e<b.length;e++)d.push(b[e]);b=0;for(var n=this.dom.firstElementChild;n;n=
e,b++)if(e=n.nextElementSibling,n=!0===c?y.query(n):y.wrap(n))if(d[0]=n,d[1]=b,!1===a.apply(null,d))break;return this};b.pos=function(a){var c=this.dom;a=y.unwrap(a);if(a==c)return{left:0,top:0};for(;c&&!c.getBoundingClientRect;)c=c.parentNode;if(c)return c=c.getBoundingClientRect(),c={left:c.left,top:c.top},a&&a!==V.body&&(a=a.getBoundingClientRect(),c.left-=a.left,c.top-=a.top),c};b.size=function(){for(var a=this.dom;a&&!a.getBoundingClientRect;)a=a.parentNode;if(a)return a=a.getBoundingClientRect(),
{width:a.width,height:a.height}};b.rect=function(a){a=y.unwrap(a);for(var c=this.dom;c&&!c.getBoundingClientRect;)c=c.parentNode;if(c){var b=c.getBoundingClientRect(),b={left:b.left,top:b.top,right:b.right,bottom:b.bottom,width:b.width,height:b.height};a&&a!==V.body&&(a==c?(b.right-=b.left,b.bottom-=b.top,b.left=0,b.top=0):(a=a.getBoundingClientRect(),b.left-=a.left,b.top-=a.top,b.right-=a.left,b.bottom-=a.top));return b}};b.inRect=function(a,c){var b=this.dom;return b&&0<=a&&0<=c&&a<=b.clientWidth&&
c<=b.clientHeight};b.ancestorByClass=function(a){for(var c=this.parent(),b=w.rootNode;c&&c.hasClass;){if(c.hasClass(a))return c;if(c.equals(b))break;c=c.parent()}return null};b.childByTagName=function(a){a=a.toUpperCase();for(var c=this.dom.firstElementChild;c;c=c.nextElementSibling)if(c.tagName.toUpperCase()===a)return y.wrap(c);return null};b.childrenByTagName=function(a){var c=null;a=a.toUpperCase();for(var b=this.dom.firstElementChild;b;b=b.nextElementSibling)b.tagName.toUpperCase()===a&&(c||
(c=[]),c.push(y.wrap(b)));return c};b.childByClass=function(a){if(this)for(var c=this.firstChildElem();c;c=c.nextSiblingElem())if(c.hasClass(a))return c;return null};b.byClass=function(a){return y.wrap(this.dom.getElementsByClassName(a))};b.byId=function(a){for(var c=[y.unwrap(this.dom)];0<c.length;)for(var b=c.shift().firstElementChild;b;b=b.nextElementSibling){if(b.id===a)return y.wrap(b);c.push(b)}return null};b.byTag=function(a){a=a.toUpperCase();for(var c=[y.unwrap(this.dom)],b=[];0<c.length;)for(var d=
c.shift().firstElementChild;d;d=d.nextElementSibling)d.tagName.toUpperCase()===a?b.push(y.wrap(d)):c.push(d);if(b.length)return b};b.isDescendantOf=function(a){return y.isDescendantOf(this.dom,a)};b.mousePos=function(a){a||(a=R.event);for(var c={x:0,y:0},b=this.dom;b;b=b.offsetParent)c.x+=b.offsetLeft,c.y+=b.offsetTop;if(a.pageX||a.pageY)c.x=a.pageX-c.x,c.y=a.pageY-c.y;else if(a.clientX||a.clientY)c.x=a.clientX+V.body.scrollLeft+V.documentElement.scrollLeft-c.x,c.y=a.clientY+V.body.scrollTop+V.documentElement.scrollTop-
c.y;return c};b.touchPos=function(a){if(a){var c={identifier:a.identifier,x:0,y:0};if(a.center&&a.target){var b=y.wrap(a.target).pos(this);c.x=a.center.x+b.left;c.y=a.center.y+b.top}else{for(b=this.dom;b;b=b.offsetParent)c.x+=b.offsetLeft,c.y+=b.offsetTop;c.x=a.pageX-c.x;c.y=a.pageY-c.y}return c}};b.select=function(){R.focus();if(R.getSelection){var a=V.createRange();a.selectNodeContents(this.dom);y.selectRange(a)}else V.selection&&V.body.createTextRange&&(a=V.body.createTextRange(),a.moveToElementText(this.dom),
a.select())};var t=function(a){for(var c=!0;c;){var b=a.currentNode;if(1===b.nodeType)if("svg"===b.nodeName)c=a.skipNode();else if(b=y.data(b,"acc"),void 0!==b)if("none"===b)c=a.skipNode();else break;else break;else if(3===b.nodeType)break;else c=a.nextNode()}return c},u=function(){for(var a;!(a=this.nextSibling())&&this.parentNode(););return a},v=function(a){for(;this.currentNode!==a&&this.nextNode(););return this.currentNode===a},p=function(){return t(this)},l=function(){var a=this.nextNode();a&&
(a=t(this));return a};b.createTreeWalker=function(a,c,b){void 0===a&&(a=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);void 0===c&&(c=null);void 0===b&&(b=!1);a=V.createTreeWalker(this.dom,a,c,b);a.skipNode=u;a.skipToNode=v;a.firstACCNode=p;a.nextACCNode=l;return a};b.createCanvas=function(){return new pc(this)};b.on=function(a,c,b){void 0===b&&(b=c,c=void 0);if("function"!==typeof b)this.invalidArg("on"+a,"listener",b,"Must be a function");else{var d=Array.prototype.slice.call(arguments,2);d[0]=null;
c=c||this;var e,n=this.dom;e=a;var g=y.data(n,"_events");g||(g={},y.data(n,"_events",g));(n=g[e])||(n=g[e]=[]);e=n;for(g=0;g<e.length;g++)if(n=e[g],n.fn===b){n.ref=c;n.args=d;b=null;break}b&&(e.push({fn:b,ref:c,args:d}),1==e.length&&(d=this._events[a])&&d.add&&d.add(this,a))}return this};b.off=function(a,c,b){void 0===b&&(b=c);if("function"===typeof b&&(c=m(this.dom,a))){for(var d=0;d<c.length;d++)if(c[d].fn===b){c.splice(d,1);break}0===c.length&&(b=this._events[a])&&b.remove&&b.remove(this,a)}return this};
for(var m=function(a,c){var b=y.data(a,"_events");if(b&&(b=b[c])&&0<b.length)return b},H=function(a,c,b){a["on"+c]=function(a,b){1==arguments.length&&(b=a,a=null);if(2<arguments.length){for(var d=[c,a,b],e=2;e<arguments.length;e++)d.push(arguments[e]);return this.on.apply(this,d)}return this.on(c,a,b)};a["off"+c]=function(a,b){return this.off(c,a,b)};a._events||(a._events={});a._events[c]=b},I=function(a){var c=m(a.currentTarget,a.type);if(c){for(var b=!0,d=0;d<c.length;d++){var e=c[d];e.args[0]=
a;!1===e.fn.apply(e.ref,e.args)&&(b=!1);e.args[0]=null}b||jb(a)}},a="mouseover mouseout mouseenter mouseleave mousedown mousemove mouseup wheel touchstart touchmove touchend touchcancel click dblclick contextmenu keydown keyup keypress blur focus scroll change transitionend".split(" "),c={add:function(a,c){a.dom.addEventListener(c,I)},remove:function(a,c){a.dom.removeEventListener(c,I)}},f=0;f<a.length;f++)H(b,a[f],c);for(var a="tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
Q=function(a){return"dragstart"===a||"dragmove"===a||"dragend"===a||"dragcancel"===a},J=function(a,c){var b=a.data("_gestures");!b&&c&&(b={listenerCount:0},a.data("_gestures",b));return b},c={add:function(a,c){var b=J(a,!0);b.touches||(b.touches=[],a.ontouchstart(C));b.listenerCount++;Q(c)&&(b.dragCount||(b.dragCount=0,a.onmousedown(U)),b.dragCount++)},remove:function(a,c){var b=J(a);b&&(b.listenerCount--,0===b.listenerCount&&(a.removeData("_gestures"),a.offtouchstart(C)),Q(c)&&0<b.dragCount&&(b.dragCount--,
b.dragCount||a.offmousedown(U)))}},f=0;f<a.length;f++)H(b,a[f],c);var N={add:function(a,c){},remove:function(a,c){}};b.customEvent=function(a){H(this,a,N)};b.dispatchCustom=function(a,c){var b=!0,d=m(this.dom,a);if(d)for(var e=0;e<d.length;e++){var n=d[e];n.args[0]=c;!1===n.fn.apply(n.ref,n.args)&&(b=!1);b&&c.defaultPrevented&&c.defaultPrevented()&&(b=!1);n.args[0]=null}return b};var D=function(a,c,b,e,n){for(var g=!0;a&&a.dom&&!m(a.dom,c);)a=a.parent();a&&!a.dom&&(a=null);if(a&&a.dom){var g=b.start,
f=b.current,l=g.center,E=f.center,p=b.delta;p||(p=b.delta={x:0,y:0});p.x=E.x-l.x;p.y=E.y-l.y;if(p.x||p.y)b.moved=!0;var v=b.moved||!1,H=b.press?!!b.press.started:!1,ja=L(Zb(l.x,l.y,E.x,E.y)),h=l.x,r=l.y,C=E.x,X=E.y,h=L(h==C&&r==X?0:Math.atan2(r-X,C-h),100),k;0<ja&&(k=d[Math.floor((12*h/Math.PI+24)%24)]);r=1;C=0;b.touches&&1<b.touches.length&&(0<g.distance&&(r=f.distance/g.distance),C=$b(f.angle-g.angle));b={type:c,srcEvent:e,target:a.dom,distance:ja,angle:h,scale:r,rotation:C,start:l,center:E,delta:p,
direction:k,moved:v,press:H,kinetic:!!n};R.OILogGesture&&R.OILogGesture(c,a,b);g=a.dispatchCustom(c,b);for(a=a.parent();g&&a&&a.dom;a=a.parent())m(a.dom,c)&&(g=a.dispatchCustom(c,b))}return g},O=function(a,c,b){c.press&&(c.press.started=!0,D(a,"press",c,b))},B=function(a,c,b){c.press&&(c.press.started&&D(a,"pressup",c,b),c.press.timer&&sa(c.press.timer),delete c.press)},r=function(a,c,b,d,e,n){a=b.kinetic;var g=!1,f;if(a){b.start=e;b.current=n;var m=Date.now()-a.frameTime,m=Math.exp(-m/325),l;a.ax&&
(f=-a.ax*m,.5>Math.abs(f)&&(f=0),b.current.center.x=e.center.x+a.tx+f);a.ay&&(l=-a.ay*m,.5>Math.abs(l)&&(l=0),b.current.center.y=e.center.y+a.ty+l);if(f||l)f=b.dragCount?"dragmove":"panmove",D(c,f,b,d,!0),g=!0,a.anim=cb(r,null,c,b,d,e,n)}g||(f=b.dragCount?"dragend":"panend",D(c,f,b,d,!0),delete b.kinetic,delete b.start,delete b.current)},g=function(a,c,b){c.pan&&(D(a,"pancancel",c,b),delete c.pan)},k=function(a){if(a){var c=Date.now();if(1==a.length){var b=a[0];a={x:L(b.x),y:L(b.y)};return{distance:0,
angle:0,center:a,time:c}}if(2<=a.length){for(var d=0,e,n=a.length-1,g=0;g<n;g++)for(var f=a[g],m=g+1;m<a.length;m++){var l=a[m],l=Zb(f.x,f.y,l.x,l.y);l>d&&(d=l,e=f,b=a[m])}a:{if(a){var E,p;if(1==a.length){n=a[0];a={x:n.x,y:n.y};break a}if(2==a.length){n=a[0];E=a[1];a={x:(n.x+E.x)/2,y:(n.y+E.y)/2};break a}if(2<a.length){n={x:0,y:0};g=0;f=a.length-1;for(m=0;m<a.length;m++){E=a[m];p=m<f?a[m+1]:a[0];l=E.x;E=E.y;var v=p.x;p=p.y;var H=l*p-v*E,g=g+H;n.x+=(l+v)*H;n.y+=(E+p)*H}g*=3;n.x/=g;n.y/=g;a=n;break a}}a=
void 0}a.x=L(a.x);a.y=L(a.y);d=L(d);n=e.x;e=e.y;g=b.x;b=b.y;return{distance:d,angle:L(n==g&&e==b?0:Math.atan2(e-b,g-n),100),center:a,time:c}}}};b.kinetic=function(a){!0===a?J(this,!0).enableKinetic=!0:!1===a&&(a=J(this))&&delete a.enableKinetic};b.cancelKinetic=function(){var a=J(this);a&&a.kinetic&&(a.kinetic.anim&&ac(a.kinetic.anim),delete a.kinetic)};var C=function(a){var c=J(this);if(c){this.cancelKinetic();var b=c.touches,d=a.changedTouches,e=w.viewNode,n=null;c.dragCount||(n=this.pos(e));for(var f=
0;f<d.length;f++){var m=e.touchPos(d[f]);n&&(m.x-=n.left,m.y-=n.top);m.ox=m.x;m.oy=m.y;b.push(m)}c.current=k(c.touches);c.start=c.current;1==b.length?(delete c.tap,c.tap={time:c.current.time},B(this,c,a),a=ca(O,500,null,this,c,a),c.press={timer:a}):1<b.length&&!c.pinch&&(delete c.tap,B(this,c,a),g(this,c,a),delete c.distance,c.pinch||(c.pinch={},D(this,"pinchstart",c,a)));$a.setTouchCapture(K,ba,ia,this);return!1}},K=function(a){var c=J(this);if(c){for(var b=c.touches,d,e=a.changedTouches,n=c.dragCount?
w.viewNode:this,f=0;f<e.length;f++)for(var m=n.touchPos(e[f]),l=0;l<b.length;l++)if(d=b[l],d.identifier===m.identifier){d.x=m.x;d.y=m.y;d.dx=m.x-d.ox;d.dy=m.y-d.oy;break}d=c.current;e=k(c.touches);if(e.distance!==d.distance||e.angle!==d.angle||e.center.x!==d.center.x||e.center.y!==d.center.y)if(c.previous=d,c.current=e,1!=b.length||c.multi)1<b.length&&(c.multi=!0,c.pinch&&(b=c.previous,d=c.current,e=c.start,0<e.distance&&(n=L(b.distance/e.distance,100),L(d.distance/e.distance,100)!=n&&D(this,"pinchmove",
c,a)),d.angle!=b.angle&&(c.rotate||(c.rotate={start:c.start.angle},D(this,"rotatestart",c,a)),D(this,"rotatemove",c,a))));else if(d=b[0],b=c.distance=Zb(d.dx,d.dy,0,0),d=e.time-c.start.time,10<b&&50<d&&(delete c.tap,c.press&&c.press.started||B(this,c,a),c.pan||(g(this,c,a),c.pan={startTime:c.current.time},c.enableKinetic&&!c.press&&(c.kinetic={vx:0,vy:0,frameTime:c.current.time,frameX:0,frameY:0}),D(this,c.dragCount?"dragstart":"panstart",c,a)),c.pan&&(D(this,c.dragCount?"dragmove":"panmove",c,a),
a=c.kinetic)))b=c.current.time,d=b-a.frameTime,e=c.delta,c.pan.moveTime=b,c=e.y-a.frameY,a.vx=1E3*(e.x-a.frameX)/(d+1)*.8+.2*a.vx,a.vy=1E3*c/(d+1)*.8+.2*a.vy,a.vx=fa(a.vx,-1E4,1E4),a.vy=fa(a.vy,-1E4,1E4),a.frameTime=b,a.frameX=e.x,a.frameY=e.y;return!1}},ba=function(a){na(this,a,!1)},ia=function(a){na(this,a,!0)},na=function(a,c,b){var d=J(a);if(d){var e=d.touches,n=e.length-c.changedTouches.length;try{if(1==e.length)if(b)delete d.tap,B(a,d,c),g(a,d,c);else{if(d.pan){var f=Date.now(),m=f-d.pan.startTime;
b=!1;var l,E=d.kinetic;E&&(150<f-d.pan.moveTime&&(E.vx=0,E.vy=0),10<Math.abs(E.vx)&&(E.ax=.8*E.vx,E.tx=Math.round(d.delta.x+E.ax)),10<Math.abs(E.vy)&&(E.ay=.8*E.vy,E.ty=Math.round(d.delta.y+E.ay)),E.ax||E.ay?(E.frameTime=f,E.anim=cb(r,null,a,d,c,d.start,d.current),b=!0):delete d.kinetic);b||(l=d.dragCount?"dragend":"panend",D(a,l,d,c));if(!(d.dragCount||d.press&&d.press.started)&&1E3>m){var p=d.touches[0],H=Math.abs(p.dx),v=Math.abs(p.dy);60<=H&&60>v?l=0>p.dx?"swiperight":"swipeleft":60<=v&&60>H&&
(l=0>p.dy?"swipeup":"swipedown");l&&D(a,l,d,c)}delete d.pan}B(a,d,c);d.tap&&(200>Date.now()-d.tap.time&&D(a,"tap",d,c),delete d.tap)}else 1<e.length&&1>=n&&(b?(d.rotate&&(D(a,"rotatecancel",d,c),delete d.rotate),d.pinch&&(D(a,"pinchcancel",d,c),delete d.pinch)):(d.rotate&&(D(a,"rotateend",d,c),delete d.rotate),d.pinch&&(D(a,"pinchend",d,c),delete d.pinch)))}catch(ra){F.logError(null,ra)}a=c.changedTouches;for(c=0;c<a.length;c++)for(f=a[c],m=0;m<e.length;m++)if(e[m].identifier===f.identifier){e.splice(m,
1);break}delete d.distance;0===e.length&&(delete d.start,delete d.current,delete d.previous,delete d.multi,$a.releaseTouchCapture());return!1}},A=function(a){a=w.viewNode.mousePos(a);return{distance:0,angle:0,center:{x:a.x,y:a.y}}},U=function(a){if(0===(a.button||0)){var c=A(a),b=J(this,!0);b.start=c;b.current=c;if(!D(this,"dragstart",b,a))return $a.setMouseCapture(n,E,this),!1}},n=function(a){var c=A(a),b=J(this,!0);if(b&&b.current){var d=b.current.center;if(c.center.x!=d.x||c.center.y!=d.y)b.current=
c,D(this,"dragmove",b,a);return!1}},E=function(a){var c=J(this,!0);D(this,"dragend",c,a);$a.releaseMouseCapture();return!1};return e}(),bc=function(){var d=function(b,a,c){T.call(this,"input",c);this.dom.type="button";"string"===typeof b&&(this.dom.value=b);"string"===typeof a&&(this.dom.title=a)},e=W(d,T);Object.defineProperties(e,{disabled:{get:function(){return this.dom.disabled},set:function(b){this.dom.disabled=b}}});return d}(),qc=function(){var d=function(b,a){T.call(this,"textarea",a);"string"===
typeof b&&(this.dom.value=b)},e=W(d,T);Object.defineProperties(e,{value:{get:function(){return this.dom.value},set:function(b){this.dom.value=b}}});e.moveCaret=function(b){var a=this.dom;a.createTextRange?(a=a.createTextRange(),a.move("character",b),a.select()):void 0!==a.selectionStart?(a.focus(),a.setSelectionRange(b,b)):a.focus()};return d}(),pc=function(){var d=function(a,b){T.call(this,"canvas");2===arguments.length?(this.dom.width=a,this.dom.height=b):1===arguments.length&&(this.dom.width=a.clientWidth,
this.dom.height=a.clientHeight,y.wrap(a).append(this))},e=W(d,T);Object.defineProperties(e,{width:{get:function(){return this.dom.width}},height:{get:function(){return this.dom.height}}});var b=function(a,b,d,e,t,u,v,p){this.globalAlpha=1;void 0!==t&&(this.fillStyle=t);u?(this.strokeStyle=u,this.lineWidth=v||1,this.lineCap="square",this.beginPath(),this.setLineDash(p||[]),this.rect(a,b,d,e),t&&this.fill(),this.stroke(),this.closePath()):(this.lineWidth=0,this.fillRect(a,b,d,e))},a=function(a,b,d,
e,t,u,v){void 0!==t&&(this.strokeStyle=t);this.lineWidth=u||1;this.lineCap="square";this.globalAlpha=1;this.beginPath();this.setLineDash(v||[]);this.moveTo(a,b);this.lineTo(d,e);this.stroke();this.closePath()};e.getContext=function(c){c=this.dom.getContext(c);c.oitrect=b;c.oitline=a;return c};return d}(),Aa=function(){var d=function(d,b){this.prop("list",d);this.prop("name",b)};W(d);return d}(),db=function(){var d=function(b){this._createFn=b;this._plugins={}},e=W(d);e.item=function(b){return this._plugins[b]};
e.items=function(){return this._plugins};e.extend=function(b,a){if(Array.isArray(b))for(var c=0;c<b.length;c++)this.extend.call(this,b[c],a);else{if("string"===typeof b)return c=this._plugins[b],c||(c=this._createFn.call(this,b))&&(this._plugins[b]=c),c&&c.extend.call(c,a),c;if("object"===typeof b)for(c in b)this.extend.call(this,c,b[c])}};return d}(),w=function(){var d=new db(function(e){return new rc(d,e)});d.reset=function(d,b){if("string"===typeof d){"boolean"!==typeof b&&(b=!0);var a=this._plugins[d];
a&&a.reset(b)}};d.resetAll=function(d){"boolean"!==typeof d&&(d=!0);for(var b in this._plugins)this._plugins[b].reset(d)};d.defaultVal=function(d){if(d=this._plugins[d])return d.defaultVal()};d.setProperty=function(d,b,a){(d=this._plugins[d])&&d.setProperty(b,a)};return d}(),rc=function(){var d=function(b,a){Aa.call(this,b,a)},e=W(d,Aa);e.extend=function(b){b=b||{};var a={_v:{value:void 0,writable:!0}};b.init&&(a.init={value:b.init});void 0!==b.def&&(a.def={value:b.def});this.list!==w&&(!0===b.pub&&
(a.pub={value:b.pub}),b.legal&&(a.legal={value:b.legal}),b.validate&&(a.validate={value:b.validate}),b.type&&(a.type={value:b.type||"boolean"},"number"===b.type||Array.isArray(b.type)&&-1!=b.type.indexOf("number")))&&("number"===typeof b.min&&(a.min={value:b.min}),"number"===typeof b.max&&(a.max={value:b.max}));Object.defineProperties(this,a);var c=this;this.list["on"+this.name]=function(a,b){return c.listen(a,b)};this.list["off"+this.name]=function(a,b){return c.unlisten(a,b)};Object.defineProperty(this.list,
this.name,{enumerable:!0,get:function(){return void 0===c._v&&(c.init&&(c._v=c.init()),void 0===c._v)?c.defaultVal():c._v},set:function(a){c.set(a)}})};e.listen=function(b,a){void 0===a&&(a=b,b=void 0);this._listeners||(this._listeners=[]);this._listeners.push({context:b,fn:a})};e.unlisten=function(b,a){if(this._listeners){void 0===a&&(a=b);for(var c=0;c<this._listeners.length;c++)if(this._listeners[c].fn==a){this._listeners.splice(c,1);break}}};e.set=function(b,a){if(b!==this._v){if(void 0!==b){var c=
!0;if(this.type){var d=null===b?"null":typeof b,c=d===this.type;!c&&Array.isArray(this.type)&&(c=-1!=this.type.indexOf(d));c||"string"!==d||(c="color"===this.type,!c&&Array.isArray(this.type)&&(c=-1!=this.type.indexOf("color")),c&&(d="color"));c&&"color"===d?Fa(b)||(this.pub&&F.invalidArg("setOptions",this.name,b,"Must be a CSS color string"),b=this._v):c||("null"===d?b=void 0:(this.pub&&(d=Array.isArray(this.type)?"Must be one of these types: "+JSON.stringify(this.type):"Must be of type "+this.type,
F.invalidArg("setOptions",this.name,b,d)),b=this._v))}c&&(this.legal&&-1==this.legal.indexOf(b)?(this.pub&&F.invalidArg("setOptions",this.name,b,"Must be one of "+JSON.stringify(this.legal)),b=this._v):void 0!==this.min&&b<this.min?(this.pub&&F.invalidArg("setOptions",this.name,b,"Using minimum value of "+this.min,!1),b=this.min):void 0!==this.max&&b>this.max?(this.pub&&F.invalidArg("setOptions",this.name,b,"Using maximum value of "+this.max,!1),b=this.max):this.validate&&(b=this.validate(this.name,
b,this._v)))}if(b!==this._v){c=this._v;if("object"===this.type){this._v={};for(var e in b)b.hasOwnProperty(e)&&(this._v[e]=b[e])}else this._v=b;if(!1!==a&&this._listeners)for(e=0;e<this._listeners.length;e++)d=this._listeners[e],d.fn.call(d.context,this._v,c,this.name)}}};e.setProperty=function(b,a){if("object"===this.type||Array.isArray(this.type)&&-1!=this.type.indexOf("object")&&(!this._v||this._v[b]!==a))if(this._v||(this._v={}),this._v[b]!==a&&(this._v[b]=a,this._listeners))for(var c=0;c<this._listeners.length;c++){var d=
this._listeners[c];d.fn.call(d.context,this._v,null,this.name)}};e.reset=function(b){this.set(void 0,b)};e.defaultVal=function(){return this.def};return d}();w.extend({URL:{init:function(){return V.URL}},baseURL:{init:function(){return x.outputBaseUrl}},viewNode:{init:function(){var d=w.rootNode;if(d)return y.attach(d.childByClass("oit-view"))}},rootNode:{init:function(){var d=y.byClass("oit-view-root");if(d&&0<d.length)return y.attach(d[0])}},deType:{},drawing:{},libversion:{},documentLoading:{def:!1},
documentLoaded:{def:!1},documentComplete:{def:!1},documentUnloading:{def:!1},dynamicContent:{def:!1},enableRawText:{},guid:{},singlePageIndex:{},isMobile:{init:function(){return sc()}},isMobileOrTablet:{init:function(){return tc()}},editingComment:{def:0},staging:{def:!1},hasHiddenText:{def:!1},hasWorksheetRevisions:{def:!1},httpHeaders:{def:null},withCredentials:{def:!1}});var x=function(){var d=new db(function(e){return new rc(d,e)});d.isPublic=function(d){return(d=this._plugins[d])&&d.pub};d.reset=
function(d){ab(this._plugins,"reset",null,d)};d.reset=function(d,b){if("string"===typeof d){"boolean"!==typeof b&&(b=!0);var a=this._plugins[d];a&&a.reset(b)}};d.resetAll=function(d){"boolean"!==typeof d&&(d=!0);for(var b in this._plugins)this._plugins[b].reset(d)};d.defaultVal=function(d){if(d=this._plugins[d])return d.defaultVal()};d.setProperty=function(d,b,a){(d=this._plugins[d])&&d.setProperty(b,a)};return d}();x.extend({disableAnimation:{pub:!0,type:"boolean",init:function(){return!1}},memoryModel:{pub:!0,
type:"string",legal:["large","small","micro","none"],init:function(){return w.isMobileOrTablet?"small":"large"}},detectBaseUrl:{pub:!0,type:"boolean",def:!0},outputBaseUrl:{pub:!0,type:"string",def:""},centerPages:{pub:!0,type:"boolean",def:!0},redactionColor:{pub:!0,type:"color",def:"#000"},redactionFillColor:{pub:!0,type:"color",def:null},showHighlightLabels:{pub:!0,type:"boolean",def:!0},highlightLabelFontFamily:{pub:!0,type:"string",def:null},highlightLabelFontSize:{pub:!0,type:"string",def:null},
highlightActivationBoxColor:{pub:!0,type:["color","null"],def:null},redactionMode:{pub:!0,type:"string",legal:["simple","compound","hybrid"],def:"hybrid"},contentTimeout:{pub:!0,type:"number",min:1,def:2E4},doubleClickInterval:{pub:!0,type:"number",def:500,min:1,max:1E4},removeExtraEmailHeaders:{pub:!0,type:"boolean",def:!1},emailHeaderStyle:{pub:!0,type:"object",def:null},zoom:{type:"number",def:1,min:.1,max:40},zoomMode:{type:["string","null"],legal:[null,"page","pagewidth","pageheight","mobile"],
init:function(){return w.isMobileOrTablet?"mobile":null}},rotation:{type:"number",legal:[0,90,180,270],def:0},selectionMode:{type:"string",legal:["text","rect","cell","none"],def:"text",validate:function(d,e,b){return S.validateMode(e,b)}},nochrome:{pub:!0,type:"boolean",def:!1,init:function(){return!1}},scrollMode:{pub:!0,type:"string",legal:["single","vertical","hswipe","vswipe"],def:"vertical",init:function(){return w.isMobileOrTablet?"hswipe":"vertical"}},showSlideNotes:{pub:!0,type:"boolean",
def:!1},showAnnotations:{pub:!0,type:"boolean",def:!1},presentationMode:{pub:!0,type:"string",legal:["normal","slideshow"],def:"normal"},showEmailAddresses:{pub:!0,type:"boolean",def:!1},showHiddenSheets:{pub:!0,type:"boolean",def:!1},showHiddenRows:{pub:!0,type:"boolean",def:!1},showHiddenColumns:{pub:!0,type:"boolean",def:!1},showCellTooltips:{type:"boolean",def:!1},showHiddenContentNotification:{pub:!0,type:"string",legal:["none","expanded","collapsed"],def:"collapsed"},appointmentHeader:{pub:!0,
type:"object",def:{subjectField:"SUBJECT",headerFields:[["ORGANIZER","FROM"],"IMPORTANCE","LOCATION","DTSTART","DTEND","CATEGORIES","ATTENDEES","REQATTENDEE","OPTATTENDEE"]}},contactHeader:{pub:!0,type:"object",def:{subjectField:["SUBJECT","DISPLAYAS","FILEAS","FULLNAME"],defaultSubject:!1,dateField:null,photoField:[{g:"PHOTO",id:"PHOTO"},"PHOTO"],logoField:[{g:"LOGO",id:"LOGO"},"LOGO"],headerFields:["COMPANY",[{g:"NAME",id:"FIRST"},"FIRST"],[{g:"NAME",id:"MIDDLE"},"MIDDLE"],[{g:"NAME",id:"FAMILY"},
"FAMILY"],[{g:"NAME",id:"SUFFIX"},"SUFFIX"],[{g:"NAME",id:"TITLE"},"TITLE","JOBTITLE"],{multi:!0,fields:[{g:"TELENUMBER",t:"Work",id:"TELENUMBER",l:"EMAIL_BUSINESSPHONE"},{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},"BUSINESSPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Cell",id:"TELENUMBER",l:"EMAIL_MOBILEPHONE"},"MOBILEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Pager",id:"TELENUMBER",l:"EMAIL_PAGERPHONE"},"PAGERPHONE"]},
{multi:!0,fields:[{g:"TELENUMBER",t:"Home",id:"TELENUMBER",l:"EMAIL_HOMEPHONE"},{g:"ADDRESS",t:"Home",id:"PHONE",l:"EMAIL_HOMEPHONE"},"HOMEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Postal",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},{g:"ADDRESS",t:"Postal",id:"PHONE",l:"EMAIL_OTHERPHONE"},{g:"TELENUMBER",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},"TELENUMBER","OTHERPHONE"]},{multi:!0,fields:[{g:"EMAIL",id:"EMAIL",d:"DISPLAYAS"},"EMAIL"]},"WEBPAGE","IMADDRESS","DISPLAYAS",{title:"BUSINESSADDRESS",fields:[[{g:"ADDRESS",
t:"Work",id:"POBOX"},{g:"BUSINESSADDRESS",id:"BUSINESSPOBOX"},"BUSINESSPOBOX"],[{g:"ADDRESS",t:"Work",id:"STREET"},{g:"BUSINESSADDRESS",id:"BUSINESSSTREET"},"BUSINESSSTREET"],[{g:"ADDRESS",t:"Work",id:"CITY"},{g:"BUSINESSADDRESS",id:"BUSINESSCITY"},"BUSINESSCITY"],[{g:"ADDRESS",t:"Work",id:"STATE"},{g:"BUSINESSADDRESS",id:"BUSINESSSTATE"},"BUSINESSSTATE"],{g:"ADDRESS",t:"Work",id:"REGION"},[{g:"ADDRESS",t:"Work",id:"POSTALCODE"},{g:"BUSINESSADDRESS",id:"BUSINESSPOSTALCODE"},"BUSINESSPOSTALCODE"],
[{g:"ADDRESS",t:"Work",id:"COUNTRY"},{g:"BUSINESSADDRESS",id:"BUSINESSCOUNTRY"},"BUSINESSCOUNTRY"],[{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE2"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE2"},"BUSINESSPHONE2"],[{g:"ADDRESS",t:"Work",id:"BUSINESSFAX"},{g:"BUSINESSADDRESS",id:"BUSINESSFAX"},"BUSINESSFAX"]]},{title:"HOMEADDRESS",fields:[[{g:"ADDRESS",t:"Home",id:"POBOX"},"HOMEPOBOX"],[{g:"ADDRESS",t:"Home",id:"STREET"},"HOMESTREET"],[{g:"ADDRESS",t:"Home",id:"CITY"},"HOMECITY"],[{g:"ADDRESS",t:"Home",id:"STATE"},
"HOMESTATE"],{g:"ADDRESS",t:"Home",id:"REGION"},[{g:"ADDRESS",t:"Home",id:"POSTALCODE"},"HOMEPOSTALCODE"],[{g:"ADDRESS",t:"Home",id:"COUNTRY"},"HOMECOUNTRY"],[{g:"ADDRESS",t:"Home",id:"PHONE2"},"HOMEPHONE2"],[{g:"ADDRESS",t:"Home",id:"FAX"},"HOMEFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",t:"Postal",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",t:"Postal",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",t:"Postal",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",t:"Postal",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",
t:"Postal",id:"REGION"},[{g:"ADDRESS",t:"Postal",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",t:"Postal",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",t:"Postal",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",t:"Postal",id:"FAX"},"OTHERFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",id:"REGION"},[{g:"ADDRESS",id:"POSTALCODE"},"OTHERPOSTALCODE"],
[{g:"ADDRESS",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",id:"FAX"},"OTHERFAX"]]}]}},distroHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:[]}},journalHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"START",headerFields:["ENTRY_TYPE","COMPANY","DURATION","CATEGORIES"]}},emailHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:["CLIENT_SUBMIT_TIME","DATE"],headerFields:["FROM","TO","CC",
"BCC"]}},noteHeader:{pub:!0,type:"object",def:{subjectField:null,dateField:null,headerFields:["CREATION_TIME","CATEGORIES"]}},postHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"CREATION_TIME",headerFields:["FROM","CLIENT_SUBMIT_TIME","CONVERSATION_TOPIC"]}},taskHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:"START_DATE STATUS DUE_DATE PRIORITY OWNER PERCENT_COMPLETE CATEGORIES".split(" ")}},annoBarWidth:{pub:!0,type:"number",init:function(){return Math.min(w.viewNode.clientWidth/
2,320)}},highlightTermIntervals:{pub:!0,type:"boolean",def:!0},highlightActivationStyle:{pub:!0,type:"string",legal:["box","opacity"],def:"opacity"},annotationSort:{pub:!0,type:"string",legal:"location date rdate author rauthor type".split(" "),def:"location"},normalizeAccentsForSearch:{pub:!0,type:"boolean",def:!0}});var Vc=function(){var d=function(a,c,b){Aa.call(this,c,b);this.prop("host",a,!1,!0)},e=W(d,Aa),b=function(a,c,b){var d=a._int;if(d)for(var e=0;e<d.length;e++){var f=d[e];if(!(f.fn!==
c||void 0!==b&&f.context!==b||a._xint&&-1!==a._xint.indexOf(e)))return e}return-1},a=function(a,c){var b=a._pub;return b?b.indexOf(c):-1},c=function(a,c,d,e){void 0===d&&(d=c,c=void 0);if(-1===b(a,d,c)){var m=!a.hasListeners(),f={context:c,fn:d};!0===e&&(f.listenOnce=!0);a.single&&a.hasListeners()?a.logError(null,"Only one listener may be registered for the "+a.name+" event."):(a._int||a.prop("_int",[],!0),a._int.push(f),m&&a.isSystemEvent()&&a.list.addElementListeners(a.name),a.onListen&&a.onListen.call(null,
a,d,c))}},f=function(a,c){-1!=c&&(a.dispatching?(a._xint||(a._xint=[]),a._xint.push(c)):(a._int.splice(c,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onUnlisten&&a.onUnlisten.call(null,a)))},h=function(a,c){-1!=c&&(a.dispatching?(a._xpub||(a._xpub=[]),a._xpub.push(c)):(a._pub.splice(c,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onRemove&&a.onRemove.call(null,a)))},q=function(){var a;this.detail&&(a=this.detail.apply(null,arguments));
var c=this.systemEventName||this.name,b=V.createEvent("CustomEvent");b.initCustomEvent(c,!0,!0,a);return b},t=function(){var a=!0,c,b;this.dispatching=!0;var d=this._int;if(d)for(c=d.length,b=0;b<c;b++){var e=d[b];e.listenOnce&&f(this,b);!1===e.fn.apply(e.context,arguments)&&(a=!1)}d=this._pub;if(a&&d){a=q.apply(this,arguments);c=d.length;for(b=0;b<c;b++)d[b].call(void 0,a);a=!a.defaultPrevented}a&&this._def&&(a=this._def.fn.apply(this._def.context,arguments));this.dispatching=!1;if(this._xint){for(b=
this._xint.length-1;0<=b;b--)f(this,this._xint[b]);delete this._xint}if(this._xpub){for(b=this._xpub.length-1;0<=b;b--)h(this,this._xpub[b]);delete this._xpub}return a};e.extend=function(a){a&&(!0===a.pub&&(this.prop("pub",!0),a.detail&&this.prop("detail",a.detail)),!0===a.systemEvent&&this.prop("systemEventName","_"+this.name),0<a.delay&&this.prop("delay",a.delay),!0===a.single&&this.prop("single",!0),this.prop("onListen",a.onListen),this.prop("onUnlisten",a.onUnlisten),this.prop("onAdd",a.onAdd),
this.prop("onRemove",a.onRemove),Object.defineProperty(this.list,this.name,{enumerable:!0,value:this}))};e.enable=function(){this.disabled=!1};e.disable=function(){this.disabled=!0};e.hasListeners=function(){return!!this._def||this._int&&0<this._int.length||this._pub&&0<this._pub.length};e.isSystemEvent=function(){return!!this.systemEventName};e.setDefaultListener=function(a,c){if(a){this._def&&this.setDefaultListener(null);var b=!this.hasListeners();this._def={context:c,fn:a};b&&this.isSystemEvent()&&
this.list.addElementListeners(this.name);this.onListen&&this.onListen.call(null,this,a,c)}else this._def&&(delete this._def,!this.hasListeners()&&this.isSystemEvent()&&this.list.removeElementListeners(this.name),this.onUnlisten&&this.onUnlisten.call(null,this))};e.listen=function(a,b){c(this,a,b,!1)};e.listenOnce=function(a,b){c(this,a,b,!0)};e.unlisten=function(a,c){void 0===c&&(c=a,a=void 0);f(this,b(this,c,a))};e.addPublicListener=function(c){var b=!1;if(this.pub&&"function"===typeof c)if(-1!==
a(this,c))b=!0;else{var d=!this.hasListeners();this.single&&this.hasListeners()?this.logError(null,"Only one listener may be registered for the "+this.name+" event."):(this._pub||this.prop("_pub",[],!0),this._pub.push(c),d&&this.isSystemEvent()&&this.list.addElementListeners(this.name),this.onAdd&&this.onAdd.call(null,this,c),b=!0)}return b};e.removePublicListener=function(c){c=a(this,c);if(-1==c)return!1;h(this,c);return!0};e.dispatch=function(){this.logDispatch&&this.logDispatch.apply(this,arguments);
if(this.hasListeners()&&!this.disabled){if(!this.delay||w.documentUnloading)return t.apply(this,arguments);this._dispatchTimer&&sa(this._dispatchTimer);this._ddArgs=arguments;this._dispatchTimer=ca(u,this.delay,this)}return!0};var u=function(){t.apply(this,this._ddArgs);delete this._ddArgs};e.dispatchTo=function(a,c){var b=q.apply(this,c);a.call(void 0,b);return!b.defaultPrevented};e.reset=function(){this._int&&(this._int=[]);this._pub&&(this._pub=[]);delete this._def};return d}(),uc=function(){var d=
"mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel".split(" "),e=function(a){for(a=y.unwrap(a);a;){var c=y.data(a,"dispatcherData");if(c)return c;a=a.parentNode}},b=function(a){return new Vc(this._host,this,a)},a=function(a,c){db.call(this,b);this.name=c;this._host=a;this._eventElements=[];var d=this;this.onSystemEvent=function(a){var c=!0,b=d[a.type];if(b&&b.hasListeners()&&!b.disabled){var f=e(a.currentTarget||a.target);if(f)for(var l=
0;c&&l<f.length;l++){var m=f[l];m.args[1]=a;c=b.dispatch.apply(b,m.args);m.args[1]=null}}c||jb(a);return c}},c=W(a,db);c.enable=function(){this.disabled=!1};c.disable=function(){this.disabled=!0};c.addElementListeners=function(a){if(this[a])if(-1!==d.indexOf(a))for(var c=0;c<this._eventElements.length;c++){var b=this._eventElements[c];b.addEventListener(a,this.onSystemEvent,!1)}else for(c=0;c<this._eventElements.length;c++)b=this._eventElements[c],y.wrap(b).on(a,this,this.onSystemEvent)};c.removeElementListeners=
function(a){if(this[a])if(-1!==d.indexOf(a))for(var c=0;c<this._eventElements.length;c++)this._eventElements[c].removeEventListener(a,this.onSystemEvent);else for(c=0;c<this._eventElements.length;c++)y.wrap(this._eventElements[c]).off(a,this,this.onSystemEvent)};c.addElement=function(a,c){if((a=y.unwrap(a))&&a.addEventListener){var b;if(-1==this._eventElements.indexOf(a))for(b in this._eventElements.push(a),this._plugins){var f=this[b];if(f.isSystemEvent()&&f.hasListeners())if(-1!==d.indexOf(b))a.addEventListener(b,
this.onSystemEvent,!1);else y.wrap(a).on(b,this,this.onSystemEvent)}f={context:c,args:[y.wrap(a),null]};for(b=1;b<arguments.length;b++)f.args.push(arguments[b]);var h=e(a);h||(h=[],y.data(a,"dispatcherData",h));var v=!1;for(b=0;b<h.length;b++)if(h[b].context===c){h[b]=f;v=!0;break}v||h.push(f)}};c.removeElement=function(a,c){a=y.unwrap(a);var b=this._eventElements.indexOf(a);if(-1!=b){var f=!0;if(void 0===c)y.removeData(a,"dispatcherData");else{var h=e(a);if(h){for(var v=0;v<h.length;v++)if(h[v].context===
c){1==h.length?h=null:h.splice(v,1);break}h&&0!==h.length?f=!1:y.removeData(a,"dispatcherData")}}if(f){this._eventElements.splice(b,1);for(var p in this._plugins)b=this[p],b.isSystemEvent()&&b.hasListeners()&&(-1!==d.indexOf(p)?a.removeEventListener(p,this.onSystemEvent):y.wrap(a).off(p,this,this.onSystemEvent))}}};c.removeAllElements=function(){for(var a=this._eventElements.length-1;0<=a;a--)this.removeElement(this._eventElements[a])};c.eventMessage=function(){if(!this._eventMessage){for(var a in this._plugins)this._eventMessage=
this._eventMessage?this._eventMessage+","+a:"Must be one of ["+a;this._eventMessage&&(this._eventMessage+="]")}return this._eventMessage};return a}(),Pa=new uc(null,"globalEvents");Pa.extend({install:{},init:{}});var xa=function(){return new db(function(d){return new Wc(d)})}(),Wc=function(){var d="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
e=function(a){Aa.call(this,xa,a)},b=W(e,Aa),a=function(a,c){a["on"+c.name]=function(a,b){c.listen(a,b)};a["off"+c.name]=function(a,b){c.unlisten(a,b)}};b.extend=function(c){this.def=c;Pa.install.listen(this,this.install);var b=c.events;c=c.userEventDef;if(b||c){this.on||(this.on=new uc(this,this.name));if(b)for(var e in b){var f=b[e],u=this.on.extend.call(this.on,e,f);a(this,u);f&&f.pub&&(this.hasPublicEvents=!0)}c&&(c.systemEvent=!0,this.on.extend.call(this.on,d,c),c.pub&&(this.hasPublicEvents=!0))}};
b.install=function(){var a=this,c=this.def;delete this.def;c.install&&c.install(this);if(a.hasPublicEvents||c.exports&&0<c.exports.length){OIT[a.name]||(pb(a.name,{}),a.publicName="OIT."+a.name);var b={};a.hasPublicEvents&&(a.addEventListener||(b.addEventListener={value:function(c,b){var d=!1,e=a.on[c];e?d=e.addPublicListener(b):a.invalidArg("addEventListener","name",c,a.on.eventMessage());return d}}),a.removeEventListener||(b.removeEventListener={value:function(c,b){var d=!1,e=a.on[c];e?d=e.removePublicListener(b):
a.invalidArg("removeEventListener","name",c,a.on.eventMessage());return d}}));if(c.exports&&0<c.exports.length)for(var d=0;d<c.exports.length;d++){var e=c.exports[d],v=a[e];void 0!==v&&(b||(b={}),b[e]={value:v})}Object.defineProperties(OIT[a.name],b)}};var c=function(a,b){if(Array.isArray(b))for(var d=0;d<b.length;d++){if(c(a,b[d]))return!0}else{if(void 0===a)return!0;switch(b){case "null":if(null===a)return!0;break;case "function":if(null===a||Ga(a))return!0;break;case "DOMRange":if(null===a||Ia(a))return!0;
break;case "DOMSelection":if(null===a||Ka(a))return!0;break;case "RegExp":if(null===a||a instanceof RegExp)return!0;break;case "string":if(null===a||"string"===typeof a)return!0;break;default:if(typeof a===b)return!0}}return!1};b.processArguments=function(a,b,d){for(var e={},f=0,h=0;f<d.length;f++){var p=d[f];e&&p.def&&(e[p.name]=p.def);if(h>=b.length)p.req&&(this.logError(a,"Argument '"+p.name+"' is required"),e=null);else{var l=b[h];if(c(l,p.type)){var m=null;p.val?m=p.val(l):p.legal&&-1==p.legal.indexOf(l)&&
(m="Must be one of "+JSON.stringify(p.legal));m?(this.invalidArg(a,p.name,l,m),e=null):e&&(e[p.name]=l);h++}else p.req&&(this.invalidArg(a,p.name,l,"Must be of type "+JSON.stringify(p.type)),h++,e=null)}}return e};return e}(),xb=function(){return new db(function(d){return new Xc(d)})}(),Xc=function(){var d=function(b){Aa.call(this,xb,b)},e=W(d,Aa);e.extend=function(b){this.def=b;Pa.install.listen(this,this.install)};e.install=function(){var b=this.def;delete this.def;b.install&&b.install(this)};e.init=
function(b){if(b.isLoaded())this.load(b);else{var a=this;b.load(!0,function(){a.load(b)})}};e.load=function(b){};e.unload=function(){};e.visiblePages=function(){return[z.activePage()]};e.saveScrollPos=function(){};e.restoreScrollPos=function(b){};e.maxPageWidth=function(){return z.maxWidth()};e.maxPageHeight=function(){return z.maxHeight()};e.padding=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollPadding=function(){};e.margin=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollOffset=
function(){return w.viewNode.scroll()};e.startElasticScroll=function(){};e.elasticScroll=function(b,a){};e.endElasticScroll=function(b,a){};e.getSelectedText=function(){return y.selectedText()};e.select=function(b){return!1};e.keydown=function(b){return!0};e.showHidden=function(b){};e.loadRange=function(b,a){a&&a(b)};e.expandRange=function(b){return b};e.moveto=function(b,a,c){return!1};e.pageRange=function(b,a){};e.pageRect=function(b,a,c){return z.elementRect(z.page(b),a)};e.rangeRect=function(b,
a,c,d){};e.rangeFromRect=function(b,a,c,d,e,q,t){};e.extendRange=function(b,a,c,d){};e.moveAnchor=function(b,a,c,d){return!1};e.incrementSelection=function(b,a,c,d,e){return!1};e.layoutChanged=function(b){};e.update=function(b){};return d}(),ua=function(){var d=new db(function(d){return new Yc(d)});d.createDisplay=function(e){if(e=d.item(e))return xb.item(e.de)};d.features=function(e){if(e=d.item(e))return e.features};return d}(),Yc=function(){var d="zoom rotate showhidden pages fitpage highlights textselection rectselection rectredaction cellselection customtextselection anchorednotes elasticScroll".split(" "),
e=function(b){Aa.call(this,ua,b)};W(e,Aa).extend=function(b){this.de=b.de;for(var a=this.features={},c=0;c<d.length;c++){var e=d[c],h=b[e];void 0===h&&(h=!0);a[e]=h}};return e}(),ib,qb,cc,rb,La,Fa,dc,yb,da=function(d){return"number"===typeof d},eb=function(d){return"string"===typeof d};(function(){var d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",
brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",
darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",
khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",
maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",
paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",
tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"rgba(0,0,0,0)"},e=1/6,b=1/3,a=2/3,c=function(c,b,d){0>d?d+=1:1<d&&--d;d<e?c+=(b-c)*d*6:.5>d?c=b:d<a&&(c+=(b-c)*(a-d)*6);return 255*c|0},f=[{property:"webkit",css:"-webkit-"},{property:"Moz",css:"-moz-"},{property:"ms",css:"-ms-"},{property:"O",css:"-o-"}],h=function(a,c,b){var d=V.documentElement;
if(eb(d.style[a]))return c;if(!1!==b)for(a=a.charAt(0).toUpperCase()+a.slice(1),b=0;b<f.length;b++)if(eb(d.style[f[b].property+a]))return f[b].css+c},q=function(a,c){for(var b,d=V.createElement("div"),e=0;e<c.length;e++)if(d.style[a]=c[e],d.style[a]===c[e]){b=c[e];break}return b};ib={transform:h("transform","transform"),"transform-origin":h("transformOrigin","transform-origin")};Wb=q("cursor",["grab","-webkit-grab","-moz-grab","move"]);Xb=q("cursor",["grabbing","-webkit-grabbing","-moz-grabbing",
"move"]);var t=function(a,c){if(-1!=c)for(var b=a.chars;c<b.length;c++){var d=b[c];if(" "!==d&&"\n"!==d&&"\r"!==d&&"\t"!==d){"/"===d&&"*"===b[c+1]&&(b=a.string.indexOf("*/",c+2),c=-1==b?a.string.length:b+2);break}}return c},u=function(a,c,b){return-1!=c&&a.chars[c]!==b?-1:++c};qb=function(a){var c;if(a){c={};a={string:a,chars:a.split("")};for(var b=0;-1!=b&&b<a.chars.length;){var d=a,e=b,b=c,f={},h=e=t(d,e);if(-1!=h){for(var v=d.chars,e=h;e<v.length;e++){var q=v[e];if(!("a"<=q&&"z">=q||"A"<=q&&"Z">=
q||"0"<=q&&"9">=q)&&"-"!==q&&"_"!==q)break}e>h?(f.name=d.string.substring(h,e),h=e):h=-1}e=h;e=t(d,e);e=u(d,e,":");h=e=t(d,e);if(-1!=h){v=d.chars;for(e=h;e<v.length;e++){q=v[e];if("!"===q||";"===q)break;if('"'===q||"'"===q||"("===q){"("===q&&(q=")");for(var D=e+1;D<v.length;D++){var O=v[D];if(O===q){e=D;break}else if("\\"===O){O=v[++D];if("0"<=O&&"9">=O||"a"<=O&&"f">=O||"A"<=O&&"F">=O){do O=v[++D];while("0"<=O&&"9">=O||"a"<=O&&"f">=O||"A"<=O&&"F">=O)}e=D;break}}}}e>h?(f.value=d.string.substring(h,
e),h=e):h=-1}e=h;e=t(d,e);h=f;-1!=e&&"!important"===d.string.substring(e,e+10)&&(h.important=!0,e+=10);e=t(d,e);e<d.chars.length&&(e=u(d,e,";"));-1!=e&&(b[f.name]=f.value);b=e}}return c};cc=function(a,c){var b=[];if(a)for(var d in a)a.hasOwnProperty(d)&&(c?b.push(d,":",a[d]," !important;"):b.push(d,":",a[d],";"));return b.join("")};rb=function(a,c){if(a&&eb(a)&&eb(c)){for(var b=0;;){b=a.indexOf(c,b);if(-1===b||0===b)break;var d=a.charAt(b-1);if(";"==d||" "==d)break;b++}if(-1!=b){for(b+=c.length;" "===
a.charAt(b);)b++;if(":"===a.charAt(b)){for(b++;" "===a.charAt(b);)b++;d=a.indexOf(";",b);-1===d&&(d=a.length);for(;d>b&&" "===a.charAt(d-1);)d--;return a.substring(b,d)}}}};La=function(){var a=arguments;if(1==a.length){a=a[0];if(eb(a))a=Fa(a);else if(void 0===a.r||void 0===a.g||void 0===a.b)a=void 0;if(a)return La(a.r,a.g,a.b,a.a)}else if(3==a.length||4==a.length){var c=L(fa(a[0],0,255)),b=L(fa(a[1],0,255)),d=L(fa(a[2],0,255)),e=1;4==a.length&&void 0!==a[3]&&(e=fa(a[3],0,1));if(1!=e)return"rgba("+
c+","+b+","+d+","+e+")";c=c.toString(16);b=b.toString(16);d=d.toString(16);2>c.length&&(c="0"+c);2>b.length&&(b="0"+b);2>d.length&&(d="0"+d);return"#"+c+b+d}};Fa=function(a){if(a){var e,f;if(0===a.indexOf("#")){if(e={r:parseInt(a.substring(1,3),16),g:parseInt(a.substring(3,5),16),b:parseInt(a.substring(5,7),16),a:1},isNaN(e.b)){f=a.substring(1,2);var m=a.substring(2,3);a=a.substring(3,4);m+=m;a+=a;e.r=parseInt(f+f,16);e.g=parseInt(m,16);e.b=parseInt(a,16)}}else if(0===a.indexOf("rgba(")||0===a.indexOf("rgb(")){e=
a.replace(/[^\d.,]/g,"").split(",");for(f=0;f<e.length;f++)e[f]=Number(e[f]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);e={r:e[0],g:e[1],b:e[2],a:e[3]}}else if(0===a.indexOf("hsla(")||0===a.indexOf("hsl(")){e=a.replace(/[^\d.,]/g,"").split(",");for(f=0;f<e.length;f++)e[f]=Number(e[f]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);f=e[0];a=e[1];m=e[2];f/=360;a/=100;m/=100;if(0===a)m=a=f=255*m|0;else{var h=.5>m?m*(1+a):m+a-m*a,I=2*m-h,m=c(I,h,f+b);a=c(I,h,f);f=c(I,h,f-b)}e={r:m,g:a,
b:f,a:e[3]}}else if(f=d[a.toLowerCase()])return Fa(f);if(e)return e.r=fa(e.r,0,255),e.g=fa(e.g,0,255),e.b=fa(e.b,0,255),e.a=fa(e.a,0,1),e}};dc=function(a,c,b,d){1<b||(b=1);var e=Fa(a);c=Fa(c);if(!e||!c)return a;var f;!0===d?(a=(e.r+c.r*b)/(1+b),d=(e.g+c.g*b)/(1+b),f=(e.b+c.b*b)/(1+b),b=(e.a+c.a*b)/(1+b)):(c.a=1-e.a,a=e.r*e.a+c.r*c.a,d=e.g*e.a+c.g*c.a,f=e.b*e.a+c.b*c.a,b=1);return La(a,d,f,b)};yb=function(a){if(void 0!==a&&null!==a&&""!==a){var c=Number(a);if(!isNaN(c))return c+"px";if(a.match(/(\d|\.)+(em|ex|px|in|pt|pc|mm|cm|\%)/))return a}else return null}})();
var M;OIT.local||pb("local",{ADDED_COLUMN:"Inserted Column",ADDED_ROW:"Inserted Row",ADDED_SHEET:"Added Sheet",ANNO_CHANGE_FROM:"from",ANNO_CHANGE_TO:"to",ANNOTATIONS:"Annotations",ANNOTATION_TYPE:"Annotation Type",AUTHOR_A_TO_Z:"Author A-Z",AUTHOR_Z_TO_A:"Author Z-A",CANCEL:"Cancel",CHANGED_TEXT:"Changed Text",CLEAR_CELL:"Cleared Cell",COLUMN:"Column",COMMENT:"Comment",DEL:"DEL",DELETED_COLUMN:"Deleted Column",DELETED_ROW:"Deleted Row",DELETED_TEXT:"Deleted Text",DISCARD_CHANGES:"Discard changes",
DOCUMENT_ERROR:"Error occurred, document incomplete.",HIDDEN_SLIDE:"This slide is hidden in presentation mode",HIDDEN_TEXT:"Hidden Text",INSERTED_TEXT:"Inserted Text",LABEL_SEPARATOR:":",LOADING:"Loading",LOCATION:"Location",MODIFIED_CELL:"Modified Cell",MOVED_CELLS:"Moved Cells",MOVED_TEXT:"Moved Text",NEW_CELL:"New Cell",NEWEST_FIRST:"Newest first",NO:"No",NO_SUBJECT:"(No Subject)",NOTES:"Notes",OK:"OK",OLDEST_FIRST:"Oldest first",PAGE_DOWN:"Next Page",PAGE_UP:"Previous Page",PLEASE_WAIT:"Please wait",
PLEASE_WAIT_CONVERTING:"Document conversion in progress...",PLEASE_WAIT_DOWNLOADING:"Loading document, please wait",PLEASE_WAIT_INITIALIZING:"Please wait while your<br>document is loaded...",PREPARING_TO_PRINT:"Preparing to print...",RENAMED_SHEET:"Renamed Sheet",ROW:"Row",SAVE_CHANGES:"Save changes",SHOWDETAILS:"Show Details",SORT_BY:"Sort by: ",HIDEDETAILS:"Hide Details",UNKNOWN_FIELD:"[Unknown Field]",UNSUPPORTED_CONTENT:"(Unsupported Content)",YES:"Yes",HIDDEN_CONTENT_HIDDEN:"Hidden content (Not Visible)",
HIDDEN_CONTENT_PARTIAL:"Hidden content (Partially Visible)",HIDDEN_CONTENT_VISIBLE:"Hidden content (Visible)",HIDDEN_CONTENT_NOTIFICATION:"This document contains hidden information:",HIDDEN_CONTENT_INVISIBLE:"These items are not currently visible in the viewer.",HIDDEN_CONTENT_SHOWLINK:"Show these items",HIDDEN_CONTENT_ALREADY_VISIBLE:"These items are already visible in the viewer.",HIDDEN_CONTENT_ORIGINAL_APPLICATION:"This document contains information that cannot be displayed in the browser. Open the document in the native application to view the full document content:",
HIDDEN_CONTENT_HIDELINK:"Hide these items",HIDDEN_CONTENT_ANNOTATIONS:"Annotations",HIDDEN_CONTENT_PAGES:"Hidden pages",HIDDEN_CONTENT_COLUMNS:"Hidden columns",HIDDEN_CONTENT_ROWS:"Hidden rows",HIDDEN_CONTENT_COMMENTS:"Comments",HIDDEN_CONTENT_SPEAKER_NOTES:"Speaker Notes",HIDDEN_CONTENT_SLIDES:"Hidden slides",HIDDEN_CONTENT_TEXT:"Hidden text",HIDDEN_CONTENT_TRACKED_CHANGES:"Tracked changes",HIDDEN_CONTENT_LARGE_SHEET:"The worksheet is larger than the browser can display",DOCUMENT_ERRORS:"Document Errors",
DOCUMENT_EXCEPTION_NOTIFICATION:"Errors were encountered while processing this document:",DOCEX_MISSING_MAP:"Some text could not be mapped to displayable characters",DOCEX_VERTICAL_TEXT:"Vertical text was present, but could not be displayed correctly",DOCEX_TEXT_EFFECTS:"Some text had unsupported text effects applied",DOCEX_UNSUPPORTED_COMPRESSION:"An embedded graphic used an unsupported compression",DOCEX_UNSUPPORTED_COLOR_SPACE:"An embedded graphic used an unsupported color space",DOCEX_FORMS:"Forms were present but could not be displayed correctly",
DOCEX_RIGHT_TO_LEFT_TABLES:"A table had right to left columns",DOCEX_ALIASED_FONT:"A required font was missing, but a font alias was used",DOCEX_MISSING_FONT:"A required font was not present on the system",DOCEX_SUBDOC_FAILED:"Part of the document could not be converted",DOCEX_TYPE_THREE_FONT:"An unsupported font was required by the document",DOCEX_UNSUPPORTED_SHADING:"The document used an unsupported shading type",DOCEX_INVALID_HTML:"Invalid HTML was encountered",DOCEX_VECTOR_OBJECT_LIMIT:"Not all of the vector objects could be displayed",
DOCEX_INVALID_ANNOTATIONS_NOT_APPLIED:"An invalid annotation could not be applied",DOCEX_INLINE_IMAGE_FOUND:"An embedded graphic could not be rendered",EMAIL_TO:"To",EMAIL_CC:"CC",EMAIL_BCC:"BCC",EMAIL_SUBJECT:"Subject",EMAIL_MSGFLAG:"Message Flag",EMAIL_FLAGSTS:"Flag Status",EMAIL_EXPIRES:"Expires",EMAIL_CATEGORIES:"Categories",EMAIL_IMPORTANCE:"Importance",EMAIL_SENSITIVITY:"Sensitivity",EMAIL_LOCATION:"Location",EMAIL_FULLNAME:"Full Name",EMAIL_JOBTITLE:"Job Title",EMAIL_COMPANY:"Company",EMAIL_EMAIL:"Email",
EMAIL_WEBPAGE:"Webpage",EMAIL_WORKPHONE:"Work Telephone",EMAIL_HOMEPHONE:"Telephone",EMAIL_FROM:"From",EMAIL_ATTACHMENT:"Attachments",EMAIL_RTFBODY:"RTF Embedded Body",EMAIL_RECEIVED:"Received",EMAIL_SIZE:"Size",EMAIL_LASTMODIFIED:"Last Modified",EMAIL_NEWSGROUPS:"Newsgroups",EMAIL_SUBMITTIME:"Submit Time",EMAIL_CCME:"CC Me",EMAIL_ALTERNATE_RECIPIENT_ALLOWED:"Alternate Recipient Allowed",EMAIL_CLIENT_SUBMIT_TIME:"Sent",EMAIL_CREATION_TIME:"Created",EMAIL_CONVERSATION_INDEX:"Conversation Index",EMAIL_CONVERSATION_TOPIC:"Topic",
EMAIL_MESSAGE_SUBMISSION_ID:"Message Submission ID",EMAIL_MESSAGE_CLASS:"Message Class",EMAIL_ORIGINATOR_DELIVERY_REPORT_REQUESTED:"Originator Delivery Report Requested",EMAIL_READ_RECEIPT_REQUESTED:"Read Receipt Requested",EMAIL_RCVD_REPRESENTING_ADDRTYPE:"Received Representing Address Type",EMAIL_RCVD_REPRESENTING_EMAIL_ADDRESS:"Received Representing Email",EMAIL_RCVD_REPRESENTING_ENTRYID:"Received Representing Entry ID",EMAIL_RCVD_REPRESENTING_NAME:"Received Representing Name",EMAIL_RCVD_REPRESENTING_SEARCH_KEY:"Received Representing Search Key",
EMAIL_RECEIVED_BY_ADDRTYPE:"Received By Address Type",EMAIL_RECEIVED_BY_EMAIL_ADDRESS:"Received By Email",EMAIL_RECEIVED_BY_ENTRYID:"Received By Entry ID",EMAIL_RECEIVED_BY_NAME:"Received By Name",EMAIL_RECEIVED_BY_SEARCH_KEY:"Received By Search Key",EMAIL_RTF_IN_SYNC:"RTF In Sync",EMAIL_RTF_SYNC_BODY_COUNT:"RTF Sync Body Count",EMAIL_RTF_SYNC_BODY_CRC:"RTF Sync Body CRC",EMAIL_RTF_SYNC_BODY_TAG:"RTF Sync Body Tag",EMAIL_RTF_SYNC_PREFIX_COUNT:"RTF Sync Prefix Count",EMAIL_RTF_SYNC_TRAILING_COUNT:"RTF Sync Trailing Count",
EMAIL_SEARCH_KEY:"Search Key",EMAIL_SENDER_ADDRTYPE:"Sender Address",EMAIL_SENDER_EMAIL_ADDRESS:"Sender Email",EMAIL_SENDER_ENTRYID:"Sender Entry ID",EMAIL_SENDER_NAME:"Sender Name",EMAIL_SENDER_SEARCH_KEY:"Sender Search Key",EMAIL_SENT_REPRESENTING_ADDRTYPE:"Sent Representing Addr Type",EMAIL_SENT_REPRESENTING_EMAIL_ADDRESS:"Sent Representing Email",EMAIL_SENT_REPRESENTING_ENTRYID:"Sent Representing Entry ID",EMAIL_SENT_REPRESENTING_SEARCH_KEY:"Sent Representing Search Key",EMAIL_TRANSPORT_MESSAGE_HEADERS:"Transport Message Headers",
EMAIL_PRIORITY:"Priority",EMAIL_AUTO_FORWARDED:"Auto Forwarded",EMAIL_DEFERRED_DELIVERY_TIME:"Deferred Delivery Type",EMAIL_EXPIRY_TIME:"Expiry Time",EMAIL_LATEST_DELIVERY_TIME:"Latest Delivery Time",EMAIL_RECIPIENT_REASSIGNMENT_PROHIBITED:"Recipient Reassignment Prohibited",EMAIL_REPLY_TIME:"Reply Time",EMAIL_REPORT_TAG:"Report Tag",EMAIL_RESPONSE_REQUESTED:"Response Requested",EMAIL_REPLY_REQUESTED:"Reply Requested",EMAIL_DELETE_AFTER_SUBMIT:"Delete After Submit",EMAIL_MESSAGE_LOCALE_ID:"Message Locale ID",
EMAIL_CREATOR_NAME:"Creator Name",EMAIL_CREATOR_ENTRYID:"Creator Entry ID",EMAIL_LAST_MODIFIER_NAME:"Last Modifier Name",EMAIL_LAST_MODIFIER_ENTRYID:"Last Modifier Entry ID",EMAIL_INTERNET_ARTICLE_NUMBER:"Internet Artical Number",EMAIL_NT_SECURITY_DESCRIPTOR:"NT Security Descriptor",EMAIL_TRUST_SENDER:"Trust Sender",EMAIL_INTERNET_MESSAGE_ID:"Internet Message ID",EMAIL_ATTR_HIDDEN:"Hidden",EMAIL_ATTR_SYSTEM:"System",EMAIL_ATTR_READONLY:"Read Only",EMAIL_INTERNET_CPID:"Internet CPID",EMAIL_MESSAGE_CODEPAGE:"Message Codepage",
EMAIL_SENDER_FLAGS:"Sender Flags",EMAIL_SENT_REPRESENTING_FLAGS:"Sent Representing Flags",EMAIL_RCVD_BY_FLAGS:"Recived By Flags",EMAIL_RCVD_REPRESENTING_FLAGS:"Received Representing Flags",EMAIL_INET_MAIL_OVERRIDE_FORMAT:"Internet Mail Override Format",EMAIL_MSG_EDITOR_FORMAT:"MSG Editor Format",EMAIL_PROFILE_CONNECT_FLAGS:"Profile Connect Flags",EMAIL_SENT_REPRESENTING_NAME:"Sent Representing Name",EMAIL_ENTRYID:"Entry ID",EMAIL_NORMALIZED_SUBJECT:"Normalized Subject",EMAIL_ATTENDEES:"Attendees",
EMAIL_REQATTENDEE:"Required Attendees",EMAIL_OPTATTENDEE:"Optional Attendees",EMAIL_FILEAS:"File as",EMAIL_DISPLAYAS:"Display As (E-mail)",EMAIL_TITLE:"Title",EMAIL_SUFFIX:"Suffix",EMAIL_NICKNAME:"Nickname",EMAIL_PROFESSION:"Profession",EMAIL_DEPARTMENT:"Department",EMAIL_OFFICE:"Office",EMAIL_ANNIVERSARY:"Anniversary",EMAIL_BIRTHDATE:"Birth date",EMAIL_ASSISTANTSNAME:"Assistant's Name",EMAIL_SPOUSESNAME:"Spouse's Name",EMAIL_MANAGERSNAME:"Manager's Name",EMAIL_BUSINESSADDRESS:"Business Address",
EMAIL_BUSINESSPHONE:"Telephone",EMAIL_HOMEADDRESS:"Home Address",EMAIL_OTHERADDRESS:"Other Address",EMAIL_MOBILEPHONE:"Mobile",EMAIL_BUSINESSFAX:"Fax",EMAIL_IMADDRESS:"IM",EMAIL_INTERNETFREEBUSYADDR:"Internet Free Busy Address",EMAIL_REMINDERTOPIC:"Reminder Topic",EMAIL_CONTACTS:"Contacts",EMAIL_CALLBACKPHONE:"Callback Telephone",EMAIL_FIRST:"First",EMAIL_FAMILY:"Last",EMAIL_TELENUMBER:"Telephone",EMAIL_BUSINESSPHONE2:"Telephone 2",EMAIL_RADIOPHONE:"Radio Telephone",EMAIL_CARPHONE:"Car Telephone",
EMAIL_OTHERPHONE:"Telephone",EMAIL_PAGERPHONE:"Pager",EMAIL_OTHERFAX:"Fax",EMAIL_HOMEFAX:"Fax",EMAIL_TELEXPHONE:"Telex Telephone",EMAIL_ISDN:"ISDN Telephone",EMAIL_ASSISTANTPHONE:"Assistant Telephone",EMAIL_HOMEPHONE2:"Telephone 2",EMAIL_MIDDLE:"Middle",EMAIL_TTYTTDPHONE:"TTY/TTD Telephone",EMAIL_GENDER:"Gender",EMAIL_PERSONALHOMEPAGE:"Personal Home Page",EMAIL_COMPANYPHONE:"Company Telephone",EMAIL_HOMECITY:"City",EMAIL_HOMECOUNTRY:"Country",EMAIL_POSTALCODE:"Postal Code",EMAIL_HOMESTATE:"State",
EMAIL_HOMESTREET:"Street",EMAIL_HOMEPOBOX:"PO Box",EMAIL_OTHERCITY:"City",EMAIL_OTHERCOUNTRY:"Country",EMAIL_OTHERPOSTALCODE:"Postal Code",EMAIL_OTHERSTATE:"State",EMAIL_OTHERSTREET:"Street",EMAIL_OTHERPOBOX:"PO Box",EMAIL_BUSINESSSTREET:"Street",EMAIL_BUSINESSCITY:"City",EMAIL_BUSINESSSTATE:"State",EMAIL_BUSINESSPOSTALCODE:"Postal Code",EMAIL_BUSINESSCOUNTRY:"Country",EMAIL_BUSINESSPOBOX:"PO Box",EMAIL_DISPLAYAS2:"Display As (E-mail 2)",EMAIL_EMAIL2:"Email 2",EMAIL_DISPLAYAS3:"Display As (E-mail 3)",
EMAIL_EMAIL3:"Email 3",EMAIL_DTSTART:"Start Time",EMAIL_DTEND:"End Time",EMAIL_START:"Start",EMAIL_DURATION:"Duration",EMAIL_ACCUREATTYPE1:"Accurate Type 1",EMAIL_ENTRY_TYPE:"Entry Type",EMAIL_STATUS:"Status",EMAIL_PERCENT_COMPLETE:"Percent Complete",EMAIL_START_DATE:"Start Date",EMAIL_DUE_DATE:"Due Date",EMAIL_COMPLETED:"Completed",EMAIL_ACTUALWORK:"Actual Work",EMAIL_TOTAL_WORK:"Total Work",EMAIL_OWNER:"Owner",EMAIL_BILLING:"Billing",EMAIL_MILEAGE:"Mileage",EMAIL_PROOF_OF_DELIVERY_REQUESTED:"Proof of Delivery Requested",
EMAIL_PROOF_OF_SUBMISSION_REQUESTED:"Proof of Submission Requested",EMAIL_IN_REPLY_TO_ID:"In Reply To ID",EMAIL_TASK_COMPLETE:"Task Complete",EMAIL_APPOINTMENT_DURATION:"Appointment Duration",EMAIL_RECURRENCE_TYPE:"Recurrence Type",EMAIL_RECURRENCE_RANGE:"Recurrence Range",EMAIL_ORGANIZER:"Organizer",EMAIL_CALENDAR_EXCEPTION:"Calendar Exceptions",EMAIL_RSVP:"RSVP",EMAIL_ROLE:"Role",EMAIL_ATTENDEE:"Attendee",EMAIL_ADDRESS:"Address",EMAIL_POBOX:"PO Box",EMAIL_EXTADDRESS:"Ext Address",EMAIL_STREET:"Street",
EMAIL_CITY:"City",EMAIL_REGION:"Region",EMAIL_COUNTRY:"Country",EMAIL_TYPE:"Type",EMAIL_NAME:"Name",EMAIL_LOGO:"Logo",EMAIL_PHOTO:"Photo",EMAIL_ALARM:"Alarm",EMAIL_DESCRIPTION:"Description",EMAIL_DATE:"Date",MULTIMEDIA_AUDIO:"audio",MULTIMEDIA_AUDIO_IND:"an audio",MULTIMEDIA_VIDEO:"video",MULTIMEDIA_VIDEO_IND:"a video",MULTIMEDIA:"multimedia",MULTIMEDIA_IND:"a multimedia",MULTIMEDIA_UNSUPPORTED_FORMAT:"Sorry, your browser does not support playing this multimedia format.",MULTIMEDIA_INTERNAL_ERROR:"Sorry, Relativity encountered an error while attempting to play this multimedia file.<br/>Please contact your administrator.",
MULTIMEDIA_PLAYBACK_WARNING_TITLE:"Video playback issues",MULTIMEDIA_PLAYBACK_WARNING_MESSAGE:"Sorry, we're experiencing playback issues with this multimedia file. <ul><li>Ensure that you are connected to Relativity.</li><li>Your browser may not fully support this multimedia format.</li><li>The native file may be partially corrupted.</li></ul>",MULTIMEDIA_MISSING_STREAM_TITLE_FMT:"Unable to play {STREAM_TYPE} stream",MULTIMEDIA_MISSING_STREAM_MESSAGE_FMT:"Unable to play {STREAM_TYPE} stream <ul><li>Your browser may not support the {STREAM_TYPE} codec.</li><li>The native file may not have {STREAM_TYPE_IND} stream.</li><li>The native file may be partially corrupted.</li></ul>"});
M=OIT.local;var Ma,lb,oc=598,Yb=599;(function(){var d=[],e=Date.now(),b=function(a){return fb(d,"request",a)},a=function(a){var c=b(this);if(!c)throw"request.start(): Invalid request object";if(!c.aborted){if(void 0!==this.status)throw"request.start(): Request is already completed";if("number"!==typeof a||0>a)throw"request.start(): fileSize must be a non-negative integer indicating the total size of the requested file in bytes";if(void 0!==c.contentLength)throw"request.start(): start should only be called once per request";
c.contentLength=a;p(c,"")}},c=function(a){var c=b(this);if(!c)throw"request.loading(): Invalid request object";if(!c.aborted){if(void 0!==this.status)throw"request.loading(): Request is already completed";if("string"!==typeof a)throw"request.loading(): responseText must be a string containing the partial or complete contents of the requested file";if(void 0!==this.contentLength&&a.length>this.contentLength)throw"request.loading(): responseText length must not exceed the size specified to request.start";
c.responseText=a;void 0!==c.contentLength&&p(c,a)}},f=function(a){var c=b(this);if(!c)throw"request.done(): Invalid request object";if(!c.aborted){if("number"!==typeof a||0>=a)throw"request.done(): status must be a positive integer HTTP status code";if(0===a)c.timeout=!0;else if(200===a){if(void 0===c.responseText)throw"request.done(): request.loading() was never called";if(void 0!==c.contentLength&&c.responseText.length!==c.contentLength)throw"request.done(): responseText length must be equal to the contentLength passed in to request.start()";
}Object.defineProperty(this,"status",{value:a});c.contentLength=c.responseText.length;Object.defineProperty(this,"responseText",{value:c.responseText});Sa(d,c);v(c)}},h=function(){var a=b(this);if(!a)throw"request.abort(): Invalid request object";a.aborted=!0;v(a)},q=function(b,e){var m={};Object.defineProperties(m,{url:{value:b},start:{value:a},loading:{value:c},done:{value:f},abort:{value:h}});e.request=m;e.isLocal=!0;d.push(e);return m},t=function(a){a.inDispatch=!0;F.on.ajax.dispatch(a.request);
a.inDispatch=!1},u=function(a,c){var b=a[c];if(b){var d=Array.prototype.slice.call(arguments,2);a.args&&(d=d.concat(a.args));b.apply(a.context,d)}},v=function(a){var c="unknown"!=typeof a.request.responseText?a.request.responseText:void 0,b=a.request.status;0===b||a.aborted?(b=oc,a.aborted=!0,F.on.ajax.hasListeners()&&F.on.ajaxabort.hasListeners()&&F.on.ajaxabort.dispatch(this)):a.timeout&&(b=Yb);a.contentLength=c.length;200===b?u(a,"success",a.url,a.contentLength,c,b):u(a,"error",a.url,a.contentLength,
c,b);u(a,"complete",a.url,a.contentLength,c,b)},p=function(a,c){u(a,"loading",a.url,a.contentLength,c,a.request.status)};Ma=function(a){var c=a.url,b;if("string"===typeof c&&0<c.length){var f={context:null},m;for(m in a)f[m]=a[m];if(F.on.ajax.hasListeners())q(c,f),ca(t,0,null,f),b=f;else if(R.XMLHttpRequest){f.request=new XMLHttpRequest;!1===a.cache&&(c=-1!=c.indexOf("?")?c+"&":c+"?",++e,c+="_="+e);f.request.onreadystatechange=function(){if(!f.aborted)switch(f.request.readyState){case 2:f.contentLength=
Number(f.request.getResponseHeader("Content-Length"));p(f,"");break;case 3:p(f,"unknown"!=typeof f.request.responseText?f.request.responseText:void 0);break;case 4:v(f),Sa(d,f)}};f.request.ontimeout=function(){f.timeout=!0;v(f)};w.withCredentials&&(f.request.withCredentials=!0);f.request.open("GET",c,!0);if(a=w.httpHeaders)for(var l in a)a.hasOwnProperty(l)&&f.request.setRequestHeader(l,a[l]);f.request.send();d.push(f);b=f}}return b};var l=function(a){a.aborted=!0;a.request&&a.request.abort()};lb=
function(a){a?(Sa(d,a),l(a)):(Y(d,l),d=[])}})();var L=function(d,e){return e&&1<e?Math.round(d*e)/e:Math.floor(0>d?d-.5:d+.5)},fa=function(d,e,b){d<e?d=e:d>b&&(d=b);return d},Zb=function(d,e,b,a){if(d==b&&e==a)return 0;d=b-d;e=a-e;return L(Math.sqrt(d*d+e*e))},$b=function(d,e){if("deg"===e)d%=360,0>d&&(d+=360);else{var b=Math.PI,a=2*b;d%=a;d<-b?d+=a:d>b&&(d-=a)}return d},ec=function(d,e,b){void 0===b&&(b=1.01);return(d>e?Math.abs(d/e):Math.abs(e/d))<=b},fc,sb,Ua,ca,sa,cb,ac;(function(){for(var d=
[],e=[],b=[],a=R.requestAnimationFrame,c=R.cancelAnimationFrame,f=0,h=["ms","moz","webkit","o"],q=0;q<h.length&&!a;++q)a=R[h[q]+"RequestAnimationFrame"],c=R[h[q]+"CancelAnimationFrame"]||R[h[q]+"CancelRequestAnimationFrame"];a||(a=function(a){var c=(new Date).getTime(),b=Math.max(0,16-(c-f)),d=R.setTimeout(function(){a(c+b)},b);f=c+b;return d});c||(c=function(a){R.clearTimeout(a)});fc=function(){var a;for(a=0;a<d.length;a++)R.clearInterval(d[a].id);d=[];for(a=0;a<e.length;a++)R.clearTimeout(e[a].id);
e=[];for(a=0;a<b.length;a++)c.call(R,b[a].id);b=[]};var t=function(a,c,b,d){var e=0;d={fn:a[e++],remove:!!d};c&&(d.timeout=a[e++]);d.context=a[e++];b&&(d.args=[0],d.ts=!0);a.length>e&&(a=Array.prototype.slice.call(a,e),d.args=d.args?d.args.concat(a):a);return d},u=function(a,c,b){try{a.remove&&Sa(c,a),a.ts&&(a.args[0]=b),a.fn.apply(a.context,a.args)}catch(m){R.OILogDebugError&&R.OILogDebugError("Error in asynchronous timer function: "+m.message)}};sb=function(a,c,b){var e=t(arguments,!0,!1,!1);d.push(e);
e.id=R.setInterval(function(){u(e,d)},e.timeout);return e.id};Ua=function(a){R.clearInterval(a);Jb(d,"id",a)};ca=function(a,c,b){var d=t(arguments,!0,!1,!0);e.push(d);d.id=R.setTimeout(function(){u(d,e)},c);return d.id};sa=function(a){R.clearTimeout(a);Jb(e,"id",a)};cb=function(c,d){for(var e,f=0;f<b.length;f++)if(e=b[f],e.fn===c&&e.context===d)return e.id;e=t(arguments,!1,!0,!0);b.push(e);e.id=a.call(R,function(a){u(e,b,a)});return e.id};ac=function(a){c.call(R,a);Jb(b,"id",a)};Pa.install.listen(function(){F.onreset(function(){fc();
d=[];e=[];b=[]})})})();var Ta,jb,zb,Va,Ya,Ga,Ia,Ka,vc,Qa,Wa,Y,Ab,wc,ab,xc,yc,Sa,Jb,fb,gc,wb,Kb,zc,Ac,Bb,Bc,gb,Cc,Dc,hc,sc,tc;(function(){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,b=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/,
a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,c=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
f=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,h=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t=Math.pow(2,53),u="oit-emhdrvalue oit-emhdrlabel oit-emhdrsection oit-email oit-rt oit-sn oit-comment-text oit-comment-date oit-comment-author oit-anno-text oit-anno-date oit-anno-author oit-overlay".split(" ");Ta=function(a){for(a=y.unwrap(a);a&&!y.isElement(a);)a=a.parentNode;var c;a&&(a=y.wrap(a),c=a.hasClass(u)?a:a.ancestorByClass(u));return c?c:null};jb=function(a){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()};
zb=function(a,c,b){var d=a.indexOf(":");if(0<d){var e=zb(a.slice(0,d),c,b);a=zb(a.slice(d+1),c,b);e.c2=a.c1;e.r2=a.r1;return e}var e=!1,d=0,f=!1,m=0,l=0,r=a.length,g=a.charCodeAt(l);l<r&&36==g&&(e=!0,l++,g=a.charCodeAt(l));for(!1===(l<r&&65<=g&&90>=g)&&(f=e);l<r&&65<=g&&90>=g;)d=26*d+(g-65+1),l++,g=a.charCodeAt(l);l<r&&36==g&&(f=!0,l++,g=a.charCodeAt(l));for(;l<r&&48<=g&&57>=g;)m=10*m+(g-48),l++,g=a.charCodeAt(l);0<d&&d--;0<m&&m--;!e&&c&&(d+=c);!f&&b&&(m+=b);return ta(d,m,d,m)};Va=function(a){if("number"==
typeof a&&!(0>a)){if(26>a)return d[a];var c=a%26,b=(a-c)/26-1;if(702>a)return d[b]+d[c];a=Math.floor(b);b=a%26;return d[(a-b)/26-1]+d[b]+d[c]}};Ya=function(a){if("number"==typeof a&&!(0>a))return(a+1).toString()};Ga=function(a){return"[object Function]"==Object.prototype.toString.call(a)};Ia=function(a){return a&&void 0!==a.startContainer&&void 0!==a.startOffset&&void 0!==a.endContainer&&void 0!==a.endOffset?!0:!1};Ka=function(a){return a&&void 0!==a.anchorNode&&void 0!==a.anchorOffset&&void 0!==
a.focusNode&&void 0!==a.focusOffset?!0:!1};vc=function(a){return!/^(?:[a-z]+:)?\/\//i.test(a)};Qa=function(a,c){return a&&0!==a.length?c&&0!==c.length?"/"==a.charAt(a.length-1)?"/"==c.charAt(0)?a+c.substr(1):a+c:"/"==c.charAt(0)?a+c:a+"/"+c:a:c};Wa=function(a){var c;if(Array.isArray(a)){c=[];for(var b=0;b<a.length;b++)c[b]=Wa(a[b])}else{if(Ga(a))return null;if(null===a)c=null;else switch(typeof a){case "object":c={};for(b in a)a.hasOwnProperty(b)&&!Ga(a[b])&&(c[b]=Wa(a[b]));break;case "string":c=
new String(a);break;case "number":case "boolean":case "undefined":c=a}}return c};Y=function(a,c,b){v(!1,!1,null,arguments)};Ab=function(a,c){v(!1,!1,a,c)};wc=function(a,c,b){v(!1,!0,null,arguments)};ab=function(a,c,b){v(!0,!1,null,arguments)};xc=function(a,c){v(!0,!1,a,c)};var v=function(a,c,b,d){var e=0;b||(b=d[e++]);if(b&&(a||0<b.length)){var f,m=d[e++],h=d[e++],r="string"==typeof m;r||e--;d=d.length>e?Array.prototype.slice.call(d,e):void 0;r?e=l:(e=p,d||(d=[null]));if(a)for(f in b)b.hasOwnProperty(f)&&
e(b[f],m,h,d);else if(c?(f=b.length-1,c=a=-1):(f=0,a=b.length,c=1),b.item)for(;f!=a;f+=c)e(b.item(f),m,h,d);else for(;f!=a;f+=c)e(b[f],m,h,d)}},p=function(a,c,b,d){null===a||void 0===a||null!==b&&void 0!==b&&!a.filter(b)||(d[0]=a,c.apply(null,d))},l=function(a,c,b,d){a&&(null===b||void 0===b||a.filter(b))&&a[c].apply(a,d)};yc=function(a,c,b){if(a===c)return!0;if(null===a||void 0===a)return null===c||void 0===c;if(null===c||void 0===c||"[object Array]"!==Object.prototype.toString.call(a)||"[object Array]"!==
Object.prototype.toString.call(c)||a.length!=c.length)return!1;for(var d=0;d<a.length;d++)if(a[d]!==c[d])if(!0===b){if(JSON.stringify(a[d])!==JSON.stringify(c[d]))return!1}else return!1;return!0};Sa=function(a,c){var b=a.indexOf(c);-1!=b&&a.splice(b,1)};Jb=function(a,c,b){c=gc(a,c,b);-1!=c&&a.splice(c,1)};fb=function(a,c,b){c=gc(a,c,b);if(-1!=c)return a[c]};gc=function(a,c,b){if(Array.isArray(a)&&"string"===typeof c)for(var d=0;d<a.length;d++){var e=a[d];if(e&&e[c]===b)return d}return-1};wb=function(a){return Ia(a)?
"[DOM Range]":Ka(a)?"[DOM Selection]":y.isElement(a)?y.unwrap(a).outerHTML:y.isText(a)?'"'+a.textContent+'"':JSON.stringify(a)};Kb=function(a){a&&(a=a.replace(/[&<>"']/g,function(a){return q[a]}));return a};var m;a:{try{(new Date).toLocaleDateString("i")}catch(H){m="RangeError"===H.name;break a}m=!1}zc=function(a){if(m&&(a.match(e)||a.match(b)))try{a=(new Date(a)).toLocaleDateString()}catch(I){}return a};Ac=function(a){if(m&&(a.match(e)||a.match(b)))try{a=(new Date(a)).toLocaleTimeString()}catch(I){}return a};
Bb=function(a){if(m&&(a.match(e)||a.match(b)))try{a=(new Date(a)).toLocaleString()}catch(I){}return a};Bc=function(a){1073741824<a?(a=Math.floor(a/1073741824*10)/10,a=""+a+" GB"):1048576<a?(a=Math.floor(a/1048576*10)/10,a=""+a+" MB"):1024<a?(a=Math.floor(a/1024*10)/10,a=""+a+" KB"):a=""+Math.floor(a)+" B";return a};gb=function(){if(w.isMobileOrTablet){var a=z.activePage();if(a){var c=y.create("div");a.append(c);ca(function(){c.destroy()},10)}}};Cc=function(a){for(var c=a.css("width"),b=1,d=t;b<d;){var e=
Math.ceil((b+d)/2);a.css("width",e+"px");a.clientWidth!=e?d=e-1:b=e}a.css("width",c);return b};Dc=function(a){for(var c=a.css("height"),b=1,d=t;b<d;){var e=Math.ceil((b+d)/2);a.css("height",e+"px");a.clientHeight!=e?d=e-1:b=e}a.css("height",c);return b};hc=function(a){var c=!1;switch(a){case "firefox":c=-1!=navigator.userAgent.toLowerCase().indexOf("firefox");break;case "ie11":c=!!R.MSInputMethodContext&&!!V.documentMode}return c};sc=function(){var b=!1,d=navigator.userAgent||navigator.vendor||R.opera;
if(a.test(d)||c.test(d.substr(0,4)))b=!0;return b};tc=function(){var a=!1,c=navigator.userAgent||navigator.vendor||R.opera;if(f.test(c)||h.test(c.substr(0,4)))a=!0;return a}})();var Zc=function(){function d(){}function e(){console.log(Array.prototype.slice.call(arguments).join(" "))}var b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",
iviti:"ive",biliti:"ble",logi:"log"},a={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};return function(c,f){var h,q,t,u,v,p;p=f?e:d;if(3>c.length)return c;t=c.substr(0,1);"y"==t&&(c=t.toUpperCase()+c.substr(1));u=/^(.+?)(ss|i)es$/;q=/^(.+?)([^s])s$/;u.test(c)?(c=c.replace(u,"$1$2"),p("1a",u,c)):q.test(c)&&(c=c.replace(q,"$1$2"),p("1a",q,c));u=/^(.+?)eed$/;q=/^(.+?)(ed|ing)$/;u.test(c)?(q=u.exec(c),u=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,u.test(q[1])&&(u=/.$/,
c=c.replace(u,""),p("1b",u,c))):q.test(c)&&(q=q.exec(c),h=q[1],q=/^([^aeiou][^aeiouy]*)?[aeiouy]/,q.test(h)&&(c=h,p("1b",q,c),q=/(at|bl|iz)$/,v=/([^aeiouylsz])\1$/,h=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,q.test(c)?(c+="e",p("1b",q,c)):v.test(c)?(u=/.$/,c=c.replace(u,""),p("1b",v,c)):h.test(c)&&(c+="e",p("1b",h,c))));u=/^(.*[aeiouy].*)y$/;u.test(c)&&(q=u.exec(c),h=q[1],c=h+"i",p("1c",u,c));u=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;
u.test(c)&&(q=u.exec(c),h=q[1],q=q[2],u=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,u.test(h)&&(c=h+b[q],p("2",u,c)));u=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;u.test(c)&&(q=u.exec(c),h=q[1],q=q[2],u=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,u.test(h)&&(c=h+a[q],p("3",u,c)));u=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;q=/^(.+?)(s|t)(ion)$/;u.test(c)?(q=u.exec(c),h=q[1],u=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
u.test(h)&&(c=h,p("4",u,c))):q.test(c)&&(q=q.exec(c),h=q[1]+q[2],q=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,q.test(h)&&(c=h,p("4",q,c)));u=/^(.+?)e$/;u.test(c)&&(q=u.exec(c),h=q[1],u=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,q=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,v=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,u.test(h)||q.test(h)&&!v.test(h))&&(c=h,p("5",u,
q,v,c));u=/ll$/;q=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;u.test(c)&&q.test(c)&&(u=/.$/,c=c.replace(u,""),p("5",u,q,c));"y"==t&&(c=t.toLowerCase()+c.substr(1));return c}}(),Ec={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u1ea4":"A","\u1eae":"A","\u1eb2":"A","\u1eb4":"A","\u1eb6":"A","\u1ea6":"A","\u1eb0":"A","\u0202":"A","\u00c7":"C","\u1e08":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u1ebe":"E",
"\u1e16":"E","\u1ec0":"E","\u1e14":"E","\u1e1c":"E","\u0206":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u1e2e":"I","\u020a":"I","\u00d0":"D","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u1ed0":"O","\u1e4c":"O","\u1e52":"O","\u020e":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u1ea5":"a","\u1eaf":"a","\u1eb3":"a","\u1eb5":"a","\u1eb7":"a",
"\u1ea7":"a","\u1eb1":"a","\u0203":"a","\u00e7":"c","\u1e09":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u1ebf":"e","\u1e17":"e","\u1ec1":"e","\u1e15":"e","\u1e1d":"e","\u0207":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u1e2f":"i","\u020b":"i","\u00f0":"d","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u1ed1":"o","\u1e4d":"o","\u1e53":"o","\u020f":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00ff":"y",
"\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C","\u0109":"c","\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0110":"D","\u0111":"d","\u0112":"E","\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u01f4":"G","\u011d":"g","\u01f5":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H",
"\u0125":"h","\u0126":"H","\u0127":"h","\u1e2a":"H","\u1e2b":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i","\u012c":"I","\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u1e30":"K","\u1e31":"k","\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u013f":"L","\u0140":"l","\u0141":"l","\u0142":"l","\u1e3e":"M","\u1e3f":"m","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n",
"\u0149":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0154":"R","\u0155":"r","\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","\u0212":"R","\u0213":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s","\u015e":"S","\u0218":"S","\u0219":"s","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u021b":"t","\u021a":"T","\u0164":"T","\u0165":"t","\u0166":"T","\u0167":"t","\u0168":"U","\u0169":"u","\u016a":"U","\u016b":"u","\u016c":"U","\u016d":"u",
"\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0216":"U","\u0217":"u","\u0174":"W","\u0175":"w","\u1e82":"W","\u1e83":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u017f":"s","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U","\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u",
"\u01d9":"U","\u01da":"u","\u01db":"U","\u01dc":"u","\u1ee8":"U","\u1ee9":"u","\u1e78":"U","\u1e79":"u","\u01fa":"A","\u01fb":"a","\u01fe":"O","\u01ff":"o","\u1e54":"P","\u1e55":"p","\u1e64":"S","\u1e65":"s","\u0403":"\u0413","\u0453":"\u0433","\u040c":"\u041a","\u045c":"\u043a","\u1ed2":"O","\u1ed3":"o","\u1e50":"O","\u1e51":"o","\u1eea":"U","\u1eeb":"u","\u1e80":"W","\u1e81":"w","\u1ef2":"Y","\u1ef3":"y","\u0200":"A","\u0201":"a","\u0204":"E","\u0205":"e","\u0208":"I","\u0209":"i","\u020c":"O",
"\u020d":"o","\u0210":"R","\u0211":"r","\u0214":"U","\u0215":"u","\u01e6":"G","\u01e7":"g","\u021e":"H","\u021f":"h","\u01e8":"K","\u01e9":"k","\u1e66":"S","\u1e67":"s","\u1e10":"D","\u1e11":"d","\u0228":"E","\u0229":"e","\u1e28":"H","\u1e29":"h"},$c=Object.keys(Ec).join("|"),ad=new RegExp($c,"g"),ic=function(d){return d.replace(ad,function(d){return Ec[d]})},Fc=function(){var d=[{rule:/(\S{3})(\S*)(ies)$/,replace:"y"},{rule:/(\S{3})(\S*)(ing)$/,replace:""},{rule:/(\S{4})(\S*)(ness)$/,replace:""},
{rule:/(\S{0})(\S*)(ss)$/,replace:"ss"},{rule:/(\S{3})(\S*)(s)$/,replace:""},{rule:/(\S{4})(\S*)(ion)$/,replace:""},{rule:/(\S{4})(\S*)(ism)$/,replace:""},{rule:/(\S{4})(\S*)(ly)$/,replace:""},{rule:/(\S{3})(\S*)(eed)$/,replace:"ee"},{rule:/(\S{4})(\S*)(ied)$/,replace:"y"},{rule:/(\S{4})(\S*)(ed)$/,replace:""},{rule:/(\S{3})(\S*)(ed)$/,replace:"e"},{rule:/(\S{4})(\S*)(er)$/,replace:""},{rule:/(\S{4})(\S*)(ful)$/,replace:""},{rule:/(\S{4})(\S*)(able)$/,replace:""},{rule:/(\S{4})(\S*)(ible)$/,replace:""},
{rule:/(\S{3})(\S*)(v)$/,replace:"f"},{rule:/(\S{4})(\S*)(e)$/,replace:""},{rule:/(\S{3})(\S*)(dd)$/,replace:"d"},{rule:/(\S{3})(\S*)(gg)$/,replace:"g"},{rule:/(\S{3})(\S*)(ll)$/,replace:"l"},{rule:/(\S{3})(\S*)(mm)$/,replace:"m"},{rule:/(\S{3})(\S*)(nn)$/,replace:"n"},{rule:/(\S{3})(\S*)(pp)$/,replace:"p"},{rule:/(\S{3})(\S*)(rr)$/,replace:"r"},{rule:/(\S{3})(\S*)(ss)$/,replace:"s"},{rule:/(\S{3})(\S*)(tt)$/,replace:"t"}];return function(e,b){for(var a=0,c=e;a<d.length;){var f=d[a].rule.exec(c);
if(f)if(rStem=f[1]+f[2]+d[a].replace,rStem===c)break;else a=0,c=rStem;else a++}return c}}(),Gc=xa.extend("fonts",{events:{fontload:{}},install:function(d){var e=["serif","sans-serif","monospace","cursive","fantasy"],b={},a=0,c;d.loadWebFont=function(d){var e=b[d];if(void 0===e){var h=w.rootNode;if(h){e=y.create("div","oit-fontpreloader");e.css("font-family",d);var u=y.create("span");e.append(u);u.html("AEIMNOTaeimnot130");h.append(e);b[d]=e}a=0;c||(c=ca(f,250))}};var f=function(){var h=!1,q=!1,t,
u;c=void 0;for(t in b)if((u=b[t])&&!0!==u){for(var v=!0,p,l=0;l<e.length;l++){u.css("font-family",t+","+e[l]);var m=u.offsetWidth;if(0<l&&m!=p){v=!1;break}p=m}v?(u.destroy(),q=b[t]=!0):(u.css("font-family",t),h=!0)}if(h)if(a++,20>a)c=ca(f,250);else for(t in b)(u=b[t])&&!0!==u&&(u.destroy(),b[t]=!1);q?d.on.fontload.dispatch():0===a%2&&d.on.fontload.dispatch()};F.onreset(function(){for(var d in b){var e=b[d];e&&!0!==e&&e.destroy()}b=[];a=0;c=void 0})}}),ha=xa.extend("view",{exports:"attach detach fitToContainer height info stage load unload width hasFeature".split(" "),
events:{resize:{delay:80},detach:{},update:{}},install:function(d){var e,b=0,a,c,f,h,q={},t,u=0,v=0,p,l,m,H,I,Q,J;d.hasFeature=function(a){var c=!1;switch(a){case "string":case "dtsearch":case "lucene":case "phsterms":case "literal":case "literal*":case "enhancedhighlight":c=!0}return c};var N=function(){t&&(t.hide(),t=null)};d.dispatchResize=function(){var b=w.viewNode;b&&(f&&D(),a!=b.clientWidth||c!=b.clientHeight)&&(a=b.clientWidth,c=b.clientHeight,d.on.resize.dispatch())};var D=function(){if(f){var a=
f.computedStyle(),c=f.offsetWidth-parseInt(a.borderLeftWidth,10)-parseInt(a.borderRightWidth,10),a=f.offsetHeight-parseInt(a.borderTopWidth,10)-parseInt(a.borderBottomWidth,10);w.rootNode.css({width:c+"px",height:a+"px"})}};d.dispatchScroll=function(a){var c=w.viewNode;if(c&&(d.invalidateCanvas(),F.on.scrollupdate.dispatch(),c=c.scroll(),a||c.left!=v||c.top!=u)){a=c.left-v;var b=c.top-u;v=c.left;u=c.top;F.on.scroll.dispatch(a,c.left,b,c.top)}};var O=function(){},B=function(){},r=function(){x.nochrome?
w.viewNode.addClass("oit-nochrome"):w.viewNode.removeClass("oit-nochrome")},g=function(){var a=w.rootNode;a&&(a.addClass("oit-view-root"),a=w.viewNode,a||(a=y.attach(y.create("div","oit-view")),w.viewNode=a),e="oitview"+b++,a.id=e,r(),a.attr("tabindex","-1"),a.onscroll(d.dispatchScroll),d.fitToContainer());R.matchMedia&&(a=R.matchMedia("print"))&&a.addListener(function(a){});R.addEventListener("beforeprint",O);R.addEventListener("afterprint",B);R.addEventListener("resize",d.dispatchResize)};Pa.init.listen(function(){var a=
w.rootNode;if(a){var c=a.data("json"),b=a.data("icd"),d=a.data("page");if(c||b)h=a.parent();g();ga.initializeContent(c,b,d);F.initializeDocument()}});d.attach=function(a){a&&a!==y.unwrap(f)&&(d.detach(),f=y.wrap(a),a=w.rootNode,a||(a=w.rootNode=y.attach(y.create("div"))),a.addClass("oit-view-embedded"),f.append(a),g())};d.detach=function(){F.unload();w.viewNode&&(w.viewNode.offscroll(d.dispatchScroll),w.viewNode.removeData("_events"),y.detach(w.viewNode));w.rootNode&&y.detach(w.rootNode);y.reset();
d.on.detach.dispatch();var a=w.viewNode;if(a)try{a.destroy()}catch(A){}if(a=w.rootNode)try{a.destroy()}catch(A){}R.removeEventListener("beforeprint",O);R.removeEventListener("afterprint",B);R.removeEventListener("resize",d.dispatchResize);w.rootNode=w.viewNode=null;e=f=h=void 0};d.stage=function(a){w.staging=!0;d.load(a)};var k=function(a){d.logAJAXError("load","Timed out waiting for document to load",a)};d.load=function(a,c){f||h?void 0===a?w.staging&&(w.staging=!1,F.showNotifications()):(d.unload(),
w.dynamicContent=!0,w.documentLoading=!0,c&&(c.headers&&(w.httpHeaders=c.headers),c.withCredentials&&(w.withCredentials=!0)),l&&sa(l),l=ca(k,3E4,null,a),Ma({url:a,loading:C,success:K,error:ba}),t=ya.createProgressDialog(M.PLEASE_WAIT)):d.logError("load","Call OIT.view.attach before OIT.view.load")};var C=function(a,c,b){l&&sa(l);l=ca(k,3E4,null,a);a=b?b.length:0;t&&t.update(80*a/c)},K=function(a,c,b,e){c=!0;l&&(sa(l),l=void 0);try{0===b.length?(d.logAJAXError("load","The document is empty or is still being exported",
a,e,b),c=!1):c=F.installDocument(a,b)}catch(E){d.logAJAXError("load","The document could not be installed ("+E.message+")",a,e,b),c=!1}c||N()},ba=function(a,c,b,e){l&&(sa(l),l=void 0);d.logAJAXError("load","Failed to load the document index file from the server",a,e,b);N()};d.unload=function(){F.unload();w.httpHeaders=null;w.withCredentials=!1;y.reset()};d.fitToContainer=function(){f&&(D(),d.dispatchResize())};d.width=function(a){a=yb(a);null!==a&&(f&&f.css("width",a),w.rootNode.css("width",a),d.dispatchResize());
return w.rootNode.offsetWidth};d.height=function(a){a=yb(a);null!==a&&(f&&f.css("height",a),w.rootNode.css("height",a),d.dispatchResize());return w.rootNode.offsetHeight};d.info=function(){var a=Wa(q);a.libversion=w.libversion?Wa(w.libversion):"Unknown";var c=ga.manifest();c&&(a.manifest=Wa(c));return a};d.infoRaw=function(){return q};d.showDocumentError=function(a){p||(p=new Nb({title:M.DOCUMENT_ERRORS,closeButton:!0,className:"oit-toast-error"}));p.message(a);p.expand(!1)};var ia=function(){var a=
w.rootNode,c=a.clientWidth,b=a.clientHeight,e;m=void 0;Q&&(H!=c||I!=b?(Q.destroy(),Q=null):(e=Q.getContext("2d"),e.clearRect(0,0,c,b)));Q||(J||(J=y.create("div","oit-viewcanvas"),a.insertFirst(J)),H=c,I=b,Q=J.createCanvas());e||(e=Q.getContext("2d"));d.on.update.dispatch(e)};d.invalidateCanvas=function(){!m&&d.on.update.hasListeners()&&(m=cb(ia,this))};w.onviewNode(function(a,c){c&&c.destroy();if(a){for(var b=w.rootNode,d=b.childByClass("oit-toolframe");d;){d=d.childByClass("oit-toolcontent");if(!d)break;
b=d;d=b.childByClass("oit-toolframe")}b&&b.append(a)}});F.onreset(function(){N();p&&(p.destroy(),p=null);Q&&(Q.destroy(),Q=null);J&&(J.destroy(),J=null);m&&(ac(m),m=void 0);I=H=-1;c=a=void 0;q={};v=u=0});ga.ondata(function(a,c,b){if(a.info){q||(q={});for(var d in a.info)q[d]=a.info[d];q.fi||(q.fi=1999);q.fistring||(q.fistring="Unknown");q.product||(q.product="Outside In Technology");q.version||(q.version="Unknown")}c&&N()});x.onnochrome(r)}}),ya=xa.extend("dialog",{install:function(d){var e=[],b=
null,a=!1,c,f=!1;d.createProgressDialog=function(a,c){var b={dialog:null,text:null,ticks:null,spinner:null,percentDone:0,active:!1,suppressed:!1,message:a,showTicks:c,display:q,update:t,hide:v};e.push(b);R.performance&&R.performance.now?(b.startTime=performance.now(),b.interval=sb(h,200,b)):b.display();return b};var h=function(){var a=performance.now()-this.startTime;0<this.percentDone?(a=100*a/this.percentDone,a=1E3<=a):a=500<=a;a&&(Ua(this.interval),this.display())},q=function(){var a=e.indexOf(this);
if(!this.active&&0===a&&!this.dialog)if(this.active=!0,F.on.showmessage.dispatch(this.message,!0,this.showTicks)){this.suppressed=!1;d.showModalOverlay(!0,200);if(a=w.rootNode){this.dialog=y.create("div","oit-dialog oit-progress-dialog");this.text=y.create("div","oit-dialog-text");this.ticks=y.create("div","oit-progress-dialog-ticks");for(var c=0;20>c;c++)this.ticks.append(y.create("div"));this.spinner=y.create("div","oit-pending oit-progress-dialog-ticks");this.dialog.append(this.text,this.ticks,
this.spinner);a.append(this.dialog)}!1===this.showTicks?(this.ticks.css("display",null),this.spinner.css("display","block")):(this.spinner.css("display",null),this.ticks.css("display","block"));this.tickCount=void 0;this.update(this.percentDone);this.text.html(this.message);this.dialog.css({opacity:0,display:"block"});this.dialog.abortAnimation();this.dialog.animate({opacity:1,time:200,startCSS:{display:"block"}})}else this.suppressed=!0},t=function(a){"number"===typeof a&&(0>a?a=0:100<a&&(a=100),
this.percentDone=a,this.active&&(F.on.progress.dispatch(a),this.dialog&&(a=Math.floor(21*a/100),20<a&&(a=20),a!=this.tickCount&&(this.tickCount=a,this.ticks.forChildElements(u,a)))))},u=function(a,c,b){c<b?a.addClass("filled"):a.removeClass("filled")},v=function(){var a=this;a.interval&&(Ua(a.interval),a.interval=void 0);a.active&&F.on.hidemessage.dispatch();a.dialog&&(a.dialog.abortAnimation(),a.dialog.animate({opacity:0,endCSS:{display:"none"},endFn:function(){a.dialog.destroy();a.dialog=null},
time:200}),d.showModalOverlay(!1,200));Sa(e,a)};d.showModalOverlay=function(a,b){b=b||200;var d=f;if(a){if(!c){var e=w.rootNode;e&&(c=y.create("div","oit-screen"),e.append(c))}c&&!f&&(f=!0,c.abortAnimation(),c.animate({opacity:.5,time:b,startCSS:{opacity:0,display:"block"}}))}else f&&(f=!1,c.abortAnimation(),c.animate({opacity:0,time:b,endCSS:{display:null}}));f!=d&&(d=z.activeOverlay())&&d.updateCSS()};d.modalOverlayVisible=function(){return f};d.showMessage=function(c){a&&d.hideMessage();if(F.on.showmessage.dispatch(c,
!1,!1)){if(!b){var e=w.rootNode;e&&(b=y.create("div","oit-background-message"),e.append(b))}b&&(a||(b.abortAnimation(),b.animate({opacity:.8,time:200,startCSS:{opacity:0,display:"block"}})),b.html(c))}a=!0};d.hideMessage=function(){a&&(F.on.hidemessage.dispatch(),b&&(b.abortAnimation(),b.animate({opacity:0,time:200,endCSS:{display:null}})),a=!1)};d.messageVisible=function(){return a};F.onreset(function(){for(;0<e.length;)e[e.length-1].hide();b&&b.destroy();c&&c.destroy();b=null;a=!1;c=null;f=!1})}}),
Hc=function(){function d(a){if(-1===a.indexOf("*"))return!1;for(var c=0;c<a.length;c++)if("*"!==a.charAt(c))return!1;return!0}function e(a,c,b){this.value=a;this.type=c;this.subtype=b}function b(){this.items=[];this.add=function(a,c,b){b||(b="");a=new e(a,c,b);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;
this.index++;return!0};this.current=function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function a(a,c){this.regEx=c;this.type=a}function c(a,d){for(var e=new b,n=a.slice(0);n;){for(var g=0;g<d.length;g++){var f=n.match(d[g].regEx);if(f){var m=d[g].type;if("LUCENE_WITHIN"===m){var r,m=e,l=/\"(.*)\"~(\d+)/.exec(f[0]);if(l){var C=c(l[1],v);if(C&&
C.items&&C.items.length){var h=0,k=0;for(r=0;r<C.items.length;r++){var A=C.items[r];"OPEN_PAREN"===A.type?k++:"CLOSE_PAREN"===A.type&&k--;if(0===k){h=r+1;break}}for(r=0;r<h;r++)m.addRef(C.items[r]);r=Number(l[2]);isNaN(r)||r++;m.add("WI"+r,"WITHIN",0);for(r=h;r<C.items.length;r++)m.addRef(C.items[r])}}}else"CONNECTOR_TILDE"===m?e.add(f[0].substring(0,f[0].length-1),"WORD",0):e.add(f[0],m,0);n=n.slice(f[0].length);break}}g==d.length&&(n=n.slice(1))}return e}function f(a,c,b){a.push("(");!1===b&&a.push("?:");
a.push(c);a.push(")")}function h(a,c,b,d,e){a.push("(");!1===d&&a.push("?:");q(a,c,b,e);a.push(")")}function q(a,c,b,d){var e;e=c.replace(/([\^\$\+\.\|\(\)\{\}\[\]\\])/g,"\\$1");x.normalizeAccentsForSearch&&(e=ic(e));e=e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]");e=e.replace(/[\u0022\u201C\u201D\u030B\u030F]/g,"[\\u0022\\u201C\\u201D\\u030B\\u030F]");e=e.replace(/\s+/g,"\\s+");if(b)b=e.replace(/\?/g,"[\\u003F]"),b=b.replace(/\*/g,"[\\u002A]");else if(b=e.replace(/\?/g,
"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]"),b=b.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),"dtsearch"===d.searchType)if(b=b.replace(/=/g,"[=\\d]"),d.stemAll||"~"===b.substring(b.length-1))c=0,"~"===b.substring(b.length-1)&&(c=1),b=b.substring(0,b.length-c).toLowerCase(),b=d.stemmerFunction(b),d.stems.push(b),
b+="\ue000*";else{if(d.fuzzies&&0<=b.indexOf("%")&&(c=b.indexOf("%"),0<=c)){var n=b.lastIndexOf("%")-c+1;b=b.replace(/%/g,"");b=b.toLowerCase();d.fuzzies.push({searchTerm:b,minMatch:c,maxDistance:n});0<c&&c--;b=b.slice(0,c)+"\ue001+";e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]")}}else if(d.fuzzies&&"lucene"===d.searchType&&0<=b.indexOf("~")){c=0;n=1;e=b.lastIndexOf("~");if(e+1<b.length){var g=Number(b.slice(e+1,b.length));isNaN(g)||(n=g)}b=b.slice(0,e);b=b.toLowerCase();
d.fuzzies.push({searchTerm:b,minMatch:c,maxDistance:n});b=b.slice(0,c)+"\ue001+"}a.push(b)}var t="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",u=[new a("NUMERICAL_PATTERN",/^(=[=\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]*)/),new a("CONNECTOR_TILDE",/^(\bNOT~(?=\s|$)|\bnot~(?=\s|\)|$))/),new a("CONNECTOR_TILDE",/^(\bAND~(?=\s|$)|\band~(?=\s|\)|$))/),new a("CONNECTOR_TILDE",/^(\bOR~(?=\s|$)|\bor~(?=\s|\)|$))/),new a("NOT_WITHIN",/^(\bNOT\b|\bnot\b)\s+(\bw\/|\bW\/|\bw \/|\bW \/)/),new a("AND_NOT",
/^(\bAND\b|\band\b)\s+(\bNOT\b|\bnot\b)/),new a("OR_NOT",/^(\bOR\b|\bor\b)\s+(\bNOT\b|\bnot\b)/),new a("AND",/^(\bAND\b|\band\b)/),new a("OR",/^(\bOR\b|\bor\b)/),new a("NOT",/^(\bNOT\b|\bnot\b)/),new a("AndAny",/^(\bAndAny\b|\bandany\b)/),new a("XFIRSTWORD",/^(\bxfirstword\b)/),new a("XLASTWORD",/^(\bxlastword\b)/),new a("DATE",/^\b[dD][aA][tT][eE]\(\s*\**\s*\)/),new a("DATE_WITH_PARAM",/^\b[dD][aA][tT][eE]\([^\)]*\)/),new a("MAIL",/^\b[mM][aA][iI][lL]\(\s*\**\s*\)/),new a("MAIL_WITH_PARAM",/^\b[mM][aA][iI][lL]\([^\)]*\)/),
new a("CREDITCARD",/^\b[cC][rR][eE][dD][iI][tT][cC][aA][rR][dD]\(\s*\**\s*\)/),new a("CREDITCARD_WITH_PARAM",/^\b[cC][rR][eE][dD][iI][tT][cC][aA][rR][dD]\([^\)]*\)/),new a("VISA_CREDIT_CARD_REGEX",/^\bvisacreditcard\(\)/),new a("WITHIN",/^(\bw\/|\bW\/|\bw \/|\bW \/|\bWI\d+|\bwi\d+)/),new a("PRE",/^(\bpre\/|\bPRE\/|\bpre \/|\bPRE \/)/),new a("OPEN_PAREN",/^\(/),new a("CLOSE_PAREN",/^\)/),new a("DTSEARCH_REGULAREXPRESSION",/^\"##[^\"]*\"/),new a("WHITESPACE",/^\s+/),new a("PHRASE",/^"[^"]*"/),new a("WORD",
/^[^\s)]+/)],v=[new a("AND",/^(\bAND\b|\s*\u0026\u0026\s*|\s*\u002B\s*)/),new a("OR",/^(\bOR\b|\s*\u007C\u007C\s*)/),new a("NOT",/^(\bNOT\b|\s*\u0021\s*|\s*\u002D\s*)/),new a("LUCENE_WITHIN",/^\"[^\"]*\"~\d+/),new a("OPEN_PAREN",/^\(/),new a("CLOSE_PAREN",/^\)/),new a("LUCENE_REGULAREXPRESSION",/^\/[^\/]*\//),new a("WHITESPACE",/^\s+/),new a("PHRASE",/^"[^"]*"/),new a("WORD",/^[^\s)]+/)],p="(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",
t="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",p="(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",l=function(a,c,b){var d,e=null;a.lastHit=pa(b,b+c[0].length);var g=c.length;for(d=1;d<c.length;d++)void 0===c[d]&&g--;if(0<g){e={range:a.lastHit,terms:[]};for(g=1;g<c.length;g++)if(c[g]){var f=c[g],m=a.modifier;"\ue010"===f?
d="\ue010+":(d=!!f.match(t),f=f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),d=d?["(",f,")"].join(""):["(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))(",f,")",p].join(""));d=new RegExp(d,m);for(m=null;f=d.exec(c[0]);){m||(m=f);if(0===f.index)break;if(f.index+f[0].length>=c[0].length){m=f;break}}if(m){f=m[0];d=m.index;if(m[1]){var r=m[0].indexOf(m[1]);
-1!=r&&(f=m[1],d+=r)}var r=b+d,C=r+f.length,l=!1;for(d=0;d<e.terms.length;d++){var h=e.terms[d];if(h.range.acc<C&&r<h.range.accend){r<h.range.acc&&(h.range.acc=r);C>h.range.accend&&(h.range.accend=C);l=!0;break}}!l&&(d=pa(r,C),e.terms.push({term:f,range:d}),m=m.index+m[0].length-1,0===a.nextOffset||a.nextOffset>m)&&(a.nextOffset=m)}}if(0===e.terms.length)e=null;else{c=e.terms[0].range;b=e.terms[0].range;e.range=ea(e.terms[0].range);for(d=1;d<e.terms.length;d++)g=e.terms[d].range,g.acc<e.range.acc&&
(e.range.acc=g.acc),g.accend>e.range.accend&&(e.range.accend=g.accend),g.acc<c.acc&&(c=g),g.accend>b.accend&&(b=g);a.lastHit=pa(c.acc,c.accend);e.lastTermACC=b.acc}}return e},m=function(a,c){var b=c.minMatch,d=c.searchTerm,e=c.maxDistance;if(a.length<b||d.length<b)return null;for(var g=0;g<b;g++)if(d.charAt(g)!==a.charAt(g))return null;for(var f=0,m=g,r,C,l,h,k=0;d.length-k>g&&a.length-k>g&&d.charAt(d.length-1-k)===a.charAt(a.length-1-k);)k++;for(var q=a.slice(0,a.length-k),p=d.slice(0,d.length-k);g<
p.length;)if(r=p.charAt(g),d=m<q.length?q.charAt(m):0,g++,m++,r!==d){f++;if(f>e)return null;C=g<p.length?p.charAt(g):0;l=m<q.length?q.charAt(m):0;r===l?(r=g+1<p.length?p.charAt(g+1):0,h=m+1<q.length?q.charAt(m+1):0,C===d&&r===h?(g++,m++):C===d&&r===l?g++:C===h?m++:C===l?(g++,m++):C===d?(g++,m++):(g>=p.length||k)&&m++):C===d?(r=g+1<p.length?p.charAt(g+1):0,m+1<q.length&&q.charAt(m+1),r===l?g++:C===l?(g++,m++):g++):C===l&&(g++,m++)}q.length>m&&(f+=q.length-m);if(f>e)return null;0<b&&b--;e=a.slice(0,
b);for(m=b;m<a.length;m++)e+="\ue001";return e},H=new RegExp("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))((?:([1-2][0-9]{3})(?:[[/\\-,\\u0020]+))?(?:(1[0-2]|0?[1-9]|january|jan(?:\\.)?|february|feb(?:\\.)?|march|mar(?:\\.)?|april|apr(?:\\.)?|may|june|jun(?:\\.)?|july|jul(?:\\.)?|august|aug(?:\\.)?|september|sept(?:\\.)?|sep(?:\\.)?|october|oct(?:\\.)?|november|nov(?:\\.)?|december|dec(?:\\.)?)(?:[ \\t]+(?:of|the)[ \\t]+|[/\\-\\u0020]+)((?:3[01]|[12][0-9]|0?[1-9])(?:(?:st|th|rd|nd)?)|(?:(?:thirty[\\- \\t]?)?(?:first|one))|(?:(?:twenty[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:teen)?(?:th)?|seven(?:teen)?(?:th)?|eighth|eight(?:een(?:th)?)?|ninth|nine(?:teen)?(?:th)?))|(?:thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))|((?:3[01]|[12][0-9]|0?[1-9])(?:(?:st|th|rd|nd)?)|(?:(?:thirty[\\- \\t]?)?(?:first|one))|(?:(?:twenty[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:teen)?(?:th)?|seven(?:teen)?(?:th)?|eighth|eight(?:een(?:th)?)?|ninth|nine(?:teen)?(?:th)?))|(?:thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))(?:[ \\t]+(?:of|the)[ \\t]+|[/\\-\\u0020]+)(1[0-2]|0?[1-9]|january|jan(?:\\.)?|february|feb(?:\\.)?|march|mar(?:\\.)?|april|apr(?:\\.)?|may|june|jun(?:\\.)?|july|jul(?:\\.)?|august|aug(?:\\.)?|september|sept(?:\\.)?|sep(?:\\.)?|october|oct(?:\\.)?|november|nov(?:\\.)?|december|dec(?:\\.)?))(?:(?:[ \\t\\-,/]+)(?:((?:[0-9]{2})?[0-9]{2})|((?:(?:(?:(?:(?:twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety)[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:ty)?(?:teen)?(?:th)?|seven(?:ty)?(?:teen)?(?:th)?|eight(?:y)?(?:een)?(?:h)?|ninth|nine(?:ty)?(?:teen)?(?:th)?))|(?:forty|fifty|sixty|seventy|eighty|ninety|thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))(?:[\\-\\u0020]?(?:hundred|thousand)?(?:and| )*)){1,3})))?)"+
p,"ig"),I=/(\w+)/ig,Q=function(a){var c=parseInt(a,10);2==a.length&&(c=50>a?c+2E3:c+1900);return c},J="jan feb mar apr may jun jul aug sep oct nov dec".split(" "),N=function(a){if("0"<=a.charAt(0)&&"9">=a.charAt(0))return parseInt(a);if(2<a.length)return a=a.slice(0,3),a=a.toLowerCase(),J.indexOf(a)+1},D="thousandth hundredth twentieth thirtieth fortieth fiftieth sixtieth seventieth eightieth ninetieth".split(" "),O="thousand hundred twenty thirty forty fifty sixty seventy eighty ninety".split(" "),
B="zero one two three four five six seven eight nine".split(" "),r="ten eleven twelve thirteen fourteen fifteen sixteen seventeen eighteen nineteen".split(" "),g="zeroth first second third fourth fifth sixth seventh eighth ninth tenth eleventh twelfth thirteenth fourteenth fifteenth sixteenth seventeenth eighteenth nineteenth".split(" "),k=["st","th","rd","nd"],C=function(a,c){for(var b=0;b<c.length;b++)if(0===a.indexOf(c[b]))return b;return-1},K=function(a){result=0;var c,b=0;for(a=a.toLowerCase();a;)if("0"<=
a.charAt(0)&&"9">=a.charAt(0)){for(c=1;c<a.length&&!("0">a.charAt(0)||"9"<a.charAt(0));c++);result=parseInt(a.slice(0,c));a=a.slice(c)}else c=C(a,D),0<=c?a=a.slice(D[c].length):(c=C(a,O),0<=c&&(a=a.slice(O[c].length))),0<=c?0==c?(0<b?result-=b:b=1,result+=1E3*b,b=0):1==c?(0<b?result-=b:b=1,result+=100*b,b=0):(result===b&&0<b&&100>b&&(result*=100),b=10*c,result+=b):(c=C(a,g),0<=c?(b=c,result+=c,a=a.slice(g[c].length)):(c=C(a,r),0<=c?(result===b&&0<b&&100>b&&(result*=100),b=c+10,result+=b,a=a.slice(r[c].length)):
(c=C(a,B),0<=c?(b=c,result+=c,a=a.slice(B[c].length)):(c=C(a,k),a=0<=c?a.slice(k[c].length):a.slice(1)))));return result},ba=function(a,c,b,d,e,g,f,m){a=0;c?a=1E4*Q(c):f?a=1E4*Q(f):m&&(a=1E4*K(m));b&&d?(a+=100*N(b),a+=K(d)):g&&e?(a+=100*N(g),a+=K(e)):a=0;if(1E7>a||2901E4<=a)a=null;return a},ia=function(a,c){function b(a,b,d,e){b=b.toLowerCase();if(c.stems)for(e=0;e<c.stems.length;e++)if(b.charAt(0)==c.stems[e].charAt(0)&&(d=c.stemmerFunction(b),d===c.stems[e])){for(a=d.length;a<b.length;a++)d+="\ue000";
return d}if(c.fuzzies)for(e=0;e<c.fuzzies.length;e++)if(d=m(b,c.fuzzies[e]))return d;return a}function d(a,b,d,e,n,g,f,m,r,C,l){if(c.dates)for(d=ba(b,d,e,n,g,f,m,r),i=0;i<c.dates.length;i++)if(d>=c.dates[i].startDate&&d<=c.dates[i].endDate){d="";for(e=0;e<a.length-b.length;e++)d+=a.charAt(e);b=a.length;if(n=a.match(/( and)+$/))b=n.index;for(;e<b;e++)d+="\ue010";for(;e<a.length;e++)d+=a.charAt(e);return d}return a}if(a){if(c.fuzzies&&0<c.fuzzies.length||c.stems&&0<c.stems.length)a=a.replace(I,b);c.dates&&
0<c.dates.length&&(a=a.replace(H,d))}return a};return{findStart:function(a,b,e,n,g,m,r){e=!1===e?"ig":"g";n={type:a,reverse:"up"===n,hits:[],hitIndex:0,lastHit:null,modifier:e,stemAll:!!m,stemmer:r};"number"==typeof g&&(n.startACC=g);if("string"==typeof b)if("dtsearch"===a||"lucene"===a){if(d(b))e=null;else{var E="\\S*(?:\\s+\\S+)",C=!1;g=!1;b.match(t)&&(E="(?:\\s*\\S)",C=!0);b="lucene"===a?c(b,v):c(b,u);var l=null;b&&(l=b.items);var k=[];b={searchType:a,stems:[],fuzzies:[],dates:[],stemAll:n.stemAll,
stemmerFunction:n.stemmer};n.stemmer&&("dtsearch"===n.stemmer?b.stemmerFunction=Fc:"porter"===n.stemmer&&(b.stemmerFunction=Zc));b.stemmerFunction||"dtsearch"!==a||(b.stemmerFunction=Fc);var ja=[],X=0;r=m=!1;for(var K=!0,I,A,J,Q=0;Q<l.length;Q++)if(A=l[Q],0<X)"OPEN_PAREN"===A.type?X++:"CLOSE_PAREN"===A.type?(X--,1===X&&X--):1===X&&"WHITESPACE"!==A.type&&X--;else{I=!1;if("WORD"===A.type){I=A.value.match(t);k.push("(");k.push("?:");I||k.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))");
k.push("(");!1===K&&k.push("?:");q(k,A.value,!1,b);for(Q++;Q<l.length;Q++)if("WHITESPACE"===l[Q].type&&Q+1<l.length&&"WORD"===l[Q+1].type)"lucene"===a?k.push("|"):k.push("\\s+");else if("WORD"===l[Q].type)q(k,l[Q].value,!1,b);else{Q--;break}k.push(")");I||k.push(p);k.push(")");I=!0}else if("PHRASE"===A.type)I=A.value.match(t),k.push("("),k.push("?:"),I||k.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"),
h(k,A.value.substring(1,A.value.length-1),!0,K,b),I||k.push(p),k.push(")"),I=!0;else if("WHITESPACE"!==A.type)if("WITHIN"===A.type){if(Q+1<l.length)if("WI"===A.value.substring(0,2)||"wi"===A.value.substring(0,2))A=Number(A.value.slice(2,A.value.length)),isNaN(A)||(ja.push(k.length),0<A&&A--,A=E+"{0,"+A+"}",C&&(A+="\\s*"),k.push(A));else if("WORD"===l[Q+1].type)if(A=Number(l[Q+1].value),!isNaN(A))Q++,ja.push(k.length),0<A&&A--,A=E+"{0,"+A+"}",C&&(A+="\\s*"),k.push(A);else if("S"===l[Q+1].value||"s"===
l[Q+1].value)Q++,ja.push(k.length),k.push("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)");else if("P"===l[Q+1].value||"p"===l[Q+1].value)Q++,ja.push(k.length),k.push("(?:[^\\u000a\\u000d]*)")}else if("NOT_WITHIN"===A.type)Q+1<l.length&&"WORD"===l[Q+1].type&&(A=Number(l[Q+1].value),isNaN(A)||(Q++,ja.push(k.length),K=!1,0<A&&A--,A="(?!("+E+"{0,"+A+"})",C&&(A+="\\s*"),k.push(A)));else if("PRE"===A.type)Q+1<l.length&&"WORD"===l[Q+1].type&&(A=Number(l[Q+1].value),isNaN(A)||(Q++,0<A&&A--,A=E+"{0,"+
A+"}",C&&(A+="\\s*"),k.push(A)));else if("MAIL"===A.type)f(k,'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))(@)((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',K),I=!0;else if("MAIL_WITH_PARAM"===A.type)A=A.value.substring(5,A.value.length-1),A=A.replace(/\s+$/,""),1<A.length&&(h(k,A,!1,K,b),I=!0);else if("CREDITCARD"===A.type)f(k,"(?:\\d[ -]*?){13,16}",K),I=!0;else if("CREDITCARD_WITH_PARAM"===A.type)A=A.value.substring(11,A.value.length-
1),A=A.replace(/\s+$/,""),1<A.length&&(h(k,A,!1,K,b),I=!0);else if("VISA_CREDIT_CARD_REGEX"===A.type)f(k,"(4[0-9]{12}(?:[0-9]{3})?)|(4[0-9]{3}-[0-9]{4}-[0-9]{4}-[0-9](?:[0-9]{3})?)",K),I=!0;else if("DATE"===A.type)b.dates.push({startDate:1E7,endDate:2901E4}),k.push("(\ue010+)"),I=!0;else if("DATE_WITH_PARAM"===A.type){var U=A.value.substring(5,A.value.length-1);if(I=H.exec(U))A=I=ba(I[1],I[2],I[3],I[4],I[5],I[6],I[7],I[8]),(U=H.exec(U))&&(A=ba(U[1],U[2],U[3],U[4],U[5],U[6],U[7],U[8])),I&&A&&(I>A&&
(U=I,I=A,A=U),b.dates.push({startDate:I,endDate:A})),k.push("(\ue010+)");H.lastIndex=0;I=!0}else"AND"===A.type?k.push("|"):"OR"===A.type?k.push("|"):"NOT"===A.type?X=1:"AND_NOT"===A.type?X=1:"OR_NOT"===A.type?X=1:"AndAny"===A.type?k.push("|"):"XFIRSTWORD"===A.type?(k.push("("),k.push("?:"),k.push("^\\s*"),k.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),k.push(")"),m=I=!0):"XLASTWORD"===A.type?(k.push("("),
k.push("?:"),k.push("\\s*"),k.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),k.push("\\s*$"),k.push(")"),r=I=!0):"DTSEARCH_REGULAREXPRESSION"===A.type?(k.push("("),k.push(A.value.substring(3,A.value.length-1)),k.push(")"),I=!0):"LUCENE_REGULAREXPRESSION"===A.type?(k.push("("),k.push(A.value.substring(1,A.value.length-1)),k.push(")"),I=!0):"OPEN_PAREN"===A.type?(k.push("("),k.push("?:")):"CLOSE_PAREN"===
A.type?(k.push(")"),I=!0):"NUMERICAL_PATTERN"===A.type&&(k.push("("),k.push("?:"),k.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]))"),k.push("("),!1===K&&k.push("?:"),I=k,A=A.value.replace(/([\^\(\)\[\]])/g,"\\$1"),A=A.replace(/\s+$/,""),A=A.replace(/[\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]+/g,"[\\u0020!@,:;<>\\$\\+\\-\\.\\\\\\/\\^\\{\\|\\}\\(\\)\\*\\?#~\\u2012\\u2013\\u2014\\uFE58\\uFF0D]+"),
A=A.replace(/=/g,"[=\\d]"),I.push("[\\(]?"+A),k.push(")"),k.push(p),k.push(")"),I=!0);if(0<ja.length&&I){U=ja[ja.length-1];J=0;A=U-1;for(var D=U+1;D<k.length;D++)"("===k[D]?J++:")"===k[D]&&J--;if(0===J&&")"==k[A])for(;0<=A&&(")"===k[A]?J++:"("===k[A]&&J--,0!==J);A--);I=k[U];if(0===J&&"(?!("===I.substring(0,4))k.push(")");else if(0===J){g=!0;k.push(")");k.push("|");k.push("(");k.push("?:");for(var N=[],K=U+1;K<D;K++)if(k.push(k[K]),"^\\s*"===k[K])for(N.push("^\\s*"),J=A;J<U;J++)N.push(k[J]);else if("\\s*$"===
k[K]){for(J=A;J<U;J++)N.push(k[J]);N.push("\\s*$")}k.push(k[U]);for(K=A;K<U;K++)if(k.push(k[K]),"^\\s*"===k[K])for(N.push("^\\s*"),J=U+1;J<D;J++)N.push(k[J]);else if("\\s*$"===k[K]){for(J=U+1;J<D;J++)N.push(k[J]);N.push("\\s*$")}k.push(")");if(N.length)for(k.push("|"),J=0;J<N.length;J++)k.push(N[J]);k.push(")");k.push(" ");k.push(" ");k.push(" ");k.push(" ");for(K=k.length;K>A+4;K--)k[K-1]=k[K-5];k[A]="(";k[A+1]="?:";k[A+2]="(";k[A+3]="?:";if("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===
I||"(?:[^\\u000a\\u000d]*)"===I)for(K=A;K<k.length;K++)if(k[K]===I)for(K++;K<k.length;K++)if("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"===k[K]){k[K]="(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===I?"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002D\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))":
"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))";break}ja.pop();K=!0}}}k=k.join("");1==l.length&&(m?k="^\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))":r&&(k="\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))\\s*$"));
a=null;if(0!==k.length)try{a=new RegExp(k,e)}catch(kb){}E=e=a;m?E=a=null:r&&(e=a=null);0===b.stems.length&&0===b.fuzzies.length&&0===b.dates.length&&(b=null);e={regex:a,first:e,last:E,searchParameters:b,checkForMultipleMatches:g}}n.regex=e}else{g=null;x.normalizeAccentsForSearch&&(b=ic(b));if(!1===d(b)||"literal"===a)b=b.replace(/([\^\$\+\?\.\|\(\)\{\}\[\]\\])/g,"\\$1"),b=b.replace(/^\s+/,""),b=b.replace(/\s+$/,""),b=b.replace(/['\u0060\u00B4\u2018\u2019]/g,"['\\u0060\\u00B4\\u2018\\u2019]"),b=b.replace(/[\"\u201C\u201D\u030B\u030F]/g,
'[\\"\\u201C\\u201D\\u030B\\u030F]'),b=b.replace(/\s+/g,"\\s+"),"phsterms"===a||"string"===a?(a=b.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),g=b.replace(/\*/g,t+"*"),g=new RegExp("(?:^|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])("+a+")(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])|(?="+
t+")("+g+")",e)):"literal*"===a?(b=b.replace(/\*/g,"[^\\s]*"),g=new RegExp("("+b+")",e)):"literal"===a&&(b=b.replace(/\*/g,"\\*"),g=new RegExp("("+b+")",e));n.regex={regex:g}}else b instanceof RegExp&&(n.regex={regex:b});return n},findNext:function(a,c){if(a.regex){if(void 0===a.blockIndex){if(void 0!==a.startACC){var b;a:{b=a.startACC;for(var d=0;d<c.length;d++){var e=c[d].range;if(b>=e.acc&&b<e.accend){b=d;break a}if(d==c.length-1&&(b=e.accend)){b=d;break a}}b=void 0}a.blockIndex=b}if(void 0===
a.blockIndex)if(a.reverse){if(ga.isPending())return;a.blockIndex=c.length-1}else a.blockIndex=0}for(;;){if(a.hitIndex>=a.hits.length){a.hits=[];a.hitIndex=0;for(b=a.reverse?0:c.length;0===a.hits.length;){d=c[a.blockIndex];if(!d)break;if(!d.text)break;var g,e=0;g=a.regex.searchParameters;var f=a.regex.regex;a.regex.last&&!ga.isPending()&&a.blockIndex==c.length-1&&(f=a.regex.last);a.regex.first&&0===a.blockIndex&&(f=a.regex.first);if(f){var k=d.text;for(g&&(k=ia(d.text,g));(g=f.exec(k))&&""!==g[0];){var m=
d.range.acc+g.index;a.nextOffset=0;if(!a.lastHit||m>a.lastHit.acc){var r=l(a,g,m);if(r){if("dtsearch"===a.type||"lucene"===a.type){for(var C=r.lastTermACC-m,h=null;0<C;){var C=g[0].substring(0,C),q=f.source,p="";f.global&&(p+="g");f.ignoreCase&&(p+="i");f.multiline&&(p+="m");C=(new RegExp(q,p)).exec(C);if(!C||""===C[0])break;C=l(a,C,m+C.index);if(!C)break;h||(h=[]);h.push(C);C=C.lastTermACC-m}if(h)for(m=h.length-1;0<=m;m--)a.hits.push(h[m])}a.hits.push(r)}}g.index>e&&(e=g.index);e+=a.nextOffset+1;
f.lastIndex=e}}if(a.blockIndex==b)break;a.blockIndex+=a.reverse?-1:1}a.reverse&&(a.hits=a.hits.reverse())}if(a.hitIndex>=a.hits.length)break;for(;a.hitIndex<a.hits.length;){b=a.hits[a.hitIndex];d=!0;void 0!==a.startACC&&(d=a.reverse?b.range.acc<=a.startACC:b.range.acc>=a.startACC);if(d&&z.isDocumentText(b.range.acc,b.range.accend-1))return a.hitIndex++,b;if(d&&ga.isPending())return;a.hitIndex++}}}}}}(),Z=xa.extend("rawtext",{events:{add:{}},install:function(d){var e=/(\r\n|\r|\n)/g,b=/\s/g,a=[],c,
f,h=function(){if(void 0===c)for(var b=c=0;b<a.length;b++)a[b].text&&c++;return c};d.findStart=function(a,c,b,d,e,f,h){return Hc.findStart(a,c,b,d,e,f,h)};d.findNext=function(c){return Hc.findNext(c,a)};d.findBoundaryStart=function(c,d){var f;if(0<a.length){var m="line"===d?e:b;m.lastIndex=0;for(var l=t(c);void 0!=l;){var h=a[l];if(!h.text)break;for(var q;q=m.exec(h.text);){q=h.range.acc+q.index;if(q>c)break;f=q+1}if(void 0!==f)break;if(0===l)break;l--}}void 0===f&&(f=c);return f};d.findBoundaryEnd=
function(c,d){var f;if(0<a.length){var m="line"===d?e:b;m.lastIndex=0;for(var l=t(c);void 0!=l;){var h=a[l];if(!h.text)break;for(var q;q=m.exec(h.text);)if(q=h.range.acc+q.index,q>c){f=q;break}if(void 0!==f)break;if(l+1>=a.length)break;l++}}void 0===f&&(f=c);return f};d.firstACC=function(){if(0<a.length)return a[0].range.acc};d.lastACC=function(){if(0<a.length)return a[a.length-1].range.accend};d.hasRawText=function(){if(0<a.length)return!0;if(!ga.isPending())return!1};d.isPending=function(){return ga.isPending()?
!0:h()<a.length};d.getRawTextBlock=function(c){if(0<=c&&c<a.length)return c=a[c],c.text||u(c),c};var q=function(){var c=t(this.acc),b=t(this.accend);if(void 0===c||void 0===b)d.isPending()?(d.onadd(this,q),ga.onadd(this,q)):(d.offadd(this,q),ga.offadd(this,q),this.callback());else{for(var e=0,f=c;f<=b;f++){var h=a[f];!h.text&&h.src?u(h,q,this):e++}e==b-c+1&&(d.offadd(this,q),ga.offadd(this,q),this.callback())}};d.loadRawText=function(a,c,b){q.call({acc:a,accend:c,callback:b})};d.getRawText=function(c,
b){for(var d=t(c),e=t(b),f;d<=e;d++){var m=a[d];if(!m.text){f=void 0;break}var h=c-m.range.acc;0>h&&(h=0);var l=b-m.range.acc;l>m.text.length&&(l=m.text.length);m=m.text.substring(h,l);f=f?f+m:m}return f};var t=function(c){for(var b=0;b<a.length;b++){var d=a[b].range;if(c>=d.acc&&c<d.accend||b==a.length-1&&(c=d.accend))return b}},u=function(a,c,b){if(!a.text&&a.src){if(c){a.callbacks||(a.callbacks=[]);for(var d=!1,e=0;e<a.callbacks.length;e++)if(a.callbacks[e].func==c&&a.callbacks[e].context==b){d=
!0;break}d||a.callbacks.push({func:c,context:b})}a.loading||(c=Qa(w.baseURL,a.src),h(),a.loading=!0,Ma({url:c,complete:v,args:[a]}))}else c&&c.call(b,a)},v=function(b,e,f,h,q){q.loading=!1;200==h?ga.isICD(f)?ga.processContentData(f):(q.text=f,p(q)):(q.text="",d.logAJAXError(null,"Failed to load a document text block from the server",b,h,f));c++;e=a.indexOf(q);b=a[e-1];e=a[e+1];b&&b.text&&(q.text=b.text.substr(b.text.length-2048,2048)+q.text,q.range.acc-=2048);e&&e.text&&(e.text=q.text.substr(q.text.length-
2048,2048)+e.text,e.range.acc-=2048);if(q.callbacks){for(b=0;b<q.callbacks.length;b++)q.callbacks[b].func.call(q.callbacks[b].context,q);delete q.callbacks}200==h&&d.on.add.dispatch(q.range.acc,q.range.accend)};d.replaceRawText=function(c){if(c&&(f=f?f.concat(c):c,0<a.length))for(c=0;c<a.length;c++)p(a[c])};var p=function(a){if(f&&f.length&&a.text)for(var c,b=a.range.acc,d=a.range.acc+a.text.length,e=0;e<f.length;e++)if(c=f[e],c.acc<=d&&c.accend>=b){var h=c.acc-b;0>h&&(h=0);c=c.accend-b;c>a.text.length&&
(c=a.text.length);for(var l=c-h,q="";0<l--;)q+=" ";a.text=a.text.substr(0,h)+q+a.text.substr(c)}a.text&&x.normalizeAccentsForSearch&&(a.text=ic(a.text))};F.onreset(function(){f=c=void 0;a=[]});ga.ondata(function(c,b,d){if(c.text)for(b=0;b<c.text.length;b++){d=c.text[b];p(d);for(var e=0;e<a.length;e++)if(0===Xa(d.range,a[e].range)){a[e].text=d.text;d=null;break}d&&(a.push(d),u(d))}})}}),jc,wa,pa,Ob,mb,ta,Fb,va,Xa,Ic,bb,ea,Jc,kc,Pb,nb,Gb;(function(){var d=function(d,b){return d.acc-b.acc};jc=function(d){return!!wa(d,
!1,!1)};wa=function(d,b,a){var c;if(d&&d.type)switch(d.type){case "text":da(d.acc)&&da(d.accend)&&(c=d);c&&a&&(d=z.forRange(c,0,!0))&&d.isEmailHeader()&&(d=z.findTextRange(c))&&(d=d[0].startContainer)&&(y.isText(d)||y.isElement(d))&&(d=Ta(d),d=mb(d))&&(Array.isArray(d)&&(d=pa(d[0].acc,d[d.length-1].accend)),c.acc<d.acc||c.accend>d.accend)&&(c=ea(c),c.acc<d.acc&&(c.acc=d.acc),c.accend>d.accend&&(c.accend=d.accend));break;case "cell":if(da(d.page)&&da(d.c1)&&da(d.r1)&&da(d.c2)&&da(d.r2)&&(c=d,0>c.page?
c=void 0:c.page<z.count()?(a=z.page(c.page))&&"worksheet"!==a.type&&"database"!=a.type&&(c=void 0):c.offsets&&(da(c.offsets.left)&&da(c.offsets.top)&&da(c.offsets.right)&&da(c.offsets.bottom)||(c=void 0)),c&&!0===b&&(a=z.page(d.page)))&&(a=a.spreadsheetModel())){var e=a.colCount()-1;b=a.rowCount()-1;if(d.c1>e||0>d.c2||d.r1>b||0>d.r2)c=void 0;else{a=fa(d.c1,0,e);var e=fa(d.c2,0,e),h=fa(d.r1,0,b);b=fa(d.r2,0,b);if(a!==d.c1||e!==d.c2||h!==d.r1||b!==d.r2)c=ea(d),c.c1=a,c.c2=e,c.r1=h,c.r2=b}}break;case "rect":if(da(d.page)&&
da(d.left)&&da(d.top)&&da(d.right)&&da(d.bottom)&&eb(d.units)&&("px"===d.units||"tw"===d.units||"pct"===d.units)&&(c=d,"pct"!==d.units||da(d.embedId)?0>c.page?c=void 0:void 0===d.embedId&&c.page<z.count()&&(a=z.page(c.page))&&"page"!==a.type&&"drawing"!==a.type&&"slide"!==a.type&&"chart"!==a.type&&"bitmap"!==a.type&&"email"!==a.type&&"html"!==a.type&&"rt"!==a.type&&"sn"!==a.type&&(c=void 0):c=void 0,c&&void 0===d.embedId&&!0===b&&(a=z.page(d.page))&&(b=a.pageRect())))if(d.left>b.right||d.right<b.left||
d.top>b.bottom||d.bottom<b.top)c=void 0;else{var e=fa(d.left,b.left,b.right),h=fa(d.top,b.top,b.bottom),q=fa(d.bottom,h,b.bottom),t=d.right;"html"!==a.type&&(t=fa(d.right,e,b.right));if(e!=d.left||t!=d.right||h!=d.top||q!=d.bottom)c=ea(d),c.left=e,c.right=t,c.top=h,c.bottom=q}}return c};pa=function(){var d=arguments,b,a;switch(d.length){case 2:da(d[0])&&da(d[1])&&(b=d[0],a=d[1]);break;case 1:if(da(d[0]))b=d[0],a=d[0];else if(Ia(d[0])||Ka(d[0])){if(d=mb(d[0]))Array.isArray(d)?(b=d[0].acc,a=d[d.length-
1].accend):(b=d.acc,a=d.accend)}else if((d=wa(d[0]))&&"cell"===d.type){var c=z.page(d.page);if(c&&("worksheet"===c.type||"database"===c.type)&&(c=c.spreadsheetModel()))return c.mapToText(d)}}var f;da(b)&&da(a)&&(f=new OIT.TextRange(b,a));return f};Ob=function(d,b){d=y.unwrap(d);b=b||0;var a;a:{if(1===d.nodeType&&d.childNodes&&(a=d.childNodes[b]))break a;a=void 0}a&&(d=a,b=0);var c;a=w.viewNode;for(var e=d;e;e=e.parentNode){var h=y.data(e,"acc");if(void 0!==h){"none"!==h&&(c=y.wrap(e));break}if(e===
a)break}if(a=c){c=parseInt(a.data("acc"),10);if(!a.equals(d))for(a=a.createTreeWalker(),e=a.firstACCNode();e;){e=a.currentNode;if(e===d)break;1===e.nodeType?(e=y.data(e,"acc"))&&(c=parseInt(e,10)):3===e.nodeType&&(c+=e.nodeValue.length);e=a.nextACCNode()}return c+b}};mb=function(d){var b;Ia(d)?b=d:Ka(d)&&"number"===typeof d.rangeCount&&0<d.rangeCount?b=d.getRangeAt(0):y.isElement(d)&&(b=V.createRange(),b.selectNode(y.unwrap(d)));if(b){d=b.startContainer;var a=b.startOffset,c=b.endContainer,e=b.endOffset,
h,q;if(d===c){h=Ob(d,a);if(a===e)return pa(h,h);if(y.isText(d))return pa(h,h+e-a)}for(var t=b.commonAncestorContainer;t&&!y.isElement(t);)t=t.parentNode;t=y.wrap(t);b=Ob(t);var u=[],v,t=t.createTreeWalker();h=t.firstACCNode();for(var p=!1,l=!1,m=!1;h;){var H=t.currentNode;H===d&&y.isText(d)?p=!0:p||H.parentNode!==d||(l=!0,0!==a&&y.nodeIndex(H)!=a)||(p=!0);l&&!p&&(y.isDescendantOf(H,d)||(p=!0));if(m&&!y.isDescendantOf(H,c))break;1===H.nodeType?(h=y.data(H,"acc"))&&(b="none"===h?void 0:Number(h)):3===
H.nodeType&&void 0!==b&&(p&&0<H.nodeValue.length&&(h=b,H===d&&(h+=a),q=b+H.nodeValue.length,H===c&&(q=b+e),v&&v.accend!=b&&v.accend!=b-1&&(v=null),v?v.accend=q:(v=pa(h,q),u.push(v))),b+=H.nodeValue.length);if(H===c&&y.isText(c))break;else if(H.parentNode===c&&(m=!0,0===e||y.nodeIndex(H)>=e))break;h=t.nextACCNode()}u=Jc(u);0===u.length?u=void 0:1==u.length&&(u=u[0]);return u}};ta=function(){var d,b,a,c,f,h,q,t=arguments;switch(t.length){case 9:b=t[0];a=t[1];c=t[2];f=t[3];h=t[4];q={left:t[5],top:t[6],
right:t[7],bottom:t[8]};break;case 5:b=t[0];a=t[1];c=t[2];f=t[3];h=t[4];break;case 4:a=t[0];c=t[1];f=t[2];h=t[3];break;case 3:b=t[0];a=t[1];c=t[2];f=t[1];h=t[2];break;case 2:a=t[0];c=t[1];f=t[0];h=t[1];break;case 1:if((t=wa(t[0]))&&"text"===t.type&&(d=z.forRange(t))&&("worksheet"===d.type||"database"===d.type)&&(d=d.spreadsheetModel()))return d.mapToCells(t)}if(void 0===b)b=z.current();else if(eb(b)){if(d=z.byName(b))b=d.index}else if(da(b)){if(0>b||b>=z.count())b=void 0}else b=void 0;var u;da(b)&&
da(a)&&da(c)&&da(f)&&da(h)?u=new OIT.CellRange(b,a,c,f,h,q):F.invalidArg("cellRange");return u};Fb=function(){var d,b,a,c,f,h,q="px",t=arguments;if(2<=t.length&&6>=t.length){var u=0;if(eb(t[u])){var v=z.byName(t[u]);v&&(b=v.index,u++)}for(var v=0,p=u;p<t.length;p++)if(da(t[p]))v++;else break;switch(v){case 6:d=t[u++];case 5:b=t[u++];case 4:a=t[u++];c=t[u++];f=t[u++];h=t[u++];break;case 3:b=t[u++];case 2:a=t[u++],c=t[u++],f=a,h=c}u<t.count&&eb(t[u])&&(q=t[u++])}if(void 0===b)b=z.current();else if(da(b)){if(0>
b||b>=z.count())b=void 0}else b=void 0;var l;da(b)&&da(a)&&da(c)&&da(f)&&da(h)&&("px"===q||"tw"===q||"pct"===q)?l=new OIT.RectRange(d,b,a,c,f,h,q):F.invalidArg("rectRange");return l};va=function(d,b){if(d&&"rect"===d.type&&d.units!==b){var a,c,e;switch(b){case "px":"tw"===d.units?(a=z.page(d.page))&&a.dpi&&(d.left=L(d.left*a.dpi/1440,1E4),d.top=L(d.top*a.dpi/1440,1E4),d.right=L(d.right*a.dpi/1440,1E4),d.bottom=L(d.bottom*a.dpi/1440,1E4),d.units="px"):"pct"===d.units&&void 0!==d.embedId&&(a=z.page(d.page))&&
(a=a.embeddingRect(d.embedId))&&(c=a.width/100,e=a.height/100,d.left=L(d.left*c,1E4),d.right=L(d.right*c,1E4),d.top=L(d.top*e,1E4),d.bottom=L(d.bottom*e,1E4),d.units="px");break;case "tw":"px"===d.units&&(a=z.page(d.page))&&a.dpi&&(d.left=L(1440*d.left/a.dpi,1E4),d.top=L(1440*d.top/a.dpi,1E4),d.right=L(1440*d.right/a.dpi,1E4),d.bottom=L(1440*d.bottom/a.dpi,1E4),d.units="tw");break;case "pct":if("px"===d.units&&(a=z.page(d.page))){if(void 0!==d.embedId){if(a=a.embeddingRect(d.embedId))c=100/a.width,
e=100/a.height}else e=a.pageRect(),c=100/e.width,e=100/e.height;void 0!==c&&(d.units="pct",d.left=L(d.left*c,1E4),d.right=L(d.right*c,1E4),d.top=L(d.top*e,1E4),d.bottom=L(d.bottom*e,1E4))}}}};Xa=function(d,b){if(!d)return b?-1:0;if(!b)return 1;if(d.page<b.page)return-1;if(d.page>b.page)return 1;if(d.type===b.type)switch(d.type){case "text":return d.acc<b.acc?-1:b.acc<d.acc?1:d.accend<b.accend?-1:b.accend<d.accend?1:0;case "cell":if(d.r1<b.r1)return-1;if(b.r1<d.r1)return 1;if(d.c1<b.c1)return-1;if(b.c1<
d.c1)return 1;if(d.r2<b.r2)return-1;if(b.r2<d.r2)return 1;if(d.c2<b.c2)return-1;if(b.c2<d.c2)return 1;if(d.offsets)if(b.offsets){if(d.offsets.top<b.offsets.top)return-1;if(d.offsets.top>b.offsets.top)return 1;if(d.offsets.left<b.offsets.left)return-1;if(d.offsets.left>b.offsets.left)return 1;if(d.offsets.bottom<b.offsets.bottom)return-1;if(d.offsets.bottom>b.offsets.bottom)return 1;if(d.offsets.right<b.offsets.right)return-1;if(d.offsets.right>b.offsets.right)return 1}else return 1;else if(b.offsets)return-1;
return 0;case "rect":return d.units!=b.units&&(b=ea(b),va(b,d.units)),d.top<b.top?-1:b.top<d.top?1:d.left<b.left?-1:b.left<d.left?1:d.bottom<b.bottom?-1:b.bottom<d.bottom?1:d.right<b.right?-1:b.right<d.right?1:0}};Ic=function(d,b){if(d.type===b.type)switch(d.type){case "text":return b.acc>=d.acc&&b.accend<=d.accend}return!1};bb=function(d,b){if(d&&b&&b.type===d.type)switch(b.type){case "text":return d.accend>b.acc&&d.acc<b.accend;case "cell":return d.c2>=b.c1&&d.c1<=b.c2&&d.r2>=b.r1&&d.r1<=b.r2;case "rect":return d.right>=
b.left&&d.left<=b.right&&d.bottom>=b.top&&d.top<=b.bottom}return!1};ea=function(d){var b;if(d)switch(d.type){case "text":b=new OIT.TextRange(d.acc,d.accend);break;case "cell":b=new OIT.CellRange(d.page,d.c1,d.r1,d.c2,d.r2);!0===d.selectingCols&&(b.selectingCols=!0);!0===d.selectingRows&&(b.selectingRows=!0);d.offsets&&(b.offsets={left:d.offsets.left,top:d.offsets.top,right:d.offsets.right,bottom:d.offsets.bottom});break;case "rect":b=new OIT.RectRange(d.embedId,d.page,d.left,d.top,d.right,d.bottom,
d.units,d.section)}return b};Gb=function(d,b){if(b)if(Array.isArray(b))for(var a=0;a<b.length;a++)d=Gb(b[a],d);else if(!d)d=ea(b);else if(d.type===b.type)switch(d.type){case "cell":b.c1<d.c1&&(d.c1=b.c1);b.r1<d.r1&&(d.r1=b.r1);b.c2>d.c2&&(d.c2=b.c2);b.r2>d.r2&&(d.r2=b.r2);break;case "text":b.acc<d.acc&&(d.acc=b.acc),b.accend>d.accend&&(d.accend=b.accend)}return d};Jc=function(e){if(e&&1<e.length){e.sort(d);for(var b=[],a,c=0;c<e.length;c++){var f=e[c];a&&3>f.acc-a.accend?f.accend>a.accend&&(a.accend=
f.accend):(a=f,b.push(f))}e=b}return e};kc=function(d){if(1===d.length)return d[0];if(1<d.length){var b=d[0],a=V.createRange();a.setStart(b.startContainer,b.startOffset);a.setEnd(b.endContainer,b.endOffset);for(var b=Ta(b.startContainer),c=1;c<d.length;c++){var e=d[c],h=Ta(e.endContainer);y.unwrap(h)==y.unwrap(b)&&a.setEnd(e.endContainer,e.endOffset)}return a}};Pb=function(d){if(d=wa(d))switch(d.type){case "text":return d.acc==d.accend;case "cell":return!1;case "rect":return d.left==d.right||d.top==
d.bottom}return!0};nb=function(d){if(d)switch(d.type){case "cell":var b=[];b.push(Va(d.c1),d.r1+1);d.c2==d.c1&&d.r2==d.r1||b.push(":",Va(d.c2),d.r2+1);return b.join("")}}})();var G=xa.extend("display",{events:{displayload:{},displayunload:{}},install:function(d){var e={zoom:!1,rotate:!1,showhidden:!1,pages:!1,fitpage:!1,highlights:!1,textselection:!1,rectselection:!1,rectredaction:!1,cellselection:!1,customtextselection:!1,anchorednotes:!1},b=null,a=null,c=e,f=!1,h;d.loadDisplay=function(e){d.unloadDisplay();
var f=e.type;e.overlay&&e.overlay.firstPage&&(f=e.overlay.firstPage.type);if(b=ua.createDisplay(f))a=e.overlay,w.deType=f,c=ua.features(f),w.drawing.resetOrigin(),b.init(e),d.on.displayload.dispatch(a.firstPage,a.lastPage)};d.unloadDisplay=function(){b&&(d.on.displayunload.dispatch(a.firstPage,a.lastPage),b.unload(),a=b=null,w.deType=null);c=e};d.features=function(){var a=c;if("vertical"!==x.scrollMode){var d=z.activePage();d&&(a=ua.features(d.type))}return a};d.isSelectionModeSupported=function(a){var c=
!1;switch(a){case "none":c=!0;break;case "text":d.features().textselection&&(c=!0);break;case "rect":d.features().rectselection&&(c=!0);break;case "cell":d.features().cellselection&&(c=!0)}return c};d.isHighlightModeSupported=function(a){var c=d.isSelectionModeSupported(a);c||"text"!==a||"worksheet"!==w.deType&&"database"!==w.deType||(c=!0);return c};d.visiblePages=function(){return b?b.visiblePages():[]};d.startElasticScroll=function(){if(b)return b.startElasticScroll()};d.elasticScroll=function(a,
c){if(b)return b.elasticScroll(a,c)};d.endElasticScroll=function(a,c){if(b)return b.endElasticScroll(a,c)};d.saveScrollPos=function(){if(b)return b.saveScrollPos()};d.restoreScrollPos=function(a){b&&b.restoreScrollPos(a)};d.maxPageWidth=function(){if(b)return b.maxPageWidth()};d.maxPageHeight=function(){if(b)return b.maxPageHeight()};d.padding=function(){if(b)return b.padding()};d.scrollPadding=function(){if(b)return b.scrollPadding()};d.margin=function(){if(b)return b.margin()};d.scrollOffset=function(){if(b)return b.scrollOffset()};
d.keydown=function(a){return b?b.keydown(a):!0};d.showHidden=function(a){b&&b.showHidden(a)};d.loadRange=function(a,c){b&&b.loadRange(a,c)};d.expandRange=function(a){b&&(a=b.expandRange(a));return a};d.moveto=function(a,c,d){return b?b.moveto(a,c,d||{}):!1};d.getSelectedText=function(){return b?b.getSelectedText():""};d.select=function(a){return b?b.select(a):!1};d.pageRange=function(c,d){if(b&&a.containsPage(c))return b.pageRange(c,d)};d.pageRect=function(c,d){if(b&&a.containsPage(c))return b.pageRect(c,
d)};d.rangeRect=function(c,d,e,f){if(b&&("text"===c.type||a.containsPage(c.page)))return b.rangeRect(c,d,e,f)};d.rangeFromRect=function(c,d,e,f,h,l,m,H){if(b&&a.containsPage(c))return b.rangeFromRect(c,d,e,f,h,l,m,H)};d.extendRange=function(a,c,d,e){if(b)return b.extendRange(a,c,d,e)};d.moveAnchor=function(a,c,d,e){return b?b.moveAnchor(a,c,d,e):!1};d.incrementSelection=function(a,c,d,e,f){return b?b.incrementSelection(a,c,d,e,f):!1};d.suspendUpdate=function(){f||(f=!0)};d.resumeUpdate=function(){f&&
(f=!1,d.update())};d.layoutChanged=function(a){b&&b.layoutChanged(a)};d.update=function(a,c){if(!f)if(!0===c)h&&sa(h),h=ca(d.update,50,this,a,!1);else if(b)return b.update(a);return!1};d.activeOverlay=function(){return a};F.onreset(d.unloadDisplay);Gc.onfontload(function(){d.update(!0)})}}),S=xa.extend("selection",{events:{beginselection:{},selectionchanged:{}},install:function(d){var e=null,b=!0,a,c=null,f=!0,h=!1,q=!0,t=!1,u,v,p,l,m,H,I,Q,J,N,D,O=0,B,r,g,k=0,C,K,ba=0,ia=0,na,A,U,n=[],E,ja,X,oa;
d.reset=function(){d.select(null);x.selectionMode=d.validateMode(x.selectionMode)};d.style=function(a,d){f=!1===d?!1:!0;null!==a&&"string"!==typeof a||a===c||(c=a,e=qb(c),Ea(),qa());return c};d.isSelecting=function(){return t};var Ea=function(a){if(!a&&e){a="";e.color&&(a+="color:"+e.color+";");var c=e["background-color"];c&&(a+="background-color:"+c+";")}a&&0<a.length?(E||(E=y.create("style"),E.type="text/css",y.byTagName("head")[0].append(E)),E.html(".oit-view ::selection, .oit-annopane ::selection { "+
a+"}")):E&&E.html("")},qa=function(){if(v){var a=v.selectionRect();a.resetStyle();e?(a.removeClass("oit-sel-rect"),a.css(e)):a.addClass("oit-sel-rect");a.update()}};d.textSelection=function(){if(p){if("text"===p.type)return ea(p);if("cell"===p.type)return pa(p)}};d.cellSelection=function(){if(p&&"cell"===p.type)return ea(p)};d.rectSelection=function(){if(p&&"rect"===p.type)return ea(p)};d.selectionType=function(){return p?p.type:"none"};d.hide=function(c){b=!1;a=c;hc("firefox")?d.select(null):a?Ea(a):
Ea("background-color: rgba(255,255,255,0);");v&&v.showSelectionRect(!1)};d.select=function(c,e,g,n){var f=!1;b=!0;a=null;if(null===c)f=!!p,aa(),d.update();else if(c)if(Ka(c)||Ia(c))f=d.select(pa(c));else if(c=wa(c),!c||c.selectingRows||c.selectingCols||!1===c.autoExpand||(c=G.expandRange(c)),c&&0!==Xa(c,p)){var k=z.forRange(c,0,!0);k&&(f=!0,d.on.beginselection.dispatch(c),aa(),v=k,p=ea(c),u=ea(c),qa(),d.update())}if(f||e!==oa)d.on.selectionchanged.dispatch(p,!0),oa=e,F.on.select.dispatch(p,g||null,
n||null,Pb(p),e)&&(w.drawing&&w.drawing.update(!0),p&&void 0===e&&(c=G.rangeRect(p,"view"),"text"===p.type&&d.update(),c&&P.activateNearest(c.left,c.top)));return f};d.saveSelection=function(){if(!p)return null;var c={range:ea(p)};b||(c.visible=!1,c.hideStyle=a);return c};d.restoreSelection=function(a){if(a){var c=a.range,b=z.forRange(c,0,!0);b&&(d.on.beginselection.dispatch(c),aa(),v=b,p=ea(c),u=ea(c),qa(),d.update(),a.visible||d.hide(a.hideStyle))}};d.startRectSelection=function(c,e,g){aa();z.deactivateAnnotation();
t=!0;G.isSelectionModeSupported("text")||P.startSelection();g=z.mapToPage(c,e,null,!0);d.logRect&&d.logRect(g.page,g.x,g.y,!0);l={x:c,y:e};v=g.page;I=g.x;Q=g.y;J=c;N=e;b=H=!0;a=null;p=G.rangeFromRect(v.index,I,Q,I,Q,v,"select");"cell"!==p.type||h||delete p.offsets;u=ea(p);d.on.beginselection.dispatch(p);qa();d.update();d.on.selectionchanged.dispatch(p,!1);return!0};d.extendRectSelection=function(a,c,b){u&&(H&&(b=Math.abs(c-N),2<Math.abs(a-J)||2<b)&&(H=!1,G.isSelectionModeSupported("text")&&P.startSelection()),
Ba(m,a,c),a=z.mapToPage(a,c,v,!0),d.logRect&&d.logRect(a.page,a.x,a.y),p=G.extendRange(u,a.x,a.y,a.page),q&&(p=wa(p,!0)),d.update(),d.on.selectionchanged.dispatch(p,!1))};d.endRectSelection=function(a,c,b){ka();t=!1;d.extendRectSelection(a,c);d.on.selectionchanged.dispatch(p,!0);var e={x:a,y:c},g=H;oa=void 0;F.on.select.dispatch(p,l,e,H)&&"rect"===x.selectionMode&&d.select(null);g&&b&&(e=y.wrap(b.target),e.isDescendantOf(z.activeOverlay())||e.isDescendantOf(w.drawing))&&((e=z.activePage())&&e.isSpreadsheet()?
P.activateNearest(a,c,b,!0):(a=P.findNearest(a,c))&&0===a.distance.ax&&0===a.distance.ay||P.deactivate());P.endSelection()};d.cancelRectSelection=function(a,c){ka();d.select(null)};d.startTouchTextSelection=function(c,e){b=!0;a=null;ja&&d.abortTouchTextSelection();t=!0};d.updateTouchTextSelection=function(){var a=R.getSelection();!a.anchorNode||X&&X.anchorNode==a.anchorNode&&X.anchorOffset==a.anchorOffset&&X.focusNode==a.focusNode&&X.focusOffset==a.focusOffset||(X||(X={}),X.anchorNode=a.anchorNode,
X.anchorOffset=a.anchorOffset,X.focusNode=a.focusNode,X.focusOffset=a.focusOffset,ja=pa(a))};d.abortTouchTextSelection=function(){ja=null;t=!1};d.startTextSelection=function(c,e,n,f){aa();t=!0;g=D=null;m=y.wrap(f.target);b=!0;a=null;l={x:c,y:e};H=!0;J=c;N=e;if(!G.features().customtextselection)return!1;c=z.mapToPage(c,e,null,!0,!0);c.inAnnotation||z.deactivateAnnotation();e=c.page.mapPointToText(c.x,c.y,null,c.inAnnotation);if(!e||!e.overlaps)return!1;K=c;r=Ta(e.node);var E;if("line"===n||"word"===
n)E=c.page.findTextBoundary(e.node,e.offset,n);E?(C=n,B=E,D=B.startContainer,O=B.startOffset,g=B.endContainer,k=B.endOffset):(C=void 0,D=e.node,O=e.offset,g=e.node,k=e.offset);if(D&&g&&(d.update(),y.selectRange(D,O,g,k),n=R.getSelection(),n.anchorNode&&n.focusNode))if(n=pa(n))d.on.beginselection.dispatch(n);else return g=D=null,!1;return!0};d.extendTextSelection=function(a,c,d){if(!G.features().customtextselection)return!1;H&&(d=Math.abs(c-N),2<Math.abs(a-J)||2<d)&&(H=!1,G.isSelectionModeSupported("text")&&
P.startSelection());Ba(m,a,c);d=null;var b=!1;K&&K.inAnnotation&&(d=K.page,b=!0);a=z.mapToPage(a,c,d,!0,!0,b);c=a.page.mapPointToText(a.x,a.y,r,a.inAnnotation);if(!c)return!1;if(c.node!=g||c.offset!=k){if(C){if(c=a.page.findTextBoundary(c.node,c.offset,C))a=c.compareBoundaryPoints(Range.START_TO_START,B),-1==a?(g=c.startContainer,k=c.startOffset,D=B.endContainer,O=B.endOffset):(D=B.startContainer,O=B.startOffset,g=c.endContainer,k=c.endOffset)}else g=c.node,k=c.offset;D&&g&&(D==g?O>k?y.selectRange(g,
k,D,O):y.selectRange(D,O,g,k):(a=D.compareDocumentPosition(g),2==a?y.selectRange(g,k,D,O):y.selectRange(D,O,g,k)))}return!0};d.endTextSelection=function(a,c,b){ka();t=!1;K=m=null;if("text"==x.selectionMode){var e,n=H;C&&(n=!1);ja?(e=ja,ja=null):(e=R.getSelection(),e=e.anchorNode&&e.focusNode?pa(e):null);if(!e)aa(),P.autoHighlight()&&y.clearSelection();else if(0!==Xa(e,p)){e.acc!==e.accend&&(n=!1);var f=z.forRange(e);f&&(H=!1,N=J=Q=I=void 0,v=f,p=e,u=ea(e),d.on.selectionchanged.dispatch(p,!0),e={x:a,
y:c},oa=void 0,F.on.select.dispatch(p,l,e,Pb(p)))}n&&b&&(b=y.wrap(b.target),b.isDescendantOf(z.activeOverlay())||b.isDescendantOf(w.drawing))&&((a=P.findNearest(a,c))&&0===a.distance.ax&&0===a.distance.ay||P.deactivate());D=void 0;O=0;g=B=void 0;k=0;C=void 0}P.endSelection()};d.incrementSelection=function(a,c,b){var e=!1;p&&(e=G.incrementSelection(u,p,a,c,b))&&(d.update(),d.on.selectionchanged.dispatch(p,!0));return e};d.moveAnchor=function(a,c,b){var e=!1;u&&(e=G.moveAnchor(u,a,c,b))&&(p=ea(u),d.update(),
d.on.selectionchanged.dispatch(p,!0));return e};d.update=function(){if(p)if("text"===p.type){y.clearSelection();d.logUpdate&&d.logUpdate(p);var a=z.findTextRange(p);a&&y.selectRange(kc(a))}else{if(v)if(a=G.rangeRect(p,"overlay",!0),d.logUpdate&&d.logUpdate(p,a),!a)v.showSelectionRect(!1);else if(v.hasSelectionRect()){var c=v.selectionRect();c.move(a.left,a.top,a.width,a.height);c.show(b&&(!H||f)&&("rect"===p.type||"cell"===p.type))}}else y.clearSelection();G.select(p)&&G.update()};var aa=function(){y.clearSelection();
v&&v.showSelectionRect(!1);t=!1;b=!0;a=null;H=!1;N=J=Q=I=void 0;p=u=v=null;Ea();qa()};d.validateMode=function(a,c){G.isSelectionModeSupported(a)||("rect"===a?G.features().rectredaction&&"redaction"==OIT.highlights.autoHighlight()||(a=void 0):a=void 0);a||(c?a=d.validateMode(c):G.isSelectionModeSupported("text")?a="text":G.isSelectionModeSupported("rect")?a="rect":G.isSelectionModeSupported("cell")&&(a="cell"));return a};d.addAutoscrollRoot=function(a){n.push(y.wrap(a))};var Ba=function(a,c,d){if(c!=
na||d!=A){var b=w.viewNode;na=c;for(A=d;a&&-1==n.indexOf(a);){if(a===b||!(a instanceof T)){a=null;break}a=a.parent()}var e;a?(e=a.pos(b),c-=e.left,d-=e.top,e=a.clientWidth*x.zoom,b=a.clientHeight*x.zoom):(a=b,e=b.clientWidth,b=b.clientHeight);1>=c?(ba=c-1,-30<ba&&(ba=-30)):c>=e-1?(ba=c-(e-1),30>ba&&(ba=30)):ba=0;1>=d?(ia=d-1,-30<ia&&(ia=-30)):d>=b-1?(ia=d-(b-1),30>ia&&(ia=30)):ia=0;ba||ia?U||(U=sb(ma,100,null,a)):ka()}},ma=function(a){a.dscroll(ba,ia);D?d.extendTextSelection(na,A):d.extendRectSelection(na,
A)},ka=function(){U&&(Ua(U),U=void 0,ia=ba=0)};d.enableCellOffsets=function(a){h=!!a};d.bindSelectionToPage=function(a){q=!!a};aa();x.onselectionMode(function(a){d.select(null);(a=z.activeOverlay())&&a.updateCSS()});F.onreset(function(){d.reset();n=[]});G.ondisplayload(d.reset);ha.ondetach(function(){c=e=null;E&&(E.destroy(),E=null)});F.onzoom(function(a,c,b){d.update()})}}),$a=xa.extend("user",{events:{beginscroll:{},endscroll:{},beginpinchzoom:{},endpinchzoom:{}},install:function(d){var e=!1,b=
!1,a=!1,c=!1,f,h,q=null,t,u,v,p=null,l,m,H,I,Q,J,N,D,O,B=0,r=0,g=0,k=0;F.onload(function(){var a=w.rootNode;a.onmousedown(ba);a.onwheel(na);R.addEventListener("mouseup",ia,!1);R.addEventListener("keydown",C,!1);w.isMobileOrTablet&&(a=w.viewNode,a.kinetic(!0),a.ontap(Ba),a.onpress(ma),a.onpressup(ka),a.onpanstart(Ja),a.onpanmove(Cb),a.onpanend(L),a.onpancancel(L),a.onpinchstart(Mb),a.onpinchmove(ra),a.onpinchend(Db),a.onpinchcancel(Db),a.onrotatestart(Eb),a.onrotatemove(kb),a.onrotateend(Ra),a.onrotatecancel(Ra))});
F.onreset(function(){var a=w.rootNode;a&&(a.offmousedown(ba),a.offwheel(na));R.removeEventListener("mouseup",ia);R.removeEventListener("keydown",C);w.isMobileOrTablet&&(a=w.viewNode)&&(a.offtap(Ba),a.offpress(ma),a.offpressup(ka),a.offpanstart(Ja),a.offpanmove(Cb),a.offpanend(L),a.offpancancel(L),a.offpinchstart(Mb),a.offpinchmove(ra),a.offpinchend(Db),a.offpinchcancel(Db),a.offrotatestart(Eb),a.offrotatemove(kb),a.offrotateend(Ra),a.offrotatecancel(Ra))});var C=function(a){var c,b;d.logKeydown&&
d.logKeydown(a);if(d.isViewEventTarget(a.target)||e&&a.target==V.body){if((b=F.on.keydown.dispatch(a))&&!w.editingComment&&(b=G.keydown(a))){c=w.viewNode;var g=P.active(),n=0,f=0;switch(a.keyCode){case 33:G.features().pages&&(c.finishAnimation(),z.updateActivePage(),0<c.scrollTop?c.dscroll(void 0,-c.clientHeight):z.movetoPrev(),b=!1);break;case 34:G.features().pages&&(c.finishAnimation(),z.updateActivePage(),c.scrollTop<Math.max(c.clientHeight,c.scrollHeight,c.offsetHeight)-c.innerHeight?c.dscroll(void 0,
c.clientHeight):z.movetoNext(),b=!1);break;case 35:c.scroll(c.scrollWidth,c.scrollHeight);b=!1;break;case 36:c.scroll(0,0);b=!1;break;case 37:n=-1;break;case 38:f=-1;break;case 39:n=1;break;case 40:f=1;break;case 45:void 0!==g&&P.getOption(g,"enableUserComment")&&(P.showComment(g,{mode:"edit",removeOnCancel:!1}),b=!1);break;case 46:void 0!==g&&P.getOption(g,"enableUserDelete")&&(P.remove(),g=void 0,b=!1);break;case 48:a.ctrlKey&&(F.zoom(1),b=!1);break;case 187:a.ctrlKey&&(F.zoomIn(),b=!1);break;case 189:a.ctrlKey&&
(F.zoomOut(),b=!1)}if(n||f){var k;void 0!==g&&(c=P.range(g))&&(k=c.type);k||(k=x.selectionMode);if("cell"===k||"rect"===k)if(k=a.ctrlKey,void 0!==g){if(a.shiftKey){var E=c=0,r=0,m=0;b=x.rotation;switch(b){case 0:r=n;m=f;break;case 90:m=n;c=-f;break;case 180:c=-n;E=-f;break;case 270:E=-n,r=f}P.move(g,c,E,r,m,k)}else{b=x.rotation;if(0!==b)switch(c=n,E=f,b){case 90:n=-E;f=c;break;case 180:n=-c;f=-E;break;case 270:n=E,f=-c}P.move(g,n,f,n,f,k)}(c=P.range(g))&&z.moveto(c);b=!1}else b=a.shiftKey?!S.incrementSelection(n,
f,k):!S.moveAnchor(n,f,k)}}!1===b&&jb(a);return b}},K=function(a){(a.button||0)==Q&&(d.releaseMouseCapture(),d.on.endscroll.dispatch());Q=void 0},ba=function(g){e=!1;d.logMouse&&d.logMouse(g);if(!w.editingComment){var n=w.viewNode,f=n.mousePos(g);if(d.isViewEventTarget(g.target)){var k=g.button||0,E=n.inRect(f.x,f.y);if(1==k||0===k&&!E)d.on.beginscroll.dispatch(),Q=k,d.setMouseCapture(null,K);else{E=!0;n.focus();e=!0;if(0===k){n=x.selectionMode;if("rect"===n||"cell"===n)S.startRectSelection(f.x,f.y,
g)&&(a=!0,d.setMouseCapture(Ea)),E=!1;else if("text"==n){var r,n=1;if(void 0!==l){var h;if(g.pageX||g.pageY)r=g.pageX,h=g.pageY;else if(g.clientX||g.clientY)r=g.clientX,h=g.clientY;r=Math.abs(r-m.x);h=Math.abs(h-m.y);3>=r&&3>=h&&((new Date).getTime()-l<=x.doubleClickInterval&&(n=H+1),l=void 0)}r=n;var C;2===r?C="word":r=1;if(S.startTextSelection(f.x,f.y,C,g))if(c=!0,d.setMouseCapture(qa),f=r,l=(new Date).getTime(),H=f,g.pageX||g.pageY)m={x:g.pageX,y:g.pageY};else if(g.clientX||g.clientY)m={x:g.clientX,
y:g.clientY};E=!1}b=!0}!1===E&&jb(g);return E}}}},ia=function(e){var g;d.logMouse&&d.logMouse(e);if(h)g=h.call(q,e);else if(b){g=!0;if(!w.editingComment){var n=w.viewNode.mousePos(e);0===(e.button||0)&&(a?(a=!1,d.releaseMouseCapture(),S.endRectSelection(n.x,n.y,e)):(c&&(c=!1,d.releaseMouseCapture()),S.endTextSelection(n.x,n.y,e)),g=!1)}b=!1}!1===g&&jb(e);return g},na=function(a){if(!w.editingComment&&d.isViewEventTarget(a.target))if(a.ctrlKey){if(!x.browserZoom)return 0<a.wheelDelta?OIT.document.zoomIn():
0>a.wheelDelta&&OIT.document.zoomOut(),jb(a),!1}else d.on.beginscroll.dispatch(),void 0!==I&&sa(I),I=ca(A,500)},A=function(){I=void 0;d.on.endscroll.dispatch()};d.setMouseCapture=function(a,c,b){d.releaseMouseCapture();"function"===typeof a&&(R.addEventListener("mousemove",U,!0),f=a);"function"===typeof c&&(h=c);if(f||h)y.body.onmouseover(n),y.body.onmouseout(E);q=b};var U=function(a){if(f&&!1===f.call(q,a))return jb(a),!1},n=function(a){if(J){var c=aa(a);if(c!==J.buttons&&J.buttons&1&&!(c&1)){var c=
J,b;V.createEvent?(b=V.createEvent("MouseEvent"),b.initMouseEvent("mouseup",!0,!0,R,null,c.screenX,c.screenY,c.clientX,c.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.relatedTarget)):b=new MouseEvent("mouseup",{screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:0,buttons:a.buttons,relatedTarget:a.relatedTarget,region:a.region});ia(b)}J=void 0}},E=function(a){J={buttons:aa(a),screenX:a.screenX,
screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}};d.releaseMouseCapture=function(){f&&(R.removeEventListener("mousemove",f,!1),f=null);h=null;y.body.offmouseover(n);y.body.offmouseout(E)};d.setTouchCapture=function(a,c,b,e){d.releaseTouchCapture();"function"===typeof a&&(y.listen("touchmove",ja,{capture:!0,passive:!1}),t=a);"function"===typeof c&&(y.listen("touchend",X,{capture:!0,passive:!1}),u=c);"function"===typeof b&&(y.listen("touchcancel",oa,{capture:!0,passive:!1}),v=b);p=e};var ja=function(a){t&&
t.call(p,a)},X=function(a){u&&u.call(p,a)},oa=function(a){v&&v.call(p,a)};d.releaseTouchCapture=function(){t&&(y.unlisten("touchmove",ja,!1),t=null);p=v=u=null};var Ea=function(c){if(a){var b=w.viewNode.mousePos(c);S.extendRectSelection(b.x,b.y,c);return!1}return!0},qa=function(a){if(c){var b=w.viewNode.mousePos(a);S.extendTextSelection(b.x,b.y,a);return!1}return!0};d.isViewEventTarget=function(a){for(var c=w.viewNode;a;){if(c.equals(a))return!0;if("TEXTAREA"===a.tagName||"SELECT"===a.tagName||"VIDEO"===
a.tagName||"AUDIO"==a.tagName)break;if("oit-em_allheaders"===a.id)break;if(y.hasClass(a,"oit-emheadervalues")||y.hasClass(a,"oit-em_allheaders")||y.hasClass(a,"oit-note-icons")||y.hasClass(a,"oit-ssoverlay"))return!0;if(y.hasClass(a,"oit-button")||y.hasClass(a,"oit-note")||y.hasClass(a,"oit-expander"))break;a=a.parentNode}return!1};var aa=function(a){var c;if(void 0!==a.buttons)c=a.buttons;else switch(a.button){case 0:c=1;break;case 1:c=4;break;case 2:c=2;break;case 3:c=8;break;case 4:c=16}return c},
Ba=function(a){"text"===S.selectionType()&&S.select(null);z.deactivateAnnotation();var c=a.center;P.activateNearest(c.x,c.y,a.srcEvent)},ma=function(b){e=!1;if(!w.editingComment){var d=b.center;w.viewNode.focus();e=!0;var g=x.selectionMode;"rect"===g||"cell"===g?(a=!0,S.startRectSelection(d.x,d.y)):"text"==g&&S.startTextSelection(d.x,d.y,"word",b)&&(c=!0)}},ka=function(b){var d;if(a||c)a?(a=!1,d=b.center,S.endRectSelection(d.x,d.y,b.srcEvent)):c&&(c=!1,d=b.center,S.endTextSelection(d.x,d.y,b.srcEvent))},
Ja=function(a){a.press||(a=w.viewNode,N=a.scroll(),r=B=0,g=a.scrollWidth-a.clientWidth,k=a.scrollHeight-a.clientHeight,G.startElasticScroll())},Cb=function(b){if(b.press)a?(b=b.center,S.extendRectSelection(b.x,b.y)):c&&(b=b.center,S.extendTextSelection(b.x,b.y));else if(N){var d=w.viewNode,e=b.delta,n=N.left-e.x,e=N.top-e.y,f=fa(n,0,g),E=fa(e,0,k);d.autoscroll(f,E);b.kinetic||(B=n-f,r=e-E,(B||r)&&G.elasticScroll(B,r))}},L=function(a){a.press||(N=void 0,G.endElasticScroll(B,r),r=B=0)},Mb=function(a){D=
x.zoom;d.on.beginpinchzoom.dispatch()},ra=function(a){D&&F.zoom(D*a.scale,a.center,!0)},Db=function(a){D=void 0;d.on.endpinchzoom.dispatch()},Eb=function(a){O=x.rotation},kb=function(a){if(void 0!==O){var c=O;a=$b(180*a.rotation/Math.PI,"deg");60<a&&300>a&&(c=135>a?c+90:225>a?c+180:c+270);F.rotate(c)}},Ra=function(a){O=void 0}}}),ga=xa.extend("content",{events:{data:{},add:{},first:{},last:{}},install:function(d){var e=!1,b=!0,a=!1,c=[],f=[],h,q,t,u=0,v=!1,p=!1,l=null,m=[],H=function(){h&&(h.hide(),
h=null)},I=function(a){a&&(f.push({data:a}),e&&!t&&(t=ca(g,0)),(a=c.shift())&&a.destroy())},Q=function(a){a={url:a,cache:!0,retryDelay:0,pendingText:""};a.ajax=Ma({url:a.url,cache:a.cache,complete:O,args:[a]});f.push(a)};d.isPending=function(){return 0<f.length||0<m.length||!w.documentComplete};d.manifest=function(){return l};d.initializeContent=function(a,c,b){OIT.content&&(I(OIT.content),delete OIT.content);b?(w.singlePageIndex=Number(b),c&&w.dynamicContent&&N(c)):c?(w.dynamicContent=!0,N(c)):a&&
"none"!==a&&(w.dynamicContent=!0,D(a));e=!0;0<f.length&&!t&&(t=ca(g,0))};var J=function(a){if(!q&&a){if((void 0===x.outputBaseUrl||null===x.outputBaseUrl||""===x.outputBaseUrl)&&x.detectBaseUrl&&"/"!=a[0]&&0!==a.search(/http/i)){var c=w.URL.lastIndexOf("/");if(-1!=c){c=w.URL.substr(0,c+1);if(0===c.search(/http/i)){var b=V.createElement("a");b.href=c;c=b.pathname||b.pathName;"/"!=c[0]&&(c="/"+c)}0!==a.indexOf(c)&&(w.baseURL=c||null)}}q=w.baseURL}return q},N=function(a){if(a){var b=J(a);b&&"/"!=a.charAt(0)&&
(a=Qa(b,a));0===w.URL.indexOf("file://")?(b=y.create("script"),b.attr("src",a),y.head.append(b),c.push(b)):Q(a)}},D=function(a){if(a&&"none"!==a){var c=J(a);c&&"/"!=a.charAt(0)&&(a=Qa(c,a));Q(a)}},O=function(a,c,e,g,k){k.status=g;404===g&&(e="");200===g||404==g?0===e.length||0===e.indexOf("%")?(e!==k.pendingText&&(k.pendingText=e,k.retryDelay=0),k.retryDelay>x.contentTimeout?(H(),d.logAJAXError(null,"Timed out while loading the document content data from the server",a,Yb),lb(),f=[]):(b&&(h||(h=ya.createProgressDialog(M.PLEASE_WAIT_INITIALIZING,
!1))),k.cache=!1,k.retryDelay+=200,ca(function(){k.ajax=Ma({url:k.url,cache:k.cache,complete:O,args:[k]})},200))):(B(k,e),H()):(H(),d.logAJAXError(null,"Failed to load the document content data from the server",a,g,e),lb(),f=[])};d.isICD=function(a){return"if(window.OIT&&OIT.icd)OIT.icd("==a.substring(0,31)};var B=function(a,c){var b,e=c.indexOf("else OIT.content={");-1!=e?(e+=18,b=c.lastIndexOf("}"),-1!=b&&(c="{"+c.substring(e,b)+"}")):d.isICD(c)&&(e=31,b=c.lastIndexOf(");"),-1!=b&&(c=c.substring(e,
b)));try{var f=JSON.parse(c);a.data=f;t||(t=ca(g,0))}catch(A){d.logAJAXError(null,"Document data is corrupt ("+A+")",a.url,a.status,c)}},r=function(a){Ma({url:a,complete:function(a,c,b,e){if(200==e)try{l=JSON.parse(b);var f=l.files?l.files.content:null;if(f){for(c=1;c<f.length;c++)m.push(f[c].url);g()}}catch(U){d.logAJAXError(null,"The document manifest is corrupt ("+U+")",a,e,b),p=!1,l=null}else d.logAJAXError(null,"Failed to load the document manifest from the server",a,e,b),p=!1,l=null}})},g=function(){t=
void 0;if(e&&!v&&0<f.length&&f[0].data){for(var c=b;0<f.length&&f[0].data;){var g=f.shift();if(g.data.info&&g.data.info.manifest&&w.dynamicContent){var h=g.data.info.manifest,l=J(h);l&&"/"!=h.charAt(0)&&(h=Qa(l,h));r(h);p=!0}k(g.data);b=!1;void 0===w.singlePageIndex?g.data.nextContent?p||N(g.data.nextContent):g.data.nextData?p||D(g.data.nextData):a=!0:a=!0}c&&d.on.first.dispatch();d.on.add.dispatch();a&&d.on.last.dispatch()}for(;20>f.length&&0<m.length;)D(m.shift())},k=function(a){if(a){if(a.info&&
a.info.version){var c=a.info.version.split("."),e=parseInt(c[0],10),g=parseInt(c[1],10),c=parseInt(c[2],10);0<e&&0<=g&&9>=g&&0<=c&&9>=c&&(u=e+g/10+c/100)}d.on.data.dispatch(a,b,u)}};d.processICD=function(a,c,b){if(d.isICD(a)){var e=a.lastIndexOf(");");if(-1!=e){a=a.substring(31,e);try{a=JSON.parse(a),k(a)}catch(na){d.logAJAXError(null,"ICD data is corrupt ("+na+")",c,b,a)}}}};F.onreset(function(){t&&sa(t);H();e=!1;b=!0;a=!1;c=[];f=[];t=q=h=void 0;u=0;p=v=!1;l=null;m=[];w.singlePageIndex=void 0;d.on.add.reset()});
$a.onbeginscroll(function(){v=!0});$a.onendscroll(function(){v=!1;g()});pb("icd",I)}}),F=xa.extend("document",{exports:"cellRange cellSelection externalData externalValue find findAll getOptions getRawText getSelectedText highlight print properties rectRange rectSelection removeExtraEmailHeaders rotate select selection selectionMode selectionStyle selectionType setOptions showHidden textRange textSelection updateViewSize zoom zoomIn zoomOut".split(" "),events:{load:{pub:!0,detail:function(){return{url:w.URL}},
onAdd:function(d,e){w.documentLoaded&&ca(function(){d.dispatchTo(e)},0)}},reset:{},unload:{pub:!0},zoom:{pub:!0,detail:function(d,e,b){return{zoom:d,mode:e}}},rotate:{pub:!0,detail:function(d){return{angle:d}}},resize:{},idle:{pub:!0,onListen:function(){F.resetIdleTimer()},onUnlisten:function(){F.resetIdleTimer()},onAdd:function(){F.resetIdleTimer()},onRemove:function(){F.resetIdleTimer()}},error:{pub:!0,detail:function(d,e){return{message:d,fatal:!!e}}},select:{pub:!0,detail:function(d,e,b,a,c){d=
{selection:d,empty:a};e&&b&&(d.start=e,d.end=b);void 0!==c&&(d.highlightid=c);return d}},scroll:{pub:!0,detail:function(d,e,b,a){e=w.viewNode;d=z.mapToPage(0,0);e=z.mapToPage(e.clientWidth,e.clientHeight);return d&&e?{viewUpperLeft:{pageIndex:d.page.index,x:d.x,y:d.y},viewLowerRight:{pageIndex:e.page.index,x:e.x,y:e.y}}:{viewUpperLeft:{pageIndex:0,x:0,y:0},viewLowerRight:{pageIndex:0,x:0,y:0}}}},scrollupdate:{delay:200},keydown:{pub:!0,detail:function(d){return{srcEvent:d}}},optionschanged:{pub:!0,
detail:function(d){return d}},showmessage:{pub:!0,detail:function(d,e,b){return{message:d||"",modal:e||!1,progress:b||!1}}},progress:{pub:!0,detail:function(d){return{percentDone:d||0}}},hidemessage:{pub:!0},done:{pub:!0},hiddencontent:{pub:!0,detail:function(d,e){var b={},a,c;for(c=0;c<e.length;c++)a=e[c],a.supported&&d[a.name]&&(x[a.option]!==a.optionValue?(b.supportedNotVisible||(b.supportedNotVisible=[]),b.supportedNotVisible.push(M[a.message])):(b.supportedVisible||(b.supportedVisible=[]),b.supportedVisible.push(M[a.message])));
for(c=0;c<e.length;c++)a=e[c],!a.supported&&d[a.name]&&(b.unsupported||(b.unsupported=[]),b.unsupported.push(M[a.message]));return b}},ajax:{pub:!0,single:!0,detail:function(d){return{request:d}}},ajaxabort:{pub:!0,single:!0,detail:function(d){return{request:d}}},highlight:{pub:!0,detail:function(d,e,b,a){return{highlights:d,searchTerm:e,style:b,properties:a}}}},install:function(d){var e=[.1,.25,.5,.75,1,1.25,1.5,2,3,5,10,20,40],b=e[0],a=e[e.length-1],c=["rows","columns","all","none"],f=[{name:"hidden-pages",
supported:!0,message:"HIDDEN_CONTENT_PAGES",option:"showHiddenSheets",optionValue:!0},{name:"hidden-columns",supported:!0,message:"HIDDEN_CONTENT_COLUMNS",option:"showHiddenColumns",optionValue:!0},{name:"hidden-rows",supported:!0,message:"HIDDEN_CONTENT_ROWS",option:"showHiddenRows",optionValue:!0},{name:"hidden-text",supported:!0,message:"HIDDEN_CONTENT_TEXT",option:"showAnnotations",optionValue:!0},{name:"comments",supported:!0,message:"HIDDEN_CONTENT_COMMENTS",option:"showAnnotations",optionValue:!0},
{name:"tracked-changes",supported:!0,message:"HIDDEN_CONTENT_TRACKED_CHANGES",option:"showAnnotations",optionValue:!0},{name:"speaker-notes",supported:!0,message:"HIDDEN_CONTENT_SPEAKER_NOTES",option:"showSlideNotes",optionValue:!0},{name:"hidden-slides",supported:!0,message:"HIDDEN_CONTENT_SLIDES",option:"presentationMode",optionValue:"normal"},{name:"comments-unsupported",supported:!1,message:"HIDDEN_CONTENT_COMMENTS"},{name:"hidden-text-unsupported",supported:!1,message:"HIDDEN_CONTENT_TEXT"},
{name:"tracked-changes-unsupported",supported:!1,message:"HIDDEN_CONTENT_TRACKED_CHANGES"},{name:"large-sheet-unsupported",supported:!1,message:"HIDDEN_CONTENT_LARGE_SHEET"}],h=!1,q,t,u,v=!1,p=0,l,m,H={},I={},Q,J,N,D={},O,B=[],r={},g,k=!1,C,K=0,ba,ia=[],na=0;d.properties=function(){if(w.documentLoaded)return Wa(H)};d.externalValue=function(a){if(w.documentLoaded)return I[a]};d.externalData=function(){if(w.documentLoaded)return I};d.revisions=function(){return ba};d.getOptions=function(a){if(void 0===
a){a=x.items();var c={},b;for(b in a)x.isPublic(b)&&(c[b]=x[b]);c.showSlideComments=c.showAnnotations;return c}if(a&&"string"==typeof a&&("showSlideComments"===a&&(a="showAnnotations"),x.isPublic(a)))return x[a]};d.setOptions=function(a){if(a){for(var c in a){"showSlideComments"===c&&(c="showAnnotations");var b=a[c];x.isPublic(c)&&x[c]!=b&&(x[c]=b)}F()}};$a.onbeginpinchzoom(function(a,c){h=!0});$a.onendpinchzoom(function(){h=!1;d.dispatchPageEvents(!0);gb()});var A=function(c){c<b?c=b:c>a&&(c=a);
return c};d.zoom=function(a,c,b){if("number"===typeof a){var e=A(a);e!=a&&(b||d.invalidArg("zoom","zoom",a,"using fallback zoom factor "+e,!1),a=e);if(x.zoomMode||a!=x.zoom)x.zoom=a,x.zoomMode=null,d.dispatchPageEvents(!1,c)}else"string"===typeof a?a!=x.zoomMode&&(x.zoomMode=a,d.dispatchPageEvents(!1,c)):"undefined"===typeof a||b||d.invalidArg("zoom","zoom",a);return x.zoom};d.zoomIn=function(){for(var a=0;a<e.length;a++)if(e[a]>x.zoom){d.zoom(e[a]);break}return x.zoom};d.zoomOut=function(){for(var a=
e.length-1;0<=a;a--)if(e[a]<x.zoom){d.zoom(e[a]);break}return x.zoom};d.rotate=function(a){"number"===typeof a?x.rotation=$b(a,"deg"):void 0!==a&&d.invalidArg("rotate","angle",a,"Angle must be an integer multiple of 90 degrees.");return x.rotation};d.showHidden=function(a){w.documentLoaded&&!w.documentUnloading&&G.features().showhidden&&(void 0!==a&&-1==c.indexOf(a)?d.invalidArg("showHidden","mode",a,"Must be one of "+JSON.stringify(c)):G.showHidden(a))};var U=[{name:"searchTerm",type:["string","RegExp"],
req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"direction",type:"string",legal:["up","down"],def:"down"},{name:"startACC",type:"number"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];d.find=function(a,c,b,e,g){if(w.documentLoaded&&!w.documentUnloading){var n=d.processArguments("find",arguments,U);n&&ca(qa,0,{finder:Z.findStart(n.searchType,n.searchTerm,n.caseSensitive,n.direction,
g),callbackFn:n.callbackFn})}};var n=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"searchType",type:"string",legal:"string dtsearch lucene phsterms literal literal*".split(" "),def:"string"}];d.findAll=function(a,c,b){if(w.documentLoaded&&!w.documentUnloading){var e=d.processArguments("findAll",arguments,n);e&&d.findAllArgs(e)}};d.findAllArgs=function(a){w.documentLoaded&&!w.documentUnloading&&a&&
d.on.idle.listenOnce({finder:Z.findStart(a.searchType,a.searchTerm,a.caseSensitive),callbackFn:function(c){var b=!0;if(!c){if(a.callbackFn)try{a.callbackFn.call(null)}catch(kb){d.logError("findAll","Exception in callback function: "+kb)}b=!1}else if(a.callbackFn)try{var e=Z.getRawText(c.range.acc,c.range.accend),b=a.callbackFn.call(null,c.range,e)}catch(kb){d.logError("findAll","Exception in callback function: "+kb),b=!1}!1!==b&&(b=!0);return b},startIterationFn:null,endIterationFn:null},aa)};d.getRawText=
function(a){w.documentLoaded&&(Ga(a)?ca(Ba,0,{callbackFn:a,textBlockIndex:0}):d.invalidArg("getRawText","callbackFunction",a,"must be a function"))};var E=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"style",type:"string",req:!0},{name:"callbackFn",type:"function"},{name:"caseSensitive",type:"boolean",def:!0},{name:"properties",type:"object"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];d.highlight=function(a,c,b,
e,g){if(w.documentLoaded)if(!1===Z.hasRawText())d.logError("highlight","Search functionality has been disabled for this document");else if(P)if(!1===G.features().highlights)d.logError("highlight","Highlighting functionality is not available for this document type");else{var n;"object"===typeof c?(n=c,n={searchTerm:a,style:n.style,searchType:n.mode||"string",properties:n.properties,callbackFn:n.callbackFn,caseSensitive:!1!==n.caseSensitive,visible:!1!==n.visible,enableUserDelete:!1!==n.enableUserDelete,
enableUserMove:!1!==n.enableUserMove,enableUserResize:!1!==n.enableUserResize,enableUserComment:!1!==n.enableUserComment,stemAll:!0===n.stemAll,stemmer:n.stemmer}):n=d.processArguments("highlight",arguments,E);n&&(5>na?d.highlightArgs(n):ia.push(n))}else d.logError("highlight","Highlighting functionality has been disabled for this document")};d.highlightArgs=function(a){w.documentLoaded&&a&&(na++,a.batchStarted=!1,a.highlights=[],a.complete=!1,a.iteration=0,R.performance&&"function"===typeof performance.now&&
(a.startTime=performance.now()),d.on.idle.listenOnce({finder:Z.findStart(a.searchType,a.searchTerm,a.caseSensitive,"down",void 0,a.stemAll,a.stemmer),callbackFn:function(c){var b=!0;if(c){var e;if(c.terms){e=[];for(var g=0;g<c.terms.length;g++)e.push(c.terms[g].range);e=P.add(a.style,e,a.properties)}else e=P.add(a.style,c.range,a.properties);if(void 0!==e)for(Array.isArray(e)||(e=[e]),g=0;g<e.length;g++){var n=e[g];if(-1==a.highlights.indexOf(n)){a.highlights.push(n);!1===a.visible&&P.hide(n);if(!1===
a.enableUserDelete||!1===a.enableUserMove||!1===a.enableUserResize||!1===a.enableUserComment){var f={};!1===a.enableUserDelete&&(f.enableUserDelete=!1);!1===a.enableUserMove&&(f.enableUserMove=!1);!1===a.enableUserResize&&(f.enableUserResize=!1);!1===a.enableUserComment&&(f.enableUserComment=!1);P.setOptions(n,f)}if(a.callbackFn)try{var k=Z.getRawText(c.range.acc,c.range.accend),b=a.callbackFn.call(null,c.range,n,a.highlights,a.searchTerm,a.style,a.properties,k)}catch(lc){d.logError("findAll","Exception in callback function: "+
lc),b=!1}}}}else{c=["Highlight term '",a.searchTerm,"': ",a.highlights.length," hits, "];R.performance&&"function"===typeof performance.now&&(b=L(performance.now()-a.startTime,10),c.push(b,"ms, "));c.push("searchType='",a.searchType,"', stemAll=",a.stemAll,", stemmer=",a.stemmer,", style='",a.style,"', caseSensitive=",a.caseSensitive,", visible=",a.visible,", terms remaining="+(ia.length+na-1));console.log(c.join(""));if(a.callbackFn)try{a.callbackFn.call(null,null,null,a.highlights,a.searchTerm,
a.style,a.properties)}catch(lc){d.logError("findAll","Exception in callback function: "+lc)}b=!1}!1!==b&&(b=!0);b||(a.batchStarted&&P.endBatch(),a.complete=!0,d.on.highlight.dispatch(a.highlights,a.searchTerm,a.style,a.properties),0<na&&na--,5>na&&0<ia.length&&(a=ia.shift(),d.highlightArgs(a)));return b},startIterationFn:function(c){G.suspendUpdate();a.iteration++},endIterationFn:function(){!a.complete&&!a.batchStarted&&2<=a.iteration&&(P.beginBatch(),a.batchStarted=!0);G.resumeUpdate()}},aa))};d.select=
function(a,c){if(w.documentLoaded){var b=!1;if(!1===Z.hasRawText())d.logError("select","Javascript selection functionality has been disabled for this document");else if(null===a)b=S.select(null);else if(Ka(a)||Ia(a))b=S.select(a);else{var e=wa(a,!0,!0);e?(b=d.selection(),b=0!==Xa(e,b),!1!==c?z.movetoEx(e,{callbackFn:function(){S.select(e)},animate:!1}):S.select(e)):d.invalidArg("select","range",a,"must be a valid text range, cell range, or rect range")}return b}};d.selectionType=function(){if(w.documentLoaded)return S.selectionType()};
d.selectionMode=function(a){a&&(x.selectionMode=a);return x.selectionMode};d.selectionStyle=function(a){var c;void 0!==a&&null!==a&&"string"!==typeof a?d.invalidArg("selectionStyle","style",a,"Must be a valid CSS string"):c=S.style(a);return c};d.selection=function(){var a;if(w.documentLoaded)switch(S.selectionType()){case "text":a=S.textSelection();break;case "cell":a=S.cellSelection();break;case "rect":a=S.rectSelection()}return a};d.textSelection=function(){if(w.documentLoaded)return S.textSelection()};
d.cellSelection=function(){if(w.documentLoaded)return S.cellSelection()};d.rectSelection=function(){if(w.documentLoaded)return S.rectSelection()};d.getSelectedText=function(){if(w.documentLoaded)return G.getSelectedText()};d.textRange=function(){return pa.apply(this,arguments)};d.cellRange=function(){return ta.apply(this,arguments)};d.rectRange=function(){return Fb.apply(this,arguments)};d.updateViewSize=function(){ha.dispatchResize()};var ja=function(){if(G.features().fitpage){var a=90==x.rotation||
270==x.rotation,c,b=G.padding();c=G.margin();var d=b.left+b.right+c.left+c.right,b=b.top+b.bottom+c.top+c.bottom;a?(a=G.maxPageHeight(),c=G.maxPageWidth()):(a=G.maxPageWidth(),c=G.maxPageHeight());var a=a+z.annotationPaneWidth(),e=w.viewNode;return{w:A((e.clientWidth-d)/a),h:A((e.clientHeight-b)/c)}}};d.dispatchPageEvents=function(a,c){!1!==a&&(a=!0);if(w.documentLoaded&&!k){var b;if(x.zoomMode){var e=1;if(b=ja()){switch(x.zoomMode){case "page":e=Math.min(b.w,b.h);break;case "pagewidth":e=b.w;break;
case "pageheight":e=b.h;break;case "mobile":switch(w.deType){case "page":e=b.h<b.w&&b.h>=.9*b.w?b.h:b.w;break;case "drawing":e=(e=ha.infoRaw())&&1557===e.fi?b.w:Math.min(b.w,b.h);break;case "slide":case "chart":case "bitmap":e=Math.min(b.w,b.h)}}e=A(e)}x.zoom=e}else if(w.nochrome||w.isMobile)if(b=ja())b=Math.min(b.w,b.h),x.zoom<b&&(x.zoom=b);b=x.zoom;var e=Q!=b||J!=x.zoomMode,g=N!=x.rotation;if(a||e||g)G.layoutChanged(c),ha.invalidateCanvas(),w.drawing&&w.drawing.update(!0);if(a||e)Q=b,J=x.zoomMode,
d.on.zoom.dispatch(b,x.zoomMode,h);if(a||g)N=x.rotation,d.on.rotate.dispatch(x.rotation);ha.dispatchScroll(a)}};var X=function(){d.dispatchPageEvents(!0)};d.pauseIdleTimer=function(a){p++;1==p&&d.resetIdleTimer()};d.resumeIdleTimer=function(a){0<p&&(p--,0==p&&d.resetIdleTimer())};d.resetIdleTimer=function(){var a;q&&(sa(q),q=null);t&&(Ua(t),t=null);d.on.idle.hasListeners()&&w.documentLoaded&&!w.documentUnloading&&0===p?(v||(a=d.resetIdleTimer,y.listen("mousemove",a,!0),y.listen("touchmove",a,!0),
y.listen("keydown",a,!0),d.onscroll(a),v=!0),q=ca(function(){t=sb(function(){d.on.idle.dispatch(!1)},50,d.on.idle)},200),u||(u=sb(function(){d.on.idle.dispatch(!0)},200,d.on.idle))):(u&&(Ua(u),u=null),a=d.resetIdleTimer,y.unlisten("mousemove",a),y.unlisten("touchmove",a),y.unlisten("keydown",a),d.offscroll(a))};var oa=function(){var a=G.pageRect(z.count()-1,"overlay");a&&(a=a.bottom-20*(z.count()-1),d.printCSS(".oit-view-root","height:"+a+"px;"));for(;void 0!==K;)if(z.on.change.disable(),a=z.page(K))if(a.overlay&&
!a.overlay.isHidden()){a.load(!0,Ea);K=void 0;break}else K++;else{if(!w.documentComplete)break;d.logFatalError(null,"No visible pages were found in the document");K=void 0;break}},Ea=function(a){z.moveto(a.index);w.documentLoaded=!0;d.on.load.dispatch();w.documentLoading=!1;z.on.change.enable();z.dispatchChange(void 0,!0);d.dispatchPageEvents(!0);w.documentComplete&&d.on.done.dispatch();d.resetIdleTimer()};d.installDocument=function(a,c){var b=!0,e=y.create("div");e.html(c);(e=e.byClass("oit-view-root"))&&
0<e.length&&(e=e[0]);var g,n,f;e&&(g=e.data("icd"),n=e.data("json"),f=e.data("page"));if(!g&&!n||"none"==n)b="This document can't be loaded into the web view.",ha.logFatalError("load","none"==n?b+" \nThe html file must be created in Ajax mode.":b+" \nThe html file does not appear to have been created by Web View Export.",c),b=!1;else{if(vc(a)){var e=V.URL,k=e.indexOf("//");if(-1===k)w.URL=a;else{var k=k+2,E=e.lastIndexOf("/"),e=-1!=E&&E>k?e.substr(0,E+1):e+"/";"/"===a[0]&&(k=e.indexOf("/",k)+1,e=
e.substr(0,k));w.URL=Qa(e,a)}}else w.URL=a;ga.initializeContent(n,g,f);d.initializeDocument()}return b};d.unload=function(){var a=w.documentLoaded;w.documentUnloading=!0;G.suspendUpdate();d.resetIdleTimer();try{G.unloadDisplay()}catch(ra){d.logError("unload","Error while unloading display ("+ra+")")}w.documentLoaded=!1;w.documentComplete=!1;w.hasHiddenText=!1;w.hasWorksheetRevisions=!1;try{S.reset()}catch(ra){d.logError("unload","Error while resetting selection ("+ra+")")}try{P.clear()}catch(ra){d.logError("unload",
"Error while clearing highlights ("+ra+")")}try{fc()}catch(ra){d.logError("unload","Error while aborting timers ("+ra+")")}try{lb()}catch(ra){d.logError("unload","Error while aborting AJAX requests ("+ra+")")}try{d.on.reset.dispatch()}catch(ra){d.logError("unload","Error while resetting view ("+ra+")")}a&&d.on.unload.dispatch();x.zoom=1;x.zoomMode=null;h=!1;K=0;q&&(Ua(q),q=null);t&&(Ua(t),t=null);u&&(Ua(u),u=null);p=0;H={};I={};B=[];w.documentLoading=!1;r={};k=!1;ba=null;g&&(g.destroy(),g=null);C&&
(C.destroy(),C=null);w.drawing&&(w.drawing.destroy(),w.drawing=void 0);l&&(l.destroy(),l=void 0);m&&(m.destroy(),m=void 0);(a=w.viewNode)&&a.html("");w.URL=V.URL;ga.onadd(oa);w.documentUnloading=!1;G.resumeUpdate()};d.initializeDocument=function(){w.viewNode&&(w.drawing=new bd(w.viewNode),m=new tb("screen"),0<z.count()&&d.updateViewSize())};d.screenCSS=function(a,c){if(m)if(null===c)m.deleteRule(a);else if("string"==typeof c)m.setRule(a+"{"+c+"}",a);else if("object"==typeof c){var b=a+"{",d;for(d in c)b+=
d+":"+c[d]+";";m.setRule(b+"}",a)}};d.printCSS=function(a,c){l||(l=new tb("print"));if(null===c)l.deleteRule(a);else if("string"==typeof c)l.setRule(a+"{"+c+"}",a);else if("object"==typeof c){var b=a+"{",d;for(d in c)b+=d+":"+c[d]+";";l.setRule(b+"}",a)}};var qa=function(){var a=Z.findNext(this.finder);if(a||!ga.isPending()&&!Z.isPending()){if(a){var c=Z.getRawText(a.range.acc,a.range.accend);this.callbackFn.call(null,a.range,c)}else this.callbackFn.call(null);ga.offadd(qa);Z.offadd(qa)}else ga.onadd(this,
qa),Z.onadd(this,qa)},aa=function(){var a=!0,c=!1;if(!this.aborted){this.curACC||(this.curACC=0);if(this.startIterationFn){var b=100*this.curACC/Z.lastACC();this.startIterationFn(b)}var e;R.performance&&(e=R.performance.now());for(b=0;;b++){var g=Z.findNext(this.finder);if(g){if(this.curACC=g.range.acc,!1===this.callbackFn.call(null,g)){a=!1;c=!0;break}}else{ga.isPending()||Z.isPending()||(this.callbackFn.call(null),c=!0);a=!1;break}if(20<=b)if(void 0!==e){if(0==b%20&&50<R.performance.now()-e)break}else if(100<=
b)break}if(a)d.on.idle.listenOnce(this,aa);else if(c)ga.offadd(this,aa),Z.offadd(this,aa),this.aborted=!0;else if(ga.isPending()||Z.isPending())ga.onadd(this,aa),Z.onadd(this,aa);this.endIterationFn&&this.endIterationFn()}},Ba=function(){for(var a=!0,c=!1,b=0;10>b;b++){var d=Z.getRawTextBlock(this.textBlockIndex);if(d)if(d.text){var e=d.text,g=d.range.acc;if(void 0!==this.acc){var n=this.acc-d.range.acc;0<n&&(e=e.substring(n),g+=n)}this.acc=d.range.accend;if(!1===this.callbackFn.call(null,e,g)){a=
!1;c=!0;break}this.textBlockIndex++}else{a=!1;break}else{ga.isPending()||(this.callbackFn.call(null),c=!0);a=!1;break}}a?ca(Ba,50,this):c?(ga.offadd(Ba),Z.offadd(Ba)):(ga.onadd(this,Ba),Z.onadd(this,Ba))};d.removeExtraEmailHeaders=function(){x.removeExtraEmailHeaders=!0};d.externalLinks=function(){return B};var ma=function(a,c){k=!0;d.setOptions({showHiddenSheets:c,showHiddenColumns:c,showHiddenRows:c,showAnnotations:c,showSlideNotes:c,presentationMode:c?"normal":"slideshow"});k=!1;z.updateShowSlideNotes();
d.dispatchPageEvents(!0);ka();g.collapse();return!1};d.supressHiddenContentUpdate=function(){return k};var ka=function(){var a,c;if("none"===x.showHiddenContentNotification)g&&g.css("display","none");else if(!w.staging&&g&&!k){var b=[],d=!1,e=!1;for(c=0;c<f.length;c++)a=f[c],a.supported&&r[a.name]&&(b.push("<li>",M[a.message],"</li>"),x[a.option]!==a.optionValue?d=!0:e=!0);var n=[];0<b.length&&(n.push(M.HIDDEN_CONTENT_NOTIFICATION,"<div><ul>"),Array.prototype.push.apply(n,b),n.push("</ul>"),d?n.push(M.HIDDEN_CONTENT_INVISIBLE,
'</div><div><a class="oit-showhiddenlink">',M.HIDDEN_CONTENT_SHOWLINK,"</a></div>"):n.push(M.HIDDEN_CONTENT_ALREADY_VISIBLE,'</div><div><a class="oit-hidehiddenlink">',M.HIDDEN_CONTENT_HIDELINK,"</a></div>"));var b=[],E=!1;for(c=0;c<f.length;c++)a=f[c],!a.supported&&r[a.name]&&(b.push("<li>",M[a.message],"</li>"),E=!0);0<b.length&&(0<n.length&&n.push("<div>&nbsp;</div>"),n.push(M.HIDDEN_CONTENT_ORIGINAL_APPLICATION,"<div><ul>"),Array.prototype.push.apply(n,b),n.push("</ul></div>"));n=n.join("");g.message(n);
g.css("display",null);d||E?e?g.title(M.HIDDEN_CONTENT_PARTIAL):g.title(M.HIDDEN_CONTENT_HIDDEN):g.title(M.HIDDEN_CONTENT_VISIBLE);"expanded"===x.showHiddenContentNotification?g.expand(!1):g.collapse(!1);if(d){if(a=g.byClass("oit-showhiddenlink"))a[0].onclick(null,ma,!0),a[0].ontap(null,ma,!0)}else if(a=g.byClass("oit-hidehiddenlink"))a[0].onclick(null,ma,!1),a[0].ontap(null,ma,!1)}x.showAnnotations?w.viewNode.addClass("oit-showannotations"):w.viewNode.removeClass("oit-showannotations")};d.hiddenContent=
function(a){r[a]||(r[a]=!0,g||(g=new Nb({title:M.HIDDEN_CONTENT_HIDDEN,collapseButton:!0}),g.onexpand(function(){x.showHiddenContentNotification="expanded"}),g.oncollapse(function(){x.showHiddenContentNotification="collapsed"})),ka(),d.on.hiddencontent.dispatch(r,f))};d.documentException=function(a){};d.showNotifications=function(){ka()};var Ja=function(a,c,b){D[b]=a;O||(O=ca(F,50))},F=function(){if(O){var a=D;D={};sa(O);O=void 0;d.on.optionschanged.dispatch(a)}};d.print=function(){R.print()};ga.onadd(oa);
ga.ondata(function(a,c,b){var e;if(a.properties)for(e in a.properties)H[e]=a.properties[e];if(a.external)for(e in a.external)I[e]=a.external[e];if(a.options){for(var g in a.options)if(c=a.options[g],b=g.indexOf("."),0<b){var n=g.substring(0,b);g=g.substring(b+1);if("glob"==n||"opt"==n)b="glob"==n?w:x,b.hasOwnProperty(g)&&(b[g]=c)}w.hasHiddenText&&d.hiddenContent("hidden-text-unsupported");w.hasWorksheetRevisions&&d.hiddenContent("tracked-changes-unsupported")}if(a.info&&a.info.status)for(e in a.info.status)a.info.status[e]&&
d.documentException(e);a.xlinks&&(B=B.concat(a.xlinks));a.revisions&&(ba=ba?ba.concat(a.revisions):a.revisions.slice(0))});ga.onlast(function(){if(ba){for(var a=!1,c=!1,b=!1,e=!1,g=0;g<ba.length;g++){var n=ba[g],f=!0;c&&e||"add"!==n.type&&"delete"!==n.type&&"move"!==n.type?a&&b||"hidden"!=n.type||(f=!1):f=!1;if(!f){var k;n.range&&(k=z.forRange(n.range),k||(f=z.lastPage(),n.range.acc>f.accend&&(k=f)));k&&"page"===k.type?"add"===n.type||"delete"===n.type||"move"===n.type?c=!0:"hidden"===n.type&&(a=
!0):"add"===n.type||"delete"===n.type||"move"===n.type?e=!0:"hidden"===n.type&&(b=!0)}}a&&d.hiddenContent("hidden-text");c&&d.hiddenContent("tracked-changes");b&&d.hiddenContent("hidden-text-unsupported");e&&d.hiddenContent("tracked-changes-unsupported")}w.documentComplete=!0;w.documentLoaded&&d.on.done.dispatch()});ha.onresize(function(){w.editingComment?P.alignComment():d.dispatchPageEvents(!0)});z.onchange(function(){1!=z.activeOverlay().length&&"vertical"==x.scrollMode||d.dispatchPageEvents(!0)});
x.oncenterPages(X);x.onrotation(X);x.onshowHiddenSheets(ka);x.onshowHiddenColumns(ka);x.onshowHiddenRows(ka);x.onshowAnnotations(ka);x.onshowSlideNotes(ka);x.onpresentationMode(ka);x.onshowHiddenContentNotification(ka);var X=x.items(),Ib;for(Ib in X)if(x.isPublic(Ib))x["on"+Ib](Ja)}}),z=xa.extend("pages",{exports:"count current info moveto movetoNext movetoPrev pageName ranges isDocumentText".split(" "),events:{change:{pub:!0,detail:function(d){return z.info(d.index)}},add:{pub:!0,detail:function(d){return{startPage:d}}},
pageload:{},pageunload:{},overlayshow:{},overlayhide:{}},install:function(d){var e=[],b=[],a=null,c=null,f=null,h=0,q=1,t,u,v,p=0,l=0,m=0,H,I,Q,J={},N={},D,O;d.firstPage=function(){var a,c;for(c in b){a=b[c];break}return a};d.lastPage=function(){var a,c;for(c in b)a=b[c];return a};d.current=function(){return c?c.index:0};d.pageName=function(a){void 0===a&&(a=d.current());if(a=b[a])return a.name};d.count=function(){return b.length};d.each=function(a,c){Ab(b,arguments)};d.eachOverlay=function(a,c){Ab(e,
arguments)};d.moveto=function(a,c){var b;Ga(c)&&(b={callbackFn:c});return d.movetoEx(a,b)};var B=function(a){d.updateActivePage(a.pageIndex);a.callbackFn&&a.callbackFn.call(null,c.index)};d.movetoEx=function(a,b){b=b||{};w.viewNode.cancelKinetic();if("number"===typeof a)return b.pageIndex=a,g(b);if("object"===typeof a){if(y.isElement(a)||y.isText(a)){b.gotoNode=a;var e=b,n=d.forNode(e.gotoNode);n?(e.pageIndex=K(n.index),e.pageIndex!=n.index&&(e.gotoNode=null),g(e)):(d.logError("moveto","The specified node was not found on any page in the document."),
B(e));return c.index}if(e=wa(a))return b.range=ea(e),k(b);if("number"===typeof a.left&&"number"===typeof a.top&&"number"===typeof a.right&&"number"===typeof a.bottom)return b.rect=a,C(b)}d.logError("moveto","Invalid destination: "+wb(a));return c.index};var r=function(c,b){var e=c.overlay,g=e!==a;if(!b&&!g)return!1;if(g){P.deactivate();S.select(null);G.unloadDisplay();var n=a,f=w.viewNode;n&&(n.saveScroll=f.scroll(),n.undisplay());e.display()}c.load(!1,function(){a=e;d.updateActivePage(c.index);g&&
G.loadDisplay(c)});e.show();e.hasClass("oit-pagestream")?w.viewNode.addClass("oit-pagestream"):w.viewNode.removeClass("oit-pagestream");e.hasClass("oit-emailfill")?w.viewNode.addClass("oit-emailfill"):w.viewNode.removeClass("oit-emailfill");n=c.css("background")||null;w.viewNode.css("background",n);e.saveScroll?(f.scroll(e.saveScroll),delete e.saveScroll):g&&f.scroll(0,0);e.display();d.updateActivePage();return!0},g=function(e){var n=K(e.pageIndex);if(b[n])if(e.force||e.gotoNode||!c||n!=c.index){var f=
b[n];d.touchPage(n);if(f.isLoaded()){n=r(f,e.force);"sn"==f.type&&(x.showSlideNotes=!0);if("vertical"!=x.scrollMode||n)e.animate=!1;d.updateActivePage(f.index);"email"!==f.type&&G.moveto(c.index,B,e)||B(e)}else f.load(!0,function(){e.force=!0;g(e)}),"email"!==f.type&&f.overlay===a?G.moveto(f.index,null,{animate:!1}):a||r(f)}else e.pageIndex=c.index,B(e);else 0<=n&&ga.isPending()?ga.on.add.listenOnce(function(){g(e)}):(d.logError("moveto","Invalid page index: "+n),void 0!==w.singlePageIndex&&(e.pageIndex=
w.singlePageIndex),B(e));if(c)return c.index},k=function(a){if(w.documentLoading)ca(k,0,null,a);else{var b=d.nearestForRange(a.range);if(b)if(b.isPending())r(b),b.load(!0,function(){k(a)});else if(!c||b.overlay!==c.overlay||"vertical"!=x.scrollMode&&b!==c)b.overlay.show(),g({pageIndex:b.index,callbackFn:function(){k(a)}});else{if("sn"==b.type){x.showSlideNotes=!0;var e=d.page(b.index-1);"slide"==e.type&&e.hiddenFromSlideshow&&(x.presentationMode="normal")}else"slide"==b.type&&b.hiddenFromSlideshow&&
(x.presentationMode="normal");G.loadRange(a.range,function(){if(!G.moveto(a.range,B,a))if(d.inAnnotation(a.range)){var c=b.annotationPane();c&&c.activate(a.range,!0,!1,a.callbackFn)}else(c=G.rangeRect(a.range,"view"))?(a.rect=c,C(a)):(a.pageIndex=b.index,g(a))})}else ga.isPending()?ga.on.add.listenOnce(function(){k(a)}):(d.logError("moveto","The specified range was not found in the document: "+wb(a.range)),B(a))}return c.index},C=function(a){var b=a.rect,d=w.viewNode,e=d.scroll(),g=G.scrollPadding(),
n=b.left+e.left,f=b.right+e.left,k=b.top+e.top,r=b.bottom+e.top,m=e.left,h=e.left+d.clientWidth,C=e.top,l=e.top+d.clientHeight;g&&(g.left&&(m+=g.left),g.right&&(h-=g.right),g.top&&(C+=g.top),g.bottom&&(l-=g.bottom));var b=e.left,p=e.top;!0===a.moveToTop?p=k:k<C?(r-=d.clientHeight,0>r&&(r=0),C=20,g&&g.top&&(C+=g.top),p=k-C,p<r&&(p=r)):r>l&&(C=20,g&&g.bottom&&(C+=g.bottom),p=r+C-d.clientHeight,p>k&&(p=k));n<m?(f=n-d.clientWidth,0>f&&(f=0),C=20,g&&g.left&&(C+=g.left),b=n-C,b<f&&(b=f)):f>h&&(C=20,g&&
g.right&&(C+=g.right),b=f+C-d.clientWidth,b>n&&(b=n));b!=e.left||p!=e.top?(F.on.scrollupdate.disable(),e=w.deType,e=!a.moveToTop&&"worksheet"!=e&&"database"!=e,a.animate||(e=!1),e=e?150:0,d.abortAnimation(),d.animate({scrollLeft:b,scrollTop:p,time:e,endFn:function(){F.on.scrollupdate.enable();F.on.scrollupdate.dispatch();B(a)}})):B(a);return c.index};d.movetoPrev=function(a){var b=d.prev();b?d.moveto(b.index,a):a&&a.call(null,c.index);return c.index};d.movetoNext=function(a){var b=d.next();b?d.moveto(b.index,
a):a&&a.call(null,c.index);return c.index};d.info=function(a){void 0===a&&(a=d.current());if(b[a])return b[a].info()};d.next=function(a,d){var e;void 0===a&&(a=c.index);var g=a+1;!1!==d&&b[g]&&"email"==b[a].type&&"rt"==b[g].type&&g++;if(b[g])for(;g<b.length;g++){var n=b[g];if(n&&n.isEnabled()&&!n.overlay.isHidden()&&("sn"!=n.type||x.showSlideNotes)){e=n;break}}return e};d.prev=function(a,d){var e;void 0===a&&(a=c.index);var g=a-1;!1!==d&&b[g]&&b[g-1]&&"email"==b[g-1].type&&"rt"==b[g].type&&g--;if(b[g])for(;0<=
g;g--){var n=b[g];if(n&&n.isEnabled()&&!n.overlay.isHidden()&&("sn"!=n.type||x.showSlideNotes)){e=n;break}}return e};var K=function(a){var c,d;for(d=a;d<b.length;d++)if((c=b[d])&&c.isEnabled()&&!c.overlay.isHidden())return d;for(d=a;0<d;d--)if((c=b[d])&&c.isEnabled()&&!c.overlay.isHidden())return d;return 0};d.loadNextPageFromServer=function(){var c,d;d=G.visiblePages();if(0===d.length)return!1;var e=d[0].index,g=d[d.length-1].index;0>q?(e-=3,g+=1):g+=3;0>e&&(e=0);g>=b.length&&(g=b.length-1);if(0>
q){if(void 0===t||t>g)t=g;for(;t>=e;t--)(d=b[t])&&d.overlay===a&&d.isPending()&&(d.load(!1),c=!0)}else{if(void 0===t||t<e)t=e;for(;t<=g;t++)(d=b[t])&&d.overlay===a&&d.isPending()&&(d.load(!1),c=!0)}return c};d.updateActivePage=function(b){if(a){var e=c,g=w.viewNode.scroll().top;void 0!==b?e=d.page(b)||c:1==a.length?e=a.firstPage:"vertical"==x.scrollMode&&void 0===w.singlePageIndex&&g!=h&&(b=d.mapToPage(10,20,void 0,!0))&&(e=b.page);g!=h&&(q=g<h?-1:1,h=g);if(e!=c){c=e;a=c.overlay;e=G.visiblePages();
for(g=0;g<e.length;g++)d.touchPage(e[g].index);d.dispatchChange(c)}}};d.page=function(a){return b[a]};d.byName=function(a){var c,d;for(d in b)if(b[d].name===a){c=b[d];break}return c};d.forNode=function(a){return y.wrap(a).ancestorData("page")};d.nearestForRange=function(a){var c,e,g,n=d.pagesForRange(a);if(!n&&"text"===a.type)for(e=0;e<b.length;e++)if((g=b[e])&&"drawing"===g.type&&a.accend>=g.acc&&a.acc<=g.accend){n=[g];break}if(n)if(1==n.length)c=n[0];else if((e=G.visiblePages())&&0<e.length){var f=
e[0].index,k=e[e.length-1].index,r;for(e=0;e<n.length;e++)if(g=n[e],g.isEnabled()){var m=g.index,h=0;m<f?h=f-m:m>k&&(h=m-k);!c||h<r?(c=g,r=h):0===h&&(m=G.rangeRect(a,"view"))&&0>m.bottom&&(c=g,r=h)}}return c};d.forRange=function(a,c,d){var e;if(a)switch(c=c||0,!0!==d&&(d=!1),a.type){case "text":for(;c<b.length;c++){var g=b[c];if(g&&a.accend>=g.acc&&a.acc<=g.accend&&(!0!==d||"worksheet"!==g.type&&"database"!==g.type&&"email"!==g.type||g.isLoaded()||g.load(),g.containsRange(a))){e=g;break}}break;case "cell":case "rect":a.page>=
c&&a.page<b.length&&(e=b[a.page])}return e};d.inAnnotation=function(a){var c=!1;if("text"==a.type)for(var d=0;d<b.length;d++){var e=b[d];if(e&&a.accend>=e.acc&&a.acc<=e.accend&&e.inAnnotation(a)){c=!0;break}}return c};d.pagesForRange=function(a,c){for(var e,g=0;g<b.length;){g=d.forRange(a,g,c);if(!g)break;e||(e=[]);e.push(g);g=g.index+1}return e};d.top=function(){var a=G.visiblePages();if(a&&0<a.length)return a[0].index};d.bottom=function(){var a=G.visiblePages();if(a&&0<a.length)return a[a.length-
1].index};d.mapToPage=function(e,g,f,k,r,m){var n;if(f)n=f.pageRect("view");else if(c){f=c;if(f.isHidden()||"sn"===f.type&&!x.showSlideNotes)(f=d.next(c.index))||(f=d.prev(c.index));var h=!0;!0!==k&&"email"==f.type&&(h=!1,0===f.index&&(f=2<=b.length?b[1]:null));f&&(n=f.pageRect("view"));if("vertical"==x.scrollMode&&void 0===w.singlePageIndex&&1<a.length)for(;n;)if(g<n.top){k=d.prev(f.index,!1)||f;if(k===f||0===f.index||!h&&0===k.index)break;if(k.overlay!=f.overlay)break;var C=k.pageRect("view");if(g>
C.bottom){n.top-g>g-C.bottom&&(f=k,n=C);break}f=k;n=C}else if(g>n.bottom){if(f.index==b.length-1)break;k=d.next(f.index,!1)||f;if(k===f||k.overlay!=f.overlay)break;C=k.pageRect("view");if(g<C.top){C.top-g<g-n.bottom&&(f=k,n=C);break}f=k;n=C}else break}h=!1;if(f){if(r&&(e>n.right||e>w.viewNode.clientWidth)&&f.annotationPane()){r=w.viewNode;C=r.pos(y.body);k=e+C.left;var C=g+C.top,l=f.annotationPane().contentRect(y.body);l&&(k=k+r.scrollLeft-l.left,C=C+r.scrollTop-l.top,m||0<=k&&0<=C&&k<=l.width&&C<=
l.height)&&(e=k,g=C,h=!0)}if(!h&&(n&&(e-=n.left,g-=n.top),G.features().zoom&&(n=x.zoom,1!=n&&(e=L(e/n),g=L(g/n))),G.features().rotate&&(m=x.rotation,0!==m)))switch(n=f.pageRect(),r=e,k=g,m){case 90:e=n.width-k;g=r;break;case 180:e=n.width-r;g=n.height-k;break;case 270:e=k,g=n.height-r}return{page:f,x:e,y:g,inAnnotation:h}}};d.elementRect=function(a,c){var b;b=new la(a.rect(w.viewNode),"view");b.origin=c;return b};d.findTextRange=function(d){if("text"===d.type){var e;if("vertical"!=x.scrollMode||void 0!==
w.singlePageIndex)void 0!==c.acc&&d.acc<=c.accend&&d.accend>=c.acc&&(e=c.findTextRange(d));else for(var g in b){var f=b[g];if(f.overlay===a&&f.isLoaded()&&f.isEnabled()&&void 0!==f.acc&&d.acc<=f.accend&&d.accend>=f.acc&&(f=f.findTextRange(d)))if(e)for(var n=0;n<f.length;n++)e.push(f[n]);else e=f}return e}};var ba=function(a,c,b){var d=!1;if(b)if(Array.isArray(b))for(var e=0;e<b.length&&!(d=ba(a,c,b[e]));e++);else b.range&&"text"===b.range.type&&a<=b.range.accend&&c>=b.range.acc&&(d=!0);return d};
d.isAnnotationText=function(a,c,b){var e=!1;if(b)for(var g=0;!e&&g<b.length;g++)e=b[g],e=ba(a,c,e.text)||ba(a,c,e.oldtext)||ba(a,c,e.author)||ba(a,c,e.author_short)||ba(a,c,e.last_save_date)||ba(a,c,e.create_date)||ba(a,c,e.date);else(b=F.revisions())&&(e=d.isAnnotationText(a,c,b)),!e&&O&&(e=d.isAnnotationText(a,c,O.revisions));return e};d.isDocumentText=function(a,c){return d.forRange(pa(a,c),0,!0)?!0:d.isAnnotationText(a,c)};d.maxWidth=function(){if(a)return"vertical"!=x.scrollMode||void 0!==w.singlePageIndex?
c.width:a.maxWidth};d.maxHeight=function(){if(a)return"vertical"!=x.scrollMode||void 0!==w.singlePageIndex?c.height:a.maxHeight};d.decomposeRange=function(a,c){var d;if(void 0!==a.page){var e=b[a.page];if(e){if("rect"===a.type)d=e.mapRectRangeToText(a);else if("cell"===a.type){var g=e.spreadsheetModel();g&&(d=g.decomposeRange(a,c))}(e=e.mapRangeToEmbeds(a))&&(d=d?d.concat(e):e)}}return d};d.ranges=function(a){var c={};void 0===a&&(a=d.current());b[a]&&(a=b[a].textRanges())&&0<a.length&&(c.text=a);
return c};var ia=function(){if(w.dynamicContent){switch(x.memoryModel){case "none":m=l=0;break;case "large":l=3145728;m=100;break;case "small":l=1048576;m=20;break;case "micro":l=524288;m=10;break;default:w.isMobile?(l=1048576,m=20):(l=3145728,m=100)}d.applyMemoryLimit()}else m=l=0};d.applyMemoryLimit=function(a){var c,b=0;if(H)for(c=H;c;)0<c.loadedSize&&b++,c=c.nextNewer;void 0!==a&&(p+=a,d.logMemory&&d.logMemory(p,l,b,m));if(0<l&&p>l||0<m&&b>m){if(H){c=H;var e=a=-1,g=G.visiblePages();0<g.length&&
(a=g[0].index,e=g[g.length-1].index);for(;c;){g=c.nextNewer;if(0<c.loadedSize&&!c.locked&&(c.index<a||c.index>e)&&(p-=c.loadedSize,c.unload(),b--,p<=l&&b<m))break;c=g}}d.logMemory&&d.logMemory(p,l,b,m)}};d.touchPage=function(a){(a=b[a])&&a!=I&&(void 0===I?H=a:(a==H&&(H=a.nextNewer),a.nextNewer&&(a.nextNewer.nextOlder=a.nextOlder),a.nextOlder&&(a.nextOlder.nextNewer=a.nextNewer),I.nextNewer=a,a.nextOlder=I,a.nextNewer=void 0),I=a)};var na=function(){var c,b;b=(b=d.firstPage())&&b.isSpreadsheet();if(void 0===
w.singlePageIndex&&(b||1<e.length)){u||(u=new cd,u.addPrevNext(function(){d.movetoPrev()},function(){d.movetoNext()}));for(b=u.length();b<e.length;b++){c=e[b];var g=c.firstPage;if(!g)break;u.addTab(c.name,c.hidden,d.moveto,g.index);c.isHidden()&&u.hideTab(c.index)}u.show();a&&u.setActiveTab(a.index);if(O){g=[];if(x.showAnnotations)for(b=0;b<O.revisions.length;b++)c=O.revisions[b],!c.page&&c.ref&&void 0!==c.ref.sheet&&(c.page=d.page(c.ref.sheet)),c.page&&("add_sheet"==c.type?g[c.page.overlay.index]=
"oit-anno-add":g[c.page.overlay.index]||(g[c.page.overlay.index]="oit-anno-change"));for(b=0;b<e.length;b++){var f=g[b];f||(c=e[b],1==c.length&&c.firstPage.comments()&&(f="oit-anno-change"));u.tabClass(b,f)}}}else u&&(u.destroy(),u=null)};d.dispatchChange=function(a,b){a||(a=c);if(a==f&&!b)return!0;f=a;u&&u.setActiveTab(a.overlay.index);a.annotationPane()&&a.supportsAnnotationBar()&&d.createAnnotationBar();return d.on.change.dispatch(a)};d.overlayById=function(a){return fb(e,"id",a)};d.pageById=function(a){return fb(b,
"id",a)};d.createAnnotationBar=function(){v||(v=new dd)};d.activeOverlay=function(){return a};d.activePage=function(){return c};d.ssRevisions=function(){return O};var A=function(){na();h=void 0};d.updateShowSlideNotes=function(){if(!F.supressHiddenContentUpdate()){var a=G.saveScrollPos();x.showSlideNotes?F.screenCSS(".oit-sn","display:block;"):(F.screenCSS(".oit-sn",null),c&&"sn"==c.type&&(P.deactivate(),S.select(null)));d.updateActivePage();G.layoutChanged();G.restoreScrollPos(a)}};d.overlayTabRect=
function(a){if(u)return u.tabRect(a.index)};d.activeAnnotationPane=function(a){if(void 0!==a&&a!==D){var c=D;D=null;c&&c.deactivate();D=a}return D};d.deactivateAnnotation=function(){d.activeAnnotationPane(null)};d.scrollToAnnotationPane=function(a){if(x.showAnnotations&&d.activePage()&&d.activePage().supportsAnnotationPane()){var c=w.viewNode;c.animate({scrollLeft:c.scrollWidth-c.clientWidth,endFn:a})}else a&&a()};d.annotationPaneWidth=function(){return x.showAnnotations&&a&&a.hasAnnotations()&&a.firstPage.supportsAnnotationPane()?
338:0};var U=function(){!0===x.showHiddenSheets?d.eachOverlay(function(a){a.firstPage&&"worksheet"==a.firstPage.type&&a.show()}):!1===x.showHiddenSheets&&d.eachOverlay(function(a){a.hidden&&a.firstPage&&"worksheet"==a.firstPage.type&&a.hide()})};x.onmemoryModel(ia);x.onnochrome(A);x.onshowSlideNotes(d.updateShowSlideNotes);x.onscrollMode(function(){h=void 0});x.onshowHiddenSheets(U);x.onshowSlideNotes(function(){!1===x.showSlideNotes&&"vertical"!==x.scrollMode&&"sn"===d.activePage().type&&d.movetoPrev()});
x.onshowAnnotations(na);x.onannotationSort(function(){a&&a.each(function(a){(a=a.annotationPane())&&a.applySort()})});F.onreset(function(){for(var d in b){var g=b[d],k=g;p-=k.loadedSize;k.unload();g.destroy()}b=[];Y(e,"destroy");e=[];f=c=a=null;h=0;q=1;u&&(u.destroy(),u=null);v&&(v.destroy(),v=null);Q&&(Q.destroy(),Q=void 0,J={},N={});l=p=0;O=I=H=t=void 0});ga.ondata(function(a,c,g){var f;if(g=a.style){Q||(Q=new tb);var k=[],n=[];for(c=0;c<g.length;c++){var r=g[c];if("string"===typeof r)n.push(r);
else if(r.s&&r.p){var h=r.s,r=r.p;"@font-face"===h?J.hasOwnProperty(r)||(J[r]=!0,k.push(h,"{",r,"}")):N.hasOwnProperty(h)||(N[h]=!0,n.push(h,"{",r,"}"))}}0<k.length&&Q.addCSSText(k.join(""));0<n.length&&Q.addCSSText(n.join(""))}if(a.overlays)for(c=0;c<a.overlays.length;c++)g=a.overlays[c],d.overlayById(g.oid)||e.push(new Kc(e.length,g));if(a.pages){f=b.length;for(c=0;c<a.pages.length;c++){g=a.pages[c];k=null;"email"===g.type&&(w.singlePageIndex=void 0);if(void 0!==g.index){if(n=parseInt(g.index,10),
void 0===w.singlePageIndex||w.singlePageIndex===n)b[n]||(b[n]=new hb(n,g.type,g.id)),k=b[n]}else k=new hb(b.length,g.type,g.id),b.push(k);k&&k.processData(g)}d.applyMemoryLimit()}a.attachments&&(c=d.page(0))&&(c._attachments=a.attachments.slice(0));if(a.ssrevisions&&a.ssrevisions.revisions){O=a.ssrevisions;O.revisions.sort(function(a,c){return a.seq-c.seq});g=null;for(c=0;c<O.revisions.length;c++)if(k=O.revisions[c],void 0!==Qb[k.type]&&F.hiddenContent("tracked-changes"),k.cells)for(n=0;n<k.cells.length;n++)if(h=
k.cells[n],h.text)for(r=0;r<h.text.length;r++)g=Gb(g,h.text[r].range);g?Z.loadRawText(g.acc,g.accend,function(){d.each("processSSRevisions");na()}):(d.each("processSSRevisions"),na())}a.revisions&&d.each("processRevisions");U();na();void 0!==f&&b.length>f&&d.on.add.dispatch(f)});ga.onadd(function(){d.updateActivePage()});F.onscrollupdate(d.updateActivePage);F.onload(function(){ia();A();d.updateShowSlideNotes()});$a.onendscroll(d.updateActivePage);S.onselectionchanged(function(a,c){if(x.showAnnotations){var b=
d.activeAnnotationPane();if(a){var e=d.nearestForRange(a);e&&e.annotationPane()&&(b=e.annotationPane())}b&&c&&b.activate(a,!1,!1)}});d.onoverlayshow(function(a){u&&u.showTab(a.index)});d.onoverlayhide(function(a){u&&u.hideTab(a.index);!c||c.isEnabled()&&!c.overlay.isHidden()||(a=K(c.index),d.moveto(a))})}}),P=xa.extend("highlights",{exports:"activate active add addMultiple addNote addStamp apply autoHighlight autoHighlightOptions clear comment current deactivate defineStamp first getJSON hide hideComment isHidden label last logVisibleHighlights moveto movetoNext movetoPrev next prev properties property range redact remove serialize setOptions show showComment style type validateStyles".split(" "),
events:{activate:{pub:!0,detail:function(d,e,b){return{highlightid:d?d.id:void 0,before:e,after:b}}},add:{pub:!0,detail:function(d){return{highlightid:d.id}}},remove:{pub:!0,detail:function(d){return{highlightid:d.id}}},move:{pub:!0,detail:function(d){return{highlightid:d.id}}},comment:{pub:!0,detail:function(d){return{highlightid:d.id}}},mode:{pub:!0,detail:function(d){return{autohighlight:d,autooptions:P.autoHighlightOptions(),selectionmode:F.selectionMode()}}}},userEventDef:{pub:!0,detail:function(d,
e,b){return{highlightid:b.id,srcEvent:e}}},install:function(d){var e={},b=function(a){var c=a.toLowerCase();e[a]={w:"border"+a+"Width",c:"border"+a+"Color",wp:"border-"+c+"-width",cp:"border-"+c+"-color",sp:"border-"+c+"-style"}};b("Top");b("Right");b("Bottom");b("Left");var a=0,c=[],f=0,h=0,q,t,u,v,p=-1,l=-1,m,H,I=!1,Q=!1,J,N=!1,D=!1,O,B={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0},r=!0,g=
[],k=!1,C={x:0,y:0},K=[];d.add=function(){var a=arguments,c=1,b={};ta(0,a,b,"add");b.invalid||(c=sa(c,a,b,"add"));b.invalid||(Array.isArray(b.range)?b.type="hl-"+b.range[0].type:Ia(b.range)||Ka(b.range)?b.type="hl-text":b.type="hl-"+b.range.type,xa(0,a,b,"add"));b.invalid||(c=va(c,a,b,"properties","add"),c=za(c,a,b,"comment","add"));b.invalid||ua(c,a,b,"add");if(!b.invalid)return ka(b)};d.addMultiple=function(a,c,b,e){var g=arguments,f=1,k={},n,r;ta(0,g,k,"addMultiple");if(!k.invalid){if(Array.isArray(c)){for(r=
0;r<c.length;r++){if(!wa(c[r])){k.invalid=!0;break}if(n&&n!=c[r].type){k.invalid=!0;break}n=c[r].type}f++}else k.invalid=!0;n||(k.invalid=!0);k.invalid&&d.invalidArg("addMultiple","rangeList",null,"Must be an array of ranges")}k.invalid||(k.type="hl-"+n.type,xa(0,g,k,"addMultiple"));k.invalid||va(f,g,k,"properties","addMultiple");if(!k.invalid){g=[];d.beginBatch();for(r=0;r<c.length;r++)k.range=wa(c[r]),f=ka(k),g.push(f),e&&d.setOptions(f,e);d.endBatch();return g}};d.addNote=function(){var a=arguments,
c=1,b={type:"note"};ta(0,a,b,"addNote");b.invalid||(c=sa(c,a,b,"addNote"));b.invalid||("cell"!==b.range.type&&"rect"!==b.range.type&&(d.invalidArg("addNote","range",b.range,"Anchored notes may only be added to rect or cell ranges"),b.invalid=!0),xa(0,a,b,"addNote"));b.invalid||(c=va(c,a,b,"properties","addNote"),c=za(c,a,b,"comment","addNote"));b.invalid||ua(c,a,b,"addNote");if(!b.invalid)return ka(b)};d.redact=function(){var a,b=arguments,d={type:"redaction"};a=sa(0,b,d,"redact");d.invalid||(a=va(a,
b,d,"properties","redact"),a=za(a,b,d,"label","redact"));d.invalid||ua(a,b,d,"redact");if(!d.invalid){if("compound"===x.redactionMode||"hybrid"===x.redactionMode&&"cell"===d.range.type)d.compound=!0;a:{a=d;b=!1;a.range.embedId?b=!1:"hybrid"===x.redactionMode?b="rect"===a.range.type:"simple"===x.redactionMode&&(b="rect"===a.range.type||"cell"===a.range.type);if(b){var e=z.decomposeRange(a.range);if(e){var d=[],g=a.range,f=z.page(g.page),k=G.rangeRect(g,f),n=a.activate;a.activate=!1;for(b=0;b<e.length;b++){a.range=
e[b];var r=Ja(a);-1==d.indexOf(r)&&d.push(r)}if("drawing"===f.type||"slide"===f.type||"chart"===f.type){e=0===d.length;if(!e)for(b=0;b<d.length;b++)if(r=c[d[b]].range,"rect"!==r.type){e=!0;break}else if(r=G.rangeRect(r,f),!r||!r.equals(k)){e=!0;break}e&&(a.range=g,d.unshift(Ja(a)))}if(0<d.length){n&&ca(d[0]);1==d.length&&(d=d[0]);a=d;break a}}}a=ka(a)}return a}};d.apply=function(a,c){if(!Array.isArray(a)){try{a=JSON.parse(a)}catch(ed){d.invalidArg("apply","highlights",a,"Error parsing JSON string: "+
ed.message);return}a&&a.range&&"object"==typeof a.range&&(a=[a])}if(Array.isArray(a))if(w.documentLoaded){c=Ga(c)?c:null;for(var b=0;b<a.length;b++){var e=a[b];if("sdef"==e.type)d.defineStamp(e.stamp,e.url);else{var g=la();if(!c||c(g,e.properties))if(wa(e.range))if(g=[],"stamp"==e.type){var f={name:e.stamp};e.opacity&&(f.opacity=e.opacity);e.sizing&&(f.sizing=e.sizing);g.push(f);g.push(e.range);e.hasOwnProperty("properties")&&g.push(e.properties);e.hasOwnProperty("comment")&&g.push(e.comment);d.addStamp.apply(void 0,
g)}else ka(e);else d.invalidArg("apply","highlight["+b+"]",e)}}}else q=q?a.concat(q):a};d.remove=function(a,c){if(Array.isArray(a)){d.beginBatch();for(var b=0;b<a.length;b++)d.remove(a[b]);d.endBatch()}else(b=Z(a,m,"remove"))&&ba(b,c)};var ba=function(a,b){var e=a.id;void 0===b&&(b=!0);d.on.remove.dispatch(a);var g,k=!1,n=!1;e==m?(Ra(b),m=void 0,void 0!=a.prevId?(g=a.prevId,n=!0):void 0!=a.nextId&&(g=a.nextId,k=!0)):b=!1;d.hideComment(e);d.unmap(a);a.destroy();c[e]=null;f--;e<h&&(h=e);void 0!==g&&
ca(g,k,n,b,!1,!1)};d.removeFromRange=function(a){Array.isArray(a)?Y(a,d.removeFromRange):"text"===a.type&&d.each(ia,null,a)};var ia=function(a,c){var b=a.range;"text"===b.type&&b.accend>=c.acc&&b.acc<=c.accend&&d.remove(a.id,!1)};d.count=function(){return f};d.clear=function(a){a=Ga(a)?a:null;Ra();d.beginBatch();d.each(ba,a,!1);d.endBatch();a||(m=void 0,c=[],h=f=0,K=[])};b=function(){var a=x.highlightLabelFontFamily,c=x.highlightLabelFontSize,b="";a&&(b+="font-family:"+a+";");c&&(b+="font-size:"+
c+";");F.screenCSS(".oit-highlight-label",b);d.each("showLabel",null,x.showHighlightLabels)};d.setOptions=function(a,c){c&&fa(a,m,"setOptions",null,[c])};d.getOption=function(a,c){return fa(a,m,"getOption",null,[c])};d.style=function(a,c){var b,e=Z(a,m,"style");if(e)if(c){var g=aa(c,"hl-text"!=e.type);g?b=e.style(g):d.invalidArg("style","style",c)}else b=e.style();return b};d.comment=function(a,c,b){if(a=Z(a,m,"comment")){var e=a.comment();void 0!==c&&c!==e&&(b||a.id!==d.active()||a.isNote()?e=a.comment(c):
(d.hideComment(),e=a.comment(c),d.showComment()),d.on.comment.dispatch(a));return e}};var na=function(a){if("scale"==a||"stretch"==a||"image"==a)return a},A=function(a){if(a&&!isNaN(a)&&(a=Number(a),0<=a&&1>=a))return a},U=function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y))return{x:Math.round(a.x),y:Math.round(a.y)}},n=function(a){a.img=new Image;a.img.src=a.url;a.img.onload=function(){a.height=this.height;a.width=this.width;a.defaultSize&&(this.style.width=a.defaultSize.x,this.style.height=a.defaultSize.y);
delete a.img}};d.stamp=function(a){if(v)return v[a]};d.label=function(a,c){return fa(a,m,"label",null,[c])};d.defineStamp=function(a,c,b){v||(v={});c?(b=b||{},c={url:c},b.sizing&&(c.sizing=na(b.sizing)),b.opacity&&(c.opacity=A(b.opacity)),b.defaultSize&&(c.defaultSize=U(b.defaultSize)),v[a]=c,n(v[a])):delete v[a]};var E=function(a){var c;if(a){var b;if(a instanceof String||"string"==typeof a)b={name:a};else{b={};for(var d in a)b[d]=a[d]}b.name&&v&&v[b.name]&&(b.type="stamp",b.stamp=v[b.name],c=b)}return c};
d.addStamp=function(){var a,c=arguments,b=E(c[0]);if(b){b.sizing=na(b.sizing)||b.stamp.sizing||"scale";b.opacity=A(b.opacity)||b.stamp.opacity||1;b.defaultSize=U(b.defaultSize)||b.stamp.defaultSize;var e;e=sa(1,c,b,"addStamp");var g=b.range;g&&"rect"!=g.type&&"cell"!=g.type?(d.invalidArg("addStamp","range",g),b.invalid=!0):"rect"===g.type&&Pb(g)?b.range=Ea(g.left,g.top,"rect",b):"cell"===g.type&&g.c1==g.c2&&g.r1==g.r2&&(b.range=Ea(g.c1,g.r1,"cell",b));b.invalid||(e=va(e,c,b,"properties","addStamp"),
e=za(e,c,b,"comment","addStamp"));ua(e,c,b,"addStamp");b.invalid||(a=ka(b))}else d.invalidArg("addStamp","stamp",c[0],"Must be the name of a defined stamp");return a};d.getJSON=function(a){if(a=Z(a,m,"getJSON"))return JSON.stringify(a.serialize())};d.serialize=function(a){var c=[],b,e;Ga(a)?b=a:Array.isArray(a)?e=a:"number"===typeof a&&(e=[a]);d.each(ja,b,c,{},e);return JSON.stringify(c,null,!1)};var ja=function(a,c,b,d){d&&-1==d.indexOf(a.id)||(a=a.serialize(),a.stamp&&!b[a.stamp]&&(c.push({type:"sdef",
stamp:a.stamp,url:v[a.stamp].url}),b[a.stamp]=!0),c.push(a))};d.properties=function(a,c){return fa(a,m,"properties",null,[c])};d.property=function(a,c,b){return fa(a,m,"property",null,[c,b])};d.current=function(){return m};d.active=function(){if(!I&&!Q)return m};d.moveto=function(a){(a=Z(a,m,"moveto"))&&ca(a.id,!1,!1,!0,!0,!0);return m};d.movetoNext=function(a){if(void 0===m)void 0!==t&&d.moveto(t);else{var b=m;if(I&&c[b].filter(a)&&qa(b))return d.moveto(b);for(;;){b=c[b].nextId;if(void 0===b)break;
var e=c[b];if(e.filter(a)&&(e=z.nearestForRange(e.range)))return e.isLoaded()?ca(b):z.moveto(e.index,function(){d.movetoNext(a)}),b}}return m};d.movetoPrev=function(a){if(void 0===m)void 0!==u&&d.moveto(u);else{var b=m;if(Q&&c[b].filter(a)&&qa(b))return d.moveto(b);for(;;){b=c[b].prevId;if(void 0===b)break;var e=c[b];if(e.filter(a)&&(e=z.nearestForRange(e.range)))return e.isLoaded()?ca(b):z.moveto(e.index,function(){d.movetoPrev(a)}),b}}return m};d.type=function(a){if(a=Z(a,m,"type"))switch(a.type){case "note":case "redaction":case "stamp":return a.type;
default:return"highlight"}};d.range=function(a){if(a=Z(a,m,"range"))return a.range};d.show=function(a){if(void 0===a||Ga(a))d.beginBatch(),d.each(function(a){ra(a)},a),d.endBatch();else if(Array.isArray(a)){d.beginBatch();for(var c=0;c<a.length;c++){var b=Z(a[c]);b&&ra(b)}d.endBatch()}else fa(a,m,"show")};d.hide=function(a){if(void 0===a||Ga(a))d.beginBatch(),d.each(function(a){T(a)},a),d.endBatch();else if(Array.isArray(a)){d.beginBatch();for(var c=0;c<a.length;c++){var b=Z(a[c]);b&&T(b)}d.endBatch()}else fa(a,
m,"hide");d.alignHighlight()};d.isHidden=function(a){return fa(a,m,"isHidden")};d.logVisibleHighlights=function(){var a=d.first();if(void 0===a)console.log("No visible highlights.");else for(;void 0!==a;){var b=c[a];console.log("["+b.id+"]: range="+JSON.stringify(b.range)+", key="+JSON.stringify(b.key));a=d.next(a)}};d.showComment=function(a,b){Array.isArray(a)&&(a=a[0]);var e=Z(a,m,"showComment");if(e){b=b||{};b.mode||(b.mode="view");var g=d.active();if(void 0!==g&&(g=c[g],g.isNote()&&g.isEditing()))return;
if(e.isNote())switch(b.mode){case "view":e.show();e.endEditText(!0);break;case "edit":e.beginEditText(!1);break;case "new":e.beginEditText(!0)}else e.dialog(b.mode)}};d.hideComment=function(a){(a=Z(a,m,"hideComment"))&&(a.isNote()?a.collapse():a.hideDialog())};d.first=function(){return t};d.last=function(){return u};d.next=function(a){if(a=Z(a,m,"next"))return a.nextId};d.prev=function(a){if(a=Z(a,m,"prev"))return a.prevId};d.activate=function(a){(a=Z(a,m,"activate"))&&ca(a.id)};d.deactivate=function(){Ra(!0)};
var X=function(a){if(a)for(var c in B)void 0!==a[c]&&(B[c]=a[c]);S.enableCellOffsets("note"===N||"stamp"===N);oa();d.on.mode.dispatch(N)};d.autoHighlightOptions=function(a){void 0!==a&&X(a);a={};for(var c in B)a[c]=B[c];return a};d.autoHighlight=function(a,c){var b;if(!1===a){S.select(null);if(O){b=G.features();switch(O){case "text":b.textselection||(O=null);break;case "rect":b.rectselection||(O=null);break;case "cell":b.cellselection||(O=null);break;default:O=null}O&&(F.selectionMode(O),O=null)}N=
!1;X()}else if("selection"===a||"note"===a||"redaction"===a||"stamp"===a){c=c||{};B.comment=null;B.sticky=!1;B.properties=null;S.select(null);if("stamp"===a){if(!E(c.stamp))return d.invalidArg("autoHighlight","options.stamp",c.stamp),N=!1}else if(("selection"===a||"note"===a)&&!aa(c.style,!0))return d.invalidArg("autoHighlight","options.style",c.style),N=!1;N=a;O||(O=F.selectionMode());if("note"===a||"redaction"===a||"stamp"===a)b=G.features(),b.rectselection||"redaction"===a&&b.rectredaction?F.selectionMode("rect"):
b.cellselection&&F.selectionMode("cell");X(c)}return N};d.pauseAutoHighlight=function(a){D=!!a};d.beginBatch=function(){a++};d.endBatch=function(){0<a&&a--};d.batchMode=function(){return 0<a};var oa=function(){if("selection"===N||"note"===N)S.style(B.style,!1);else if("redaction"===N){var a;x.redactionFillColor&&"compound"===x.redactionMode&&"rect"===F.selectionMode()?a=x.redactionFillColor:(a=Fa(x.redactionColor),.7<a.a&&(a.a=.7),a=La(a.r,a.g,a.b,a.a));S.style("background-color:"+a+";",!1)}else if("stamp"===
N)if(v&&(a=v[B.stamp]),a){var c="background:url("+a.url+") no-repeat";"number"===typeof a.opacity&&1!=a.opacity&&(c+=";opacity:"+a.opacity);"scale"==a.sizing?c+=";background-size:contain":"stretch"==a.sizing&&(c+=";background-size:100% 100%");S.style(c)}else S.style(null);else S.style(null)},Ea=function(a,c,b,d){var e,g;d&&(d.defaultSize&&(e=d.defaultSize.x,g=d.defaultSize.y),e||(e=d.width),g||(g=d.height));e||(e=200);g||(g=200);a=z.mapToPage(a,c);d&&(a.x-=Math.floor(e/2),a.y-=Math.floor(g/2));return G.rangeFromRect(a.page.index,
a.x,a.y,a.x+e,a.y+g,a.page,"move")},qa=function(a){return"slideshow"!=x.presentationMode?!0:(a=wa(c[a].range))&&z.nearestForRange(a)?!0:!1};d.startSelection=function(){H=d.active();Ra(!1)};d.endSelection=function(){H=void 0};F.onselect(function(a,b,e,g,f){var k=!0;if(a&&N&&!D){var n=a,r="note"===N,h="stamp"===N;if(r&&!G.features().anchorednotes||(r||h)&&"text"===n.type&&!g)return!0;a=r||!0===B.comment;if(g)if((r||h)&&e&&void 0===H){var m;h&&((b=E(B.stamp))?m=b.stamp:n=null);n&&(b=G.features(),n=b.rectselection?
Ea(e.x,e.y,"rect",m):b.cellselection?Ea(e.x,e.y,"cell",m):null);n||S.select(null)}else S.select(null),n=null;else r&&b&&e&&"rect"===n.type&&(m=n.bottom-n.top,100>n.right-n.left&&(b.x<e.x?n.right=n.left+100:n.left=n.right-100),80>m&&(b.y<e.y?n.bottom=n.top+80:n.top=n.bottom-80));if(n&&void 0===f){var C;"text"===n.type&&(n=V.getSelection());"redaction"===N?C=d.redact(n,B.properties,B.label):h?!E(B.stamp)||"rect"!==n.type&&"cell"!==n.type?S.select(null):C=d.addStamp(B.stamp,n,B.properties):r?"rect"===
n.type||"cell"===n.type?C=d.addNote(B.style,n,B.properties):S.select(null):C=d.add(B.style,n,B.properties);if(void 0!==C){e=Array.isArray(C)?C:[C];f="string"===typeof B.comment?B.comment:void 0;for(k=0;k<e.length;k++)C=c[e[k]],C.setOptions(B),f&&C.comment(f);S.select(null);d.activate(e[0]);a&&d.showComment(e,{mode:"new"});k=!1;B.sticky||d.autoHighlight(!1)}}}return k});d.alignComment=function(){d.each("alignDialog")};G.ondisplayload(function(a,c){p=a.index;l=c.index;d.eachOnPage("addToPage",z.page(p));
l>p&&P(p+1,l)});G.ondisplayunload(function(a,c){d.each("destroyDialog");l=p=-1});z.onpageload(function(a){-1!=l&&a.index>l&&(l=z.activeOverlay().lastPage.index);0<c.length&&a.index>=p&&a.index<=l&&d.eachOnPage(function(c){c.addToPage(a.index)},a)});z.onpageunload(function(a){a.index>=p&&a.index<=l&&(d.each("removeFromPage",null,a.index),a.highlightLayer=void 0)});d.onEmailHeaderResize=function(a){d.each("addToPage",null,a);d.positionAll(z.activeOverlay())};d.alignHighlight=function(){void 0==m||I||
Q||ca(m,!1,!1,!1,!1,!0)};d.move=function(a,c,b,d,e,g){var f;c=c||0;d=d||0;b=b||0;e=e||0;g=g||!1;if((a=Z(a))&&(c||d||b||e)&&a.getOption("enableUserMove")){var k=ea(a.range);if("rect"===k.type){g=g?1:10;var n=G.pageRange(k.page,k.type);k.left+=c*g;k.top+=b*g;k.right+=d*g;k.bottom+=e*g;g=k.right-k.left;f=k.bottom-k.top;c&&(0>k.left?(k.left=0,d&&(k.right=g)):k.left>=k.right&&(k.left=k.right-1));d&&(k.right<=k.left?k.right=k.left+1:k.right>n.right&&(k.right=n.right,c&&(k.left=k.right-g,0>k.left&&(k.left=
0))));b&&(0>k.top?(k.top=0,e&&(k.bottom=k.top+f)):k.top>=k.bottom&&(k.top=k.bottom-1));e&&(k.bottom<=k.top?k.bottom=k.top+1:k.bottom>n.bottom&&(k.bottom=n.bottom,b&&(k.top=k.bottom-f,0>k.top&&(k.top=0))))}else"cell"===k.type&&(n=G.pageRange(k.page,k.type),k.c1+=c,k.r1+=b,k.c2+=d,k.r2+=e,g=k.c2-k.c1,f=k.r2-k.r1,c&&(k.c1<n.c1?(k.c1=n.c1,d&&(k.c2=k.c1+g)):k.c1>k.c2&&(k.c1=k.c2)),d&&(k.c2<k.c1?k.c2=k.c1:k.c2>n.c2&&(k.c2=n.c2,c&&(k.c1=k.c2-g,k.c1<n.c1&&(k.c1=n.c1)))),b&&(k.r1<n.r1?(k.r1=n.r1,e&&(k.r2=
k.r1+f)):k.r1>k.r2&&(k.r1=k.r2)),e&&(k.r2<k.r1?k.r2=k.r1:k.r2>n.r2&&(k.r2=n.r2,b&&(k.r1=k.r2-f,k.r1<n.r1&&(k.r1=n.r1)))));a.setRange(k)}};var aa=function(a,c){if(!r)return a;var b;if("string"==typeof a){b=[];var d=rb(a,"color");d&&b.push("color:",d,";");(d=rb(a,"background-color"))&&b.push("background-color:",d,";");if(!c)(d=rb(a,"text-decoration"))&&b.push("text-decoration:",d,";");else if(c&&-1!=a.indexOf("border")){d=y.create("div");d.attr("style",a);d.css("display","none");y.body.append(d);var e=
d.computedStyle(d),g=Ba(e,"Top"),f=Ba(e,"Left"),k=Ba(e,"Bottom"),n=Ba(e,"Right");g.w&&g.w==k.w&&g.w==f.w&&g.w==n.w&&g.c==k.c&&g.c==f.c&&g.c==n.c?b.push("border:",g.w," solid ",g.c,";"):(ma(e,g,b),ma(e,f,b),ma(e,k,b),ma(e,n,b));d.destroy()}b=0===b.length?void 0:b.join("")}return b},Ba=function(a,c){c=e[c];return{e:c,w:a[c.w],c:a[c.c]}},ma=function(a,c,b){c.w&&b.push(c.e.wp,",",c.w,";",c.e.sp,":solid;",c.e.cp,":",c.c,";")};d.map=function(a){if("text"===a.range.type){var c=K[a.range.acc];void 0!==c?
c instanceof Array?c.push(a.id):K[a.range.acc]=[c,a.id]:K[a.range.acc]=a.id}};d.unmap=function(a){if("text"===a.range.type){var c=K[a.range.acc];void 0!==c&&(c instanceof Array?1==c.length&&c[0]==a.id?delete K[a.range.acc]:Sa(c,a.id):c===a.id&&delete K[a.range.acc])}};var ka=function(a){var c,b,d,e,g;if(Array.isArray(a.range)){g=a.range;a.compound=g;e=g[0].acc;b=g[0].accend;for(c=1;c<g.length;c++)d=g[c],d.acc<e&&(e=d.acc),d.accend>b&&(b=d.accend);a.range=pa(e,b)}else if(Ia(a.range)||Ka(a.range)){g=
mb(a.range);if(!g)return;if(!Array.isArray(g))return a.range=g,ka(a);a.compound=g;e=g[0].acc;b=g[0].accend;for(c=1;c<g.length;c++)d=g[c],d.acc<e&&(e=d.acc),d.accend>b&&(b=d.accend);a.range=pa(e,b)}if("text"===a.range.type){if((g=z.pagesForRange(a.range))&&2<=g.length){d=a.range;e=[];var f,k;for(c=0;c<g.length;c++)b=g[c],b.overlay!=k?(f=pa(b.acc,b.accend),e.push(f),k=b.overlay):(b.acc<f.acc&&(f.acc=b.acc),b.accend>f.accend&&(f.accend=b.accend));if(1<e.length){f=[];for(c=0;c<e.length;c++)a.range=e[c],
a.range.acc<d.acc&&(a.range.acc=d.acc),a.range.accend>d.accend&&(a.range.accend=d.accend),k=Ja(a),-1==f.indexOf(k)&&f.push(k);return 0===f.length?void 0:1==f.length?f[0]:f}}}else if("rect"===a.range.type&&(b=z.page(a.range.page))&&b.isEmailHeader())return;return Ja(a)},Ja=function(a){var b;if("text"===a.range.type){var e,k=a.properties,n=a.comment,r=a.label;null===k&&(k=void 0);null===n&&(n=void 0);null===r&&(r=void 0);var h=K[a.range.acc];if(void 0!==h)if(h instanceof Array)for(var m=0;m<h.length;m++){if(e=
c[h[m]],e.matches(a.style,a.range,k,n,r)){b=e;break}}else e=c[h],e.matches(a.style,a.range,k,n,r)&&(b=e)}else b=void 0;if(!b){"text"===S.selectionType()&&S.select(null);e="rect"===a.range.type||"cell"===a.range.type;k=la();switch(a.type){case "redaction":b=new fd(k,a);break;case "note":e&&(b=new gd(k,a));break;case "stamp":e&&(b=new hd(k,a));break;default:b=new Za(k,a)}if(!b)return;c[k]=b;f++;e=!0;d.batchMode()&&(e=(e=z.forRange(b.range))&&e.spreadsheetModel()?e.spreadsheetModel().containsRange(b.range):
!1);if(e){if(e=b,e.addToDocument(),(k=ha.infoRaw())&&1557===k.fi&&"text"==e.range.type)for(k=z.count(),n=0;n<k;n++)(r=z.page(n))&&!r.isLoaded()&&r.containsRange(e.range)&&W(n,!0,e)}else g.push({type:"add",highlight:b}),L();d.link(b)}d.on.add.dispatch(b);!0===a.activate?ca(b.id):C&&(d.activateNearest(C.x,C.y,null,!1),C=null);return b.id},L=function(){k||(k=!0,F.onidle(da))},P=function(a,b){if(0!==c.length&&!d.batchMode())for(var e=a;e<=b;e++){var f=z.page(e);f&&f.isLoaded()&&(g.push({type:"addall",
pageIndex:e,loadPage:!1}),L())}},M=function(a,c){for(var b=g.length-1;0<=b;b--){var d=g[b];d.highlight!==a||c&&-1==c.indexOf(d.type)||g.splice(b,1)}},ra=function(a){M(a);g.push({type:"show",highlight:a});L()},T=function(a){M(a);g.push({type:"hide",highlight:a});L()},W=function(a,c,b){g.push({type:"addtopage",pageIndex:a,loadPage:!!c,highlight:b});L()},da=function(){G.suspendUpdate();var a=[],b;R.performance&&(b=R.performance.now());for(var e=0;0<g.length;e++){var f=g.shift();if(void 0!==f.pageIndex){var n=
z.page(f.pageIndex);if(n.isLoaded())if(void 0===f.highlight){if(n&&n.isLoaded())for(var r=0;r<c.length;r++){var h=c[r];h&&n.containsRange(h.range)&&W(f.pageIndex,!1,h)}}else f.highlight.addToPage(f.pageIndex);else if(!0===f.loadPage){var m=f;n.load(!1,function(){g.unshift(m);L()})}}else void 0!==f.highlight&&("show"===f.type&&f.highlight.isHidden()?f.highlight.show():"hide"===f.type?f.highlight.hide():(f.highlight.addToDocument(!1),a.push(f.highlight)));if(10<=e)if(void 0!==b){if(0==e%10&&50<R.performance.now()-
b)break}else if(20<=e)break}for(b=0;b<a.length;b++)d.link(a[b]);0===g.length&&k&&(k=!1,F.offidle(da));G.resumeUpdate()};d.findNearest=function(a,b){if(void 0!==t){var d=z.mapToPage(a,b,null,!0,!0);if(d){var e=d.page;a=d.x;b=d.y;for(var g,f,k,n=0;n<c.length;n++){var r=c[n];if(r&&!r.isHidden()&&r.isOnPage(e.index)){var h=r.distanceFromPoint(e.index,a,b,d.inAnnotation);void 0!==h&&(0===h.x&&0===h.y?(g||(g=[]),g.push(r),f=h):!g&&(void 0===f||h.ay<f.ay||h.ay==f.ay&&h.ax<f.ax)&&(f=h,k=r))}}if(g)return{highlights:g,
distance:f};if(k)return{highlights:[k],distance:f}}}};d.activateNearest=function(a,b,e,g){var f=m,k=Q,n=I;!1!==g&&(g=!0);if(void 0===t)C&&(C.x=a,C.y=b);else{var r=d.findNearest(a,b);if(r)if(f=void 0,n=k=!1,1<r.highlights.length){var h=d.active();if(void 0!==h)for(var l=0;l<r.highlights.length;l++)if(r.highlights[l].id==h){++l>=r.highlights.length&&(l=0);f=r.highlights[l].id;break}void 0===f&&(f=r.highlights[0].id)}else f=r.highlights[0].id,k=r.distance,n=0>k.y||0===k.y&&0>k.x,k=0<k.y||0===k.y&&0<
k.x;else{if(r=z.mapToPage(a,b,null,!0,!0))for(l=r.page,f=t;void 0!==f;f=c[f].nextId)if((r=z.forRange(c[f].range))&&r.index>=l.index){h=r;break}h||(f=u,h=z.forRange(c[f].range));h.index<l.index?k=!0:n=!0}}if(f!=m||k!=Q||n!=I)return!1!==g||n||k?e||n||k||(n=!0):n=!0,ca(f,n,k,!0,!1),d.active()};var Ra=function(a){ca(void 0,!1,!1,a)},ca=function(a,b,e,g,f,k){var n;if(!J&&(a=(n=Z(a))?n.id:void 0,!0!==b&&(b=!1),!0!==e&&(e=!1),!1!==f&&(f=!0),(n=a!=m||b!=I||e!=Q)&&(k=!1),n||k)){void 0!==a&&d.isHidden(a)&&
(a=void 0);if(!k){if(n=c[m])n.hideDialog(),n.deactivate();n=m;m=a;void 0!==n&&c[n]&&c[n].isEmptyRedaction()&&d.remove(n,!0);I=b;Q=e}if(void 0!==m&&!b&&!e&&c[m]){n=c[m];if(f){z.moveto(n.range,function(){ca(a,b,e,g,!1,!0)});return}if(n.isNote())S.select(null);else{J=n;S.select(n.range,n.id);f=qb(n.style());var r;f.color&&(r="color:"+f.color+";background-color: rgba(255,255,255,0);");S.hide(r);J=null}w.viewNode.focus();n.activate(k);n.comment()&&!n.isNote()&&d.showComment(n.id,{mode:"view"})}!1!==g&&
(n=Z(m),d.on.activate.dispatch(n,I,Q))}};d.highlight=function(a){return c[a]};var fa=function(a,c,b,d,e){d=d||b;if(a=Z(a,c,b))return"string"==typeof d?a[d].apply(a,e):d.apply(null,e)},Z=function(a,b,e){var g;void 0===a&&(a=b);"number"===typeof a&&c[a]?g=c[a]:e&&d.invalidArg(e,"id",a);return g};d.link=function(a){var b=a.id;d.unlink(a,!0);if(!a.isHidden()){var e=a.generateKey();if(e)if(void 0===t)u=t=b;else for(var g=u;;){var f=c[g],k=f.key,n=!1;e.page>k.page?n=!0:e.page==k.page&&(e.y>k.y?n=!0:e.y==
k.y&&(e.x>k.x?n=!0:e.x==k.x&&b>g&&(n=!0)));if(n){g===u?u=b:(a.nextId=f.nextId,c[a.nextId].prevId=b);a.prevId=g;f.nextId=b;break}if(g===t){a.nextId=g;t=f.prevId=b;break}g=f.prevId}}};d.unlink=function(a,b){!0!==b&&a.id==m&&(Ra(),m=void 0);if(void 0!==a.prevId||void 0!==a.nextId||t==a.id){var d=void 0!==a.prevId?c[a.prevId]:null,e=void 0!==a.nextId?c[a.nextId]:null;d?d.nextId=a.nextId:t=a.nextId;a.nextId=void 0;e?e.prevId=a.prevId:u=a.prevId;a.prevId=void 0}};d.positionAll=function(a){d.each("positionAll",
a);d.alignHighlight()};d.validateStyles=function(a){void 0!==a&&(r=!1!==a);return r};d.updateHighlights=function(){P(p,l);d.positionAll(z.activeOverlay())};var la=function(){for(;h<c.length&&c[h];)h++;h>=c.length&&(h=c.length,c.push(null));return h};d.each=function(a,b){Ab(c,arguments)};d.eachOnPage=function(a,b){Y(c,a,function(a){return b.containsRange(c[a].range)},b.index)};var sa=function(a,c,b,e){if(a<c.length){c=c[a];if(Array.isArray(c)){b.range=c;for(var g=0;g<c.length;g++)wa(c[g])||(b.range=
null)}else Ia(c)||Ka(c)?b.range=c:b.range=wa(c);b.range&&a++}b.range||("text"===F.selectionType()&&(b.range=V.getSelection(),b.range&&b.range.isCollapsed&&(b.range=void 0)),b.range||(b.range=F.selection()),b.range?b.activate=!0:(d.invalidArg(e,"range",null,"A range was not specified and nothing is currently selected"),b.invalid=!0));return a},ta=function(a,c,b,e){if(1>c.length||"string"!==typeof c[0])d.invalidArg(e,"style",null,"A highlight style must be specified"),b.invalid=!0},xa=function(a,c,
b,e){var g;a<c.length&&"string"===typeof c[a]&&(g=c[a]);b.style=aa(g,"hl-text"!=b.type);b.style?a++:(d.invalidArg(e,"style",g),b.invalid=!0);return a},va=function(a,c,b,d,e){a<c.length&&(c=c[a],c instanceof Object||"object"==typeof c?(b[d]=c,a++):null!==c&&void 0!==c||a++);return a},za=function(a,c,b,d,e){a<c.length&&(c=c[a],c instanceof String||"string"==typeof c?(b[d]=c,a++):null!==c&&void 0!==c||a++);return a},ua=function(a,c,b,e){for(;a<c.length&&void 0===c[a];)a++;a<c.length&&(d.invalidArg(e,
null,null,"Unexpected argument(s)"),b.invalid=!0);return a},ya=function(){d.each("updateStyle","isRedaction");oa()};x.onredactionColor(ya);x.onredactionFillColor(ya);x.onnochrome(function(){d.positionAll(z.activeOverlay())});x.onshowSlideNotes(d.updateHighlights);x.onshowHighlightLabels(function(a){d.each("showLabel",null,a)});x.onhighlightLabelFontFamily(b);x.onhighlightLabelFontSize(b);x.onhighlightActivationBoxColor(function(a){if(null===a)F.screenCSS(".oit-highlight-active .oit-activation","display:none;"),
F.screenCSS(".oit-highlight-embed","display:none;"),F.screenCSS(".oit-highlight-active .oit-resize div","display:none;"),F.screenCSS(".oit-text-handle div:nth-child(2)","display:none;"),F.screenCSS(".oit-text-handle div:first-child","display:none;"),F.screenCSS(".oit-text-handle",null);else if(a=Fa(a)){var c="rgb("+a.r+","+a.g+","+a.b+")",b="border:2px solid "+c+";opacity:"+a.a+";";F.screenCSS(".oit-highlight-active .oit-activation",b);b="border:1px solid "+c+";opacity:"+a.a+";";F.screenCSS(".oit-highlight-embed",
b);b="background-color:"+c+";";F.screenCSS(".oit-highlight-active .oit-resize div",b);F.screenCSS(".oit-text-handle div:nth-child(2)",b);F.screenCSS(".oit-text-handle div:first-child","border-bottom: 7px solid "+c+";");b="opacity:"+a.a+";";F.screenCSS(".oit-text-handle",b)}});b=function(a,c,b){if((a=z.activePage())&&a.isSpreadsheet()&&!b.inAnnotation())return!0;a="tap"===c.type?w.viewNode.touchPos(c):w.viewNode.mousePos(c);void 0===d.activateNearest(a.x,a.y,c,!0)&&b&&d.activate(b.id);return void 0!==
d.active()?!1:!0};d.on.click.setDefaultListener(b);d.on.tap.setDefaultListener(b);F.onscroll(function(){d.alignComment()});F.onreset(function(){d.on.removeAllElements();d.clear();a=0;c=[];h=f=0;v=u=t=q=void 0;l=p=-1;H=m=void 0;Q=I=!1;J=void 0;D=N=!1;O=void 0;B={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0};g=[];k&&(k=!1,F.offidle(da));C={x:0,y:0};K=[]});F.onload(function(){if(q){var a=q;q=null;
d.apply(a)}});F.onzoom(function(a,c,b){d.positionAll(z.activeOverlay())});ga.ondata(function(a,c,b){a.highlights&&d.apply(a.highlights);if(a.stamps)for(var e in a.stamps)v[e]=a.stamps[e]})}}),Lc=xa.extend("hyperlinks",{userEventDef:{pub:!0,detail:function(d,e,b){d={srcEvent:e,url:b.url};b.range&&(d.range=ea(b.range));b.alt&&(d.alt=b.alt);d.external=0!==d.url.indexOf("#");return d}},install:function(d){var e,b,a={},c=0,f=!1,h=null,q=null,t,u=function(a,c,b){if(c){var e=b+10;e>c.length&&(e=c.length);
for(;b<e;b++){var f=c[b],h=f.range;if(h)if("text"===h.type)H(a,f);else if("rect"==h.type&&h.page===a.index){if(!a.linkMap){var m=a.childByClass("oit-svg"),r=m.byClass("oit-svg-text");if(r&&0<r.length){r=r[0];a.linkMap=y.create("div","oit-area-hyperlinks");a.linkMap.attr("style",r.attr("style"));if(r.classList)for(var g=0;g<r.classList.length;g++){var k=r.classList.item(g);"oit-svg-text"!==k&&a.linkMap.addClass(k)}m.append(a.linkMap)}}a.linkMap&&(h="left:"+h.left+"px;top:"+h.top+"px;width:"+(h.right-
h.left)+"px;height:"+(h.bottom-h.top)+"px;",m=y.create("div"),m.attr("style",h),a.linkMap.append(m),d.on.addElement(m,f),h={anchorNode:m,page:a},f.anchors||(f.anchors=[]),f.anchors.push(h))}}}return b},v=function(a,c,b){if(c){var d=b+10;d>c.length&&(d=c.length);for(;b<d;b++){var e=c[b],f=e.range;if(f&&"text"===f.type){var h=a.findRange(f.acc,f.accend);h&&Y(h,"addDataToRange",null,f,e)}}}return b},p=function(c,b,d){c=0;b&&(c=b.button||0);if(0!==c||!d.targetId)return!0;h=null;(b=a[d.targetId])?(d=y.byId(d.targetId)||
b.range||b.page,void 0!==d&&z.movetoEx(d,{force:!0,moveToTop:!0}),f&&(ya.hideMessage(),f=!1)):ga.isPending()?(f||(ya.showMessage(OIT.local.PLEASE_WAIT_INITIALIZING),f=!0),h=d,ga.on.add.listenOnce(function(){h&&p(null,null,h)})):f&&(ya.hideMessage(),f=!1);return!1};d.on.click.setDefaultListener(p);d.on.tap.setDefaultListener(p);ga.ondata(function(d,f,h){var m;if(d.hyperlinks){e=e?e.concat(d.hyperlinks):d.hyperlinks;for(f=0;f<d.hyperlinks.length;f++)h=d.hyperlinks[f],h.type="hyperlink",h.id="oit-hl-"+
++c,m=h.url,0===m.indexOf("#")&&(h.targetId=m.substring(1)+"."+y.expando,h.url="#"+h.targetId);h=z.count();for(m=0;m<h;m++)(f=z.page(m))&&f.isLoaded()&&!f.isHidden()&&u(f,d.hyperlinks,0)}if(d.bookmarks){b=b?b.concat(d.bookmarks):d.bookmarks;for(f=0;f<d.bookmarks.length;f++)h=d.bookmarks[f],m=h.name,h.type="bookmark",h.id=m+"."+y.expando,a[h.id]||(a[h.id]=h);h=z.count();for(m=0;m<h;m++)(f=z.page(m))&&f.isLoaded()&&v(f,d.bookmarks,0)}});var l=function(){if(q){for(var a,c=0;c<q.length;c++){var d=q[c];
if(d.page.isLoaded()){var f=!0;d.page.isHidden()?f=!1:(e&&(d.hindex=u(d.page,e,d.hindex),d.hindex<e.length&&(f=!1)),b&&(d.bindex=v(d.page,b,d.bindex),d.bindex<b.length&&(f=!1)));f||(a||(a=[]),a.push(d))}}q=a}q||(t&&(Ua(t),t=void 0),F.offidle(l))},m=function(a,c,b){a.addDataToRange(c,b);"OIT.ihs(event)"==a.attr("onmouseover")&&a.attr("onmouseover",null);"OIT.ihs(event)"==a.attr("ontouchstart")&&a.attr("ontouchstart",null)},H=function(a,c){var b=c.range,d=a.findRange(b.acc,b.accend);d&&Y(d,m,null,b,
c)};z.onpageload(function(a,c){q||(q=[]);if(-1==q.indexOf(a)&&(q.push({page:a,hindex:0,bindex:0}),1==q.length))if("rt"!=a.type&&"sn"!=a.type||t)t=sb(l,75);else F.onidle(l)});z.onpageunload(function(a){if(e)for(var c=0;c<e.length;c++){var b=e[c];if(b.anchors)for(var f=b.anchors.length-1;0<=f;f--){var h=b.anchors[f];if(h.page===a){d.on.removeElement(h.anchorNode);1==b.anchors.length?b.anchors=void 0:b.anchors.splice(f,1);break}}}delete a.linkMap});F.onreset(function(){d.on.removeAllElements();b=e=void 0;
a={};c=0;q=h=null;t&&(Ua(t),t=void 0)});pb("ihs",function(a){if(e)for(var c=mb(a.currentTarget),b,d=0;d<e.length;d++){var f=e[d];bb(c,f.range)&&(b||(b=z.forNode(a.currentTarget)),b&&H(b,f))}})}}),ob=xa.extend("attachments",{exports:["describe","setOptions"],userEventDef:{pub:!0,detail:function(d,e,b){(d=ob.describe(b))?d.attachment=b:d={};d.srcEvent=e;return d},onListen:function(){ob.onListen()},onUnlisten:function(){ob.onUnlisten()},onAdd:function(){ob.onListen()},onRemove:function(){ob.onUnlisten()}},
install:function(d){var e=[],b,a=0;d.item=function(a){return e[a]};d.describe=function(a){var c;0===arguments.length?c=Wa(e):isNaN(a)||0<=a&&a<e.length&&(c=Wa(e[a]));return c};d.setOptions=function(a){a&&(b||(b=new tb),a.hasOwnProperty("cursor")&&b.setRule(".oit-attachedFile {cursor:"+a.cursor+"}","cursor"),a.hasOwnProperty("color")&&b.setRule(".oit-attachedFile {color:"+a.color+"}","color"))};d.onListen=function(){0===a&&w.viewNode&&w.viewNode.addClass("oit-attachevents");a++};d.onUnlisten=function(){0<
a&&0===--a&&w.viewNode&&w.viewNode.removeClass("oit-attachevents")};F.onload(function(){0<a?w.viewNode.addClass("oit-attachevents"):w.viewNode.removeClass("oit-attachevents")});F.onreset(function(){e=[];b&&(b.destroy(),b=void 0)});ga.ondata(function(a,b,d){if(a.attachments)for(d=0;d<a.attachments.length;d++)b=a.attachments[d],b.id=e.length,e.push(b);if(a.pages)for(var c=0;c<a.pages.length;c++){var f=a.pages[c].attachments;if(f)for(d=0;d<f.length;d++)b=f[d],b.id=e.length,e[b.id]=b}})}}),Mc=xa.extend("archive",
{userEventDef:{pub:!0,detail:function(d,e,b){return{nodeid:b,name:d.text(),srcEvent:e}}}}),Na=xa.extend("multimedia",{events:{loading:{pub:!0,detail:function(d){return{elem:d}}},failedToPlay:{pub:!0,detail:function(d,e){return{elem:d,error:e}}},canPlay:{pub:!0,detail:function(d){return{elem:d}}},missingContent:{pub:!0,detail:function(d,e){return{elem:d,status:e}}},internalError:{pub:!0,detail:function(d,e,b){return{elem:d,err:e,details:b}}},loaded:{pub:!0,detail:function(d,e){return{elem:d,success:e}}}},
exports:["setOptions","getOptions","MissingContentStatus"],install:function(d){var e={disableCaching:!1};d.MissingContentStatus={MISSING_AUDIO:"no audio",MISSING_VIDEO:"no video"};var b={CORS_ERROR:"Unable to determine the type of multimedia error that occurred. Request blocked by CORS. Ensure the CORS preflight request and the actual request did not fail.",PLAYBACK_ERROR:"Unable to play multimedia file format. Codec is unsupported by browser.",TIMEOUT:"Unable to determine the type of multimedia error that occurred. Request timed out.",
INTERNAL_ERROR:"Unable to determine the type of multimedia error that occurred. An internal error occurred."};d.getOptions=function(){return Wa(e)};d.setOptions=function(a){a.hasOwnProperty("disableCaching")&&(e.disableCaching=a.disableCaching)};d.detectError=function(a,c){if(a)if("string"===typeof a&&(a={url:a}),"string"===typeof a.url&&0<a.url.trim().length){a.timeout=a.timeout||2E3;var e=!1,h=Ma({url:a.url,headers:{Range:"bytes=0-0"},loading:function(a,d,f,v){e||(e=!0,d=2===Math.round(v/100)?"PLAYBACK_ERROR":
0===v?"CORS_ERROR":"INTERNAL_ERROR",c({url:a,error:d,message:b[d]||"Missing error message"}),lb(h))},success:function(a,d,f,h){e||(e=!0,c({url:a,error:"PLAYBACK_ERROR",message:b.PLAYBACK_ERROR||"Missing error message"}))},error:function(a,d,f,h){e||(e=!0,c({url:a,error:"INTERNAL_ERROR",status:httpCode,message:b.INTERNAL_ERROR||"Missing error message"}))}})}else d.invalidArg("detectError","request.url",a.url,"expected non-empty string");else d.invalidArg("detectError","request",a,"expected either url as string or { url: string, timeout?: number }")};
d.load=function(a){function c(a,c){e||(e=!0,d.detectError({url:a.dom.currentSrc,timeout:2E3},function(b){console.log("mod.multimedia.detectError",b);switch(b.error){case "PLAYBACK_ERROR":d.on.failedToPlay.dispatch(a,c);break;default:d.on.internalError.dispatch(a,c,b)}}),d.on.loaded.dispatch(a,!1))}function b(a){if(!q){q=!0;var c=a.dom,b=function(a){return"undefined"!==typeof a};c instanceof HTMLVideoElement&&((b(c.webkitDecodedFrameCount)&&0==c.webkitDecodedFrameCount||b(c.mozDecodedFrames)&&0==c.mozDecodedFrames||
b(c.videoTracks)&&0==c.videoTracks.length)&&d.on.missingContent.dispatch(a,d.MissingContentStatus.MISSING_VIDEO),(b(c.mozHasAudio)&&!c.mozHasAudio||b(c.webkitAudioDecodedByteCount)&&0==c.webkitAudioDecodedByteCount||b(c.audioTracks)&&0==c.audioTracks.length)&&d.on.missingContent.dispatch(a,d.MissingContentStatus.MISSING_AUDIO));d.on.canPlay.dispatch(a);d.on.loaded.dispatch(a,!0)}}if(a){d.on.loading.dispatch(a);var e=!1,q=!1;a.dom.addEventListener("canplay",function(){b(a)});a.dom.addEventListener("error",
function(b){c(a,b)});for(var t=a.dom.getElementsByTagName("source"),u=0,v=0;v<t.length;v++)t[v].addEventListener("error",function(b){u++;u>=t.length&&!e&&c(a,b)});a.dom.load()}else d.invalidArg("load","media",a,"cannot be null or undefined")}}}),za=xa.extend("toolbars",{exports:["add","hide","remove","setSize","show"],events:{add:{pub:!0,detail:function(d,e){return{id:d,edge:e}}},remove:{pub:!0,detail:function(d,e){return{id:d,edge:e}}},show:{pub:!0,detail:function(d,e,b,a){return{id:d,edge:e,width:b,
height:a}}},hide:{pub:!0,detail:function(d,e){return{id:d,edge:e}}},resize:{pub:!0,detail:function(d,e,b,a){return{id:d,edge:e,width:b,height:a}}},resizeinternal:{}},install:function(d){var e=["left","top","right","bottom"],b=[],a,c,f=function(){ab(b,"refresh");ha.dispatchResize()};ha.onresize(f);z.onchange(function(){var a=z.activeOverlay();a!=c&&(c=a,f())});d.add=function(c,f,h){var q;if(-1===e.indexOf(c))d.invalidArg("add","edge",c,"Must be one of "+JSON.stringify(MEMORY_MODELS));else if(y.isElement(f)){var p,
l=!1,m=!1,t=!1,I;h&&(h.size&&((p="auto"===h.size?h.size:yb(h.size))||d.invalidArg("add","options.size",h.size,"Must be a valid CSS length or 'auto'")),!0===h.visible&&(l=!0),!0===h.overlay&&(m=!0),!0===h.resizable&&(t=!0),h.border&&(I=h.border));var u;a?(u=b[a],q=++a):q=a=1;h=w.viewNode;var J=h.scroll();f=new Rb(q,c,y.wrap(f),I,u);m&&f.overlay(!0);t&&f.resizable(!0);b[q]=f;p&&f.setSize(p);h.scroll(J);d.on.add.dispatch(q,c);l&&d.show(q)}else d.invalidArg("add","elem",f,"Must be a valid DOM Element");
return q};d.addInternal=function(a,c){b[a]=c};d.removeInternal=function(a){var c=b[a];c&&(c.remove(),delete b[a])};d.internalParent=function(a){var c,d;for(d in b)d=Number(d),d>a&&(void 0===c||d<c)&&(c=d);if(void 0!==c)return b[c]};d.remove=function(a){ab(b,h,a);f()};var h=function(c){var d=c.id;c.remove();for(b[d]=void 0;!b[a];)if(0>=--a){a=void 0;break}return!0};d.setSize=function(a,c){a=Number(a);var e=b[a];e&&!e.isInternal()||d.invalidArg("setSize","id",a,"Must be a valid toolbar id returned by OIT.toolbars.add");
var h="auto"===c?c:yb(c);h?e&&(e.setSize(h),f()):d.invalidArg("setSize","size",c,"Must be a valid CSS length or 'auto'")};d.show=function(a,c){ab(b,"show",a,c||{});f()};d.hide=function(a){ab(b,"hide",a);f()}}}),ub,Sb,Tb,Nc;(function(){var d=null,e={},b=0;ub=function(a,c,b,d,e,t){if(b&&"text"===c.type&&c.accend>c.acc&&(e=a.findRange(c.acc,c.accend,e))&&0<e.length)return d={type:"style",id:d,priority:t||0},"string"===typeof b?d.className=b:d.props=b,!b.color&&e[0].hasClass("oit-tt")&&(t=e[0].computedStyle().color,
t=Fa(t),t.a=1,b.color=La(t)),Y(e,"addDataToRange",null,c,d),a.pageLayoutChanged(),e};Tb=function(a,c,b,d){b&&a&&0<a.length&&(c={type:"style",id:c,priority:d||0},"string"===typeof b?c.className=b:c.props=b,!b.color&&a[0].hasClass("oit-tt")&&(d=a[0].computedStyle().color,d=Fa(d),d.a=1,b.color=La(d)),Y(a,"changeData",null,c))};Sb=function(a,c){Y(a,"removeData",null,"style",c)};Nc=function(a){a=cc(a,!0);var c=e[a];c||(c="oit-ss"+ ++b,e[a]=c,d||(d=new tb),d.addCSSText("."+c+" {"+a+"}"));return c};F.onreset(function(){d&&
(d.destroy(),d=null);e={};b=0})})();ua.extend(["page","drawing","slide","chart"],{de:"page",showhidden:!1,cellselection:!1});ua.extend("bitmap",{de:"page",showhidden:!1,textselection:!1,cellselection:!1,customtextselection:!1});ua.extend("html",{de:"page",rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1,elasticScroll:!1});ua.extend("email",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});ua.extend("rt",
{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});ua.extend("sn",{de:"page",showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1});xb.extend("page",{install:function(d){var e,b=1,a=null,c,f,h,q,t,u=w.isMobileOrTablet?10:20,v=!1,p,l=0,m=0,H,I;d.load=function(h){e=h.overlay;b=1;a=null;c=h.type;f=void 0;if(!w.isMobile&&void 0===w.singlePageIndex)F.onidle(g);Q(h);z.onadd(d,J);z.onchange(d,
k);S.onbeginselection(d,E);F.onscroll(d,ja);if("email"===c)ha.onresize(d,C);x.onremoveExtraEmailHeaders(d,na);x.onscrollMode(d,A);x.onpresentationMode(d,U);x.onnochrome(d,n);x.onshowEmailAddresses(d,X);x.onshowAnnotations(d,oa);n(x.nochrome);r(h.index);oa();k()};d.unload=function(){F.screenCSS(".oit-annopane",null);z.offadd(J);z.offchange(k);S.offbeginselection(E);F.offscroll(ja);ha.offresize(C);x.offremoveExtraEmailHeaders(na);x.offscrollMode(A);x.offpresentationMode(U);x.offnochrome(n);x.offshowEmailAddresses(X);
x.offshowAnnotations(oa);w.isMobile||F.offidle(g);f&&(f.destroy(),f=void 0);a&&a.hideStickyHeader();e=null;b=1;a=null;h=f=t=q=c=void 0;u=w.isMobileOrTablet?10:20};d.visiblePages=function(){var a=[];if("email"===c)e.each(function(c){a.push(c)});else if("vertical"==x.scrollMode&&void 0===w.singlePageIndex){var b=z.count(),d,g,f,k=z.current();for(d=k-1;0<=d;d--)if((g=z.page(d))&&g.isEnabled()){if(g.overlay!=e)break;f=g.pageRect("view");if(0>=f.bottom)break;k=d}a.push(z.page(k));var n=w.viewNode.clientHeight-
10;for(d=k+1;d<b;d++)if((g=z.page(d))&&g.isEnabled()){if(g.overlay!=e)break;f=g.pageRect("view");if(f.top>n)break;10<f.bottom&&a.push(g)}}else a.push(z.activePage());return a};d.saveScrollPos=function(){var a=z.page(d.visiblePages()[0]);if(a){var c=a.pageRect("view");return{page:a,offset:c.top/c.height}}};d.restoreScrollPos=function(a){if(a&&a.page&&void 0!==a.offset){var c=a.page.pageRect("view");(a=c.top-a.offset*c.height)&&w.viewNode.dscroll(void 0,a)}};d.scrollPadding=function(){if(a)return a.scrollPadding()};
d.margin=function(){return{left:u,top:u,right:u,bottom:u}};var Q=function(c){if(c._emailHeader){a=c._emailHeader;a.applyShowEmailAddresses();var b=c.overlay.firstPage,d=z.page(b.index+1);b&&b.load(!0,function(){d?d.load(!0,function(){d.parent()!=b.parent()&&b.parent().append(d);C()}):C()})}};d.layoutChanged=function(a){if(e){var c=w.viewNode,d=x.zoom;a||(a={x:0,y:0});var g=c.scroll(),f=null,n=null,r;r=u/x.zoom;1!=d&&(f=["scale(",d,",",d,")"].join(""),n="left top");r=2*r+z.annotationPaneWidth();r=
"vertical"==x.scrollMode?r+e.maxWidth:r+z.activePage().width;e.css({transform:f,"transform-origin":n,"min-width":r+"px"});N();f=d/b;c.scroll((a.x+g.left)*f-a.x,(a.y+g.top)*f-a.y);b=d;k()}};var J=function(a){H||(H=ca(function(){H=void 0;N(!0);r()},500))},N=function(a){if(e){var b=x.rotation,d={yOffset:0,maxWidth:0,height:0},g=z.top(),k=[],n=x.centerPages,r=u/x.zoom;if("email"===c)n=!1,k.push(".oit-emailbk{"),k.push("margin:",r,"px"),k.push("}"),k.push(".oit-email-stickyheader{"),k.push("left:",r,"px"),
k.push("}");else if("html"===c||"rt"===c)n=!1;if(n){k.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");k.push("margin:",r,"px 0 ",r/2,"px 0");k.push("}");k.push(".oit-sn{");k.push("margin:0 0 ",2*r,"px 0");k.push("}");if(!x.nochrome&&0!==b){k.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");switch(b){case 90:k.push("box-shadow:-1px 1px 5px 0 rgba(0,0,0,.25) !important");break;case 180:k.push("box-shadow:-1px -1px 5px 0 rgba(0,0,0,.25) !important");break;case 270:k.push("box-shadow:1px -1px 5px 0 rgba(0,0,0,.25) !important")}k.push("}")}k.push(".oit-page:last-of-type,.oit-bitmap:last-of-type,.oit-drawing:last-of-type,.oit-slide:last-of-type,.oit-chart:last-of-type,.oit-sn:last-of-type{margin-bottom:",
r,"px;}")}"vertical"==x.scrollMode?e.each(D,null,k,b,n,r,d):D(z.activePage(),k,b,n,r,d);0===d.maxWidth?e.css("width",null):(d.maxWidth+=u+u,e.css("width",d.maxWidth+"px"));0===d.height?e.css("height",null):(d.height+=u,e.css("height",d.height+"px"));k=k.join("");f||(f=new tb);f.setCSSText(k);!g||h||a||"vertical"!=x.scrollMode||void 0!==w.singlePageIndex||(a=x.disableAnimation,x.disableAnimation=!0,z.moveto(g),x.disableAnimation=a);e.each(function(a){a.pageLayoutChanged();a.positionAnnotations()});
P.positionAll(e)}},D=function(a,b,d,e,g,f){var k=0,n=0,r,h=w.viewNode.clientWidth,m=z.annotationPaneWidth();a.resetCache();if("sn"==a.type)e&&(k=(h/x.zoom-(a.offsetWidth+m))/2,k<g&&(k=g)),n=f.yOffset;else{if("email"===c||"html"===c||"rt"===c)d=0;switch(d){case 0:e&&(k=(h/x.zoom-(a.offsetWidth+m))/2,k<g&&(k=g));break;case 90:e&&(n=(h/x.zoom-(a.offsetHeight+m))/2,n<g&&(n=g));k=-f.yOffset-a.offsetWidth;f.yOffset=f.yOffset-a.offsetHeight+a.offsetWidth;a.offsetHeight>f.maxWidth&&(f.maxWidth=a.offsetHeight);
f.height+=a.offsetWidth+u;r="rotate(270deg) ";break;case 180:e&&(k=-((h/x.zoom-(a.offsetWidth+m))/2),k>-g&&(k=-g));k-=a.offsetWidth;n=-a.offsetHeight;r="rotate(180deg) ";break;case 270:e&&(n=-((h/x.zoom-(a.offsetHeight+m))/2),n>-g&&(n=-g)),n-=a.offsetHeight,k=f.yOffset,f.yOffset=f.yOffset-a.offsetHeight+a.offsetWidth,a.offsetHeight>f.maxWidth&&(f.maxWidth=a.offsetHeight),f.height+=a.offsetWidth+u,r="rotate(90deg) "}}k=L(k);n=L(n);if(0!==k||0!==n||r){b.push("#",a.id.replace(/\./g,"\\."));b.push(" {");
if(0!==k||0!==n||r)b.push(ib.transform,":"),r&&b.push(r),0===k&&0===n||b.push("translate(",k,"px,",n,"px)"),b.push(";");b.push("}")}};d.moveto=function(b,d,e){var g=!1,f;e=e||{};if(jc(b))if(a)g=a.moveto(b,d,e);else{if("slide"==c&&(f=z.forRange(b))&&f.annotationPane()){var k=f.annotationPane().range();bb(k,b)&&f.annotationPane().activate(b,!0,!0,d,e)}}else"number"===typeof b&&(g=w.viewNode,f=z.page(b),r(f.index),(b=e.gotoNode)&&b!==f?b=z.elementRect(b,"overlay"):(b=f.pageRect("overlay").clone(),b.top-=
u),f=g.scroll().top,b=f+(b.top-f),0>b&&(b=0),b!=f?(F.on.scrollupdate.disable(),g.abortAnimation(),f=!1!==e.animate?150:0,h=!0,g.animate({scrollTop:b,time:f,endFn:O,args:[d,e]})):d&&d(e),g=!0);return g};var O=function(a,c,b){h=!1;F.on.scrollupdate.enable();F.on.scrollupdate.dispatch();c&&c(b)},B=function(a){"sn"!=a.type&&(t&&a.hiddenFromSlideshow?a.hide():a.show())},r=function(a){var b=!1;"vertical"===x.scrollMode&&void 0===w.singlePageIndex?w.viewNode.removeClass("oit-single"):w.viewNode.addClass("oit-single");
if("vertical"==x.scrollMode&&void 0===w.singlePageIndex||"email"===c||"html"===c||"rt"===c)void 0!==q&&(e.showPages(),q=void 0,b=!0,t=!1),a="slideshow"==x.presentationMode,a!=t&&(t=a,b=!0,e.each(B));else if(a=a||z.current(),a!=q){var d=z.page(a);if(d){var g;void 0===q?e.hidePages(d.index):(g=z.page(q),d.addClass("oit-noshadow"));d.show({insertLast:!0,animate:!0,endFn:function(){d.removeClass("oit-noshadow");g&&g.hide()}});q=a;b=!0;w.isMobileOrTablet&&e.css("min-height",d.height+u+u+"px")}}b&&(F.dispatchPageEvents(!0),
P.positionAll(e))};d.pageRange=function(a,c){if("rect"===c){var b=z.page(a);if(b)return b=b.pageRect(),Fb(a,0,0,b.width,b.height)}};d.rangeRect=function(a,c,b,d){var e;if("text"===a.type){var g=z.forRange(a);g&&(e=g.textBoundingRect(a,d))}else"rect"===a.type&&(e=new la(a),void 0!==a.embedId&&((d=z.page(a.page))&&(g=d.embeddingRect(a.embedId)),g?e.offset(g.left,g.top):e=void 0));e&&(e.origin=c);return e};d.rangeFromRect=function(a,c,b,d,e,g,f,k){var n;if(a=z.page(a))c=new la(c,b,d,e,g),c.origin=a,
b=void 0!==k?a.embeddingRect(k):a.pageRect(),"html"!==a.type&&"rt"!==a.type&&"sn"!==a.type&&("move"===f?c.constrain(b):"select"!==f&&c.intersect(b)),void 0!==k?(c.offset(-b.left,-b.top),n=c.toRange(a),n.embedId=k,va(n,"pct")):n=c.toRange(a);return n};d.extendRange=function(a,c,b,e){var g=d.rangeRect(a,e);return d.rangeFromRect(a.page,g.left,g.top,c,b,e,"extend")};var g=function(a){if(!a)return z.loadNextPageFromServer()||F.offidle(g),!1},k=function(){if(!w.isMobile&&void 0===w.singlePageIndex)F.onidle(g);
void 0!==I&&sa(I);I=ca(function(){I=void 0;w.viewNode.scroll();for(var a=G.visiblePages(),c=0;c<a.length;c++){var b=a[c];b&&b.isPending()&&b.load(!1)}},100)},C=function(){e.each(ia);a&&a.applyViewSize()},K=function(){if("email"===c){var a=w.viewNode.clientWidth-146;30>a&&(a=30);return a}},ba=function(){if(this.hasClass("oit-ximage"))this.css("max-width",null),this.removeClass("oit-ximage"),this.addClass("oit-cimage");else if(this.hasClass("oit-cimage")){var a=K();this.css("max-width",""+a+"px");this.addClass("oit-ximage");
this.removeClass("oit-cimage")}C();z.each("pageLayoutChanged")},ia=function(a){if(a.hasClass("oit-rt")&&a.isLoaded()){var c=K();if(c!==a.pageContentMaxWidth){a.pageContentMaxWidth=c;for(var b,d,e=0;;e++){var g=a.embeddingByIndex(e);if(!g)break;var f=y.byId(g.id);if(f&&(c&&(g.w>c?(f.hasClass("oit-cimage")||(f.css("max-width",""+c+"px"),f.addClass("oit-ximage")),f.onclick(ba),f.ontap(ba)):(f.css("max-width",null),f.removeClass("oit-ximage"),f.removeClass("oit-cimage"),f.offclick(ba),f.offtap(ba))),
g=z.elementRect(f,a))){if(void 0===b||g.right>b)b=g.right;if(void 0===d||g.bottom>d)d=g.bottom}}void 0!==b&&a.css("min-width",b+10+"px");void 0!==d&&a.css("min-height",d+10+"px");if(c&&(b=a.childByTagName("div"))&&(b=b.childrenByTagName("TABLE")))for(d=0;d<b.length;d++)b[d].css("max-width",""+c+"px");a.pageLayoutChanged()}}},na=function(c){a&&c&&a.removeExtraEmailHeaders()},A=function(){e&&(r(),w.viewNode.scroll(0,0),z.updateActivePage())},U=function(){e&&r()},n=function(a){e&&(u=a?0:w.isMobileOrTablet?
10:20,r())},E=function(){a&&a.beginSelection()};d.startElasticScroll=function(){var a=x.scrollMode;"hswipe"!==a&&"vswipe"!==a||!G.features().elasticScroll||(w.viewNode.css("overflow","hidden"),v=!0,m=l=0)};d.elasticScroll=function(a,c){if(v){var b=x.scrollMode,d="hswipe"===b,b="vswipe"===b,g=0,f=0;void 0!==a&&d&&(l=g=-a,e.css("left",g+"px"));void 0!==c&&b&&(m=f=-c,e.css("top",f+"px"));if(g||f){w.viewNode.cancelKinetic();var b=z.activePage(),k=b.annotationPane();k&&k.hide();var n;if(0<g||0<f)n=z.prev(z.current());
else if(0>g||0>f)n=z.next(z.current());n&&n!==p&&(p&&(p.hide(),p.css({left:null,top:null,position:null}),p=void 0),n.overlay==b.overlay&&(f=g=0,n.index<b.index?d?g=b.pos(e).left/x.zoom-u-n.width:f=b.pos(e).top/x.zoom-u-n.height:d?g=b.rect(e).right/x.zoom+u:f=b.rect(e).bottom/x.zoom+u,n.css({left:g+"px",top:f+"px",position:"absolute",transform:"none"}),n.show({animate:!1}),(k=n.annotationPane())&&k.hide(),p=n))}gb()}};d.endElasticScroll=function(a,c){if(v){v=!1;w.viewNode.css("overflow",null);var b=
"hswipe"===x.scrollMode;w.viewNode.cancelKinetic();var d,g=z.activePage();b?(b=a/(g.width*x.zoom),d=a/w.viewNode.clientWidth):(b=c/(g.height*x.zoom),d=c/w.viewNode.clientHeight);d=Math.max(b,d);var f=b=0,k=g;-.25>d?k=z.prev(g.index)||g:.25<d&&(k=z.next(g.index)||g);k!==g&&(b=(w.viewNode.clientWidth-k.width*x.zoom)/2,b<u&&(b=u),d=u,f=k.pos(w.viewNode),b=l+b-f.left,f=m+d-f.top);e.animate({offsetLeft:b,offsetTop:f,time:100,transition:k!==g?"ease-in":"ease-out",endFn:function(){p&&(p!==k&&p.hide(),p.css({left:null,
top:null,transform:null}),p=void 0);e.css({left:null,top:null});k!==g&&(z.deactivateAnnotation(),w.viewNode.scroll(0,0),z.movetoEx(k.index,{animate:!1}),P.eachOnPage("addToPage",k));if(x.showAnnotations){var a=k.annotationPane();a&&a.show()}gb()}});gb()}};var ja=function(){if(a)a.onScroll()},X=function(){a&&a.applyShowEmailAddresses()},oa=function(){var a=x.showAnnotations;if(a){var c=z.activePage();c&&!c.supportsAnnotationBar()&&F.screenCSS(".oit-annopane","width:338px !important;");z.scrollToAnnotationPane(P.updateHighlights)}else z.deactivateAnnotation(),
F.screenCSS(".oit-annopane",null);e.each(function(c){(c=c.annotationPane())&&(a?c.show():c.hide())});F.dispatchPageEvents()}}});ua.extend(["worksheet","database"],{de:"ss",rotate:!1,textselection:!1,rectselection:!1,customtextselection:!1});xb.extend("ss",{install:function(d){var e,b,a,c,f=!1;d.load=function(f){e=f;c=a=b=null;if(b=f.spreadsheetModel())a=new id(b,e),(f=b.showHidden())?(f={columns:f.columns,rows:f.rows},d.showHidden(f)):a.showHidden(x.showHiddenColumns,x.showHiddenRows),a.doUpdate();
x.onshowHiddenRows(d,h);x.onshowHiddenColumns(d,q);x.onshowAnnotations(d,t);t()};d.unload=function(){x.offshowHiddenRows(h);x.offshowHiddenColumns(q);x.offshowAnnotations(t);c&&sa(c);a&&a.unload();c=a=b=null};d.maxPageWidth=function(){if(a)return a.maxPageWidth()};d.maxPageHeight=function(){if(a)return a.maxPageHeight()};d.padding=function(){if(a)return a.padding()};d.scrollOffset=function(){if(a)return a.scrollOffset()};d.getSelectedText=function(){return b?b.getSelectedText():""};d.select=function(a){return b?
b.select(a):!1};d.keydown=function(c){var d=!0;if(a)switch(c.keyCode){case 33:w.viewNode.dscroll(0,-(a.visibleHeight()+1));if(c=S.cellSelection())d=a.visibleRange(),d=d.r2-d.r1+1,c.c2=c.c1,c.r1-=d,0>c.r1&&(c.r1=0),c.r2=c.r1,S.select(c);d=!1;break;case 34:w.viewNode.dscroll(0,a.visibleHeight()+1);if(c=S.cellSelection())d=a.visibleRange(),d=d.r2-d.r1+1,c.c2=c.c1,c.r1+=d,d=b.rowCount()-1,c.r1>d&&(c.r1=d),c.r2=c.r1,S.select(c);d=!1;break;case 35:f=!f;d=!1;break;case 36:a.scrollToRange(0,0,0,0);c=ta(e.index,
0,0);S.select(c);d=f=!1;break;case 27:a.hidePopup(!0);d=f=!1;break;case 37:case 38:case 39:case 40:break;default:f=!1}return d};d.loadRange=function(a,c){b&&b.loadRange(a,c)};d.expandRange=function(a){b&&(a=b.expandRange(a));return a};d.moveto=function(c,b,d){return a?a.moveto(c,b,d):!1};d.showHidden=function(c){void 0===c&&(c="all");var d=b.showHidden(c);"string"===typeof c&&(c=d);a&&a.showHidden(c.columns,c.rows)};var h=function(){a&&a.showHidden(void 0,x.showHiddenRows)},q=function(){a&&a.showHidden(x.showHiddenColumns,
void 0)},t=function(){S.select(null);b&&b.showAnnotations(x.showAnnotations);a&&(a.showHidden(x.showHiddenColumns,x.showHiddenRows),a.update())};d.pageRange=function(a,c){if("cell"===c&&a==e.index)return ta(a,0,0,b.colCount()-1,b.rowCount()-1)};d.pageRect=function(c,b){if(a)return a.pageRect(c,b)};d.rangeRect=function(c,b,d){if(a)return a.rangeRect(c,b,d)};d.rangeFromRect=function(c,b,d,e,f,h,q,v){if(a)return a.rangeFromRect(c,b,d,e,f,h,q,v)};d.extendRange=function(c,b,d,e){if(a)return a.extendRange(c,
b,d,e)};var u=function(a,c){var d=fa(a+c,0,b.colCount()-1);if(0!==c&&b.colHidden(d)){var e=b.colCount()-1;do if(d+=c,0>d){for(d=0;d<=e&&b.colHidden(d);d++);break}else if(d>e){for(d=e;0<=d&&b.colHidden(d);d--);break}while(b.colHidden(d))}return d},v=function(a,c){var d=fa(a+c,0,b.rowCount()-1);if(0!==c&&b.rowHidden(d)){var e=b.rowCount()-1;do if(d+=c,0>d){for(d=0;d<=e&&b.rowHidden(d);d++);break}else if(d>e){for(d=e;0<=d&&b.rowHidden(d);d--);break}while(b.rowHidden(d))}return d};d.moveAnchor=function(c,
d,e,h){h=!1;f&&(0>d?d=-b.colCount():0<d&&(d=b.colCount()),0>e?e=-b.rowCount():0<e&&(e=b.rowCount()),f=!1);d=u(c.c1,d);e=v(c.r1,e);c.c1!=d&&(c.c1=d,h=!0);c.c2!=d&&(c.c2=d,h=!0);c.r1!=e&&(c.r1=e,h=!0);c.r2!=e&&(c.r2=e,h=!0);h&&a.scrollToRange(c.c1,c.r1,c.c1,c.r1);return h};d.incrementSelection=function(c,d,e,h,q){q=!1;f&&(0>e?e=-b.colCount():0<e&&(e=b.colCount()),0>h?h=-b.rowCount():0<h&&(h=b.rowCount()),f=!1);d.c2==c.c1?(e=u(d.c1,e),e!=d.c1&&(e<=d.c2?d.c1=e:(d.c1=d.c2,d.c2=e),q=!0)):(e=u(d.c2,e),e!=
d.c2&&(e>=d.c1?d.c2=e:(d.c2=d.c1,d.c1=e),q=!0));d.r2==c.r1?(h=v(d.r1,h),h!=d.r1&&(h<=d.r2?d.r1=h:(d.r1=d.r2,d.r2=h),q=!0)):(h=v(d.r2,h),h!=d.r2&&(h>=d.r1?d.r2=h:(d.r2=d.r1,d.r1=h),q=!0));q&&(h=d.c2==c.c1?d.c1:d.c2,c=d.r2==c.r1?d.r1:d.r2,a.scrollToRange(h,c,h,c));return q};d.layoutChanged=function(c){a&&a.layoutChanged(c)};d.update=function(c){a&&a.update(c)}}});ua.extend(["archive","emailarchive"],{de:"arc",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,rectselection:!1,cellselection:!1,anchorednotes:!1});
xb.extend("arc",{install:function(d){var e,b,a,c,f=function(a){a.preventDefault();v(this.parentNode.parentNode.parentNode,this)},h=function(a){v(this.parentNode.parentNode.parentNode,this)},q=function(a){c=b.scroll()},t=function(a){b.autoscroll(c.left-a.delta.x,c.top-a.delta.y)},u=function(){var c=b.scroll().left;c!=a&&(a=c,0===a?e.css("margin-left",null):e.css("margin-left",-a+"px"))};d.load=function(c){e=c.childByClass("oit-tree-head");b=c.childByClass("oit-tree-nodes");a=0;b.kinetic(!0);var d=
y.byClass("oit-open-close");d&&(Y(d,"onclick",null,f),Y(d,"ontap",null,h));if(d=y.byClass("oit-tree-nname"))for(c=0;c<d.length;c++){var m=d[c],l=m.attr("data-nodeid");null!==l&&""!==l&&(l=Number(l),isNaN(l)||Mc.on.addElement(m,l))}if(d=e.byClass("oit-col-header"))for(c=0;c<d.length;c++)d[c].ctrl=new p(d[c],e),d[c].ctrl.colClass="f"+c;c=e;var v;a:{try{for(var I=V.styleSheets,d=0;d<I.length;d++){var H=I[d].cssRules||I[d].rules;if(0<H.length&&"div.f0"==H[0].selectorText){v=d;break a}}}catch(r){}v=null}c.ssIndex=
v;b.onscroll(u);b.onpanstart(q);b.onpanmove(t)};d.unload=function(){Mc.on.removeAllElements()};var v=function(a,c){var b=a.nextElementSibling;"none"!=b.style.display?(b.style.display="none",c&&c.addClass("closed")):(b.style.display="block",c&&c.removeClass("closed"))},p=function(a,c){T.call(this,"div","oit-col-dragger");this.append(y.create("div"));this.headerbar=c;var b=a.nextSiblingElem();b?e.insert(this,b):e.append(this);this.header=a;this.ondragstart(l);this.ondragmove(m);this.ondragend(H);this.ondragcancel(H)};
W(p,T);var l=function(a){this.orgwidth=this.header.clientWidth;this.overlay||(a=w.viewNode,this.overlay=y.create("div","oit-tree-overlay"),this.overlay.css({height:a.clientHeight-this.headerbar.clientHeight+"px",top:this.headerbar.clientHeight+2+"px",left:this.header.offsetLeft-3+"px"}),this.overlay.innerWidth=this.orgwidth+6,this.header.parent().append(this.overlay));return!1},m=function(a){a=this.orgwidth+a.delta.x-3;1>a&&(a=1);this.header.innerWidth=a;this.overlay.innerWidth=a+9;return!1},H=function(a){this.overlay.destroy();
delete this.overlay;this.header.css("width",null);var c=this.orgwidth+a.delta.x-3;1>c&&(c=1);c+="px";if(null!==this.headerbar.ssIndex){var b=V.styleSheets[this.headerbar.ssIndex].cssRules,d="div."+this.colClass;for(a=0;a<b.length;a++)if(b[a].selectorText==d){b[a].style.width=c;break}}else for(b=this.headerbar.parent().byClass(this.colClass),a=0;a<b.length;a++)b[a].css("width",c);return!1}}});ua.extend("multimedia",{de:"mm",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,textselection:!1,rectselection:!1,
cellselection:!1,anchorednotes:!1});xb.extend("mm",{install:function(d){function e(){b.each(a)}var b=null;d.load=function(a){ha.onresize(d,e);w.viewNode.css("display","flex");w.viewNode.css("overflow","hidden");b=a.overlay;b.css("display","flex");b.css("justify-content","center");b.css("align-items","center");e()};d.unload=function(){ha.offresize(e);b=null;w.viewNode.css("display",null);w.viewNode.css("align-items",null);w.viewNode.css("overflow",null)};var a=function(a){if(a.hasClass("oit-multimedia")&&
a.isLoaded()&&(a=a.childByClass("oit-video"))){var c=a.dom.videoHeight,b=a.dom.mediaWidth,d=w.viewNode.clientHeight,e=w.viewNode.clientWidth;hc("ie11")&&(c>d||b>e)?(a.css("background-size","auto"),a.css("max-width",e+"px"),a.css("max-height",d+"px")):c>d?(a.css("background-size","contain"),a.css("max-width","100%"),a.css("max-height",d+"px")):(b>e?(a.css("background-size","contain"),a.css("max-width",e+"px")):(a.css("background-size","auto"),a.css("resize",null),a.css("max-width","100%")),a.css("max-height",
"100%"))}}}});var la=function(){var d=function(){var a=arguments;if(1===a.length)a=a[0],void 0!==a.units?("px"!==a.units&&(a=ea(a),va(a,"px")),this.l=a.left,this.t=a.top,this.r=a.right,this.b=a.bottom,this.o=z.page(a.page)):a.o&&(this.l=a.l,this.t=a.t,this.r=a.r,this.b=a.b,this.o=a.o);else if(2===a.length){var b=a[0];this.l=b.left;this.t=b.top;this.r=b.right;this.b=b.bottom;this.o=a[1]}else this.l=a[0],this.t=a[1],this.r=a[2],this.b=a[3],this.o=a[4];a=this.o&&("view"===this.o||"overlay"===this.o||
this.o instanceof T);if(!(da(this.l)&&da(this.t)&&da(this.r)&&da(this.b)&&a))throw"Invalid Rectangle";this.l=L(this.l,1E4);this.t=L(this.t,1E4);this.r=L(this.r,1E4);this.b=L(this.b,1E4);this.l>this.r&&(a=this.l,this.l=this.r,this.r=a);this.t>this.b&&(a=this.t,this.t=this.b,this.b=a);this.w=this.r-this.l;this.h=this.b-this.t},e=W(d);Object.defineProperties(e,{left:{enumerable:!0,get:function(){return this.l},set:function(a){this.verifyMutable();this.l=L(a,1E4);this.r=this.l+this.w}},top:{enumerable:!0,
get:function(){return this.t},set:function(a){this.verifyMutable();this.t=L(a,1E4);this.b=this.t+this.h}},right:{enumerable:!0,get:function(){return this.r},set:function(a){this.verifyMutable();this.r=L(a,1E4);this.l=this.r-this.w}},bottom:{enumerable:!0,get:function(){return this.b},set:function(a){this.verifyMutable();this.b=L(a,1E4);this.t=this.b-this.h}},width:{enumerable:!0,get:function(){return this.w},set:function(a){this.verifyMutable();0>a&&(a=0);this.w=L(a,1E4);this.r=this.l+this.w}},height:{enumerable:!0,
get:function(){return this.h},set:function(a){this.verifyMutable();0>a&&(a=0);this.h=L(a,1E4);this.b=this.t+this.h}},origin:{enumerable:!0,get:function(){return this.o},set:function(a){this.verifyMutable();this.convert(a)}}});var b=function(a,b,d){return"number"===typeof d&&(d=L(d,1E4),d!==a[b])?(a[b]=d,!0):!1};e.move=function(a,d,e,q){this.verifyMutable();a=b(this,"l",a);a|=b(this,"t",d);a|=b(this,"r",e);if(a|=b(this,"b",q))this.w=this.r-this.l,this.h=this.b-this.t;return a};e.movesize=function(a,
d,e,q){this.verifyMutable();a=b(this,"l",a);a|=b(this,"t",d);a|=b(this,"w",e);if(a|=b(this,"h",q))this.r=this.l+this.w,this.b=this.t+this.h;return a};e.offset=function(a,b){this.verifyMutable();void 0!==a&&(this.left+=a);void 0!==b&&(this.top+=b)};e.size=function(a,b){this.verifyMutable();void 0!==a&&(this.width=a);void 0!==b&&(this.height=b)};e.scale=function(a){void 0!==a&&(this.verifyMutable(),this.left*=a,this.top*=a,this.width*=a,this.height*=a)};var a=function(a,b){return a===b?!0:.999<(a>b?
b/a:a/b)};e.equals=function(c){return a(this.l,c.left)&&a(this.t,c.top)&&a(this.r,c.right)&&a(this.b,c.bottom)};e.overlaps=function(a){return this.l<a.right&&this.r>a.left&&this.t<a.bottom&&this.b>a.top};e.contains=function(a){return a.left>=this.l&&a.right<=this.r&&a.top>=this.t&&a.bottom<=this.b};e.containsPoint=function(a,b){return a>=this.l&&a<=this.r&&b>=this.t&&b<=this.b};e.union=function(a,b,d,e){if(1==arguments.length){var c=arguments[0];this.union(c.left,c.top,c.right,c.bottom)}else this.verifyMutable(),
a=L(a,1E4),b=L(b,1E4),d=L(d,1E4),e=L(e,1E4),a<this.l&&(this.l=a),b<this.t&&(this.t=b),d>this.r&&(this.r=d),e>this.b&&(this.b=e),this.w=this.r-this.l,this.h=this.b-this.t};e.intersect=function(a,b,d,e){if(1==arguments.length){var c=arguments[0];this.intersect(c.left,c.top,c.right,c.bottom)}else this.verifyMutable(),a=L(a,1E4),b=L(b,1E4),d=L(d,1E4),e=L(e,1E4),this.l=fa(this.l,a,d),this.r=fa(this.r,a,d),this.t=fa(this.t,b,e),this.b=fa(this.b,b,e),this.w=this.r-this.l,this.h=this.b-this.t};e.constrain=
function(a,b,d,e){if(1==arguments.length){var c=arguments[0];this.constrain(c.left,c.top,c.right,c.bottom)}else{this.verifyMutable();a=L(a,1E4);b=L(b,1E4);d=L(d,1E4);e=L(e,1E4);var c=d-a,f=e-b;this.width>=c?(this.l=a,this.r=d,this.w=c):this.left<a?this.left=a:this.right>d&&(this.right=d);this.height>=f?(this.t=b,this.b=e,this.h=f):this.t<b?this.top=b:this.b>e&&(this.bottom=e)}};e.clone=function(){return new d(this.left,this.top,this.right,this.bottom,this.origin)};e.toRange=function(a){var c=this;
this.o!==a&&(c=this.clone(),c.origin=a);return Fb(a.index,c.left,c.top,c.right,c.bottom)};e.readonly=function(a){"boolean"===typeof a&&(this._readonly=a);return!!this._readonly};e.verifyMutable=function(){if(this._readonly)throw"Attempted to modify a read-only Rectangle";};e.distanceFrom=function(a,b,d,e,t){a=L(a,1E4);b=L(b,1E4);switch(d){case "left":a-=this.l;break;case "center":a-=(this.l+this.r)/2;break;case "right":a-=this.r;break;case "none":a=0;break;default:a=a<this.l?a-this.l:a>this.r?a-this.r:
0}switch(e){case "top":b-=this.t;break;case "middle":b-=(this.t+this.b)/2;break;case "bottom":b-=this.b;break;case "none":b=0;break;default:b=b<this.t?b-this.t:b>this.b?b-this.b:0}if("xy"===t)t={x:a,y:b,ax:Math.abs(a),ay:Math.abs(b)};else if(0===a&&0===b)t=0;else if(t=L(Math.sqrt(a*a+b*b),10),0>b||0===b&&0>a)t=-t;return t};e.convert=function(a){var b=this.o;if(a!==b){var c,d=x.rotation,e=x.zoom;if(a instanceof hb)if("view"===b||"overlay"===b){if(c=a,(b=c.pagePos(b))&&this.offset(-b.left,-b.top),c.features().zoom&&
1!=e&&this.move(this.l/e,this.t/e,this.r/e,this.b/e),c.features().rotate&&0!==d)switch(d){case 90:this.move(c.width-this.b,this.l,c.width-this.t,this.r);break;case 180:this.move(c.width-this.r,c.height-this.b,c.width-this.l,c.height-this.t);break;case 270:this.move(this.t,c.height-this.r,this.b,c.height-this.l)}}else if(b instanceof hb)b=b.pageRect(),c=a.pageRect(),this.offset(c.left-b.left,c.top-b.top);else throw"Unsupported Rectangle conversion";else if(b instanceof hb)if("view"===a||"overlay"===
a){c=b;if(c.features().rotate&&0!==d)switch(d){case 90:this.move(this.t,c.width-this.r,this.b,c.width-this.l);break;case 180:this.move(c.width-this.r,c.height-this.b,c.width-this.l,c.height-this.t);break;case 270:this.move(c.height-this.b,this.l,c.height-this.t,this.r)}c.features().zoom&&"email"!==c.type&&"rt"!==c.type&&1!=e&&this.move(this.l*e,this.t*e,this.r*e,this.b*e);(b=c.pagePos(a))&&this.offset(b.left,b.top)}else throw"Unsupported Rectangle conversion";else if("view"===a||"overlay"===a||a instanceof
T)if("view"===b)b=G.padding(),c=G.scrollOffset(),this.left=this.left-b.left+c.left,this.top=this.top-b.top+c.top,a instanceof T&&(b=(c=a.ancestorByClass("oit-overlay"))?a.pos(c):a.pos(w.viewNode),this.left-=b.left,this.top-=b.top);else{if("overlay"===b||b instanceof T)b instanceof T&&(b=(c=b.ancestorByClass("oit-overlay"))?b.pos(c):b.pos(w.viewNode),this.left+=b.left,this.top+=b.top),"view"===a&&(b=G.padding(),c=G.scrollOffset(),this.left=this.left+b.left-c.left,this.top=this.top+b.top-c.top)}else throw"Unsupported Rectangle conversion";
this.o=a}return this};return d}(),mc=function(){var d=function(b){this._rects=[];this.add(b)},e=W(d);Object.defineProperties(e,{length:{enumerable:!0,get:function(){return this._rects.length}},left:{enumerable:!0,get:function(){return this.boundingRectangle().left}},top:{enumerable:!0,get:function(){return this.boundingRectangle().top}},right:{enumerable:!0,get:function(){return this.boundingRectangle().right}},bottom:{enumerable:!0,get:function(){return this.boundingRectangle().bottom}},width:{enumerable:!0,
get:function(){return this.boundingRectangle().width}},height:{enumerable:!0,get:function(){return this.boundingRectangle().height}}});e.item=function(b){return this._rects[b]};e.add=function(b){if(b){if(Array.isArray(b))for(var a=0;a<b.length;a++)this._rects.push(b[a]);else this._rects.push(b);this._boundingRect=null}return this};e.convert=function(b){Y(this._rects,"convert",null,b);this._boundingRect=null;return this};e.boundingRect=function(){if(!this._boundingRect){for(var b=this._rects,a=b[0],
c=a.left,d=a.top,e=a.right,q=a.bottom,t=1;t<b.length;t++)a=b[t],a.left<c&&(c=a.left),a.top<d&&(d=a.top),a.right>e&&(e=a.right),a.bottom>q&&(q=a.bottom);this._boundingRect=new la(c,d,e,q,b[0].origin)}return this._boundingRect};e.interiorRect=function(b,a){for(var c=this._rects,d=null,e=0,q=0;q<c.length;q++){var t=c[q];if(t.width>=b.width&&t.height>=b.height){d=t;break}else if(!d||t.width>d.width||t.height>d.height){var u=t.width/b.width,v=t.height/b.height,p=Math.min(u,v);a&&(u=t.height/b.width,v=
t.width/b.height,p=Math.max(p,Math.min(u,v)));if(!d||p>e)d=t,e=p}}if(d)return d.clone()};return d}(),tb=function(){var d=function(b){T.call(this,"style");b&&this.attr("media",b);this.append(y.createText(""));y.head.append(this);this.rulecount=0;this.indexLookup={};Object.defineProperty(this,"sheet",{get:function(){return this.dom.sheet}})},e=W(d,T);e.addCSSText=function(b){this.html(this.html()+b)};e.setCSSText=function(b){this.html(b)};e.setRule=function(b,a){if(a&&this.indexLookup.hasOwnProperty(a))return this.updateRuleByIndex(b,
this.indexLookup[a]);try{return this.sheet.insertRule(b,this.rulecount),a&&(this.indexLookup[a]=this.rulecount),this.rulecount++}catch(c){this.logError("setRule","Error inserting style rule: "+c.message)}};e.updateRuleByIndex=function(b,a){if(!isNaN(a)){try{this.sheet.deleteRule(a),this.sheet.insertRule(b,a)}catch(c){this.logError("updateRuleByIndex","Error updating style rule: "+c.message)}return a}};e.updateRule=function(b,a){this.indexLookup.hasOwnProperty(a)?this.updateRuleByIndex(b,this.indexLookup[a]):
this.updateRuleByIndex(b,a)};e.removeFromNames=function(b){for(var a in this.indexLookup)this.indexLookup[a]==b?delete this.indexLookup[a]:this.indexLookup[a]>b&&--this.indexLookup[a]};e.deleteRule=function(b){b=this.indexLookup.hasOwnProperty(b)?this.indexLookup[b]:b;!isNaN(b)&&b<this.rulecount&&(this.sheet.deleteRule(b),this.removeFromNames(b),this.rulecount--)};e.hasRule=function(b){return this.indexLookup.hasOwnProperty(b)};return d}(),Uc=function(){var d=function(a,b){a/=b/2;if(1>a)return.5*
a*a;a--;return-.5*(a*(a-2)-1)},e={ease:d,"ease-in-out":d,"ease-in":function(a,b){a/=b;return a*a*a},"ease-out":function(a,b){a/=b;a--;return a*a*a+1},linear:function(a,b){return a/b}},b="opacity offsetLeft offsetTop innerWidth innerHeight scrollLeft scrollTop".split(" "),a={scrollLeft:!1,scrollTop:!1},c=[],f=function(a){wc(c,"step",null,a);0<c.length&&cb(f)},h=function(a){var b=a.elem;b&&b.dom&&(b.data("_animation")===a&&b.removeData("_animation"),b.removeClass("oit-animating"));Sa(c,a)};F.onreset(function(){Y(c,
"finish");c=[];for(var b in a)a.hasOwnProperty(b)&&(a[b]=!1)});var q=function(a,b,c){b=b[a];void 0!==b&&(c[a]=b)},t=function(a,b,c){b=b[a];Ga(b)&&(c[a]=b)},u=function(a,b){var c=a[b];c&&(a.args?c.apply(a.context,a.args):c.call(a.context,a.elem))},v=function(a,b){var c=a[b];c&&a.elem&&a.elem.dom&&a.elem.css(c)},p=function(h,l){this.elem=h;this.time=void 0!==l.time?l.time:120;t("startFn",l,this);t("stepFn",l,this);t("endFn",l,this);q("context",l,this);l.args&&(this.args=Array.prototype.slice.call(l.args,
0),this.args.unshift(h));q("startCSS",l,this);q("endCSS",l,this);this.transFn=e[l.transition]||d;for(var m=x.disableAnimation||0>=this.time,v=0;v<b.length;v++){var p=b[v],u=l[p];if(void 0!==u){var D=h[p];D!=u&&(this.props||(this.props={}),this.props[p]={start:D,end:u},m|=a[p])}}m||!this.props?this.finish():(c.push(this),h.data("_animation",this),h.addClass("oit-animating"),cb(f))},l=W(p);l.isEmpty=function(){return 0>=this.time||!this.props};l.step=function(a){var b=!1,c=this.elem;c&&c.dom&&void 0===
this.startTime&&(v(this,"startCSS"),u(this,"startFn"),this.startTime=a,this.steps=0,c=this.elem);if(c&&c.dom&&(this.steps++,a-=this.startTime,a=a>=this.time?1:this.transFn(a,this.time),1>a)){var b=this.props,d;for(d in b){var e=b[d];c[d]=e.start+(e.end-e.start)*a}u(this,"stepFn");b=!0}b||this.finish();return b};l.finish=function(){var b=this.elem;if(b){var c=this.props,d;if(this.steps&&4>this.steps)for(d in c)a.hasOwnProperty(d)&&(a[d]=!0);h(this);void 0===this.startTime&&(v(this,"startCSS"),u(this,
"startFn"));if(b.dom)for(d in c)b[d]=c[d].end;v(this,"endCSS");u(this,"endFn");this.deleteAll()}};l.abort=function(){this.elem&&(h(this),this.deleteAll())};return p}(),Oc=function(){var d=[],e=OIT.DialogBox=function(a){T.call(this,"div","oit-dialog");a=a||{};this._resizable=this._moveable=this._modal=this._visible=!1;d.push(this);this.css("opacity",0);this._form=y.create("form",this);this.move(a.x,a.y,a.width,a.height);void 0!==a.className&&this.addClass(a.className);void 0!==a.moveable&&this.moveable(a.moveable);
void 0!==a.resizable&&this.resizable(a.resizable);void 0!==a.modal&&this.modal(a.modal);void 0!==a.resultFn&&(this._resultFn=a.resultFn);void 0!==a.destroyFn&&(this._destroyFn=a.destroyFn);void 0!==a.title&&this.title(a.title);void 0!==a.textColor&&this.css("color",a.textColor);void 0!==a.backgroundColor&&this._form.css("background-color",a.backgroundColor);a.cancel&&(h(this,M.CANCEL,this.cancel),this.onkeydown(q));a.ok&&h(this,M.OK,this.ok);a.no&&h(this,M.NO,this.no);a.yes&&h(this,M.YES,this.yes);
w.rootNode.append(this)},b=W(e,T),a=function(a){a=this.pos();this._dragX=a.left;this._dragY=a.top;this._header.css("cursor",Xb);return!1},c=function(a){this.move(this._dragX+a.delta.x,this._dragY+a.delta.y);this._header.css("cursor",Xb);return!1},f=function(a){this._header.css("cursor",Wb);return!1},h=function(a,b,c){a._footer||(a._footer=y.create("footer",a),a._footerVisible=!0);b=new bc(b);a._footer.append(b);b.onclick(a,c);b.ontap(a,c)},q=function(a){return 27==a.keyCode?!1:!0},t=function(a){var b=
0;a._header&&(a._header.css("cursor",a._moveable?Wb:null),b=a._header.offsetHeight);if(a._footer&&a._footerVisible)a._footer.css("display",null),a._form.css({height:null,position:"absolute",top:b+"px",left:"0px",right:"0px",bottom:a._footer.offsetHeight+"px"});else{a._footer&&a._footer.css("display","none");var c=null;0<b&&(c=a.clientHeight-b+"px");a._form.css({position:null,left:null,right:null,top:null,bottom:null,height:c})}};b.destroy=function(){this.cancel();this.show(!1,{animate:!1});this._destroyFn&&
this._destroyFn(this);Sa(d,this);T.prototype.destroy.call(this)};b.exit=function(){this.cancel();this.show(!1,{endFn:this.destroy,context:this})};b.moveable=function(a){if(!0===a||!1===a)this._moveable=a,t(this);return this._moveable};b.resizable=function(a,b,c){if((!0===a||!1===a)&&a!=this._resizable){this._resizable=a;var d,e;this._resizable?(this.addClass("oit-dialog-resizable"),void 0!==b&&(d=b+"px"),void 0!==c&&(e=c+"px")):this.removeClass("oit-dialog-resizable");this.css({"min-width":d,"min-height":e})}return this._resizable};
b.modal=function(a){!0!==a&&!1!==a||a===this._modal||(this._modal=a,ya.showModalOverlay(this._modal));return this._modal};b.title=function(b){if(b){var d;this._header||(this._header=y.create("header"),this.insert(this._header,this.firstChildElem()),this._header.ondragstart(this,a),this._header.ondragmove(this,c),this._header.ondragend(this,f),this._header.ondragcancel(this,f));d=this._header;this._title||(this._title=y.create(),d.append(this._title));this._title.html(b);this._title.css("display",
null);d.addClass("oit-dialog-header-shaded");t(this)}else null===b&&(this._title&&(this._title.destroy(),delete this._title),this._header&&(this._header.destroy(),delete this._header),t(this));return this._title?this._title.text():void 0};b.resetForm=function(){this._form.html("")};b.addLabel=function(a,b){var c=y.create("label",this._form);c.html(a);b&&b.style&&c.css(b.style);return c};b.addTextArea=function(a,b){a&&(this.addLabel(a),y.create("br",this._form));var c=new qc;this._form.append(c);b&&
(b.style&&c.css(b.style),b.placeholder&&c.attr("placeholder",b.placeholder));return c};b.show=function(a,b){!1!==a&&(a=!0);a&&(this._result=void 0);this.finishAnimation();if(this._visible==a)b&&(b.startFn&&b.startFn.call(b.context,this),b.endFn&&b.endFn.call(b.context,this));else{b=b||{};var c=0;!1!==b.animate&&(c=200);a?(this.startFn=b.startFn,this.startContext=b.context,this.animate({opacity:1,time:c,startCSS:{opacity:0,display:"block"},startFn:u,endFn:b.endFn,context:this}),this._visible=!0,this._modal&&
ya.showModalOverlay(!0,c)):(this.animate({opacity:0,time:c,startFn:b.startFn,endCSS:{display:null},endFn:b.endFn,context:b.context}),this._visible=!1,this._modal&&ya.showModalOverlay(!1,c))}return this._visible};var u=function(){t(this);this.startFn&&this.call(this.startContext,this);delete this.startFn;delete this.startContext};b.showFooter=function(a){!0!==a&&!1!==a||a===this._footerVisible||(this._footerVisible=!1!==a,t(this));return this._footerVisible};b.move=function(a,b,c,d,e){var f=w.viewNode,
h=f.size(),f=f.pos();void 0===c&&(c=this.offsetWidth);var l=h.width-10-10;c>l&&(c=l);void 0===d&&(d=this.offsetHeight);l=h.height-10-10;d>l&&(d=l);void 0!==a&&(l=f.left+h.width-10-c,a>l&&(a=l),a=L(a));void 0!==b&&(h=f.top+h.height-10-d,b>h&&(b=h),b=L(b));this._visible&&a!==this.offsetLeft||b!==this.offsetTop||c!==this.innerWidth||d!=this.innerHeight?(h=e&&!0===e.animate?200:0,e&&(this.moveOptions=e),this.css("overflow","hidden"),this.animate({offsetLeft:a,offsetTop:b,innerWidth:c,innerHeight:d,time:h,
endCSS:{overflow:null},endFn:v,context:this})):e&&e.endFn&&e.endFn.call(e.context,this)};var v=function(){t(this);var a=this.moveOptions;a&&a.endFn&&a.endFn.call(a.context,this);delete this.moveOptions};b.autoSize=function(a,b,c,d,e){(c=this.hasClass("oit-animating"))&&this.removeClass("oit-animating");var f=["width","height","display","opacity"];d=this.css(f);this.removeCSS(f);this.css("display","block");this.css("opacity","1");var f=this.offsetWidth,h=this.offsetHeight;this.css(d);c&&this.addClass("oit-animating");
this.move(a,b,f,h,e)};b.maxsize=function(a,b){var c={};void 0!=a&&(c["max-width"]=0===a?null:a+"px");void 0!=b&&(c["max-height"]=0===b?null:b+"px");this.css(c)};var p=function(a,b){a._visible||a.css("display","block");var c=a[b];a._visible||a.css("display",null);return c};b.width=function(){return p(this,"offsetWidth")};b.height=function(){return p(this,"offsetHeight")};var l=function(a,b){void 0===a._result&&(a._result=b,a._resultFn&&a._resultFn(a,b))};b.cancel=function(){l(this,!1)};b.ok=function(){l(this,
!0)};b.no=function(){l(this,0)};b.yes=function(){l(this,1)};b.result=function(){return this._result};F.onreset(function(){for(;0<d.length;)d.shift().destroy()});return e}();pb("TextRange",function(d,e){if(d>e){var b=d;d=e;e=b}this.type="text";this.acc=d;this.accend=e});pb("CellRange",function(d,e,b,a,c,f,h,q,t){var u;e>a&&(u=e,e=a,a=u);b>c&&(u=b,b=c,c=u);this.type="cell";this.page=d;this.section=z.page(d).section;this.c1=e;this.r1=b;this.c2=a;this.r2=c;void 0!==f&&(this.offsets="number"===typeof f?
{left:f,top:h,right:q,bottom:t}:{left:f.left,top:f.top,right:f.right,bottom:f.bottom})});pb("RectRange",function(d,e,b,a,c,f,h,q){var t;b>c&&(t=b,b=c,c=t);a>f&&(t=a,a=f,f=t);this.type="rect";void 0!==d&&(this.embedId=d);this.page=e;this.left=b;this.top=a;this.right=c;this.bottom=f;this.units=h;if(void 0!==q)this.section=q;else if(d=z.page(e))this.section=d.section});var Ub=function(){var d=function(a,b,d){T.call(this,"div",b);this._layer=a;this._visible=!0;d?d.append(this):a.append(this);y.attach(this);
"none"===this.computedStyleProp("display")&&(this._visible=!1);this.changed()},e=W(d,T);e.createChild=function(a){return new Ca(this,a)};e.layer=function(){return this._layer};e.moveToTop=function(){this.parent().append(this)};e.addClass=function(a){this.hasClass(a)||(T.prototype.addClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.removeClass=function(a){this.hasClass(a)&&(T.prototype.removeClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};
e.defaultSize=function(){if(!this._defaultSize){var a=["transform","display","width","height"],b=this.css(a);this.removeCSS(a);this._defaultSize={width:this.offsetWidth,height:this.offsetHeight};this.css(b)}return this._defaultSize};e.setDefaultSize=function(a){this._defaultSize=a};e.resetDefaultSize=function(){this._defaultSize&&(this._defaultSize=null)};e.setTitle=function(a){this.attr("title",a)};e.show=function(a){!1!==a&&(a=!0);a!==this._visible&&((this._visible=a)?(this.css("display","block"),
this.changed()):this.css("display","none"));return this};e.hide=function(){return this.show(!1)};e.visible=function(){return this._visible&&this._layer.visible()};e.layoutObject=function(){if(!this._animating&&this.visible()){var a=this.position();if(a){var b={};b.left=a.left;this._borderOffset&&(b.left-=this._borderOffset.left);b.left+="px";b.top=a.top;this._borderOffset&&(b.top-=this._borderOffset.top);b.top+="px";b.width=a.width+"px";b.height=a.height+"px";this.css(b);this._borderOffset||(this._borderOffset=
{left:this.clientLeft,top:this.clientTop},this._borderOffset.left&&this.css("left",a.left-this._borderOffset.left+"px"),this._borderOffset.top&&this.css("top",a.top-this._borderOffset.top+"px"))}}return this};e.changed=function(){this._dirty||(this._dirty=!0,this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.childChanged=function(a){this._dirty||(this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.update=
function(a){this._dirty&&(a=!0,this._dirty=!1);a&&this.layoutObject();this.queryChildElements(b,a);return this};var b=function(a,b,d){a.update&&a.update(d)};return d}(),Ca=function(){var d=function(b,a){a=a||{};Ub.call(this,b.layer(),a.classList,b);this._parentObject=b;a.title&&this.setTitle(a.title);var c=a.margin||0;this._margin={left:c,top:c,right:c,bottom:c};void 0!==a.hpos&&(this._hpos=a.hpos);void 0!==a.vpos&&(this._vpos=a.vpos);!0===a.inheritMoveable&&(this.inheritMoveable=!0)},e=W(d,Ub);e.resize=
function(b,a){void 0!==b||void 0!==a?this._size&&this._size.width===b&&this._size.height===a||(this._size={width:b,height:a},this.changed()):this._size&&(delete this._size,this.changed());return this};e.setMargin=function(b,a,c,d){var e=!1;void 0!==b&&b!==this._margin.left&&(this._margin.left=b,e=!0);void 0!==a&&a!==this._margin.top&&(this._margin.top=a,e=!0);void 0!==c&&c!==this._margin.right&&(this._margin.right=c,e=!0);void 0!==d&&d!==this._margin.bottom&&(this._margin.bottom=d,e=!0);e&&(this._pos&&
(this._pos=void 0),this.changed());return this};e.position=function(){if(this._parentObject){var b=this._parentObject.position()||this._parentObject.defaultSize();if(this._pos&&b.width!=this._parentWidth||b.height!=this._parentHeight)this._pos=void 0;if(void 0===this._pos){this._parentWidth=b.width;this._parentHeight=b.height;var a,c,d,e;if("fill"===this._hpos)a=this._margin.left,d=b.width-this._margin.left-this._margin.right;else if(void 0!==this._hpos)if(d=this._size&&0<this._size.width?this._size.width:
this.defaultSize().width,"number"===typeof this._hpos)a=0<=this._hpos?this._margin.left+this._hpos:b.width-this._margin.right-d+this._hpos;else switch(this._hpos){case "left":a=this._margin.left;break;case "center":a=(b.width-d)/2;break;case "right":a=b.width-this._margin.right-d}if("fill"===this._vpos)c=this._margin.top,e=b.height-this._margin.top-this._margin.bottom;else if(void 0!==this._vpos)if(e=this._size&&0<this._size.height?this._size.height:this.defaultSize().height,"number"===typeof this._vpos)c=
0<=this._vpos?this._margin.top+this._vpos:b.height-this._margin.bottom-e+this._vpos;else switch(this._vpos){case "top":c=this._margin.top;break;case "middle":c=(b.height-e)/2;break;case "bottom":c=b.height-this._margin.bottom-e}void 0!==a||void 0!==c||void 0!==d||void 0!==e?(void 0===a&&(a=0),void 0===c&&(c=0),void 0===d&&(d=this.defaultSize().width),void 0===e&&(e=this.defaultSize().height),this._pos=new la(a,c,a+d,c+e,"overlay")):this._pos=null}}return this._pos};return d}(),jd=function(){var d=
function(b){Ca.call(this,b,{hpos:"center",vpos:"middle",classList:"oit-highlight-label",inheritMoveable:!0})},e=W(d,Ca);e.destroy=function(){this._parentObject&&this._parentObject.attr("title",null);Ca.prototype.destroy.call(this)};e.setText=function(b){this._labelText=b=b||"";this.html(b);this.setTitle(b);this.resetDefaultSize();this.changed()};e.setColor=function(b,a){this.css("color",b)};e.setBoundingRect=function(b){b?this._parentRect=b.clone():delete this._parentRect;this.show()};e.position=
function(){if(this._parentObject){var b=this._parentRect||this._parentObject.position();this.css("transform",null);this.showLabelText=!0;this.html(this._labelText);var a="",c=this.defaultSize(),d=c.width+4,e=c.height+4,q=!1;if(d>b.width||e>b.height){if(d>e&&b.width<b.height||d<e&&b.width>b.height)c={width:c.height,height:c.width},d=c.width+4,e=c.height+4,a="rotate(270deg)",q=!0;if(d>b.width||e>b.height){var t=L(Math.min(b.width/d,b.height/e),1E3);.4>t?(a="",this.html(""),this.showLabelText=!1):(a+=
"scale("+t+","+t+")",d=c.width*t+4,e=c.height*t+4)}}this.css("transform",a);if(this.showLabelText)return a=b.left+(b.width-d)/2,b=b.top+(b.height-e)/2,q&&(b+=e),d=a+d,e=b+e,this.show(),new la(a,b,d,e,"overlay");this.hide()}};return d}(),kd=function(){var d=function(a){Ca.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation",inheritMoveable:!0})},e=W(d,Ca);e.setResizable=function(a){if(a){this._resizable||(this.addClass("oit-resize"),b(this,"oit-resize-n",!1,!0,!1,!1),b(this,"oit-resize-s",
!1,!1,!1,!0),b(this,"oit-resize-e",!1,!1,!0,!1),b(this,"oit-resize-w",!0,!1,!1,!1),b(this,"oit-resize-ne",!1,!0,!0,!1),b(this,"oit-resize-nw",!0,!0,!1,!1),b(this,"oit-resize-se",!1,!1,!0,!0),b(this,"oit-resize-sw",!0,!1,!1,!0));var c=a.margin||0;0>c&&this.setMargin(c,c,c,c);this._resizable=a}else this._resizable&&(this._resizeHandles&&(Y(this._resizeHandles,"destroy"),delete this._resizeHandles),delete this._resizable,this.removeClass("oit-resize"))};var b=function(a,b,d,e,p,l){b=y.create("div",b);
b.ondragstart(a,c,d,e,p,l);b.ondragmove(a,f);b.ondragend(a,h);b.ondragcancel(a,h);a.append(b);a._resizeHandles||(a._resizeHandles=[]);a._resizeHandles.push(b)},a=function(a,b,c){b=b._parentObject;b.dispatchCustom(a,{drawingRect:b,newRect:c.curRect,moved:c.resized})},c=function(b,c,d,e,f){b=this._parentObject.position();this.resizeInfo=c={left:c,top:d,right:e,bottom:f,startRect:b.clone(),curRect:b.clone(),resized:!1};a("resizestart",this,c);return!1},f=function(b){var c=this.resizeInfo;this.calculateResize(c,
b);c.resized=!0;a("resizemove",this,c);if(!this._resizable.bindToObject){b=this._parentObject.position();var d=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(d+c.curRect.left-b.left,d+c.curRect.top-b.top,d+b.right-c.curRect.right,d+b.bottom-c.curRect.bottom)}return!1},h=function(b){b=this.resizeInfo;if(!this._resizable.bindToObject){var c=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(c,c,c,c)}a("resizeend",this,b);delete this.resizeInfo;
return!1};e.calculateResize=function(a,b){var c=b.delta.x,d=b.delta.y,e=a.startRect.left,f=a.startRect.top,h=a.startRect.right,q=a.startRect.bottom;a.left?(e+=c,h-e<this._resizable.minWidth&&(e=h-this._resizable.minWidth)):a.right&&(h+=c,h-e<this._resizable.minWidth&&(h=e+this._resizable.minWidth));a.top?(f+=d,q-f<this._resizable.minHeight&&(f=q-this._resizable.minHeight)):a.bottom&&(q+=d,q-f<this._resizable.minHeight&&(q=f+this._resizable.minHeight));return e!=a.curRect.left||f!=a.curRect.top||h!=
a.curRect.right||q!=a.curRect.bottom?(a.curRect.move(e,f,h,q),!0):!1};return d}(),ld=function(){var d,e=function(b){Ca.call(this,b,{hpos:"fill",vpos:"fill",classList:"oit-activation"});this._range=ea(b._range);this._startHandle=a(this,c);this._endHandle=a(this,f)},b=W(e,Ca),a=function(a,b){var c=new Ca(a,{hpos:0,vpos:0,classList:"oit-text-handle"});c.append(y.create("div")).append(y.create("div")).ondragstart(a,b).ondragmove(a,q).ondragend(a,t).ondragcancel(a,t);return c};b.showHandles=function(a){a=
!1!==a?null:"none";this._startHandle.css("display",a);this._endHandle.css("display",a)};var c=function(a){var b=this._range;return h(this,this._startHandle,a,b.accend,b.acc)},f=function(a){var b=this._range;return h(this,this._endHandle,a,b.acc,b.accend)},h=function(a,b,c,d,e){a._anchor=d;a._focus=e;b=b.pos(w.viewNode);c=c.center;a._adjust={x:16-(c.x-b.left),y:-(c.y-b.top)};return!1},q=function(a){var b=a.center;if(b&&(a=this._parentObject,b=z.mapToPage(b.x+this._adjust.x,b.y+this._adjust.y,null,
!0,!0))){if(void 0===this._textAnchorRoot){var c=b.page.findACC(a._range.acc);this._textAnchorRoot=c?Ta(c[0]):null}if(c=b.page.mapPointToText(b.x,b.y,this._textAnchorRoot))c=c.acc,c!=this._focus&&(this._focus=c,this._focus>=this._anchor?(this._range.acc=this._anchor,this._range.accend=this._focus):(this._range.acc=this._focus,this._range.accend=this._anchor),this.changed(),a.setRange(this._range),a.dispatchCustom("textmove",{range:this._range,page:b.page}))}return!1},t=function(a){a=this._parentObject;
a.setRange(this._range);a.dispatchCustom("textmoveend",{range:this._range});delete this._anchor;delete this._focus;delete this._adjust;return!1};b.layoutObject=function(){if(this.visible()){var a=this._parentObject;Ca.prototype.layoutObject.call(this);d||(d=this._startHandle.defaultSize());var b=this._parentObject.position();if(b){this.show();var c=u(this._startHandle,b,a.startHandleRect()),b=u(this._endHandle,b,a.endHandleRect());c||b||(c=z.pagesForRange(a._range),this.show(c&&-1!=c.indexOf(a._page)))}else this.hide()}};
var u=function(a,b,c){c?(a.setMargin(c.left-b.left-d.width/2,c.bottom-b.top-1),a.resize(d.width,d.height),a.show()):a.hide();return c};return e}(),Oa=function(){var d=function(a,b,d){Ub.call(this,b,d);this._pos=new la(0,0,0,0,"overlay")},e=W(d,Ub);e.setLabel=function(a,b,d){if(a){if(d=d||"#FFF",a!==this._labelText||b!=this._labelColor||d!=this._backgroundColor)if(this._labelText=a,this._labelColor=b||"#000",this._labelBackground=d||"#FFF",this.setTitle(this._labelText),this._labels)for(a=0;a<this._labels.length;a++)b=
this._labels[a],b.setText(this._labelText),b.setColor(this._labelColor,this._labelBackground)}else this._labelText&&(delete this._labelText,delete this._labelColor,delete this._labelBackground,this.setTitle(""),this._labels&&(Y(this._labels,"destroy"),delete this._labels));this.changed()};e.allocateLabelChildren=function(a){this._labels||(this._labels=[]);for(;this._labels.length<a;){var b=new jd(this);this._labels.push(b);b.setText(this._labelText);b.setColor(this._labelColor,this._labelBackground)}for(;this._labels.length>
a;)this._labels.pop().destroy();return this._labels};e.labelChildCount=function(){return this._labels?this._labels.length:0};e.getLabelChild=function(a){if(this._labels)return this._labels[a]};e.move=function(c,d,e,q,t){this._pos.movesize(c,d,e,q)&&(this.changed(),this.finishAnimation(),t&&(c=this.position(),t.stepFn&&(this.stepMoveFn=t.stepFn),t.endFn&&(this.endMoveFn=t.endFn),t={offsetLeft:c.left,offsetTop:c.top,innerWidth:c.width,innerHeight:c.height,transition:t.transition||"ease",time:t.timems,
startFn:t.startFn,stepFn:b,endFn:a,context:this},this._animating=!0,this.animate(t)));return this};var b=function(a){this.update(!0);this.stepMoveFn&&this.stepMoveFn(this)},a=function(a){delete this._animating;this.changed();this.endMoveFn&&this.endMoveFn(this);delete this.stepMoveFn;delete this.endMoveFn};e.resize=function(a,b){return this.move(void 0,void 0,a,b)};e.position=function(){return this._pos};return d}(),Hb=function(){var d=function(b,a,c){Oa.call(this,b,a,c)},e=W(d,Oa);e.customEvent("resizestart");
e.customEvent("resizemove");e.customEvent("resizeend");e.activate=function(b,a){this._rectActivation||(this._rectActivation=new kd(this),a&&this.insertFirst(this._rectActivation),this._resizable&&this._rectActivation.setResizable(this._resizable));this.moveToTop();return this};e.deactivate=function(){this._rectActivation&&(this._rectActivation.destroy(),delete this._rectActivation);return this};e.resizable=function(b,a){if(!0===b){a=a||{};var c=!0,d=a.minWidth||0,e=a.minHeight||0,q=a.margin||0;!1===
a.bindToObject&&(c=!1);this._resizable&&this._resizable.bindToObject==c&&this._resizable.onResizeStart==a.onResizeStart&&this._resizable.onResize==a.onResize&&this._resizable.onResizeEnd==a.onResizeEnd&&this._resizable.onResizeCancel==a.onResizeCancel&&this._resizable.context===a.context&&this._resizable.minWidth==d&&this._resizable.minHeight==e&&this._resizable.margin==q||(this._resizable={bindToObject:c,minWidth:d,minHeight:e,margin:q},a.onResizeStart&&(this._resizable.onResizeStart=a.onResizeStart),
a.onResize&&(this._resizable.onResize=a.onResize),a.onResizeEnd&&(this._resizable.onResizeEnd=a.onResizeEnd),a.onResizeCancel&&(this._resizable.onResizeCancel=a.onResizeCancel),this._resizable.context=a.context||this,this._rectActivation&&this._rectActivation.setResizable(this._resizable))}else this._resizable&&!1===b&&(delete this._resizable,this._rectActivation&&this._rectActivation.setResizable(null));return this};e.layoutObject=function(){if(this.visible()&&!this._animating&&(Oa.prototype.layoutObject.call(this),
this._labelText)){var b=this.position().clone();b.left=0;b.top=0;this.allocateLabelChildren(1)[0].setBoundingRect(b)}return this};return d}(),md=function(){var d=function(b,a,c){Oa.call(this,b,a,c);b=this.defaultSize();this.move(void 0,void 0,b.width,b.height)},e=W(d,Oa);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return d}(),nd=function(){var d=function(b,a,c,d){var e=["oit-badge"];c&&e.push(c);
Oa.call(this,b,a,e);this.resize(20,20);this.text(d)},e=W(d,Oa);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return d}(),od=function(){var d=function(a,b,d){Oa.call(this,a,b,d);this._page=z.page(a)},e=W(d,Oa);e.customEvent("textmove");e.customEvent("textmoveend");e.activate=function(a){this._textActivation||(this._textActivation=new ld(this));this._textActivation.showHandles(this._showHandles);this.moveToTop();
return this};e.deactivate=function(){this._textActivation&&(this._textActivation.destroy(),delete this._textActivation);return this};e.setRange=function(a){if(a&&"text"===a.type)if(!this._range)this._range=ea(a),this.changed();else if(this._range.acc!=a.acc||this._range.accend!==a.accend)this._range.acc=a.acc,this._range.accend=a.accend,this.changed();return this};e.showTextHandles=function(){this._showHandles=!0;this._textActivation&&this._textActivation.showHandles(!0);return this};e.hideTextHandles=
function(){this._showHandles=!1;this._textActivation&&this._textActivation.showHandles(!1);return this};e.layoutObject=function(){if(this.visible()&&!this._animating){var a=this._page.textBoundingRect(this._range);a&&(a.origin="overlay",this.move(a.left,a.top,a.width,a.height));Oa.prototype.layoutObject.call(this);if(this._labelText){var b=this._page.textRects(this._range,"overlay"),a=this._page.textBoundingRect(this._range);if(b&&a&&(a.origin="overlay",this.allocateLabelChildren(b.length),0<this._labels.length))for(var d=
this.getLabelChild(0).defaultSize(),e=0;e<this._labels.length;e++){var q=this.getLabelChild(e);q.setDefaultSize(d);this._moveable?q.addClass("oit-moveable"):q.removeClass("oit-moveable");var t=b[e].interiorRect(d,!0);t&&t.offset(-a.left,-a.top);q.setBoundingRect(t)}}}return this};var b=function(a,b,d){var c=a._page.accRect(b,"overlay");if(!c)for(var e=0<d?1:-1,f=e;!(c=a._page.accRect(b+f,"overlay"))&&f!=d;f+=e);c&&(c.width=0);return c};e.startHandleRect=function(){if(this._range)return b(this,this._range.acc,
1)};e.endHandleRect=function(){if(this._range)return b(this,this._range.accend,-2)};return d}(),pd=function(){var d=function(a,b,d){T.call(this,"div","oit-drawinglayer oit-drawinglayer-"+b,d);this._drawing=a;this._name=b;this._visible=!0;y.attach(this);a.append(this);this.show()},e=W(d,T);e.drawing=function(){return this._drawing};e.show=function(a,b){void 0===a&&(a=!0);a!==this._visible&&(!0===a?(this._visible=!0,this.css("display",null),!1!==b&&this.update(!0)):!1===a&&(this._visible=!1,this.css("display",
"none")))};e.hide=function(){this.show(!1)};e.visible=function(){return this._visible};e.update=function(a){this.queryChildElements(b,a)};var b=function(a,b,d){a.update&&a.update(d)};e.changed=function(){this._drawing.changed()};return d}(),bd=function(){var d=function(a){T.call(this,"div","oit-drawingpanel");y.attach(this);this._origin=null;a.append(this);a.onscroll(this,this.updateScroll)},e=W(d,T);e.destroy=function(){var a=this.parent();a&&a.offscroll(this.updateScroll);T.prototype.destroy.call(this)};
e.update=function(a){!0!==a&&(a=!1);this._animationFrame&&(this._animationFrame=null);this.queryChildElements(b,a)};var b=function(a,b,d){a.update&&a.update(d)};e.changed=function(){this._animationFrame||(this._animationFrame=cb(this.update,this))};e.setOrigin=function(a,b){if(!this._origin)this._origin={x:a,y:b},this.updateScroll();else if(this._origin.x!=a||this._origin.y!=b)this._origin.x=a,this._origin.y=b,this.updateScroll()};e.resetOrigin=function(){this._origin&&(this._origin=null,this.css({left:null,
top:null}))};e.updateScroll=function(){if(this._origin){var a=this.parent().scroll();this.css({left:this._origin.x+a.left+"px",top:this._origin.y+a.top+"px"})}};return d}(),vb=function(){var d=function(a,b,d){T.call(this,a);this.acc=b;this.accend=d;void 0===this.accend&&(a=y.data(this,"accend"))&&(this.accend=Number(a));void 0===this.accend&&(this.accend=b+this.text().length)},e=W(d,T);e.destroy=function(){this.unload();T.prototype.destroy.call(this)};e.unload=function(){a(this,null,null)};e.text=
function(a){if(void 0!==a){var b=this._anchor||this;b.destroyChildren();b.dom.textContent=a}return this.dom.textContent};e.textNode=function(){return(this._anchor||this).dom.firstChild};e.createSplit=function(a){var b=new d("span",this.acc,a);this.copyDataTo(b);var c=this.text(),e=a-this.acc;b.text(c.substring(0,e));this.text(c.substring(e));this.acc=a;this._changed=!0;return b};e.mergeSplit=function(a){var b=this.text()+a.text();this.text(b);this.accend=a.accend;this._changed=!0;a.destroy()};e.dataEquals=
function(a){var b=!1,c=this._data;a=a._data;if(!c)b=!a;else if(a&&c.length==a.length)for(var b=!0,d=0;d<c.length;d++){var e=c[d],u=a[d];if(e.type!==u.type||e.id!==u.id){b=!1;break}}return b};e.addData=function(a){this._data||(this._data=[]);"hyperlink"===a.type?this._data.unshift(a):this._data.push(a);this._changed=!0};e.changeData=function(a){if(this._data)for(var b=0;b<this._data.length;b++){var c=this._data[b];if(c.type===a.type&&c.id===a.id){this._data[b]=a;this._changed=!0;break}}};e.removeData=
function(a,b){if(this._data)for(var c=0;c<this._data.length;c++){var d=this._data[c];if(d.type===a&&d.id===b){this._data.splice(c,1);0===this._data.length&&delete this._data;this._changed=!0;break}}};e.copyDataTo=function(a){this._data&&(a._data=a._data?a._data.concat(this._data):this._data.slice(0),a._changed=!0)};e.moveDataTo=function(a){this._data&&(b(this,null,null,null,null),a._data=a._data?a._data.concat(this._data):this._data,delete this._data,this._changed=!0,a._changed=!0)};e.updateData=
function(){if(this._changed){var a=null,d=null,e=null,q=null,t=void 0;if(this._data)for(var u=0,v=0;v<this._data.length;v++){var p=this._data[v];if("style"===p.type){if(p.className&&(q||(q=[]),q.push(p.className)),p.props)for(var l in p.props)if(p.props.hasOwnProperty(l)){var m=p.props[l];if("background-color"==l){var w=p.priority||0;void 0===t||w>t?(t=w,u=1,e||(e={}),e[l]=m):w==t&&(e[l]=dc(m,e[l],u,!0),u++)}else e||(e={}),e[l]=m}}else"hyperlink"===p.type?a=p:"bookmark"===p.type&&(d=p)}b(this,e,q,
a,d);this._changed=!1}};var b=function(b,d,e,q,t){d?(d=Nc(d),d!=b._splitClass&&(b._splitClass&&b.removeClass(b._splitClass),b.addClass(d),b._splitClass=d)):b._splitClass&&(b.removeClass(b._splitClass),delete b._splitClass);b._appliedClasses&&(b.removeClass(b._appliedClasses),delete b._appliedClasses);e&&(b.addClass(e),b._appliedClasses=e);a(b,q,t)},a=function(a,b,d){var c=a._anchor;if(b){var e=b&&0===b.url.indexOf("#");c||(c=e?a._anchor=y.create("span"):a._anchor=y.create("a"),c.text(a.text()),a.html(""),
a.append(c));b&&(a.addClass("oit-hyperlink"),e||c.attr("href",b.url),Lc.on.addElement(c,b));d&&c.attr("id",d.id)}else d?a.attr("id",d.id):c&&(Lc.on.removeElement(c),b=c.text(),c.destroy(),delete a._anchor,a.removeClass("oit-hyperlink"),a.html(b))};return d}(),qd=function(){var d=RegExp("^[^\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]*?[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]"),e=function(a,b,c){vb.call(this,a,b);this._origin=c},b=W(e,vb);b.unload=function(){this.discardLayout();
Y(this._splits,"unload");vb.prototype.unload.call(this)};b.discardLayout=function(){delete this._charRects;delete this._spanRect};b.distanceFromPoint=function(a,b){var c=this.findClosestChar(a,b);if(c)return c.distance};b.overlapRange=function(a){var b=this.spanRect();if(b.overlaps(a)){if(a.contains(b))return pa(this.acc,this.accend);if(b=f(this)){for(var c,d,e=0;e<b.length;e++)a.overlaps(b[e])&&(d=this.acc+e,void 0===c&&(c=d),d+=1);if(void 0!==c)return pa(c,d)}}};b.spanRect=function(){var a=this._spanRect;
a||(a=z.elementRect(this,this._origin),0<a.width&&0<a.height&&(this._spanRect=a));return a};b.textAngle=function(){void 0===this._angle&&(this._angle=this.ancestorData("angle"),this._angle=void 0!==this._angle?Number(this._angle)*Math.PI/180:0);return this._angle};b.rtl=function(){void 0===this._rtl&&(this._rtl=!!d.test(this.text()));return this._rtl};b.findClosestChar=function(a,b){var c=f(this),d,e,h;for(d=0;d<c.length;d++){var l=Math.abs(c[d].distanceFrom(a,b,"left","middle"));if(void 0===e||l<
h)e=d,h=l,d==c.length-1&&(l=c[d].distanceFrom(a,b,"center","none"),0<l&&e++)}var m,q;if(this._splits){c=this._splits;for(d=l=0;d<c.length;d++){var I=c[d].textNode(),Q=l+I.textContent.length;if(e>=l&&e<Q){m=I;q=e-l;break}l=Q}m||(m=c[c.length-1].textNode(),q=m.textContent.length)}else m=this.textNode(),q=e;return{node:m,offset:q,acc:this.acc+e,distance:h}};b.textRect=function(a){var b=this.spanRect();if(this.hasClass("oit-hiddentext"))return new la(b);if(0===b.width||0===b.height)return null;if(!a||
a.acc<=this.acc&&a.accend>=this.accend)return new la(b);if(a.acc<this.accend&&a.accend>this.acc){var c=this.text(),b=a.acc-this.acc;0>b&&(b=0);a=a.accend-this.acc;a>c.length&&(a=c.length);if((c=f(this,b,a))&&0<c.length){var d;d=new la(c[b],this._origin);a==b&&(d.width=0);for(b+=1;b<a;b++)d.union(c[b]);return d}}};b.findTextRange=function(a,b){var c,d,e,f,h=this._splits;if(h){if(a.acc<=this.acc&&(c=h[0].textNode(),d=0),a.accend>=this.accend&&(e=h[h.length-1].textNode(),f=e.textContent.length),!c||
!e)for(var m=0;m<h.length;m++){var q=h[m];if(a.accend<q.acc)break;if(!c&&a.acc<q.accend&&(c=q.textNode(),d=a.acc-q.acc,0>d&&(d=0),e))break;if(c&&!e&&a.accend<=q.accend){e=q.textNode();f=a.accend-q.acc;0>f&&(f=0);break}}}else c=e=this.textNode(),d=0,a.acc>this.acc&&(d+=a.acc-this.acc),f=this.text().length,a.accend<this.accend&&(f-=this.accend-a.accend);h=V.createRange();h.setStart(c,d);h.setEnd(e,f);b.push(h)};var a=function(a,b,c,d){c._charRects.push(new la(a.rect(d),d))},c=function(a,b,d,e,f,p,l,
m,w){var h;a=y.unwrap(a);if(3==a.nodeType){if(h=a.textContent.length,b<=w&&b+h>=m)for(m-=b,0>m&&(m=0),w-=b,w>h&&(w=h),h=m;h<w;h++)l[h+b]||(p.setStart(a,h),p.setEnd(a,h+1),m=p.getBoundingClientRect(),m=new la(m.left-f.left,m.top-f.top,m.right-f.left,m.bottom-f.top,e),m.origin=d._origin,l[h+b]=m)}else for(h=0;h<a.childNodes.length&&b<=w;h++){var v=a.childNodes[h],q=b+v.textContent.length;m<=q&&b<=w&&c(v,b,d,e,f,p,l,m,w);b=q}},f=function(b,d,e){d||(d=0);e||(e=b.text().length);var f=V.createRange?V.createRange():
null;if(f&&f.getBoundingClientRect)try{var h,p;b._origin instanceof T&&!(b._origin instanceof hb)?(h=b._origin,p=h.rect()):(h="view",p=w.viewNode.rect());var l=b._charRects||[];c(b,0,b,h,p,f,l,d,e);b._charRects=l}catch(m){}else if(!b._charRects){f=b.text();e=new T;e.transferFrom(b);h=[];for(d=0;d<f.length;d++)h.push("<span>"),h.push(f[d]),d+1<f.length&&(p=f.charCodeAt(d),l=f.charCodeAt(d+1),1536<=p&&1791>=p&&1536<=l&&1791>=l&&h.push("&zwj;")),h.push("</span>");b.html(h.join(""));b._charRects=[];b.forChildElements(a,
b,b._origin);d=new la(b.rect(b._origin),b._origin);b.html("");b.transferFrom(e);f=b.spanRect();if(f.width!=d.width&&(e=f.width/d.width,!ec(e,1)))for(f=f.left,d=0;d<b._charRects.length;d++)h=b._charRects[d],p=(h.left-f)*e+f,h.move(p,void 0,p+h.width*e,void 0)}return b._charRects};b.createSplit=function(){var a=new vb("span",this.acc,this.accend);this.moveDataTo(a);a.transferFrom(this);return a};b.updateData=function(){var a=this._splits;a?Y(a,"updateData"):vb.prototype.updateData.call(this)};b.split=
function(a){if(!a)return this._splits;if(!this._splits){if(a.acc<=this.acc&&a.accend>=this.accend||this.hasClass("oit-hiddentext"))return[this];var b=this.createSplit();this.append(b);this._splits=[b]}for(var b=this._splits,c=[],d=0;d<b.length;d++){var e=b[d],f;if(!(a.acc>=e.accend)){if(a.accend<=e.acc)break;a.acc>e.acc&&(f=e.createSplit(a.acc),b.splice(d++,0,f),this.insert(f,e));a.accend<e.accend&&(f=e.createSplit(a.accend),b.splice(d++,0,f),this.insert(f,e),e=f);c.push(e)}}return c};b.join=function(){var a=
this._splits;if(a){for(var b,c=a[a.length-1],d=a.length-2;0<=d;d--)b=a[d],b.dataEquals(c)&&(b.mergeSplit(c),a.splice(d+1,1)),c=b;1==a.length&&(b=a[0],b.moveDataTo(this),this.text(b.text()),b.destroy(),delete this._splits)}};b.addDataToRange=function(a,b){var c=this.split(a);c&&(Y(c,"addData",null,b),this.join(),this.updateData(),"hyperlink"===b.type&&f(this))};b.changeData=function(a){vb.prototype.changeData.call(this,a);Y(this._splits,"changeData",null,a);this.updateData()};b.removeData=function(a,
b){vb.prototype.removeData.call(this,a,b);Y(this._splits,"removeData",null,a,b);this.join();this.updateData()};return e}(),Pc=function(){var d=function(b,a){this._page=b;this._contentRoot=a||b;this._spans=[];if(1024<this._contentRoot.text().length)for(var c=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),d=c.firstACCNode();d;){for(var e=c.currentNode,q=!0,d=e.firstChild;d;d=d.nextSibling)if(3!==d.nodeType){q=!1;break}if(q&&1024<e.textContent.length){(d=c.skipNode())&&(d=c.firstACCNode());
for(var q=e.textContent,t=[],u=0;u<q.length;u+=1024){var v=q.substring(u,u+1024),v=Kb(v);t.push("<span>",v,"</span>")}e.innerHTML=t.join("");e.textContent.length!=q.length&&(e.textContent=q)}else d=c.nextACCNode()}for(var p,c=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),d=c.firstACCNode();d;){e=c.currentNode;(d=y.data(e,"acc"))&&(p=Number(d));q=!0;for(d=e.firstChild;d;d=d.nextSibling)if(3==d.nodeType){q=!1;break}q||void 0===p?d=c.nextACCNode():(e=new qd(e,p,this._contentRoot),this._spans.push(e),
p=e.accend,(d=c.skipNode())&&(d=c.firstACCNode()))}this._layoutSettings={};if(!b.checkedACCRange){if(c=this.getTextRange())c.acc<b.acc&&(b.acc=c.acc),c.accend>b.accend&&(b.accend=c.accend);b.checkedACCRange=!0}},e=W(d);e.destroy=function(){Y(this._spans,"unload");this.deleteAll()};e.discardLayout=function(){Y(this._spans,"discardLayout")};e.getTextRange=function(){for(var b,a=0;a<this._spans.length;a++){var c=this._spans[a];b?(c.acc<b.acc&&(b.acc=c.acc),c.accend>b.accend&&(b.accend=c.accend)):b=pa(c.acc,
c.accend)}return b};e.textRanges=function(){for(var b=[],a,c=this._page.isEmailHeader(),d=0;d<this._spans.length;d++){var e=this._spans[d];!c&&a&&a.accend+1>=e.acc?e.accend>a.accend&&(a.accend=e.accend):(a=pa(e.acc,e.accend),b.push(a))}return b};e.mapPointToSpan=function(b,a,c){if(0<this._spans.length){var d,e,q,t;this._page.pushShow();var u=[],v;for(t=0;t<this._spans.length;t++)if(q=this._spans[t],!q.hasClass("oit-hiddentext")&&(!c||q.equals(c)||q.isDescendantOf(c))&&(e=q.spanRect())&&0<e.width&&
0<e.height){e=a<e.top?e.top-a:a>e.bottom?a-e.bottom:0;if(void 0===v||e<v)u.length=0,v=e;e==v&&u.push(q)}v=void 0;if(1==u.length)d=u[0];else for(t=0;t<u.length;t++)if(q=u[t],e=Math.abs(q.distanceFromPoint(b,a)),void 0===v||e<v)d=q,v=e;this._page.popShow();return d}};e.findOverlappingText=function(b){if(0<this._spans.length){var a=[];this._page.pushShow();for(var c=0;c<this._spans.length;c++){var d=this._spans[c].overlapRange(b);d&&a.push(d)}this._page.popShow();if(0<a.length)return a}};e.findRange=
function(b,a){for(var c=[],d=0;d<this._spans.length;d++){var e=this._spans[d];e.acc<=a&&e.accend>b&&c.push(e)}if(0<c.length)return c};e.findACC=function(b){for(var a=[],c=0;c<this._spans.length;c++){var d=this._spans[c];b>=d.acc&&b<d.accend&&a.push(d)}if(0<a.length)return a};return d}(),hb=function(){var d=/\S/,e=function(a,b,c){var d=V.getElementById(c);d?T.call(this,d):T.call(this,"div","oit-section oit-"+b+" oit-pending",c);this.prop("index",a);this.data("page",this);this._needArrange=!0;this._staticContent=
!!this.firstChildElem()},b=W(e,T);b.processData=function(b){var c=this.isEmailHeader(),d={},e=!1,g=!1,f;for(f in b){var r=b[f],h=null,l=!1;switch(f){case "embeds":case "frames":case "fields":case "attachments":case "comments":h="_"+f;break;case "data":case "src":case "href":h="_"+f+"URL";break;case "section":case "name":case "type":case "media":case "dpi":case "autodpi":case "hiddenFromSlideshow":h=f;break;case "acc":case "accend":h=f;l=!0;break;case "w":c||this.css("width",r);h="width";r=parseInt(r,
10);l=!0;break;case "h":c||this.css("height",r);h="height";r=parseInt(r,10);l=!0;break;case "oid":(r=z.overlayById(b.oid))&&r!==this.overlay&&(h="overlay",g=!0);break;case "background":this.css("background",r)}h&&!this.hasOwnProperty(h)&&(d[h]={value:r,writable:l,enumerable:!1},e=!0)}"sn"!==this.type||this.width||(c=z.page(this.index-1))&&c.width&&(d.width={value:c.width,writable:!1,enumerable:!1},e=!0,this.css("width",c.css("width")),G.layoutChanged());e&&Object.defineProperties(this,d);g&&this.overlay.add(this);
b.content&&!this.isLoaded()&&(!0===this.deferContent?this.deferredContent=b.content:a(this,b.content));!this._ssmodel&&b.ssdata&&(this._ssmodel=new rd(b.ssdata,this._embeds,this));if(b.comments){if(this.supportsAnnotations()){e=d=!1;ha.infoRaw();for(g=0;g<b.comments.length;g++)c=b.comments[g],c.range&&c.text?d=!0:e=!0;d&&F.hiddenContent("comments");e&&F.hiddenContent("comments-unsupported")}else F.hiddenContent("comments-unsupported");this.overlay.hasAnnotations(!0)}"sn"===b.type&&F.hiddenContent("speaker-notes");
b.hiddenFromSlideshow&&F.hiddenContent("hidden-slides");b.hidden_columns&&F.hiddenContent("hidden-columns");b.hidden_rows&&F.hiddenContent("hidden-rows");this._staticContent&&(v(this,!1),Q(this))};b.supportsAnnotations=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":case "worksheet":case "database":return!0}return!1};b.supportsAnnotationPane=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":return!0}return!1};
b.supportsAnnotationBar=function(){switch(this.type){case "worksheet":case "database":return!0}return!1};var a=function(a,b){var c=y.create("div");c.html(b);var d=c.byClass("oit-view");if(d&&0<d.length)for(c=0;c<d.length;c++){var e=d[c].byClass("oit-section");if(e)for(var g=0;g<e.length;g++){var k=e[g],f=z.pageById(k.id);f&&!f.firstChildElem()&&(w.baseURL&&p(k),f.transferFrom(k),f.addClass(k.attr("class")))}}else w.baseURL&&p(c),a.transferFrom(c),a._needArrange=!0};b.destroy=function(){this.unload();
T.prototype.destroy.call(this)};b.unload=function(){var a=this.isLoaded();this.abortLoad();this._needArrange=!0;this._selRect&&(this._selRect.destroy(),delete this._selRect);this._ssmodel&&(this._ssmodel.unload(),delete this._ssmodel);this._spanMap&&(this._spanMap.destroy(),delete this._spanMap);this._annotationPane&&(this._annotationPane.destroy(),delete this._annotationPane);0<this.loadedSize&&(this.pageContentChanged(),this.html(""),this.addClass("oit-pending"),this.loadedSize=0);this.logUnload&&
this.logUnload();a&&z.on.pageunload.dispatch(this)};b.show=function(a){var b;if(this.isHidden()){a=a||{};this.finishAnimation();a.animate&&this.css("opacity",0);if(!this.parent()){var c;if(!a.insertLast)for(var d=this.index+1;;d++){b=z.page(d);if(!b||b.overlay!==this.overlay)break;if(!b.isHidden()){c=b;break}}c?this.overlay.insert(this,c):this.overlay.append(this);this._annotationPane&&this._annotationPane.show()}a.animate?(void 0===a.time&&(a.time=a.animate?150:0),a.opacity=1,this.animate(a)):a&&
a.endFn&&a.endFn();"vertical"===x.scrollMode&&(b=z.page(this.index+1))&&"sn"===b.type&&x.showSlideNotes&&b.show()}else a&&a.endFn&&a.endFn();return this};b.hide=function(){var a=y.unwrap(this).parentNode;a&&(this.finishAnimation(),a.removeChild(this.dom),this._annotationPane&&this._annotationPane.hide(),"vertical"===x.scrollMode&&(a=z.page(this.index+1))&&"sn"===a.type&&a.hide());return this};b.pushShow=function(){this._showState?this._showState.count++:(this._showState={count:1},this.parent()||(this._showState.pageHidden=
!0,this.show(),this._annotationPane&&this._annotationPane.show()),this.overlay.isDisplayed()||(this._showState.overlayUndisplayed=!0,this.overlay.display()),this.overlay.isHidden()&&(this._showState.overlayHidden=!0,this.overlay.show()),"none"===this.computedStyle().display&&(this._showState.pageDisplayNone=!0,this.css("display","block")))};b.popShow=function(){this._showState&&(this._showState.count--,0>=this._showState.count&&(this._showState.pageDisplayNone&&this.css("display",null),this._showState.overlayHidden&&
this.overlay.hide(),this._showState.overlayUndisplayed&&this.overlay.undisplay(),this._showState.pageHidden&&(this.hide(),this._annotationPane&&this._annotationPane.hide()),delete this._showState))};b.isHidden=function(){return this._hidden||!this.parent()||!this.overlay||this.overlay.isHidden()||!this.overlay.isDisplayed()};b.filter=function(a){return a!==this.index};b.info=function(){var a={page:this.index,type:this.type,typeEx:this.type,features:ua.features(this.type),comments:!!this._annotationPane};
if("slide"==a.type){var b=z.page(this.index+1);b&&"sn"===b.type?a.notes=!0:y.byId(this.id+".note")?a.notes=!0:a.notes=!1}else"rt"==a.type?(0<this.index&&"email"==z.page(this.index-1).type&&(a.type="email"),"rt"==a.type&&(a.type="html")):"sn"==a.type&&(a.type="slide",a.notes=!0);void 0!=this.hiddenFromSlideshow&&(a.hiddenFromSlideshow=this.hiddenFromSlideshow);void 0!==this.acc&&(a.acc=this.acc,void 0!==this.accend&&(a.accend=this.accend));this.width&&this.height&&(a.width=this.width,a.height=this.height);
return a};b.features=function(){return ua.features(this.type)};b.isEmailHeader=function(){return this.hasClass("oit-emailheaderpage")||"emailheader"===this.id||"emailheader.1"===this.id};b.isPending=function(){return this.hasClass("oit-pending")};b.isLoading=function(){return this.hasClass("oit-loading")};b.isLoaded=function(){return!this.hasClass("oit-pending")&&!this.hasClass("oit-loading")};b.isEnabled=function(){return"slideshow"!=x.presentationMode?!0:"slide"!=this.type||!this.hiddenFromSlideshow};
b.mapPointToText=function(a,b,c,d){var e;d?e=this.annotationPane().mapPointToSpan(a,b,c):(d=this.getSpanMap())&&(e=d.mapPointToSpan(a,b,c));if(e){var g=e.textAngle();c=e.spanRect();d=c.left;var k=c.top,f=c.right,r=c.bottom;if(0!==g){c=[{x:d,y:k},{x:f,y:k},{x:f,y:r},{x:d,y:r}];d=Math.cos(g);k=Math.sin(g);for(f=0;f<c.length;f++)r=c[f].x-a,g=c[f].y-b,c[f].x=a+r*d+g*k,c[f].y=b+-r*k+g*d;d=f=c[0].x;k=r=c[0].y;for(g=1;4>g;g++){var n=c[g];n.x<d?d=n.x:n.x>f&&(f=n.x);n.y<k?k=n.y:n.y>r&&(r=n.y)}}e=e.findClosestChar(a,
b);e.overlaps=a>=d-2&&a<=f+2&&b>=k-2&&b<=r+2;return e}};b.findTextBoundary=function(a,b,c){a=Ob(a);if(Z&&void 0!==a&&(a+=b,b=Z.findBoundaryStart(a,c),c=Z.findBoundaryEnd(b,c),void 0!==b&&void 0!==c)){c=pa(b,c);if(this._frames){var d,e;for(b=0;b<this._frames.length;b++){var g=this._frames[b];a>=g.acc&&a<g.accend&&(void 0===d?(d=g.acc,e=g.accend):(g.acc<d&&(d=g.acc),g.accend>e&&(e=g.accend)))}c.acc<d&&(c.acc=d);c.accend>e&&(c.accend=e)}if(d=this.findTextRange(c))return kc(d)}};b.resetCache=function(){delete this._cachedRects;
if(this._annotationPane)this._annotationPane.onResize(!0)};var c=function(a){var b=a._cachedRects;b||(b=a._cachedRects={});var c=w.viewNode,d=c.clientWidth,e=c.clientHeight,g=c.scroll(),c=g.left,g=g.top,f=a.offsetLeft;a=a.offsetTop;var r=x.zoom,h=x.rotation;if(b.viewWidth!=d||b.viewHeight!=e||b.scrollLeft!=c||b.scrollTop!=g||b.offsetLeft!=f||b.offsetTop!=a||b.zoom!=r||b.rotation!=h)b.view=null,b.overlay=null,b.pos=null,b.viewWidth=d,b.viewHeight=e,b.scrollLeft=c,b.scrollTop=g,b.offsetLeft=f,b.offsetTop=
a,b.zoom=r,b.rotation=h;return b};b.pageRect=function(a){var b=c(this);if("view"===a||"overlay"===a){var d=b[a];d||((d=G.pageRect(this.index,a))&&d.readonly(!0),b[a]=d);return d}b.page||(b.page=G.pageRect(this.index,this));return b.page};b.pagePos=function(a){if("overlay"===a)return a=c(this),a.pos||(a.pos=this.pos(this.overlay)),a.pos;if("view"===a){a=this.pagePos("overlay");a={left:a.left,top:a.top};var b=G.padding();b&&(a.left+=b.left,a.top+=b.top);if(b=G.scrollOffset())a.left-=b.left,a.top-=b.top;
return a}};b.inAnnotation=function(a){var b=!1;if("text"===a.type&&!this.findRange(a.acc,a.accend,"page")){var c;this._annotationPane&&(c=this._annotationPane.findRange(a.acc,a.accend));if(c)b=!0;else if(this._comments)for(c=0;c<this._comments.length;c++){var d=this._comments[c];if(d.text){for(var e=0;e<d.text.length;e++){var g=d.text[e].range;if(g&&bb(a,g)){b=!0;break}}if(b)break}}}return b};b.containsRange=function(a){if("text"!==a.type)return a.page==this.index;var b=!1,c;if(a.acc<=this.accend&&
a.accend>=this.acc){switch(this.type){case "worksheet":case "database":(b=this.spreadsheetModel())&&!b.hasPendingContent()?(b=b.containsRange(a),b||(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)))):b=!0;break;default:if(this._frames)for(c=0;c<this._frames.length;c++){var d=this._frames[c];if(a.acc<=d.accend&&a.accend>=d.acc){b=!0;break}}!b&&this.isLoaded()&&(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==
c&&0<c.length&&(b=!0)));b||this._frames||this.isLoaded()||(b=!0)}!b&&this._comments&&(b=z.isAnnotationText(a.acc,a.accend,this._comments))}return b};var f=function(a,b){return a.acc-b.acc},h=function(a,b){if(b&&0<b.length){b.sort(f);for(var c=[],d,e=a.isEmailHeader(),g=0;g<b.length;g++){var k=b[g];void 0!==k.acc&&(!e&&d&&d.accend+1>=k.acc?k.accend>d.accend&&(d.accend=k.accend):(d=pa(k.acc,k.accend),c.push(d)))}return c}};b.mapRectRangeToText=function(a){if("rect"===a.type){var b=this.getSpanMap();
if(b)return a=new la(a,this),h(this,b.findOverlappingText(a))}};b.textRanges=function(){var a=this.getSpanMap();if(a)return h(this,a.textRanges())};b.mapRangeToEmbeds=function(a){var b;if(this._embeds&&("rect"===a.type||"cell"===a.type)&&(a=G.rangeRect(a,this)))for(var c=0;c<this._embeds.length;c++){var d=this._embeds[c],e=this.embeddingRect(d.uid);if(e&&e.overlaps(a)){var g=e.left,f=e.top;e.intersect(a);e.offset(-g,-f);b||(b=[]);d=Fb(d.uid,this.index,e.left,e.top,e.right,e.bottom);va(d,"pct");b.push(d)}}return b};
b.embeddingByIndex=function(a){var b;this._embeds&&0<=a&&a<this._embeds.length&&(b=this._embeds[a]);return b};b.embeddingByUID=function(a){var b;this._embeds&&(b=fb(this._embeds,"uid",a));return b};b.embeddingRect=function(a){if(this._embeds&&(a=fb(this._embeds,"uid",a))){var b;if(a.position)b=a.position,b=new la(b.left,b.top,b.right,b.bottom,this);else{var c=a.x,d=a.y;if(void 0===c||void 0===d){var e=y.byId(a.id);e&&(e=z.elementRect(e,this),void 0===c&&(c=e.left),void 0===d&&(d=e.top))}void 0!=c&&
void 0!=d&&(b=new la(c,d,c+a.w,d+a.h,this))}return b}};b.textBoundingRect=function(a,b){if(this.isLoaded()&&"text"===a.type){var c;if(this.isSpreadsheet())z.activeOverlay()==this.overlay&&(c=G.rangeRect(a,this));else{this.pushShow();var d=this.findRange(a.acc,a.accend,b);if(d&&0<d.length){for(var e=Ta(d[0]),g=0;g<d.length;g++){var f=d[g].textRect(a);if(f){var k=Ta(d[g]);y.unwrap(k)===y.unwrap(e)&&(c?c.union(f):c=f)}}c||1!=d.length||(c=d[0],e=ea(a),e.accend==c.acc&&e.accend++,c=d[0].textRect(e))}this.popShow()}return c}};
b.frameForRange=function(a){var b;if(this.isLoaded()&&this._frames&&"text"===a.type)for(var c=0;c<this._frames.length;c++){var d=this._frames[c];if(a.accend>=d.acc&&a.acc<d.accend){b=y.byId(d.id);break}}return b};b.textRects=function(a,b,c){if(c||"text"!==a.type)Array.isArray(c)&&(c=c.slice());else{if(this.isSpreadsheet()&&z.activeOverlay()==this.overlay){var d=G.rangeRect(a,b);d&&(e=[new mc(d)])}c=this.findRange(a.acc,a.accend)}if(c&&0<c.length){var e;this.pushShow();c.sort(function(a,b){var c=a.spanRect(),
d=b.spanRect(),e=c.top-d.top;e||(e=c.left-d.left);return e});for(var g,f=[],d=0;d<c.length;d++){var k=c[d].textRect(a);k&&(g&&ec(k.top,g.top)&&ec(k.bottom,g.bottom)&&k.left<=g.right+1?g.union(k):(g=k,f.push(g)))}this.popShow();if(0<f.length)for(e||(e=[]),a=new mc(f[0]),e.push(a),d=1;d<f.length;d++)if(c=f[d],8>c.width||8>c.height)a.add(c);else{for(var k=c.left-5,r=c.right+5,n=c.top-2,h=c.bottom+2,C=a.length-1;0<=C;C--)if(g=a.item(C),r>=g.left&&k<=g.right&&h>=g.top&&n<=g.bottom){a.add(c);c=null;break}c&&
(a=new mc(c),e.push(a))}e&&("overlay"!==b&&"view"!==b||Y(e,"convert",null,b));return e}};b.accRect=function(a,b){var c,d=pa(a,a+1);if(this.isSpreadsheet())c=G.rangeRect(d,b);else{var e=this.findACC(a);if(e&&0<e.length){this.pushShow();for(var g=Ta(e[0]),f=0;f<e.length;f++){var k=e[f].textRect(d);if(k){var r=Ta(e[f]);y.unwrap(r)===y.unwrap(g)&&(c?c.union(k):c=k)}}c&&(c.origin=b);this.popShow()}}return c};b.findTextRange=function(a){if("text"===a.type&&a.acc<=this.accend&&a.accend>=this.acc&&this.isLoaded()){var b=
[],c=!1;if(this._frames&&"email"!==this.type)for(var d=0;d<this._frames.length;d++){var e=this._frames[d];if(a.acc<=e.accend&&a.accend>=e.acc)if((e=V.getElementById(e.id))&&0===e.childNodes.length){var g=V.createRange();g.setStart(e,0);g.setEnd(e,0);b.push(g)}else c=!0}else c=!0;c&&(c=a.acc===a.accend?this.findACC(a.acc):this.findRange(a.acc,a.accend))&&Y(c,"findTextRange",null,a,b);if(0<b.length)return b}};b.layer=function(a){if(this.overlay)return this.selectionRect(),this.overlay.layer(a)};b.hasSelectionRect=
function(){return!!this._selRect};b.selectionRect=function(){if(!this._selRect){var a=this.overlay?this.overlay.layer("selection"):void 0;this._selRect=new Hb(this.index,a,"oit-sel-rect");this._selRect.hide()}return this._selRect};b.showSelectionRect=function(a){this._selRect&&this._selRect.show(a)};b.findRange=function(a,b,c){var d;c=c||"all";if("all"===c||"page"===c){var e=this.getSpanMap();e&&(d=e.findRange(a,b))}!this._annotationPane||"all"!==c&&"annotations"!==c||(a=this._annotationPane.findRange(a,
b))&&(d=d?d.concat(a):a);return d};b.findACC=function(a){var b,c=this.getSpanMap();c&&(b=c.findACC(a));this._annotationPane&&(a=this._annotationPane.findACC(a))&&(b=b?b.concat(a):a);return b};b.pageContentChanged=function(){delete this._cachedRects;this._spanMap&&(this._spanMap.destroy(),delete this._spanMap)};b.pageLayoutChanged=function(){delete this._cachedRects;this._spanMap&&this._spanMap.discardLayout();if(this._annotationPane)this._annotationPane.onResize(!0)};b.isSpreadsheet=function(){return this._ssmodel||
this._dataURL};b.spreadsheetModel=function(){return this._ssmodel};b.getSpanMap=function(){void 0===this._spanMap&&this.isLoaded()&&(this.isSpreadsheet()?this._spanMap=null:this._spanMap=new Pc(this));return this._spanMap};var q=function(a){if(a.showProgressDialog&&void 0!==a.srcSize&&void 0!==a.dataSize){var b=a.srcSize+a.dataSize;262144<=b&&(b=100*(a.srcLoaded+a.dataLoaded)/b,a.progressDialog||(a.progressDialog=ya.createProgressDialog(M.PLEASE_WAIT_INITIALIZING,!0)),a.progressDialog&&a.progressDialog.update(b))}},
t=function(b){if(void 0===b.srcRequest&&void 0===b.dataRequest&&b.isLoading()){F.resumeIdleTimer("pageload");b.logLoad&&b.logLoad();b.removeClass("oit-loading");b.pageContentChanged();z.touchPage(b.index);b.loadedSize=0;b.dataSize&&(b.loadedSize+=b.dataSize);b.srcSize&&(b.loadedSize+=b.srcSize);z.applyMemoryLimit(b.loadedSize);b.deferredContent&&(a(b,b.deferredContent),delete b.deferredContent,delete b.deferContent);v(b,!0);b.progressDialog&&(b.progressDialog.hide(),delete b.progressDialog);delete b.showProgressDialog;
if(b.completionFuncs){for(var c=0;c<b.completionFuncs.length;c++)b.completionFuncs[c](b);delete b.completionFuncs}delete b.locked;Q(b)}},u=function(a){if(a&&"multimedia"==a.type){var b=a._hrefURL;w.baseURL&&"/"!=b.charAt(0)&&(b=Qa(w.baseUrl,b));"string"!==typeof a.media&&a.logError("OIPage","page of type 'multimedia' is missing 'media' property. using default of 'video'.");var c;switch(a.media){case "audio":c=sd;break;case "video":c=Qc;break;default:c=Qc,a.logError("OIPage","'media' property is invalid. got '"+
a.media+"' but expected either 'audio' or 'video'. defaulting to 'video'")}return new c(b,a)}a.logError("OIPage","cannot create a media player unless the 'page.type' is 'media'")},v=function(a,b){var c;a&&"email"==a.type&&(c=a.childByClass("oit-emailheader"),c||(c=a.byId("oit-emailheader"))&&c.addClass("oit-emailheader"),c&&(a.addClass("oit-emailheaderpage"),c=new td(c),a._emailHeader=c));(c=a.childByClass("oit-email_page"))&&!c.firstChildElem()&&c.css("display","none");if("sn"===a.type){c=y.create("div",
"oit-noteheader");c.html('<span class="oit-notesicon"></span><span class="oit-unselectable"> '+M.NOTES+"</span>");var d=a.firstChildElem();d.addClass("oit-sn-content");a.insert(c,d)}a.hiddenFromSlideshow&&(c=y.create("div","oit-hiddenpage"),c.attr("title",M.HIDDEN_SLIDE),a.append(c));"multimedia"===a.type&&(a._player?a.append(a._player):this.logError("OIPage","missing 'page._player'. expected to be set after page loaded."));r(a,a._comments);a.processRevisions();a.processSSRevisions();a.positionAnnotations();
z.on.pageload.dispatch(a,!!b)},p=function(a){a=y.wrap(a);if(w.baseURL){a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT);for(var b;b=a.nextNode();)if("IMG"===b.tagName){var c=b.getAttribute("src");c&&("/"!=c.charAt(0)&&(c=Qa(w.baseURL,c)),b.setAttribute("src",c))}else"image"===b.tagName&&(c=b.getAttribute("xlink:href"))&&("/"!=c.charAt(0)&&(c=Qa(w.baseURL,c)),b.setAttribute("xlink:href",c))}};b.abortLoad=function(){this.isLoading()&&(this.srcRequest&&(lb(this.srcRequest),delete this.srcRequest),this.dataRequest&&
(lb(this.dataRequest),delete this.dataRequest),this.removeClass("oit-loading"),this.addClass("oit-pending"))};b.load=function(a,b){var c=this,d=c.isPending(),e=c.isLoading();if((d||e)&&(c._srcURL||c._dataURL||c.media))if(e)b&&c.completionFuncs.push(b);else{c.dataSize=0;c.dataLoaded=0;c.srcSize=0;c.srcLoaded=0;c.completionFuncs=[];b&&c.completionFuncs.push(b);c.removeClass("oit-pending");c.addClass("oit-loading");c.locked=!0;!0===a&&(c.showProgressDialog=!0);d=w.baseURL;c._dataURL&&(e=c._dataURL,d&&
"/"!=e.charAt(0)&&(e=Qa(d,e)),c.dataRequest=Ma({url:e,context:c,loading:l,complete:m}));c._srcURL&&(e=c._srcURL,d&&"/"!=e.charAt(0)&&(e=Qa(d,e)),c.srcRequest=Ma({url:e,context:c,loading:H,complete:I}));if(c.media){H.call(c,0,"");var g=u(c);c._player=g;var f=function(a,b){a==g&&(Na.on.loaded.unlisten(f),t(c))};Na.on.loaded.listen(f);g.load()}(c.dataRequest||c.srcRequest)&&F.pauseIdleTimer("pageload")}else d&&(c.removeClass("oit-pending"),v(c,!1)),b&&b(c)};var l=function(a,b,c){this.dataSize=b;c&&(this.dataLoaded=
c.length);q(this)},m=function(a,b,c,d){this.dataSize=b;c&&(this.dataLoaded=c.length,q(this));if(200===d)try{var e=JSON.parse(c);this.processData({ssdata:e})}catch(ia){this.logAJAXError(null,"The data for page "+(this.index+1)+" is corrupt",a,d,c)}else this.logAJAXError(null,"Failed to load the data for page "+(this.index+1)+" from the server",a,d,c);delete this.dataRequest;t(this)},H=function(a,b,c){this.srcSize=b;c&&(this.srcLoaded=c.length);q(this)},I=function(a,b,c,d){this.srcSize=b;c&&(this.srcLoaded=
c.length,q(this));200===d?(this.deferContent=!0,ga.isICD(c)?ga.processICD(c,a,d):this.processData({content:c})):this.logAJAXError(null,"Failed to load the content for page "+(this.index+1)+" from the server",a,d,c);delete this.srcRequest;t(this)},Q=function(a){var b=ha.infoRaw();if(b&&1557===b.fi){var c=(b=a.firstChildElem())?b.firstChildElem():null,d=c?c.nextSiblingElem():null,e=d?d.nextSiblingElem():null,g=e?e.nextSiblingElem():null,f=c?c.firstChildElem():null,r=f?f.firstChildElem():null,h=d?d.firstChildElem():
null,n=e?e.firstChildElem():null,l=n?n.firstChildElem():null,m=l?l.firstChildElem():null,p=m?m.firstChildElem():null;if(r&&!r.nextSiblingElem()&&h&&!h.nextSiblingElem()&&p&&!p.nextSiblingElem()){var v=n.size(),q=p.size(),t=!0;v&&q&&0<v.width&&0<v.height&&0<q.width&&0<q.height&&(t=q.height/v.height,t=.9<=q.width/v.width&&.9<=t);"DIV"==b.tagName&&b.hasClass("oit-svg")&&"DIV"==c.tagName&&c.hasClass("oit-svg-layer")&&"DIV"==d.tagName&&d.hasClass("oit-frame")&&"DIV"==e.tagName&&e.hasClass("oit-svg-layer")&&
"svg"==f.tagName&&"rect"==r.tagName&&"DIV"==h.tagName&&h.hasClass("oit-svg-text")&&"svg"==n.tagName&&"g"==l.tagName&&l.hasClass("oit-pagescale")&&"g"==m.tagName&&m.hasClass("oit-framescale")&&"image"==p.tagName&&!g&&t&&(a="#"+a.id.replace(".","\\.")+" .oit-svg-text",F.screenCSS(a+" div","color:rgba(0,0,0,0);"),F.screenCSS(a+" span","color:rgba(0,0,0,0);"),b.append(d))}}};b.comments=function(){return this._comments};var J=function(a,b){if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)J(a[c],b);
else if(a.range&&"text"===a.range.type){if(void 0===b.acc||a.range.acc<b.acc)b.acc=a.range.acc;if(void 0===b.accend||a.range.accend>b.accend)b.accend=a.range.accend}},N=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)N(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=Z.getRawText(a.range.acc,a.range.accend))},D=function(a){var b="";if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)b+=D(a[c]);else a.range&&"text"===a.range.type&&a.text&&(b=a.text);return b},O=function(a,
b){if(a.isEmpty())b._annotationPane.destroy(),delete b._annotationPane;else{b.supportsAnnotationBar()&&z.createAnnotationBar();var c=a.range();c&&(c.acc<b.acc&&(b.acc=c.acc),c.accend>b.accend&&(b.accend=c.accend));x.showAnnotations&&a.layout()}},B=function(a,b){a._annotationPane||(a._annotationPane=new ud(a),x.showAnnotations?a._annotationPane.show():a._annotationPane.hide(),S.addAutoscrollRoot(a._annotationPane.scrollPane()));a._annotationPane.processAnnotations(b,O,a)},r=function(a,b,c){if(b&&a.supportsAnnotations()){for(var d=
{},e=0;e<b.length;e++){var g=b[e];J(g.text,d);J(g.author,d);J(g.author_short,d);J(g.last_save_date,d);J(g.create_date,d);J(g.date,d)}void 0!==d.acc?Z.loadRawText(d.acc,d.accend,function(){for(var d=0;d<b.length;d++){var e=b[d];N(e.text);N(e.author);N(e.author_short);N(e.last_save_date);N(e.create_date);N(e.date)}c&&(b=c(a,b));B(a,b)}):(c&&(b=c(a,b)),B(a,b))}};b.processRevisions=function(){if(this.isLoaded()&&this.supportsAnnotations()){var a=F.revisions();if(a){for(var b=[],c=0;c<a.length;c++){var e=
a[c];e.range&&this.findRange(e.range.acc,e.range.accend,"page")&&b.push(e)}b.length&&r(this,b,function(a,b){for(var c=0;c<b.length;c++){var e=b[c],g=b[c-1];if(g&&e.range&&g.range&&("add"===e.type&&"delete"===g.type||"delete"===e.type&&"add"===g.type)){var f=D(e.author),k=D(g.author),r=D(e.last_save_date||e.create_date),h=D(g.last_save_date||g.create_date);f===k&&r===h&&(g.range.acc==e.range.acc&&g.range.accend==e.range.accend?"add"===g.type?b.splice(c-1,1):b.splice(c,1):(f=D(e.text),k=D(g.text),g.range.accend===
e.range.acc&&d.test(f)&&d.test(k)&&(f=b[c-1]={type:"change",id:e.id,author:e.author,last_save_date:e.last_save_date,create_date:e.create_date},"add"===e.type?(f.range=e.range,f.text=e.text,f.oldtext=g.text):(f.range=g.range,f.text=g.text,f.oldtext=e.text),b.splice(c,1))))}}return b})}}};b.processSSRevisions=function(){var a=z.ssRevisions();this._ssmodel&&a&&!this.processedSSRevisions&&(this.processedSSRevisions=!0,this._ssmodel.processRevisions(a,function(){r(this,this._ssmodel.revisions())},this))};
b.positionAnnotations=function(){this._annotationPane&&x.showAnnotations&&this._annotationPane.layout()};b.annotationPane=function(){return this._annotationPane};return e}(),Kc=function(){function d(a){return"string"===typeof a&&0<a.length&&"none"!==a}var e,b=function(a,b){var c={index:{value:a},length:{get:function(){return this.firstPage?this.lastPage.index-this.firstPage.index+1:0}}};b.name&&(c.name={value:b.name});b.hidden&&(c.hidden={value:!0},F.hiddenContent("hidden-pages"));Object.defineProperties(this,
c);(c=V.getElementById(b.oid))?T.call(this,c):(c="oit-overlay",b.cls&&(c=-1==b.cls.indexOf(c)?c+(" "+b.cls):b.cls),T.call(this,"article",c,b.oid));w.viewNode.append(this);this.undisplay();this.hidden?this.hide():this.show()},a=W(b,T);a.updateCSS=function(){"text"!==x.selectionMode||ya.modalOverlayVisible()?this.addClass("oit-unselectable"):this.removeClass("oit-unselectable");"rect"===x.selectionMode?this.css("cursor","crosshair"):this.css("cursor",null)};a.item=function(a){if(this.firstPage)return z.page(this.firstPage.index+
a)};a.add=function(a){this.append(a);this.firstPage||(this.firstPage=a);this.lastPage=a;if(!this.maxWidth||a.width>this.maxWidth)this.maxWidth=a.width;if(!this.maxHeight||a.height>this.maxHeight)this.maxHeight=a.height;this._pagesHidden&&a.hide()};a.containsPage=function(a){return z.page(a).overlay==this};a.display=function(){if(this.layers){var a=G.activeOverlay()===this;ab(this.layers,"show",null,a)}a=this.css("display");e=d(a)&&e!==a?a:"block";this.css("display",e);this.updateCSS()};a.undisplay=
function(){this.layers&&ab(this.layers,"hide");this.css("display",null)};a.isDisplayed=function(){var a=this.css("display");return d(a)};a.show=function(){!1!==this._isHidden&&(this._isHidden=!1,z.on.overlayshow.dispatch(this))};a.hide=function(){!0!==this._isHidden&&(this._isHidden=!0,this.undisplay(),z.on.overlayhide.dispatch(this))};a.isHidden=function(){return void 0!==this._isHidden?this._isHidden:this.hidden};a.showPages=function(a){this.each("show",a);this._pagesHidden=!1};a.hidePages=function(a){this.each("hide",
a);this._pagesHidden=!0};a.hasAnnotations=function(a){void 0!==a&&(this._hasAnnotations=!!a);return!!this._hasAnnotations||!!F.revisions()};a.each=function(a,b){Ab(this,arguments)};a.layer=function(a){var b;this.layers&&(b=this.layers[a]);b||(b=new pd(w.drawing,a,this.id+"."+a),this.layers||(this.layers={}),this.layers[a]=b);return b};return b}(),Za=function(){var d=function(a,b){this.id=a;this.range=ea(b.range);this.type=b.type;b.style&&(this._style=b.style);b.cls&&(this._class=b.cls);b.comment&&
(this._comment=b.comment);b.label&&(this._label=b.label);b.properties&&(this._properties=b.properties);b.options&&this.setOptions(b.options);if(b.compound&&(this._compound=!0,Array.isArray(b.compound))){this._cRanges=[];for(var c=0;c<b.compound.length;c++){var d=ea(b.compound[c]);"rect"===d.type&&va(d,"px");this._cRanges.push(d)}}this._pageInfo=[];"rect"===this.range.type&&(void 0!==this.range.embedId?va(this.range,"pct"):va(this.range,"px"));this.range=wa(this.range,!0);P.map(this)},e=W(d);e.isNote=
function(){return!1};e.isRedaction=function(){return!1};e.isCompoundRedaction=function(){return!1};e.isEmptyRedaction=function(){return!1};e.setRange=function(a){return void 0!==a&&0!==Xa(a,this.range)?("cell"==this.range.type&&this.eachPage(function(a,b){B(b,z.page(a.index))},null,this),P.unmap(this),this.range=ea(a),P.map(this),delete this._cRanges,"text"==a.type&&this._compound&&(this._cRanges=[a]),this.updateStyle(),P.alignHighlight(),P.on.move.dispatch(this),!0):!1};e.updateStyle=function(){this._hidden||
this.eachPage(b,null,this)};var b=function(a,b){var c=a.index;b.removeFromPage(a);b.addToPage(c)};e.filter=function(a){if(a){if("string"===typeof a)return this[a]();if(a instanceof hb)return this.isOnPage(a.index);if(a instanceof Kc)return this.isInOverlay(a);if(!a(this.id,this._properties))return!1}return!0};e.properties=function(a){void 0!==a&&(this._properties=a);return this._properties};e.property=function(a,b){void 0!==b&&(this._properties||(this._properties={}),this._properties[a]=b);if(this._properties)return this._properties[a]};
e.style=function(a){a&&(this._style=a,this.updateStyle());return this._style};e.highlightStyle=function(){var a=this.style();this._active||"opacity"!==x.highlightActivationStyle||(a=this.highlightStyleProps(),a=cc(a));return a};e.highlightStyleProps=function(){var a=qb(this.style());if(!this._active&&a&&"opacity"===x.highlightActivationStyle){var b=a["background-color"];b&&(b=Fa(b))&&(b.a*=.4,a["background-color"]=La(b))}return a};e.intervalStyleProps=function(){var a=this.highlightStyleProps()["background-color"];
a&&(a=Fa(a));if(a)return a.a*=.25,a=La(a),{"background-color":a}};e.fillStyle=function(){if("text"!==this.range.type)return this._style};e.css=function(a){return rb(this._style,a)};e.matches=function(a,b,c,d,e){return this._style===a&&0===Xa(this.range,b)&&this._properties===c&&this._comment===d&&this._label===e};var a=function(a,b){b&&b.autodpi?va(a,"pct"):b&&"bitmap"===b.type?va(a,"px"):va(a,"tw")};e.serialize=function(){var b={type:this.type},c,d;b.range=ea(this.range);"rect"===b.range.type&&(void 0!==
b.range.embedId?va(b.range,"pct"):(c=z.page(b.range.page),a(b.range,c)));if(this.ttrects){var e=[],g;for(g in this.ttrects){var f=this.ttrects[g];if(f){c=z.page(g);for(var k=0;k<f.length;k++)d=f[k].toRange(c),a(d,c),e.push(d)}}b.ttrects=[].concat.apply([],e)}this._style&&(b.style=this._style);this._properties&&(b.properties=this._properties);"string"===typeof this._comment&&(b.comment=this._comment);this._label&&(b.label=this._label);this._options&&(b.options=this._options);if(this._cRanges)for(b.compound=
[],c=0;c<this._cRanges.length;c++)d=ea(this._cRanges[c]),"rect"===d.type&&(void 0!==d.embedId?va(d,"pct"):va(d,"tw")),b.compound.push(d);return b};e.destroy=function(){this.destroyDialog();this.eachPage(c,null,this);P.unlink(this);this.deleteAll()};var c=function(a,b){b.removeFromPage(a)};e.getOption=function(a){if("text"==this.range.type){if("enableUserMove"===a)return!1;if("enableUserResize"===a)for(var b in this._pageInfo){if(z.page(Number(b)).isSpreadsheet())return!1;break}}return(b=this._options)&&
void 0!==b[a]?b[a]:!0};e.setOptions=function(a){if(a&&(r(this,"enableUserDelete",a,!0),r(this,"enableUserComment",a,!0),r(this,"enableUserResize",a,!0),"text"!==this.range.type&&r(this,"enableUserMove",a,!0),this._options)){a=!1;for(var b in this._options)if(this._options.hasOwnProperty(b)){a=!0;break}a||delete this._options}};e.comment=function(a){void 0!==a&&(this._comment=null===a?void 0:String(a),this.updateComment(void 0,this._comment));return this._comment};e.dialog=function(a){var b=this._dialog;
b?(b.abortAnimation(),b.show(!0)):b=this._dialog=new vd(this);b.loadComment();b.setMode(a);b.align();return b};e.alignDialog=function(a){this._dialog&&this._dialog.align(a)};e.hideDialog=function(){var a=this._dialog;a&&a.show(!1,{endFn:a.close,context:a})};e.exitDialog=function(){this._dialog&&this._dialog.exit()};e.destroyDialog=function(){this._dialog&&this._dialog.destroy()};e.onDialogDestroy=function(a){a===this._dialog&&delete this._dialog};e.label=function(a){void 0!==a&&(this._label=null===
a||""===a?void 0:String(a),this.eachPage(f,null,this));return this._label};var f=function(a,b){b.applyLabel(a)};e.showLabel=function(a){this._label&&(!1===a?this._labelVisible=!1:delete this._labelVisible,this.eachPage(f,null,this))};e.isOnPage=function(a){return!!this._pageInfo[a]};e.isInOverlay=function(a){var b=a.lastPage.index;for(a=a.firstPage.index;a<=b;a++)if(this.isOnPage(a))return!0;return!1};var h=function(a,b){var c=a._pageInfo[b];c||(a._pageInfo[b]=c={index:b});return c};e.eachPage=function(a,
b){xc(this._pageInfo,arguments)};e.activate=function(a){this.inAnnotation()&&(x.showAnnotations=!0);this.addToDocument();this._hidden&&(this.show(),this._autohide=!0,G.update());this._active=!0;this.eachPage(t,null,this);this.positionAll()};var q=function(a,b){if("text"===b.range.type&&"opacity"===x.highlightActivationStyle){var c=z.page(a.index).spreadsheetModel();if(c&&!b.inAnnotation())c.updateHighlight(b);else{var d=1,c=-2;b._active&&(d=2,c=-1);var e=b.highlightStyleProps();a.spanList&&Tb(a.spanList,
b.id,e,d);a.compoundSpanList&&Y(a.compoundSpanList,function(a,b){Tb(a.spans,b,e,d)},null,b.id);if(a.intervalSpanList){var g=b.intervalStyleProps();g&&Y(a.intervalSpanList,Tb,null,b.id|1E9,g,c)}}}},t=function(a,b){var c=a.drawingRect;b.oldFocusPage=void 0;if("text"===b.range.type)"opacity"===x.highlightActivationStyle?q(a,b):c&&(c.addClass("oit-highlight-active"),c.setRange(b.range),b.getOption("enableUserResize")?c.ontextmove(b,u).ontextmoveend(b,p).showTextHandles():c.offtextmove(u).offtextmoveend(p).hideTextHandles(),
c.activate());else if(c){c.addClass("oit-highlight-active");var d="cell"!==b.range.type;b.updateMoveable(!0,c);b.updateResizable({bindToObject:d,minWidth:10,minHeight:10},c);c.activate()}a.embedRect&&a.embedRect.show()};e.updateMoveable=function(a,b,c){c=c||b;if(!1!==a&&this.getOption("enableUserMove"))b.addClass("oit-moveable").ondragstart(this,K,c).ondragmove(this,ba,c).ondragend(this,ia,c).ondragcancel(this,na,c);else b.removeClass("oit-moveable").offdragstart(K).offdragmove(ba).offdragend(ia).offdragcancel(na)};
e.updateResizable=function(a,b,c){c=c||b;if(a&&this.getOption("enableUserResize"))c.resizable(!0,a).onresizemove(this,A).onresizeend(this,U);else c.resizable(!1).offresizemove(A).offresizeend(U)};var u=function(a){var b=a.range;a=a.page;var c=z.pagesForRange(b);a!=this.oldFocusPage&&(this.oldFocusPage=a,this.eachPage(v,null,c,this));this._pageInfo[a.index]||this.addToPage(a.index,!0);this._cRanges&&(this._cRanges=[b]);O(this,a,this.highlightStyle(),b);this.alignDialog({animate:!1})},v=function(a,
b,c){a.spanList&&(a=a.index,fb(b,"index",a)||B(c,z.page(a)))},p=function(a){this.setRange(a.range)};e.deactivate=function(){this._active&&(delete this._active,this.eachPage(l,null,this),this._autohide&&(this.hide(),delete this._autohide,G.update()))};var l=function(a,b){var c=a.drawingRect;c&&c.removeClass("oit-highlight-active").deactivate();"text"===b.range.type?"opacity"===x.highlightActivationStyle&&q(a,b):c&&(b.updateMoveable(!1,c),b.updateResizable(!1,c));a.embedRect&&a.embedRect.hide()};e.show=
function(){if(void 0!==this._hidden){var a=this._hidden;delete this._hidden;if(0<a.length){for(var b=0;b<a.length;b++)this.addToPage(a[b]);P.link(this)}else this.addToDocument()}delete this._autohide};e.hide=function(){this._hidden||(this._hidden=[],this.eachPage(m,null,this),P.unlink(this))};var m=function(a,b){b._hidden.push(a.index);b.removeFromPage(a)};e.collapse=function(){};e.isHidden=function(){return!(!this._hidden&&!this._autohide)};var w=function(a,b){var c,d=a._pageInfo[b.index];if(d){if(!d.boundingRects)if(d.spanList||
d.compoundSpanList){var e;if(d.spanList)e=b.textRects(a.range,b,d.spanList);else{var g=[];for(c=0;c<d.compoundSpanList.length;c++)Array.prototype.push.apply(g,d.compoundSpanList[c].spans);for(c=0;c<a._cRanges.length;c++){var f=b.textRects(a._cRanges[c],b,g);e?Array.prototype.push.apply(e,f):e=f}}if(e)for(c=0;c<e.length;c++)for(g=e[c],f=0;f<g.length;f++){var k=g.item(f).clone();k.readonly(!0);d.boundingRects||(d.boundingRects=[]);d.boundingRects.push(k.clone())}}else if(b.isSpreadsheet()||"text"!==
a.range.type)"text"===a.range.type&&(c=b.textBoundingRect(a.range)),c||(c=G.rangeRect(a.range,b)),c&&(c=c.clone(),c.readonly(!0),d.boundingRects=[c]);return d.boundingRects}},I=function(a,b,c){var d;if(b){c=c||b;if("text"===a.range.type){var e=w(a,b);if(e){d=e[0].clone();for(var g=1;g<e.length;g++)d.union(e[g]);d.origin=c}}d||(d=G.rangeRect(a.range,c||b))}return d};e.boundingRectList=function(a){var b=[];this.eachPage(Q,null,a,b,this);if(0<b.length)return b};var Q=function(a,b,c,d){(a=I(d,z.page(a.index),
b))&&c.push(a)};e.addToDocument=function(a){if(!this._hidden){var b=z.pagesForRange(this.range);if(b){for(var c=0;c<b.length;c++)this.addToPage(b[c].index,!1,a);!1!==a&&P.link(this)}}};var J=function(a){a.highlightLayer||(N(a),a.highlightLayer=a.layer("highlights"));return a.highlightLayer},N=function(a){a.compoundHighlightLayer||(a.compoundHighlightLayer=a.layer("chighlights"));return a.compoundHighlightLayer};e.addToPage=function(a,b,c){var d=z.page(a),e=this._pageInfo[a];e&&b&&(this.removeFromPage(e),
e=null);if(!this._hidden&&(!e||e.needRect||e.needApply)&&d&&d.isLoaded()&&!d.isHidden()&&(b||d.containsRange(this.range))){var g;delete this._inComment;d.pushShow();e&&e.needApply||(e=O(this,d,this.highlightStyle(),this.range));e&&delete e.boundingRects;if(P.batchMode())e&&(e.needApply=!0);else{b="text"!==this.range.type||"opacity"!==x.highlightActivationStyle;var f=!1;b&&(g=I(this,d,"overlay"),g||(e&&(e.needRect=!0),f=!0));if(!f){e?(delete e.needRect,delete e.needApply):e=h(this,a);void 0===this.range.embedId||
e.embedRect||(e.embedRect=new Hb(a,J(d)),e.embedRect.addClass("oit-highlight-embed"),e.embedRect.hide());if(b&&!e.drawingRect&&(e.drawingRect=this.createDrawingRect(d.index,J(d)),e.drawingRect&&(P.on.addElement(e.drawingRect,this),d.inAnnotation(this.range))))e.drawingRect.onwheel(this,function(a){var b=d.annotationPane();if(b)return b.scrollPane().redirectEvent(a)});(b=this.fillStyle())?(e.styleDiv||(e.styleDiv=y.create("div","oit-highlight-style"),e.drawingRect&&e.drawingRect.append(e.styleDiv)),
e.styleDiv.attr("style",b)):e.styleDiv&&(e.styleDiv.destroy(),delete e.styleDiv);this._label&&this.applyLabel(e);D(this._pageInfo[a],this,g);this.updateComment(e,this._comment)}}!1!==c&&P.link(this);G.update(!1,!0);d.popShow()}};e.removeFromPage=function(a){"number"==typeof a&&(a=this._pageInfo[a]);if(a){var b=a.index;B(this,z.page(b));a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag);a.drawingRect&&(P.on.removeElement(a.drawingRect,this),a.drawingRect.destroy());a.embedRect&&a.embedRect.destroy();
this._pageInfo[b]=null;G.update(!1,!0)}};e.createDrawingRect=function(a,b){var c;"text"===this.range.type?"opacity"!==x.highlightActivationStyle&&(c=new od(a,b),c.setRange(this.range)):c=new Hb(a,b);return c};e.distanceFromPoint=function(a,b,c,d){var e;a=z.page(a);if(a=w(this,a))for(var g=0;g<a.length;g++){var f=a[g];if(!(f.origin instanceof hb)==d&&(f=f.distanceFrom(b,c,"nearest","nearest","xy"),void 0===e||f.ay<e.ay||f.ay==e.ay&&f.ax<e.ax)&&(e=f,0===e.x&&0===e.y))break}return e};var D=function(a,
b,c){var d;if(a){d=a.index;var e=z.page(d);if(e.isHidden()||!e.isEnabled()){a.drawingRect&&a.drawingRect.hide();a.embedRect&&a.embedRect.hide();if(a.cRects)for(d=0;d<a.cRects.length;d++)a.cRects[d].rect.hide();a.needRect=!0}else if("text"===b.range.type)a.drawingRect&&a.drawingRect.show().changed();else if(c||(c=I(b,e,"overlay")),c){a.drawingRect&&a.drawingRect.show().move(c.left,c.top,c.width,c.height);a.embedRect&&(c=z.page(d).embeddingRect(b.range.embedId))&&(c.origin="overlay",a.embedRect.show().move(c.left,
c.top,c.width,c.height));if(a.cRects)for(d=0;d<a.cRects.length;d++)e=a.cRects[d],(c=G.rangeRect(e.range,"overlay"))&&e.rect.show().move(c.left,c.top,c.width,c.height);b.updateComment(a,b._comment)}}};e.positionAll=function(){this.eachPage(D,null,this)};e.generateKey=function(){var a,b=z.pagesForRange(this.range);if(b&&void 0===this.prevId&&void 0===this.nextId)for(var c=0;c<b.length;c++){var d=b[c];this.key&&this.key.page!=d.index&&delete this.key;this.key||(this.key={page:d.index,x:0,y:0});if(this.inAnnotation())this.key.x=
this.range.acc,this.key.y=9999999;else if(d.isEmailHeader()&&"text"===this.range.type)this.key.x=this.range.acc,this.key.y=0;else if(d.spreadsheetModel()){var e;"cell"===this.range.type?(e=this.range,this.key.x=0,this.key.y=e.r1*d.spreadsheetModel().colCount()+e.c1):"text"===this.range.type?(this.key.x=this.range.acc,this.key.y=-1):delete this.key}else if(d.isLoaded()){e=void 0;if(d&&(d=w(this,d))){e=d[0].left;for(var g=d[0].top,f=1;f<d.length;f++){var k=d[f];if(k.top<g||k.top==g&&k.left<e)e=k.left,
g=k.top}e={left:e,top:g}}(d=e)?(this.key.x=d.left,this.key.y=d.top):delete this.key}else this.key.x=this.range.acc,this.key.y=-1;if(this.key){a=this.key;break}}else delete this.key;return a};e.inAnnotation=function(){void 0===this._inComment&&(this._inComment=z.inAnnotation(this.range));return this._inComment};e.applyLabel=function(a){if(a&&a.drawingRect)if(this._label&&!1!==this._labelVisible){var b=this.css("background-color"),c;a:{if(b&&(c=Fa(b))){c.r=255-c.r;c.g=255-c.g;c.b=255-c.b;c=La(c.r,c.g,
c.b);break a}c=void 0}c||(b=null);a.drawingRect.setLabel(this._label,c,b)}else a.drawingRect.setLabel(null)};var O=function(a,b,c,d){var e=null,g=0,f,k,r,n,l,m;a._active?g=2:"opacity"===x.highlightActivationStyle&&(g=1);var C=S.saveSelection();C&&C.range&&"text"===C.range.type&&b.isSpreadsheet()&&(S.select(null),C=null);B(a,b);if(a._compound){if(a._cRanges||(a._cRanges=z.decomposeRange(d,!0)),a._cRanges){(n=b.spreadsheetModel())&&n.addHighlight(a)&&(e||(e=h(a,b.index)));var A="rect"===d.type,p;for(n=
0;n<a._cRanges.length;n++){l=a._cRanges[n];if("text"===l.type){if(r||(r=qb(c)),r&&(k=ub(b,l,r,a.id,void 0,g))){e||(e=h(a,b.index));e.compoundSpanList||(e.compoundSpanList=[]);for(var v=0;v<k.length;v++)if(f=k[v].split(l))for(m=0;m<f.length;m++)P.on.addElement(f[m],a);e.compoundSpanList.push({spans:k,range:l})}}else if(k=G.rangeRect(l,"overlay"))f=new Hb(b.index,N(b)),c&&(m=y.create("div","oit-highlight-style"),m.attr("style",c),f.append(m)),f.move(k.left,k.top,k.width,k.height),e||(e=h(a,b.index)),
e.cRects||(e.cRects=[]),e.cRects.push({range:l,rect:f});A&&(l="text"===d.type?b.textBoundingRect(l):G.rangeRect(l,b))&&(p?p.union(l):p=l)}if(x.highlightTermIntervals&&"text"===a.range.type&&1<a._cRanges.length&&(g=-2,a._active&&(g=-1),d=a.intervalStyleProps())){c=[];k=a.acc;for(n=0;n<a._cRanges.length;n++)l=a._cRanges[n],l.acc>k&&c.push(pa(k,l.acc)),k=l.accend;for(n=0;n<c.length;n++)if(l=c[n],k=ub(b,l,d,a.id|1E9,void 0,g))e||(e=h(a,b.index)),e.intervalSpanList||(e.intervalSpanList=[]),e.intervalSpanList.push(k)}p&&
(b=G.rangeFromRect(b.index,p.left,p.top,p.right,p.bottom,b,"highlight"))&&(a.range=b)}}else if("text"===d.type&&((n=b.spreadsheetModel())&&n.addHighlight(a)&&(e=h(a,b.index)),r=qb(c))&&(k=ub(b,d,r,a.id))){e||(e=h(a,b.index));e.spanList=k;for(n=0;n<k.length;n++)if(f=k[n].split(d))for(m=0;m<f.length;m++)P.on.addElement(f[m],a);if((n=ha.infoRaw())&&1557===n.fi)for(a.ttrects||(a.ttrects=[]),a=a.ttrects[b.index]=[],n=0;n<k.length;n++)k[n].hasClass("oit-tt")&&(b=k[n].textRect(d))&&a.push(b)}C&&S.restoreSelection(C);
return e},B=function(a,b){var c,d=a._pageInfo[b.index];if(d){var e=S.saveSelection();e&&e.range&&"text"===e.range.type&&b.isSpreadsheet()&&(S.select(null),e=null);var g=b.spreadsheetModel();g&&("text"===a.range.type||a._compound)&&g.removeHighlight(a);if(d.spanList){for(c=0;c<d.spanList.length;c++)if(g=d.spanList[c].split(a.range))for(var f=0;f<g.length;f++)P.on.removeElement(g[f],a);Sb(d.spanList,a.id);delete d.spanList;b.pageLayoutChanged()}d.compoundSpanList&&(Y(d.compoundSpanList,function(b,d){var e=
b.range,g=b.spans;for(c=0;c<g.length;c++){var f=g[c].split(e);if(f)for(var k=0;k<f.length;k++)P.on.removeElement(f[k],a)}Sb(g,d)},null,a.id),delete d.compoundSpanList,b.pageLayoutChanged());d.intervalSpanList&&(Y(d.intervalSpanList,Sb,null,a.id|1E9),delete d.intervalSpanList,b.pageLayoutChanged());if(d.cRects){for(c=0;c<d.cRects.length;c++)if(g=d.cRects[c].rect)P.on.removeElement(g,a),g.destroy();delete d.cRects}e&&S.restoreSelection(e)}},r=function(a,b,c,d){var e=!1;c=c[b];void 0!==c&&(c==d?(d=a._options)&&
void 0!==d[b]&&(delete d[b],e=!0,a.optionChanged(b)):(a._options||(a._options={}),a._options[b]=!!c,e=!0,a.optionChanged(b)));return e};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.id===P.active()&&this.activate(!0)}};var g=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?a.drawingRect&&(b?(a.commentFlag||(a.drawingRect.onmouseenter(this,k).onmouseleave(this,C),a.commentFlag||(a.commentFlag=new Ca(a.drawingRect,{hpos:"right",vpos:"top",
margin:2,classList:"oit-comment-flag"}))),a.commentFlag.show()):a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag)):this.eachPage(g,null,b,this)};var k=function(a){this.id!=P.active()&&P.showComment(this.id)},C=function(a){this.id!=P.active()&&P.hideComment(this.id)},K=function(a,b){if(this.getOption("enableUserMove")){var c=b.position();this._moveable={startRect:c.clone(),curRect:c.clone()};return!1}return!0},ba=function(a,b){if(this._moveable){var c=this.range,d,e=this._moveable.startRect;
d=this._moveable.curRect;var g=a.delta;d.left=e.left+g.x;d.top=e.top+g.y;"cell"!==c.type||c.offsets?d=G.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId):(this.moveOriginalRect||(this.moveOriginalRect=G.rangeRect(c,d.origin)),e=this.moveOriginalRect.clone(),e.left=d.left,e.top=d.top,d=G.rangeFromRect(c.page,e.left,e.top,e.right,e.bottom,e.origin,"move",c.embedId),e=c.c2-c.c1,g=c.r2-c.r1,d.c2-d.c1<e&&(d.c2=d.c1+e),d.r2-d.r1<g&&(d.r2=d.r1+g),delete d.offsets);0!==Xa(d,c)&&
(d=G.rangeRect(d,"overlay"),b.move(d.left,d.top,d.width,d.height),this._active&&this._comment&&this._dialog&&this._dialog.align({rect:d,animate:!1}))}return!1},ia=function(a,b){if(this._moveable){var c=this.range,d=this._moveable.curRect,d=G.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId);if("cell"===d.type&&!c.offsets){delete this.moveOriginalRect;var e=c.c2-c.c1,c=c.r2-c.r1;d.c2-d.c1<e&&(d.c2=d.c1+e);d.r2-d.r1<c&&(d.r2=d.r1+c);delete d.offsets}this.setRange(d);delete this._moveable}return!1},
na=function(a,b){if(this._moveable){var c=a.center;P.activateNearest(c.x,c.y,a.srcEvent);delete this._moveable}return!1},A=function(a){var b=this.range,c=a.drawingRect;a=a.newRect;var d=G.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==d.type||b.offsets||delete d.offsets;if(d=wa(d,!0))b=G.rangeRect(d,"overlay"),"rect"===d.type&&(a=b),c.move(b.left,b.top,b.width,b.height);this._active&&this._comment&&this._dialog&&this._dialog.align({rect:a,animate:!1})},U=
function(a){var b=this.range;a=a.newRect;a=G.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==a.type||b.offsets||delete a.offsets;a=wa(a,!0);this.setRange(a)};return d}(),fd=function(){var d=function(b,a){Za.call(this,b,a)},e=W(d,Za);e.isRedaction=function(){return!0};e.isCompoundRedaction=function(){return!0===this._compound};e.isEmptyRedaction=function(){return!0===this._compound&&!this._cRanges};e.style=function(b){b=x.redactionColor;return"color:"+b+";background-color:"+
b+";"};e.fillStyle=function(){if("text"!==this.range.type){var b;if(b=!this._compound||"rect"!==this.range.type&&"cell"!==this.range.type?x.redactionColor:x.redactionFillColor)return"background-color:"+b+";"}};e.css=function(b){if("color"===b||"background-color"===b)return x.redactionColor};return d}(),gd=function(){var d=function(a,b){Za.call(this,a,b);this._newNote=!0;this._state="oit-note-pinned";this._pinned=!0;this._hidden=this._hover=this._active=this._editing=!1},e=W(d,Za);e.isNote=function(){return!0};
e.isEditing=function(){return this._editing};e.isHidden=function(){return this._hidden};e.removeFromPage=function(a){this.endEditText(!1);Za.prototype.removeFromPage.call(this,a)};e.activate=function(a){if(!this._active||a)this._active=!0,this.updateState(a)};e.deactivate=function(){this._active&&(this._active=!1,this.updateState())};e.show=function(){this._hidden&&(this._hidden=!1,this.updateState())};e.hide=function(){this._hidden||(this._hidden=!0,this.updateState())};e.pin=function(){this._pinned||
(this._pinned=!0,this.updateState())};e.unpin=function(){this._pinned&&(this.endEditText(!0),P.active()==this.id&&P.deactivate(),this._pinned=!1,this.updateState())};e.beginEditText=function(a){void 0!==a&&(this._newNote=a);this._editing||(this._editing=!0,w.editingComment++,this.updateState())};e.endEditText=function(a){this._editing&&(!1===a&&(this.buttons.textArea.value=P.comment(this.id)),this._editing=!1,w.editingComment--,this.updateState(),this._newNote&&(a?delete this._newNote:P.remove(this.id)))};
e.ok=function(){this.endEditText(!0);return!1};e.cancel=function(){this.endEditText(!1);return!1};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.updateState(!0)}};var b=function(){this.addClass("oit-note-expanding")},a=function(){this.removeClass("oit-note-expanding")},c=function(){this.addClass("oit-note-collapsing")},f=function(){this.removeClass("oit-note-collapsing")};e.updateState=function(d){var e;e=this._editing?"oit-note-editing":this._active?this._pinned?
"oit-note-active":"oit-note-shown":this._hidden?"oit-note-hidden":this._pinned?"oit-note-pinned":this._hover?"oit-note-hover":"oit-note-iconic";var h=this.noteRect;if(h){if(e!=this._state||d){var l=this._state;this._state=e;h.removeClass(l).addClass(e);switch(l){case "oit-note-editing":P.comment(this.id,this.buttons.textArea.value);ya.showModalOverlay(!1);this.buttons.iconBar.focus();h.layer().removeClass("oit-note-layer-edit");h.removeClass("oit-highlight-active").deactivate();break;case "oit-note-hidden":h.show();
break;case "oit-note-iconic":"oit-note-hidden"!==e&&(d=this.originalRect,h.move(d.left,d.top,d.width,d.height,{timems:200,startFn:b,endFn:a}));break;case "oit-note-active":h.removeClass("oit-highlight-active").deactivate();case "oit-note-pinned":"oit-note-active"!==e&&"oit-note-pinned"!==e&&(this.updateMoveable(!1,this.buttons.iconBar,h),this.updateResizable(!1,h))}this.positionAll();switch(e){case "oit-note-hidden":h.hide();break;case "oit-note-iconic":this.originalRect=h.position().clone();d=this.collapsedRect=
{left:this.originalRect.right-20,top:this.originalRect.top,width:20,height:20};"oit-note-hidden"===l?h.move(d.left,d.top,d.width,d.height):h.move(d.left,d.top,d.width,d.height,{timems:200,startFn:c,endFn:f});break;case "oit-note-editing":h.layer().addClass("oit-note-layer-edit");h.addClass("oit-highlight-active").activate(!1,!0);P.activate(this.id);ya.showModalOverlay(!0);e=this.buttons.textArea;e.blur();e.focus();this._newNote&&e.moveCaret(e.value.length||0);break;case "oit-note-active":h.addClass("oit-highlight-active").activate(!1,
!0);case "oit-note-pinned":this.updateMoveable(!0,this.buttons.iconBar,h),this.updateResizable({bindToObject:"cell"!==this.range.type,minWidth:60,minHeight:45,margin:-5},h)}}h.update()}};e.createDrawingRect=function(a,b){var c=new Hb(a,b),d={};this.noteRect=c;this.buttons=d;c.addClass("oit-note").addClass("oit-note-pinned");d.iconBar=new Ca(c,{classList:"oit-note-icons",inheritMoveable:!0});d.iconBar.attr("tabindex","-1");d.cancel=new Ca(d.iconBar,{classList:"oit-note-cancel",title:M.DISCARD_CHANGES});
d.cancel.onclick(this,this.cancel).ontap(this,this.cancel);d.ok=new Ca(d.iconBar,{classList:"oit-note-ok",title:M.SAVE_CHANGES});d.ok.onclick(this,this.ok).ontap(this,this.ok);d.pin=new Ca(c,{classList:"oit-note-pin"});d.pin.onmouseenter(this,h).onmouseleave(this,q).onclick(this,t).ontap(this,t);d.textArea=new qc;d.textArea.onfocus(this,v).ontap(this,u);d.textForm=y.create("form");d.textForm.append(d.textArea);c.append(d.textForm);this.updateState(!0);return c};var h=function(a){this._hover=!0;this.updateState()},
q=function(a){this._hover=!1;this.updateState()},t=function(a){this._pinned?this.unpin():this.pin();return!1},u=function(a){this.buttons.textArea.blur();this.buttons.textArea.focus()},v=function(a){this.getOption("enableUserComment")?this.beginEditText():this.buttons.textArea.blur()},p=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?this._hidden||this._editing||!this.buttons||(this.buttons.textArea.value=b||""):this.eachPage(p,null,b,this)};return d}(),hd=function(){var d=function(d,
b){Za.call(this,d,b);b.name&&(this._name=b.name);b.sizing&&(this._sizing=b.sizing);b.opacity&&(this._opacity=b.opacity);if(!this._style){var a="background:url("+P.stamp(this._name).url+") no-repeat";1!=this._opacity&&(a+=";opacity:"+this._opacity);"scale"===this._sizing?a+=";background-size:contain":"stretch"===this._sizing&&(a+=";background-size:100% 100%");this._style=a}};W(d,Za).serialize=function(){var d=Za.prototype.serialize.call(this);d.stamp=this._name;d.opacity=this._opacity;d.sizing=this._sizing;
delete d.style;return d};return d}(),vd=function(){var d=200,e=150,b=function(a){var b="#000",d=a.css("background-color");d&&(d=dc(d,"#FFFFFF"));if(d){var e=Fa(d);128>e.r&&128>e.g&&128>e.b&&(b="#FFF")}Oc.call(this,{ok:!0,cancel:!0,className:"oit-dialog-comment",resultFn:c,destroyFn:f,textColor:b,backgroundColor:d});this._highlight=a},a=W(b,Oc),c=function(a,b){"view"!==a._mode&&(d=a.width(),e=a.height(),"new"!==a._mode||b&&a._textarea.value?(b&&a.saveComment(),P.active()===a._highlight.id?a.setMode("view"):
a._highlight.exitDialog()):(P.remove(a._highlight.id),S.select(null)))},f=function(a){a.setMode(null);a._highlight.onDialogDestroy(a)};a.setMode=function(a){if(a!==this._mode){if("edit"===this._mode||"new"===this._mode)w.editingComment--,this.removeClass("oit-comment-edit");this._mode=a;switch(a){case "view":this._highlight.comment()?(this._textarea&&(this._textarea.destroy(),delete this._textarea),this._label||(this._label=this.addLabel(null),this._label.onclick(this,h).ontap(this,h).onmouseenter(this,
q).onmouseleave(this,t)),this.resizable(!1),this.modal(!1),this.showFooter(!1),this.maxsize(d,e),this._mode=a,this.loadComment(),this.align(),this.show()):this._highlight.exitDialog();break;case "edit":case "new":w.editingComment++,this.addClass("oit-comment-edit"),this.modal(!0),this.align({endFn:u,context:this})}}};var h=function(){this._highlight.getOption("enableUserComment")&&this.setMode("edit")},q=function(){P.showComment(this._highlight.id)},t=function(){var a=this._highlight.id,b=P.active();
a!=b&&(P.hideComment(a),void 0!==b&&P.showComment(b))},u=function(){this.show(!0,{endFn:v,context:this})},v=function(){this._label&&(this._label.destroy(),delete this._label);this._textarea||(this.resetForm(),this._textarea=this.addTextArea(null),this._textarea.onfocus(this,p));this.loadComment();this.resizable(!0,180,100);this.showFooter(!0);this.maxsize(0,0);this._textarea&&this._textarea.focus&&this._textarea.focus()},p=function(){var a=this._textarea;a&&("number"==typeof a.selectionStart?a.selectionStart=
a.selectionEnd=a.value.length:"undefined"!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select()))};a.loadComment=function(){var a=this._highlight.comment()||"";this._textarea?this._textarea.value=a:this._label&&this._label.text(a)};a.saveComment=function(){this._textarea&&P.comment(this._highlight.id,this._textarea.value,!0)};a.align=function(a){var b;a:{var c=a?a.rect:null;if(this){var f=this._highlight,h=f.isNote(),l,p,v;if(c)"view"!==c.origin&&(c=c.clone(),c.origin=
"view"),h?(b=c.left,l=c.top,p=c.right-c.left,v=c.bottom-c.top):(b=c.right+10,l=c.top);else if(c=f.boundingRectList("view"))for(f=0;f<c.length;f++){var q=c[f];h?(b=q.left,l=q.top,p=q.right-q.left,v=q.bottom-q.top):(b=q.right+10,l=q.top);0>l&&0<=q.bottom&&(l=0);if(0<=b&&0<=l)break}if(void 0!=b){10>b&&(b=10);10>l&&(l=10);h=w.viewNode.pos();b+=h.left;l+=h.top;if(p&&v){b={left:b,top:l,width:p,height:v};break a}b={left:b,top:l};break a}}b=void 0}b&&(l=b.width||d,p=b.height||e,"view"===this._mode?this.autoSize(b.left,
b.top,l,p,a):this.move(b.left,b.top,l,p,a))};return b}(),Rb=function(){var d=function(a,b,c,d,e){this.prop("id",a);this._edge=b;this._visible=!1;this._autoSize=!0;this._resizable=this._overlay=!1;this._height=this._width=void 0;switch(this._edge){case "top":this._dimension="height";this._border="borderBottom";this._direction=1;break;case "bottom":this._dimension="height";this._border="borderTop";this._direction=-1;break;case "left":this._dimension="width";this._border="borderRight";this._direction=
1;break;case "right":this._dimension="width",this._border="borderLeft",this._direction=-1}this._frame=y.create("div","oit-toolframe");this._toolbar=y.create("div","oit-toolbar oit-toolbar-"+this._edge);this._toolsParent=y.create("div","oit-toolbar-tool");this._toolsElem=c;this._content=y.create("div","oit-toolcontent");this._toolbar.append(this._toolsParent);this._toolsParent.append(this._toolsElem);this._frame.append(this._toolbar,this._content);d&&(y.unwrap(this._toolbar).style[this._border]=d);
a=e?e._content:w.rootNode;this._content.transferFrom(a);a.append(this._frame)},e=W(d);e.filter=function(a){return a===this.id};e.refresh=function(){this.applySize()};e.isInternal=function(){return 0>this.id};var b=function(a){this._startSize=this.size();return!1},a=function(a){var b=this._startSize;switch(this._edge){case "top":b+=a.delta.y;break;case "bottom":b-=a.delta.y;break;case "left":b+=a.delta.x;break;case "right":b-=a.delta.x}this.setSize(b);return!1},c=function(a){delete this._startSize;
return!1};e.overlay=function(a){"boolean"===typeof a&&((this._overlay=a)?this._toolbar.addClass("oit-toolbar-overlay"):this._toolbar.removeClass("oit-toolbar-overlay"),this._visible&&(this.hide(),this.show()));return this._overlay};e.resizable=function(d,e,q,t){"boolean"===typeof d&&((this._resizable=d)?("number"==typeof e&&"number"==typeof q&&"string"==typeof t&&(this._collapseSize=e,this._minSize=q,this._collapseHeader=y.create("div","oit-toolcollapse"),this._collapseHeader.html(t),this._toolbar.append(this._collapseHeader)),
this._toolbar.addClass("oit-toolbar-resizable"),this._resizeHandle||(this._resizeHandle=y.create("div","oit-toolresize"),this._resizeHandle.html("<div></div>"),this._resizeHandle.ondragstart(this,b),this._resizeHandle.ondragmove(this,a),this._resizeHandle.ondragend(this,c),this._resizeHandle.ondragcancel(this,c),this._resizeHandle.kinetic(!1),this._toolbar.append(this._resizeHandle))):(this._collapseHeader&&this._collapseHeader.destroy(),delete this._collapseSize,delete this._minSize,delete this._collapseHeader,
this._toolbar.removeClass("oit-toolbar-resizable"),this._resizeHandle&&(this._resizeHandle.destroy(),delete this._resizeHandle)),this._visible&&(this.hide(),this.show()));return this._resizable};e.remove=function(){var a=this._frame.parent();a&&(a.transferFrom(this._content),this._frame.destroy());this.isInternal()||za.on.remove.dispatch(this.id,this._edge)};e.isVisible=function(){return this._visible};e.show=function(a){var b=this._toolbar;a=a||{};if(!this._visible){this._autoSize=this._visible=
!0;this._toolbar.css("display","block");if(void 0===this._borderSize&&(this._borderSize=0,y.unwrap(this._toolbar).style[this._border])){var c=this._toolbar.computedStyle();c&&(this._borderSize=parseInt(c[this._border+"Width"],10))}this.applySize(a.size,!0);this.isInternal()||za.on.show.dispatch(this.id,this._edge,b.offsetWidth,b.offsetHeight)}this.dispatchSize(a.refresh)};e.hide=function(){this._visible&&(this._visible=!1,this._toolbar.css("display",null),this.applySize(),this.isInternal()||za.on.hide.dispatch(this.id,
this._edge))};e.size=function(){return"width"===this._dimension?this._toolbar.innerWidth:this._toolbar.innerHeight};e.setSize=function(a){if("auto"===a)this._toolbar.css(this._dimension,null),this._autoSize=!0,this.applySize();else{this._visible&&void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._toolbar.css(this._dimension,a);this._autoSize=!1;switch(this._edge){case "top":case "bottom":this._resizeHandle&&(a-=this._resizeHandle.offsetHeight);break;case "left":case "right":this._resizeHandle&&
(a-=this._resizeHandle.offsetWidth)}this.applySize(a)}};e.applySize=function(a,b,c){if(void 0!==a||void 0===this._startSize){var d=this._toolbar,e=this._content,f=this._toolsElem,h=this._frame;if(this._visible){this._autoSize&&d.removeCSS(["bottom","top","right","left",this._dimension]);if(void 0===a){switch(this._edge){case "top":case "bottom":this._autoSize?this._size=f.offsetHeight:(this._size=d.offsetHeight,this._resizeHandle&&(this._size-=this._resizeHandle.offsetHeight));break;case "left":case "right":this._autoSize?
this._size=f.offsetWidth:(this._size=d.offsetWidth,this._resizeHandle&&(this._size-=this._resizeHandle.offsetWidth))}a=this._size}void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._collapseSize&&(a<this._collapseSize?this._collapsed||(this._collapseHeader.css("display","block"),this._toolsParent.css("display","none"),this._collapsed=!0):this._collapsed&&(this._collapseHeader.css("display",null),this._toolsParent.css("display",null),this._collapsed=!1));void 0!==this._borderSize&&(a+=
this._borderSize);var f=h.clientWidth,h=h.clientHeight,l=w.rootNode.clientWidth-10,m=w.rootNode.clientHeight-10;switch(this._edge){case "top":this._visible&&this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>m&&(a=m));d.css("bottom",h-a+"px");this._overlay||e.css("top",a+"px");break;case "bottom":this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>m&&(a=m));d.css("top",h-a+"px");this._overlay||e.css("bottom",a+"px");break;case "left":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,
a>l&&(a=l));d.css("right",f-a+"px");this._overlay||e.css("left",a+"px");break;case "right":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,a>l&&(a=l)),d.css("left",f-a+"px"),this._overlay||e.css("right",a+"px")}}else if(!this._overlay)switch(this._edge){case "top":e.css("top",0);break;case "bottom":e.css("bottom",0);break;case "left":e.css("left",0);break;case "right":e.css("right",0)}!0!==b&&this.dispatchSize(c)}};e.dispatchSize=function(a){var b=0,c=0;this._visible&&(this._collapsed?(b=this._collapseHeader.clientWidth,
c=this._collapseHeader.clientHeight):(b=this._toolsParent.clientWidth,c=this._toolsParent.clientHeight));if(a||b!=this._width||c!=this._height)this._width=b,this._height=c,ha.dispatchResize(),this.isInternal()?za.on.resizeinternal.dispatch(this.id,this._edge,b,c,this._collapsed):za.on.resize.dispatch(this.id,this._edge,b,c)};return d}(),cd=function(){return function(){var d,e,b,a,c,f=[],h,q,t,u;this.show=function(){d&&d.show()};this.hide=function(){d&&d.hide()};this.length=function(){return f.length};
this.addPrevNext=function(d,f){if(!a){a=new bc("\u25c4",M.PAGE_UP);d&&(a.onclick(d),a.ontap(d));c=new bc("\u25ba",M.PAGE_DOWN);f&&(c.onclick(f),c.ontap(f));var h=y.create("div","oit-tab-nextprev");h.append(a,c);e.append(h);(h=h.size())&&h.width&&b.css("right",h.width+"px")}};this.addTab=function(a,c,d,e){var h=y.create("div","oit-tab");h.html("<div>"+a+"</div>");c&&h.addClass("oit-hidden");b.append(h);f.push(h);if(d instanceof Function)h.on("click",null,v,d,e).on("tap",null,v,d,e);return f.length-
1};var v=function(a,b,c){b(c)};this.showTab=function(a){0<=a&&a<f.length&&(f[a].css("display",null),p())};this.hideTab=function(a){0<=a&&a<f.length&&(f[a].css("display","none"),p())};this.tabClass=function(a,b){if(0<=a&&a<f.length){if(f[a].customClass){if(f[a].customClass===b)return;f[a].removeClass(f[a].customClass);delete f[a].customClass}b&&(f[a].addClass(b),f[a].customClass=b)}};this.setActiveTab=function(a){if(0<=a&&a<f.length&&a!=h&&(void 0!=h&&f[h].removeClass("oit-tab-selected"),h=a,f[h].addClass("oit-tab-selected"),
p(),void 0!==h)){a=f[h].rect(e);var c=b.rect(e),d=c.left;a.right>c.right?d-=a.right-c.right:0>a.left&&(d-=a.left);0<=d?b.css("left",null):b.css("left",d+"px")}};this.tabRect=function(a){if(0<=a&&a<f.length){a=f[h].rect(w.rootNode);a=new la(a,"view");var b=w.viewNode.rect(w.rootNode);a.offset(-b.left,-b.top);return a}};this.destroy=function(){d&&za.removeInternal(-2);e&&e.destroy();f=c=a=b=e=d=null};var p=function(){if(a){for(var b,d,e=0;e<f.length;e++)"none"!==f[e].css("display")&&(d=e,void 0===b&&
(b=e));a.disabled=h<=b;c.disabled=h>=d}};e=y.create("div","oit-tab-bar");b=y.create("div","oit-tab-list");e.append(b);b.kinetic(!0);b.ondragstart(function(a){a=b.rect(e);q=a.left;t=a.right;u=f[f.length-1].rect(e).right;return!1});b.ondragmove(function(a){var c=a.delta.x;a=q+c;0>a&&(c=u+c,c<t&&(a+=t-c));0<a&&(a=0);b.css("left",a+"px");return!1});d=new Rb(-2,"bottom",e,null,za.internalParent(-2));za.addInternal(-2,d);d.show()}}(),wd=function(){return function(){var d,e,b;this.show=function(){d&&d.show()};
this.hide=function(){d&&d.hide()};this.enable=function(){b.attr("disabled",null)};this.disable=function(){b.attr("disabled","disabled")};this.setText=function(a){a?b.attr("value",a):b.attr("value","")};this.destroy=function(){d&&za.removeInternal(-4);e&&e.destroy();b=e=d=null};e=y.create("div","oit-formula-bar");var a=y.create("div","oit-formula-padding");b=y.create("input","oit-formula-text");b.attr("type","text");b.attr("readonly","readonly");a.append(b);e.append(a);d=new Rb(-4,"top",e,null,za.internalParent(-4));
za.addInternal(-4,d);d.show()}}(),Da=function(){var d=function(a,b,d){this._size=b;this._hidden=!1;a?(this._hidden=!0===a.hidden,void 0!==a.h?this._size=a.h:void 0!==a.w&&(this._size=a.w),this._title=void 0!==a.t?a.t:d,void 0!==a.st&&(this._styleIndex=a.st),this._acc=a.acc,this._accend=a.accend):this._title=d;this._originalHidden=this._hidden;this._originalSize=this._size},e=W(d);e.acc=function(){return this._acc};e.accend=function(){return this._accend};e.clone=function(){var a=new d(null,this._size,
this._title);a._size=this._size;a._originalSize=this._originalSize;a._hidden=this._hidden;a._originalHidden=this._originalHidden;a._title=this._title;void 0!==this._styleIndex&&(a._styleIndex=this._styleIndex);void 0!==this._acc&&(a._acc=this._acc);void 0!==this._accend&&(a._accend=this._accend);void 0!==this._revisions&&(a._revisions=this._revisions);void 0!==this._deleted&&(a._deleted=this._deleted);this._data&&(a._data=this._data.slice(0));a.clonedFrom=this;return a};e.title=function(){return this._title};
e.style=function(){return this._styleIndex};e.revision=function(a){void 0!==a&&(this._revisions||(this._revisions=[],this.clonedFrom&&(this.clonedFrom._revisions=this._revisions)),this._revisions.push(a),"delete_col"===a.type||"delete_row"===a.type)&&(this._deleted=!0);return this._revisions};e.setCellData=function(a){var b,d;this._data=a;if(void 0===this._acc){for(a=0;a<this._data.length;a++)if(b=this._data[a],d=b.t||b.v,b&&d&&void 0!==b.a){this._acc=b.a;break}if(void 0!=this._acc)for(a=this._data.length-
1;0<=a;a--)if(b=this._data[a],d=b.t||b.v,b&&d&&void 0!==b.a){this._accend=b.a+d.length-1;break}}};e.hidden=function(){return this._hidden};e.originalHidden=function(){return this._originalHidden};e.deleted=function(){return!!this._deleted};e.show=function(a){return this._hidden||5>this._size?(this._hidden=!1,5>this._size&&(this._size=a),!0):!1};e.reset=function(){var a=!1;void 0!=this._originalSize&&(this._size=this._originalSize,a=!0);!this._hidden&&this._originalHidden&&(a=this._hidden=!0);return a};
e.size=function(){return this._hidden?0:this._size};e.setSize=function(a){if("number"!==typeof a)throw"Invalid argument to setSize";this._size=a;this._hidden=0===a};e.getCellsForRange=function(a,b){if(this._data&&void 0!==this._acc&&a<=this._accend&&b>=this._acc){for(var c,d=0;d<this._data.length;d++){var e=this._data[d],t=e.t||e.v;e&&t&&void 0!==e.a&&a<=e.a+t.length&&b>=e.a&&(c||(c=[]),c.push(e))}return c}};e.getIndexForCell=function(a){if(this._data){for(var b=0,d=0;d<this._data.length;d++){var e=
this._data[d];if(e&&e==a)break;e&&e.e?b+=e.e:b++}return b}};var b=function(a,b){if(a._data){if(void 0===a._getCellIndex||b<a._getCellIndex)if(a._cellDataIndex=0,a._getCellIndex=0,a._getCellEmpty=0,0<a._data.length){var c=a._data[0];c?c.e&&(a._getCellEmpty=c.e):a._getCellEmpty=1}for(;a._getCellIndex<b;){0<a._getCellEmpty&&a._getCellEmpty--;if(0===a._getCellEmpty){a._cellDataIndex++;if(a._cellDataIndex>=a._data.length){a._getCellIndex=b;return}c=a._data[a._cellDataIndex];a._getCellEmpty=c?c.e||0:1}a._getCellIndex++}if(a._cellDataIndex<
a._data.length)return a._cellDataIndex}};e.getCell=function(a){a=b(this,a);if(void 0!==a)return this._data[a]};e.insertCell=function(a){this._data&&void 0!==b(this,a)&&this._data.splice(this._cellDataIndex,0,null)};return d}(),rd=function(){var d={add_row:!0,delete_row:!0},e={add_col:!0,delete_col:!0},b={add_row:!0,delete_row:!0,add_col:!0,delete_col:!0,new_cell:!0,clear_cell:!0,modify_cell:!0,move_cells:!0},a=function(a,b,c){this._page=c;this._top=this._left=null;this._extRowCount=this._extColCount=
this._bottom=this._right=void 0;this._merged=null;this._ajaxLoading=this._ajaxPending=0;this._hideMsg=!1;this._cellGridChanged=!0;this._showAnnotations=!1;this._fonts=a.sheet.fonts;this._styles=a.styles;a.formulas&&(this._formulas=a.formulas);a.sheet.hasOwnProperty("s")?this._sheetStyle=this.cellStyle(a.sheet.s):this._sheetStyle={};this._colMajor="colmajor"===a.sheet.order;this._defColWidth=a.sheet.defcw||80;this._defRowHeight=a.sheet.defrh||20;a.cols||(a.cols=[]);a.rows||(a.rows=[]);this._colCount=
0<a.sheet.c?a.sheet.c:a.cols.length;this._rowCount=0<a.sheet.r?a.sheet.r:a.rows.length;this._cols=[];for(var d=0;d<a.cols.length;d++){var e=a.cols[d];if(void 0!==e.s)for(var g=e.e||e.s,f=e.s;f<=g;f++)c=Va(f),this._cols[f]=new Da(e,this._defColWidth,c);else c=Va(d),this._cols[d]=new Da(e,this._defColWidth,c)}this._rows=[];for(d=0;d<a.rows.length;d++)if(e=a.rows[d],void 0!==e.s)for(g=e.e||e.s,f=e.s;f<=g;f++)c=Ya(f),this._rows[f]=new Da(e,this._defRowHeight,c);else c=Ya(d),this._rows[d]=new Da(e,this._defRowHeight,
c);var k;a.cells&&(k=h(this,a.cells));if(a.data)for(this._data=a.data,a=0;a<this._data.length;a++)c=this._data[a],c.f&&this._ajaxPending++,c.iend=a+1<this._data.length?this._data[a+1].i-1:this._colMajor?this._colCount:this._rowCount;this._embeds=b;t(this,k)},c=W(a);c.showAnnotations=function(a){if(void 0!==a){var b=!1;!0!==a&&(a=!1);!0===a&&(this._annoRows||this._annoCols)?(this._annoRows&&this._rows!==this._annoRows&&(this._rows=this._annoRows,this._rowCount=this._annoRowCount,b=!0),this._annoCols&&
this._cols!==this._annoCols&&(this._cols=this._annoCols,this._colCount=this._annoColCount,b=!0)):(this._normalRows&&this._rows!==this._normalRows&&(this._rows=this._normalRows,this._rowCount=this._normalRowCount,b=!0),this._normalCols&&this._cols!==this._normalCols&&(this._cols=this._normalCols,this._colCount=this._normalColCount,b=!0));b&&(this._top=this._left=null,this._extRowCount=this._extColCount=this._bottom=this._right=void 0,this._cellGridChanged=!0,this._showAnnotations=a,delete this._accmap)}return this._showAnnotations};
c.cellGridChanged=function(a){void 0!==a&&(this._cellGridChanged=!!a);return this._cellGridChanged};c.getCellText=function(a,b){var c=this.getCell(a,b);return c?c.t||c.v||"":""};c.getCellComments=function(a,b,c){var d,e=this._page.comments();if(e)for(var g=0;g<e.length;g++){var f=e[g];if("cell"===f.type&&f.range&&"cell"===f.range.type){var k=f.range;this._showAnnotations&&f.annoRange&&(k=f.annoRange);a>=k.c1&&a<=k.c2&&b>=k.r1&&b<=k.r2&&(!c||k.c2==a&&k.r1==b)&&(d||(d=[]),d.push(f))}}return d};c.updateDimensions=
function(){this._right=this.colLeft(this._colCount);this._bottom=this.rowTop(this._rowCount);this._extColCount=this._colCount;this._extRowCount=this._rowCount;var a=this.embeddingCount();if(a){for(var b=0;b<a;b++){var c=this.embed(b);if(c){if(!c.expansionApplied){var d=this.embed(b);if(d.node&&!d.originApplied){d.originApplied=!0;d.adjustX=0;d.adjustY=0;var e=d.node.data("origin");e&&(e=e.split(","),2==e.length&&(d.adjustX=Number(e[0]),d.adjustY=Number(e[1])))}}var f=this.colWidth(c.c1),h=this.rowHeight(c.r1),
m=c.x1,l=c.y1;m>f&&(m=f);l>h&&(l=h);d=this.colLeft(c.c1)+m;e=this.rowTop(c.r1)+l;c.position={left:d,top:e};void 0===c.c2?(c.position.right=d+c.w,c.position.bottom=e+c.h):(f=this.colWidth(c.c2),h=this.rowHeight(c.r2),m=c.x2,l=c.y2,m>f&&(m=f),l>h&&(l=h),f=this.colLeft(c.c2)+m,l=this.rowTop(c.r2)+l,f<d&&(f=d),l<e&&(l=e),c.position.right=f,c.position.bottom=l);c.position.right>this._right&&(this._right=c.position.right);c.position.bottom>this._bottom&&(this._bottom=c.position.bottom)}}this._extColCount=
this.colFromX(this._right)+1;this._extRowCount=this.rowFromY(this._bottom)+1;this._right=this.colLeft(this._extColCount);this._bottom=this.rowTop(this._extRowCount)}};c.unload=function(){Y(this._data,function(a){a.ajax&&lb(a.ajax)});this._data=null;this._deferredTimer&&(F.resumeIdleTimer("loadDataForCells"),sa(this._deferredTimer),delete this._deferredTimer);this._embeds=this._styles=this._fonts=this._sheetStyle=this._merged=this._rows=this._cols=null};c.sheetStyle=function(){return this._sheetStyle};
c.webFonts=function(){return this._fonts};c.getFormulaText=function(a,b){var c=this.getCell(a,b);if(c){if(!c.fa&&void 0!==c.fm){var d;a:{if(this._formulas&&(d=this.getCell(a,b))&&"number"==typeof d.fm&&0<=d.fm&&d.fm<this._formulas.length){d=this._formulas[d.fm];break a}d=void 0}if(d){var e,g=b,f=d.f,r=0,h=0;e=a;if(this._showAnnotations)for(var m=0;m<e;m++){var n=this._cols[m];n&&n.title()==M.DEL&&e--}if(this._showAnnotations)for(m=0;m<g;m++)(n=this._rows[m])&&n.title()==M.DEL&&g--;c.fr||(r=e-d.c,
h=g-d.r);d=xd(f,r,h,F.externalLinks());c.fa="="+d;c.fr&&(c.fa="{"+c.fa+"}")}}return c.fa}};c.showHidden=function(a){if(a){this._showHidden||(this._showHidden={columns:!1,rows:!1});if("string"===typeof a)switch(a){case "all":this._showHidden.columns=!0;this._showHidden.rows=!0;break;case "none":this._showHidden.columns=!1;this._showHidden.rows=!1;break;case "columns":this._showHidden.columns=!0;break;case "rows":this._showHidden.rows=!0}else void 0!==a.sheets&&void 0!==a.columns&&void 0!==a.rows&&
(this._showHidden.columns=a.columns,this._showHidden.rows=a.rows);this.cellGridChanged(!0)}return this._showHidden};c.embeddingCount=function(){return this._embeds?this._embeds.length:0};c.embed=function(a){if(this._embeds&&0<=a&&a<this._embeds.length)return(a=this._embeds[a])&&!a.node&&(a.node=y.byId(a.id),!a.node||a.node.hasClass("oit-svg-embed")||a.node.hasClass("oit-image-embed")||(a.node=a.node.parent())),a};c.embedByUID=function(a){return fb(this._embeds,"uid",a)};c.getCell=function(a,b){var c,
d;this._colMajor?(d=this._cols[a])&&(c=d.getCell(b)):((d=this._rows[b])&&(c=d.getCell(a)),!c&&this._showAnnotations&&(d=this._cols[a])&&(c=d.getCell(b)));return c||null};c.cellFromPos=function(a,b,c){this._right&&this._bottom||this.updateDimensions();a=this.colFromX(a);b=this.rowFromY(b);a>=this._extColCount&&(a=this._extColCount-1);b>=this._extRowCount&&(b=this._extRowCount-1);!1!==c&&(c=this.getMergedCell(a,b))&&(a=c.range.c1,b=c.range.r1);return ta(a,b)};c.prevTextCell=function(a,b){var c,d,e,
g=a-50;0>g&&(g=0);if(this._colMajor)for(e=a-1;e>=g;e--){if((d=this._cols[e])&&(d=d.getCell(b))&&(d.t||d.v)){c=e;break}}else{var f=this._rows[b];if(f)for(e=a-1;e>=g;e--)if((d=f.getCell(e))&&(d.t||d.v)){c=e;break}}return c};c.cellStyle=function(a){return this._styles&&void 0!==a&&0<=a&&a<this._styles.length?this._styles[a]:{}};c.rowCount=function(){void 0===this._bottom&&this.updateDimensions();return this._extRowCount};c.colCount=function(){void 0===this._right&&this.updateDimensions();return this._extColCount};
c.eachRow=function(a){for(var b in this._rows)a(Number(b))};c.eachCol=function(a){for(var b in this._cols)a(Number(b))};c.rowHeight=function(a){return(a=this._rows[a])?a.size():this._defRowHeight};c.colWidth=function(a){return(a=this._cols[a])?a.size():this._defColWidth};c.setRowHeight=function(a,b){var c=this._rows[a];c||(c=Ya(a),this._rows[a]=c=new Da(null,this._defRowHeight,c));c.setSize(b);this._top=null;this._right=void 0;this.cellGridChanged(!0)};c.setColWidth=function(a,b){var c=this._cols[a];
c||(c=Va(a),this._cols[a]=c=new Da(null,this._defColWidth,c));c.setSize(b);this._left=null;this._bottom=void 0;this.cellGridChanged(!0)};c.showRow=function(a){return(a=this._rows[a])&&a.show(this._defRowHeight)?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};c.showCol=function(a){return(a=this._cols[a])&&a.show(this._defColWidth)?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};c.resetRow=function(a){return(a=this._rows[a])&&a.reset()?(this._top=null,this._right=
void 0,this.cellGridChanged(!0),!0):!1};c.resetCol=function(a){return(a=this._cols[a])&&a.reset()?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};c.colHidden=function(a){return(a=this._cols[a])?a.hidden():!1};c.colOriginalHidden=function(a){return(a=this._cols[a])?a.originalHidden():!1};c.rowHidden=function(a){return(a=this._rows[a])?a.hidden():!1};c.rowOriginalHidden=function(a){return(a=this._rows[a])?a.originalHidden():!1};c.colDeleted=function(a){return(a=this._cols[a])?
a.deleted():!1};c.rowDeleted=function(a){return(a=this._rows[a])?a.deleted():!1};c.colStyle=function(a){return(a=this._cols[a])?this.cellStyle(a.style()):{}};c.rowTop=function(a){if(!this._top){this._top=[];for(var b=0,c=0;c<=this._rows.length;c++){this._top.push(b);var d=this._rows[c],b=d?b+d.size():b+this._defRowHeight}}if(a<this._top.length)return this._top[a];b=this._top.length-1;return this._top[b]+(a-b)*this._defRowHeight};c.rowBottom=function(a){return this.rowTop(a+1)};c.rowFromY=function(a){for(var b=
0;a>this.rowBottom(b);)b++;for(;!this.rowHeight(b)&&0<b;)b--;return b};c.colLeft=function(a){if(!this._left){this._left=[];for(var b=0,c=0;c<=this._cols.length;c++){this._left.push(b);var d=this._cols[c],b=d?b+d.size():b+this._defColWidth}}if(a<this._left.length)return this._left[a];b=this._left.length-1;return this._left[b]+(a-b)*this._defColWidth};c.colRight=function(a){return this.colLeft(a+1)};c.colFromX=function(a){for(var b=0;a>this.colRight(b);)b++;for(;!this.colWidth(b)&&0<b;)b--;return b};
c.sheetRight=function(){void 0===this._right&&this.updateDimensions();return this._right};c.sheetBottom=function(){void 0===this._bottom&&this.updateDimensions();return this._bottom};c.colTitle=function(a,b){var c,d=this._cols[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedCols&&a>=this._colCount&&(a-=this._deletedCols),!1!==b&&(c=Va(a)));return c};c.rowTitle=function(a,b){var c,d=this._rows[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedRows&&a>=this._rowCount&&(a-=this._deletedRows),
!1!==b&&(c=Ya(a)));return c};c.colType=function(a){var b;(a=this._cols[a])&&(b=a.type());return b};c.rowType=function(a){var b;(a=this._rows[a])&&(b=a.type());return b};c.getMergedCell=function(a,b){var c;if(this._merged)for(var d=0;d<this._merged.length;d++){var e=this._merged[d].range;if(a>=e.c1&&a<=e.c2&&b>=e.r1&&b<=e.r2){c=this._merged[d];break}}return c};c.containsRange=function(a){var b=!1;if("text"===a.type){var c=a.acc;a=a.accend;var d=this.findCellsForRange(c,a);if(-1!=d)for(var e=this.getACCMap(),
f=this._colMajor?this._cols:this._rows;d<e.length;d++){var r=f[e[d]];if(r){if(r.acc()>a)break;if(r.getCellsForRange(c,a)){b=!0;break}}}}else b=a.page===this._page.index;return b};c.getACCMap=function(){if(!this._accmap){this._accmap=[];var a=this._colMajor?this._cols:this._rows,b;for(b in a){var c=Number(b),d=a[c];d&&void 0!==d.acc()&&this._accmap.push(c)}}return this._accmap};c.findCellsForRange=function(a,b){var c=this.getACCMap(),d=this._colMajor?this._cols:this._rows;if(0==c.length)return-1;for(var e=
0;e<d.length&&!d[e];)e++;for(var g=d.length-1;0<=g&&!d[g];)g--;if(!d[e]||!d[g]||b<d[e].acc()||a>d[g].accend())return-1;for(var e=0,g=c.length-1,f;e<=g;){f=Math.floor((e+g)/2);var r=d[c[f]];if(b<r.acc())g=f-1;else if(a>r.accend())e=f+1;else break}for(;0<f&&d[c[f-1]].accend()>a;)f--;return f};c.getCellsForRange=function(a,b){var c=this.findCellsForRange(a,b);if(-1!=c){for(var d=this.getACCMap(),e=this._colMajor?this._cols:this._rows,g=void 0;c<d.length;c++){var f=e[d[c]];if(f){if(f.acc()>b)break;(f=
f.getCellsForRange(a,b))&&(g?Array.prototype.push.apply(g,f):g=f)}}return g}};c.select=function(a){var b=!1,c,d;if(a&&"text"===a.type){if(0!==Xa(a,this._selectedRange)&&(this.select(null),c=this._selectedCells=this.getCellsForRange(a.acc,a.accend))){this._selectedRange=ea(a);for(d=0;d<c.length;d++)b=c[d],b.selection=a,b.highlightsChanged=!0;b=!0}}else if(this._selectedCells){c=this._selectedCells;delete this._selectedCells;delete this._selectedRange;for(d=0;d<c.length;d++)b=c[d],delete b.selection,
b.highlightsChanged=!0;b=!0}return b};c.addHighlight=function(a){var b=!1,c,d;if(a)if("text"===a.range.type){var e=this.getCellsForRange(a.range.acc,a.range.accend);if(e){for(d=0;d<e.length;d++)c=e[d],c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);b=!0}!b&&this.hasPendingContent()&&(b=this._page.containsRange(a.range))}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(e=this.mapToText(a.range)))for(d=0;d<e.length;d++)if(c=
e[d],c=this.getCell(c.cell.c,c.cell.r))c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);return b};c.updateHighlight=function(a){var b;if(a)if("text"===a.range.type){var c=this.getCellsForRange(a.range.acc,a.range.accend);if(c)for(a=0;a<c.length;a++)c[a].highlightsChanged=!0}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(c=this.mapToText(a.range)))for(a=0;a<c.length;a++)if(b=c[a],b=this.getCell(b.cell.c,b.cell.r))b.highlightsChanged=
!0};c.removeHighlight=function(a){if(a){var b,c;if("text"==a.range.type){var d=this.getCellsForRange(a.range.acc,a.range.accend);if(d){for(c=0;c<d.length;c++)b=d[c],b.highlights&&(Sa(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0);return!0}}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(d=this.mapToText(a.range)))for(c=0;c<d.length;c++)b=d[c],(b=this.getCell(b.cell.c,b.cell.r))&&b.highlights&&(Sa(b.highlights,a),0===b.highlights.length&&delete b.highlights,
b.highlightsChanged=!0)}return!1};c.expandRange=function(a){a=ea(a);if(this._merged){var b;do{b=!1;for(var c=0;c<this._merged.length;c++){var d=this._merged[c];a.c1<=d.range.c2&&a.c2>=d.range.c1&&a.r1<=d.range.r2&&a.r2>=d.range.r1&&(d.range.c1<a.c1&&(a.c1=d.range.c1,b=!0),d.range.r1<a.r1&&(a.r1=d.range.r1,b=!0),d.range.c2>a.c2&&(a.c2=d.range.c2,b=!0),d.range.r2>a.r2&&(a.r2=d.range.r2,b=!0))}}while(b)}return a};c.getHoverText=function(){if(!x.showCellTooltips||this.isRangeSelected())return null;var a=
S.cellSelection();return(a=this.getCell(a.c1,a.r1))&&a.clipped?a.t||a.v:null};c.isRangeSelected=function(){var a=!1,b=S.cellSelection();if(b&&(b.c1!=b.c2||b.r1!=b.r2)&&(a=!0,this._merged))for(var c=0;c<this._merged.length;c++){var d=this._merged[c];if(b.c1==d.range.c1&&b.c2==d.range.c2&&b.r1==d.range.r1&&b.r2==d.range.r2){a=!1;break}}return a};c.getSelectedText=function(){var a="",b;switch(S.selectionType()){case "text":if(this._selectedCells){b=S.textSelection();for(var c=this._selectedCells,d=0;d<
c.length;d++){var e=c[d];if(e.t){var f=b.acc-e.a;0>f&&(f=0);var h=b.accend-e.a;h>f&&(a&&(a+="\t"),a+=e.t.substring(f,h))}}}break;case "cell":if(b=S.cellSelection(),this.isRangeSelected())for(c=0,d=b.r1;d<=b.r2;d++){e=0;for(f=b.c1;f<=b.c2;f++){if(h=this.getCellText(f,d)){if(0<c)for(1E3<c&&(c=1E3);0<c;c--)a+="\r\n";if(0<e)for(1E3<e&&(e=1E3);0<e;e--)a+="\t";a+=h}e++}c++}else a=this.getCellText(b.c1,b.r1)||""}return a};c.mapToCells=function(a){if("text"==a.type){var b=[],c=a.acc;a=a.accend;var d=this.getACCMap();
if(this._colMajor){var e=this.findCellsForRange(c,a);if(-1==e)return;for(;e<d.length;e++){var e=d[e],f=this._cols[e];if(f){if(f.acc()>a)break;var h=e,r=b;if(f){var m=f.getCellsForRange(c,a);if(m)for(var l=0;l<m.length;l++){var n=f.getIndexForCell(m[l]),p=this.getMergedCell(h,n);p?r.push(ea(p.range)):r.push(ta(h,n))}}}}}else{e=this.findCellsForRange(c,a);if(-1==e)return;for(;e<d.length;e++)if(e=d[e],f=this._rows[e]){if(f.acc()>a)break;h=e;r=b;if(f&&(m=f.getCellsForRange(c,a)))for(l=0;l<m.length;l++)n=
f.getIndexForCell(m[l]),(p=this.getMergedCell(n,h))?r.push(ea(p.range)):r.push(ta(n,h))}}return b}};c.mapToText=function(a){if("cell"==a.type){var b;a=f(a);for(var c=a.r1;c<=a.r2;c++)for(var d=a.c1;d<=a.c2;d++){var e=this.getCell(d,c);if(e&&e.t&&void 0!==e.a){var h=e.a+e.t.length;b||(b=[]);e=pa(e.a,h);e.cell={c:d,r:c};b.push(e)}}return b}};c.decomposeRange=function(a,b){if("cell"==a.type){a=f(a);var c=this.mapToText(a);if(b)c?c.push(a):c=[a];else{for(var d=[],e=a.r1;e<=a.r2;e++)for(var g=null,h=a.c1;h<=
a.c2;h++){var r=this.getCell(h,e);r&&r.v&&(g&&g.c2==h-1?g.c2=h:(g=ta(a.page,h,e,h,e),d.push(g)))}if(0<d.length)for(c||(c=[]),e=0;e<d.length;e++)if(g=d[e]){for(h=e+1;h<d.length;h++)(r=d[h])&&r.r1==g.r2+1&&r.c1==g.c1&&r.c2==g.c2&&(g.r2=r.r2,d[h]=null);c.push(g)}}return c}};var f=function(a){var b=a;if("cell"==a.type&&a.offsets){var b=a.c1,c=a.c2,d=a.r1,e=a.r2,f;b>c&&(f=b,b=c,c=f);d>e&&(f=d,d=e,e=f);0>a.offsets.left&&0<b&&b--;0<a.offsets.right&&c++;0>a.offsets.top&&0<d&&d--;0<a.offsets.bottom&&e++;b=
ta(a.page,b,d,c,e)}return b},h=function(a,b){var c,d,e,f,g,h,r;delete a._accmap;var m=a._colMajor?a._cols:a._rows;c=0;var n,l=[];for(e=0;e<b.length;e++){var p=b[e];p instanceof Array?n=c:(c=p.i,n=p.e||p.i,p=p.d);var v;a._colMajor?(v=new Da(null,a._defColWidth,null),void 0===f&&(f=c,g=0,r=a.rowCount())):(v=new Da(null,a._defRowHeight,null),void 0===g&&(g=c,f=0,h=a.colCount()));for(var q=c;q<=n;q++){a._colMajor?h=q:r=q;m[q]||(m[q]=v);m[q].setCellData(p);for(var t=0,D=0;t<p.length;t++){d=p[t];d.fr&&
l.push(d);if(d.mh||d.mv)a._merged||(a._merged=[]),c=a._colMajor?ta(q,D,q,D):ta(D,q,D,q),d.mh&&(c.c2+=d.mh),d.mv&&(c.r2+=d.mv),a._merged.push({cell:d,range:c});d.e?D+=d.e:D++}}c=n+1}for(e=0;e<l.length;e++)for(d=l[e],c=zb(d.fr),m=c.c1;m<=c.c2;m++)for(n=c.r1;n<=c.r2;n++)(p=a.getCell(m,n))&&p!==d&&(p.fr=d.fr,p.fm=d.fm);return ta(a._page.index,f,g,h,r)},q=function(a,b,c){for(var d;0<=b&&b<a.length;b+=c){var e=a[b];if(e&&void 0!==e.acc()){d=e;break}}return d},t=function(a,b){if(b){var c,d;a._colMajor?(c=
q(a._cols,b.c1,1),d=q(a._cols,b.c2,-1)):(c=q(a._rows,b.r1,1),d=q(a._rows,b.r2,-1));c&&d&&(P.each(function(b){b.addToPage(a._page.index,!0)},function(b){b=P.highlight(b).range;return"text"!==b.type?b.page===a._page.index:b.acc<d.accend()&&b.accend>c.acc()}),G.update(!0))}},u=function(a,b,c,d,e,f,m){f.loaded=!0;delete f.ajax;0===--e._ajaxLoading&&e._hideMsg&&(ya.hideMessage(),e._hideMsg=!1);if(200===d){var g=JSON.parse(c);g.cells&&(g=h(e,g.cells),t(this,g))}else e.logAJAXError(null,"Failed to load the spreadsheet data for sheet "+
(e._page+1)+" from the server",a,d,c);F.resumeIdleTimer("loadSSDataFromServer");if(m){for(var g=[e],k=7;k<arguments.length;k++)g.push(arguments[k]);m.apply(null,g)}},v=function(a,b,c){if(b.f&&!b.loaded&&!b.ajax){var d=b.f;"/"!=d.charAt(0)&&(d=Qa(w.baseURL,d));F.pauseIdleTimer("loadSSDataFromServer");b.ajax=Ma({url:d,context:a,complete:u,args:Array.prototype.slice.call(arguments)});a._ajaxPending--;a._ajaxLoading++;1!=a._ajaxLoading||ya.messageVisible()||(ya.showMessage(M.PLEASE_WAIT_DOWNLOADING),
a._hideMsg=!0)}};c.hasPendingContent=function(){return this._data||0<this._ajaxPending||0<this._ajaxLoading};c.loadRange=function(a,b){var c=!0;if(this._data)switch(a.type){case "text":var d=this.mapToCells(a);d&&0!==d.length||(ca(p,0,this,this,a,b),c=!1);break;case "cell":this.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,b),c=!1}b&&c&&b(a)};var p=function(a,b,c){var d=a.mapToCells(b);if(d&&0<d.length)c&&c(b);else for(d=0;d<a._data.length;d++){var e=a._data[d];if(e&&!e.loaded&&!e.ajax){v(a,e,p,b,c);break}}};
c.loadDataForCells=function(a,b,c,d,e,f){if(void 0===a||void 0===b||void 0===c||void 0===d)f&&f();else if(this._data){this._colMajor||(a=b,c=d);var g;for(d=0;d<this._data.length;d++)if((b=this._data[d])&&!b.loaded&&!b.ajax){if(b.i>c)break;if(b.iend>=a){var k=!1;if(this._colMajor)for(var h=b.i;h<=b.iend;h++){if(!this.colHidden(h)){k=!0;break}}else for(h=b.i;h<=b.iend;h++)if(!this.rowHidden(h)){k=!0;break}k&&(g||(g=[]),g.push(b))}}g?e?(this._deferredTimer?(sa(this._deferredTimer),delete this._deferredTimer):
F.pauseIdleTimer("loadDataForCells"),this._deferredTimer=ca(function(a,b){delete this._deferredTimer;F.resumeIdleTimer("loadDataForCells");l.call(this,a,b)},200,this,g,f)):l.call(this,g,f):f&&f()}else f&&f()};var l=function(a,b){for(var c=0;c<a.length;c++)v(this,a[c],b)},m=function(a){var b;if(a&&void 0!==a.sheet){var c=z.page(a.sheet);if(c&&c.isLoaded()){var d=c.spreadsheetModel();if(d){b=a.c1;var e=a.r1,f=a.c2,h=a.r2,r=a=!1;void 0===b?(b=0,f=d.colCount()-1,a=!0):void 0===f&&(f=b);void 0===e?(e=
0,h=d.rowCount()-1,r=!0):void 0===h&&(h=e);b=ta(c.index,b,e,f,h);a&&(b.selectingRows=!0);r&&(b.selectingCols=!0)}}}return b},H=function(a,b,c){for(a=0;a<b.cells.length;a++){c=b.cells[a];var d=m(c.ref);d&&(delete c.ref,c.range=d)}},I=function(a){for(var b={t:""},c=0;c<a.text.length;c++){var d=a.text[c];if(d.range){var e=Z.getRawText(d.range.acc,d.range.accend);e&&(b.t+=e,b.a||(b.a=d.range.acc))}else d.text&&(b.t+=d.text,delete b.a)}return b},Q=function(a,b,c){b.resolved||(b.ref&&(void 0===b.ref.sheet||
b.page||(b.page=z.page(b.ref.sheet)),b.range=m(b.ref),b.range&&delete b.ref),b.oldref&&(b.oldrange=m(b.oldref),b.oldrange&&delete b.oldref),b.user&&(c&&(b.author=c[b.user]),delete b.user),b.ref||b.oldref||(b.resolved=!0));b.resolved&&b.page&&b.page===a._page&&(a._revisions||(a._revisions=[]),-1==a._revisions.indexOf(b)&&(a._revisions.push(b),"delete_row"===b.type?a._deletedRows++:"delete_col"===b.type&&a._deletedCols++))},J=function(a,b){var c=b.indexOf(a);if(-1==c)for(var d in b){var e=b[d];if(e&&
e.clonedFrom&&e.clonedFrom===a){c=parseInt(d,10);break}}return c},N=function(a,b){if(b&&(b.col||b.row)){var c=ea(b),d,e=c.c1==c.c2,f=c.r1==c.r2;b.col&&(a._annoCols&&(d=J(b.col,a._annoCols),-1!=d&&(c.c1=d)),delete b.col);b.col2?(a._annoCols&&(d=J(b.col2,a._annoCols),-1!=d&&(c.c2=d)),delete b.col2):e&&(c.c2=c.c1);b.row&&(a._annoRows&&(d=J(b.row,a._annoRows),-1!=d&&(c.r1=d)),delete b.row);b.row2?(a._annoRows&&(d=J(b.row2,a._annoRows),-1!=d&&(c.r2=d)),delete b.row2):f&&(c.r2=c.r1);return c}};c.processRevisions=
function(a,b,c){var d=!1;if(a&&a.revisions){var e=this,f;e._deletedCols=0;for(f=e._deletedRows=0;f<a.revisions.length;f++)Q(e,a.revisions[f],a.users);if(e._revisions){a=ta(e._page.index,0,0,0,0);for(f=0;f<e._revisions.length;f++)d=e._revisions[f],Gb(a,d.range),Gb(a,d.oldrange);e.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,function(){var a,d=e._cols.slice(0),f=e._rows.slice(0);e._normalColCount=e._colCount;e._annoColCount=e._colCount+e._deletedCols;e._normalCols=e._cols;e._annoCols=e._cols.slice(0);e._normalRowCount=
e._rowCount;e._annoRowCount=e._rowCount+e._deletedRows;e._normalRows=e._rows;e._annoRows=e._rows.slice(0);for(a=e._revisions.length-1;0<=a;a--){var g=e._revisions[a],k,h,r,m=e;h=g;g=g.range;k=d;var l=f;if(g)switch(h.type){case "add_row":g.row=l[g.r1];g.row||(r=Ya(g.r1),g.row=l[g.r1]=new Da(null,m._defRowHeight,r),m._annoRows[g.r1]||(m._annoRows[g.r1]=g.row));g.col=k[g.c1];g.col2=k[g.c2];g.row.revision(h);l.splice(g.r1,1);break;case "add_col":g.col=k[g.c1];g.col||(r=Va(g.c1),g.col=k[g.c1]=new Da(null,
m._defColWidth,r),m._annoCols[g.c1]||(m._annoCols[g.c1]=g.col));g.row=l[g.r1];g.row2=l[g.r2];g.col.revision(h);k.splice(g.c1,1);break;case "delete_row":r=g;var p=m,v=h,q=new Da(null,p._defRowHeight,M.DEL);q.revision(v);v.target=q;H(p,v,q);for(var p=0,t=[],D=0;D<v.cells.length;D++){var J=v.cells[D];J.range.c1>p&&(t.push({e:J.range.c1-p}),p=J.range.c1);t.push(I(J));p++}q.setCellData(t);r.row=q;g.col=k[g.c1];g.col2=k[g.c2];for(g.row.revision(h);g.r1>l.length;)l.push(null);l.splice(g.r1,0,g.row);k=0<
g.r1?(k=l[g.r1-1])?m._annoRows.indexOf(k)+1:g.r1:(k=l[g.r1+1])?m._annoRows.indexOf(k):g.r1;for(;k>m._annoRows.length;)m._annoRows.push(null);m._annoRows.splice(k,0,g.row);if(m._colMajor)for(r=0;r<m._annoCols.length;r++)if(k=m._annoCols[r])h=m._normalCols.indexOf(k),-1!=h&&(h=k,k=h.clone(),m._annoCols[r]=k,h=l.indexOf(h),-1!=h&&(l[h]=k)),k.insertCell(g.r1);break;case "delete_col":r=g;p=m;v=h;q=new Da(null,p._defColWidth,M.DEL);q.revision(v);v.target=q;H(p,v,q);p=0;t=[];for(D=0;D<v.cells.length;D++)J=
v.cells[D],J.range.r1>p&&(t.push({e:J.range.r1-p}),p=J.range.r1),t.push(I(J)),p++;q.setCellData(t);r.col=q;g.row=l[g.r1];g.row2=l[g.r2];for(g.col.revision(h);g.c1>k.length;)k.push(null);k.splice(g.c1,0,g.col);k=0<g.c1?(k=k[g.c1-1])?m._annoCols.indexOf(k)+1:g.c1:(k=k[g.c1+1])?m._annoCols.indexOf(k):g.c1;for(;k>m._annoCols.length;)m._annoCols.push(null);m._annoCols.splice(k,0,g.col);if(!m._colMajor)for(r=0;r<m._annoRows.length;r++)if(k=m._annoRows[r])h=m._normalRows.indexOf(k),-1!=h&&(h=k,k=h.clone(),
m._annoRows[r]=k,h=l.indexOf(h),-1!=h&&(l[h]=k)),k.insertCell(g.c1);break;case "clear_cell":for(;g.c2>=k.length;)r=Va(k.length),h=new Da(null,m._defColWidth,r),k.push(h),m._annoCols.push(h);for(;g.r2>=l.length;)r=Ya(l.length),h=new Da(null,m._defRowHeight,r),l.push(h),m._annoCols.push(h);case "new_cell":case "modify_cell":case "move_cells":g.col=k[g.c1],g.row=l[g.r1],g.c2!=g.c1&&(g.col2=k[g.c2]),g.r2!=g.r1&&(g.row2=l[g.r2])}}for(a=0;a<e._revisions.length;a++){f=e;d=e._revisions[a];if(m=N(f,d.range))d.annoRange=
m;if(f=N(f,d.oldrange))d.oldAnnoRange=f}if(a=e._page.comments())for(d=0;d<a.length;d++)g=a[d],"cell"===g.type&&g.range&&"cell"===g.range.type&&(f=g,m=e,g=g.range,m._normalCols&&m._normalRows?(g.col=m._normalCols[g.c1],g.row=m._normalRows[g.r1],g.c2!=g.c1&&(g.col2=m._normalCols[g.c2]),g.r2!=g.r1&&(g.row2=m._normalRows[g.r2]),m=N(m,g)):m=void 0,f.annoRange=m);e.showAnnotations(x.showAnnotations);delete e._revisionMap;b&&b.call(c)});d=!0}}return d};c.revisions=function(){return this._revisions};c.rowRevisions=
function(a){if(a=this._rows[a])return a.revision()};c.colRevisions=function(a){if(a=this._cols[a])return a.revision()};var D=function(a,b,c){a[b]?(Array.isArray(a[b])||(a[b]=[a[b]]),a[b].push(c)):a[b]=c},O=function(a,b,c){for(var d=b.r1;d<=b.r2;d++)for(var e=b.c1;e<=b.c2;e++){var f=e,g=c,k=a[d];k||(k=a[d]=[]);k[f]?(Array.isArray(k[f])||(k[f]=[k[f]]),k[f].push(g)):k[f]=g}},B=function(a,b){a&&(b||(b=[]),Array.isArray(a)?Array.prototype.push.apply(b,a):b.push(a));return b};c.getCellRevisions=function(a,
c){var f;if(this._revisions){if(!this._revisionMap){for(var g=this._revisions,h={cols:[],rows:[],cells:[]},m=0;m<g.length;m++){var l=g[m],r=l.annoRange||l.range,p=l.oldAnnoRange||l.oldrange;d[l.type]?(r&&D(h.rows,r.r1,l),p&&D(h.rows,p.r1,l)):e[l.type]?(r&&D(h.rows,r.c1,l),p&&D(h.rows,p.c1,l)):b[l.type]&&(r&&O(h.cells,r,l),p&&O(h.cells,p,l))}this._revisionMap=h}f=B(this._revisionMap.cols[a],f);f=B(this._revisionMap.rows[c],f);(g=this._revisionMap.cells[c])&&(f=B(g[a],f))}return f};return a}(),yd=function(){var d=
{f:"_font",s:"_fontSize",fs:"_fontStyle",fw:"_fontWeight",d:"_textdec",ba:"_baseline",ta:"_angle",c:"_color",w:"_wrap",a:"_align",i:"_indent",v:"_valign",bdr:"_bdr",b:"_fill",bb:"_fillBg",bh:"_fillHatch"},e=function(a,b,c,e){this._data=a;this._model=b;this._style=a.s?b.cellStyle(a.s):{};a.t?this._text=a.t:a.v&&(this._text=a.v);var f=this._style,h=a.c?b.colStyle(c):{},m=b.sheetStyle();this._font="Arial";this._fontSize=10;this._align="g";this._indent=0;this._valign="b";for(var l in d)if(d.hasOwnProperty(l)){var g=
f[l]||h[l]||m[l];void 0!==g&&(this[d[l]]=g)}a.c&&(this._color=a.c);if(this._angle&&"vertical"!==this._angle){for(;0>this._angle;)this._angle+=360;for(;360<=this._angle;)this._angle-=360;0===this._angle?this._angle=null:(this._angle=(360-this._angle)*Math.PI/180,this._align="l",this._valign="b",this._indent=0)}this._bdr&&(this._topBorder=this._bdr[0],this._rightBorder=this._bdr[1],this._bottomBorder=this._bdr[2],this._leftBorder=this._bdr[3],a.bs&&(-1!=a.bs.indexOf("t")&&(this._topBorder=null),-1!=
a.bs.indexOf("r")&&(this._rightBorder=null),-1!=a.bs.indexOf("b")&&(this._bottomBorder=null),-1!=a.bs.indexOf("l")&&(this._leftBorder=null)),delete this._bdr);2>this._indent&&(this._indent=2);this._clearLeft=this._textRight=this._textLeft=0;this._clearRight=void 0;if(a=b.getCellComments(c,e,!0))this._comments=a;if(b=b.getCellRevisions(c,e))for(a=0;a<b.length;a++)if(f=b[a],f.range&&f.range.c1==c&&f.range.r1==e||f.oldrange&&f.oldrange.c1==c&&f.oldrange.r1==e){this._hasRevision=!0;break}},b=W(e);b.hasText=
function(){return this._text&&0<this._text.length};b.textRight=function(){return this._textRight};b.horizontalMerge=function(){return this._data.mh||0};b.verticalMerge=function(){return this._data.mv||0};b.horizontalAlign=function(){return this._align};b.leftBorder=function(){return this._leftBorder||null};b.topBorder=function(){return this._topBorder||null};b.rightBorder=function(){return this._rightBorder||null};b.bottomBorder=function(){return this._bottomBorder||null};b.rangeRect=function(a){var b=
this._wrappedText;if("text"===a.type&&b){var c,d=a.acc-this._data.a;a=a.accend-this._data.a;0>d&&(d=0);a>this._text.length&&(a=this._text.length);for(var e=0;e<b.length;e++)for(var f=b[e],h=f.x,m=f.y,g=f.o,k=0;k<f.spans.length;k++){var l=f.spans[k],p=g+l.t.length;if(p>d&&g<a){var g=h+l.w,v=m+f.h;c?(h<c.left&&(c.left=h),m<c.top&&(c.top=m),g>c.right&&(c.right=g),v>c.bottom&&(c.bottom=v)):c={left:h,top:m,right:g,bottom:v}}h+=l.w;g=p}return c}};b.drawTextBackground=function(a,b,c,d,e,f,h){if(0>this._textLeft||
this._textRight>f)b=d+this._textLeft,d+=this._textRight,b<this._clearLeft&&(b=this._clearLeft),void 0!==this._clearRight&&d>=this._clearRight&&(d=this._clearRight-1),a.oitrect(b+1,e+1,d-b-1,h-1,"#ffffff")};b.drawBackground=function(a,b,c,d,e,f,h){if(this._fill||this.horizontalMerge()||this.verticalMerge())if(this._fillHatch){b=new pc(8,8);c=b.getContext("2d");this._fillBg&&c.oitrect(0,0,8,8,this._fillBg);c.strokeStyle=this._fill||"#ffffff";c.lineCap="square";"d"==this._fillHatch.charAt(0)?c.lineWidth=
2:c.lineWidth=1;switch(this._fillHatch){case "lv":case "dv":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);break;case "lh":case "dh":c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "ldd":case "ddd":c.oitline(-.5,-.5,8.5,8.5);break;case "lud":case "dud":c.oitline(8.5,-.5,-.5,8.5);break;case "lg":case "dg":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "lt":case "dt":c.oitline(0,0,8,8),c.oitline(8,0,0,8)}b=a.createPattern(y.unwrap(b),"repeat");
a.fillStyle=b;a.globalAlpha=1;a.fillRect(d+.5,e+.5,f+.5,h+.5)}else a.oitrect(d+.5,e+.5,f+.5,h+.5,this._fill||"#ffffff")};var a=function(a,b,c,d,e){c||(c=1);var f=2*c;switch(b){case "dotted":b=[f,f];break;case "dashed":b=[2*f,f];break;case "dashdot":b=[2*f,f,f,f];break;case "dashdotdot":b=[2*f,f,f,f,f,f];break;case "double":b=[];c=Math.floor(c/3);1>c&&(c=1);break;default:b=[]}for(var h=f=0;h<b.length;h++)f+=b[h];e%=f;a.strokeStyle=d||"black";a.fillStyle=d||"black";a.lineWidth=c;a.setLineDash?(a.setLineDash(b),
a.lineDashOffset=e):(a.mozDash=b,a.mozDashOffset=e)},c=function(a){var b=Math.floor(a.w/3);1>b&&(b=1);a=a.w-(b+b);1>a&&(a=1);b=(b+a)/2;return[-b,b]},f=function(a,b){var d=0,e=0,f;a&&"double"===a.s&&(f=c(a),d=-f[0]);b&&"double"===b.s&&(f=c(b),e=f[1]);return d&&e?d>e?-d:-e:d?d:e},h=function(a,b){var d=0,e=0,f;a&&"double"===a.s&&(f=c(a),d=-f[0]);b&&"double"===b.s&&(f=c(b),e=f[1]);return d&&e?[-d,-e]:d?[-d,d]:[e,-e]},q=function(b,d,e,m,l,p,v,r,g){a(b,l.s,l.w,l.c,d);"double"===l.s?(l=c(l),p=h(p,v),r=h(r,
g),p[0]||(p[0]=-.5),p[1]||(p[1]=-.5),r[0]||(r[0]=.5),r[1]||(r[1]=.5),b.beginPath(),b.moveTo(d-p[0],e+l[0]),b.lineTo(m+r[0],e+l[0]),b.moveTo(d-p[1],e+l[1]),b.lineTo(m+r[1],e+l[1])):(l=f(p,v),r=f(r,g),l||(l=-.5),r||(r=.5),b.beginPath(),b.moveTo(d-l,e+.5),b.lineTo(m+r,e+.5));b.stroke()},t=function(b,d,e,m,l,p,v,r,g){a(b,l.s,l.w,l.c,e);"double"===l.s?(l=c(l),p=h(p,v),r=h(r,g),p[0]||(p[0]=-.5),p[1]||(p[1]=-.5),r[0]||(r[0]=.5),r[1]||(r[1]=.5),b.beginPath(),b.moveTo(d+l[0],e-p[0]),b.lineTo(d+l[0],m+r[0]),
b.moveTo(d+l[1],e-p[1]),b.lineTo(d+l[1],m+r[1])):(l=f(p,v),r=f(r,g),l||(l=-.5),r||(r=.5),b.beginPath(),b.moveTo(d+.5,e-l),b.lineTo(d+.5,m+r));b.stroke()},u=function(a,b){var c=null;a&&(c=a.bottomBorder());if(b){var d=b.topBorder();d&&(!c||d.w>c.w)&&(c=d)}return c},v=function(a,b){var c=null;a&&(c=a.rightBorder());if(b){var d=b.leftBorder();d&&(!c||d.w>c.w)&&(c=d)}return c};b.drawBorder=function(b,c,d,e,f,h,m,l){if(this._topBorder||this._rightBorder||this._bottomBorder||this._leftBorder){var g=e+h;
m=f+m;b.lineCap="square";b.lineJoin="miter";b.globalAlpha=1;var k;this._leftBorder&&0<=this._textLeft&&0<c&&(c=u(l[0][0],l[1][0]),k=u(l[1][0],l[2][0]),t(b,e,f,m,this._leftBorder,c,this._topBorder,k,this._bottomBorder));this._topBorder&&0<d&&(c=v(l[0][0],l[0][1]),d=v(l[0][1],l[0][2]),q(b,e,f,g,this._topBorder,c,this._leftBorder,d,this._rightBorder));this._rightBorder&&this._textRight<=h&&(d=u(l[0][2],l[1][2]),h=u(l[1][2],l[2][2]),t(b,g,f,m,this._rightBorder,this._topBorder,d,this._bottomBorder,h));
this._bottomBorder&&(k=v(l[2][0],l[2][1]),h=v(l[2][1],l[2][2]),q(b,e,m,g,this._bottomBorder,this._leftBorder,k,this._rightBorder,h));a(b,null)}};var p=function(a,b,c,d){if(c||d){var e={s:{},o:-1,oend:-1};"text"===b.type?(e.o=b.acc-a._data.a,0>e.o&&(e.o=0),e.oend=b.accend-a._data.a):(e.o=0,e.oend=a._text.length);c&&(e.s.c=c);d&&(e.s.bg=La(d));return e}};b.layoutText=function(a,b,c,d,e,f,h){if(this.hasText()){var r,g,k;c=!1;var v=null;r=this._data.selection;var q=this._data.highlights;if(r||q&&0<q.length){v=
[];r&&(k=S.style()||"background-color:#3399FF;",g=rb(k,"color"),k=rb(k,"background-color"),(g=p(this,r,g,k))&&v.push(g));if(q)for(r=0;r<q.length;r++){var t=q[r];if(k=t.highlightStyleProps())g=k.color,k=k["background-color"],(g=p(this,t.range,g,k))&&v.push(g)}delete this._data.highlightsChanged}this._wrappedText&&yc(v,this._highlightSpecs,!0)||(this._highlightSpecs&&!v?delete this._highlightSpecs:this._highlightSpecs=v,this._wrappedText=null);this.horizontalMerge()||this.verticalMerge()?(this._clearLeft=
b,this._clearRight=b+d):(this._clearLeft=f,this._clearRight=h);d!=this._layoutWidth&&(this._wrappedText=null);e!=this._layoutHeight&&(this._wrappedText=null,c=!0);if(!this._wrappedText&&(this._textLeft=0,this._layoutWidth=this._textRight=d,"l"==this._align?this._textLeft=this._indent:"r"==this._align&&(this._textRight=d-this._indent),r=this._textRight-this._textLeft,c=!0,this._wrap||this._angle?this._wrappedText=this.wrapText(a,r,e):this._data.cs||-1!=this._text.indexOf("\n")?this._wrappedText=this.wrapText(a,
void 0,e):(b=this.createLine(0,this._text.length,null),l(a,b,this),m(a,b,this),this._wrappedText=[b]),a=this._wrappedText))if(r=void 0!==this._data.v,r="r"==this._align||"rs"==this._align||r&&"g"==this._align,"c"==this._align||"cs"==this._align)for(r=0;r<a.length;r++)b=a[r],b.x=(d-b.w)/2,f=b.x+b.w,b.x<this._textLeft&&(this._textLeft=b.x),f>this._textRight&&(this._textRight=f);else if(r)for(r=0;r<a.length;r++)b=a[r],b.x=d-2-b.w-this._indent,b.x<this._textLeft&&(this._textLeft=b.x);else for(r=0;r<a.length;r++)b=
a[r],b.x=this._indent,f=b.x+b.w,f>this._textRight&&(this._textRight=f);this._layoutHeight=e;if(c)for(a=this._wrappedText,d=a[a.length-1],d=d.y+d.h-a[0].y,c=0,"c"==this._valign?c=(e-d)/2:"b"==this._valign&&(c=e-d-2),r=0;r<a.length;r++)b=a[r],b.y=c,c+=b.h}};b.drawText=function(a,b,c,d,e,f,h){if(b=this._wrappedText){c=!1;var l=b[b.length-1],l=l.y+l.h-b[0].y;this._data.clipped=!1;if(0>this._textLeft||this._textRight>f||l>h){f=d+this._textLeft;var g=d+this._textRight;if(f<this._clearLeft||void 0!==this._clearRight&&
g>this._clearRight||l>h)f<this._clearLeft&&(f=this._clearLeft),void 0!==this._clearRight&&g>this._clearRight&&(g=this._clearRight),a.save(),c=!0,a.beginPath(),a.fillStyle="black",a.rect(f,e,g-f,h),a.clip(),this._data.clipped=!0}a.globalAlpha=1;a.textAlign="left";a.textBaseline="alphabetic";this._angle&&"vertical"!==this._angle&&0<b.length&&(c||(a.save(),c=!0),a.translate(d+b[0].x,e+b[0].y),d=-b[0].x,e=-b[0].y,a.rotate(this._angle));for(f=0;f<b.length;f++){l=b[f];if(l.y>h)break;for(var g=d+l.x,k=e+
l.y,m=0;m<l.spans.length;m++){var p=l.spans[m],v=this._font,q=this._fontSize,t=this._fontStyle,A=this._fontWeight,w=this._color,n=this._textdec,E=this._baseline,u=null;p.s&&(p.s.f&&(v=p.s.f),p.s.s&&(q=p.s.s),p.s.fs&&(t=p.s.fs),p.s.fw&&(A=p.s.fw),p.s.c&&(w=p.s.c),p.s.d&&(n=p.s.d),p.s.ba&&(E=p.s.ba),p.s.bg&&(u=p.s.bg));p.hs&&(p.hs.c&&(w=p.hs.c),p.hs.bg&&(u=p.hs.bg));var D=L(k+l.a);E&&("sup"===E?(D+=-.35*l.a,q*=.65):"sub"===E&&(D+=.141*l.a,q*=.65));if(u){E=u;u=1;if(0===E.indexOf("rgba(")||0===E.indexOf("rgb(")){var y=
Fa(E);y&&(E=La(y.r,y.g,y.b),u=y.a)}a.fillStyle=E;a.globalAlpha=u;a.fillRect(g-1,D-l.a,p.w+2,l.h+2)}a.font=x(v,q,t,A);a.fillStyle=w||"black";a.globalAlpha=1;a.fillText(p.t,g,D);if(n){var B,J,N;switch(n){case "u":N=1;B=D+N;break;case "d":N=1;B=D+N;J=B+N+N;break;case "l":N=1,B=D-.25*p.a}void 0!==B&&(B=L(B)+.5,a.strokeStyle=w,a.lineWidth=N,a.beginPath(),a.moveTo(g,B),a.lineTo(g+p.w,B),void 0!==J&&(J=L(J)+.5,a.moveTo(g,J),a.lineTo(g+p.w,J)),a.stroke(),a.closePath())}g+=p.w}}c&&a.restore()}};b.drawFlags=
function(b,c,d,e,f,h,l){void 0!==this._data.fm&&(c=f+l,b.lineCap="square",b.lineJoin="miter",b.globalAlpha=1,b.strokeStyle="rgba(52,113,183,0.5)",b.fillStyle="rgba(52,113,183,0.5)",b.lineWidth=1,b.beginPath(),b.moveTo(e,c),b.lineTo(e,c-6),b.lineTo(e+6,c),b.lineTo(e,c),b.fill(),a(b,null));this._comments&&(e+=h,b.lineCap="square",b.lineJoin="miter",b.globalAlpha=1,b.strokeStyle="rgb(255,0,0)",b.fillStyle="rgb(255,0,0)",b.lineWidth=1,b.beginPath(),b.moveTo(e,f),b.lineTo(e,f+6),b.lineTo(e-6,f),b.lineTo(e,
f),b.fill(),a(b,null))};b.createLine=function(a,b,c){var d={x:0,y:0,w:0,h:0,spans:[],o:a},e,f,h,l;if(c){l=a;for(var g,k=0;k<c.length;k++){e=c[k];if(e.o>l&&(f=e.o,f>b&&(f=b),l=this._text.substring(l,f),d.spans.push({t:l,w:0,s:g}),l=f,l>=b))break;g=this._model.cellStyle(e.s)}l<b&&(l=this._text.substring(l,b),d.spans.push({t:l,w:0,s:g}))}else l=this._text.substring(a,b),d.spans.push({t:l,w:0});if(this._highlightSpecs)for(b=0;b<this._highlightSpecs.length;b++)for(c=this._highlightSpecs[b],l=a,g=0;g<d.spans.length;g++)k=
d.spans[g],f=l+k.t.length,c.o<f&&c.oend>l&&(e=c.o-l,0<e&&(f=k.t.substring(0,e),h=k.t.substring(e),e={t:f,w:0},k.s&&(e.s=k.s),k.hs&&(e.hs={},k.hs.c&&(e.hs.c=k.hs.c),k.hs.bg&&(e.hs.bg=k.hs.bg)),d.spans.splice(g,0,e),g++,k.t=h,l+=f.length,f=l+k.t.length),e=c.oend-l,e<k.t.length&&(f=k.t.substring(0,e),h=k.t.substring(e),e={t:h,w:0},k.s&&(e.s=k.s),k.hs&&(e.hs={},k.hs.c&&(e.hs.c=k.hs.c),k.hs.bg&&(e.hs.bg=k.hs.bg)),d.spans.splice(g+1,0,e),k.t=f,f=l+k.t.length),k.hs||(k.hs={}),c.s.c&&(k.hs.c=c.s.c),c.s.bg&&
(k.hs.bg=c.s.bg)),l=f;return d};var l=function(a,b,c){for(var d=b.w=0;d<b.spans.length;d++){var e=b.spans[d],f=c._font,h=c._fontSize,l=c._fontStyle,g=c._fontWeight,k=c._baseline;e.s&&(e.s.f&&(f=e.s.f),e.s.s&&(h=e.s.s),e.s.fs&&(l=e.s.fs),e.s.fw&&(g=e.s.fw),e.s.baseline&&(k=e.s.baseline));k&&("sup"===k?h*=.65:"sub"===k&&(h*=.65));a.font=x(f,h,l,g);e.w=a.measureText(e.t).width;b.w+=e.w}return b.w},m=function(a,b,c){Ha||(Ha=y.create("div","oit-textmeasure"),w.rootNode.append(Ha));b.h=0;b.a=0;Ha.css("display",
"inline");for(a=0;a<b.spans.length;a++){var d=b.spans[a],e=c._font,f=c._fontSize,h=c._fontStyle,l=c._fontWeight;d.s&&(d.s.f&&(e=d.s.f),d.s.s&&(f=d.s.s),d.s.fs&&(h=d.s.fs),d.s.fw&&(l=d.s.fw));Ha.text(d.t);var g=y.create("span");Ha.append(g);Ha.css("font",x(e,f,h,l));Ha.offsetHeight>b.h&&(b.h=Ha.offsetHeight);d.a=g.offsetTop+1;d.a>b.h&&(d.a=b.h);d.a>b.a&&(b.a=d.a)}Ha.html("");Ha.attr("style","");Ha.css("display",null)};b.wrapText=function(a,b,c){var d=[];void 0!==b&&(b-=4);var e=0,f=0,h=0;if("vertical"===
this._angle)b=0;else if(this._angle)if(this._angle===Math.PI/2||this._angle===3*Math.PI/2)b=this._layoutHeight;else{var p=Math.tan(this._angle),g=-this._layoutHeight-p,k=2*this._layoutHeight+p,p=Math.min(Math.min(Math.sqrt(g*g),Math.sqrt(p*p+this._layoutHeight*this._layoutHeight)),Math.sqrt(this._layoutHeight*this._layoutHeight+k*k));p<b&&(b=p)}p=this._text;p=this._data.cs||void 0!==b?p.replace(/\s/g,"\ufffd"):p.replace(/\n/g,"\ufffd");for(g=0;e<this._text.length;){h=p.indexOf("\ufffd",h);-1==h&&
(h=p.length);k=this.createLine(e,h,this._data.cs);l(a,k,this);var v=void 0!==b&&k.w>b;if(v||"\n"==this._text[h]||h>=this._text.length){if(v)if(f>e)h=f,k=this.createLine(e,h,this._data.cs),l(a,k,this);else for(v=e+1;h>v&&!(h--,k=this.createLine(e,h,this._data.cs),l(a,k,this),k.w<=b););m(a,k,this);k.y=g;g+=k.h;d.push(k);if(void 0!==c&&g>=c)break;h<this._text.length&&(e=this._text[h]," "!=e&&"\t"!=e&&"\n"!=e||h++);e=h}else f=h++}if(0!==d.length)return d};var x=function(a,b,c,d){0>=b&&(b=10);var e="";
c&&"normal"!==c&&(e+=c+" ");d&&"normal"!=d&&(e+=d+" ");return e+(b+"px "+a)};return e}(),Ha=null,id=function(){return function(d,e){var b=this,a=d,c=e,f,h,q,t,u,v,p,l,m,H,I,Q,J,N,D,O=[],B,r,g,k,C=0,K=0,G=40,M=22,R,A,U,n,E=x.zoom,ja="database"!==e.type,X,oa=-1,T=-1,qa=-1,aa=-1,Ba=!1,ma,ka,Ja;this.unload=function(){Ja&&(F.resumeIdleTimer("update"),sa(Ja),Ja=null);b.hidePopup(!0);ma&&(ma.destroy(),ma=null);F.offscroll(V);S.offselectionchanged(Z);z.offpageload(W);ha.offresize(ra);N&&N.destroy();for(var d=
a.embeddingCount(),e=0;e<d;e++)a.embed(e).node=void 0;H&&(c.append(H),H=void 0);u&&u.destroy();p&&p.destroy();m&&m.destroy();f&&f.destroy();Ha&&(Ha.destroy(),Ha=null);B=O=D=N=I=H=m=l=p=v=u=t=f=c=a=b=null};this.layoutChanged=function(a){x.zoom!=E&&(b.hidePopup(),ra())};var W=function(a){H&&(c.append(H),I=H=void 0);ra()};this.maxPageWidth=function(){var b=a.sheetRight();void 0!==X&&X>b&&(b=X);return b};this.maxPageHeight=function(){return a.sheetBottom()};this.padding=function(){return{left:G,top:M,
right:0,bottom:0}};this.visibleRange=function(){return ta(K,C,n,U)};this.visibleHeight=function(){return Oa(U)-Wa(C)};this.scrollOffset=function(b,c){void 0===b&&(b=K);void 0===c&&(c=C);var d=L(a.colLeft(b)*E)+1,e=L(a.rowTop(c)*E)+1;return{left:d,top:e}};var V=function(c,d,e,f,g){var h=C;f/=E;if(0<e)for(;!(a.rowBottom(h)>=f);)h++;else if(0>e)for(e=C;0<=e;e--)if(a.rowTop(e)<=f){h=e;break}e=K;f=d/E;if(0<c)for(;!(a.colRight(e)>=f);)e++;else if(0>c)for(c=K;0<=c;c--)if(a.colLeft(c)<=f){e=c;break}if(e!=
K||h!=C)K=e,C=h,!1!==g&&(b.update(),b.hidePopup())},Z=function(b,d){if(d){if(D){var e=a.getSelectedText();D.html(e);D.select()}if(a.isRangeSelected())ma.disable(),ma.setText(void 0);else if(e=F.cellSelection()){var f=a.getFormulaText(e.c1,e.r1);f||(f=a.getCellText(e.c1,e.r1))&&"="==f[0]&&(f="'"+f);ma.enable();ma.setText(f)}else ma.setText(void 0);if(x.showAnnotations){var g,e=F.cellSelection(),f=c.annotationPane();if(e&&f){g=!a.isRangeSelected();!ka||ka.c==e.c1&&ka.r==e.r1||(ka=null);var h=ka?ka.anno:
null,k=null,n=a.getCellComments(e.c1,e.r1),l=a.getCellRevisions(e.c1,e.r1);h&&g&&(n&&(g=n.indexOf(h),-1!=g&&((k=n[g+1])||(k=l?l[0]:n[0]))),!k&&l&&(g=l.indexOf(h),-1!=g&&((k=l[g+1])||(k=n?n[0]:l[0]))));k||((k=Ca(n,e))||(k=Ca(l,e)),k||(n?k=n[0]:l&&(k=l[0])));k&&(ka={anno:k,c:e.c1,r:e.r1},f.activate(k))}}}da();ga()};this.showHidden=function(d,e){if(a){var f=!1;!0===d?a.eachCol(function(b){a.showCol(b)&&(f=!0)}):!1===d&&a.eachCol(function(b){a.resetCol(b)&&(f=!0)});!0===e?a.eachRow(function(b){a.showRow(b)&&
(f=!0)}):!1===e&&a.eachRow(function(b){a.resetRow(b)&&(f=!0)});f&&(X=void 0,P.deactivate(),S.update(),b.update(),P.positionAll(c),F.dispatchPageEvents())}};var ra=function(c){var d=w.viewNode;t&&h==d.clientWidth&&q==d.clientHeight&&E==x.zoom||(h=d.clientWidth,q=d.clientHeight,E=x.zoom,L(h/E),L(q/E),(d=gb())&&(1==E?d.css("transform",null):d.css("transform","scale("+E+","+E+")")),t&&(t.destroy(),v.destroy(),l.destroy()),u||(u=y.create("div","oit-ssgrid"),p=y.create("div","oit-sscolheader"),p.onmousemove(Da),
p.ondragstart(Ga),p.ondragmove(Qa),p.ondragend(Na),p.ondragcancel(Na),p.onpress(Ia),p.onpressup(La),m=y.create("div","oit-ssrowheader"),m.onmousemove(Sa),m.ondragstart(Ua),m.ondragmove(Aa),m.ondragend(Ka),m.ondragcancel(Ka),m.onpress(Ma),m.onpressup(Ta),f.append(u,p,m)),f.css({width:h+"px",height:q+"px"}),G=m.offsetWidth,M=p.offsetHeight,t=u.createCanvas(),v=p.createCanvas(),l=m.createCanvas(),a.updateDimensions(),!1!==c&&b.update())};this.pageRect=function(b,d){if("view"===d||"overlay"===d||d===
c){var e=0,f=0,g=a.sheetRight(),h=a.sheetBottom();if("view"===d||"overlay"===d){var k=x.zoom;1!=k&&(e*=k,f*=k,g*=k,h*=k);"view"===d&&(k=this.scrollOffset(),e+=G-k.left,f+=M-k.top,g+=G-k.left,h+=M-k.top)}return new la(e,f,g,h,d)}};this.rangeRect=function(b,d,e){var f;if("cell"===b.type){f=b.r1;var h=b.r2,n=b.c1,l=b.c2,m=b.offsets;b.offsets?f=new la(a.colLeft(n)+m.left,a.rowTop(f)+m.top,a.colLeft(l)+m.right,a.rowTop(h)+m.bottom,c):(b.selectingRows&&(n=0,l=a.colCount()-1),b.selectingCols&&(f=0,h=a.rowCount()-
1),f=new la(a.colLeft(n)+1,a.rowTop(f)+1,a.colRight(l),a.rowBottom(h),c))}else if("rect"===b.type)"px"!==b.units&&(b=ea(b),va(b,"px")),f=new la(b),void 0!==b.embedId&&(h=a.embedByUID(b.embedId),b=c.embeddingRect(b.embedId),h&&b&&f.offset(b.left,b.top));else if("text"==b.type&&(h=a.mapToCells(b)))for(n=0;n<h.length;n++){var p=h[n],l=a.colLeft(p.c1),m=a.rowTop(p.r1),v;a:{v=p.c1;var A=p.r1;if(v>=B.c1&&v<=B.c2&&A>=B.r1&&A<=B.r2){var q=O[A-B.r1];if(q){v=q[v-B.c1];break a}}v=r&&v==g&&A==k?r:void 0}A=!1;
v||(v=za(p.c1,p.r1),A=!0);A&&(A=t.getContext("2d"),A.save(),A.font="12px Arial,Helvetica,sans-serif",xa(A,p.c1,p.r1,v),A.restore());if(p=v.rangeRect(b))p.left+=l,p.right+=l,p.top+=m,p.bottom+=m,f?f.union(p):f=new la(p,c)}if(f)return!0===e&&(e=w.viewNode,e=new la(0,0,e.clientWidth,e.clientHeight,"view"),e.origin=f.origin,f.intersect(e.left-100,e.top-100,e.right+100,e.bottom+100),0===f.width||0===f.height)&&(f=void 0),f&&d&&(f.origin=d),f};this.rangeFromRect=function(d,f,g,h,k,n,l,m,p,v){d=new la(f,
g,h,k,n);d.origin=c;if(void 0!==m)return p=e.embeddingRect(m),"move"===l?d.constrain(p):d.intersect(p),d.offset(-p.left,-p.left),f=d.toRange(),f.embedId=m,va(f,"pct"),f;"move"!==l&&"resize"!==l&&"extend"!==l&&("view"===n&&(f-=G,g-=M),v|=f<a.colLeft(K),p|=g<a.rowTop(C));m=new la(0,0,a.sheetRight(),a.sheetBottom(),c);"move"===l?d.constrain(m):d.intersect(m);m=!v&&!p;f=a.cellFromPos(d.left,d.top,m);m=a.cellFromPos(d.right,d.bottom,m);v?(f.c1=0,f.c2=a.colCount()-1,f.selectingRows=!0):f.c2=m.c1;p?(f.r1=
0,f.r2=a.rowCount()-1,f.selectingCols=!0):f.r2=m.r1;if("move"===l||"resize"===l)l=b.rangeRect(f,c,!1),d.left-1>l.left&&f.c1<f.c2&&(f.c1+=1),d.top-1>l.top&&f.r1<f.r2&&(f.r1+=1),d.right<l.right&&f.c1<f.c2&&--f.c2,d.bottom<l.bottom&&f.r1<f.r2&&--f.r2;v||p?(v&&(f.selectingRows=!0),p&&(f.selectingCols=!0)):(f.offsets={left:d.left-a.colLeft(f.c1),top:d.top-a.rowTop(f.r1),right:d.right-a.colLeft(f.c2),bottom:d.bottom-a.rowTop(f.r2)},f=a.expandRange(f));return f};this.extendRange=function(a,c,d,e){var f=
b.rangeRect(a,e,!1),g=f.left,f=f.top,g=a.selectingRows?g-G:g+1,f=a.selectingCols?f-M:f+1;c=b.rangeFromRect(a.page,g,f,c,d,e,"extend",void 0,a.selectingCols,a.selectingRows);c.offsets&&!a.offsets&&delete c.offsets;return c};this.update=function(a){Ja||(F.pauseIdleTimer("update"),Ja=ca(this.doUpdate,0,this,a))};this.doUpdate=function(b){Ja&&(F.resumeIdleTimer("update"),sa(Ja),Ja=null);var d=w.viewNode;if(!Ba){Ba=!0;var e=a.webFonts();if(e&&0<e.length)for(var f=e.length-1;0<=f;f--)Gc.loadWebFont(e[f])}var g=
L(-a.colLeft(K)*E),k=L(-a.rowTop(C)*E);w.drawing.setOrigin(g+G,k+M);A=K;n=void 0;for(var l=G;A<a.colCount();){if(!a.colHidden(A)&&(l+=L(a.colWidth(A)*E),l>=d.clientWidth)){l==d.clientWidth?n=A:(n=A-1,n<K&&(n=K));break}A++}void 0===n&&(n=A);R=C;U=void 0;for(var m=M;R<a.rowCount();){if(!a.rowHidden(R)&&(m+=L(a.rowHeight(R)*E),m>=d.clientHeight)){m==d.clientHeight?U=R:(U=R-1,U<C&&(U=C));break}R++}void 0===U&&(U=R);a.loadDataForCells(K,C,A,R,!0);var p=eb();if(p){var v=w.viewNode,r=v.pos(v.parent());p.css({left:r.left+
G+"px",top:r.top+M+"px",width:v.clientWidth-G+"px",height:v.clientHeight-M+"px"});gb().css({left:g+"px",top:k+"px"});for(var q=a.embeddingCount(),u=0;u<q;u++){var y=a.embed(u);if(y&&y.node&&y.position)if(void 0===y.c2)y.node.css({left:y.position.left-y.adjustX+"px",top:y.position.top-y.adjustY+"px"});else if(y.position.left===y.position.right||y.position.top===y.position.bottom)y.node.css("display","none");else{var D=(y.position.right-y.position.left)/y.w,z=(y.position.bottom-y.position.top)/y.h,
Rc,N;if(1!=D||1!=z)Rc="scale("+D+","+z+")",N="left top";y.node.css({display:null,left:y.position.left-y.adjustX*D+"px",top:y.position.top-y.adjustY*z+"px",transform:Rc,"transform-origin":N})}}}var H=t.getContext("2d");H.clearRect(0,0,t.width,t.height);H.save();var I,qa=B,aa,ma;a.cellGridChanged()?(O=qa=B=null,a.cellGridChanged(!1)):!0===b&&(B=null);var oa=K;if(0<K)for(aa=C;aa<=R;aa++)if(!a.rowHidden(aa)&&(I=a.getCell(K,aa),!I||!I.t&&!I.v)){var ka=a.prevTextCell(K,aa);void 0!==ka&&ka<oa&&(oa=ka)}if(B&&
(B.c1!=oa||B.c2!=A||B.r1!=C||B.r2!=R)){if(oa>B.c2||A<B.c1||C>B.r2||R<B.r1)O=qa=null;B=null}if(!B){B=ta(oa,C,A,R);var P=O;O=[];for(aa=B.r1;aa<=B.r2;aa++)a.rowHidden(aa)||(O[aa-B.r1]=[]);var T=null,ba=null;for(aa=B.r1;aa<=B.r2;aa++)if(!a.rowHidden(aa))for(ma=B.c1;ma<=B.c2;ma++){I=a.getCell(ma,aa);var na=a.colStyle(ma),V=a.getCellComments(ma,aa),W=a.getCellRevisions(ma,aa),Ea=V||W||I!==T||null!==na?null:ba;if(I&&!Ea){if(qa){var ia=aa-qa.r1;if(0<=ia&&ia<P.length&&P[ia]){var Z=ma-qa.c1;0<=Z&&Z<P[ia].length&&
(Ea=P[ia][Z])}}Ea||(Ea=za(ma,aa,I))}O[aa-B.r1][ma-B.c1]=Ea;T=I;ba=Ea}}H.font="12px Arial,Helvetica,sans-serif";var ca=L((a.colRight(a.colCount()-1)-a.colLeft(K))*E),fa=L((a.rowBottom(a.rowCount()-1)-a.rowTop(C))*E),Y=w.viewNode,ea=Y.clientWidth,ha=Y.clientHeight;ja||(ea>ca&&(ea=ca),ha>fa&&(ha=fa));H.oitrect(0,0,ea,ha,"#ffffff");H.fillStyle=ja?"#f3f3f3":"#eaeaea";Y.clientWidth>ca&&H.fillRect(ca,0,Y.clientWidth-ca,Y.clientHeight);Y.clientHeight>fa&&H.fillRect(0,fa,Y.clientWidth,Y.clientHeight-fa);H.oitline(.5,
0,.5,ha,"#d0d0d0");for(var Cb=!1,la=K+1;;la++){var Ib=a.colHidden(la);if(!Ib||!Cb){var ua=$a(la);if(ua>ea)break;var wa=ua+.5;H.oitline(wa,0,wa,ha,"#e0e0e0")}Cb=Ib}H.oitline(0,.5,ea,.5,"#d0d0d0");for(var Cb=!1,va=C+1;;va++){var Mb=a.rowHidden(va);if(!Mb||!Cb){var Db=Wa(va);if(Db>ha)break;var ya=Db+.5;H.oitline(0,ya,ea,ya,"#e0e0e0")}Cb=Mb}var Fa=X;a.colLeft(K);a.rowTop(C);for(var Ca=0,Da=0;Da<O.length;Da++){var Na=O[Da],Oa=Da+B.r1,Ha=a.rowHeight(Oa);if(0<Ha){var Ga=0;B.c1!=K&&(Ga=a.colLeft(B.c1)-a.colLeft(K));
for(var Qa=Ga,Ia=0;Ia<Na.length;Ia++){var Pa=Ia+B.c1,Ka=a.colWidth(Pa);if(0<Ka){var La=Na[Ia];if(La&&La.hasText()){xa(H,Pa,Oa,La,Qa,Ga,Ca,Ka,Ha);var Sa=a.colLeft(Pa)+La.textRight();if(void 0===X||Sa>X)X=Sa;Qa=Ga+Ka}Ga+=Ka}}Ca+=Ha}}var Ua=d.clientWidth,Va=d.clientHeight,Aa,Ma=a.sheetRight(),Ta=a.sheetBottom();void 0!==X&&X>Ma&&(Ma=X);c.width=Ma;c.height=Ta;var Xa=w.viewNode,Ya=Xa.clientWidth/E,bb=Xa.clientHeight/E,Za=20/E,ib=G/E,jb=M/E,Eb=Ma+ib+Za;if(Eb>Ya){for(var ab=a.colCount()-1;a.colLeft(ab)<
Ma;)ab++;for(var lb=ab,fb=a.colWidth(lb),hb=lb-1;0<=hb;hb--){var pb=fb+a.colWidth(hb);if(pb>Ya)break;fb=pb}Aa=Ya-fb;0>Aa&&(Aa=0);Aa+=Za;var qb=a.colRight(ab)+ib+Aa;qb>Eb&&(Eb=qb)}var cb=Ta+jb+Za;if(cb>bb){for(var db=a.rowCount()-1;a.rowTop(db)<Ta;)db++;for(var rb=db,nb=a.rowHeight(rb),ob=rb-1;0<=ob;ob--){var vb=nb+a.rowHeight(ob);if(vb>bb)break;nb=vb}Aa=bb-nb;0>Aa&&(Aa=0);Aa+=Za;var xb=a.rowBottom(db)+jb+Aa;xb>cb&&(cb=xb)}void 0===Q&&(Q=Cc(c),J=Dc(c));var sb=Math.ceil(Eb*E),tb=Math.ceil(cb*E);sb>
Q&&(F.hiddenContent("large-sheet-unsupported"),sb=Q);tb>J&&(F.hiddenContent("large-sheet-unsupported"),tb=J);c.css({width:sb+"px",height:tb+"px"});if(X!=Fa||Ua!=d.clientWidth||Va!=d.clientHeight)H.restore(),h=-1,ra();else{H.scale(E,E);pa(H,"drawTextBackground");pa(H,"drawBackground");pa(H,"drawBorder",!0);H.restore();H.save();var yb=a.revisions();if(yb&&x.showAnnotations){H.save();for(var Ab=0;Ab<yb.length;Ab++){var mb=yb[Ab],Lb=mb.annoRange||mb.range,Fb=mb.oldAnnoRange||mb.oldrange;switch(mb.type){case "new_cell":Ra(H,
Lb,null,"rgba(44,156,58,0.5)");break;case "modify_cell":Ra(H,Lb,null,"rgba(148,57,174,0.5)");break;case "clear_cell":Ra(H,Lb,null,"rgba(213,61,61,0.5)");break;case "delete_row":var Gb=H,ub=Lb.r1;if(ub<=R&&ub>=C){var Hb=ta(c.index,0,ub,a.colCount()-1,ub),wb=kb(Hb);Gb.oitrect(wb.left,wb.top,wb.width,wb.height,"rgba(234,158,158,0.1)")}break;case "delete_col":var Jb=H,zb=Lb.c1;if(zb<=A&&zb>=K){var Kb=ta(c.index,zb,0,zb,a.rowCount()-1),Bb=kb(Kb);Jb.oitrect(Bb.left,Bb.top,Bb.width,Bb.height,"rgba(234,158,158,0.1)")}break;
case "move_cells":Ra(H,Fb,null,"rgba(213,61,61,0.5)"),Ra(H,Lb,null,"rgba(44,156,58,0.5)")}}H.restore()}H.scale(E,E);pa(H,"drawText");pa(H,"drawFlags");H.restore();da();ga();S.update()}};this.hidePopup=function(a){};this.moveto=function(b,c,d){var e=!1;if(jc(b))if("text"===b.type)(b=a.mapToCells(b))&&0<b.length&&(e=this.moveto(b[0],c,d));else if("cell"===b.type){for(e=b.c1;e<=b.c2;e++)if(a.colHidden(e)){x.showHiddenColumns=!0;break}for(e=b.r1;e<=b.r2;e++)if(a.rowHidden(e)){x.showHiddenRows=!0;break}b.selectingRows||
b.selectingCols||(b=a.expandRange(b));e=w.viewNode.scroll();this.scrollToRange(b.c1,b.r1,b.c2,b.r2);b=w.viewNode.scroll();V(b.left-e.left,b.left,b.top-e.top,b.top,!0);c&&c(d);e=!0}return e};this.scrollToRange=function(b,c,d,e){var f=w.viewNode,g,h;if(b<K)g=b;else if(d>n){var k=f.clientWidth-G;for(g=d;0<=g;){k-=L(a.colWidth(g)*E);if(0===k)break;if(0>k){g++;break}if(0===g)break;g--}b<g&&(g=b)}if(c<C)h=c;else if(e>U){b=f.clientHeight-M;for(h=e+1;0<=h;){b-=L(a.rowHeight(h)*E);if(0===b)break;if(0>b){h++;
break}if(0===h)break;h--}c<h&&(h=c)}c=this.scrollOffset(g,h);var l,m;void 0!==g&&(l=c.left);void 0!==h&&(m=c.top);f.scroll(l,m)};var da=function(){var b=v.getContext("2d");b.save();b.oitrect(0,0,p.clientWidth,p.clientHeight,"#eaeaea");b.oitrect(0,0,G,M,"#eaeaea");b.oitrect(G-11.5,M-11.5,8,8,"#d0d0d0","#e0e0e0");b.fillStyle="black";b.textAlign="center";b.textBaseline="middle";var c=12;1<=E?b.font="12px Arial,Helvetica,sans-serif":(c*=E,8>c&&(c=8),b.font=c+"px Arial,Helvetica,sans-serif");for(var c=
F.cellSelection(),d=M/2,e=0,f=!1,g=K,h=K;ja||h<=a.colCount();h++){var k=0;a.colHidden(h)?e++:(k=L(a.colWidth(h)*E),0===k?e++:e&&(e=0,f=!0));if(1>=e){var l=$a(h)+G+.5;if(l>p.clientWidth)break;f&&(l+=2,f=!1);var n=null;if(x.showAnnotations){var m=a.colRevisions(h);if(m){for(var r=!1,A=!1,q=0;q<m.length;q++)"add_col"==m[q].type?r=!0:A=!0;r&&A?n="rgba(201,156,214,0.5)":r?n="rgba(149,205,156,0.5)":A&&(n="rgba(234,158,158,0.5)")}}!n&&c&&h>=c.c1&&h<=c.c2&&(n="#d0d0d0");n&&(b.oitrect(l,0,k,M,"#FFF"),b.oitrect(l,
0,k,M,n),b.fillStyle="black");b.strokeStyle=c&&h>c.c1&&h<=c.c2?"#c1c1c1":"#d0d0d0";b.oitline(l,0,l,M,b.strokeStyle);if(!ja&&h>=a.colCount())break;0<k&&(b.save(),b.beginPath(),b.rect(l,0,k,M),b.clip(),(n=a.colTitle(h,!1))||(n=Va(g)),b.measureText(n).width>=k?(k=l+1,b.textAlign="left"):(k=l+k/2,b.textAlign="center"),a.colOriginalHidden(h)?b.fillStyle="#b2b2b2":b.fillStyle="#000",b.fillText(n,k,d),b.restore())}a.colDeleted(h)||g++}c=.5;b.oitline(0,c,p.clientWidth,c,"#d0d0d0");c=M+.5;b.oitline(0,c,p.clientWidth,
c,"#d0d0d0");b.restore()},ga=function(){var b=l.getContext("2d");b.save();b.oitrect(0,0,m.clientWidth,m.clientHeight,"#eaeaea");b.fillStyle="black";b.textAlign="center";b.textBaseline="middle";var c=12;1<=E?b.font="12px Arial,Helvetica,sans-serif":(c*=E,8>c&&(c=8),b.font=c+"px Arial,Helvetica,sans-serif");for(var c=F.cellSelection(),d=G/2,e=0,f=!1,g=C,h=C;ja||h<=a.rowCount();h++){var k=0;a.rowHidden(h)?e++:(k=L(a.rowHeight(h)*E),0===k?e++:e&&(e=0,f=!0));if(1>=e){var n=Wa(h)+.5;if(n>m.clientHeight)break;
f&&(n+=2,f=!1);var p=null;if(x.showAnnotations){var v=a.rowRevisions(h);if(v){for(var r=!1,A=!1,q=0;q<v.length;q++)"add_row"==v[q].type?r=!0:A=!0;r&&A?p="rgba(201,156,214,0.5)":r?p="rgba(149,205,156,0.5)":A&&(p="rgba(234,158,158,0.5)")}}!p&&c&&h>=c.r1&&h<=c.r2&&(p="#d0d0d0");p&&(b.oitrect(0,n,G,k,"#FFF"),b.oitrect(0,n,G,k,p),b.fillStyle="black");b.strokeStyle=c&&h>c.r1&&h<=c.r2?"#c1c1c1":"#d0d0d0";b.oitline(0,n,G,n,b.strokeStyle);if(!ja&&h>=a.rowCount())break;0<k&&(b.save(),b.beginPath(),b.rect(0,
n,G,k),b.clip(),(p=a.rowTitle(h,!1))||(p=Ya(g)),k=n+k/2,a.rowOriginalHidden(h)?b.fillStyle="#b2b2b2":b.fillStyle="#000",b.fillText(p,d,k,G),b.restore())}a.rowDeleted(h)||g++}c=G+.5;b.oitline(c,0,c,m.clientHeight,"#d0d0d0");b.restore()},kb=function(a){var b={left:0,top:0,right:0,bottom:0};b.left=$a(a.c1);b.right=Pa(a.c2);b.top=Wa(a.r1);b.bottom=Oa(a.r2);a=w.viewNode.clientWidth;var c=w.viewNode.clientHeight;b.left=fa(b.left,-100,a+100);b.right=fa(b.right,-100,a+100);b.top=fa(b.top,-100,c+100);b.bottom=
fa(b.bottom,-100,c+100);b.width=b.right-b.left;b.height=b.bottom-b.top;return b},Ra=function(a,b,c,d){b&&b.c1<=A&&b.c2>=K&&b.r1<=R&&b.r2>=C&&(b=kb(b),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,null,"#FFF",2),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,c,d,2,[1,6]))},Y=function(a,b){return!a||0>b||b>=a.length?null:a[b]},pa=function(b,c,d){var e=0,f,g;d&&(f=[[null,null,null],[null,null,null],[null,null,null]]);for(var h,k=null,n=0<O.length?O[0]:null,l=0;l<O.length;l++){h=k;var k=n,n=l+1<O.length?
O[l+1]:null,m=l+B.r1,p=a.rowHeight(m);if(0<p){var v=0;B.c1!=K&&(v=a.colLeft(B.c1)-a.colLeft(K));for(var r=0;r<k.length;r++){var A=r+B.c1,q=a.colWidth(A),t=k[r];if(0<q&&t){var E=t.horizontalMerge(),u=t.verticalMerge(),w=q,y=p;for(g=1;g<=E;g++)w+=a.colWidth(A+g);for(g=1;g<=u;g++)y+=a.rowHeight(m+g);!0===d&&(f[0][0]=Y(h,r-1),f[0][1]=Y(h,r),f[0][2]=Y(h,r+1),f[1][0]=Y(k,r-1),f[1][1]=t,f[1][2]=Y(k,r+1),f[2][0]=Y(n,r-1),f[2][1]=Y(n,r),f[2][2]=Y(n,r+1));t[c](b,A,m,v,e,w,y,f)}v+=q}e+=p}}},xa=function(b,c,
d,e,f,g,h,k,n){var l,m;void 0===g&&(g=a.colLeft(c)-a.colLeft(K));void 0===h&&(h=a.rowTop(d)-a.rowTop(C));void 0===k&&(k=a.colWidth(c));void 0===n&&(n=a.rowHeight(d));if(void 0===f)for(f=g,l=c-1;0<=l;l--){var p=a.getCell(l,d);if(p&&(p.t||p.v))break;f=a.colLeft(l)-a.colLeft(K)}var p=e.horizontalMerge(),v=e.verticalMerge();if((l="cs"===e.horizontalAlign())||0<p)for(m=1;(l||m<=p)&&!(l&&(l=a.getCell(c+m,d),l=!l||l.t||l.v?!1:"cs"===a.cellStyle(l.s).a,!l&&m>p));)k+=a.colWidth(c+m),m++;for(m=1;m<=v;m++)n+=
a.rowHeight(d+m);p=a.colLeft(K);v=a.colRight(A)-p;m=void 0;ja||(m=a.colRight(c)-p);for(c+=1;;c++){l=a.getCell(c,d);if(!l)break;if(l.t||l.v){m=a.colLeft(c)-p;break}l=a.colRight(c)-p;if(l>v)break;ja||(m=l)}e.layoutText(b,g,h,k,n,f,m)},za=function(b,c,d){d||(d=a.getCell(b,c));if(d)return r=d=new yd(d,a,b,c),g=b,k=c,d},ua=function(b){var c;if(b>=G){b-=G;for(var d=K;d<a.colCount();){var e=Pa(d),f=e-3;if(f>b)break;var g=e+3;if(b>=f&&b<=g&&(c=d,b<=e))break;d++}}return c},wa=function(a){var b;if(a>=G)for(a-=
G,b=K;!(a<Pa(b));b++);return b},ya=function(b){var c;if(b>=M){b-=M;for(var d=C;d<a.rowCount();){var e=Oa(d),f=e-3;if(f>b)break;var g=e+3;if(b>=f&&b<=g&&(c=d,b<=e))break;d++}}return c},Fa=function(a){var b;if(a>=M)for(a-=M,b=C;!(a<Oa(b));b++);return b},Ca=function(a,b){var c;if(a)for(var d=0;d<a.length;d++){var e=a[d];if(0===Xa(e.range,b)){c=e;break}if(e.oldrange&&0===Xa(e.oldrange,b)){c=e;break}}return c},Da=function(a){-1==aa&&-1==T&&(a=w.viewNode.mousePos(a),a=void 0!==ua(a.x)?"col-resize":null,
v.css("cursor",a))},Ga=function(a){return-1==aa&&(a=ua(a.center.x),void 0!==a)?(T=a,!1):!0},Qa=function(d){if(-1!=aa)d=wa(d.center.x),S.select(ta(c.index,aa,0,d,a.rowCount()-1));else if(-1!=T){d=L((d.center.x-G)/E)+a.colLeft(K);var e=a.colLeft(T);d=d>=e?d-e:0;d!=a.colWidth(T)&&(a.setColWidth(T,d),S.update(),b.update(),P.positionAll(c))}return!1},Na=function(a){-1!=T&&(T=-1,ra(),P.positionAll(c));return!1},Ia=function(b){aa=wa(b.center.x);S.select(ta(c.index,aa,0,aa,a.rowCount()-1))},La=function(a){aa=
-1},Sa=function(a){-1==qa&&-1==oa&&(a=w.viewNode.mousePos(a),a=void 0!==ya(a.y)?"row-resize":null,l.css("cursor",a))},Ua=function(a){return-1==qa&&(a=ya(a.center.y),void 0!==a)?(oa=a,!1):!0},Aa=function(d){if(-1!=qa)d=Fa(d.center.y),S.select(ta(c.index,0,qa,a.colCount()-1,d));else if(-1!==oa){d=L((d.center.y-M)/E)+a.rowTop(C);var e=a.rowTop(oa);d=d>=e?d-e:0;d!=a.rowHeight(oa)&&(a.setRowHeight(oa,d),S.update(),b.update(),P.positionAll(c))}return!1},Ka=function(a){-1!==oa&&(oa=-1,ra(),P.positionAll(c));
return!1},Ma=function(b){qa=Fa(b.center.y);S.select(ta(c.index,0,qa,a.colCount()-1,qa))},Ta=function(a){qa=-1},Wa=function(b){return L((a.rowTop(b)-a.rowTop(C))*E)},Oa=function(b){return L((a.rowBottom(b)-a.rowTop(C))*E)},$a=function(b){return L((a.colLeft(b)-a.colLeft(K))*E)},Pa=function(b){return L((a.colRight(b)-a.colLeft(K))*E)},eb=function(){void 0===H&&(H=c.childByClass("oit-sheet-embedpane"))&&w.viewNode.parent().append(H);return H},gb=function(){if(void 0===I){var a=eb();I=a?a.childByClass("oit-sheet-embedlist"):
null}return I};(function(){var b=w.viewNode;f=b.parent().childByClass("oit-ssoverlay");f||(f=y.create("div","oit-ssoverlay"),b.parent().insert(f,b));f.html("");N=c.overlay.childByClass("oit-sel-text");N||(N=y.create("div"),c.overlay.append(N));D=y.create("pre");N.addClass("oit-sel-text");N.html("");N.append(D);ma=new wd;ma.show();F.onscroll(V);S.onselectionchanged(Z);z.onpageload(W);ha.onresize(ra);b=b.scroll();V(b.left,b.left,b.top,b.top,!1);ra(!1);ca(function(){P.eachOnPage(function(b){a.addHighlight(b);
P.link(b)},c)},0)})()}}(),xd=function(){function d(a,b,c){this.value=a;this.type=b;this.subtype=c}function e(){this.items=[];this.add=function(a,b,c){c||(c="");a=new d(a,b,c);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==
this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function b(){this.items=[];this.pushToken=function(a,b,c){this.items.push(new d(a,b,c))};this.push=function(a){this.items.push(a)};this.pop=function(){var a=this.items.pop();return new d(a.value,a.type,z)};this.token=function(){return 0<this.items.length?this.items[this.items.length-1]:null};this.value=function(){return this.token()?
this.token().value:""};this.type=function(){return this.token()?this.token().type:""};this.subtype=function(){return this.token()?this.token().subtype:""}}function a(a,b,c,d){var e=!1,f=0,g=!1,h=0;a=a.replace(n,"");a=a.replace(ja,"@");a=a.replace(X,"");var k=a.length,l=a.indexOf("!")+1,m="";0<l&&(m=a.slice(0,l-1));var p=a.slice(l,a.length),v=m.match(E);if(v&&d){var r=""+v[0],v="'";r.charCodeAt(0)==U&&(r=r.slice(1,r.length),v="");r=r.slice(1,r.length-1);r=parseInt(r,10);0<r&&r--;if(r<d.length){d=d[r];
d=d.replace(P,"\\");var r=d.lastIndexOf("\\"),q;0<=r?(q=d.slice(r+1,d.length),d=d.slice(0,r+1)):(q=d,d="");0===d.indexOf("file:\\\\\\")&&(d=d.slice(8,d.length));m="'"+m.replace(E,d+"["+q+"]")+v;m=m.replace(oa," ")}}v=a.charCodeAt(l);l<k&&v==F&&(e=!0,l++,v=a.charCodeAt(l));for((d=l<k&&v>=G&&v<=L)||(g=e);l<k&&v>=G&&v<=L;)f=26*f+(v-G+1),l++,v=a.charCodeAt(l);16172<f&&(d=!1);l<k&&v==F&&(g=!0,l++,v=a.charCodeAt(l));for(r=l<k&&v>=M&&v<=A;l<k&&v>=M&&v<=A;)h=10*h+(v-M),l++,v=a.charCodeAt(l);e||(f+=b);g||
(h+=c);0<f&&f--;""!==m&&(m+="!");return l==k&&(d||r)?m+(d?(e?"$":"")+Va(f):"")+(r?(g?"$":"")+h:""):m+p}function c(a){for(var c=new e,d=new b,A=0,E=function(){return a.substr(A,1)},u="",U=!1,H=!1,X=!1,F=!1;0<a.length;)if(" "==a.substr(0,1))a=a.substr(1);else{"="==a.substr(0,1)&&(a=a.substr(1));break}for(var I=/^[1-9]{1}(\.[0-9]+)?E{1}$/;!(A>=a.length);)if(U)'"'==E()?'"'==a.substr(A+1,1)?(u+='"',A+=1):(U=!1,c.add('"'+u+'"',h,J),u=""):u+=E(),A+=1;else if(H)"'"==E()?"'"==a.substr(A+1,1)?(u+="'",A+=1):
(u+=E(),H=!1):u+=E(),A+=1;else if(X)"]"==E()&&(X=!1),u+=E(),A+=1;else if(F)u+=E(),A+=1,-1!=",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+u+",")&&(F=!1,c.add(u,h,O),u="");else if(-1!="+-".indexOf(E())&&1<u.length&&u.match(I))u+=E(),A+=1;else if('"'==E())0<u.length&&(c.add(u,y),u=""),U=!0,A+=1;else if("'"==E())0<u.length?(c.add(u,y),u=""):u+=E(),H=!0,A+=1;else if("["==E())X=!0,u+=E(),A+=1;else if("#"==E())0<u.length&&(c.add(u,y),u=""),F=!0,u+=E(),A+=1;else if("{"==E())0<u.length&&(c.add(u,
y),u=""),c.add("{",q,x),d.pushToken("}",q,z),c.add("",q,x),d.pushToken("",q,z),A+=1;else if(";"==E())0<u.length&&(c.add(u,h),u=""),c.addRef(d.pop()),c.add(";",w),c.add("",q,x),d.pushToken("",q,z),A+=1;else if("}"==E())0<u.length&&(c.add(u,h),u=""),c.addRef(d.pop()),c.addRef(d.pop()),A+=1;else if(" "==E())for(0<u.length&&(c.add(u,h),u=""),c.add("",m),A+=1;" "==E()&&!(A>=a.length);)A+=1;else-1!=",>=,<=,<>,".indexOf(","+a.substr(A,2)+",")?(0<u.length&&(c.add(u,h),u=""),c.add(a.substr(A,2),p,D),A+=2):
(-1!="+-*/^&=><".indexOf(E())?(0<u.length&&(c.add(u,h),u=""),c.add(E(),p)):-1!="%".indexOf(E())?(0<u.length&&(c.add(u,h),u=""),c.add(E(),l)):"("==E()?0<u.length?(c.add(u.replace(n,"")+"(",q,x),d.pushToken(")",q,z),u=""):(c.add("(",t,x),d.pushToken(")",t,z)):","==E()?(0<u.length&&(c.add(u,h),u=""),d.type()!=q?c.add(E(),p,C):c.add(E(),w)):")"==E()?(0<u.length&&(c.add(u,h),u=""),c.addRef(d.pop())):u+=E(),A+=1);0<u.length&&c.add(u,h);for(d=new e;c.moveNext();)u=c.current(),u.type==m?c.BOF()||c.EOF()||
(c.previous().type==q&&c.previous().subtype==z||c.previous().type==t&&c.previous().subtype==z||c.previous().type==h)&&(c.next().type==q&&c.next().subtype==x||c.next().type==t&&c.next().subtype==x||c.next().type==h)&&d.add(" ",p,k):d.addRef(u);for(;d.moveNext();)u=d.current(),u.type==p&&"-"==u.value?d.BOF()?u.type=v:d.previous().type==q&&d.previous().subtype==z||d.previous().type==t&&d.previous().subtype==z||d.previous().type==l||d.previous().type==h?u.subtype=r:u.type=v:u.type==p&&"+"==u.value?d.BOF()?
u.type=f:d.previous().type==q&&d.previous().subtype==z||d.previous().type==t&&d.previous().subtype==z||d.previous().type==l||d.previous().type==h?u.subtype=r:u.type=f:u.type==p&&0===u.subtype.length?-1!="<>=".indexOf(u.value.substr(0,1))?u.subtype=D:u.subtype="&"==u.value?g:r:u.type==h&&0===u.subtype.length?isNaN(parseFloat(u.value))?u.subtype="TRUE"==u.value||"FALSE"==u.value?D:B:u.subtype=N:u.type==q&&"@"==u.value.substr(0,1)&&(u.value=u.value.substr(1));d.reset();for(c=new e;d.moveNext();)d.current().type!=
f&&c.addRef(d.current());c.reset();return c}var f="noop",h="operand",q="function",t="subexpression",w="argument",v="operator-prefix",p="operator-infix",l="operator-postfix",m="white-space",y="unknown",x="start",z="stop",J="text",N="number",D="logical",O="error",B="range",r="math",g="concatenate",k="intersect",C="union",F=36,G=65,L=90,M=48,A=57,U=39,n=/\u005F[^\u002E]*\u002E/,E=/^'?\u005B[0-9]+\u005D/,ja=/\u005B\u0023This Row\u005D/,X=/\u005B\u005D/,oa=/%20/g,P=/\u002F/g;return function(b,d,e,f){b=
c(b);for(var g="",h;b.moveNext();){var k=b.current();if(k.subtype!=C&&k.type!=w||!h||h.subtype!=B||64!=h.value.charCodeAt(h.value.length-1)){if(k.subtype==B){h=k;var l;l=k.value;var n=d,m=e,p=f,v=l.lastIndexOf(":");l=0<v?a(l.slice(0,v),n,m,p)+":"+a(l.slice(v+1),n,m,p):a(l,n,m,p);h.value=l}g+=k.value}h=k}return g}}(),td=function(){var d={ATTACHMENTS:"ATTACHMENT",BADDRESS:"BUSINESSADDRESS",BPHONE:"BUSINESSPHONE",CALENDAREXCEPTIONS:"CALENDAR_EXCEPTION",CATEGORY:"CATEGORIES",CREATED:"CREATION_TIME",DUEDATE:"DUE_DATE",
ENDDATE:"DTEND",ENDTIME:"DTEND",ENTRYTYPE:"ENTRY_TYPE",FAX:"BUSINESSFAX",HADDRESS:"HOMEADDRESS",HPHONE:"HOMEPHONE",IM:"IMADDRESS",LAST:"FAMILY",NAME:"FULLNAME",MOBILE:"MOBILEPHONE",OPTATTEND:"OPTATTENDEE",PERCENT:"PERCENT_COMPLETE",RECURRANGE:"RECURRENCE_RANGE",RECURTYPE:"RECURRENCE_TYPE",REQATTEND:"REQATTENDEE",STARTDATE:"START_DATE",STARTTIME:"DTSTART",TOPIC:"CONVERSATION_TOPIC"},e={FI_OUTLOOK_MSG_APPT:"calendarentry",FI_OUTLOOK_MSG_CDSMAIL:"msg",FI_OUTLOOK_MSG_CONTACT:"contact",FI_OUTLOOK_MSG_DISTLIST:"contactgroup",
FI_OUTLOOK_MSG_JOURNAL:"journal",FI_OUTLOOK_MSG_MAIL:"msg",FI_OUTLOOK_MSG_NDR:"msg",FI_OUTLOOK_MSG_NOTE:"note",FI_OUTLOOK_MSG_ODSMAIL:"msg",FI_OUTLOOK_MSG_POST:"note",FI_OUTLOOK_MSG_TASK:"task",FI_OUTLOOK_OFT_APPT:"calendarentry",FI_OUTLOOK_OFT_CDSMAIL:"msg",FI_OUTLOOK_OFT_CONTACT:"contact",FI_OUTLOOK_OFT_DISTLIST:"contactgroup",FI_OUTLOOK_OFT_JOURNAL:"journal",FI_OUTLOOK_OFT_MAIL:"msg",FI_OUTLOOK_OFT_NDR:"msg",FI_OUTLOOK_OFT_NOTE:"note",FI_OUTLOOK_OFT_ODSMAIL:"msg",FI_OUTLOOK_OFT_POST:"note",FI_OUTLOOK_OFT_TASK:"task",
ai:"vector",bmp:"image",cdr:"vector",cgm:"vector",chtml:"ie",cur:"image",dcx:"image",dgn:"vector",doc:"doc",docx:"doc",drw:"vector",dwg:"vector",dxf:"vector",emf:"vector",eml:"msg",fft:"text",gdf:"vector",gem:"vector",gif:"image",hdml:"ie",hpgl:"vector",htm:"ie",html:"ie",ico:"image",ics:"calendar",img:"image",indd:"image",jpg:"image",lwp:"text",mhtml:"ie",mpg:"video",mpp:"project",msg:"msg",odg:"vector",odi:"image",odt:"text",oft:"text",pbm:"image",pcd:"image",pct:"image",pcx:"image",pdf:"pdf",pdfi:"image",
pgm:"image",pic:"vector",pif:"vector",png:"image",ppm:"image",ppt:"ppt",pptx:"ppt",ps:"vector",psd:"image",psp:"image",pst:"msg",rtf:"text",sdw:"image",svg:"vector",tga:"image",tif:"image",txt:"text",vsd:"vsd",wbmp:"image",wmf:"vector",wml:"ie",wmv:"video",wpd:"text",wpg:"image",xbm:"image",xhtml:"ie",xlc:"xls",xls:"xls",xlsb:"xls",xlsx:"xls",xml:"ie",xmp:"ie",xpm:"image",yim:"text",zip:"zip"},b=function(a){T.call(this,a);y.attach(this);this._page=z.forNode(a);if(!this._page._fields&&(a=(a=this.byClass("oit-maildata"))?
a[0]:y.byId("oit-maildata"))){var b=this.byClass("oit-emhdrlabel"),D=this.byClass("oit-emhdrvalue"),J=[];if(b&&D&&b.length==D.length)for(var B=0;B<b.length;B++){var r=b[B],g=D[B];if("oit-email_attachments"!=r.id){var k={},C;r.id&&0===r.id.indexOf("oit-email_")&&(C=r.id.substring(10).toUpperCase(),k.id=d[C]||C);if(!k.id)for(C=0;;C++){var I=r.classList.item(C);if(!I)break;if(0===I.indexOf("oit-email_")){C=I.substring(10).toUpperCase();k.id=d[C]||C;break}}k.id||(k.label=r.html());r=g.attr("data-acc");
1==g.dom.childElementCount?g=g.firstChildElem():(C=y.create("div"),C.transferFrom(g),g=C);r&&(g.attr("data-acc",r),"none"===r&&g.addClass("oit-noacc"));k.value=g.dom.outerHTML;J.push(k)}}this._page._fields=J;a.destroy()}this.html('<div class="oit-headerpadding"><table class="oit-maildata"></table><div class="oit_attachments oit-noacc" data-acc="none"></div></div><div class="oit-emextra"><div class="oit-em_allheaders"><table class="oit-emheadervalues"></table></div></div>');this._hdrtable=this.byClass("oit-maildata")[0];
a=this.parent().parent();a.hasClass("oit-emailstream")&&(b=y.create("div","oit-emailbk"),b.transferFrom(a),a.append(b),a.addClass("oit-emailfill"));b=this._page._fields;a=this.byClass("oit-em_allheaders")[0];if(x.removeExtraEmailHeaders||w.isMobile)a.destroy(),a=null;c(b);switch(this.data("subtype")){case "journal":D=x.journalHeader;break;case "contact":D=x.contactHeader;break;case "note":D=x.noteHeader;break;case "appt":D=x.appointmentHeader;break;case "task":D=x.taskHeader;break;case "post":D=x.postHeader;
break;case "dist":D=x.distroHeader;break;default:D=x.emailHeader}J=this._page._fields;if(D.subjectField)if(k=l(J,D.subjectField),B=l(J,D.dateField),!D.subjectField&&!D.dateField||k||!1===D.defaultSubject||(k=new Sc({id:"SUBJECT",value:'<div class="oit-emhdrvalue oit-textfield"><div><span></span></div></div>'})),k){if(k.addedToHeader=!0,g=this.subjectBar=y.create("div","oit-email-subjectbar"),r=k.clone(),r.addContainerClass("oit-email-subject"),r.appendAsDiv(g),r.labelElem.html(""),this.fixedSubjectField=
r,r.valueElem.text()||(r.valueElem.addClass("oit-nosubject"),r.valueElem.text(M.NO_SUBJECT)),r=this._hdrtable.parent(),r.insert(g,r.firstChildElem()),k.hide(),B&&(this.headerDateField=B,k=B.clone(),k.addContainerClass("oit-email-date"),k.appendAsDiv(g),this.fixedDateField=k,B.appendAsRow(this._hdrtable),B.hide()),!w.isMobile&&(B=g.clone(!0)))this.stickyHeader=y.create("div","oit-email-stickyheader"),this.stickyHeader.append(B),this.stickyHeader.onmouseover(this,m),this.stickyHeader.onmouseout(this,
H),this.stickyHeader.ontap(this,F),w.viewNode.parent().append(this.stickyHeader),this.stickyHeaderVisible=!1,this.stickyDateFixedField=this.stickyHeader.byClass("oit-email-date"),Array.isArray(this.stickyDateFixedField)&&(this.stickyDateFixedField=this.stickyDateFixedField[0])}else this.addClass("oit-nosubject");D.photoField&&(B=l(J,D.photoField))&&(B.addContainerClass("oit-email-photo"),B.insertAsDiv(this._hdrtable.parent(),this._hdrtable),B.labelElem.html(""));D.logoField&&(B=l(J,D.logoField))&&
(B.addContainerClass("oit-email-logo"),B.insertAsDiv(this._hdrtable.parent(),this._hdrtable),B.labelElem.html(""));if(D.headerFields)for(g=y.create("tbody"),k=0;k<D.headerFields.length;k++)if(r=D.headerFields[k],"string"==typeof r||Array.isArray(r))(C=l(J,r))&&C.appendAsRow(this._hdrtable);else if(r.fields)if(r.multi){C=[];for(B=0;B<r.fields.length;B++)p(J,r.fields[B],null,C);for(B=0;B<C.length;B++)C[B].appendAsRow(this._hdrtable)}else if(r.title){I=[];for(B=0;B<r.fields.length;B++)if(C=l(J,r.fields[B]))C.showType(!1),
I.push(C);if(0<I.length)for(g.html('<tr><td class="oit-emhdrsection" colspan="3"><span data-acc="none" class="oit-noacc">'+M["EMAIL_"+r.title]+M.LABEL_SEPARATOR+"</span></td></tr>"),this._hdrtable.append(g.firstChildElem()),B=0;B<I.length;B++)I[B].appendAsRow(this._hdrtable)}if(this.stickyHeader){this.stickyHeaderDetail=y.create("div","oit-shdetail");this.stickyHeaderDetailShown=!1;D=y.wrap(this._hdrtable.clone(!0));B=!1;g=0;for(k=D.firstChildElem();k;k=J)J=k.nextSiblingElem(),g++,B||(20<g?B=!0:k.firstChildElem().hasClass("oit-emhdrsection")&&
(B=!0)),B&&k.destroy();this.stickyHeaderDetail.append(D);this.stickyHeader.append(this.stickyHeaderDetail);this.stickyDateHeaderField=D.byClass("DATE");this.stickyDateHeaderField||(this.stickyDateHeaderField=D.byClass("RECEIVED"));Array.isArray(this.stickyDateHeaderField)&&(this.stickyDateHeaderField=this.stickyDateHeaderField[0]);this.stickyDateHeaderField&&(this.stickyDateHeaderField=this.stickyDateHeaderField.parent());v(this.stickyHeader)}f(b)&&(this._emailExpander=y.create("div","oit-showemail"),
this._emailExpander.onclick(this,u),this._emailExpander.ontap(this,u),this._hdrtable.parent().insert(this._emailExpander,this._hdrtable),x.showEmailAddresses?q.call(this):t.call(this));if(a)if(D=a.firstChildElem(),b=h(D,b))for(this.allHeaders=new zd(this,a,"oit-email_gear_icon",18,18,M.SHOWDETAILS,M.HIDEDETAILS),this.byClass("oit-headerpadding")[0].append(this.allHeaders),D=0;D<b.length;D++)b[D].tab=this.allHeaders;else a.destroy(),a=null;a||this.removeExtraEmailHeaders();if((a=this._page._attachments)&&
0<a.length){b=this.byClass("oit_attachments")[0];D=y.create("div");for(J=0;J<a.length;J++)B=a[J],B.ext||(g=B.name,k=g.lastIndexOf("."),B.ext="",-1!=k&&(B.ext=g.substring(k+1).toLowerCase())),(g=e[B.file_id]||e[B.ext])||(g="generic"),g=['<div class="oit-attached-file" data-index="',B.id,'">','<div class="oit-ficon oit-ficon-',g,'"><div></div></div>','<div class="oit-attinfo">',"<div>",B.displayName||B.name,"</div>"],B.size&&(g.push("<div>"),B.size&&g.push(Bc(B.size)),g.push("</div>")),g.push("</div></div>"),
D.html(g.join("")),g=D.firstChildElem(),b.append(g),ob.on.addElement(g,B.id);D.html('<div style="clear:both;"></div>');b.append(D.firstChildElem())}this._page.pageContentChanged();this.applyShowEmailAddresses();this.onStyleChanged()},a=W(b,T);a.destroy=function(){ob.on.removeAllElements();this.stickyHeader&&this.stickyHeader.destroy();T.prototype.destroy.call(this)};a.scrollPadding=function(){if(this.stickyHeaderVisible)return{top:this.stickyHeader.offsetHeight}};var c=function(a,b){if(a)for(var d=
0;d<a.length;d++){var e=a[d];e.appendAsRow||(a[d]=new Sc(e,b));e.subfields&&c(e.subfields,a[d])}},f=function(a){var b=!1;if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d.addedToHeader&&d.hasEmailAddresses){b=!0;break}if(d.subfields&&(b=f(d.subfields)))break}return b},h=function(a,b,c){c||(c=[]);if(b){var d,e;for(d=0;d<b.length;d++)e=b[d],e.subfields||e.addedToHeader||!e.hasValue()||(e.appendToExtra(a),e.extra=!0,c.push(e));for(d=0;d<b.length;d++)if(e=b[d],e.subfields){var f=a,g=c,k=e.subfields;if(k)for(var l=
!0,m=0;m<k.length;m++){var p=k[m];if(!p.addedToHeader&&(p.hasValue()||p.subfields)){if(e&&l){var v=M["EMAIL_"+e.fieldId];if(v||e.fieldDef.label){var q,l=[];l.push('<tr><td class="oit-emhdrsection" colspan="2">');e.fieldType&&(q=e.fieldType.substring(1,e.fieldType.length-1));v?l.push('<span data-acc="none" class="oit-noacc">',v):l.push(e.fieldDef.label,'<span data-acc="none" class="oit-noacc">');q&&l.push(" (",q,")");l.push(M.LABEL_SEPARATOR,"</span></td><td></td></tr>");l=l.join("");v=y.create("tbody");
v.html(l);f.append(v.firstChildElem())}l=!1}p.appendToExtra(f);g.push(p)}p.subfields&&h(f,p.subfields,g)}}}return 0===c.length?null:c};a.applyShowEmailAddresses=function(){this._emailExpander&&(x.showEmailAddresses?q.call(this):t.call(this),this.applyViewSize(!0))};var q=function(){this._emailExpander&&(this._page.addClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.addClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-showemail").addClass("oit-hideemail"),z.each("pageLayoutChanged"))},
t=function(){this._emailExpander&&(this._page.removeClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.removeClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-hideemail").addClass("oit-showemail"),z.each("pageLayoutChanged"))},u=function(){x.showEmailAddresses=!x.showEmailAddresses},v=function(a){a.attr("data-acc")&&a.attr("data-acc","none");for(a=a.firstChildElem();a;a=a.nextSiblingElem())v(a)},p=function(a,b,c,d){if(b&&a){var e,f;if(Array.isArray(b))for(e=0;e<
b.length;e++)p(a,b[e],null,d);else if(b.g)for(c=b.t?";"+b.t+";":null,e=0;e<a.length;e++)f=a[e],f.subfields&&f.fieldId==b.g&&(c?f.fieldType&&-1!=f.fieldType.indexOf(c)&&p(f.subfields,b.id,b.d,d):p(f.subfields,b.id,b.d,d));else if("string"==typeof b)for(e=0;e<a.length;e++)if(f=a[e],f.fieldId==b&&!f.addedToHeader&&(f.hasValue()||f.isCompound())){d.push(f);var g=null;if(c&&"string"==typeof c)for(var h=0;h<a.length;h++){var l=a[h];if(l.hasValue()&&!l.addedToHeader&&l.fieldId==c){g=l;break}}f.setDisplayField(g)}}},
l=function(a,b){if(a&&b){var c=[];p(a,b,null,c);if(1<=c.length)return c[0]}},m=function(){if(this.stickyHeaderDetail&&!S.isSelecting()){var a=this.stickyHeaderDetail.firstChildElem().outerHeight;this.stickyHeaderDetail.css("height",""+a+"px");this.stickyHeaderDetailShown=!0}},H=function(){this.stickyHeaderDetail&&(this.stickyHeaderDetail.css("height",null),this.stickyHeaderDetailShown=!1)},F=function(){this.stickyHeaderDetailShown?H.call(this):m.call(this)};a.applyViewSize=function(a){var b;this.stickyHeader&&
this.stickyHeader.css("width",null);this.fixedSubjectField&&(a=this.fixedSubjectField.containerWidth(),this.fixedDateField&&(this.fixedDateField.show(),a+=this.fixedDateField.containerWidth()),b=w.viewNode.clientWidth,x.nochrome||(b-=42),a>b?(this.fixedDateField&&this.fixedDateField.hide(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display","none"),this.headerDateField&&this.headerDateField.show(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display",null)):(this.fixedDateField&&
this.fixedDateField.show(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display",null),this.headerDateField&&this.headerDateField.hide(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display","none")));this.stickyHeader&&(a=this._page.parent().offsetWidth,b=w.viewNode.clientWidth,x.nochrome||(a-=2,b-=21),a>b&&(a=b),this.stickyHeader.css("width",a+"px"));if(!this._page.isHidden())P.onEmailHeaderResize(this._page.index);this._page.overlay.each("pageLayoutChanged")};a.finishAnimation=
function(){this._page&&this._page.finishAnimation()};a.showStickyHeader=function(){if(this.stickyHeader&&this.subjectBar&&(this.stickyHeaderVisible||(this.stickyHeader.addClass("oit-email-shvisible"),x.nochrome?this.stickyHeader.addClass("oit-nochrome"):this.stickyHeader.removeClass("oit-nochrome"),this.stickyHeaderVisible=!0),this.stickyHeaderVisible&&!x.nochrome)){var a=w.viewNode.scrollLeft;0===a?this.stickyHeader.css("left",null):this.stickyHeader.css("left",21-a+"px")}};a.hideStickyHeader=function(){this.stickyHeader&&
this.subjectBar&&this.stickyHeaderVisible&&(this.stickyHeader.removeClass("oit-email-shvisible"),this.stickyHeaderVisible=!1)};a.onScroll=function(){this.stickyHeader&&this.subjectBar&&(0>this.subjectBar.pos(this.stickyHeader.parent()).top?this.showStickyHeader():this.hideStickyHeader())};a.beginSelection=function(a){this._selectionPos=null;this.showEmailHeader(a)};a.getEmailFieldForRange=function(a){var b;if(a&&"text"==a.type){var c=this._page._fields,d;for(d in c){var e=c[d];if("custom"===d)for(var f=
0;f<e.length;f++){if(b=e[f].subfieldByRange(a))return b}else if(b=e.subfieldByRange(a))return b}}};a.moveto=function(a,b,c){return(a=this.showEmailHeader(a,b,c))&&a.tab?!0:!1};a.showEmailHeader=function(a,b,c){if(a&&"text"==a.type){var d=this.getEmailFieldForRange(a);if(d)if(d.field&&this.hideStickyHeader(),d.tab)c=c||{},d.tab.activate(null,!0),d.tab.scrollToRange(a),b&&b(c),this._selectionPos="tab";else{for(var e=d.addresses;!e&&d.groupField;)d=d.groupField,e=d.addresses;if(e&&!x.showEmailAddresses)for(var f=
0;f<e.length;f++){var g=e[f].address;if(g){var h=g.acc;if(h+g.text.length>=a.acc&&h<=a.accend){x.showEmailAddresses=!0;break}}}b&&b(c)}return d}};a.onStyleChanged=function(){this.applyEmailHeaderStyles()};a.applyEmailHeaderStyles=function(){try{this._headerStyle&&this.css(this._headerStyle),this.applyViewSize()}catch(J){this.logError("email header style","An error occurred setting email header style")}};var G=function(a,b){var c=!1;if(a.subfields)for(var d=a.subfields.length-1;0<=d;d--)G(a.subfields[d],
b)&&a.subfields.splice(d,1);if(!a.addedToHeader||a.extra)a.range&&b.push(a.range),c=!0;return c};a.removeExtraEmailHeaders=function(){this.allHeaders&&this.allHeaders.activate(null,!1);var a=this._page._fields;if(a){for(var b=[],c=a.length-1;0<=c;c--)G(a[c],b)&&a.splice(c,1);b.length&&(Z.replaceRawText(b),P.removeFromRange(b))}this.allHeaders&&(this.allHeaders.destroy(),delete this.allHeaders)};return b}(),zd=function(){var d=function(a,d,e,q,t,u,v){T.call(this,"div","oit-button");y.attach(this);
e&&this.addClass(e);this._header=a;this._minHeight=this._fullHeight=t;this._clientDiv=d;this._active=!1;this._utip=u;v&&(this._atip=v);u&&this.attr("title",u);if(this._clientDiv)this._clientDiv.on("scroll",null,b,this);this.on("click",this,this.activate,"toggle");this.on("tap",this,this.activate,"toggle")},e=W(d,T);e.destroy=function(){this._clientDiv&&(this._clientDiv.offscroll(b),delete this._clientDiv);this.offclick(this.activate);this.offtap(this.activate);T.prototype.destroy.call(this)};var b=
function(a,b){var c=b._clientDiv.scroll();b._scroll&&c.left==b._scroll.left&&c.top==b._scroll.top||(b._scroll=c,c=z.page(0),P.deactivate(),c.pageLayoutChanged(),P.positionAll(c))};e.isActive=function(){return this._active};e.containsRange=function(a){var b=y.wrap(a.startContainer);a=y.wrap(a.endContainer);var c=y.isDescendantOf(b,this._clientDiv);if(c||y.isDescendantOf(a,this._clientDiv))return{tab:this,rangeElem:c?b:a}};e.scrollToRange=function(a){if(this._clientDiv.childByClass("oit-emheadervalues")&&
(a=G.rangeRect(a,"view"))){var c=0,d=0,e=w.viewNode.clientWidth,t=w.viewNode.clientHeight;0>a.left?c=a.left-10:a.right>e&&(c=a.right+10-e);0>a.top?d=a.top-10:a.bottom>t&&(d=a.bottom+10-t);if(c||d)w.viewNode.dscroll(c,d),b(null,this)}};var a=function(a,b,d){(b=b.getEmailFieldForRange(a.range))&&b.tab&&(a.id==P.active()&&P.deactivate(),a.removeFromPage(d))};e.activate=function(b,d){var c=this._active;"toggle"==d?c=!c:"boolean"===typeof d&&(c=d);if(c!==this._active){var e=this._header._page;this._header.finishAnimation();
(this._active=c)||"tab"!==this._selectionPos||S.select(null);c||(P.each(a,e,this._header,e.index),w.viewNode.scroll(0,0));c?(this.addClass("oit-activetab"),this._clientDiv.parent().addClass("oit-activetab"),this._atip&&this.attr("title",this._atip)):(this.removeClass("oit-activetab"),this._clientDiv.parent().removeClass("oit-activetab"),this._utip&&this.attr("title",this._utip));this._header.applyViewSize()}};return d}(),Sc=function(){var d="TO CC BCC FROM EMAIL EMAIL2 EMAIL3 RCVD_REPRESENTING_ADDRESS RECEIVED_BY_EMAIL_ADDRESS SENDER_EMAIL_ADDRESS SENT_REPRESENTING_EMAIL_ADDRESS".split(" "),
e=["ORGANIZER","ATTENDEES"],b=function(a,b){T.call(this);this.fieldDef=a;a.id&&(this.fieldId=a.id);a.type&&(this.fieldType=";"+a.type+";");a.subfields&&(this.subfields=a.subfields);a.range&&(this.range=a.range);this.container=y.create("div");b&&(this.groupField=b,this.showGroupType=!0);this.addedToHeader=!1},a=W(b,T);a.clone=function(){return new b(this.fieldDef)};a.isCompound=function(){return this.subfields&&0<this.subfields.length&&-1!=e.indexOf(this.fieldId)};a.show=function(){this.container.css("display",
null);this.container.attr("data-acc",null)};a.hide=function(){this.container.css("display","none");this.container.attr("data-acc","none")};a.showType=function(a){this.showGroupType=!!a};a.subfieldById=function(a){var b,c;if(a)if(Array.isArray(a))for(c=0;c<a.length&&!(b=this.subfieldById(a[c]));c++);else for(c=0;c<this.subfields.length;c++){var d=this.subfields[c];if(d.fieldId==a){b=d;break}}return b};a.subfieldByRange=function(a){var b;if(this.subfields)for(var c in this.subfields){var d=this.subfields[c];
if("custom"==c)for(var e=0;e<d.length&&!(b=d[e].subfieldByRange(a));e++);else b=d.subfieldByRange(a);if(b)break}b||this.range&&Ic(this.range,a)&&(b=this);return b};a.toTagName=function(a,b){var c=f(this.container,a);if(this.labelElem){var d=f(this.labelElem,b);d.transferFrom(this.labelElem);c.append(d);this.labelElem=d}this.valueElem&&(d=f(this.valueElem,b),d.transferFrom(this.valueElem),c.append(d),this.valueElem=d);(d=this.container.parent())&&d.insert(c,this.container);this.container.destroy();
this.container=c};a.containerWidth=function(){return this.container.offsetWidth};a.addContainerClass=function(a){this.container.addClass(a)};a.prepForMainHeader=function(){this.addedToHeader||(this.addedToHeader=!0,this.parseEmailAddresses(),this.buildFieldValue())};a.appendAsRow=function(a){this.prepForMainHeader();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};a.appendAsDiv=function(a){this.prepForMainHeader();
"DIV"!==this.container.tagName&&this.toTagName("div","div");a.append(this.container)};a.insertAsDiv=function(a,b){this.prepForMainHeader();"DIV"!==this.container.tagName&&this.toTagName("div","div");a.insert(this.container,b)};a.appendToExtra=function(a){this.addedToHeader=!0;this.buildFieldValue();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};a.parseEmailAddresses=function(){this.addresses||(this.isCompound()?
(this.addresses=[],c(this,this.addresses),0===this.addresses.length&&delete this.addresses):this.fieldDef.value&&-1!=d.indexOf(this.fieldId)&&this.parseStandardEmailAddresses())};a.parseStandardEmailAddresses=function(){if(this.range){var a=y.create("div");a.html(this.fieldDef.value);for(var b,c=a.createTreeWalker(),d=c.firstACCNode(),a=[],e;d;){d=c.currentNode;if(1===d.nodeType)(d=y.data(d,"acc"))&&(b="none"===d?void 0:Number(d));else if(3===d.nodeType&&0<d.nodeValue.length&&void 0!==b){var f=b+
d.nodeValue.length;e&&e.accend!=b&&(e=null);e?e.accend=f:(e={text:d.nodeValue,acc:b,accend:f},a.push(e));b+=d.nodeValue.length}d=c.nextACCNode()}for(c=b=0;c<a.length;c++){e=a[c];d=e.text;e=e.acc;var f=[],h=d.toUpperCase(),q=(d.match(/@/g)||[]).length,w=(h.match(/CN=/g)||[]).length,h=(h.match(/((\[([^\[\]])*\/CN([^\[\]])*\])+)/g)||[]).length,q=0===w?q+h:0===h?q+w:q+Math.min(w,h);if(0===q)d=f;else{var x=u(d,/((?:[^;"']|"[^"]*"|'[^']*')+)/g,q),w=u(d,/((?:[^;"]|"[^"]*")+)/g,q),h=u(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,
q),q=u(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,q);if(!x||w.diff<x.diff)x=w;if(!x||h.diff<x.diff)x=h;if(!x||q.diff<x.diff)x=q;if(x){if(q=x.list)for(var z=0,w=0;w<q.length;w++){h=q[w];z=d.indexOf(h,z);if(-1==z)break;var x=e+z,z=z+h.length,B=null,r=null,g=-1,k=-1,C=h.lastIndexOf("<"),F=h.lastIndexOf(">"),G=h.lastIndexOf("["),M=h.lastIndexOf("]"),L=void 0,A=void 0;0<=C&&F>C?(L=C,A=F):0<=G&&M>G&&(L=G,A=M);void 0!==L&&A+1<h.length&&(L=void 0);void 0!==L?(B=h.substring(0,L),g=x,r=h.substring(L+1,A),k=x+L+1):
(F=h.toUpperCase(),C=F.indexOf("CN="),0<C&&"/"!==F.charAt(C-1)&&(C=-1),0<=C?(r=h,k=x,B=h.indexOf("/",C),-1==B&&(B=h.length),B=h.substring(C+3,B),g=x+C+3):-1!=h.indexOf("@")?(r=h,k=x):(B=h,g=x));B=t(B,g);r=t(r,k);B||(B=r,r=null);(B||r)&&f.push({name:B,address:r})}d=f}else d=void 0}d&&0<d.length&&(b++,this.addresses=this.addresses?this.addresses.concat(d):d)}b!=a.length&&delete this.addresses}};a.markAddedToHeader=function(a){this.addedToHeader=!0;if(a&&this.subfields)for(var b=0;b<this.subfields.length;b++)this.subfields[b].markAddedToHeader(a)};
var c=function(a,b){switch(a.fieldId){case "ORGANIZER":case "ATTENDEE":var d=a.subfieldById("DISPLAYAS"),e=a.subfieldById("EMAIL")||a.subfieldById("ORGANIZER");if(d&&d.fieldDef&&d.fieldDef.value&&d.fieldDef.range&&e&&e.fieldDef&&e.fieldDef.value&&e.fieldDef.range){var f=y.create("div");f.html(d.fieldDef.value);var h=f.text();f.html(e.fieldDef.value);f=f.text();h=t(h,d.fieldDef.range.acc);f=t(f,e.fieldDef.range.acc);h&&f&&(b.push({name:h,address:f}),a.markAddedToHeader(!0))}break;case "ATTENDEES":for(d=
0;d<a.subfields.length;d++)c(a.subfields[d],b)}};a.setDisplayField=function(a){if(a&&this.fieldDef.value&&this.range&&a.fieldDef.value&&a.range){var b=y.create("div");b.html(a.fieldDef.value);var c=t(b.text(),a.range.acc);b.html(this.fieldDef.value);b=t(b.text(),this.range.acc);c&&b&&(this.displayField=a,this.displayField.addedToHeader=!0,this.addresses=[{name:c,address:b}])}else delete this.displayField,delete this.addresses};a.hasValue=function(){return"string"==typeof this.fieldDef.imageurl||"string"==
typeof this.fieldDef.value};a.buildFieldValue=function(){var a=this.fieldDef,b;this.container.html("");if(!this.labelElem){var c;a.id&&(c=M["EMAIL_"+a.id])&&(a.label=c);var d=y.create("div","oit-emhdrlabel");b=[];c||("string"==typeof a.label?b.push(a.label):b.push(M.UNKNOWN_FIELD));b.push('<span data-acc="none" class="oit-noacc">');c&&b.push(a.label);this.groupField&&this.showGroupType&&this.groupField.fieldDef.type&&b.push(" (",this.groupField.fieldDef.type,")");a.label&&-1!=a.label.indexOf(M.LABEL_SEPARATOR)||
b.push(M.LABEL_SEPARATOR);b.push("</span>");d.html(b.join(""));this.labelElem=d}if(!this.valueElem){if("string"==typeof a.imageurl)b='<img src="'+a.imageurl+'"/>',this.valueElem=y.create("div","oit-fieldimage"),this.valueElem.html(b);else if(this.addresses){this.valueElem=y.create("div");this.valueElem.html(a.value);b=[];for(c=0;c<this.addresses.length;c++)d=this.addresses[c],b.push('<span class="oit-email-a">'),0<c&&h(", ",b),d.name&&q(d.name.text,d.name.acc,"oit-email-aname",d.address?d.address.text:
null,null,null,b),d.address&&(q(d.address.text,d.address.acc,"oit-email-aaddr",null," [","]",b),this.hasEmailAddresses=!0),b.push("</span>");this.valueElem.html(b.join(""));this.valueElem.removeData("acc")}else"string"==typeof a.value&&(this.valueElem=y.create("div"),this.valueElem.html(a.value));if(this.valueElem&&(this.valueElem.addClass("oit-emhdrvalue"),a.id&&(a=a.id,this.groupField&&(a=this.groupField.fieldDef.id+"/"+a),this.valueElem.attr("data-fieldid",a)),this.valueElem.hasClass("oit-noacc"))){var e;
this.valueElem.hasClass("oit-datetime-field")?e=Bb(this.valueElem.text()):this.valueElem.hasClass("oit-date-field")?e=zc(this.valueElem.text()):this.valueElem.hasClass("oit-time-field")&&(e=Ac(this.valueElem.text()));e&&this.valueElem.text(e)}}this.labelElem&&this.container.append(this.labelElem);this.valueElem&&this.container.append(this.valueElem)};var f=function(a,b){var c=y.create(b);c.addClass(a.attr("class"));var d=a.attr("data-acc");d&&c.attr("data-acc",d);(d=a.attr("data-fieldid"))&&c.attr("data-fieldid",
d);return c},h=function(a,b){b.push('<span class="oit-noacc" data-acc="none">',a,"</span>")},q=function(a,b,c,d,e,f,q){a=Kb(a);d=Kb(d);q.push("<span");d&&q.push(' title="',d,'"');0>b&&(c=c?c+" oit-noacc":"oit-noacc");c&&q.push(' class="',c,'"');e||f?(q.push(">"),e&&(0>b?q.push(e):h(e,q)),q.push("<span",' data-acc="'),0<b?q.push(b):q.push("none"),q.push('">',a,"</span>"),f&&(0>b?q.push(f):h(f,q))):(q.push(' data-acc="'),0<b?q.push(b):q.push("none"),q.push('">',a));q.push("</span>")},t=function(a,b){if(a){for(var c=
0;c<a.length&&/\s/.test(a[c]);c++)b++;a=a.trim();if(2<=a.length){var c=a.charAt(0),d=a.charAt(a.length-1);'"'!=c&&"'"!=c||c!=d||(b++,a=a.substring(1,a.length-1),(c=t(a,b))?(a=c.text,b=c.acc):a=null)}}return a?{text:a,acc:b}:null},u=function(a,b,c){if(a=a.match(b)){for(b=0;b<a.length;b++);b=0;if(a)for(var d=0;d<a.length;d++)(0<a[d].indexOf("@")||0<=a[d].toUpperCase().indexOf("CN="))&&b++;if(0<b)return{list:a,count:b,diff:Math.abs(b-c)}}};return b}(),Ad=function(){var d=function(){T.call(this,"div",
"oit-scrollpane");this.addClass("oit-scrollpanebar");this.html('<div class="oit-scrollpanecontent"></div><div class="oit-scrollbar"><div></div></div><div class="oit-scrollpaneup oit-fade"></div><div class="oit-scrollpanedn oit-fade"></div><div class="oit-scrollpaneup oit-ellip">&#x2022; &#x2022; &#x2022;</div><div class="oit-scrollpanedn oit-ellip">&#x2022; &#x2022; &#x2022;</div>');this.prop("scrollbar",this.childByClass("oit-scrollbar"),!1,!0);this.prop("scrollthumb",this.scrollbar.firstChildElem(),
!1,!0);this.prop("scrollup",this.byClass("oit-scrollpaneup"),!1,!0);this.prop("scrolldown",this.byClass("oit-scrollpanedn"),!1,!0);w.isMobileOrTablet&&(this.kinetic(!0),this.onpanstart(this,t),this.onpanmove(this,u));this.scrollbar.onclick(this,a);this.scrollbar.ontap(this,a);this.scrollthumb.ondragstart(this,c);this.scrollthumb.ondragmove(this,f);this.scrollthumb.ondragend(this,h);this.scrollthumb.ondragcancel(this,h);this.scrollthumb.onclick(this,q);this.prop("content",this.childByClass("oit-scrollpanecontent"),
!1,!0);this.content.onwheel(this,b);this.onmouseover(this,function(){this.addClass("oit-hover")});this.onmouseout(this,function(){this.removeClass("oit-hover")});y.attach(this)},e=W(d,T);Object.defineProperties(e,{scrollLeft:{get:function(){return 0},set:function(a){}},scrollTop:{get:function(){return-this.content.offsetTop},set:function(a){this.setScrollTop(a,!0)}},minScroll:{get:function(){return 0}},maxScroll:{get:function(){var a=this.content.outerHeight-this.clientHeight;0>a&&(a=0);return a}},
contentHeight:{get:function(){return this.content.outerHeight}},visibleHeight:{get:function(){return this.clientHeight}},enabled:{get:function(){return this.content.outerHeight>this.clientHeight}}});e.setScrollTop=function(a,b){if("number"===typeof a){var c=this.minScroll,d=this.maxScroll;a<c?a=c:a>d&&(a=d);this.content.offsetTop!=-a?(this.content.offsetTop=-a,!1!==b&&this.update(a),"function"===typeof R.UIEvent?c=new UIEvent("scroll"):(c=V.createEvent("UIEvents"))&&c.initUIEvent&&c.initUIEvent("scroll",
!0,!1,R,null,2),c&&this.dispatchCustom("scroll",c)):!1!==b&&this.update(a);return a}};e.scrollIntoView=function(a){var b;a instanceof T?b=a.rect(this.content):a instanceof la&&(b=a);b&&(a=this.scrollTop,b.bottom>=a+this.visibleHeight&&(a=b.bottom+11-this.visibleHeight),b.top<=a&&(a=b.top-11),this.scrollTop=a)};e.isVisible=function(a){var b;a instanceof la?b=a:a instanceof T&&(b=a.rect(this.content));return b?(a=this.scrollTop*x.zoom,b.top<a+this.visibleHeight*x.zoom&&b.bottom>a):!1};e.update=function(a){if(void 0===
a)this.setScrollTop(this.scrollTop);else{if(this.scrollbar){var b=this.content.outerHeight,c=this.clientHeight;c>=b?(this.scrollbar.css("display","none"),this.removeClass("oit-scrollable")):(c=100*c/b,1>c&&(c=1),this.scrollthumb.css({top:100*a/b+"%",height:c+"%"}),this.scrollbar.css("display",null),this.addClass("oit-scrollable"))}if(this.scrollup){b=0<a;c=a<this.maxScroll;for(a=0;a<this.scrollup.length;a++)this.scrollup[a].css("opacity",b?null:0);for(a=0;a<this.scrolldown.length;a++)this.scrolldown[a].css("opacity",
c?null:0)}}};var b=function(a){if(!a.ctrlKey&&this.enabled){var b=a.deltaY;if(1==a.deltaMode||2==a.deltaMode)b*=12;this.scrollTop+=b;return!1}},a=function(a){if(a.offsetY){var b=this.content.outerHeight,c=this.clientHeight,d=this.scrollTop/b;a=a.offsetY/this.clientHeight;a<d?this.scrollTop-=c:a>d+c/b&&(this.scrollTop+=c)}},c=function(a){this.scrollthumb._topPercent=100*this.scrollTop/this.content.outerHeight;this.scrollbar.css("opacity",.1);return!1},f=function(a){var b=this.content.outerHeight,c=
100*(b-this.clientHeight)/b;a=this.scrollthumb._topPercent+100*a.delta.y/this.clientHeight;0>a?a=0:a>c&&(a=c);this.scrollTop=a*b/100;return!1},h=function(a){delete this.scrollthumb._topPercent;this.scrollbar.css("opacity",null);return!1},q=function(a){return!1},t=function(a){return!1},u=function(a){this.scrollTop-=a.delta.y;return!1};e.redirectEvent=function(a){var c=!0;"wheel"==a.type&&(b.call(this,a),c=!1);return c};return d}(),Qb={paragraph:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,
showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},slide:{requireText:!1,skipIfNoText:!1,showIcon:!0,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},page:{requireText:!1,skipIfNoText:!1,showIcon:!0,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},cell:{requireText:!0,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,
title:"COMMENT"},add:{requireText:!1,skipIfNoText:!0,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!0,textCls:"oit-anno-add",badgeCls:null,title:"INSERTED_TEXT"},"delete":{requireText:!1,skipIfNoText:!0,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:null,title:"DELETED_TEXT"},change:{requireText:!1,skipIfNoText:!0,showIcon:!1,showTo:!0,showFrom:!0,checkRanges:!0,textCls:"oit-anno-change",badgeCls:null,title:"CHANGED_TEXT"},move:{requireText:!1,skipIfNoText:!0,
showIcon:!1,showTo:!1,showFrom:!0,checkRanges:!0,textCls:"oit-anno-move",badgeCls:null,title:"MOVED_TEXT"},hidden:{requireText:!1,skipIfNoText:!0,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:"oit-badge-delete",title:"HIDDEN_TEXT"},add_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_ROW"},delete_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,
textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_ROW"},add_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_COLUMN"},delete_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_COLUMN"},new_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,
title:"NEW_CELL"},modify_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MODIFIED_CELL"},clear_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"CLEAR_CELL"},move_cells:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MOVED_CELLS"},add_sheet:{requireText:!1,
skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_SHEET"},rename_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showTo:!0,showFrom:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"RENAMED_SHEET"}},ud=function(){var d=/\S/,e="#ffbc2b #9439ae #61b34a #de2f40 #43bee6 #ef5f11 #0078ff".split(" "),b=['<div class="oit-annoblock"><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable oit-annotitle"> ',
M.ANNOTATIONS,'</span><span class="oit-sortselect"><span class="oit-unselectable">',M.SORT_BY,'</span><select name="oit-sort" class="oit-sort"><option value="location">',M.LOCATION,'</option><option value="author">',M.AUTHOR_A_TO_Z,'</option><option value="rauthor">',M.AUTHOR_Z_TO_A,'</option><option value="date">',M.OLDEST_FIRST,'</option><option value="rdate">',M.NEWEST_FIRST,'</option><option value="type">',M.ANNOTATION_TYPE,"</option></select></span></div></div>"].join(""),a=function(a){T.call(this,
"div","oit-annopane");this._page=a;this._annos=[];this._groups=[];this._newGroups=[];this._groupOffsets=[];this._badgeColorIndex=0;this._authorColors={};this._showLeader=!0;this._batches=[];this._needLayout=!0;this.html(b);this._block=this.byClass("oit-annoblock")[0];this._header=this.byClass("oit-annoheader")[0];this._title=this.byClass("oit-annotitle")[0];this._commentIcon=this.byClass("oit-commentsicon")[0];this._sortSpan=this.byClass("oit-sortselect")[0];this._sortSelect=this.byClass("oit-sort")[0];
this._scrollPane=new Ad;this._block.append(this._scrollPane);this.onclick(z.deactivateAnnotation);this.ontap(z.deactivateAnnotation);this._sortSelect.onchange(this,D);this._scrollPane.onscroll(this,Y);ha.onresize(this,Y);F.onzoom(this,Y);this._isHidden=!0;this.css("display","none");this.attach()},c=W(a,T);c.destroy=function(){this._scrollPane.offscroll(this,Y);F.offzoom(this,Y);ha.offresize(this,Y);F.offidle(this,p);F.offidle(this,R);for(var a=0;a<this._newGroups.length;a++)this._newGroups[a].groupDiv.destroy();
T.prototype.destroy.call(this)};c.update=function(){this.isHidden()||this._resizeTimer||(Y.call(this),this.layout(),this.scrollPane().update())};var f=function(a){var b=100;0<a._batches.length?b=0:0<a._newGroups.length&&(b=a._groups.length/(a._newGroups.length+a._groups.length),b=Math.floor(100*b));100<=b?a._title.text(M.ANNOTATIONS):a._title.text(M.LOADING+" ("+b+"%)")};c.isLoading=function(){return 0<this._batches.length||0<this._newGroups.length};c.isEmpty=function(){return 0===this._annos.length&&
0===this._batches.length&&0===this._newGroups.length};c.toolbarMode=function(a){!0===a?this._toolbarMode=!0:delete this._toolbarMode};c.attach=function(){if(!this.parent()){var a=this._page;if(a.supportsAnnotationPane()){var b=a.parent();b&&(a.nextSiblingElem()?b.insert(this,a.nextSiblingElem()):b.append(this))}}};c.range=function(){return this._range};var h=function(a,b){var c=!1;if(a)if(Array.isArray(a))for(var d=0;d<a.length&&!(c=h(a[d],b));d++);else a.range&&(c=bb(a.range,b));return c},q=function(a,
b){var c=a.anno;return h(c.text,b)||h(c.oldtext,b)||h(c.last_save_date||c.create_date||c.date,b)||h(c.author,b)},t=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)t(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=Z.getRawText(a.range.acc,a.range.accend))},u=function(a,b,c,d){var e=null,f;if("string"===typeof b)e=y.create("p"),c.append(e),f=y.create("span"),e.append(f),v(a,b,f);else if(Array.isArray(b))for(var g=!0,h=0;h<b.length;h++){var k=b[h];k.range&&d&&(g=a._page.containsRange(k.range));
g&&(e||(e=y.create("p"),c.append(e)),t(k),k.text?(f=y.create("span"),e.append(f),v(a,k,f)):e=null)}},v=function(a,b,c){b&&("string"===typeof b?(c.attr("data-acc","none"),c.addClass("oit-noacc"),c.text(b)):b.text&&(b.range&&b.range.acc?(c.attr("data-acc",b.range.acc),a._range?(b.range.acc<a._range.acc&&(a._range.acc=b.range.acc),b.range.accend>a._range.accend&&(a._range.accend=b.range.accend)):a._range=ea(b.range)):(c.attr("data-acc","none"),c.addClass("oit-noacc")),c.text(b.text),b.b&&c.css("font-weight",
"bold"),b.i&&c.css("font-style","italic")))},p=function(){if(0<this._batches.length){var a=this._batches.shift();if(a&&0<a.length){for(var b=this._page,c=b.overlay?b.overlay.layer("comments"):void 0,h,l=0;l<a.length;l++){var m=a[l],q=Qb[m.type],r=!!q;if(q&&q.skipIfNoText){var t=m,w=!1;if(t.text)for(h=0;h<t.text.length;h++){var x=t.text[h];if(x.text&&d.test(x.text)){w=!0;break}}w||(r=!1)}if(r&&m.range){t=r=null;if(m.parentid)for(w=0;w<this._annos.length;w++)if(h=this._annos[w],h.anno.id==m.parentid){r=
h;t=h.groupInfo;break}t||(t={groupDiv:y.create("div","oit-annogroup"),annos:[]},this._newGroups.push(t));w=y.create("div","oit-anno");w.attr("id","oita"+m.id);h=y.create("div","oit-anno-text");if(x=q.title)switch(x=M[x],m.type){case "add_row":x+=" "+Ya(m.range.r1);break;case "delete_row":x+=" "+Ya(m.range.r1);break;case "add_col":x+=" "+Va(m.range.c1);break;case "delete_col":x+=" "+Va(m.range.c1);break;case "cell":x+=" "+nb(m.range);break;case "new_cell":x+=" "+nb(m.range);break;case "modify_cell":x+=
" "+nb(m.range);break;case "clear_cell":x+=" "+nb(m.range);break;case "move_cells":x+=" "+nb(m.oldrange)+" to "+nb(m.range)}if(q.showFrom&&m.oldtext){if(q.showTo){var z=y.create("div","oit-anno-change-sep oit-noacc");z.attr("data-acc","none");z.text(M.ANNO_CHANGE_FROM);h.append(z)}u(this,m.oldtext,h,q.checkRanges);q.showTo&&(z=y.create("div","oit-anno-change-sep oit-noacc"),z.attr("data-acc","none"),z.text(M.ANNO_CHANGE_TO),h.append(z))}if(q.showTo)if(m.text)u(this,m.text,h,q.checkRanges);else if(q.requireText){z=
y.create("p","oit-noacc oit-unsupportedcontent");z.attr("data-acc","none");var B=y.create("span");B.text(M.UNSUPPORTED_CONTENT);z.append(B);h.append(z)}z=y.create("div","oit-anno-meta");if(B=m.last_save_date||m.create_date||m.date){var D=null;"string"===typeof B?D=Bb(B):B.text&&(D=Bb(B.text));if(D){var G=y.create("span","oit-anno-date");D===B.text?v(this,B,G):(G.text(D),G.addClass("oit-noacc"),G.attr("data-acc","none"));z.append(G)}}D="";B=null;m.author&&(D=y.create("span","oit-anno-author"),v(this,
m.author,D),z.append(D),D=D.text().trim(),0<D.length&&(B=this._authorColors[D],B||(this._authorColors[D]=B=e[this._badgeColorIndex++],this._badgeColorIndex>=e.length&&(this._badgeColorIndex=0)),D=D.charAt(0).toUpperCase()));if(x){G=y.create("div","oit-anno-type oit-noacc");G.attr("data-acc","none");if(D){var H=y.create("div","oit-badge");B&&H.css("background",B);H.text(D);G.append(H)}H=y.create("span");H.text(x);G.append(H);w.append(G)}w.append(h,z);t.groupDiv.append(w);h={anno:m,annoDiv:w,groupInfo:t};
t.annos.push(h);w.onclick(this,g,h);w.ontap(this,g,h);"text"===m.range.type?(h.spans=ub(b,m.range,q.textCls,m.id,"page"),r||(h.badge=new nd(b.index,c,q.badgeCls,D),B&&h.badge.css("background",B),h.badge.onclick(this,k,h),h.badge.ontap(this,k,h),h.badge.onmouseover(this,C,h),h.badge.onmouseout(this,K,h),h.badge.hide())):q.showIcon&&(r?(h.parent=r,h.icon=r.icon,r.icon.removeClass("oit-commenticon"),r.icon.addClass("oit-commenticonmulti"),r.icon.resetDefaultSize(),m=r.icon.defaultSize(),r.icon.move(void 0,
void 0,m.width,m.height)):(m=new md(b.index,c,"oit-commenticon"),t.groupDiv.data("commenticon",m),m.data("comment",t.groupDiv),m.onclick(this,k,h),m.ontap(this,k,h),m.onmouseover(this,C,h),m.onmouseout(this,K,h),h.icon=m,m.hide()));h.index=this._annos.length;this._annos.push(h)}}V(this)}O(this,!0);this.update()}0===this._batches.length&&(F.offidle(this,p),this._processingBatches=!1,this.layout(),this._processBatchCallbackFn&&(this._processBatchCallbackFn(this,this._processBatchCallbackArg),delete this._processBatchCallbackFn,
delete this._processBatchCallbackArg));f(this)};c.processAnnotations=function(a,b,c){if(a){if(500>=a.length)this._batches.push(a);else for(var d=0;d<a.length;d+=500){var e=d+500;e>a.length&&(e=a.length);e=a.slice(d,e);this._batches.push(e)}this._processingBatches||(this._processingBatches=!0,b&&(this._processBatchCallbackFn=b,this._processBatchCallbackArg=c),F.onidle(this,p),p.call(this));f(this)}};c.show=function(){this.attach();if(this.parent()){this._isHidden=!1;this.css("display",null);for(var a=
0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&("slide"!==b.anno.type&&b!==this._activeAnno||b.icon.show());b.badge&&b.badge.show();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.onclick(this,k,b);d.ontap(this,k,b);d.onmouseover(this,C,b);d.onmouseout(this,K,b)}}V(this);O(this);this.update()}};c.hide=function(){this._isHidden=!0;this.css("display","none");for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&b.icon.hide();b.badge&&b.badge.hide();
if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.offclick(this,k);d.offtap(this,k);d.offmouseover(this,C);d.offmouseout(this,K)}}B(this)};c.isHidden=function(){return!!this._isHidden};c.panelRect=function(a){return z.elementRect(this._scrollPane,a)};c.contentRect=function(a){return z.elementRect(this._scrollPane.content,a)};c.getSpanMap=function(){this._spanMap||(this._spanMap=new Pc(this._page,this._scrollPane.content));return this._spanMap};c.scrollPane=function(){return this._scrollPane};
c.findACC=function(a){var b=this.getSpanMap();if(b)return b.findACC(a)};c.findRange=function(a,b){var c=this.getSpanMap();if(c)return c.findRange(a,b)};c.mapPointToSpan=function(a,b,c){var d=this.getSpanMap();if(d)return d.mapPointToSpan(a,b,c)};c.containsRange=function(a){var b=!1;"text"===a.type&&this._range&&a.acc<=this._range.accend&&a.accend>=this._range.acc&&(a.acc===a.accend?b=!!this.findACC(a.acc):(a=this.findRange(a.acc,a.accend),void 0!==a&&0<a.length&&(b=!0)));return b};c.annoRect=function(a,
b,c){var d=null,e;c||(c=a.anno.annoRange||a.anno.range);if(a.spans||a.anno.embeds){if(a.spans)for(var f=0;f<a.spans.length;f++)(e=a.spans[f].textRect(c))&&(d?b?e.bottom>d.bottom?d=e:e.bottom==d.bottom&&d.union(e):d.union(e):d=e);if(a.anno.embeds)for(b=0;b<a.anno.embeds.length;b++)(e=this._page.embeddingRect(a.anno.embeds[b].uid))&&(d?d.union(e):d=e)}else if(a.icon)(e=a.icon.isHidden())&&a.icon.show(),d=new la(a.icon.rect(w.viewNode),"view"),e&&a.icon.hide();else if("cell"===c.type)switch(a.anno.type){case "add_sheet":case "rename_sheet":d=
z.overlayTabRect(this._page.overlay);break;case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":d=G.rangeRect(c,"view");break;default:d=G.expandRange(c),d=G.rangeRect(d,"view")}else d=G.rangeRect(c,"view",!1,"page"),d||"text"!==c.type||(a=this._page.frameForRange(c))&&(a=a.firstChildElem())&&"DIV"===a.tagName&&(d=a.rect(w.viewNode),d=new la(d,"view"),d.width=0,d.height=0);return d};c.annoTextHeight=function(a,b){var c=
0;if(a.spans){for(var d,e=0;e<a.spans.length;e++){var f=a.spans[e].textRect(a.anno.range);f&&(!d||f.bottom>d.bottom?d=f:f.bottom==d.bottom&&d.union(f))}d&&(d.origin=b,c=d.height)}return c};var l=function(a,b){var c=a.annos[0],d=b.annos[0],c=Xa(c.anno.annoRange||c.anno.range,d.anno.annoRange||d.anno.range);0===c&&(c=H(a,b));return c},m=function(a,b){return-l(a,b)},H=function(a,b){var c=a.annos[0].anno,d=b.annos[0].anno,c=c.last_save_date||c.create_date||c.date,d=d.last_save_date||d.create_date||d.date;
c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=a.annos[0].index-b.annos[0].index);return e},I=function(a,b){return-H(a,b)},L=function(a,b){var c=a.annos[0].anno.author,d=b.annos[0].anno.author;c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=H(a,b));return e},J=function(a,b){return-L(a,b)},N=function(a,b){var c=a.annos[0].anno.type,
d=b.annos[0].anno.type,e=Qb[c],f=Qb[d];e&&e.title&&(c=M[e.title]);f&&f.title&&(d=M[f.title]);e=0;c&&d&&(e=c.localeCompare(d));0===e&&(e=l(a,b));return e},D=function(){var a=y.unwrap(this._sortSelect),a=a.item(a.selectedIndex);x.annotationSort=a?a.value:"index"};c.applySort=function(a){var b=x.annotationSort;if(!this.isLoading()&&(a||b!==this._sort)){this._sort=b;switch(b){case "date":a=H;break;case "rdate":a=I;break;case "rlocation":a=m;break;case "author":a=L;break;case "rauthor":a=J;break;case "type":a=
N;break;default:a=l}this._groups.sort(a);for(a=this._groups.length-1;0<=a;a--)this._groups[a].groupDiv.detach();for(a=0;a<this._groups.length;a++)this._scrollPane.content.append(this._groups[a].groupDiv);y.unwrap(this._sortSelect).value=b;delete this._spanMap;this._groupOffsets=[];this.update()}};var O=function(a,b){if(!a.isHidden())if(a.isLoading()||2>a._annos.length)a._showSort=!1,delete a._headerWidth,a._sortSpan.css("display","none");else{var c=a._header.clientWidth;if(b||!a._headerWidth||a._showSort&&
c<a._headerWidth||!a._showSort&&c>a._headerWidth){a._sortSpan.css("display",null);var c=a._sortSpan.pos(a._header),d=a._commentIcon.rect(a._header),e=!0;c.top>=d.bottom&&(e=!1);e||a._sortSpan.css("display","none");a._showSort=e}}};c.onResize=function(a){var b=this._header.clientWidth;if(!0===a||b!=this._headerWidth){this._headerWidth=b;if(this._resizeTimer)sa(this._resizeTimer);else for(a=0;a<this._groups.length;a++)b=this._groups[a],b.visible&&b.groupDiv.css("height",null);this._resizeTimer=ca(function(){this._groupOffsets=
[];for(var a=0;a<this._groups.length;a++){var b=this._groups[a];b.height&&(b.groupDiv.css("height",null),delete b.height)}this._spanMap&&this._spanMap.discardLayout();O(this);delete this._resizeTimer;this.update()},100,this)}};c.layout=function(){var a=this._page,b=a.pageRect("overlay");if(!a.parent()||!this.parent()||this.isHidden())this.css("display","none");else if(this&&b){delete this._needLayout;var c,d,e=x.zoom;this._toolbarMode?this.css({top:null,left:null,height:null,display:null}):(this.css({top:b.top/
e+"px",left:b.right/e+"px",height:b.height/e+"px",display:null}),150>b.height?(this._header.css("display","none"),this._scrollPane.css("top","0")):(this._header.css("display",null),this._scrollPane.css("top",null)));this._scrollPane.update();a.pagePos("overlay");for(e=0;e<this._annos.length;e++){var f=this._annos[e];if(f.badge){var g=this.annoRect(f,!1);if(g){g.origin="overlay";c=b.left+5;d=(g.top+g.bottom)/2-10;var g=b.bottom-20-5,h;do{if(d>g)break;for(var k=h=0;k<e;k++)if(k!=e&&this._annos[k].badge){var l=
this._annos[k].badge.position(),m=l.bottom- -2;d>l.top-l.height+-2&&d<m&&(d=m,h++)}}while(h&&20>=h);d>g||20<h?(f.badge.destroy(),delete f.badge):(f.badge.show(),f.badge.move(c,d))}else f.badge.hide()}if(f.icon&&!f.parent){if(f.anno.range)switch(f.anno.range.type){case "rect":c=f.anno.range.left;d=f.anno.range.top;break;case "text":if(g=G.rangeRect(f.anno.range,a))c=g.left,d=g.top,f.icon.css("opacity",.3)}else c=f.anno.x,d=f.anno.y;void 0!==c&&void 0!==d&&(g=new la(c,d,c+20,d+20,a),0>g.left?g.left=
0:g.right>a.width&&(g.right=a.width),0>g.top?g.top=0:g.bottom>a.height&&(g.bottom=a.height),g.origin="overlay",f.icon.move(g.left,g.top),this._isHidden||"slide"!==f.anno.type&&f!==this._activeAnno||f.icon.show())}}}};var B=function(a){a._hasUpdateListener||(ha.onupdate(a,r),a._hasUpdateListener=!0);ha.invalidateCanvas()};c.showLeader=function(a){!1!==a&&(a=!0);a!==this._showLeader&&(this._showLeader=!1!==a,ha.invalidateCanvas())};var r=function(a){if(!this._isHidden&&x.showAnnotations&&this._activeAnno){var b=
this._activeAnno;if(b&&this._showLeader){var c;if(b.anno.oldrange&&"cell"===b.anno.oldrange.type){var d=S.cellSelection(),e=b.anno.annoRange||b.anno.range,f=b.anno.oldrange;d&&!bb(d,e)&&bb(d,f)&&(c=f)}if(d=this.annoRect(b,!0,c)){e=w.rootNode;f=w.viewNode;c=f.rect(e);d.origin="view";d.offset(c.left,c.top);var g=d.left,h=d.top,k=d.right,l=d.bottom;0>g&&0<k&&(g=0);k>f.clientWidth&&g<f.clientWidth&&(k=f.clientWidth);0>h&&0<l&&(h=0);l>f.clientHeight&&h<f.clientHeight&&(l=f.clientHeight);d.move(g,h,k,l);
k=b.annoDiv.rect(e);0===k.height&&(k=b.groupInfo.groupDiv.rect(e));G.padding();var m=10;b.spans&&(m=.7*this.annoTextHeight(b,"view"),10>m?m=10:40<m&&(m=40));var p,q,r;p="cell"===b.anno.range.type;q="add_sheet"===b.anno.type||"rename_sheet"===b.anno.type;var h=!1,l=!0,t=k.top+20,u=k.bottom-20,f=k.left,g=t,b=f-10;if(p)h=!0,q?(m=(d.right+d.left)/2,p=d.top,q=m,r=p-10,l=!1):(m=d.right+2,p=d.top+d.height/2,q=m+10,q>b&&(q=m),r=p);else{var v=d.top-m;r=d.bottom+m;m=(d.right+d.left)/2;p=d.bottom;q=m;var y=
this._page.pageRect("view").clone();y.offset(c.left,c.top);if(r>=y.bottom||g<p&&v>y.top)p=d.top,r=v;g=r>u?u:r<t?t:r}e=this._scrollPane.rect(e);g<e.top?g=e.top:g>e.bottom&&(g=e.bottom);d=!0;g<k.top?(g=e.bottom,d=!1):g>k.bottom&&(g=e.top,d=!1);l&&q>=b&&(q=m,r=p,b=f);if(m<f||!l)a.save(),e=w.rootNode.rect(),e=e.right-e.left-c.left,a.beginPath(),a.rect(c.left,c.top,e,c.bottom-c.top),a.clip(),a.beginPath(),h&&a.arc(m,p,2,0,2*Math.PI,!0),a.moveTo(m,p),a.lineTo(q,r),a.lineTo(b,g),d&&a.lineTo(f,g),a.strokeStyle=
"rgba(255,255,255,0.1)",a.lineWidth=9,a.stroke(),a.strokeStyle="rgba(255,255,255,0.3)",a.lineWidth=7,a.stroke(),a.strokeStyle="rgba(255,255,255,0.5)",a.lineWidth=5,a.stroke(),a.strokeStyle="rgba(0,0,0,0.25)",a.lineWidth=3,a.stroke(),a.restore()}}}};c.deactivate=function(a,b){this.activate(null,!1,!1,a,b)};c.activate=function(a,b,c,d,e){var f=this;if(f._activating)d&&d(e);else if(f._annos){!1!==b&&(b=!0);var g,h,k;if(a)if(h=wa(a))for(k=0;k<f._annos.length;k++){if(q(f._annos[k],h)){g=f._annos[k];break}}else if(a.anno&&
a.groupInfo.groupDiv)g=a;else if(a.id)for(k=0;k<f._annos.length;k++)if(f._annos[k].anno===a){g=f._annos[k];break}if(g)z.deactivateAnnotation(),f._activating=g,x.showAnnotations||(x.showAnnotations=!0),z.movetoEx(this._page.index,{animate:!0,callbackFn:function(){z.scrollToAnnotationPane(function(){f._activeAnno=g;z.activeAnnotationPane(f);if(g.spans||g.anno.embeds){if(g.spans)for(var a=0;a<g.spans.length;a++)g.spans[a].addClass("oit-active")}else g.icon&&(g.icon.show(),g.icon.activate());B(f);g.annoDiv.addClass("oit-active");
if(b){var k;h&&(k=f.getSpanMap().findRange(h.acc,h.accend));if(k){for(var l,a=0;a<k.length;a++){var m=k[a].textRect(h);m&&(l?l.union(m):l=m)}l&&(l.origin=f._scrollPane.content,l.scale(1/x.zoom),f._scrollPane.scrollIntoView(l))}else f._scrollPane.scrollIntoView(g.groupInfo.groupDiv),f._scrollPane.scrollIntoView(g.annoDiv)}if(k=g.anno.annoRange||g.anno.range)if(G.moveto(k),c&&"cell"===k.type&&"add_sheet"!==g.anno.type&&"rename_sheet"!=g.anno.type){k=(l=S.cellSelection())&&g.anno.oldrange&&!bb(l,k)&&
bb(l,g.anno.oldrange)?ea(g.anno.oldrange):ea(k);switch(g.anno.type){case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":k.autoExpand=!1}P.pauseAutoHighlight(!0);S.select(k);P.pauseAutoHighlight(!1)}d&&d(e);delete f._activating})}});else{a=f._activeAnno;f._activeAnno=null;if(a){if(a.spans||a.anno.embeds){if(a.spans)for(k=0;k<a.spans.length;k++)a.spans[k].removeClass("oit-active")}else a.icon&&(a.icon.deactivate(),
"slide"!==a.anno.type&&a.icon.hide());B(f);a.annoDiv.removeClass("oit-active");z.activeAnnotationPane(null);a=null}d&&d(e)}}};var g=function(a,b){this.activate(b,!1,!0);return!1},k=function(a,b){if(0===y.selectedText().length)return P.deactivate(),S.reset(),this.activate(b,!0,!0),!1},C=function(a,b){b.groupInfo.groupDiv.addClass("oit-hover")},K=function(a,b){b.groupInfo.groupDiv.removeClass("oit-hover")},R=function(){if(!this.isHidden()&&!this._needLayout){for(var a=0;30>a;a++){var b=this._newGroups.shift();
if(!b)break;this._scrollPane.content.append(b.groupDiv);this._groups.push(b)}this._scrollPane.update();f(this);Y.call(this);0===this._newGroups.length&&(this._processingGroups=!1,F.offidle(this,R),O(this,!0),this.applySort(!0),P.each("addToPage",null,this._page.index,!0))}},V=function(a){!a._processingGroups&&0<a._newGroups.length&&!a.isHidden()&&(a._processingGroups=!0,a._addGroupInterval=F.onidle(a,R),f(a),R.call(a))},Y=function(){if(!this._isHidden){var a,b,c;c=-1;for(a=0;a<this._groups.length;a++)if(b=
this._groups[a],!b.height&&(-1==c&&(c=a),!b.visible)){b.visible=!0;for(var d=0;d<b.annos.length;d++)b.annos[d].annoDiv.css("display",null)}d=0;if(-1!=c){var e=x.zoom;for(a=c;a<this._groups.length;a++)b=this._groups[a],void 0===b.height&&(c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top,d++,0<c.height&&(b.height=this._toolbarMode?c.height-1:c.height/e-1,b.groupDiv.css("height",b.height+"px")))}if(d<this._groups.length)for(a=0;a<this._groups.length;a++)void 0===this._groupOffsets[a]&&
(b=this._groups[a],c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top);this._groupOffsets[this._groups.length]=this._scrollPane.content.outerHeight;c=this.clientHeight;d=this._scrollPane.scrollTop;this._toolbarMode||(c*=x.zoom,d*=x.zoom);for(a=0;a<this._groups.length;a++)if(b=this._groups[a],e=this._groupOffsets[a]-d,e=0<this._groupOffsets[a+1]-d&&e<c,e!=b.visible)for(var e=(b.visible=e)?null:"none",f=0;f<b.annos.length;f++)b.annos[f].annoDiv.css("display",e);B(this)}};return a}(),
dd=function(){return function(){var d='<div><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable"> '+M.ANNOTATIONS+"</span></div></div>",e,b,a;this.show=function(){if(e&&a){var b=x.annoBarWidth;0<b?e.show({size:b}):e.show();a.show()}};this.hide=function(){e&&(a&&a.hide(),e.hide())};this.destroy=function(){za.offresizeinternal(this,f);z.offchange(this,c);x.offshowAnnotations(this,c);x.offannoBarWidth(this,c);e&&za.removeInternal(-3);b&&b.destroy();b=e=null};
var c=function(){var c=z.activePage(),c=c?c.annotationPane():null;c!==a&&(a&&(a.css("width",null),a.hide(),z.activeAnnotationPane(null),b.remove(a),a.toolbarMode(!1),a=null),a=c)&&(z.activeAnnotationPane(a),b.append(a),a.toolbarMode(!0),a.scrollPane().setScrollTop(0,!0));c=x.annoBarWidth;0>=c&&(c=void 0);e.applySize(c,void 0,!0);a&&x.showAnnotations?this.show():this.hide()},f=function(c,d,e,f,v){-3===c&&b&&a&&(0<e&&(x.annoBarWidth=e,e+="px",b.css("width",e),a.css("width",e)),a.showLeader(!v),a.onResize(),
ha.invalidateCanvas())};b=y.create("div","oit-annobar");e=new Rb(-3,"right",b,null,za.internalParent(-3));e.resizable(!0,60,30,d);za.addInternal(-3,e);za.onresizeinternal(this,f);z.onchange(this,c);x.onshowAnnotations(this,c);x.onannoBarWidth(this,c);c.call(this)}}(),Vb=function(){function d(a,b){var c=a,d;for(d in b)if(b.hasOwnProperty(d))var e=b[d],c=c.replace(new RegExp(("{"+d+"}").replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),e);return c}var e=function(a){if(!a)return this.logError("OIMultimedia",
"missing options argument"),null;if("string"!==typeof a.url)return this.logError("OIMultimedia","url is missing or not a string"),null;this._url=a.url;this._display=a.display||"multimedia";this._didPlay=this._didFallback=this._didWarn=!1;this._failedToPlay=this._canPlay=null;T.call(this,a.tag,a.selector,a.parentNode);this.attr("controls","");this.attr("controlsList","noDownload");var b=Na.getOptions().disableCaching?"?t="+(new Date).getUTCMilliseconds():"";this.html("<source src="+a.url+b+"></source>");
y.attach(this);this._origin=null;this.hide();this._registerListeners()},b=W(e,T);b.load=function(){Na.load(this)};b._registerListeners=function(){var a=this;this._failedToPlay=function(){a.onFailedToPlay.apply(a,arguments)};this._canPlay=function(){a.onCanPlay.apply(a,arguments)};this._internalError=function(){a.onInternalError.apply(a,arguments)};this._missingContent=function(){a.onMissingContent.apply(a,arguments)};Na.on.failedToPlay.listen(this._failedToPlay);Na.on.canPlay.listen(this._canPlay);
Na.on.internalError.listen(this._internalError);Na.on.missingContent.listen(this._missingContent)};b.onFailedToPlay=function(a,b){if(a===this)if(this._didPlay&&!this._didWarn){this._didWarn=!0;var c=new Nb({title:M.MULTIMEDIA_PLAYBACK_WARNING_TITLE,collapseButton:!0});c.message(M.MULTIMEDIA_PLAYBACK_WARNING_MESSAGE);c.expand(!0)}else this._didPlay||this.fallback(M.MULTIMEDIA_UNSUPPORTED_FORMAT)};b.onMissingContent=function(a,b){if(a===this){var c;switch(b){case Na.MissingContentStatus.MISSING_AUDIO:c=
{STREAM_TYPE:M.MULTIMEDIA_AUDIO,STREAM_TYPE_IND:M.MULTIMEDIA_AUDIO_IND};break;case Na.MissingContentStatus.MISSING_VIDEO:c={STREAM_TYPE:M.MULTIMEDIA_VIDEO,STREAM_TYPE_IND:M.MULTIMEDIA_VIDEO_IND};break;default:c={STREAM_TYPE:M.MULTIMEDIA,STREAM_TYPE_IND:M.MULTIMEDIA_IND}}var e=d(M.MULTIMEDIA_MISSING_STREAM_TITLE_FMT,c);c=d(M.MULTIMEDIA_MISSING_STREAM_MESSAGE_FMT,c);e=new Nb({title:e,collapseButton:!0});e.message(c);e.expand(!0)}};b.onInternalError=function(a,b){a===this&&(Na.on.failedToPlay.unlisten(this._failedToPlay),
this.fallback(M.MULTIMEDIA_INTERNAL_ERROR))};b.onCanPlay=function(a){a===this&&(this._didPlay=!0,Na.on.canPlay.unlisten(this._canPlay),this.show())};b.fallback=function(a){this._didFallback||(this._didFallback=!0,this.handleFallback(a))};b.handleFallback=function(a){a=a||M.MULTIMEDIA_UNSUPPORTED_FORMAT;this.hide();var b=new T("div","oit-multimedia-fallback",this.parent());b.html(a);this.parent().append(b)};return e}(),sd=function(){var d=function(d,b){Vb.call(this,{url:d,tag:"audio",display:"audio",
selector:"oit-audio",parentNode:b})};W(d,Vb);return d}(),Qc=function(){var d=function(d,b){Vb.call(this,{url:d,tag:"video",display:"video",selector:"oit-video",parentNode:b})};W(d,Vb);return d}(),Nb=function(){var d,e=function(){if(d){var a=w.viewNode,a=a.offsetHeight-a.clientHeight;0===a?d.css("bottom",null):d.css("bottom",a+"px")}};ha.onresize(e);F.onzoom(e);var b=function(a){a=a||{};T.call(this,"div","oit-toast");a.className&&this.addClass(a.className);var b=[];a.collapseButton&&b.push('<input class="oit-collapsebutton" type="button" value="&#x25bc;">');
a.closeButton&&b.push('<input class="oit-closebutton" type="button" value="x">');b.push('<div class="oit-title"></div><div class="oit-body"></div>');this.html(b.join(""));a.collapseButton&&(this.prop("collapseButton",this.childByClass("oit-collapsebutton")),this.collapseButton.onclick(this,u),this.collapseButton.ontap(this,u));a.closeButton&&(this.prop("closeButton",this.childByClass("oit-closebutton")),this.closeButton.onclick(this,p),this.closeButton.ontap(this,p));this.prop("titletext",this.childByClass("oit-title"));
this.prop("messagetext",this.childByClass("oit-body"));this._collapsed=!0;this.onclick(this,v);this.ontap(this,v);this.onmouseenter(this,f);this.onmouseleave(this,h);y.attach(this);d||(d=y.create("div","oit-toastpane"),w.viewNode.parent().append(d),e());b=d.firstChildElem();a.collapseButton||!b?d.append(this):d.insert(this,b);a.title&&this.title(a.title);a.content&&this.message(a.content)},a=W(b,T);a.customEvent("expand");a.customEvent("collapse");var c=function(a){a._collapsed?a._colSize&&a.css({width:a._colSize.width+
"px",height:a._colSize.height+"px"}):a._expSize&&a.css({width:a._expSize.width+"px",height:a._expSize.height+"px"})};a.title=function(a){if(void 0!==a){this.titletext.html(a);a=this.attr("class");var b=this.css("display");this.attr("class","oit-toast");this.css("display",null);this.css({width:null,height:null});this._colSize={width:this.innerWidth,height:this.innerHeight};c(this);this.attr("class",a);this.css("display",b)}return this.titletext.html()};a.message=function(a){if(void 0!==a){this.messagetext.html(a);
a=this.attr("class");var b=this.css("display");this.attr("class","oit-toast oit-expanded");this.css("display",null);this.css({width:null,height:null});this._expSize={width:this.innerWidth,height:this.innerHeight};c(this);this.attr("class",a);this.css("display",b)}return this.messagetext.html()};a.isCollapsed=function(){return this._collapsed};a.hide=function(a){this._hidden||this._pendingHidden?a&&a():(this._pendingHidden=!0,this._hideCallback=a)};a.hideNow=function(){this._hidden=!0;this._pendingHidden=
!1;this.animate({opacity:0,time:300,endCSS:{display:"none"},endFn:this._hideCallback})};a.show=function(){if(this._hidden||this._pendingHidden)this._pendingHidden=this._hidden=!1,this.css("display",null),delete this._hideCallback};var f=function(){this._mouse=!0},h=function(){this._mouse=!1;this._pendingHidden&&this.hideNow()},q=function(){this.offtransitionend(q);this._tto&&(sa(this._tto),delete this._tto);this.removeClass("oit-collapsing");this.dispatchCustom("collapse",{});gb()};a.collapse=function(a){if(this._collapsed)return!1;
this._tto&&sa(this._tto);this._collapsed=!0;!1===a?(this.removeClass("oit-expanded"),c(this),this.dispatchCustom("collapse",{})):(this.addClass("oit-collapsing"),this.removeClass("oit-expanded"),this.ontransitionend(q),ca(function(){c(this)},0,this),this._tto=ca(function(){delete this._tto;q.call(this)},400,this));gb();return!0};var t=function(){this.offtransitionend(t);this._tto&&(sa(this._tto),delete this._tto);this.addClass("oit-expanded");this.removeClass("oit-expanding");this.dispatchCustom("expand",
{});gb()};a.expand=function(a){if(!this._collapsed)return!1;this._tto&&sa(this._tto);this._collapsed=!1;!1===a?(this.addClass("oit-expanded"),c(this),this.dispatchCustom("expand",{})):(this.addClass("oit-expanding"),this.ontransitionend(t),c(this),this._tto=ca(function(){delete this._tto;t.call(this)},400,this));gb();return!0};var u=function(a){if(this.collapse())return!1},v=function(a){if(this.expand())return!1},p=function(a){this.hideNow()};F.onreset(function(){d&&(d.destroy(),d=null)});return b}();
w.libversion="2018.7.0.494";(function(d){Pa.install.dispatch();Pa.install.reset();R.addEventListener("load",function(){Pa.init.dispatch();Pa.init.reset()})})(!1)})(window,document);
//# sourceURL=oit.js 
