/*
 oit.js 
 Portions (C) 1991, 2016, Oracle Corp, and (C) 2017, Relativity ODA LLC. 
 Version 2018.3.0.354 
*/
(function(Q,Y){var Qb,Rb;if(Q.OIT){var ha=Q.OIT.view;ha&&(ha.detach?ha.detach():ha.unload&&ha.unload())}Q.OIT=function(){var d={};Object.defineProperties(d,{uninstall:{value:function(){fc&&fc(this)},writable:!0}});return d}();var X=function(d,e){e||(e=Kc);return d.prototype=Object.create(e.prototype)},fc=function(){if(Q.OIT){var d=Q.OIT.view;d&&d.detach();Q.OIT=void 0}},nb=function(d,e,a){Object.defineProperty(OIT,d,{value:e,writable:!!a})},y=function(){var d=/^[.#\w][-_\.\w\d]*$/,e=("oit"+Math.random()).replace(/\W/g,
""),a=[],c=1,b=function(a){if(d.test(a)){if(0===a.lastIndexOf("#",0))return b.byId(a.slice(1));if(0===a.lastIndexOf(".",0))return b.byClass(a.slice(1));if(0===a.indexOf(" "))return b.byTagName(a)}return b.bySelector(a)};Object.defineProperties(b,{html:{get:function(){return b.wrap(Y.documentElement)}},body:{get:function(){return b.wrap(Y.body)}},head:{get:function(){return b.wrap(b.html.childByTagName("head"))}},expando:{value:e}});b.byId=function(a){return b.wrap(Y.getElementById(a))};b.byClass=
function(a){return b.wrap(Y.getElementsByClassName(a))};b.byTagName=function(a){return b.wrap(Y.getElementsByTagName(a))};b.bySelector=function(a){return b.wrap(Y.querySelectorAll(a))};b.attach=function(a){(a=b.wrap(a))&&a.data("_elem",a);return a};b.detach=function(a){a&&b.removeData(a,"_elem")};b.query=function(a){return b.data(a,"_elem")};b.isElement=function(a){return a&&(a.dom||1===a.nodeType)};b.isText=function(a){return a&&3===a.nodeType};b.isDescendantOf=function(a,c){a=b.unwrap(a);if(c=b.unwrap(c))for(;a&&
a.parentNode;){if(a.parentNode===c)return!0;a=a.parentNode}return!1};b.nodeIndex=function(a){a=b.unwrap(a);for(var c=0;;){a=a.previousSibling;if(!a)break;++c}return c};b.unwrap=function(a){a&&a.dom&&(a=a.dom);return a};b.wrap=function(a){if(a){var c;if(!b.isElement(a)&&0<=a.length&&("function"===typeof a.item?c=[]:Array.isArray(a)&&(c=a),c)){for(var d=0;d<a.length;d++)c[d]=b.wrap(a[d]);0===c.length&&(c=null);return c}if(a.tagName&&!a.dom)return(c=b.query(a))||(c=new L(a)),c}return a};b.acceptsData=
function(a){return a&&(1===a.nodeType||9===a.nodeType)};b.data=function(d,f,k){d=b.unwrap(d);if(b.acceptsData(d)&&f){var m=d[e];if(void 0!==k){if(!m){do m=c++;while(void 0!==a[m]);Object.defineProperty(d,e,{value:m})}a[m]||(a[m]={});a[m].domNode=b.nodeToString(d);return a[m][f]=k}var p;m&&(k=a[m])&&(p=k[f]);void 0===p&&d.getAttribute&&(p=d.getAttribute("data-"+f),null===p&&(p=void 0));return p}};b.destroyData=function(d){d=b.unwrap(d);b.acceptsData(d)&&(d=d[e])&&(a[d]=void 0,d<c&&(c=d))};b.removeData=
function(c,d){c=b.unwrap(c);if(b.acceptsData(c)){var f=c[e];if(f)if(d){if(f=a[f]){delete f[d];var m;a:{for(m in f)if(Object.prototype.hasOwnProperty.call(f,m)){m=!0;break a}m=!1}m||b.removeData(c)}}else a[f]=void 0}c&&c.removeAttribute&&c.removeAttribute("data-"+d)};b.removeSubtreeData=function(a){b.removeData(a);for(a=a.firstElementChild;a;a=a.nextElementSibling)b.removeSubtreeData(a)};b.reset=function(){var d,e;for(e in a){var f=a[e];f&&(b.logUnreleasedData&&b.logUnreleasedData(f),d||(d=[]),d[e]=
f)}d?a=d:(a=[],c=1)};b.hasClass=function(a,c){if(Array.isArray(c)){for(var d=0;d<c.length;d++)if(b.hasClass(a,c[d]))return!0;return!1}if(a=b.unwrap(a)){if(a.classList)return a.classList.contains(c);if(a.getAttribute&&(d=a.getAttribute("class")))return d=" "+d+" ",c=" "+c.trim()+" ",-1!=d.indexOf(c)}return!1};var f=function(a,c){if(a.classList)a.classList.add(c);else if(a.getAttribute&&!b.hasClass(a,c)){var d=a.getAttribute("class");a.setAttribute("class",d+(" "+c))}};b.addClass=function(a,c){if((a=
b.unwrap(a))&&c){var d;if(Array.isArray(c))for(d=0;d<c.length;d++)f(a,c[d]);else if(-1!=c.indexOf(" "))for(c=c.split(" "),d=0;d<c.length;d++)f(a,c[d]);else f(a,c)}};var k=function(a,b){if(a.classList)a.classList.remove(b);else if(a.getAttribute){var c=a.getAttribute("class").replace(b,"");a.setAttribute("class",c)}};b.removeClass=function(a,c){if((a=b.unwrap(a))&&c){var d;if(Array.isArray(c))for(d=0;d<c.length;d++)k(a,c[d]);else if(-1!=c.indexOf(" "))for(c=c.split(" "),d=0;d<c.length;d++)k(a,c[d]);
else k(a,c)}};b.create=function(a,b,c,d){return new L(a,b,c,d)};b.createText=function(a){return Y.createTextNode(a)};b.listen=function(){return Y.addEventListener.apply(Y,arguments)};b.unlisten=function(){return Y.removeEventListener.apply(Y,arguments)};b.cursor=function(a){void 0!==a&&(Y.body.style.cursor=a);return Y.body.style.cursor};b.clearSelection=function(){Q.focus();if(Q.getSelection){var a=Q.getSelection();null!==a&&a.removeAllRanges()}};b.selectRange=function(a,b,c,d){Q.focus();if(Q.getSelection){var e;
Pa(a)?e=a:(e=Y.createRange(),e.setStart(a,b),e.setEnd(c,d));a=Q.getSelection();a.removeAllRanges();a.addRange(e)}};b.selectedText=function(){var a;if(Q.getSelection){var b=Q.getSelection();b&&(a=b.toString())}else Y.selection&&"Control"!=Y.selection.type&&(a=Y.selection.createRange().text);a||(a="");return a};b.nodeToString=function(a){if((a=b.unwrap(a))&&1===a.nodeType){var c=[];c.push("<",a.tagName.toLowerCase());if(a.classList)for(var d=0;d<a.classList.length;d++)c.push(".",a.classList[d]);a.id&&
c.push("#",a.id);c.push(">");return c.join("")}};return b}(),Kc=function(){var d=function(){},e=d.prototype;e.prop=function(a,c,b,d){"string"===typeof a&&void 0!==c&&Object.defineProperty(this,a,{value:c,writable:!!b})};e.deleteAll=function(){for(var a in this)this.hasOwnProperty(a)&&delete this[a]};e.invalidArg=function(a,c,b,d){var e="",e=c?e+("Invalid value specified for argument '"+c+"'"):e+"Invalid argument";b&&(e+=": '"+Fb(b)+"'");d&&(e+=", "+d);this.logError(a,e)};e.logError=function(a,c){var b;
this.publicName&&a&&(b=this.publicName+"."+a+": ");c&&(b=(b?b+": ":"")+String(c));b&&0<b.length&&F.on.error.dispatch(b,!1)&&console.error(b)};e.logFatalError=function(a,c,b,d){var e;this.publicName&&a&&(e=this.publicName+"."+a+": ");c&&(e=(e?e+": ":"")+String(c));b&&(e=(e?e+" ":"")+String(b));e&&0<e.length&&F.on.error.dispatch(e,!0)&&("warn"!==d&&(d="error"),console[d](e),ha.unload(),ha.showDocumentError(c))};e.logAJAXError=function(a,c,b,d,e){d===gc?c+=" (Request aborted)":d===Sb?c+=" (Request timed out)":
void 0!==d&&(c=c+" (HTTP Status "+d+")");d=[];b&&d.push(" [",b,"]");void 0!==e&&d.push(" responseText='",e,"'");this.logFatalError(a,c,d.join(""))};return d}(),L=function(){var d=[];d[0]=d[23]="right";d[5]=d[6]="up";d[11]=d[12]="left";d[17]=d[18]="down";for(var e=function(a){void 0===a&&(a="div");if("string"==typeof a){var b=this.dom=Y.createElement(a),c=1;if(c<arguments.length){var d;"string"==typeof arguments[c]?d=arguments[c++]:Array.isArray(arguments[c])&&(d=arguments[c++].join(" "));d&&d.length&&
b.setAttribute("class",d)}c<arguments.length&&"string"==typeof arguments[c]&&(b.id=arguments[c++]);c<arguments.length&&(b=y.wrap(arguments[c++]))&&y.isElement(b)&&b.append(this)}else y.isElement(a)&&(this.dom=y.unwrap(a))},a=X(e),c="clientLeft clientTop clientWidth clientHeight offsetWidth offsetHeight scrollWidth scrollHeight parentNode tagName classList".split(" "),b=function(b){Object.defineProperty(a,b,{get:function(){return this.dom[b]}})},f=0;f<c.length;f++)b(c[f]);Object.defineProperties(a,
{id:{get:function(){return this.dom.id},set:function(a){this.dom.id=a}},opacity:{get:function(){return Number(this.computedStyleProp("opacity"))},set:function(a){this.dom.style.opacity=a}},offsetLeft:{get:function(){return this.dom.offsetLeft},set:function(a){this.dom.style.left=K(a)+"px"}},offsetTop:{get:function(){return this.dom.offsetTop},set:function(a){this.dom.style.top=K(a)+"px"}},scrollLeft:{get:function(){return this.dom.scrollLeft},set:function(a){this.dom.scrollLeft=K(a)}},scrollTop:{get:function(){return this.dom.scrollTop},
set:function(a){this.dom.scrollTop=K(a)}},innerWidth:{get:function(){var a=this.computedStyleProp("width");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientWidth},set:function(a){this.dom.style.width=K(a)+"px"}},innerHeight:{get:function(){var a=this.computedStyleProp("height");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientHeight},set:function(a){this.dom.style.height=K(a)+"px"}},outerWidth:{get:function(){var a=this.dom.offsetWidth,b=Q.getComputedStyle(this.dom);b.marginLeft&&b.marginRight&&
(a+=parseFloat(b.marginLeft)+parseFloat(b.marginRight));return a}},outerHeight:{get:function(){var a=this.dom.offsetHeight,b=Q.getComputedStyle(this.dom);b.marginTop&&b.marginBottom&&(a+=parseFloat(b.marginTop)+parseFloat(b.marginBottom));return a}}});a.focus=function(){this.dom.focus()};a.blur=function(){this.dom.blur()};a.toString=function(){return y.nodeToString(this)};a.parent=function(){if(this.dom)return y.wrap(this.dom.parentNode)};a.firstChildElem=function(){if(this.dom)return y.wrap(this.dom.firstElementChild)};
a.nextSiblingElem=function(){if(this.dom)return y.wrap(this.dom.nextElementSibling)};a.detach=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom)}};a.destroy=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom);this.destroyChildren();y.destroyData(this.dom);this.deleteAll()}};var k=function(a){for(var b=a.firstElementChild;b;b=a){a=b.nextElementSibling;k(b);var c=y.query(b);c?c.destroy():y.removeData(b)}};a.destroyChildren=function(){k(this.dom)};a.equals=
function(a){return this.dom==y.unwrap(a)};a.html=function(a){void 0!==a&&(this.destroyChildren(),this.dom.innerHTML=a);return this.dom.innerHTML};a.text=function(a){void 0!==a&&(this.destroyChildren(),this.dom.textContent=a);return this.dom.textContent};a.data=function(a,b){return y.data(this.dom,a,b)};a.ancestorData=function(a){for(var b,c=this.dom,d=y.unwrap(w.rootNode);c;){b=y.data(c,a);if(void 0!==b)break;if(c==d)break;c=c.parentNode}return b};a.removeData=function(a){y.removeData(this.dom,a)};
a.hasClass=function(a){return y.hasClass(this.dom,a)};a.addClass=function(a){y.addClass(this.dom,a);return this};a.removeClass=function(a){y.removeClass(this.dom,a);return this};a.attr=function(a,b){var c;if(Array.isArray(a)){for(var d={},e=0;e<a.length;e++)c=a[e],d[c]=this.dom.getAttribute(c);return d}if(void 0===b){if("string"===typeof a)return this.dom.getAttribute(a);for(c in a)a.hasOwnProperty(c)&&this.dom.setAttribute(c,a[c])}else null===b?this.dom.removeAttribute(a):this.dom.setAttribute(a,
b);return this};a.css=function(a,b){var c=this.dom;if(c){var c=c.style,d;try{if(Array.isArray(a)){for(var e={},g=0;g<a.length;g++)d=a[g],e[d]=c.getPropertyValue(gb[d]||d);return e}if(void 0===b)if("string"===typeof a){if(-1==a.indexOf(":"))return c.getPropertyValue(gb[a]||a);(e=hb(a))&&this.css(e)}else for(d in a)a.hasOwnProperty(d)&&(g=a[d],null===g||void 0===g?c.removeProperty(gb[d]||d):c.setProperty(gb[d]||d,g,""));else null===b?c.removeProperty(gb[a]||a):c.setProperty(gb[a]||a,b,"")}catch(Qa){}}return this};
a.removeCSS=function(a){var b=this.dom;if(Array.isArray(a))for(var c=0;c<a.length;c++)b.style.removeProperty(a[c]);else if("string"===typeof a)b.style.removeProperty(a);else for(c in a)a.hasOwnProperty(c)&&b.style.removeProperty(c);return this};a.resetStyle=function(){return this.attr("style",null)};a.computedStyle=function(){return Q.getComputedStyle(this.dom)};a.computedStyleProp=function(a){return this.computedStyle().getPropertyValue(a)};a.show=function(){this._hidden&&(this.css("display",null),
delete this._hidden);return this};a.hide=function(){this._hidden||(this.css("display","none"),this._hidden=!0);return this};a.isHidden=function(){return this._hidden};a.autoscroll=function(a,b){var c=this.dom;switch(arguments.length){case 0:return{left:c.scrollLeft,top:c.scrollTop};case 1:return this.autoscroll(a.left,a.top);case 2:void 0!==a&&(c.scrollLeft=a),void 0!==b&&(c.scrollTop=b)}return this};a.scroll=function(a,b){void 0===a&&void 0===b||this.cancelKinetic();return this.autoscroll.apply(this,
arguments)};a.dscroll=function(a,b){this.cancelKinetic();a&&(this.scrollLeft+=a);b&&(this.scrollTop+=b);return this};a.animate=function(a){a&&(this.finishAnimation(),this.dom&&new Lc(this,a));return this};a.finishAnimation=function(){var a=this.data("_animation");a&&a.finish();return this};a.abortAnimation=function(){var a=this.data("_animation");a&&a.abort();return this};a.append=function(){if(this.dom)for(var a=arguments,b=0;b<a.length;b++){var c=a[b];Array.isArray(c)?this.append.apply(this,c):
this.dom.appendChild(y.unwrap(c))}return this};a.insert=function(a,b){this.dom&&this.dom.insertBefore(y.unwrap(a),y.unwrap(b));return this};a.insertAfter=function(a,b){this.dom&&(a=y.unwrap(a),b=y.unwrap(b),b=b.nextSibling,this.dom.insertBefore(a,b));return this};a.insertFirst=function(a){this.dom&&this.dom.insertBefore(y.unwrap(a),this.dom.firstChild);return this};a.remove=function(a){this.dom&&this.dom.removeChild(y.unwrap(a));return this};a.clone=function(a){return this.dom?this.dom.cloneNode(!!a):
null};a.transferFrom=function(a){a=y.unwrap(a);if(this.dom&&a)for(;0<a.childNodes.length;)this.dom.appendChild(a.childNodes[0]);return this};a.forElementAndAncestors=function(a){for(var b=this,c=y.unwrap(w.rootNode);b&&!1!==a(b)&&b!=c;)b=b.parent();return this};a.forChildElements=function(a){return v.call(this,a,!1,arguments)};a.queryChildElements=function(a){return v.call(this,a,!0,arguments)};var v=function(a,b,c){for(var d=[null,-1],e=1;e<c.length;e++)d.push(c[e]);c=0;for(var g=this.dom.firstElementChild;g;g=
e,c++)if(e=g.nextElementSibling,g=!0===b?y.query(g):y.wrap(g))if(d[0]=g,d[1]=c,!1===a.apply(null,d))break;return this};a.pos=function(a){var b=this.dom;a=y.unwrap(a);if(a==b)return{left:0,top:0};for(;b&&!b.getBoundingClientRect;)b=b.parentNode;if(b)return b=b.getBoundingClientRect(),b={left:b.left,top:b.top},a&&a!==Y.body&&(a=a.getBoundingClientRect(),b.left-=a.left,b.top-=a.top),b};a.size=function(){for(var a=this.dom;a&&!a.getBoundingClientRect;)a=a.parentNode;if(a)return a=a.getBoundingClientRect(),
{width:a.width,height:a.height}};a.rect=function(a){a=y.unwrap(a);for(var b=this.dom;b&&!b.getBoundingClientRect;)b=b.parentNode;if(b){var c=b.getBoundingClientRect(),c={left:c.left,top:c.top,right:c.right,bottom:c.bottom,width:c.width,height:c.height};a&&a!==Y.body&&(a==b?(c.right-=c.left,c.bottom-=c.top,c.left=0,c.top=0):(a=a.getBoundingClientRect(),c.left-=a.left,c.top-=a.top,c.right-=a.left,c.bottom-=a.top));return c}};a.inRect=function(a,b){var c=this.dom;return c&&0<=a&&0<=b&&a<=c.clientWidth&&
b<=c.clientHeight};a.ancestorByClass=function(a){for(var b=this.parent(),c=w.rootNode;b&&b.hasClass;){if(b.hasClass(a))return b;if(b.equals(c))break;b=b.parent()}return null};a.childByTagName=function(a){a=a.toUpperCase();for(var b=this.dom.firstElementChild;b;b=b.nextElementSibling)if(b.tagName.toUpperCase()===a)return y.wrap(b);return null};a.childrenByTagName=function(a){var b=null;a=a.toUpperCase();for(var c=this.dom.firstElementChild;c;c=c.nextElementSibling)c.tagName.toUpperCase()===a&&(b||
(b=[]),b.push(y.wrap(c)));return b};a.childByClass=function(a){if(this)for(var b=this.firstChildElem();b;b=b.nextSiblingElem())if(b.hasClass(a))return b;return null};a.byClass=function(a){return y.wrap(this.dom.getElementsByClassName(a))};a.byId=function(a){for(var b=[y.unwrap(this.dom)];0<b.length;)for(var c=b.shift().firstElementChild;c;c=c.nextElementSibling){if(c.id===a)return y.wrap(c);b.push(c)}return null};a.byTag=function(a){a=a.toUpperCase();for(var b=[y.unwrap(this.dom)],c=[];0<b.length;)for(var d=
b.shift().firstElementChild;d;d=d.nextElementSibling)d.tagName.toUpperCase()===a?c.push(y.wrap(d)):b.push(d);if(c.length)return c};a.isDescendantOf=function(a){return y.isDescendantOf(this.dom,a)};a.mousePos=function(a){a||(a=Q.event);for(var b={x:0,y:0},c=this.dom;c;c=c.offsetParent)b.x+=c.offsetLeft,b.y+=c.offsetTop;if(a.pageX||a.pageY)b.x=a.pageX-b.x,b.y=a.pageY-b.y;else if(a.clientX||a.clientY)b.x=a.clientX+Y.body.scrollLeft+Y.documentElement.scrollLeft-b.x,b.y=a.clientY+Y.body.scrollTop+Y.documentElement.scrollTop-
b.y;return b};a.touchPos=function(a){if(a){var b={identifier:a.identifier,x:0,y:0};if(a.center&&a.target){var c=y.wrap(a.target).pos(this);b.x=a.center.x+c.left;b.y=a.center.y+c.top}else{for(c=this.dom;c;c=c.offsetParent)b.x+=c.offsetLeft,b.y+=c.offsetTop;b.x=a.pageX-b.x;b.y=a.pageY-b.y}return b}};a.select=function(){Q.focus();if(Q.getSelection){var a=Y.createRange();a.selectNodeContents(this.dom);y.selectRange(a)}else Y.selection&&Y.body.createTextRange&&(a=Y.body.createTextRange(),a.moveToElementText(this.dom),
a.select())};var l=function(a){for(var b=!0;b;){var c=a.currentNode;if(1===c.nodeType)if("svg"===c.nodeName)b=a.skipNode();else if(c=y.data(c,"acc"),void 0!==c)if("none"===c)b=a.skipNode();else break;else break;else if(3===c.nodeType)break;else b=a.nextNode()}return b},r=function(){for(var a;!(a=this.nextSibling())&&this.parentNode(););return a},m=function(a){for(;this.currentNode!==a&&this.nextNode(););return this.currentNode===a},p=function(){return l(this)},z=function(){var a=this.nextNode();a&&
(a=l(this));return a};a.createTreeWalker=function(a,b,c){void 0===a&&(a=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);void 0===b&&(b=null);void 0===c&&(c=!1);a=Y.createTreeWalker(this.dom,a,b,c);a.skipNode=r;a.skipToNode=m;a.firstACCNode=p;a.nextACCNode=z;return a};a.createCanvas=function(){return new hc(this)};a.on=function(a,b,c){void 0===c&&(c=b,b=void 0);if("function"!==typeof c)this.invalidArg("on"+a,"listener",c,"Must be a function");else{var d=Array.prototype.slice.call(arguments,2);d[0]=null;
b=b||this;var e,g=this.dom;e=a;var n=y.data(g,"_events");n||(n={},y.data(g,"_events",n));(g=n[e])||(g=n[e]=[]);e=g;for(n=0;n<e.length;n++)if(g=e[n],g.fn===c){g.ref=b;g.args=d;c=null;break}c&&(e.push({fn:c,ref:b,args:d}),1==e.length&&(d=this._events[a])&&d.add&&d.add(this,a))}return this};a.off=function(a,b,c){void 0===c&&(c=b);if("function"===typeof c&&(b=q(this.dom,a))){for(var d=0;d<b.length;d++)if(b[d].fn===c){b.splice(d,1);break}0===b.length&&(c=this._events[a])&&c.remove&&c.remove(this,a)}return this};
for(var q=function(a,b){var c=y.data(a,"_events");if(c&&(c=c[b])&&0<c.length)return c},G=function(a,b,c){a["on"+b]=function(a,c){1==arguments.length&&(c=a,a=null);if(2<arguments.length){for(var d=[b,a,c],e=2;e<arguments.length;e++)d.push(arguments[e]);return this.on.apply(this,d)}return this.on(b,a,c)};a["off"+b]=function(a,c){return this.off(b,a,c)};a._events||(a._events={});a._events[b]=c},V=function(a){var b=q(a.currentTarget,a.type);if(b){for(var c=!0,d=0;d<b.length;d++){var e=b[d];e.args[0]=
a;!1===e.fn.apply(e.ref,e.args)&&(c=!1);e.args[0]=null}c||$a(a)}},c="mouseover mouseout mouseenter mouseleave mousedown mousemove mouseup wheel touchstart touchmove touchend touchcancel click dblclick contextmenu keydown keyup keypress blur focus scroll change transitionend".split(" "),b={add:function(a,b){a.dom.addEventListener(b,V)},remove:function(a,b){a.dom.removeEventListener(b,V)}},f=0;f<c.length;f++)G(a,c[f],b);for(var c="tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
T=function(a){return"dragstart"===a||"dragmove"===a||"dragend"===a||"dragcancel"===a},J=function(a,b){var c=a.data("_gestures");!c&&b&&(c={listenerCount:0},a.data("_gestures",c));return c},b={add:function(a,b){var c=J(a,!0);c.touches||(c.touches=[],a.ontouchstart(U));c.listenerCount++;T(b)&&(c.dragCount||(c.dragCount=0,a.onmousedown(H)),c.dragCount++)},remove:function(a,b){var c=J(a);c&&(c.listenerCount--,0===c.listenerCount&&(a.removeData("_gestures"),a.offtouchstart(U)),T(b)&&0<c.dragCount&&(c.dragCount--,
c.dragCount||a.offmousedown(H)))}},f=0;f<c.length;f++)G(a,c[f],b);var N={add:function(a,b){},remove:function(a,b){}};a.customEvent=function(a){G(this,a,N)};a.dispatchCustom=function(a,b){var c=!0,d=q(this.dom,a);if(d)for(var e=0;e<d.length;e++){var g=d[e];g.args[0]=b;!1===g.fn.apply(g.ref,g.args)&&(c=!1);c&&b.defaultPrevented&&b.defaultPrevented()&&(c=!1);g.args[0]=null}return c};var E=function(a,b,c,e,g){for(var n=!0;a&&a.dom&&!q(a.dom,b);)a=a.parent();a&&!a.dom&&(a=null);if(a&&a.dom){var n=c.start,
f=c.current,C=n.center,u=f.center,m=c.delta;m||(m=c.delta={x:0,y:0});m.x=u.x-C.x;m.y=u.y-C.y;if(m.x||m.y)c.moved=!0;var p=c.moved||!1,I=c.press?!!c.press.started:!1,z=K(Tb(C.x,C.y,u.x,u.y)),t=C.x,h=C.y,G=u.x,k=u.y,t=K(t==G&&h==k?0:Math.atan2(h-k,G-t),100),A;0<z&&(A=d[Math.floor((12*t/Math.PI+24)%24)]);h=1;G=0;c.touches&&1<c.touches.length&&(0<n.distance&&(h=f.distance/n.distance),G=Ub(f.angle-n.angle));c={type:b,srcEvent:e,target:a.dom,distance:z,angle:t,scale:h,rotation:G,start:C,center:u,delta:m,
direction:A,moved:p,press:I,kinetic:!!g};Q.OILogGesture&&Q.OILogGesture(b,a,c);n=a.dispatchCustom(b,c);for(a=a.parent();n&&a&&a.dom;a=a.parent())q(a.dom,b)&&(n=a.dispatchCustom(b,c))}return n},h=function(a,b,c){b.press&&(b.press.started=!0,E(a,"press",b,c))},u=function(a,b,c){b.press&&(b.press.started&&E(a,"pressup",b,c),b.press.timer&&sa(b.press.timer),delete b.press)},g=function(a,b,c,d,e,n){a=c.kinetic;var f=!1,C;if(a){c.start=e;c.current=n;var u=Date.now()-a.frameTime,u=Math.exp(-u/325),q;a.ax&&
(C=-a.ax*u,.5>Math.abs(C)&&(C=0),c.current.center.x=e.center.x+a.tx+C);a.ay&&(q=-a.ay*u,.5>Math.abs(q)&&(q=0),c.current.center.y=e.center.y+a.ty+q);if(C||q)C=c.dragCount?"dragmove":"panmove",E(b,C,c,d,!0),f=!0,a.anim=ib(g,null,b,c,d,e,n)}f||(C=c.dragCount?"dragend":"panend",E(b,C,c,d,!0),delete c.kinetic,delete c.start,delete c.current)},t=function(a,b,c){b.pan&&(E(a,"pancancel",b,c),delete b.pan)},A=function(a){if(a){var b=Date.now();if(1==a.length){var c=a[0];a={x:K(c.x),y:K(c.y)};return{distance:0,
angle:0,center:a,time:b}}if(2<=a.length){for(var d=0,e,g=a.length-1,n=0;n<g;n++)for(var f=a[n],C=n+1;C<a.length;C++){var u=a[C],u=Tb(f.x,f.y,u.x,u.y);u>d&&(d=u,e=f,c=a[C])}a:{if(a){var q,m;if(1==a.length){g=a[0];a={x:g.x,y:g.y};break a}if(2==a.length){g=a[0];q=a[1];a={x:(g.x+q.x)/2,y:(g.y+q.y)/2};break a}if(2<a.length){g={x:0,y:0};n=0;f=a.length-1;for(C=0;C<a.length;C++){q=a[C];m=C<f?a[C+1]:a[0];u=q.x;q=q.y;var p=m.x;m=m.y;var z=u*m-p*q,n=n+z;g.x+=(u+p)*z;g.y+=(q+m)*z}n*=3;g.x/=n;g.y/=n;a=g;break a}}a=
void 0}a.x=K(a.x);a.y=K(a.y);d=K(d);g=e.x;e=e.y;n=c.x;c=c.y;return{distance:d,angle:K(g==n&&e==c?0:Math.atan2(e-c,n-g),100),center:a,time:b}}}};a.kinetic=function(a){!0===a?J(this,!0).enableKinetic=!0:!1===a&&(a=J(this))&&delete a.enableKinetic};a.cancelKinetic=function(){var a=J(this);a&&a.kinetic&&(a.kinetic.anim&&Vb(a.kinetic.anim),delete a.kinetic)};var U=function(a){var b=J(this);if(b){this.cancelKinetic();var c=b.touches,d=a.changedTouches,e=w.viewNode,g=null;b.dragCount||(g=this.pos(e));for(var n=
0;n<d.length;n++){var f=e.touchPos(d[n]);g&&(f.x-=g.left,f.y-=g.top);f.ox=f.x;f.oy=f.y;c.push(f)}b.current=A(b.touches);b.start=b.current;1==c.length?(delete b.tap,b.tap={time:b.current.time},u(this,b,a),a=ba(h,500,null,this,b,a),b.press={timer:a}):1<c.length&&!b.pinch&&(delete b.tap,u(this,b,a),t(this,b,a),delete b.distance,b.pinch||(b.pinch={},E(this,"pinchstart",b,a)));Va.setTouchCapture(S,W,qa,this);return!1}},S=function(a){var b=J(this);if(b){for(var c=b.touches,d,e=a.changedTouches,g=b.dragCount?
w.viewNode:this,n=0;n<e.length;n++)for(var f=g.touchPos(e[n]),C=0;C<c.length;C++)if(d=c[C],d.identifier===f.identifier){d.x=f.x;d.y=f.y;d.dx=f.x-d.ox;d.dy=f.y-d.oy;break}d=b.current;e=A(b.touches);if(e.distance!==d.distance||e.angle!==d.angle||e.center.x!==d.center.x||e.center.y!==d.center.y)if(b.previous=d,b.current=e,1!=c.length||b.multi)1<c.length&&(b.multi=!0,b.pinch&&(c=b.previous,d=b.current,e=b.start,0<e.distance&&(g=K(c.distance/e.distance,100),K(d.distance/e.distance,100)!=g&&E(this,"pinchmove",
b,a)),d.angle!=c.angle&&(b.rotate||(b.rotate={start:b.start.angle},E(this,"rotatestart",b,a)),E(this,"rotatemove",b,a))));else if(d=c[0],c=b.distance=Tb(d.dx,d.dy,0,0),d=e.time-b.start.time,10<c&&50<d&&(delete b.tap,b.press&&b.press.started||u(this,b,a),b.pan||(t(this,b,a),b.pan={startTime:b.current.time},b.enableKinetic&&!b.press&&(b.kinetic={vx:0,vy:0,frameTime:b.current.time,frameX:0,frameY:0}),E(this,b.dragCount?"dragstart":"panstart",b,a)),b.pan&&(E(this,b.dragCount?"dragmove":"panmove",b,a),
a=b.kinetic)))c=b.current.time,d=c-a.frameTime,e=b.delta,b.pan.moveTime=c,b=e.y-a.frameY,a.vx=1E3*(e.x-a.frameX)/(d+1)*.8+.2*a.vx,a.vy=1E3*b/(d+1)*.8+.2*a.vy,a.frameTime=c,a.frameX=e.x,a.frameY=e.y;return!1}},W=function(a){ia(this,a,!1)},qa=function(a){ia(this,a,!0)},ia=function(a,b,c){var d=J(a);if(d){var e=d.touches,n=e.length-b.changedTouches.length;try{if(1==e.length)if(c)delete d.tap,u(a,d,b),t(a,d,b);else{if(d.pan){var f=Date.now(),C=f-d.pan.startTime;c=!1;var q,m=d.kinetic;m&&(150<f-d.pan.moveTime&&
(m.vx=0,m.vy=0),10<Math.abs(m.vx)&&(m.ax=.8*m.vx,m.tx=Math.round(d.delta.x+m.ax)),10<Math.abs(m.vy)&&(m.ay=.8*m.vy,m.ty=Math.round(d.delta.y+m.ay)),m.ax||m.ay?(m.frameTime=f,m.anim=ib(g,null,a,d,b,d.start,d.current),c=!0):delete d.kinetic);c||(q=d.dragCount?"dragend":"panend",E(a,q,d,b));if(!(d.dragCount||d.press&&d.press.started)&&1E3>C){var z=d.touches[0],p=Math.abs(z.dx),h=Math.abs(z.dy);60<=p&&60>h?q=0>z.dx?"swiperight":"swipeleft":60<=h&&60>p&&(q=0>z.dy?"swipeup":"swipedown");q&&E(a,q,d,b)}delete d.pan}u(a,
d,b);d.tap&&(200>Date.now()-d.tap.time&&E(a,"tap",d,b),delete d.tap)}else 1<e.length&&1>=n&&(c?(d.rotate&&(E(a,"rotatecancel",d,b),delete d.rotate),d.pinch&&(E(a,"pinchcancel",d,b),delete d.pinch)):(d.rotate&&(E(a,"rotateend",d,b),delete d.rotate),d.pinch&&(E(a,"pinchend",d,b),delete d.pinch)))}catch(Kb){F.logError(null,Kb)}a=b.changedTouches;for(b=0;b<a.length;b++)for(f=a[b],C=0;C<e.length;C++)if(e[C].identifier===f.identifier){e.splice(C,1);break}delete d.distance;0===e.length&&(delete d.start,
delete d.current,delete d.previous,delete d.multi,Va.releaseTouchCapture());return!1}},O=function(a){a=w.viewNode.mousePos(a);return{distance:0,angle:0,center:{x:a.x,y:a.y}}},H=function(a){if(0===(a.button||0)){var b=O(a),c=J(this,!0);c.start=b;c.current=b;if(!E(this,"dragstart",c,a))return Va.setMouseCapture(n,C,this),!1}},n=function(a){var b=O(a),c=J(this,!0);if(c&&c.current){var d=c.current.center;if(b.center.x!=d.x||b.center.y!=d.y)c.current=b,E(this,"dragmove",c,a);return!1}},C=function(a){var b=
J(this,!0);E(this,"dragend",b,a);Va.releaseMouseCapture();return!1};return e}(),Wb=function(){var d=function(a,c,b){L.call(this,"input",b);this.dom.type="button";"string"===typeof a&&(this.dom.value=a);"string"===typeof c&&(this.dom.title=c)},e=X(d,L);Object.defineProperties(e,{disabled:{get:function(){return this.dom.disabled},set:function(a){this.dom.disabled=a}}});return d}(),jc=function(){var d=function(a,c){L.call(this,"textarea",c);"string"===typeof a&&(this.dom.value=a)},e=X(d,L);Object.defineProperties(e,
{value:{get:function(){return this.dom.value},set:function(a){this.dom.value=a}}});e.moveCaret=function(a){var c=this.dom;c.createTextRange?(c=c.createTextRange(),c.move("character",a),c.select()):void 0!==c.selectionStart?(c.focus(),c.setSelectionRange(a,a)):c.focus()};return d}(),hc=function(){var d=function(a,c){L.call(this,"canvas");2===arguments.length?(this.dom.width=a,this.dom.height=c):1===arguments.length&&(this.dom.width=a.clientWidth,this.dom.height=a.clientHeight,y.wrap(a).append(this))},
e=X(d,L);Object.defineProperties(e,{width:{get:function(){return this.dom.width}},height:{get:function(){return this.dom.height}}});var a=function(a,c,d,e,l,r,m,p){this.globalAlpha=1;void 0!==l&&(this.fillStyle=l);r?(this.strokeStyle=r,this.lineWidth=m||1,this.lineCap="square",this.beginPath(),this.setLineDash(p||[]),this.rect(a,c,d,e),l&&this.fill(),this.stroke(),this.closePath()):(this.lineWidth=0,this.fillRect(a,c,d,e))},c=function(a,c,d,e,l,r,m){void 0!==l&&(this.strokeStyle=l);this.lineWidth=
r||1;this.lineCap="square";this.globalAlpha=1;this.beginPath();this.setLineDash(m||[]);this.moveTo(a,c);this.lineTo(d,e);this.stroke();this.closePath()};e.getContext=function(b){b=this.dom.getContext(b);b.oitrect=a;b.oitline=c;return b};return d}(),Wa=function(){var d=function(d,a){this.prop("list",d);this.prop("name",a)};X(d);return d}(),ob=function(){var d=function(a){this._createFn=a;this._plugins={}},e=X(d);e.item=function(a){return this._plugins[a]};e.items=function(){return this._plugins};e.extend=
function(a,c){if(Array.isArray(a))for(var b=0;b<a.length;b++)this.extend.call(this,a[b],c);else{if("string"===typeof a)return b=this._plugins[a],b||(b=this._createFn.call(this,a))&&(this._plugins[a]=b),b&&b.extend.call(b,c),b;if("object"===typeof a)for(b in a)this.extend.call(this,b,a[b])}};return d}(),w=function(){var d=new ob(function(e){return new kc(d,e)});d.reset=function(d,a){if("string"===typeof d){"boolean"!==typeof a&&(a=!0);var c=this._plugins[d];c&&c.reset(a)}};d.resetAll=function(d){"boolean"!==
typeof d&&(d=!0);for(var a in this._plugins)this._plugins[a].reset(d)};d.defaultVal=function(d){if(d=this._plugins[d])return d.defaultVal()};d.setProperty=function(d,a,c){(d=this._plugins[d])&&d.setProperty(a,c)};return d}(),kc=function(){var d=function(a,c){Wa.call(this,a,c)},e=X(d,Wa);e.extend=function(a){a=a||{};var c={_v:{value:void 0,writable:!0}};a.init&&(c.init={value:a.init});void 0!==a.def&&(c.def={value:a.def});this.list!==w&&(!0===a.pub&&(c.pub={value:a.pub}),a.legal&&(c.legal={value:a.legal}),
a.validate&&(c.validate={value:a.validate}),a.type&&(c.type={value:a.type||"boolean"},"number"===a.type||Array.isArray(a.type)&&-1!=a.type.indexOf("number")))&&("number"===typeof a.min&&(c.min={value:a.min}),"number"===typeof a.max&&(c.max={value:a.max}));Object.defineProperties(this,c);var b=this;this.list["on"+this.name]=function(a,c){return b.listen(a,c)};this.list["off"+this.name]=function(a,c){return b.unlisten(a,c)};Object.defineProperty(this.list,this.name,{enumerable:!0,get:function(){return void 0===
b._v&&(b.init&&(b._v=b.init()),void 0===b._v)?b.defaultVal():b._v},set:function(a){b.set(a)}})};e.listen=function(a,c){void 0===c&&(c=a,a=void 0);this._listeners||(this._listeners=[]);this._listeners.push({context:a,fn:c})};e.unlisten=function(a,c){if(this._listeners){void 0===c&&(c=a);for(var b=0;b<this._listeners.length;b++)if(this._listeners[b].fn==c){this._listeners.splice(b,1);break}}};e.set=function(a,c){if(a!==this._v){if(void 0!==a){var b=!0;if(this.type){var d=null===a?"null":typeof a,b=
d===this.type;!b&&Array.isArray(this.type)&&(b=-1!=this.type.indexOf(d));b||"string"!==d||(b="color"===this.type,!b&&Array.isArray(this.type)&&(b=-1!=this.type.indexOf("color")),b&&(d="color"));b&&"color"===d?ya(a)||(this.pub&&F.invalidArg("setOptions",this.name,a,"Must be a CSS color string"),a=this._v):b||("null"===d?a=void 0:(this.pub&&(d=Array.isArray(this.type)?"Must be one of these types: "+JSON.stringify(this.type):"Must be of type "+this.type,F.invalidArg("setOptions",this.name,a,d)),a=this._v))}b&&
(this.legal&&-1==this.legal.indexOf(a)?(this.pub&&F.invalidArg("setOptions",this.name,a,"Must be one of "+JSON.stringify(this.legal)),a=this._v):void 0!==this.min&&a<this.min?(this.pub&&F.invalidArg("setOptions",this.name,a,"Using minimum value of "+this.min,!1),a=this.min):void 0!==this.max&&a>this.max?(this.pub&&F.invalidArg("setOptions",this.name,a,"Using maximum value of "+this.max,!1),a=this.max):this.validate&&(a=this.validate(this.name,a,this._v)))}if(a!==this._v){b=this._v;if("object"===this.type){this._v=
{};for(var e in a)a.hasOwnProperty(e)&&(this._v[e]=a[e])}else this._v=a;if(!1!==c&&this._listeners)for(e=0;e<this._listeners.length;e++)d=this._listeners[e],d.fn.call(d.context,this._v,b,this.name)}}};e.setProperty=function(a,c){if("object"===this.type||Array.isArray(this.type)&&-1!=this.type.indexOf("object")&&(!this._v||this._v[a]!==c))if(this._v||(this._v={}),this._v[a]!==c&&(this._v[a]=c,this._listeners))for(var b=0;b<this._listeners.length;b++){var d=this._listeners[b];d.fn.call(d.context,this._v,
null,this.name)}};e.reset=function(a){this.set(void 0,a)};e.defaultVal=function(){return this.def};return d}();w.extend({URL:{init:function(){return Y.URL}},baseURL:{init:function(){return x.outputBaseUrl}},viewNode:{init:function(){var d=w.rootNode;if(d)return y.attach(d.childByClass("oit-view"))}},rootNode:{init:function(){var d=y.byClass("oit-view-root");if(d&&0<d.length)return y.attach(d[0])}},deType:{},drawing:{},libversion:{},documentLoading:{def:!1},documentLoaded:{def:!1},documentComplete:{def:!1},
dynamicContent:{def:!1},enableRawText:{},guid:{},singlePageIndex:{},isMobile:{init:function(){return lc()}},isMobileOrTablet:{init:function(){return mc()}},editingComment:{def:0},staging:{def:!1},hasHiddenText:{def:!1},hasWorksheetRevisions:{def:!1}});var x=function(){var d=new ob(function(e){return new kc(d,e)});d.isPublic=function(d){return(d=this._plugins[d])&&d.pub};d.reset=function(d){jb(this._plugins,"reset",null,d)};d.reset=function(d,a){if("string"===typeof d){"boolean"!==typeof a&&(a=!0);
var c=this._plugins[d];c&&c.reset(a)}};d.resetAll=function(d){"boolean"!==typeof d&&(d=!0);for(var a in this._plugins)this._plugins[a].reset(d)};d.defaultVal=function(d){if(d=this._plugins[d])return d.defaultVal()};d.setProperty=function(d,a,c){(d=this._plugins[d])&&d.setProperty(a,c)};return d}();x.extend({disableAnimation:{pub:!0,type:"boolean",init:function(){return!1}},memoryModel:{pub:!0,type:"string",legal:["large","small","micro","none"],init:function(){return w.isMobileOrTablet?"small":"large"}},
detectBaseUrl:{pub:!0,type:"boolean",def:!0},outputBaseUrl:{pub:!0,type:"string",def:""},centerPages:{pub:!0,type:"boolean",def:!0},redactionColor:{pub:!0,type:"color",def:"#000"},redactionFillColor:{pub:!0,type:"color",def:null},showHighlightLabels:{pub:!0,type:"boolean",def:!0},highlightLabelFontFamily:{pub:!0,type:"string",def:null},highlightLabelFontSize:{pub:!0,type:"string",def:null},highlightActivationBoxColor:{pub:!0,type:["color","null"],def:null},redactionMode:{pub:!0,type:"string",legal:["simple",
"compound","hybrid"],def:"hybrid"},contentTimeout:{pub:!0,type:"number",min:1,def:2E4},doubleClickInterval:{pub:!0,type:"number",def:500,min:1,max:1E4},removeExtraEmailHeaders:{pub:!0,type:"boolean",def:!1},emailHeaderStyle:{pub:!0,type:"object",def:null},zoom:{type:"number",def:1,min:.1,max:40},zoomMode:{type:["string","null"],legal:[null,"page","pagewidth","pageheight","mobile"],init:function(){return w.isMobileOrTablet?"mobile":null}},rotation:{type:"number",legal:[0,90,180,270],def:0},selectionMode:{type:"string",
legal:["text","rect","cell","none"],def:"text",validate:function(d,e,a){return P.validateMode(e,a)}},nochrome:{pub:!0,type:"boolean",def:!1,init:function(){return!1}},scrollMode:{pub:!0,type:"string",legal:["single","vertical","hswipe","vswipe"],def:"vertical",init:function(){return w.isMobileOrTablet?"hswipe":"vertical"}},showSlideNotes:{pub:!0,type:"boolean",def:!1},showAnnotations:{pub:!0,type:"boolean",def:!1},presentationMode:{pub:!0,type:"string",legal:["normal","slideshow"],def:"normal"},showEmailAddresses:{pub:!0,
type:"boolean",def:!1},showHiddenSheets:{pub:!0,type:"boolean",def:!1},showHiddenRows:{pub:!0,type:"boolean",def:!1},showHiddenColumns:{pub:!0,type:"boolean",def:!1},showCellTooltips:{type:"boolean",def:!1},showHiddenContentNotification:{pub:!0,type:"string",legal:["none","expanded","collapsed"],def:"collapsed"},appointmentHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",headerFields:[["ORGANIZER","FROM"],"IMPORTANCE","LOCATION","DTSTART","DTEND","CATEGORIES","ATTENDEES","REQATTENDEE","OPTATTENDEE"]}},
contactHeader:{pub:!0,type:"object",def:{subjectField:["SUBJECT","DISPLAYAS","FILEAS","FULLNAME"],defaultSubject:!1,dateField:null,photoField:[{g:"PHOTO",id:"PHOTO"},"PHOTO"],logoField:[{g:"LOGO",id:"LOGO"},"LOGO"],headerFields:["COMPANY",[{g:"NAME",id:"FIRST"},"FIRST"],[{g:"NAME",id:"MIDDLE"},"MIDDLE"],[{g:"NAME",id:"FAMILY"},"FAMILY"],[{g:"NAME",id:"SUFFIX"},"SUFFIX"],[{g:"NAME",id:"TITLE"},"TITLE","JOBTITLE"],{multi:!0,fields:[{g:"TELENUMBER",t:"Work",id:"TELENUMBER",l:"EMAIL_BUSINESSPHONE"},{g:"ADDRESS",
t:"Work",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},"BUSINESSPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Cell",id:"TELENUMBER",l:"EMAIL_MOBILEPHONE"},"MOBILEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Pager",id:"TELENUMBER",l:"EMAIL_PAGERPHONE"},"PAGERPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Home",id:"TELENUMBER",l:"EMAIL_HOMEPHONE"},{g:"ADDRESS",t:"Home",id:"PHONE",l:"EMAIL_HOMEPHONE"},"HOMEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",
t:"Postal",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},{g:"ADDRESS",t:"Postal",id:"PHONE",l:"EMAIL_OTHERPHONE"},{g:"TELENUMBER",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},"TELENUMBER","OTHERPHONE"]},{multi:!0,fields:[{g:"EMAIL",id:"EMAIL",d:"DISPLAYAS"},"EMAIL"]},"WEBPAGE","IMADDRESS","DISPLAYAS",{title:"BUSINESSADDRESS",fields:[[{g:"ADDRESS",t:"Work",id:"POBOX"},{g:"BUSINESSADDRESS",id:"BUSINESSPOBOX"},"BUSINESSPOBOX"],[{g:"ADDRESS",t:"Work",id:"STREET"},{g:"BUSINESSADDRESS",id:"BUSINESSSTREET"},"BUSINESSSTREET"],
[{g:"ADDRESS",t:"Work",id:"CITY"},{g:"BUSINESSADDRESS",id:"BUSINESSCITY"},"BUSINESSCITY"],[{g:"ADDRESS",t:"Work",id:"STATE"},{g:"BUSINESSADDRESS",id:"BUSINESSSTATE"},"BUSINESSSTATE"],{g:"ADDRESS",t:"Work",id:"REGION"},[{g:"ADDRESS",t:"Work",id:"POSTALCODE"},{g:"BUSINESSADDRESS",id:"BUSINESSPOSTALCODE"},"BUSINESSPOSTALCODE"],[{g:"ADDRESS",t:"Work",id:"COUNTRY"},{g:"BUSINESSADDRESS",id:"BUSINESSCOUNTRY"},"BUSINESSCOUNTRY"],[{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE2"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE2"},
"BUSINESSPHONE2"],[{g:"ADDRESS",t:"Work",id:"BUSINESSFAX"},{g:"BUSINESSADDRESS",id:"BUSINESSFAX"},"BUSINESSFAX"]]},{title:"HOMEADDRESS",fields:[[{g:"ADDRESS",t:"Home",id:"POBOX"},"HOMEPOBOX"],[{g:"ADDRESS",t:"Home",id:"STREET"},"HOMESTREET"],[{g:"ADDRESS",t:"Home",id:"CITY"},"HOMECITY"],[{g:"ADDRESS",t:"Home",id:"STATE"},"HOMESTATE"],{g:"ADDRESS",t:"Home",id:"REGION"},[{g:"ADDRESS",t:"Home",id:"POSTALCODE"},"HOMEPOSTALCODE"],[{g:"ADDRESS",t:"Home",id:"COUNTRY"},"HOMECOUNTRY"],[{g:"ADDRESS",t:"Home",
id:"PHONE2"},"HOMEPHONE2"],[{g:"ADDRESS",t:"Home",id:"FAX"},"HOMEFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",t:"Postal",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",t:"Postal",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",t:"Postal",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",t:"Postal",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",t:"Postal",id:"REGION"},[{g:"ADDRESS",t:"Postal",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",t:"Postal",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",t:"Postal",id:"PHONE2"},"OTHERPHONE2"],
[{g:"ADDRESS",t:"Postal",id:"FAX"},"OTHERFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",id:"REGION"},[{g:"ADDRESS",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",id:"FAX"},"OTHERFAX"]]}]}},distroHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",
dateField:null,headerFields:[]}},journalHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"START",headerFields:["ENTRY_TYPE","COMPANY","DURATION","CATEGORIES"]}},emailHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:["CLIENT_SUBMIT_TIME","DATE"],headerFields:["FROM","TO","CC","BCC"]}},noteHeader:{pub:!0,type:"object",def:{subjectField:null,dateField:null,headerFields:["CREATION_TIME","CATEGORIES"]}},postHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"CREATION_TIME",
headerFields:["FROM","CLIENT_SUBMIT_TIME","CONVERSATION_TOPIC"]}},taskHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:"START_DATE STATUS DUE_DATE PRIORITY OWNER PERCENT_COMPLETE CATEGORIES".split(" ")}},annoBarWidth:{pub:!0,type:"number",init:function(){return Math.min(w.viewNode.clientWidth/2,320)}},highlightTermIntervals:{pub:!0,type:"boolean",def:!0},highlightActivationStyle:{pub:!0,type:"string",legal:["box","opacity"],def:"opacity"},annotationSort:{pub:!0,
type:"string",legal:"location date rdate author rauthor type".split(" "),def:"location"}});var Mc=function(){var d=function(a,b,c){Wa.call(this,b,c);this.prop("host",a,!1,!0)},e=X(d,Wa),a=function(a,b,c){if(a=a._int)for(var d=0;d<a.length;d++){var e=a[d];if(e.fn===b&&(void 0===c||e.context===c))return d}return-1},c=function(a,b){var c=a._pub;return c?c.indexOf(b):-1},b=function(b,c,d,e){void 0===d&&(d=c,c=void 0);if(-1===a(b,d,c)){var f=!b.hasListeners(),q={context:c,fn:d};!0===e&&(q.listenOnce=!0);
b.single&&b.hasListeners()?b.logError(null,"Only one listener may be registered for the "+b.name+" event."):(b._int||b.prop("_int",[],!0),b._int.push(q),f&&b.isSystemEvent()&&b.list.addElementListeners(b.name),b.onListen&&b.onListen.call(null,b,d,c))}},f=function(a,b){-1!=b&&(a.dispatching?(a._xint||(a._xint=[]),a._xint.push(b)):(a._int.splice(b,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onUnlisten&&a.onUnlisten.call(null,a)))},k=function(a,b){-1!=b&&(a.dispatching?
(a._xpub||(a._xpub=[]),a._xpub.push(b)):(a._pub.splice(b,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onRemove&&a.onRemove.call(null,a)))},v=function(){var a;this.detail&&(a=this.detail.apply(null,arguments));var b=this.systemEventName||this.name,c=Y.createEvent("CustomEvent");c.initCustomEvent(b,!0,!0,a);return c},l=function(){var a=!0,b,c;this.dispatching=!0;var d=this._int;if(d)for(b=d.length,c=0;c<b;c++){var e=d[c];!1===e.fn.apply(e.context,arguments)&&(a=!1);
e.listenOnce&&f(this,c)}d=this._pub;if(a&&d){a=v.apply(this,arguments);b=d.length;for(c=0;c<b;c++)d[c].call(void 0,a);a=!a.defaultPrevented}a&&this._def&&(a=this._def.fn.apply(this._def.context,arguments));this.dispatching=!1;if(this._xint){for(c=this._xint.length-1;0<=c;c--)f(this,this._xint[c]);delete this._xint}if(this._xpub){for(c=this._xpub.length-1;0<=c;c--)k(this,this._xpub[c]);delete this._xpub}return a};e.extend=function(a){a&&(!0===a.pub&&(this.prop("pub",!0),a.detail&&this.prop("detail",
a.detail)),!0===a.systemEvent&&this.prop("systemEventName","_"+this.name),0<a.delay&&this.prop("delay",a.delay),!0===a.single&&this.prop("single",!0),this.prop("onListen",a.onListen),this.prop("onUnlisten",a.onUnlisten),this.prop("onAdd",a.onAdd),this.prop("onRemove",a.onRemove),Object.defineProperty(this.list,this.name,{enumerable:!0,value:this}))};e.enable=function(){this.disabled=!1};e.disable=function(){this.disabled=!0};e.hasListeners=function(){return!!this._def||this._int&&0<this._int.length||
this._pub&&0<this._pub.length};e.isSystemEvent=function(){return!!this.systemEventName};e.setDefaultListener=function(a,b){if(a){this._def&&this.setDefaultListener(null);var c=!this.hasListeners();this._def={context:b,fn:a};c&&this.isSystemEvent()&&this.list.addElementListeners(this.name);this.onListen&&this.onListen.call(null,this,a,b)}else this._def&&(delete this._def,!this.hasListeners()&&this.isSystemEvent()&&this.list.removeElementListeners(this.name),this.onUnlisten&&this.onUnlisten.call(null,
this))};e.listen=function(a,c){b(this,a,c,!1)};e.listenOnce=function(a,c){b(this,a,c,!0)};e.unlisten=function(b,c){void 0===c&&(c=b,b=void 0);f(this,a(this,c,b))};e.addPublicListener=function(a){var b=!1;if(this.pub&&"function"===typeof a)if(-1!==c(this,a))b=!0;else{var d=!this.hasListeners();this.single&&this.hasListeners()?this.logError(null,"Only one listener may be registered for the "+this.name+" event."):(this._pub||this.prop("_pub",[],!0),this._pub.push(a),d&&this.isSystemEvent()&&this.list.addElementListeners(this.name),
this.onAdd&&this.onAdd.call(null,this,a),b=!0)}return b};e.removePublicListener=function(a){a=c(this,a);if(-1==a)return!1;k(this,a);return!0};e.dispatch=function(){this.logDispatch&&this.logDispatch.apply(this,arguments);if(this.hasListeners()&&!this.disabled){if(!this.delay)return l.apply(this,arguments);this._dispatchTimer&&sa(this._dispatchTimer);this._ddArgs=arguments;this._dispatchTimer=ba(r,this.delay,this)}return!0};var r=function(){l.apply(this,this._ddArgs);delete this._ddArgs};e.dispatchTo=
function(a,b){var c=v.apply(this,b);a.call(void 0,c);return!c.defaultPrevented};e.reset=function(){this._int&&(this._int=[]);this._pub&&(this._pub=[]);delete this._def};return d}(),nc=function(){var d="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel".split(" "),e=function(a){for(a=y.unwrap(a);a;){var b=y.data(a,"dispatcherData");if(b)return b;a=a.parentNode}},a=function(a){return new Mc(this._host,this,a)},c=function(b,c){ob.call(this,
a);this.name=c;this._host=b;this._eventElements=[];var d=this;this.onSystemEvent=function(a){var b=!0,c=d[a.type];if(c&&c.hasListeners()&&!c.disabled){var f=e(a.currentTarget||a.target);if(f)for(var z=0;b&&z<f.length;z++){var q=f[z];q.args[1]=a;b=c.dispatch.apply(c,q.args);q.args[1]=null}}b||$a(a);return b}},b=X(c,ob);b.enable=function(){this.disabled=!1};b.disable=function(){this.disabled=!0};b.addElementListeners=function(a){if(this[a])if(-1!==d.indexOf(a))for(var b=0;b<this._eventElements.length;b++){var c=
this._eventElements[b];c.addEventListener(a,this.onSystemEvent,!1)}else for(b=0;b<this._eventElements.length;b++)c=this._eventElements[b],y.wrap(c).on(a,this,this.onSystemEvent)};b.removeElementListeners=function(a){if(this[a])if(-1!==d.indexOf(a))for(var b=0;b<this._eventElements.length;b++)this._eventElements[b].removeEventListener(a,this.onSystemEvent);else for(b=0;b<this._eventElements.length;b++)y.wrap(this._eventElements[b]).off(a,this,this.onSystemEvent)};b.addElement=function(a,b){if((a=y.unwrap(a))&&
a.addEventListener){var c;if(-1==this._eventElements.indexOf(a))for(c in this._eventElements.push(a),this._plugins){var f=this[c];if(f.isSystemEvent()&&f.hasListeners())if(-1!==d.indexOf(c))a.addEventListener(c,this.onSystemEvent,!1);else y.wrap(a).on(c,this,this.onSystemEvent)}f={context:b,args:[y.wrap(a),null]};for(c=1;c<arguments.length;c++)f.args.push(arguments[c]);var k=e(a);k||(k=[],y.data(a,"dispatcherData",k));var m=!1;for(c=0;c<k.length;c++)if(k[c].context===b){k[c]=f;m=!0;break}m||k.push(f)}};
b.removeElement=function(a,b){a=y.unwrap(a);var c=this._eventElements.indexOf(a);if(-1!=c){var f=!0;if(void 0===b)y.removeData(a,"dispatcherData");else{var k=e(a);if(k){for(var m=0;m<k.length;m++)if(k[m].context===b){1==k.length?k=null:k.splice(m,1);break}k&&0!==k.length?f=!1:y.removeData(a,"dispatcherData")}}if(f){this._eventElements.splice(c,1);for(var p in this._plugins)c=this[p],c.isSystemEvent()&&c.hasListeners()&&(-1!==d.indexOf(p)?a.removeEventListener(p,this.onSystemEvent):y.wrap(a).off(p,
this,this.onSystemEvent))}}};b.removeAllElements=function(){for(var a=this._eventElements.length-1;0<=a;a--)this.removeElement(this._eventElements[a])};b.eventMessage=function(){if(!this._eventMessage){for(var a in this._plugins)this._eventMessage=this._eventMessage?this._eventMessage+","+a:"Must be one of ["+a;this._eventMessage&&(this._eventMessage+="]")}return this._eventMessage};return c}(),Ua=new nc(null,"globalEvents");Ua.extend({install:{},init:{}});var ta=function(){return new ob(function(d){return new Nc(d)})}(),
Nc=function(){var d="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),e=function(a){Wa.call(this,ta,a)},a=X(e,Wa),c=function(a,b){a["on"+b.name]=function(a,c){b.listen(a,c)};a["off"+b.name]=function(a,c){b.unlisten(a,
c)}};a.extend=function(a){this.def=a;Ua.install.listen(this,this.install);var b=a.events;a=a.userEventDef;if(b||a){this.on||(this.on=new nc(this,this.name));if(b)for(var e in b){var f=b[e],r=this.on.extend.call(this.on,e,f);c(this,r);f&&f.pub&&(this.hasPublicEvents=!0)}a&&(a.systemEvent=!0,this.on.extend.call(this.on,d,a),a.pub&&(this.hasPublicEvents=!0))}};a.install=function(){var a=this,b=this.def;delete this.def;b.install&&b.install(this);if(a.hasPublicEvents||b.exports&&0<b.exports.length){OIT[a.name]||
(nb(a.name,{}),a.publicName="OIT."+a.name);var c={};a.hasPublicEvents&&(a.addEventListener||(c.addEventListener={value:function(b,c){var d=!1,e=a.on[b];e?d=e.addPublicListener(c):a.invalidArg("addEventListener","name",b,a.on.eventMessage());return d}}),a.removeEventListener||(c.removeEventListener={value:function(b,c){var d=!1,e=a.on[b];e?d=e.removePublicListener(c):a.invalidArg("removeEventListener","name",b,a.on.eventMessage());return d}}));if(b.exports&&0<b.exports.length)for(var d=0;d<b.exports.length;d++){var e=
b.exports[d],m=a[e];void 0!==m&&(c||(c={}),c[e]={value:m})}Object.defineProperties(OIT[a.name],c)}};var b=function(a,c){if(Array.isArray(c))for(var d=0;d<c.length;d++){if(b(a,c[d]))return!0}else{if(void 0===a)return!0;switch(c){case "null":if(null===a)return!0;break;case "function":if(null===a||Na(a))return!0;break;case "DOMRange":if(null===a||Pa(a))return!0;break;case "DOMSelection":if(null===a||Xa(a))return!0;break;case "RegExp":if(null===a||a instanceof RegExp)return!0;break;case "string":if(null===
a||"string"===typeof a)return!0;break;default:if(typeof a===c)return!0}}return!1};a.processArguments=function(a,c,d){for(var e={},f=0,m=0;f<d.length;f++){var p=d[f];e&&p.def&&(e[p.name]=p.def);if(m>=c.length)p.req&&(this.logError(a,"Argument '"+p.name+"' is required"),e=null);else{var z=c[m];if(b(z,p.type)){var q=null;p.val?q=p.val(z):p.legal&&-1==p.legal.indexOf(z)&&(q="Must be one of "+JSON.stringify(p.legal));q?(this.invalidArg(a,p.name,z,q),e=null):e&&(e[p.name]=z);m++}else p.req&&(this.invalidArg(a,
p.name,z,"Must be of type "+JSON.stringify(p.type)),m++,e=null)}}return e};return e}(),tb=function(){return new ob(function(d){return new Oc(d)})}(),Oc=function(){var d=function(a){Wa.call(this,tb,a)},e=X(d,Wa);e.extend=function(a){this.def=a;Ua.install.listen(this,this.install)};e.install=function(){var a=this.def;delete this.def;a.install&&a.install(this)};e.init=function(a){if(a.isLoaded())this.load(a);else{var c=this;a.load(!0,function(){c.load(a)})}};e.load=function(a){};e.unload=function(){};
e.visiblePages=function(){return[B.activePage()]};e.saveScrollPos=function(){};e.restoreScrollPos=function(a){};e.maxPageWidth=function(){return B.maxWidth()};e.maxPageHeight=function(){return B.maxHeight()};e.padding=function(){return{left:0,top:0,right:0,bottom:0}};e.margin=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollOffset=function(){return w.viewNode.scroll()};e.startElasticScroll=function(){};e.elasticScroll=function(a,c){};e.endElasticScroll=function(a,c){};e.getSelectedText=function(){return y.selectedText()};
e.select=function(a){return!1};e.keydown=function(a){return!0};e.showHidden=function(a){};e.loadRange=function(a,c){c&&c(a)};e.expandRange=function(a){return a};e.moveto=function(a,c,b){return!1};e.pageRange=function(a,c){};e.pageRect=function(a,c,b){return B.elementRect(B.page(a),c)};e.rangeRect=function(a,c,b,d){};e.rangeFromRect=function(a,c,b,d,e,v,l){};e.extendRange=function(a,c,b,d){};e.moveAnchor=function(a,c,b,d){return!1};e.incrementSelection=function(a,c,b,d,e){return!1};e.layoutChanged=
function(a){};e.update=function(a){};return d}(),Fa=function(){var d=new ob(function(d){return new Pc(d)});d.createDisplay=function(e){if(e=d.item(e))return tb.item(e.de)};d.features=function(e){if(e=d.item(e))return e.features};return d}(),Pc=function(){var d="zoom rotate showhidden pages fitpage highlights textselection rectselection rectredaction cellselection customtextselection anchorednotes elasticScroll".split(" "),e=function(a){Wa.call(this,Fa,a)};X(e,Wa).extend=function(a){this.de=a.de;for(var c=
this.features={},b=0;b<d.length;b++){var e=d[b],k=a[e];void 0===k&&(k=!0);c[e]=k}};return e}(),gb,hb,Xb,pb,Ha,ya,Yb,ub,aa=function(d){return"number"===typeof d},Ya=function(d){return"string"===typeof d};(function(){var d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",
chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",
deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",
lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",
mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",
pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",
wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"rgba(0,0,0,0)"},e=1/6,a=1/3,c=2/3,b=function(a,b,d){0>d?d+=1:1<d&&--d;d<e?a+=(b-a)*d*6:.5>d?a=b:d<c&&(a+=(b-a)*(c-d)*6);return 255*a|0},f=[{property:"webkit",css:"-webkit-"},{property:"Moz",css:"-moz-"},{property:"ms",css:"-ms-"},{property:"O",css:"-o-"}],k=function(a,b,c){var d=Y.documentElement;if(Ya(d.style[a]))return b;if(!1!==c)for(a=a.charAt(0).toUpperCase()+a.slice(1),c=0;c<f.length;c++)if(Ya(d.style[f[c].property+
a]))return f[c].css+b},v=function(a,b){for(var c,d=Y.createElement("div"),e=0;e<b.length;e++)if(d.style[a]=b[e],d.style[a]===b[e]){c=b[e];break}return c};gb={transform:k("transform","transform"),"transform-origin":k("transformOrigin","transform-origin")};Qb=v("cursor",["grab","-webkit-grab","-moz-grab","move"]);Rb=v("cursor",["grabbing","-webkit-grabbing","-moz-grabbing","move"]);var l=function(a,b){if(-1!=b)for(var c=a.chars;b<c.length;b++){var d=c[b];if(" "!==d&&"\n"!==d&&"\r"!==d&&"\t"!==d){"/"===
d&&"*"===c[b+1]&&(c=a.string.indexOf("*/",b+2),b=-1==c?a.string.length:c+2);break}}return b},r=function(a,b,c){return-1!=b&&a.chars[b]!==c?-1:++b};hb=function(a){var b;if(a){b={};a={string:a,chars:a.split("")};for(var c=0;-1!=c&&c<a.chars.length;){var d=a,e=c,c=b,f={},m=e=l(d,e);if(-1!=m){for(var k=d.chars,e=m;e<k.length;e++){var v=k[e];if(!("a"<=v&&"z">=v||"A"<=v&&"Z">=v||"0"<=v&&"9">=v)&&"-"!==v&&"_"!==v)break}e>m?(f.name=d.string.substring(m,e),m=e):m=-1}e=m;e=l(d,e);e=r(d,e,":");m=e=l(d,e);if(-1!=
m){k=d.chars;for(e=m;e<k.length;e++){v=k[e];if("!"===v||";"===v)break;if('"'===v||"'"===v||"("===v){"("===v&&(v=")");for(var E=e+1;E<k.length;E++){var h=k[E];if(h===v){e=E;break}else if("\\"===h){h=k[++E];if("0"<=h&&"9">=h||"a"<=h&&"f">=h||"A"<=h&&"F">=h){do h=k[++E];while("0"<=h&&"9">=h||"a"<=h&&"f">=h||"A"<=h&&"F">=h)}e=E;break}}}}e>m?(f.value=d.string.substring(m,e),m=e):m=-1}e=m;e=l(d,e);m=f;-1!=e&&"!important"===d.string.substring(e,e+10)&&(m.important=!0,e+=10);e=l(d,e);e<d.chars.length&&(e=
r(d,e,";"));-1!=e&&(c[f.name]=f.value);c=e}}return b};Xb=function(a,b){var c=[];if(a)for(var d in a)a.hasOwnProperty(d)&&(b?c.push(d,":",a[d]," !important;"):c.push(d,":",a[d],";"));return c.join("")};pb=function(a,b){if(a&&Ya(a)&&Ya(b)){for(var c=0;;){c=a.indexOf(b,c);if(-1===c||0===c)break;var d=a.charAt(c-1);if(";"==d||" "==d)break;c++}if(-1!=c){for(c+=b.length;" "===a.charAt(c);)c++;if(":"===a.charAt(c)){for(c++;" "===a.charAt(c);)c++;d=a.indexOf(";",c);-1===d&&(d=a.length);for(;d>c&&" "===a.charAt(d-
1);)d--;return a.substring(c,d)}}}};Ha=function(){var a=arguments;if(1==a.length){a=a[0];if(Ya(a))a=ya(a);else if(void 0===a.r||void 0===a.g||void 0===a.b)a=void 0;if(a)return Ha(a.r,a.g,a.b,a.a)}else if(3==a.length||4==a.length){var b=K(ka(a[0],0,255)),c=K(ka(a[1],0,255)),d=K(ka(a[2],0,255)),e=1;4==a.length&&void 0!==a[3]&&(e=ka(a[3],0,1));if(1!=e)return"rgba("+b+","+c+","+d+","+e+")";b=b.toString(16);c=c.toString(16);d=d.toString(16);2>b.length&&(b="0"+b);2>c.length&&(c="0"+c);2>d.length&&(d="0"+
d);return"#"+b+c+d}};ya=function(c){if(c){var e,f;if(0===c.indexOf("#")){if(e={r:parseInt(c.substring(1,3),16),g:parseInt(c.substring(3,5),16),b:parseInt(c.substring(5,7),16),a:1},isNaN(e.b)){f=c.substring(1,2);var q=c.substring(2,3);c=c.substring(3,4);q+=q;c+=c;e.r=parseInt(f+f,16);e.g=parseInt(q,16);e.b=parseInt(c,16)}}else if(0===c.indexOf("rgba(")||0===c.indexOf("rgb(")){e=c.replace(/[^\d.,]/g,"").split(",");for(f=0;f<e.length;f++)e[f]=Number(e[f]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);
e={r:e[0],g:e[1],b:e[2],a:e[3]}}else if(0===c.indexOf("hsla(")||0===c.indexOf("hsl(")){e=c.replace(/[^\d.,]/g,"").split(",");for(f=0;f<e.length;f++)e[f]=Number(e[f]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);f=e[0];c=e[1];q=e[2];f/=360;c/=100;q/=100;if(0===c)q=c=f=255*q|0;else{var k=.5>q?q*(1+c):q+c-q*c,m=2*q-k,q=b(m,k,f+a);c=b(m,k,f);f=b(m,k,f-a)}e={r:q,g:c,b:f,a:e[3]}}else if(f=d[c.toLowerCase()])return ya(f);if(e)return e.r=ka(e.r,0,255),e.g=ka(e.g,0,255),e.b=ka(e.b,0,255),e.a=ka(e.a,
0,1),e}};Yb=function(a,b,c,d){1<c||(c=1);var e=ya(a);b=ya(b);if(!e||!b)return a;var f;!0===d?(a=(e.r+b.r*c)/(1+c),d=(e.g+b.g*c)/(1+c),f=(e.b+b.b*c)/(1+c),c=(e.a+b.a*c)/(1+c)):(b.a=1-e.a,a=e.r*e.a+b.r*b.a,d=e.g*e.a+b.g*b.a,f=e.b*e.a+b.b*b.a,c=1);return Ha(a,d,f,c)};ub=function(a){if(void 0!==a&&null!==a&&""!==a){var b=Number(a);if(!isNaN(b))return b+"px";if(a.match(/(\d|\.)+(em|ex|px|in|pt|pc|mm|cm|\%)/))return a}else return null}})();var R;OIT.local||nb("local",{ADDED_COLUMN:"Inserted Column",ADDED_ROW:"Inserted Row",
ADDED_SHEET:"Added Sheet",ANNO_CHANGE_FROM:"from",ANNO_CHANGE_TO:"to",ANNOTATIONS:"Annotations",ANNOTATION_TYPE:"Annotation Type",AUTHOR_A_TO_Z:"Author A-Z",AUTHOR_Z_TO_A:"Author Z-A",CANCEL:"Cancel",CHANGED_TEXT:"Changed Text",CLEAR_CELL:"Cleared Cell",COLUMN:"Column",COMMENT:"Comment",DEL:"DEL",DELETED_COLUMN:"Deleted Column",DELETED_ROW:"Deleted Row",DELETED_TEXT:"Deleted Text",DISCARD_CHANGES:"Discard changes",DOCUMENT_ERROR:"Error occurred, document incomplete.",HIDDEN_SLIDE:"This slide is hidden in presentation mode",
HIDDEN_TEXT:"Hidden Text",INSERTED_TEXT:"Inserted Text",LABEL_SEPARATOR:":",LOADING:"Loading",LOCATION:"Location",MODIFIED_CELL:"Modified Cell",MOVED_CELLS:"Moved Cells",NEW_CELL:"New Cell",NEWEST_FIRST:"Newest first",NO:"No",NO_SUBJECT:"(No Subject)",NOTES:"Notes",OK:"OK",OLDEST_FIRST:"Oldest first",PAGE_DOWN:"Next Page",PAGE_UP:"Previous Page",PLEASE_WAIT:"Please wait",PLEASE_WAIT_CONVERTING:"Document conversion in progress...",PLEASE_WAIT_DOWNLOADING:"Loading document, please wait",PLEASE_WAIT_INITIALIZING:"Please wait while your<br>document is loaded...",
PREPARING_TO_PRINT:"Preparing to print...",RENAMED_SHEET:"Renamed Sheet",ROW:"Row",SAVE_CHANGES:"Save changes",SHOWDETAILS:"Show Details",SORT_BY:"Sort by: ",HIDEDETAILS:"Hide Details",UNKNOWN_FIELD:"[Unknown Field]",UNSUPPORTED_CONTENT:"(Unsupported Content)",YES:"Yes",HIDDEN_CONTENT_HIDDEN:"Hidden content (Not Visible)",HIDDEN_CONTENT_PARTIAL:"Hidden content (Partially Visible)",HIDDEN_CONTENT_VISIBLE:"Hidden content (Visible)",HIDDEN_CONTENT_NOTIFICATION:"This document contains hidden information:",
HIDDEN_CONTENT_INVISIBLE:"These items are not currently visible in the viewer.",HIDDEN_CONTENT_SHOWLINK:"Show these items",HIDDEN_CONTENT_ALREADY_VISIBLE:"These items are already visible in the viewer.",HIDDEN_CONTENT_ORIGINAL_APPLICATION:"This document contains information that cannot be displayed in the browser. Open the document in the native application to view the full document content:",HIDDEN_CONTENT_HIDELINK:"Hide these items",HIDDEN_CONTENT_ANNOTATIONS:"Annotations",HIDDEN_CONTENT_PAGES:"Hidden pages",
HIDDEN_CONTENT_COLUMNS:"Hidden columns",HIDDEN_CONTENT_ROWS:"Hidden rows",HIDDEN_CONTENT_COMMENTS:"Comments",HIDDEN_CONTENT_SPEAKER_NOTES:"Speaker Notes",HIDDEN_CONTENT_SLIDES:"Hidden slides",HIDDEN_CONTENT_TEXT:"Hidden text",HIDDEN_CONTENT_TRACKED_CHANGES:"Tracked changes",HIDDEN_CONTENT_LARGE_SHEET:"The worksheet is larger than the browser can display",DOCUMENT_ERRORS:"Document Errors",DOCUMENT_EXCEPTION_NOTIFICATION:"Errors were encountered while processing this document:",DOCEX_MISSING_MAP:"Some text could not be mapped to displayable characters",
DOCEX_VERTICAL_TEXT:"Vertical text was present, but could not be displayed correctly",DOCEX_TEXT_EFFECTS:"Some text had unsupported text effects applied",DOCEX_UNSUPPORTED_COMPRESSION:"An embedded graphic used an unsupported compression",DOCEX_UNSUPPORTED_COLOR_SPACE:"An embedded graphic used an unsupported color space",DOCEX_FORMS:"Forms were present but could not be displayed correctly",DOCEX_RIGHT_TO_LEFT_TABLES:"A table had right to left columns",DOCEX_ALIASED_FONT:"A required font was missing, but a font alias was used",
DOCEX_MISSING_FONT:"A required font was not present on the system",DOCEX_SUBDOC_FAILED:"Part of the document could not be converted",DOCEX_TYPE_THREE_FONT:"An unsupported font was required by the document",DOCEX_UNSUPPORTED_SHADING:"The document used an unsupported shading type",DOCEX_INVALID_HTML:"Invalid HTML was encountered",DOCEX_VECTOR_OBJECT_LIMIT:"Not all of the vector objects could be displayed",DOCEX_INVALID_ANNOTATIONS_NOT_APPLIED:"An invalid annotation could not be applied",DOCEX_INLINE_IMAGE_FOUND:"An embedded graphic could not be rendered",
EMAIL_TO:"To",EMAIL_CC:"CC",EMAIL_BCC:"BCC",EMAIL_SUBJECT:"Subject",EMAIL_MSGFLAG:"Message Flag",EMAIL_FLAGSTS:"Flag Status",EMAIL_EXPIRES:"Expires",EMAIL_CATEGORIES:"Categories",EMAIL_IMPORTANCE:"Importance",EMAIL_SENSITIVITY:"Sensitivity",EMAIL_LOCATION:"Location",EMAIL_FULLNAME:"Full Name",EMAIL_JOBTITLE:"Job Title",EMAIL_COMPANY:"Company",EMAIL_EMAIL:"Email",EMAIL_WEBPAGE:"Webpage",EMAIL_WORKPHONE:"Work Telephone",EMAIL_HOMEPHONE:"Telephone",EMAIL_FROM:"From",EMAIL_ATTACHMENT:"Attachments",EMAIL_RTFBODY:"RTF Embedded Body",
EMAIL_RECEIVED:"Received",EMAIL_SIZE:"Size",EMAIL_LASTMODIFIED:"Last Modified",EMAIL_NEWSGROUPS:"Newsgroups",EMAIL_SUBMITTIME:"Submit Time",EMAIL_CCME:"CC Me",EMAIL_ALTERNATE_RECIPIENT_ALLOWED:"Alternate Recipient Allowed",EMAIL_CLIENT_SUBMIT_TIME:"Sent",EMAIL_CREATION_TIME:"Created",EMAIL_CONVERSATION_INDEX:"Conversation Index",EMAIL_CONVERSATION_TOPIC:"Topic",EMAIL_MESSAGE_SUBMISSION_ID:"Message Submission ID",EMAIL_MESSAGE_CLASS:"Message Class",EMAIL_ORIGINATOR_DELIVERY_REPORT_REQUESTED:"Originator Delivery Report Requested",
EMAIL_READ_RECEIPT_REQUESTED:"Read Receipt Requested",EMAIL_RCVD_REPRESENTING_ADDRTYPE:"Received Representing Address Type",EMAIL_RCVD_REPRESENTING_EMAIL_ADDRESS:"Received Representing Email",EMAIL_RCVD_REPRESENTING_ENTRYID:"Received Representing Entry ID",EMAIL_RCVD_REPRESENTING_NAME:"Received Representing Name",EMAIL_RCVD_REPRESENTING_SEARCH_KEY:"Received Representing Search Key",EMAIL_RECEIVED_BY_ADDRTYPE:"Received By Address Type",EMAIL_RECEIVED_BY_EMAIL_ADDRESS:"Received By Email",EMAIL_RECEIVED_BY_ENTRYID:"Received By Entry ID",
EMAIL_RECEIVED_BY_NAME:"Received By Name",EMAIL_RECEIVED_BY_SEARCH_KEY:"Received By Search Key",EMAIL_RTF_IN_SYNC:"RTF In Sync",EMAIL_RTF_SYNC_BODY_COUNT:"RTF Sync Body Count",EMAIL_RTF_SYNC_BODY_CRC:"RTF Sync Body CRC",EMAIL_RTF_SYNC_BODY_TAG:"RTF Sync Body Tag",EMAIL_RTF_SYNC_PREFIX_COUNT:"RTF Sync Prefix Count",EMAIL_RTF_SYNC_TRAILING_COUNT:"RTF Sync Trailing Count",EMAIL_SEARCH_KEY:"Search Key",EMAIL_SENDER_ADDRTYPE:"Sender Address",EMAIL_SENDER_EMAIL_ADDRESS:"Sender Email",EMAIL_SENDER_ENTRYID:"Sender Entry ID",
EMAIL_SENDER_NAME:"Sender Name",EMAIL_SENDER_SEARCH_KEY:"Sender Search Key",EMAIL_SENT_REPRESENTING_ADDRTYPE:"Sent Representing Addr Type",EMAIL_SENT_REPRESENTING_EMAIL_ADDRESS:"Sent Representing Email",EMAIL_SENT_REPRESENTING_ENTRYID:"Sent Representing Entry ID",EMAIL_SENT_REPRESENTING_SEARCH_KEY:"Sent Representing Search Key",EMAIL_TRANSPORT_MESSAGE_HEADERS:"Transport Message Headers",EMAIL_PRIORITY:"Priority",EMAIL_AUTO_FORWARDED:"Auto Forwarded",EMAIL_DEFERRED_DELIVERY_TIME:"Deferred Delivery Type",
EMAIL_EXPIRY_TIME:"Expiry Time",EMAIL_LATEST_DELIVERY_TIME:"Latest Delivery Time",EMAIL_RECIPIENT_REASSIGNMENT_PROHIBITED:"Recipient Reassignment Prohibited",EMAIL_REPLY_TIME:"Reply Time",EMAIL_REPORT_TAG:"Report Tag",EMAIL_RESPONSE_REQUESTED:"Response Requested",EMAIL_REPLY_REQUESTED:"Reply Requested",EMAIL_DELETE_AFTER_SUBMIT:"Delete After Submit",EMAIL_MESSAGE_LOCALE_ID:"Message Locale ID",EMAIL_CREATOR_NAME:"Creator Name",EMAIL_CREATOR_ENTRYID:"Creator Entry ID",EMAIL_LAST_MODIFIER_NAME:"Last Modifier Name",
EMAIL_LAST_MODIFIER_ENTRYID:"Last Modifier Entry ID",EMAIL_INTERNET_ARTICLE_NUMBER:"Internet Artical Number",EMAIL_NT_SECURITY_DESCRIPTOR:"NT Security Descriptor",EMAIL_TRUST_SENDER:"Trust Sender",EMAIL_INTERNET_MESSAGE_ID:"Internet Message ID",EMAIL_ATTR_HIDDEN:"Hidden",EMAIL_ATTR_SYSTEM:"System",EMAIL_ATTR_READONLY:"Read Only",EMAIL_INTERNET_CPID:"Internet CPID",EMAIL_MESSAGE_CODEPAGE:"Message Codepage",EMAIL_SENDER_FLAGS:"Sender Flags",EMAIL_SENT_REPRESENTING_FLAGS:"Sent Representing Flags",EMAIL_RCVD_BY_FLAGS:"Recived By Flags",
EMAIL_RCVD_REPRESENTING_FLAGS:"Received Representing Flags",EMAIL_INET_MAIL_OVERRIDE_FORMAT:"Internet Mail Override Format",EMAIL_MSG_EDITOR_FORMAT:"MSG Editor Format",EMAIL_PROFILE_CONNECT_FLAGS:"Profile Connect Flags",EMAIL_SENT_REPRESENTING_NAME:"Sent Representing Name",EMAIL_ENTRYID:"Entry ID",EMAIL_NORMALIZED_SUBJECT:"Normalized Subject",EMAIL_ATTENDEES:"Attendees",EMAIL_REQATTENDEE:"Required Attendees",EMAIL_OPTATTENDEE:"Optional Attendees",EMAIL_FILEAS:"File as",EMAIL_DISPLAYAS:"Display As (E-mail)",
EMAIL_TITLE:"Title",EMAIL_SUFFIX:"Suffix",EMAIL_NICKNAME:"Nickname",EMAIL_PROFESSION:"Profession",EMAIL_DEPARTMENT:"Department",EMAIL_OFFICE:"Office",EMAIL_ANNIVERSARY:"Anniversary",EMAIL_BIRTHDATE:"Birth date",EMAIL_ASSISTANTSNAME:"Assistant's Name",EMAIL_SPOUSESNAME:"Spouse's Name",EMAIL_MANAGERSNAME:"Manager's Name",EMAIL_BUSINESSADDRESS:"Business Address",EMAIL_BUSINESSPHONE:"Telephone",EMAIL_HOMEADDRESS:"Home Address",EMAIL_OTHERADDRESS:"Other Address",EMAIL_MOBILEPHONE:"Mobile",EMAIL_BUSINESSFAX:"Fax",
EMAIL_IMADDRESS:"IM",EMAIL_INTERNETFREEBUSYADDR:"Internet Free Busy Address",EMAIL_REMINDERTOPIC:"Reminder Topic",EMAIL_CONTACTS:"Contacts",EMAIL_CALLBACKPHONE:"Callback Telephone",EMAIL_FIRST:"First",EMAIL_FAMILY:"Last",EMAIL_TELENUMBER:"Telephone",EMAIL_BUSINESSPHONE2:"Telephone 2",EMAIL_RADIOPHONE:"Radio Telephone",EMAIL_CARPHONE:"Car Telephone",EMAIL_OTHERPHONE:"Telephone",EMAIL_PAGERPHONE:"Pager",EMAIL_OTHERFAX:"Fax",EMAIL_HOMEFAX:"Fax",EMAIL_TELEXPHONE:"Telex Telephone",EMAIL_ISDN:"ISDN Telephone",
EMAIL_ASSISTANTPHONE:"Assistant Telephone",EMAIL_HOMEPHONE2:"Telephone 2",EMAIL_MIDDLE:"Middle",EMAIL_TTYTTDPHONE:"TTY/TTD Telephone",EMAIL_GENDER:"Gender",EMAIL_PERSONALHOMEPAGE:"Personal Home Page",EMAIL_COMPANYPHONE:"Company Telephone",EMAIL_HOMECITY:"City",EMAIL_HOMECOUNTRY:"Country",EMAIL_POSTALCODE:"Postal Code",EMAIL_HOMESTATE:"State",EMAIL_HOMESTREET:"Street",EMAIL_HOMEPOBOX:"PO Box",EMAIL_OTHERCITY:"City",EMAIL_OTHERCOUNTRY:"Country",EMAIL_OTHERPOSTALCODE:"Postal Code",EMAIL_OTHERSTATE:"State",
EMAIL_OTHERSTREET:"Street",EMAIL_OTHERPOBOX:"PO Box",EMAIL_BUSINESSSTREET:"Street",EMAIL_BUSINESSCITY:"City",EMAIL_BUSINESSSTATE:"State",EMAIL_BUSINESSPOSTALCODE:"Postal Code",EMAIL_BUSINESSCOUNTRY:"Country",EMAIL_BUSINESSPOBOX:"PO Box",EMAIL_DISPLAYAS2:"Display As (E-mail 2)",EMAIL_EMAIL2:"Email 2",EMAIL_DISPLAYAS3:"Display As (E-mail 3)",EMAIL_EMAIL3:"Email 3",EMAIL_DTSTART:"Start Time",EMAIL_DTEND:"End Time",EMAIL_START:"Start",EMAIL_DURATION:"Duration",EMAIL_ACCUREATTYPE1:"Accurate Type 1",EMAIL_ENTRY_TYPE:"Entry Type",
EMAIL_STATUS:"Status",EMAIL_PERCENT_COMPLETE:"Percent Complete",EMAIL_START_DATE:"Start Date",EMAIL_DUE_DATE:"Due Date",EMAIL_COMPLETED:"Completed",EMAIL_ACTUALWORK:"Actual Work",EMAIL_TOTAL_WORK:"Total Work",EMAIL_OWNER:"Owner",EMAIL_BILLING:"Billing",EMAIL_MILEAGE:"Mileage",EMAIL_PROOF_OF_DELIVERY_REQUESTED:"Proof of Delivery Requested",EMAIL_PROOF_OF_SUBMISSION_REQUESTED:"Proof of Submission Requested",EMAIL_IN_REPLY_TO_ID:"In Reply To ID",EMAIL_TASK_COMPLETE:"Task Complete",EMAIL_APPOINTMENT_DURATION:"Appointment Duration",
EMAIL_RECURRENCE_TYPE:"Recurrence Type",EMAIL_RECURRENCE_RANGE:"Recurrence Range",EMAIL_ORGANIZER:"Organizer",EMAIL_CALENDAR_EXCEPTION:"Calendar Exceptions",EMAIL_RSVP:"RSVP",EMAIL_ROLE:"Role",EMAIL_ATTENDEE:"Attendee",EMAIL_ADDRESS:"Address",EMAIL_POBOX:"PO Box",EMAIL_EXTADDRESS:"Ext Address",EMAIL_STREET:"Street",EMAIL_CITY:"City",EMAIL_REGION:"Region",EMAIL_COUNTRY:"Country",EMAIL_TYPE:"Type",EMAIL_NAME:"Name",EMAIL_LOGO:"Logo",EMAIL_PHOTO:"Photo",EMAIL_ALARM:"Alarm",EMAIL_DESCRIPTION:"Description",
EMAIL_DATE:"Date"});R=OIT.local;var Ia,db,gc=598,Sb=599;(function(){var d=[],e=Date.now(),a=function(a){return kb(d,"request",a)},c=function(b){var c=a(this);if(!c)throw"request.start(): Invalid request object";if(!c.aborted){if(void 0!==this.status)throw"request.start(): Request is already completed";if("number"!==typeof b||0>b)throw"request.start(): fileSize must be a non-negative integer indicating the total size of the requested file in bytes";if(void 0!==c.contentLength)throw"request.start(): start should only be called once per request";
c.contentLength=b;p(c,"")}},b=function(b){var c=a(this);if(!c)throw"request.loading(): Invalid request object";if(!c.aborted){if(void 0!==this.status)throw"request.loading(): Request is already completed";if("string"!==typeof b)throw"request.loading(): responseText must be a string containing the partial or complete contents of the requested file";if(void 0!==this.contentLength&&b.length>this.contentLength)throw"request.loading(): responseText length must not exceed the size specified to request.start";
c.responseText=b;void 0!==c.contentLength&&p(c,b)}},f=function(b){var c=a(this);if(!c)throw"request.done(): Invalid request object";if(!c.aborted){if("number"!==typeof b||0>=b)throw"request.done(): status must be a positive integer HTTP status code";if(0===b)c.timeout=!0;else if(200===b){if(void 0===c.responseText)throw"request.done(): request.loading() was never called";if(void 0!==c.contentLength&&c.responseText.length!==c.contentLength)throw"request.done(): responseText length must be equal to the contentLength passed in to request.start()";
}Object.defineProperty(this,"status",{value:b});c.contentLength=c.responseText.length;Object.defineProperty(this,"responseText",{value:c.responseText});Da(d,c);m(c)}},k=function(){var b=a(this);if(!b)throw"request.abort(): Invalid request object";b.aborted=!0;m(b)},v=function(a,e){var q={};Object.defineProperties(q,{url:{value:a},start:{value:c},loading:{value:b},done:{value:f},abort:{value:k}});e.request=q;e.isLocal=!0;d.push(e);return q},l=function(a){a.inDispatch=!0;F.on.ajax.dispatch(a.request);
a.inDispatch=!1},r=function(a,b){var c=a[b];if(c){var d=Array.prototype.slice.call(arguments,2);a.args&&(d=d.concat(a.args));c.apply(a.context,d)}},m=function(a){var b="unknown"!=typeof a.request.responseText?a.request.responseText:void 0,c=a.request.status;0===c||a.aborted?(c=gc,a.aborted=!0,F.on.ajax.hasListeners()&&F.on.ajaxabort.hasListeners()&&F.on.ajaxabort.dispatch(this)):a.timeout&&(c=Sb);a.contentLength=b.length;200===c?r(a,"success",a.url,a.contentLength,b,c):r(a,"error",a.url,a.contentLength,
b,c);r(a,"complete",a.url,a.contentLength,b,c)},p=function(a,b){r(a,"loading",a.url,a.contentLength,b)};Ia=function(a){var b=a.url,c;if("string"===typeof b&&0<b.length){var f={context:null},q;for(q in a)f[q]=a[q];F.on.ajax.hasListeners()?(v(b,f),ba(l,0,null,f),c=f):Q.XMLHttpRequest&&(f.request=new XMLHttpRequest,!1===a.cache&&(b=-1!=b.indexOf("?")?b+"&":b+"?",++e,b+="_="+e),f.request.onreadystatechange=function(){if(!f.aborted)switch(f.request.readyState){case 2:f.contentLength=Number(f.request.getResponseHeader("Content-Length"));
p(f,"");break;case 3:p(f,"unknown"!=typeof f.request.responseText?f.request.responseText:void 0);break;case 4:m(f),Da(d,f)}},f.request.ontimeout=function(){f.timeout=!0;m(f)},f.request.open("GET",b,!0),f.request.send(),d.push(f),c=f)}return c};var z=function(a){a.aborted=!0;a.request&&a.request.abort()};db=function(a){a?(Da(d,a),z(a)):(pa(d,z),d=[])}})();var K=function(d,e){return e&&1<e?Math.round(d*e)/e:Math.floor(0>d?d-.5:d+.5)},ka=function(d,e,a){d<e?d=e:d>a&&(d=a);return d},Tb=function(d,e,a,
c){if(d==a&&e==c)return 0;d=a-d;e=c-e;return K(Math.sqrt(d*d+e*e))},Ub=function(d,e){if("deg"===e)d%=360,0>d&&(d+=360);else{var a=Math.PI,c=2*a;d%=c;d<-a?d+=c:d>a&&(d-=c)}return d},Zb=function(d,e,a){void 0===a&&(a=1.01);return(d>e?Math.abs(d/e):Math.abs(e/d))<=a},$b,qb,Oa,ba,sa,ib,Vb;(function(){for(var d=[],e=[],a=[],c=Q.requestAnimationFrame,b=Q.cancelAnimationFrame,f=0,k=["ms","moz","webkit","o"],v=0;v<k.length&&!c;++v)c=Q[k[v]+"RequestAnimationFrame"],b=Q[k[v]+"CancelAnimationFrame"]||Q[k[v]+
"CancelRequestAnimationFrame"];c||(c=function(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-f)),d=Q.setTimeout(function(){a(b+c)},c);f=b+c;return d});b||(b=function(a){Q.clearTimeout(a)});$b=function(){var c;for(c=0;c<d.length;c++)Q.clearInterval(d[c].id);d=[];for(c=0;c<e.length;c++)Q.clearTimeout(e[c].id);e=[];for(c=0;c<a.length;c++)b.call(Q,a[c].id);a=[]};var l=function(a,b,c,d){var e=0;d={fn:a[e++],remove:!!d};b&&(d.timeout=a[e++]);d.context=a[e++];c&&(d.args=[0],d.ts=!0);a.length>e&&(a=Array.prototype.slice.call(a,
e),d.args=d.args?d.args.concat(a):a);return d},r=function(a,b,c){try{a.remove&&Da(b,a),a.ts&&(a.args[0]=c),a.fn.apply(a.context,a.args)}catch(q){Q.OILogDebugError&&Q.OILogDebugError("Error in asynchronous timer function: "+q.message)}};qb=function(a,b,c){var e=l(arguments,!0,!1,!1);d.push(e);e.id=Q.setInterval(function(){r(e,d)},e.timeout);return e.id};Oa=function(a){Q.clearInterval(a);vb(d,"id",a)};ba=function(a,b,c){var d=l(arguments,!0,!1,!0);e.push(d);d.id=Q.setTimeout(function(){r(d,e)},b);return d.id};
sa=function(a){Q.clearTimeout(a);vb(e,"id",a)};ib=function(b,d){for(var e,f=0;f<a.length;f++)if(e=a[f],e.fn===b&&e.context===d)return e.id;e=l(arguments,!1,!0,!0);a.push(e);e.id=c.call(Q,function(b){r(e,a,b)});return e.id};Vb=function(c){b.call(Q,c);vb(a,"id",c)};Ua.install.listen(function(){F.onreset(function(){$b();d=[];e=[];a=[]})})})();var va,$a,Gb,Ja,Za,Na,Pa,Xa,oc,Ka,ab,pa,wb,pc,jb,qc,rc,Da,vb,kb,ac,Fb,bc,sc,tc,xb,uc,La,vc,wc,xc,lc,mc;(function(){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),
e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,a=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/,c=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,
b=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
f=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,k=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},l=Math.pow(2,53),r="oit-emhdrvalue oit-emhdrlabel oit-emhdrsection oit-email oit-rt oit-sn oit-comment-text oit-comment-date oit-comment-author oit-anno-text oit-anno-date oit-anno-author oit-overlay".split(" ");va=function(a){for(a=y.unwrap(a);a&&!y.isElement(a);)a=a.parentNode;var b;a&&(a=y.wrap(a),b=a.hasClass(r)?a:a.ancestorByClass(r));return b?b:null};$a=function(a){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()};
Gb=function(a,b,c){var d=a.indexOf(":");if(0<d){var e=Gb(a.slice(0,d),b,c);a=Gb(a.slice(d+1),b,c);e.c2=a.c1;e.r2=a.r1;return e}var e=!1,d=0,f=!1,h=0,u=0,g=a.length,t=a.charCodeAt(u);u<g&&36==t&&(e=!0,u++,t=a.charCodeAt(u));for(!1===(u<g&&65<=t&&90>=t)&&(f=e);u<g&&65<=t&&90>=t;)d=26*d+(t-65+1),u++,t=a.charCodeAt(u);u<g&&36==t&&(f=!0,u++,t=a.charCodeAt(u));for(;u<g&&48<=t&&57>=t;)h=10*h+(t-48),u++,t=a.charCodeAt(u);0<d&&d--;0<h&&h--;!e&&b&&(d+=b);!f&&c&&(h+=c);return ra(d,h,d,h)};Ja=function(a){if("number"==
typeof a&&!(0>a)){if(26>a)return d[a];var b=a%26,c=(a-b)/26-1;if(702>a)return d[c]+d[b];a=Math.floor(c);c=a%26;return d[(a-c)/26-1]+d[c]+d[b]}};Za=function(a){if("number"==typeof a&&!(0>a))return(a+1).toString()};Na=function(a){return"[object Function]"==Object.prototype.toString.call(a)};Pa=function(a){return a&&void 0!==a.startContainer&&void 0!==a.startOffset&&void 0!==a.endContainer&&void 0!==a.endOffset?!0:!1};Xa=function(a){return a&&void 0!==a.anchorNode&&void 0!==a.anchorOffset&&void 0!==
a.focusNode&&void 0!==a.focusOffset?!0:!1};oc=function(a){return!/^(?:[a-z]+:)?\/\//i.test(a)};Ka=function(a,b){return a&&0!==a.length?b&&0!==b.length?"/"==a.charAt(a.length-1)?"/"==b.charAt(0)?a+b.substr(1):a+b:"/"==b.charAt(0)?a+b:a+"/"+b:a:b};ab=function(a){var b;if(Array.isArray(a)){b=[];for(var c=0;c<a.length;c++)b[c]=ab(a[c])}else{if(Na(a))return null;if(null===a)b=null;else switch(typeof a){case "object":b={};for(c in a)a.hasOwnProperty(c)&&!Na(a[c])&&(b[c]=ab(a[c]));break;case "string":b=
new String(a);break;case "number":case "boolean":case "undefined":b=a}}return b};pa=function(a,b,c){m(!1,!1,null,arguments)};wb=function(a,b){m(!1,!1,a,b)};pc=function(a,b,c){m(!1,!0,null,arguments)};jb=function(a,b,c){m(!0,!1,null,arguments)};qc=function(a,b){m(!0,!1,a,b)};var m=function(a,b,c,d){var e=0;c||(c=d[e++]);if(c&&(a||0<c.length)){var f,h=d[e++],u=d[e++],g="string"==typeof h;g||e--;d=d.length>e?Array.prototype.slice.call(d,e):void 0;g?e=z:(e=p,d||(d=[null]));if(a)for(f in c)c.hasOwnProperty(f)&&
e(c[f],h,u,d);else if(b?(f=c.length-1,b=a=-1):(f=0,a=c.length,b=1),c.item)for(;f!=a;f+=b)e(c.item(f),h,u,d);else for(;f!=a;f+=b)e(c[f],h,u,d)}},p=function(a,b,c,d){null===a||void 0===a||null!==c&&void 0!==c&&!a.filter(c)||(d[0]=a,b.apply(null,d))},z=function(a,b,c,d){a&&(null===c||void 0===c||a.filter(c))&&a[b].apply(a,d)};rc=function(a,b,c){if(a===b)return!0;if(null===a||void 0===a)return null===b||void 0===b;if(null===b||void 0===b||"[object Array]"!==Object.prototype.toString.call(a)||"[object Array]"!==
Object.prototype.toString.call(b)||a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(a[d]!==b[d])if(!0===c){if(JSON.stringify(a[d])!==JSON.stringify(b[d]))return!1}else return!1;return!0};Da=function(a,b){var c=a.indexOf(b);-1!=c&&a.splice(c,1)};vb=function(a,b,c){b=ac(a,b,c);-1!=b&&a.splice(b,1)};kb=function(a,b,c){b=ac(a,b,c);if(-1!=b)return a[b]};ac=function(a,b,c){if(Array.isArray(a)&&"string"===typeof b)for(var d=0;d<a.length;d++){var e=a[d];if(e&&e[b]===c)return d}return-1};Fb=function(a){return Pa(a)?
"[DOM Range]":Xa(a)?"[DOM Selection]":y.isElement(a)?y.unwrap(a).outerHTML:y.isText(a)?'"'+a.textContent+'"':JSON.stringify(a)};bc=function(a){a&&(a=a.replace(/[&<>"']/g,function(a){return v[a]}));return a};var q;a:{try{(new Date).toLocaleDateString("i")}catch(G){q="RangeError"===G.name;break a}q=!1}sc=function(b){if(q&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleDateString()}catch(V){}return b};tc=function(b){if(q&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleTimeString()}catch(V){}return b};
xb=function(b){if(q&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleString()}catch(V){}return b};uc=function(a){1073741824<a?(a=Math.floor(a/1073741824*10)/10,a=""+a+" GB"):1048576<a?(a=Math.floor(a/1048576*10)/10,a=""+a+" MB"):1024<a?(a=Math.floor(a/1024*10)/10,a=""+a+" KB"):a=""+Math.floor(a)+" B";return a};La=function(){if(w.isMobileOrTablet){var a=B.activePage();if(a){var b=y.create("div");a.append(b);ba(function(){b.destroy()},10)}}};vc=function(a){for(var b=a.css("width"),c=1,d=l;c<d;){var e=
Math.ceil((c+d)/2);a.css("width",e+"px");a.clientWidth!=e?d=e-1:c=e}a.css("width",b);return c};wc=function(a){for(var b=a.css("height"),c=1,d=l;c<d;){var e=Math.ceil((c+d)/2);a.css("height",e+"px");a.clientHeight!=e?d=e-1:c=e}a.css("height",b);return c};xc=function(a){var b=!1;switch(a){case "firefox":b=-1!=navigator.userAgent.toLowerCase().indexOf("firefox")}return b};lc=function(){var a=!1,d=navigator.userAgent||navigator.vendor||Q.opera;if(c.test(d)||b.test(d.substr(0,4)))a=!0;return a};mc=function(){var a=
!1,b=navigator.userAgent||navigator.vendor||Q.opera;if(f.test(b)||k.test(b.substr(0,4)))a=!0;return a}})();var Qc=function(){function d(){}function e(){console.log(Array.prototype.slice.call(arguments).join(" "))}var a={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",
iciti:"ic",ical:"ic",ful:"",ness:""};return function(b,f){var k,v,l,r,m,p;p=f?e:d;if(3>b.length)return b;l=b.substr(0,1);"y"==l&&(b=l.toUpperCase()+b.substr(1));r=/^(.+?)(ss|i)es$/;v=/^(.+?)([^s])s$/;r.test(b)?(b=b.replace(r,"$1$2"),p("1a",r,b)):v.test(b)&&(b=b.replace(v,"$1$2"),p("1a",v,b));r=/^(.+?)eed$/;v=/^(.+?)(ed|ing)$/;r.test(b)?(v=r.exec(b),r=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,r.test(v[1])&&(r=/.$/,b=b.replace(r,""),p("1b",r,b))):v.test(b)&&(v=v.exec(b),k=v[1],v=/^([^aeiou][^aeiouy]*)?[aeiouy]/,
v.test(k)&&(b=k,p("1b",v,b),v=/(at|bl|iz)$/,m=/([^aeiouylsz])\1$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,v.test(b)?(b+="e",p("1b",v,b)):m.test(b)?(r=/.$/,b=b.replace(r,""),p("1b",m,b)):k.test(b)&&(b+="e",p("1b",k,b))));r=/^(.*[aeiouy].*)y$/;r.test(b)&&(v=r.exec(b),k=v[1],b=k+"i",p("1c",r,b));r=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;r.test(b)&&(v=r.exec(b),k=v[1],v=v[2],r=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
r.test(k)&&(b=k+a[v],p("2",r,b)));r=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;r.test(b)&&(v=r.exec(b),k=v[1],v=v[2],r=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,r.test(k)&&(b=k+c[v],p("3",r,b)));r=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;v=/^(.+?)(s|t)(ion)$/;r.test(b)?(v=r.exec(b),k=v[1],r=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,r.test(k)&&(b=k,p("4",r,b))):v.test(b)&&(v=v.exec(b),
k=v[1]+v[2],v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,v.test(k)&&(b=k,p("4",v,b)));r=/^(.+?)e$/;r.test(b)&&(v=r.exec(b),k=v[1],r=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,m=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,r.test(k)||v.test(k)&&!m.test(k))&&(b=k,p("5",r,v,m,b));r=/ll$/;v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;
r.test(b)&&v.test(b)&&(r=/.$/,b=b.replace(r,""),p("5",r,v,b));"y"==l&&(b=l.toLowerCase()+b.substr(1));return b}}(),yc=ta.extend("fonts",{events:{fontload:{}},install:function(d){var e=["serif","sans-serif","monospace","cursive","fantasy"],a={},c=0,b;d.loadWebFont=function(d){var e=a[d];if(void 0===e){var k=w.rootNode;if(k){e=y.create("div","oit-fontpreloader");e.css("font-family",d);var r=y.create("span");e.append(r);r.html("AEIMNOTaeimnot130");k.append(e);a[d]=e}c=0;b||(b=ba(f,250))}};var f=function(){var k=
!1,v=!1,l,r;b=void 0;for(l in a)if((r=a[l])&&!0!==r){for(var m=!0,p,z=0;z<e.length;z++){r.css("font-family",l+","+e[z]);var q=r.offsetWidth;if(0<z&&q!=p){m=!1;break}p=q}m?(r.destroy(),v=a[l]=!0):(r.css("font-family",l),k=!0)}if(k)if(c++,20>c)b=ba(f,250);else for(l in a)(r=a[l])&&!0!==r&&(r.destroy(),a[l]=!1);v?d.on.fontload.dispatch():0===c%2&&d.on.fontload.dispatch()};F.onreset(function(){for(var d in a){var e=a[d];e&&!0!==e&&e.destroy()}a=[];c=0;b=void 0})}}),ha=ta.extend("view",{exports:"attach detach fitToContainer height info stage load unload width hasFeature".split(" "),
events:{resize:{delay:80},detach:{},update:{}},install:function(d){var e,a=0,c,b,f,k,v={},l,r=0,m=0,p,z,q,G,V,T,J;d.hasFeature=function(a){var b=!1;switch(a){case "dtsearch":b=!0}return b};var N=function(){l&&(l.hide(),l=null)};d.dispatchResize=function(){var a=w.viewNode;a&&(f&&E(),c!=a.clientWidth||b!=a.clientHeight)&&(c=a.clientWidth,b=a.clientHeight,d.on.resize.dispatch())};var E=function(){if(f){var a=f.computedStyle(),b=f.offsetWidth-parseInt(a.borderLeftWidth,10)-parseInt(a.borderRightWidth,
10),a=f.offsetHeight-parseInt(a.borderTopWidth,10)-parseInt(a.borderBottomWidth,10);w.rootNode.css({width:b+"px",height:a+"px"})}};d.dispatchScroll=function(a){var b=w.viewNode;if(b&&(d.invalidateCanvas(),F.on.scrollupdate.dispatch(),b=b.scroll(),a||b.left!=m||b.top!=r)){a=b.left-m;var c=b.top-r;m=b.left;r=b.top;F.on.scroll.dispatch(a,b.left,c,b.top)}};var h=function(){},u=function(){},g=function(){x.nochrome?w.viewNode.addClass("oit-nochrome"):w.viewNode.removeClass("oit-nochrome")},t=function(){var b=
w.rootNode;b&&(b.addClass("oit-view-root"),b=w.viewNode,b||(b=y.attach(y.create("div","oit-view")),w.viewNode=b),e="oitview"+a++,b.id=e,g(),b.attr("tabindex","-1"),b.onscroll(d.dispatchScroll),d.fitToContainer());Q.matchMedia&&(b=Q.matchMedia("print"))&&b.addListener(function(a){});Q.addEventListener("beforeprint",h);Q.addEventListener("afterprint",u);Q.addEventListener("resize",d.dispatchResize)};Ua.init.listen(function(){var a=w.rootNode;if(a){var b=a.data("json"),c=a.data("icd"),d=a.data("page");
if(b||c)k=a.parent();t();Z.initializeContent(b,c,d);F.initializeDocument()}});d.attach=function(a){a&&a!==y.unwrap(f)&&(d.detach(),f=y.wrap(a),a=w.rootNode,a||(a=w.rootNode=y.attach(y.create("div"))),a.addClass("oit-view-embedded"),f.append(a),t())};d.detach=function(){F.unload();w.viewNode&&(w.viewNode.offscroll(d.dispatchScroll),w.viewNode.removeData("_events"),y.detach(w.viewNode));w.rootNode&&y.detach(w.rootNode);y.reset();d.on.detach.dispatch();var a=w.viewNode;if(a)try{a.destroy()}catch(O){}if(a=
w.rootNode)try{a.destroy()}catch(O){}Q.removeEventListener("beforeprint",h);Q.removeEventListener("afterprint",u);Q.removeEventListener("resize",d.dispatchResize);w.rootNode=w.viewNode=null;e=f=k=void 0};d.stage=function(a){w.staging=!0;d.load(a)};var A=function(a){d.logAJAXError("load","Timed out waiting for document to load",a)};d.load=function(a){f||k?void 0===a?w.staging&&(w.staging=!1,F.showNotifications()):(d.unload(),w.dynamicContent=!0,z&&sa(z),z=ba(A,3E4,null,a),Ia({url:a,loading:U,success:S,
error:W}),l=Ga.createProgressDialog(R.PLEASE_WAIT)):d.logError("load","Call OIT.view.attach before OIT.view.load")};var U=function(a,b,c){z&&sa(z);z=ba(A,3E4,null,a);a=c?c.length:0;l&&l.update(80*a/b)},S=function(a,b,c,e){b=!0;z&&(sa(z),z=void 0);try{0===c.length?(d.logAJAXError("load","The document is empty or is still being exported",a,e,c),b=!1):b=F.installDocument(a,c)}catch(C){d.logAJAXError("load","The document could not be installed ("+C.message+")",a,e,c),b=!1}b||N()},W=function(a,b,c,e){z&&
(sa(z),z=void 0);d.logAJAXError("load","Failed to load the document index file from the server",a,e,c);N()};d.unload=function(){F.unload();y.reset()};d.fitToContainer=function(){f&&(E(),d.dispatchResize())};d.width=function(a){a=ub(a);null!==a&&(f&&f.css("width",a),w.rootNode.css("width",a),d.dispatchResize());return w.rootNode.offsetWidth};d.height=function(a){a=ub(a);null!==a&&(f&&f.css("height",a),w.rootNode.css("height",a),d.dispatchResize());return w.rootNode.offsetHeight};d.info=function(){var a=
ab(v);a.libversion=w.libversion?ab(w.libversion):"Unknown";var b=Z.manifest();b&&(a.manifest=ab(b));return a};d.infoRaw=function(){return v};d.showDocumentError=function(a){p||(p=new zc({title:R.DOCUMENT_ERRORS,closeButton:!0,className:"oit-toast-error"}));p.message(a);p.expand(!1)};var qa=function(){var a=w.rootNode,b=a.clientWidth,c=a.clientHeight,e;q=void 0;T&&(G!=b||V!=c?(T.destroy(),T=null):(e=T.getContext("2d"),e.clearRect(0,0,b,c)));T||(J||(J=y.create("div","oit-viewcanvas"),a.insertFirst(J)),
G=b,V=c,T=J.createCanvas());e||(e=T.getContext("2d"));d.on.update.dispatch(e)};d.invalidateCanvas=function(){!q&&d.on.update.hasListeners()&&(q=ib(qa,this))};w.onviewNode(function(a,b){b&&b.destroy();if(a){for(var c=w.rootNode,d=c.childByClass("oit-toolframe");d;){d=d.childByClass("oit-toolcontent");if(!d)break;c=d;d=c.childByClass("oit-toolframe")}c&&c.append(a)}});F.onreset(function(){N();p&&(p.destroy(),p=null);T&&(T.destroy(),T=null);J&&(J.destroy(),J=null);q&&(Vb(q),q=void 0);V=G=-1;b=c=void 0;
v={};m=r=0});Z.ondata(function(a,b,c){if(a.info){v||(v={});for(var d in a.info)v[d]=a.info[d];v.fi||(v.fi=1999);v.fistring||(v.fistring="Unknown");v.product||(v.product="Outside In Technology");v.version||(v.version="Unknown")}b&&N()});x.onnochrome(g)}}),Ga=ta.extend("dialog",{install:function(d){var e=[],a=null,c=!1,b,f=!1;d.createProgressDialog=function(a,b){var c={dialog:null,text:null,ticks:null,spinner:null,percentDone:0,active:!1,suppressed:!1,message:a,showTicks:b,display:v,update:l,hide:m};
e.push(c);Q.performance&&Q.performance.now?(c.startTime=performance.now(),c.interval=qb(k,200,c)):c.display();return c};var k=function(){var a=performance.now()-this.startTime;0<this.percentDone?(a=100*a/this.percentDone,a=1E3<=a):a=500<=a;a&&(Oa(this.interval),this.display())},v=function(){var a=e.indexOf(this);if(!this.active&&0===a&&!this.dialog)if(this.active=!0,F.on.showmessage.dispatch(this.message,!0,this.showTicks)){this.suppressed=!1;d.showModalOverlay(!0,200);if(a=w.rootNode){this.dialog=
y.create("div","oit-dialog oit-progress-dialog");this.text=y.create("div","oit-dialog-text");this.ticks=y.create("div","oit-progress-dialog-ticks");for(var b=0;20>b;b++)this.ticks.append(y.create("div"));this.spinner=y.create("div","oit-pending oit-progress-dialog-ticks");this.dialog.append(this.text,this.ticks,this.spinner);a.append(this.dialog)}!1===this.showTicks?(this.ticks.css("display",null),this.spinner.css("display","block")):(this.spinner.css("display",null),this.ticks.css("display","block"));
this.tickCount=void 0;this.update(this.percentDone);this.text.html(this.message);this.dialog.css({opacity:0,display:"block"});this.dialog.abortAnimation();this.dialog.animate({opacity:1,time:200,startCSS:{display:"block"}})}else this.suppressed=!0},l=function(a){"number"===typeof a&&(0>a?a=0:100<a&&(a=100),this.percentDone=a,this.active&&(F.on.progress.dispatch(a),this.dialog&&(a=Math.floor(21*a/100),20<a&&(a=20),a!=this.tickCount&&(this.tickCount=a,this.ticks.forChildElements(r,a)))))},r=function(a,
b,c){b<c?a.addClass("filled"):a.removeClass("filled")},m=function(){var a=this;a.interval&&(Oa(a.interval),a.interval=void 0);a.active&&F.on.hidemessage.dispatch();a.dialog&&(a.dialog.abortAnimation(),a.dialog.animate({opacity:0,endCSS:{display:"none"},endFn:function(){a.dialog.destroy();a.dialog=null},time:200}),d.showModalOverlay(!1,200));Da(e,a)};d.showModalOverlay=function(a,c){c=c||200;var d=f;if(a){if(!b){var e=w.rootNode;e&&(b=y.create("div","oit-screen"),e.append(b))}b&&!f&&(f=!0,b.abortAnimation(),
b.animate({opacity:.5,time:c,startCSS:{opacity:0,display:"block"}}))}else f&&(f=!1,b.abortAnimation(),b.animate({opacity:0,time:c,endCSS:{display:null}}));f!=d&&(d=B.activeOverlay())&&d.updateCSS()};d.modalOverlayVisible=function(){return f};d.showMessage=function(b){c&&d.hideMessage();if(F.on.showmessage.dispatch(b,!1,!1)){if(!a){var e=w.rootNode;e&&(a=y.create("div","oit-background-message"),e.append(a))}a&&(c||(a.abortAnimation(),a.animate({opacity:.8,time:200,startCSS:{opacity:0,display:"block"}})),
a.html(b))}c=!0};d.hideMessage=function(){c&&(F.on.hidemessage.dispatch(),a&&(a.abortAnimation(),a.animate({opacity:0,time:200,endCSS:{display:null}})),c=!1)};d.messageVisible=function(){return c};F.onreset(function(){for(;0<e.length;)e[e.length-1].hide();a&&a.destroy();b&&b.destroy();a=null;c=!1;b=null;f=!1})}}),ja=ta.extend("rawtext",{events:{add:{}},install:function(d){function e(a,b,c){this.value=a;this.type=b;this.subtype=c}function a(){this.items=[];this.add=function(a,b,c){c||(c="");a=new e(a,
b,c);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-
1]}}function c(a,b){this.regEx=b;this.type=a}function b(a,b,c){a.push("(");!1===c&&a.push("?:");a.push(b);a.push(")")}function f(a,b,c,d){a.push("(");!1===d&&a.push("?:");k(a,b,c);a.push(")")}function k(a,b,c,d){b=b.replace(/([\^\$\+\.\|\(\)\{\}\[\]\\])/g,"\\$1");b=b.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]");b=b.replace(/[\u0022\u201C\u201D\u030B\u030F]/g,"[\\u0022\\u201C\\u201D\\u030B\\u030F]");b=b.replace(/\s+/g,"\\s+");c?(c=b.replace(/\?/g,"[\\u003F]"),
c=c.replace(/\*/g,"[\\u002A]")):(c=b.replace(/\?/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]"),c=c.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"));a.push(c)}var v=/(\r\n|\r|\n)/g,l=/\s/g,r=[],m,p,z=[new c("NOT_WITHIN",/^(\bNOT\b|\bnot\b)\s+(\bw\/|\bW\/|\bw \/|\bW \/)/),new c("AND_NOT",/^(\bAND\b|\band\b)\s+(\bNOT\b|\bnot\b)/),
new c("OR_NOT",/^(\bOR\b|\bor\b)\s+(\bNOT\b|\bnot\b)/),new c("AND",/^(\bAND\b|\band\b)/),new c("OR",/^(\bOR\b|\bor\b)/),new c("NOT",/^(\bNOT\b|\bnot\b)/),new c("AndAny",/^(\bAndAny\b)/),new c("XFIRSTWORD",/^(\bxfirstword\b)/),new c("XLASTWORD",/^(\bxlastword\b)/),new c("DATE",/^\bdate\(\)/),new c("DATE_WITH_PARAM",/^\bdate\([^\)]*\)/),new c("MAIL",/^\bmail\(\)/),new c("MAIL_WITH_PARAM",/^\bmail\([^\)]*\)/),new c("CREDITCARD",/^\bcreditcard\(\)/),new c("CREDITCARD_WITH_PARAM",/^\bcreditcard\([^\)]*\)/),
new c("VISA_CREDIT_CARD_REGEX",/^\bvisacreditcard\(\)/),new c("WITHIN",/^(\bw\/|\bW\/|\bw \/|\bW \/|\bWI\d+|\bwi\d+)/),new c("PRE",/^(\bpre\/|\bPRE\/|\bpre \/|\bPRE \/)/),new c("OPEN_PAREN",/^\(/),new c("CLOSE_PAREN",/^\)/),new c("REGULAREXPRESSION",/^\"##[^\"]*\"/),new c("WHITESPACE",/^\s+/),new c("PHRASE",/^"[^"]*"/),new c("WORD",/^[^\s)]+/)],q=function(){if(void 0===m)for(var a=m=0;a<r.length;a++)r[a].text&&m++;return m};d.findStart=function(c,d,e,h,q){e=!1===e?"ig":"g";h={type:c,reverse:"up"===
h,hits:[],hitIndex:0,lastHit:null,modifier:e};"number"==typeof q&&(h.startACC=q);if("string"==typeof d)if("dtsearch"===c){c="\\S*(?:\\s+\\S+)";q=!1;d.match("[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]")&&(c="(?:\\s*\\S)",q=!0);var g=new a;for(d=d.slice(0);d;){for(var u=0;u<z.length;u++){var t=d.match(z[u].regEx);if(t){g.add(t[0],z[u].type,0);d=d.slice(t[0].length);break}}u==z.length&&(d=d.slice(1))}t=null;g&&(t=g.items);var A=[];d=[];for(var m=[],p=0,u=g=!1,n=!0,C,I,l=0;l<t.length;l++)if(I=
t[l],0<p)"OPEN_PAREN"===I.type?p++:"CLOSE_PAREN"===I.type?(p--,1===p&&p--):1===p&&"WHITESPACE"!==I.type&&p--;else{C=!1;if("WORD"===I.type){C=I.value.match("[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]");A.push("(");A.push("?:");C||A.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))");A.push("(");!1===n&&A.push("?:");
k(A,I.value,!1,d);for(l++;l<t.length;l++)if("WHITESPACE"===t[l].type&&l+1<t.length&&"WORD"===t[l+1].type)A.push("\\s+");else if("WORD"===t[l].type)k(A,t[l].value,!1,d);else{l--;break}A.push(")");C||A.push("(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])");A.push(")");C=!0}else if("PHRASE"===I.type)C=I.value.match("[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]"),
A.push("("),A.push("?:"),C||A.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))"),f(A,I.value.substring(1,I.value.length-1),!0,n),C||A.push("(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])"),
A.push(")"),C=!0;else if("WHITESPACE"!==I.type)if("WITHIN"===I.type){if(l+1<t.length)if("WI"===I.value.substring(0,2)||"wi"===I.value.substring(0,2))I=Number(I.value.slice(2,I.value.length)),isNaN(I)||(m.push(A.length),0<I&&I--,I=c+"{0,"+I+"}",q&&(I+="\\s*"),A.push(I));else if("WORD"===t[l+1].type)if(I=Number(t[l+1].value),!isNaN(I))l++,m.push(A.length),0<I&&I--,I=c+"{0,"+I+"}",q&&(I+="\\s*"),A.push(I);else if("S"===t[l+1].value||"s"===t[l+1].value)l++,m.push(A.length),A.push("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)");
else if("P"===t[l+1].value||"p"===t[l+1].value)l++,m.push(A.length),A.push("(?:[^\\u000a\\u000d]*)")}else"NOT_WITHIN"===I.type?l+1<t.length&&"WORD"===t[l+1].type&&(I=Number(t[l+1].value),isNaN(I)||(l++,m.push(A.length),n=!1,0<I&&I--,I="(?!("+c+"{0,"+I+"})",q&&(I+="\\s*"),A.push(I))):"PRE"===I.type?l+1<t.length&&"WORD"===t[l+1].type&&(I=Number(t[l+1].value),isNaN(I)||(l++,0<I&&I--,I=c+"{0,"+I+"}",q&&(I+="\\s*"),A.push(I))):"MAIL"===I.type?(b(A,'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))(@)((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',
n),C=!0):"MAIL_WITH_PARAM"===I.type?(f(A,I.value.substring(5,I.value.length-1),!1,n),C=!0):"CREDITCARD"===I.type?(b(A,"(?:\\d[ -]*?){13,16}",n),C=!0):"CREDITCARD_WITH_PARAM"===I.type?(f(A,I.value.substring(11,I.value.length-1),!1,n),C=!0):"VISA_CREDIT_CARD_REGEX"===I.type?(b(A,"(4[0-9]{12}(?:[0-9]{3})?)|(4[0-9]{3}-[0-9]{4}-[0-9]{4}-[0-9](?:[0-9]{3})?)",n),C=!0):"DATE"!==I.type&&("DATE_WITH_PARAM"===I.type?(f(A,I.value.substring(5,I.value.length-1),!1,n),C=!0):"AND"===I.type?A.push("|"):"OR"===I.type?
A.push("|"):"NOT"===I.type?p=1:"AND_NOT"===I.type?p=1:"OR_NOT"===I.type?p=1:"AndAny"===I.type?A.push("|"):"XFIRSTWORD"===I.type?(A.push("("),A.push("?:"),A.push("^\\s*"),A.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),A.push(")"),g=C=!0):"XLASTWORD"===I.type?(A.push("("),A.push("?:"),A.push("\\s*"),A.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),
A.push("\\s*$"),A.push(")"),u=C=!0):"REGULAREXPRESSION"===I.type?(A.push("("),A.push("?:"),A.push(I.value.substring(3,I.value.length-1)),A.push(")"),C=!0):"OPEN_PAREN"===I.type?(A.push("("),A.push("?:")):"CLOSE_PAREN"===I.type&&(A.push(")"),C=!0));if(0<m.length&&C){var v=m[m.length-1],U=0;I=v-1;for(var V=v+1;V<A.length;V++)"("===A[V]?U++:")"===A[V]&&U--;if(0===U&&")"==A[I])for(;0<=I&&(")"===A[I]?U++:"("===A[I]&&U--,0!==U);I--);C=A[v];if("(?!("===C.substring(0,4))A.push(")");else if(0===U){A.push(")");
A.push("|");A.push("(");A.push("?:");for(n=v+1;n<V;n++)A.push(A[n]);A.push(A[v]);for(n=I;n<v;n++)A.push(A[n]);A.push(")");A.push(")");A.push(" ");A.push(" ");A.push(" ");A.push(" ");for(n=A.length;n>I+4;n--)A[n-1]=A[n-5];A[I]="(";A[I+1]="?:";A[I+2]="(";A[I+3]="?:";if("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===C||"(?:[^\\u000a\\u000d]*)"===C)for(n=I;n<A.length;n++)if(A[n]===C)for(n++;n<A.length;n++)if("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))"===
A[n]){A[n]="";break}m.pop();n=!0}}}A=A.join("");1==t.length&&(g?A="^\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))":u&&(A="\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))\\s*$"));console.log("RegEx: "+A);c=null;if(0!==A.length)try{c=new RegExp(A,e)}catch(ea){}q=e=c;g?q=c=null:u&&(e=c=null);0===d.length&&(d=null);
h.regex={regex:c,first:e,last:q,stems:d}}else c=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),h.regex={regex:new RegExp("("+c+")",e)};else d instanceof RegExp&&(h.regex={regex:d});return h};var G=function(a,b,c){var d,e=null;a.lastHit=fa(c,c+b[0].length);var g=b.length;for(d=1;d<b.length;d++)void 0===b[d]&&g--;if(0<g){e={range:a.lastHit,terms:[]};for(g=1;g<b.length;g++)if(b[g]){var f=b[g],u=a.modifier;d=!!f.match("[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]");f=f.replace(/[.*+?^${}()|[\]\\]/g,
"\\$&");d=d?["(",f,")"].join(""):["(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))(",f,")(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])"].join("");d=new RegExp(d,u);for(u=null;f=d.exec(b[0]);){u||
(u=f);if(0===f.index)break;if(f.index+f[0].length>=b[0].length){u=f;break}}if(u){d=u[0];f=u.index;if(u[1]){var h=u[0].indexOf(u[1]);-1!=h&&(d=u[1],f+=h)}var f=c+f,h=f+d.length,t=!1;for(d=0;d<e.terms.length;d++){var k=e.terms[d];if(k.range.acc<h&&f<k.range.accend){f<k.range.acc&&(k.range.acc=f);h>k.range.accend&&(k.range.accend=h);t=!0;break}}!t&&(d=fa(f,h),e.terms.push({term:u[0],range:d}),u=u.index+u[0].length-1,0===a.nextOffset||a.nextOffset>u)&&(a.nextOffset=u)}}if(0===e.terms.length)e=null;else{a=
e.terms[0].range;e.range=da(e.terms[0].range);for(d=1;d<e.terms.length;d++)b=e.terms[d].range,b.acc<e.range.acc&&(e.range.acc=b.acc),b.accend>e.range.accend&&(e.range.accend=b.accend),b.accend>a.accend&&(a=b);e.lastTermOffset=a.acc-e.range.acc}}return e};d.findNext=function(a){if(a.regex){if(void 0===a.blockIndex&&(void 0!==a.startACC&&(a.blockIndex=T(a.startACC)),void 0===a.blockIndex))if(a.reverse){if(Z.isPending())return;a.blockIndex=r.length-1}else a.blockIndex=0;for(;;){if(a.hitIndex>=a.hits.length){a.hits=
[];a.hitIndex=0;for(var b=a.reverse?0:r.length;0===a.hits.length;){var c=r[a.blockIndex];if(!c)break;if(!c.text){J(c);break}var d,e=0;d=a.regex.stems;var f=a.regex.regex;a.regex.last&&!Z.isPending()&&a.blockIndex==r.length-1&&(f=a.regex.last);a.regex.first&&0===a.blockIndex&&(f=a.regex.first);if(f){var h=c.text;for(d&&(h=E(c.text,d));(d=f.exec(h))&&""!==d[0];){var u=c.range.acc+d.index;a.nextOffset=0;if(!a.lastHit||u>a.lastHit.acc){var k=G(a,d,u);if(k){if("dtsearch"===a.type){for(var q=k.lastTermOffset,
z=null;0<q;){var q=d[0].substring(0,q),n=f.source,C="";f.global&&(C+="g");f.ignoreCase&&(C+="i");f.multiline&&(C+="m");q=(new RegExp(n,C)).exec(q);if(!q||""===q[0])break;q=G(a,q,u);if(!q)break;z||(z=[]);z.push(q);q=q.lastTermOffset}if(z)for(u=z.length-1;0<=u;u--)a.hits.push(z[u])}a.hits.push(k)}}d.index>e&&(e=d.index);e+=a.nextOffset+1;f.lastIndex=e}}if(a.blockIndex==b)break;a.blockIndex+=a.reverse?-1:1}a.reverse&&(a.hits=a.hits.reverse())}if(a.hitIndex>=a.hits.length)break;for(;a.hitIndex<a.hits.length;)if(b=
a.hits[a.hitIndex++],c=!0,void 0!==a.startACC&&(c=a.reverse?b.range.acc<=a.startACC:b.range.acc>=a.startACC),c&&B.isDocumentText(b.range.acc,b.range.accend-1))return b}}};d.findBoundaryStart=function(a,b){var c;if(0<r.length){var d="line"===b?v:l;d.lastIndex=0;for(var e=T(a);void 0!=e;){var g=r[e];if(!g.text)break;for(var f;f=d.exec(g.text);){f=g.range.acc+f.index;if(f>a)break;c=f+1}if(void 0!==c)break;if(0===e)break;e--}}void 0===c&&(c=a);return c};d.findBoundaryEnd=function(a,b){var c;if(0<r.length){var d=
"line"===b?v:l;d.lastIndex=0;for(var e=T(a);void 0!=e;){var g=r[e];if(!g.text)break;for(var f;f=d.exec(g.text);)if(f=g.range.acc+f.index,f>a){c=f;break}if(void 0!==c)break;if(e+1>=r.length)break;e++}}void 0===c&&(c=a);return c};d.firstACC=function(){if(0<r.length)return r[0].range.acc};d.lastACC=function(){if(0<r.length)return r[r.length-1].range.accend};d.hasRawText=function(){if(0<r.length)return!0;if(!Z.isPending())return!1};d.isPending=function(){return Z.isPending()?!0:q()<r.length};d.getRawTextBlock=
function(a){if(0<=a&&a<r.length)return a=r[a],a.text||J(a),a};var V=function(){var a=T(this.acc),b=T(this.accend);if(void 0===a||void 0===b)d.isPending()?(d.onadd(this,V),Z.onadd(this,V)):(d.offadd(this,V),Z.offadd(this,V),this.callback());else{for(var c=0,e=a;e<=b;e++){var f=r[e];!f.text&&f.src?J(f,V,this):c++}c==b-a+1&&(d.offadd(this,V),Z.offadd(this,V),this.callback())}};d.loadRawText=function(a,b,c){V.call({acc:a,accend:b,callback:c})};d.getRawText=function(a,b){for(var c=T(a),d=T(b),e;c<=d;c++){var g=
r[c];if(!g.text){e=void 0;break}var f=a-g.range.acc;0>f&&(f=0);var h=b-g.range.acc;h>g.text.length&&(h=g.text.length);g=g.text.substring(f,h);e=e?e+g:g}return e};var T=function(a){for(var b=0;b<r.length;b++){var c=r[b].range;if(a>=c.acc&&a<c.accend||b==r.length-1&&(a=c.accend))return b}},J=function(a,b,c){if(!a.text&&a.src){if(b){a.callbacks||(a.callbacks=[]);for(var d=!1,e=0;e<a.callbacks.length;e++)if(a.callbacks[e].func==b&&a.callbacks[e].context==c){d=!0;break}d||a.callbacks.push({func:b,context:c})}a.loading||
(b=Ka(w.baseURL,a.src),q(),a.loading=!0,Ia({url:b,complete:N,args:[a]}))}else b&&b.call(c,a)},N=function(a,b,c,e,f){f.loading=!1;200==e?Z.isICD(c)?Z.processContentData(c):(f.text=c,h(f)):(f.text="",d.logAJAXError(null,"Failed to load a document text block from the server",a,e,c));m++;b=r.indexOf(f);a=r[b-1];b=r[b+1];a&&a.text&&(f.text=a.text.substr(a.text.length-2048,2048)+f.text,f.range.acc-=2048);b&&b.text&&(b.text=f.text.substr(f.text.length-2048,2048)+b.text,b.range.acc-=2048);if(f.callbacks){for(a=
0;a<f.callbacks.length;a++)f.callbacks[a].func.call(f.callbacks[a].context,f);delete f.callbacks}200==e&&d.on.add.dispatch(f.range.acc,f.range.accend)};d.replaceRawText=function(a){if(a&&(p=p?p.concat(a):a,0<r.length))for(a=0;a<r.length;a++)h(r[a])};var E=function(a,b){function c(a,c,d,e){c=c.toLowerCase();for(e=0;e<b.length;e++)if(c.charAt(0)==b[e].charAt(0)&&(d=Qc(c),d===b[e])){for(a=d.length;a<c.length;a++)d+="\ue000";return d}return a}var d=/(\w+)/ig;return a?a.replace(d,c):a},h=function(a){if(p&&
p.length&&a.text)for(var b,c=a.range.acc,d=a.range.acc+a.text.length,e=0;e<p.length;e++)if(b=p[e],b.acc<=d&&b.accend>=c){var f=b.acc-c;0>f&&(f=0);b=b.accend-c;b>a.text.length&&(b=a.text.length);for(var h=b-f,k="";0<h--;)k+=" ";a.text=a.text.substr(0,f)+k+a.text.substr(b)}};F.onreset(function(){p=m=void 0;r=[]});Z.ondata(function(a,b,c){if(a.text)for(b=0;b<a.text.length;b++){c=a.text[b];h(c);for(var d=0;d<r.length;d++)if(0===Sa(c.range,r[d].range)){r[d].text=c.text;c=null;break}c&&(r.push(c),J(c))}})}}),
cc,wa,fa,Hb,yb,ra,lb,za,Sa,Ac,bb,da,Bc,dc,zb,eb,Db;(function(){var d=function(d,a){return d.acc-a.acc};cc=function(d){return!!wa(d,!1,!1)};wa=function(d,a,c){var b;if(d&&d.type)switch(d.type){case "text":aa(d.acc)&&aa(d.accend)&&(b=d);b&&c&&(d=B.forRange(b,0,!0))&&d.isEmailHeader()&&(d=B.findTextRange(b))&&(d=d[0].startContainer)&&(y.isText(d)||y.isElement(d))&&(d=va(d),d=yb(d))&&(Array.isArray(d)&&(d=d[0]),b.acc<d.acc||b.accend>d.accend)&&(b=da(b),b.acc<d.acc&&(b.acc=d.acc),b.accend>d.accend&&(b.accend=
d.accend));break;case "cell":if(aa(d.page)&&aa(d.c1)&&aa(d.r1)&&aa(d.c2)&&aa(d.r2)&&(b=d,0>b.page?b=void 0:b.page<B.count()?(c=B.page(b.page))&&"worksheet"!==c.type&&"database"!=c.type&&(b=void 0):b.offsets&&(aa(b.offsets.left)&&aa(b.offsets.top)&&aa(b.offsets.right)&&aa(b.offsets.bottom)||(b=void 0)),b&&!0===a&&(c=B.page(d.page)))&&(c=c.spreadsheetModel())){var e=c.colCount()-1;a=c.rowCount()-1;if(d.c1>e||0>d.c2||d.r1>a||0>d.r2)b=void 0;else{c=ka(d.c1,0,e);var e=ka(d.c2,0,e),k=ka(d.r1,0,a);a=ka(d.r2,
0,a);if(c!==d.c1||e!==d.c2||k!==d.r1||a!==d.r2)b=da(d),b.c1=c,b.c2=e,b.r1=k,b.r2=a}}break;case "rect":if(aa(d.page)&&aa(d.left)&&aa(d.top)&&aa(d.right)&&aa(d.bottom)&&Ya(d.units)&&("px"===d.units||"tw"===d.units||"pct"===d.units)&&(b=d,"pct"!==d.units||aa(d.embedId)?0>b.page?b=void 0:void 0===d.embedId&&b.page<B.count()&&(c=B.page(b.page))&&"page"!==c.type&&"drawing"!==c.type&&"slide"!==c.type&&"chart"!==c.type&&"bitmap"!==c.type&&"email"!==c.type&&"html"!==c.type&&"rt"!==c.type&&"sn"!==c.type&&(b=
void 0):b=void 0,b&&void 0===d.embedId&&!0===a&&(c=B.page(d.page))&&(a=c.pageRect())))if(d.left>a.right||d.right<a.left||d.top>a.bottom||d.bottom<a.top)b=void 0;else{var e=ka(d.left,a.left,a.right),k=ka(d.top,a.top,a.bottom),v=ka(d.bottom,k,a.bottom),l=d.right;"html"!==c.type&&(l=ka(d.right,e,a.right));if(e!=d.left||l!=d.right||k!=d.top||v!=d.bottom)b=da(d),b.left=e,b.right=l,b.top=k,b.bottom=v}}return b};fa=function(){var d=arguments,a,c;switch(d.length){case 2:aa(d[0])&&aa(d[1])&&(a=d[0],c=d[1]);
break;case 1:if(aa(d[0]))a=d[0],c=d[0];else if(Pa(d[0])||Xa(d[0])){if(d=yb(d[0]))Array.isArray(d)?(a=d[0].acc,c=d[d.length-1].accend):(a=d.acc,c=d.accend)}else if((d=wa(d[0]))&&"cell"===d.type){var b=B.page(d.page);if(b&&("worksheet"===b.type||"database"===b.type)&&(b=b.spreadsheetModel()))return b.mapToText(d)}}var f;aa(a)&&aa(c)&&(f=new OIT.TextRange(a,c));return f};Hb=function(d,a){d=y.unwrap(d);a=a||0;var c;a:{if(1===d.nodeType&&d.childNodes&&(c=d.childNodes[a]))break a;c=void 0}c&&(d=c,a=0);
var b;c=w.viewNode;for(var e=d;e;e=e.parentNode){var k=y.data(e,"acc");if(void 0!==k){"none"!==k&&(b=y.wrap(e));break}if(e===c)break}if(c=b){b=parseInt(c.data("acc"),10);if(!c.equals(d))for(c=c.createTreeWalker(),e=c.firstACCNode();e;){e=c.currentNode;if(e===d)break;1===e.nodeType?(e=y.data(e,"acc"))&&(b=parseInt(e,10)):3===e.nodeType&&(b+=e.nodeValue.length);e=c.nextACCNode()}return b+a}};yb=function(d){var a;Pa(d)?a=d:Xa(d)&&"number"===typeof d.rangeCount&&0<d.rangeCount?a=d.getRangeAt(0):y.isElement(d)&&
(a=Y.createRange(),a.selectNode(y.unwrap(d)));if(a){d=a.startContainer;var c=a.startOffset,b=a.endContainer,e=a.endOffset,k,v;if(d===b){k=Hb(d,c);if(c===e)return fa(k,k);if(y.isText(d))return fa(k,k+e-c)}for(var l=a.commonAncestorContainer;l&&!y.isElement(l);)l=l.parentNode;l=y.wrap(l);a=Hb(l);var r=[],m,l=l.createTreeWalker();k=l.firstACCNode();for(var p=!1,z=!1,q=!1;k;){var G=l.currentNode;G===d&&y.isText(d)?p=!0:p||G.parentNode!==d||(z=!0,0!==c&&y.nodeIndex(G)!=c)||(p=!0);z&&!p&&(y.isDescendantOf(G,
d)||(p=!0));if(q&&!y.isDescendantOf(G,b))break;1===G.nodeType?(k=y.data(G,"acc"))&&(a="none"===k?void 0:Number(k)):3===G.nodeType&&void 0!==a&&(p&&0<G.nodeValue.length&&(k=a,G===d&&(k+=c),v=a+G.nodeValue.length,G===b&&(v=a+e),m&&m.accend!=a&&m.accend!=a-1&&(m=null),m?m.accend=v:(m=fa(k,v),r.push(m))),a+=G.nodeValue.length);if(G===b&&y.isText(b))break;else if(G.parentNode===b&&(q=!0,0===e||y.nodeIndex(G)>=e))break;k=l.nextACCNode()}r=Bc(r);0===r.length?r=void 0:1==r.length&&(r=r[0]);return r}};ra=
function(){var d,a,c,b,f,k,v,l=arguments;switch(l.length){case 9:a=l[0];c=l[1];b=l[2];f=l[3];k=l[4];v={left:l[5],top:l[6],right:l[7],bottom:l[8]};break;case 5:a=l[0];c=l[1];b=l[2];f=l[3];k=l[4];break;case 4:c=l[0];b=l[1];f=l[2];k=l[3];break;case 3:a=l[0];c=l[1];b=l[2];f=l[1];k=l[2];break;case 2:c=l[0];b=l[1];f=l[0];k=l[1];break;case 1:if((l=wa(l[0]))&&"text"===l.type&&(d=B.forRange(l))&&("worksheet"===d.type||"database"===d.type)&&(d=d.spreadsheetModel()))return d.mapToCells(l)}if(void 0===a)a=B.current();
else if(Ya(a)){if(d=B.byName(a))a=d.index}else if(aa(a)){if(0>a||a>=B.count())a=void 0}else a=void 0;var r;aa(a)&&aa(c)&&aa(b)&&aa(f)&&aa(k)?r=new OIT.CellRange(a,c,b,f,k,v):F.invalidArg("cellRange");return r};lb=function(){var d,a,c,b,f,k,v="px",l=arguments;if(2<=l.length&&6>=l.length){var r=0;if(Ya(l[r])){var m=B.byName(l[r]);m&&(a=m.index,r++)}for(var m=0,p=r;p<l.length;p++)if(aa(l[p]))m++;else break;switch(m){case 6:d=l[r++];case 5:a=l[r++];case 4:c=l[r++];b=l[r++];f=l[r++];k=l[r++];break;case 3:a=
l[r++];case 2:c=l[r++],b=l[r++],f=c,k=b}r<l.count&&Ya(l[r])&&(v=l[r++])}if(void 0===a)a=B.current();else if(aa(a)){if(0>a||a>=B.count())a=void 0}else a=void 0;var z;aa(a)&&aa(c)&&aa(b)&&aa(f)&&aa(k)&&("px"===v||"tw"===v||"pct"===v)?z=new OIT.RectRange(d,a,c,b,f,k,v):F.invalidArg("rectRange");return z};za=function(d,a){if(d&&"rect"===d.type&&d.units!==a){var c,b,e;switch(a){case "px":"tw"===d.units?(c=B.page(d.page))&&c.dpi&&(d.left=K(d.left*c.dpi/1440,1E4),d.top=K(d.top*c.dpi/1440,1E4),d.right=K(d.right*
c.dpi/1440,1E4),d.bottom=K(d.bottom*c.dpi/1440,1E4),d.units="px"):"pct"===d.units&&void 0!==d.embedId&&(c=B.page(d.page))&&(c=c.embeddingRect(d.embedId))&&(b=c.width/100,e=c.height/100,d.left=K(d.left*b,1E4),d.right=K(d.right*b,1E4),d.top=K(d.top*e,1E4),d.bottom=K(d.bottom*e,1E4),d.units="px");break;case "tw":"px"===d.units&&(c=B.page(d.page))&&c.dpi&&(d.left=K(1440*d.left/c.dpi,1E4),d.top=K(1440*d.top/c.dpi,1E4),d.right=K(1440*d.right/c.dpi,1E4),d.bottom=K(1440*d.bottom/c.dpi,1E4),d.units="tw");
break;case "pct":if("px"===d.units&&(c=B.page(d.page))){if(void 0!==d.embedId){if(c=c.embeddingRect(d.embedId))b=100/c.width,e=100/c.height}else e=c.pageRect(),b=100/e.width,e=100/e.height;void 0!==b&&(d.units="pct",d.left=K(d.left*b,1E4),d.right=K(d.right*b,1E4),d.top=K(d.top*e,1E4),d.bottom=K(d.bottom*e,1E4))}}}};Sa=function(d,a){if(!d)return a?-1:0;if(!a)return 1;if(d.page<a.page)return-1;if(d.page>a.page)return 1;if(d.type===a.type)switch(d.type){case "text":return d.acc<a.acc?-1:a.acc<d.acc?
1:d.accend<a.accend?-1:a.accend<d.accend?1:0;case "cell":if(d.r1<a.r1)return-1;if(a.r1<d.r1)return 1;if(d.c1<a.c1)return-1;if(a.c1<d.c1)return 1;if(d.r2<a.r2)return-1;if(a.r2<d.r2)return 1;if(d.c2<a.c2)return-1;if(a.c2<d.c2)return 1;if(d.offsets)if(a.offsets){if(d.offsets.top<a.offsets.top)return-1;if(d.offsets.top>a.offsets.top)return 1;if(d.offsets.left<a.offsets.left)return-1;if(d.offsets.left>a.offsets.left)return 1;if(d.offsets.bottom<a.offsets.bottom)return-1;if(d.offsets.bottom>a.offsets.bottom)return 1;
if(d.offsets.right<a.offsets.right)return-1;if(d.offsets.right>a.offsets.right)return 1}else return 1;else if(a.offsets)return-1;return 0;case "rect":return d.units!=a.units&&(a=da(a),za(a,d.units)),d.top<a.top?-1:a.top<d.top?1:d.left<a.left?-1:a.left<d.left?1:d.bottom<a.bottom?-1:a.bottom<d.bottom?1:d.right<a.right?-1:a.right<d.right?1:0}};Ac=function(d,a){if(d.type===a.type)switch(d.type){case "text":return a.acc>=d.acc&&a.accend<=d.accend}return!1};bb=function(d,a){if(d&&a&&a.type===d.type)switch(a.type){case "text":return d.accend>
a.acc&&d.acc<a.accend;case "cell":return d.c2>=a.c1&&d.c1<=a.c2&&d.r2>=a.r1&&d.r1<=a.r2;case "rect":return d.right>=a.left&&d.left<=a.right&&d.bottom>=a.top&&d.top<=a.bottom}return!1};da=function(d){var a;if(d)switch(d.type){case "text":a=new OIT.TextRange(d.acc,d.accend);break;case "cell":a=new OIT.CellRange(d.page,d.c1,d.r1,d.c2,d.r2);!0===d.selectingCols&&(a.selectingCols=!0);!0===d.selectingRows&&(a.selectingRows=!0);d.offsets&&(a.offsets={left:d.offsets.left,top:d.offsets.top,right:d.offsets.right,
bottom:d.offsets.bottom});break;case "rect":a=new OIT.RectRange(d.embedId,d.page,d.left,d.top,d.right,d.bottom,d.units,d.section)}return a};Db=function(d,a){if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)d=Db(a[c],d);else if(!d)d=da(a);else if(d.type===a.type)switch(d.type){case "cell":a.c1<d.c1&&(d.c1=a.c1);a.r1<d.r1&&(d.r1=a.r1);a.c2>d.c2&&(d.c2=a.c2);a.r2>d.r2&&(d.r2=a.r2);break;case "text":a.acc<d.acc&&(d.acc=a.acc),a.accend>d.accend&&(d.accend=a.accend)}return d};Bc=function(e){if(e&&1<
e.length){e.sort(d);for(var a=[],c,b=0;b<e.length;b++){var f=e[b];c&&3>f.acc-c.accend?f.accend>c.accend&&(c.accend=f.accend):(c=f,a.push(f))}e=a}return e};dc=function(d){if(1===d.length)return d[0];if(1<d.length){var a=d[0],c=Y.createRange();c.setStart(a.startContainer,a.startOffset);c.setEnd(a.endContainer,a.endOffset);for(var a=va(a.startContainer),b=1;b<d.length;b++){var e=d[b],k=va(e.endContainer);y.unwrap(k)==y.unwrap(a)&&c.setEnd(e.endContainer,e.endOffset)}return c}};zb=function(d){if(d=wa(d))switch(d.type){case "text":return d.acc==
d.accend;case "cell":return!1;case "rect":return d.left==d.right||d.top==d.bottom}return!0};eb=function(d){if(d)switch(d.type){case "cell":var a=[];a.push(Ja(d.c1),d.r1+1);d.c2==d.c1&&d.r2==d.r1||a.push(":",Ja(d.c2),d.r2+1);return a.join("")}}})();var D=ta.extend("display",{events:{displayload:{},displayunload:{}},install:function(d){var e={zoom:!1,rotate:!1,showhidden:!1,pages:!1,fitpage:!1,highlights:!1,textselection:!1,rectselection:!1,rectredaction:!1,cellselection:!1,customtextselection:!1,anchorednotes:!1},
a=null,c=null,b=e,f=!1,k;d.loadDisplay=function(e){d.unloadDisplay();var f=e.type;e.overlay&&e.overlay.firstPage&&(f=e.overlay.firstPage.type);if(a=Fa.createDisplay(f))c=e.overlay,w.deType=f,b=Fa.features(f),w.drawing.resetOrigin(),a.init(e),d.on.displayload.dispatch(c.firstPage,c.lastPage)};d.unloadDisplay=function(){a&&(d.on.displayunload.dispatch(c.firstPage,c.lastPage),a.unload(),c=a=null,w.deType=null);b=e};d.features=function(){var a=b;if("vertical"!==x.scrollMode){var d=B.activePage();d&&(a=
Fa.features(d.type))}return a};d.isSelectionModeSupported=function(a){var b=!1;switch(a){case "none":b=!0;break;case "text":d.features().textselection&&(b=!0);break;case "rect":d.features().rectselection&&(b=!0);break;case "cell":d.features().cellselection&&(b=!0)}return b};d.isHighlightModeSupported=function(a){var b=d.isSelectionModeSupported(a);b||"text"!==a||"worksheet"!==w.deType&&"database"!==w.deType||(b=!0);return b};d.visiblePages=function(){return a?a.visiblePages():[]};d.startElasticScroll=
function(){if(a)return a.startElasticScroll()};d.elasticScroll=function(b,d){if(a)return a.elasticScroll(b,d)};d.endElasticScroll=function(b,d){if(a)return a.endElasticScroll(b,d)};d.saveScrollPos=function(){if(a)return a.saveScrollPos()};d.restoreScrollPos=function(b){a&&a.restoreScrollPos(b)};d.maxPageWidth=function(){if(a)return a.maxPageWidth()};d.maxPageHeight=function(){if(a)return a.maxPageHeight()};d.padding=function(){if(a)return a.padding()};d.margin=function(){if(a)return a.margin()};d.scrollOffset=
function(){if(a)return a.scrollOffset()};d.keydown=function(b){return a?a.keydown(b):!0};d.showHidden=function(b){a&&a.showHidden(b)};d.loadRange=function(b,d){a&&a.loadRange(b,d)};d.expandRange=function(b){a&&(b=a.expandRange(b));return b};d.moveto=function(b,d,c){return a?a.moveto(b,d,c||{}):!1};d.getSelectedText=function(){return a?a.getSelectedText():""};d.select=function(b){return a?a.select(b):!1};d.pageRange=function(b,d){if(a&&c.containsPage(b))return a.pageRange(b,d)};d.pageRect=function(b,
d){if(a&&c.containsPage(b))return a.pageRect(b,d)};d.rangeRect=function(b,d,e,f){if(a&&("text"===b.type||c.containsPage(b.page)))return a.rangeRect(b,d,e,f)};d.rangeFromRect=function(b,d,e,f,k,z,q,G){if(a&&c.containsPage(b))return a.rangeFromRect(b,d,e,f,k,z,q,G)};d.extendRange=function(b,d,c,e){if(a)return a.extendRange(b,d,c,e)};d.moveAnchor=function(b,d,c,e){return a?a.moveAnchor(b,d,c,e):!1};d.incrementSelection=function(b,d,c,e,f){return a?a.incrementSelection(b,d,c,e,f):!1};d.suspendUpdate=
function(){f||(f=!0)};d.resumeUpdate=function(){f&&(f=!1,d.update())};d.layoutChanged=function(b){a&&a.layoutChanged(b)};d.update=function(b,c){if(!f)if(!0===c)k&&sa(k),k=ba(d.update,50,this,b,!1);else if(a)return a.update(b);return!1};d.activeOverlay=function(){return c};F.onreset(d.unloadDisplay);yc.onfontload(function(){d.update(!0)})}}),P=ta.extend("selection",{events:{beginselection:{},selectionchanged:{}},install:function(d){var e=null,a=!0,c,b=null,f=!0,k=!1,v=!0,l=!1,r,m,p,z,q,G,V,T,J,N,E,
h=0,u,g,t,A=0,U,S,W=0,qa=0,ia,O,H,n=[],C,I,ca,la;d.reset=function(){d.select(null);x.selectionMode=d.validateMode(x.selectionMode)};d.style=function(a,d){f=!1===d?!1:!0;null!==a&&"string"!==typeof a||a===b||(b=a,e=hb(b),Ba(),ma());return b};d.isSelecting=function(){return l};var Ba=function(a){if(!a&&e){a="";e.color&&(a+="color:"+e.color+";");var b=e["background-color"];b&&(a+="background-color:"+b+";")}a&&0<a.length?(C||(C=y.create("style"),C.type="text/css",y.byTagName("head")[0].append(C)),C.html(".oit-view ::selection, .oit-annopane ::selection { "+
a+"}")):C&&C.html("")},ma=function(){if(m){var a=m.selectionRect();a.resetStyle();e?(a.removeClass("oit-sel-rect"),a.css(e)):a.addClass("oit-sel-rect");a.update()}};d.textSelection=function(){if(p){if("text"===p.type)return da(p);if("cell"===p.type)return fa(p)}};d.cellSelection=function(){if(p&&"cell"===p.type)return da(p)};d.rectSelection=function(){if(p&&"rect"===p.type)return da(p)};d.selectionType=function(){return p?p.type:"none"};d.hide=function(b){a=!1;c=b;xc("firefox")?d.select(null):c?Ba(c):
Ba("background-color: rgba(255,255,255,0);");m&&m.showSelectionRect(!1)};d.select=function(b,e,g,n){var f=!1;a=!0;c=null;if(null===b)f=!!p,ea(),d.update();else if(b)if(Xa(b)||Pa(b))f=d.select(fa(b));else if(b=wa(b),!b||b.selectingRows||b.selectingCols||!1===b.autoExpand||(b=D.expandRange(b)),b&&0!==Sa(b,p)){var C=B.forRange(b,0,!0);C&&(f=!0,d.on.beginselection.dispatch(b),ea(),m=C,p=da(b),r=da(b),ma(),d.update())}if(f||e!==la)d.on.selectionchanged.dispatch(p,!0),la=e,F.on.select.dispatch(p,g||null,
n||null,zb(p),e)&&(w.drawing&&w.drawing.update(!0),p&&void 0===e&&(b=D.rangeRect(p,"view"),"text"===p.type&&d.update(),b&&M.activateNearest(b.left,b.top)));return f};d.saveSelection=function(){if(!p)return null;var b={range:da(p)};a||(b.visible=!1,b.hideStyle=c);return b};d.restoreSelection=function(a){if(a){var b=a.range,c=B.forRange(b,0,!0);c&&(d.on.beginselection.dispatch(b),ea(),m=c,p=da(b),r=da(b),ma(),d.update(),a.visible||d.hide(a.hideStyle))}};d.startRectSelection=function(b,e,g){ea();B.deactivateAnnotation();
l=!0;D.isSelectionModeSupported("text")||M.startSelection();g=B.mapToPage(b,e,null,!0);d.logRect&&d.logRect(g.page,g.x,g.y,!0);z={x:b,y:e};m=g.page;V=g.x;T=g.y;J=b;N=e;a=G=!0;c=null;p=D.rangeFromRect(m.index,V,T,V,T,m,"select");"cell"!==p.type||k||delete p.offsets;r=da(p);d.on.beginselection.dispatch(p);ma();d.update();d.on.selectionchanged.dispatch(p,!1);return!0};d.extendRectSelection=function(a,b,c){r&&(G&&(c=Math.abs(b-N),2<Math.abs(a-J)||2<c)&&(G=!1,D.isSelectionModeSupported("text")&&M.startSelection()),
Qa(q,a,b),a=B.mapToPage(a,b,m,!0),d.logRect&&d.logRect(a.page,a.x,a.y),p=D.extendRange(r,a.x,a.y,a.page),v&&(p=wa(p,!0)),d.update(),d.on.selectionchanged.dispatch(p,!1))};d.endRectSelection=function(a,b,c){oa();l=!1;d.extendRectSelection(a,b);d.on.selectionchanged.dispatch(p,!0);var e={x:a,y:b},g=G;la=void 0;F.on.select.dispatch(p,z,e,G)&&"rect"===x.selectionMode&&d.select(null);g&&c&&(c=y.wrap(c.target),c.isDescendantOf(B.activeOverlay())||c.isDescendantOf(w.drawing))&&((a=M.findNearest(a,b))&&0===
a.distance.ax&&0===a.distance.ay||M.deactivate());M.endSelection()};d.cancelRectSelection=function(a,b){oa();d.select(null)};d.startTouchTextSelection=function(b,e){a=!0;c=null;I&&d.abortTouchTextSelection();l=!0};d.updateTouchTextSelection=function(){var a=Q.getSelection();!a.anchorNode||ca&&ca.anchorNode==a.anchorNode&&ca.anchorOffset==a.anchorOffset&&ca.focusNode==a.focusNode&&ca.focusOffset==a.focusOffset||(ca||(ca={}),ca.anchorNode=a.anchorNode,ca.anchorOffset=a.anchorOffset,ca.focusNode=a.focusNode,
ca.focusOffset=a.focusOffset,I=fa(a))};d.abortTouchTextSelection=function(){I=null;l=!1};d.startTextSelection=function(b,e,n,f){ea();l=!0;t=E=null;q=y.wrap(f.target);a=!0;c=null;z={x:b,y:e};G=!0;J=b;N=e;if(!D.features().customtextselection)return!1;b=B.mapToPage(b,e,null,!0,!0);b.inAnnotation||B.deactivateAnnotation();e=b.page.mapPointToText(b.x,b.y,null,b.inAnnotation);if(!e||!e.overlaps)return!1;S=b;g=va(e.node);var C;if("line"===n||"word"===n)C=b.page.findTextBoundary(e.node,e.offset,n);C?(U=n,
u=C,E=u.startContainer,h=u.startOffset,t=u.endContainer,A=u.endOffset):(U=void 0,E=e.node,h=e.offset,t=e.node,A=e.offset);if(E&&t&&(d.update(),y.selectRange(E,h,t,A),n=Q.getSelection(),n.anchorNode&&n.focusNode))if(n=fa(n))d.on.beginselection.dispatch(n);else return t=E=null,!1;return!0};d.extendTextSelection=function(a,b,d){if(!D.features().customtextselection)return!1;G&&(d=Math.abs(b-N),2<Math.abs(a-J)||2<d)&&(G=!1,D.isSelectionModeSupported("text")&&M.startSelection());Qa(q,a,b);d=null;var c=
!1;S&&S.inAnnotation&&(d=S.page,c=!0);a=B.mapToPage(a,b,d,!0,!0,c);b=a.page.mapPointToText(a.x,a.y,g,a.inAnnotation);if(!b)return!1;if(b.node!=t||b.offset!=A){if(U){if(b=a.page.findTextBoundary(b.node,b.offset,U))a=b.compareBoundaryPoints(Range.START_TO_START,u),-1==a?(t=b.startContainer,A=b.startOffset,E=u.endContainer,h=u.endOffset):(E=u.startContainer,h=u.startOffset,t=b.endContainer,A=b.endOffset)}else t=b.node,A=b.offset;E==t?h>A?y.selectRange(t,A,E,h):y.selectRange(E,h,t,A):(a=E.compareDocumentPosition(t),
2==a?y.selectRange(t,A,E,h):y.selectRange(E,h,t,A))}return!0};d.endTextSelection=function(a,b,c){oa();l=!1;S=q=null;if("text"==x.selectionMode){var e,g=G;U&&(g=!1);I?(e=I,I=null):(e=Q.getSelection(),e=e.anchorNode&&e.focusNode?fa(e):null);if(!e)ea(),M.autoHighlight()&&y.clearSelection();else if(0!==Sa(e,p)){e.acc!==e.accend&&(g=!1);var n=B.forRange(e);n&&(G=!1,N=J=T=V=void 0,m=n,p=e,r=da(e),d.on.selectionchanged.dispatch(p,!0),e={x:a,y:b},la=void 0,F.on.select.dispatch(p,z,e,zb(p)))}g&&c&&(c=y.wrap(c.target),
c.isDescendantOf(B.activeOverlay())||c.isDescendantOf(w.drawing))&&((a=M.findNearest(a,b))&&0===a.distance.ax&&0===a.distance.ay||M.deactivate());E=void 0;h=0;t=u=void 0;A=0;U=void 0}M.endSelection()};d.incrementSelection=function(a,b,c){var e=!1;p&&(e=D.incrementSelection(r,p,a,b,c))&&(d.update(),d.on.selectionchanged.dispatch(p,!0));return e};d.moveAnchor=function(a,b,c){var e=!1;r&&(e=D.moveAnchor(r,a,b,c))&&(p=da(r),d.update(),d.on.selectionchanged.dispatch(p,!0));return e};d.update=function(){if(p)if("text"===
p.type){y.clearSelection();d.logUpdate&&d.logUpdate(p);var b=B.findTextRange(p);b&&y.selectRange(dc(b))}else{if(m)if(b=D.rangeRect(p,"overlay",!0),d.logUpdate&&d.logUpdate(p,b),!b)m.showSelectionRect(!1);else if(m.hasSelectionRect()){var c=m.selectionRect();c.move(b.left,b.top,b.width,b.height);c.show(a&&(!G||f)&&("rect"===p.type||"cell"===p.type))}}else y.clearSelection();D.select(p)&&D.update()};var ea=function(){y.clearSelection();m&&m.showSelectionRect(!1);l=!1;a=!0;c=null;G=!1;N=J=T=V=void 0;
p=r=m=null;Ba();ma()};d.validateMode=function(a,b){D.isSelectionModeSupported(a)||("rect"===a?D.features().rectredaction&&"redaction"==OIT.highlights.autoHighlight()||(a=void 0):a=void 0);a||(b?a=d.validateMode(b):D.isSelectionModeSupported("text")?a="text":D.isSelectionModeSupported("rect")?a="rect":D.isSelectionModeSupported("cell")&&(a="cell"));return a};d.addAutoscrollRoot=function(a){n.push(y.wrap(a))};var Qa=function(a,b,d){if(b!=ia||d!=O){var c=w.viewNode;ia=b;for(O=d;a&&-1==n.indexOf(a);){if(a===
c||!(a instanceof L)){a=null;break}a=a.parent()}var e;a?(e=a.pos(c),b-=e.left,d-=e.top,e=a.clientWidth*x.zoom,c=a.clientHeight*x.zoom):(a=c,e=c.clientWidth,c=c.clientHeight);1>=b?(W=b-1,-30<W&&(W=-30)):b>=e-1?(W=b-(e-1),30>W&&(W=30)):W=0;1>=d?(qa=d-1,-30<qa&&(qa=-30)):d>=c-1?(qa=d-(c-1),30>qa&&(qa=30)):qa=0;W||qa?H||(H=qb(na,100,null,a)):oa()}},na=function(a){a.dscroll(W,qa);E?d.extendTextSelection(ia,O):d.extendRectSelection(ia,O)},oa=function(){H&&(Oa(H),H=void 0,qa=W=0)};d.enableCellOffsets=function(a){k=
!!a};d.bindSelectionToPage=function(a){v=!!a};ea();x.onselectionMode(function(a){d.select(null);(a=B.activeOverlay())&&a.updateCSS()});F.onreset(function(){d.reset();n=[]});D.ondisplayload(d.reset);ha.ondetach(function(){b=e=null;C&&(C.destroy(),C=null)});F.onzoom(function(a,b,c){d.update()})}}),Va=ta.extend("user",{events:{beginscroll:{},endscroll:{},beginpinchzoom:{},endpinchzoom:{}},install:function(d){var e=!1,a=!1,c=!1,b=!1,f,k,v=null,l,r,m,p=null,z,q,G,V,T,J,N,E,h,u=0,g=0,t=0,A=0;F.onload(function(){var a=
w.rootNode;a.onmousedown(W);a.onwheel(ia);Q.addEventListener("mouseup",qa,!1);Q.addEventListener("keydown",U,!1);w.isMobileOrTablet&&(a=w.viewNode,a.kinetic(!0),a.ontap(Qa),a.onpress(na),a.onpressup(oa),a.onpanstart(Ra),a.onpanmove(Ca),a.onpanend(Cb),a.onpancancel(Cb),a.onpinchstart(Jb),a.onpinchmove(K),a.onpinchend(Bb),a.onpinchcancel(Bb),a.onrotatestart(R),a.onrotatemove(ua),a.onrotateend(L),a.onrotatecancel(L))});F.onreset(function(){var a=w.rootNode;a&&(a.offmousedown(W),a.offwheel(ia));Q.removeEventListener("mouseup",
qa);Q.removeEventListener("keydown",U);w.isMobileOrTablet&&(a=w.viewNode)&&(a.offtap(Qa),a.offpress(na),a.offpressup(oa),a.offpanstart(Ra),a.offpanmove(Ca),a.offpanend(Cb),a.offpancancel(Cb),a.offpinchstart(Jb),a.offpinchmove(K),a.offpinchend(Bb),a.offpinchcancel(Bb),a.offrotatestart(R),a.offrotatemove(ua),a.offrotateend(L),a.offrotatecancel(L))});var U=function(a){var b,c;d.logKeydown&&d.logKeydown(a);if(d.isViewEventTarget(a.target)||e&&a.target==Y.body){if((c=F.on.keydown.dispatch(a))&&!w.editingComment&&
(c=D.keydown(a))){b=w.viewNode;var g=M.active(),n=0,f=0;switch(a.keyCode){case 33:D.features().pages&&(b.finishAnimation(),B.updateActivePage(),0<b.scrollTop?b.dscroll(void 0,-b.clientHeight):B.movetoPrev(),c=!1);break;case 34:D.features().pages&&(b.finishAnimation(),B.updateActivePage(),b.scrollTop<Math.max(b.clientHeight,b.scrollHeight,b.offsetHeight)-b.innerHeight?b.dscroll(void 0,b.clientHeight):B.movetoNext(),c=!1);break;case 35:b.scroll(b.scrollWidth,b.scrollHeight);c=!1;break;case 36:b.scroll(0,
0);c=!1;break;case 37:n=-1;break;case 38:f=-1;break;case 39:n=1;break;case 40:f=1;break;case 45:void 0!==g&&M.getOption(g,"enableUserComment")&&(M.showComment(g,{mode:"edit",removeOnCancel:!1}),c=!1);break;case 46:void 0!==g&&M.getOption(g,"enableUserDelete")&&(M.remove(),g=void 0,c=!1);break;case 48:a.ctrlKey&&(F.zoom(1),c=!1);break;case 187:a.ctrlKey&&(F.zoomIn(),c=!1);break;case 189:a.ctrlKey&&(F.zoomOut(),c=!1)}if(n||f){var C;void 0!==g&&(b=M.range(g))&&(C=b.type);C||(C=x.selectionMode);if("cell"===
C||"rect"===C)if(C=a.ctrlKey,void 0!==g){if(a.shiftKey){var h=b=0,t=0,A=0;c=x.rotation;switch(c){case 0:t=n;A=f;break;case 90:A=n;b=-f;break;case 180:b=-n;h=-f;break;case 270:h=-n,t=f}M.move(g,b,h,t,A,C)}else{c=x.rotation;if(0!==c)switch(b=n,h=f,c){case 90:n=-h;f=b;break;case 180:n=-b;f=-h;break;case 270:n=h,f=-b}M.move(g,n,f,n,f,C)}(b=M.range(g))&&B.moveto(b);c=!1}else c=a.shiftKey?!P.incrementSelection(n,f,C):!P.moveAnchor(n,f,C)}}!1===c&&$a(a);return c}},S=function(a){(a.button||0)==T&&(d.releaseMouseCapture(),
d.on.endscroll.dispatch());T=void 0},W=function(g){e=!1;d.logMouse&&d.logMouse(g);if(!w.editingComment){var n=w.viewNode,f=n.mousePos(g);if(d.isViewEventTarget(g.target)){var C=g.button||0,h=n.inRect(f.x,f.y);if(1==C||0===C&&!h)d.on.beginscroll.dispatch(),T=C,d.setMouseCapture(null,S);else{h=!0;n.focus();e=!0;if(0===C){n=x.selectionMode;if("rect"===n||"cell"===n)P.startRectSelection(f.x,f.y,g)&&(c=!0,d.setMouseCapture(Ba)),h=!1;else if("text"==n){var t,n=1;if(void 0!==z){var A;if(g.pageX||g.pageY)t=
g.pageX,A=g.pageY;else if(g.clientX||g.clientY)t=g.clientX,A=g.clientY;t=Math.abs(t-q.x);A=Math.abs(A-q.y);3>=t&&3>=A&&((new Date).getTime()-z<=x.doubleClickInterval&&(n=G+1),z=void 0)}t=n;var k;2===t?k="word":t=1;if(P.startTextSelection(f.x,f.y,k,g))if(b=!0,d.setMouseCapture(ma),f=t,z=(new Date).getTime(),G=f,g.pageX||g.pageY)q={x:g.pageX,y:g.pageY};else if(g.clientX||g.clientY)q={x:g.clientX,y:g.clientY};h=!1}a=!0}!1===h&&$a(g);return h}}}},qa=function(e){var g;d.logMouse&&d.logMouse(e);if(k)g=
k.call(v,e);else if(a){g=!0;if(!w.editingComment){var n=w.viewNode.mousePos(e);0===(e.button||0)&&(c?(c=!1,d.releaseMouseCapture(),P.endRectSelection(n.x,n.y,e)):(b&&(b=!1,d.releaseMouseCapture()),P.endTextSelection(n.x,n.y,e)),g=!1)}a=!1}!1===g&&$a(e);return g},ia=function(a){if(!w.editingComment&&d.isViewEventTarget(a.target))if(a.ctrlKey){if(!x.browserZoom)return 0<a.wheelDelta?OIT.document.zoomIn():0>a.wheelDelta&&OIT.document.zoomOut(),$a(a),!1}else d.on.beginscroll.dispatch(),void 0!==V&&sa(V),
V=ba(O,500)},O=function(){V=void 0;d.on.endscroll.dispatch()};d.setMouseCapture=function(a,b,c){d.releaseMouseCapture();"function"===typeof a&&(Q.addEventListener("mousemove",H,!0),f=a);"function"===typeof b&&(k=b);if(f||k)y.body.onmouseover(n),y.body.onmouseout(C);v=c};var H=function(a){if(f&&!1===f.call(v,a))return $a(a),!1},n=function(a){if(J){var b=ea(a);if(b!==J.buttons&&J.buttons&1&&!(b&1)){var b=J,c;Y.createEvent?(c=Y.createEvent("MouseEvent"),c.initMouseEvent("mouseup",!0,!0,Q,null,b.screenX,
b.screenY,b.clientX,b.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.relatedTarget)):c=new MouseEvent("mouseup",{screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:0,buttons:a.buttons,relatedTarget:a.relatedTarget,region:a.region});qa(c)}J=void 0}},C=function(a){J={buttons:ea(a),screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}};d.releaseMouseCapture=function(){f&&(Q.removeEventListener("mousemove",
f,!1),f=null);k=null;y.body.offmouseover(n);y.body.offmouseout(C)};d.setTouchCapture=function(a,b,c,e){d.releaseTouchCapture();"function"===typeof a&&(y.listen("touchmove",I,{capture:!0,passive:!1}),l=a);"function"===typeof b&&(y.listen("touchend",ca,{capture:!0,passive:!1}),r=b);"function"===typeof c&&(y.listen("touchcancel",la,{capture:!0,passive:!1}),m=c);p=e};var I=function(a){l&&l.call(p,a)},ca=function(a){r&&r.call(p,a)},la=function(a){m&&m.call(p,a)};d.releaseTouchCapture=function(){l&&(y.unlisten("touchmove",
I,!1),l=null);p=m=r=null};var Ba=function(a){if(c){var b=w.viewNode.mousePos(a);P.extendRectSelection(b.x,b.y,a);return!1}return!0},ma=function(a){if(b){var c=w.viewNode.mousePos(a);P.extendTextSelection(c.x,c.y,a);return!1}return!0};d.isViewEventTarget=function(a){for(var b=w.viewNode;a;){if(b.equals(a))return!0;if("TEXTAREA"===a.tagName||"SELECT"===a.tagName)break;if("oit-em_allheaders"===a.id)break;if(y.hasClass(a,"oit-emheadervalues")||y.hasClass(a,"oit-em_allheaders")||y.hasClass(a,"oit-note-icons")||
y.hasClass(a,"oit-ssoverlay"))return!0;if(y.hasClass(a,"oit-button")||y.hasClass(a,"oit-note")||y.hasClass(a,"oit-expander"))break;a=a.parentNode}return!1};var ea=function(a){var b;if(void 0!==a.buttons)b=a.buttons;else switch(a.button){case 0:b=1;break;case 1:b=4;break;case 2:b=2;break;case 3:b=8;break;case 4:b=16}return b},Qa=function(a){"text"===P.selectionType()&&P.select(null);B.deactivateAnnotation();var b=a.center;M.activateNearest(b.x,b.y,a.srcEvent)},na=function(a){e=!1;if(!w.editingComment){var d=
a.center;w.viewNode.focus();e=!0;var g=x.selectionMode;"rect"===g||"cell"===g?(c=!0,P.startRectSelection(d.x,d.y)):"text"==g&&P.startTextSelection(d.x,d.y,"word",a)&&(b=!0)}},oa=function(a){var d;if(c||b)c?(c=!1,d=a.center,P.endRectSelection(d.x,d.y,a.srcEvent)):b&&(b=!1,d=a.center,P.endTextSelection(d.x,d.y,a.srcEvent))},Ra=function(a){a.press||(a=w.viewNode,N=a.scroll(),g=u=0,t=a.scrollWidth-a.clientWidth,A=a.scrollHeight-a.clientHeight,D.startElasticScroll())},Ca=function(a){if(a.press)c?(a=a.center,
P.extendRectSelection(a.x,a.y)):b&&(a=a.center,P.extendTextSelection(a.x,a.y));else if(N){var d=w.viewNode,e=a.delta,n=N.left-e.x,e=N.top-e.y,f=ka(n,0,t),C=ka(e,0,A);d.autoscroll(f,C);a.kinetic||(u=n-f,g=e-C,(u||g)&&D.elasticScroll(u,g))}},Cb=function(a){a.press||(N=void 0,D.endElasticScroll(u,g),g=u=0)},Jb=function(a){E=x.zoom;d.on.beginpinchzoom.dispatch()},K=function(a){E&&F.zoom(E*a.scale,a.center,!0)},Bb=function(a){E=void 0;d.on.endpinchzoom.dispatch()},R=function(a){h=x.rotation},ua=function(a){if(void 0!==
h){var b=h;a=Ub(180*a.rotation/Math.PI,"deg");60<a&&300>a&&(b=135>a?b+90:225>a?b+180:b+270);F.rotate(b)}},L=function(a){h=void 0}}}),Z=ta.extend("content",{events:{data:{},add:{},first:{},last:{}},install:function(d){var e=!1,a=!0,c=!1,b=[],f=[],k,v,l,r=0,m=!1,p=!1,z=null,q=[],G=function(){k&&(k.hide(),k=null)},V=function(a){a&&(f.push({data:a}),e&&!l&&(l=ba(t,0)),(a=b.shift())&&a.destroy())},T=function(a){a={url:a,cache:!0,retryDelay:0,pendingText:""};a.ajax=Ia({url:a.url,cache:a.cache,complete:h,
args:[a]});f.push(a)};d.isPending=function(){return 0<f.length||0<q.length};d.manifest=function(){return z};d.initializeContent=function(a,b,c){OIT.content&&(V(OIT.content),delete OIT.content);c?(w.singlePageIndex=Number(c),b&&w.dynamicContent&&N(b)):b?(w.dynamicContent=!0,N(b)):a&&"none"!==a&&(w.dynamicContent=!0,E(a));e=!0;0<f.length&&!l&&(l=ba(t,0))};var J=function(a){if(!v&&a){if((void 0===x.outputBaseUrl||null===x.outputBaseUrl||""===x.outputBaseUrl)&&x.detectBaseUrl&&"/"!=a[0]&&0!==a.search(/http/i)){var b=
w.URL.lastIndexOf("/");if(-1!=b){b=w.URL.substr(0,b+1);if(0===b.search(/http/i)){var c=Y.createElement("a");c.href=b;b=c.pathname||c.pathName;"/"!=b[0]&&(b="/"+b)}0!==a.indexOf(b)&&(w.baseURL=b||null)}}v=w.baseURL}return v},N=function(a){if(a){var c=J(a);c&&"/"!=a.charAt(0)&&(a=Ka(c,a));0===w.URL.indexOf("file://")?(c=y.create("script"),c.attr("src",a),y.head.append(c),b.push(c)):T(a)}},E=function(a){if(a&&"none"!==a){var b=J(a);b&&"/"!=a.charAt(0)&&(a=Ka(b,a));T(a)}},h=function(b,c,e,g,t){t.status=
g;404===g&&(e="");200===g||404==g?0===e.length||0===e.indexOf("%")?(e!==t.pendingText&&(t.pendingText=e,t.retryDelay=0),t.retryDelay>x.contentTimeout?(G(),d.logAJAXError(null,"Timed out while loading the document content data from the server",b,Sb),db(),f=[]):(a&&(k||(k=Ga.createProgressDialog(R.PLEASE_WAIT_INITIALIZING,!1))),t.cache=!1,t.retryDelay+=200,ba(function(){t.ajax=Ia({url:t.url,cache:t.cache,complete:h,args:[t]})},200))):(u(t,e),G()):(G(),d.logAJAXError(null,"Failed to load the document content data from the server",
b,g,e),db(),f=[])};d.isICD=function(a){return"if(window.OIT&&OIT.icd)OIT.icd("==a.substring(0,31)};var u=function(a,b){var c,e=b.indexOf("else OIT.content={");-1!=e?(e+=18,c=b.lastIndexOf("}"),-1!=c&&(b="{"+b.substring(e,c)+"}")):d.isICD(b)&&(e=31,c=b.lastIndexOf(");"),-1!=c&&(b=b.substring(e,c)));try{var g=JSON.parse(b);a.data=g;l||(l=ba(t,0))}catch(O){d.logAJAXError(null,"Document data is corrupt ("+O+")",a.url,a.status,b)}},g=function(a){Ia({url:a,complete:function(a,b,c,e){if(200==e)try{z=JSON.parse(c);
var g=z.files?z.files.content:null;if(g){for(b=1;b<g.length;b++)q.push(g[b].url);t()}}catch(H){d.logAJAXError(null,"The document manifest is corrupt ("+H+")",a,e,c),p=!1,z=null}else d.logAJAXError(null,"Failed to load the document manifest from the server",a,e,c),p=!1,z=null}})},t=function(){l=void 0;if(e&&!m&&0<f.length&&f[0].data){for(var b=a;0<f.length&&f[0].data;){var h=f.shift();h.data.info&&h.data.info.manifest&&w.dynamicContent&&(g(h.data.info.manifest),p=!0);A(h.data);a=!1;void 0===w.singlePageIndex?
h.data.nextContent?p||N(h.data.nextContent):h.data.nextData?p||E(h.data.nextData):c=!0:c=!0}b&&d.on.first.dispatch();d.on.add.dispatch();c&&d.on.last.dispatch()}for(;20>f.length&&0<q.length;)E(q.shift())},A=function(b){if(b){if(b.info&&b.info.version){var c=b.info.version.split("."),e=parseInt(c[0],10),g=parseInt(c[1],10),c=parseInt(c[2],10);0<e&&0<=g&&9>=g&&0<=c&&9>=c&&(r=e+g/10+c/100)}d.on.data.dispatch(b,a,r)}};d.processICD=function(a,b,c){if(d.isICD(a)){var e=a.lastIndexOf(");");if(-1!=e){a=a.substring(31,
e);try{a=JSON.parse(a),A(a)}catch(ia){d.logAJAXError(null,"ICD data is corrupt ("+ia+")",b,c,a)}}}};F.onreset(function(){l&&sa(l);G();e=!1;a=!0;c=!1;b=[];f=[];l=v=k=void 0;r=0;p=m=!1;z=null;q=[];w.singlePageIndex=void 0;d.on.add.reset()});Va.onbeginscroll(function(){m=!0});Va.onendscroll(function(){m=!1;t()});nb("icd",V)}}),F=ta.extend("document",{exports:"cellRange cellSelection externalData externalValue find findAll getOptions getRawText getSelectedText highlight print properties rectRange rectSelection removeExtraEmailHeaders rotate select selection selectionMode selectionStyle selectionType setOptions showHidden textRange textSelection updateViewSize zoom zoomIn zoomOut".split(" "),
events:{load:{pub:!0,detail:function(){return{url:w.URL}},onAdd:function(d,e){w.documentLoaded&&ba(function(){d.dispatchTo(e)},0)}},reset:{},unload:{pub:!0},zoom:{pub:!0,detail:function(d,e,a){return{zoom:d,mode:e}}},rotate:{pub:!0,detail:function(d){return{angle:d}}},resize:{},idle:{pub:!0,onListen:function(){F.resetIdleTimer()},onUnlisten:function(){F.resetIdleTimer()},onAdd:function(){F.resetIdleTimer()},onRemove:function(){F.resetIdleTimer()}},error:{pub:!0,detail:function(d,e){return{message:d,
fatal:!!e}}},select:{pub:!0,detail:function(d,e,a,c,b){d={selection:d,empty:c};e&&a&&(d.start=e,d.end=a);void 0!==b&&(d.highlightid=b);return d}},scroll:{pub:!0,detail:function(d,e,a,c){e=w.viewNode;d=B.mapToPage(0,0);e=B.mapToPage(e.clientWidth,e.clientHeight);return d&&e?{viewUpperLeft:{pageIndex:d.page.index,x:d.x,y:d.y},viewLowerRight:{pageIndex:e.page.index,x:e.x,y:e.y}}:{viewUpperLeft:{pageIndex:0,x:0,y:0},viewLowerRight:{pageIndex:0,x:0,y:0}}}},scrollupdate:{delay:200},keydown:{pub:!0,detail:function(d){return{srcEvent:d}}},
optionschanged:{pub:!0,detail:function(d){return d}},showmessage:{pub:!0,detail:function(d,e,a){return{message:d||"",modal:e||!1,progress:a||!1}}},progress:{pub:!0,detail:function(d){return{percentDone:d||0}}},hidemessage:{pub:!0},done:{pub:!0},hiddencontent:{pub:!0,detail:function(d,e){var a={},c,b;for(b=0;b<e.length;b++)c=e[b],c.supported&&d[c.name]&&(x[c.option]!==c.optionValue?(a.supportedNotVisible||(a.supportedNotVisible=[]),a.supportedNotVisible.push(R[c.message])):(a.supportedVisible||(a.supportedVisible=
[]),a.supportedVisible.push(R[c.message])));for(b=0;b<e.length;b++)c=e[b],!c.supported&&d[c.name]&&(a.unsupported||(a.unsupported=[]),a.unsupported.push(R[c.message]));return a}},ajax:{pub:!0,single:!0,detail:function(d){return{request:d}}},ajaxabort:{pub:!0,single:!0,detail:function(d){return{request:d}}}},install:function(d){var e=[.1,.25,.5,.75,1,1.25,1.5,2,3,5,10,20,40],a=e[0],c=e[e.length-1],b=["rows","columns","all","none"],f=[{name:"hidden-pages",supported:!0,message:"HIDDEN_CONTENT_PAGES",
option:"showHiddenSheets",optionValue:!0},{name:"hidden-columns",supported:!0,message:"HIDDEN_CONTENT_COLUMNS",option:"showHiddenColumns",optionValue:!0},{name:"hidden-rows",supported:!0,message:"HIDDEN_CONTENT_ROWS",option:"showHiddenRows",optionValue:!0},{name:"hidden-text",supported:!0,message:"HIDDEN_CONTENT_TEXT",option:"showAnnotations",optionValue:!0},{name:"comments",supported:!0,message:"HIDDEN_CONTENT_COMMENTS",option:"showAnnotations",optionValue:!0},{name:"tracked-changes",supported:!0,
message:"HIDDEN_CONTENT_TRACKED_CHANGES",option:"showAnnotations",optionValue:!0},{name:"speaker-notes",supported:!0,message:"HIDDEN_CONTENT_SPEAKER_NOTES",option:"showSlideNotes",optionValue:!0},{name:"hidden-slides",supported:!0,message:"HIDDEN_CONTENT_SLIDES",option:"presentationMode",optionValue:"normal"},{name:"comments-unsupported",supported:!1,message:"HIDDEN_CONTENT_COMMENTS"},{name:"hidden-text-unsupported",supported:!1,message:"HIDDEN_CONTENT_TEXT"},{name:"tracked-changes-unsupported",supported:!1,
message:"HIDDEN_CONTENT_TRACKED_CHANGES"},{name:"large-sheet-unsupported",supported:!1,message:"HIDDEN_CONTENT_LARGE_SHEET"}],k=!1,v,l,r,m=!1,p,z,q={},G={},V,T,J,N={},E,h=[],u={},g,t=!1,A,U=0,S;d.properties=function(){if(w.documentLoaded)return ab(q)};d.externalValue=function(a){if(w.documentLoaded)return G[a]};d.externalData=function(){if(w.documentLoaded)return G};d.revisions=function(){return S};d.getOptions=function(a){if(void 0===a){a=x.items();var b={},c;for(c in a)x.isPublic(c)&&(b[c]=x[c]);
b.showSlideComments=b.showAnnotations;return b}if(a&&"string"==typeof a&&("showSlideComments"===a&&(a="showAnnotations"),x.isPublic(a)))return x[a]};d.setOptions=function(a){if(a){for(var b in a){"showSlideComments"===b&&(b="showAnnotations");var c=a[b];x.isPublic(b)&&x[b]!=c&&(x[b]=c)}na()}};Va.onbeginpinchzoom(function(a,b){k=!0});Va.onendpinchzoom(function(){k=!1;d.dispatchPageEvents(!0);La()});var W=function(b){b<a?b=a:b>c&&(b=c);return b};d.zoom=function(a,b,c){if("number"===typeof a){var e=
W(a);e!=a&&(c||d.invalidArg("zoom","zoom",a,"using fallback zoom factor "+e,!1),a=e);if(x.zoomMode||a!=x.zoom)x.zoom=a,x.zoomMode=null,d.dispatchPageEvents(!1,b)}else"string"===typeof a?a!=x.zoomMode&&(x.zoomMode=a,d.dispatchPageEvents(!1,b)):"undefined"===typeof a||c||d.invalidArg("zoom","zoom",a);return x.zoom};d.zoomIn=function(){for(var a=0;a<e.length;a++)if(e[a]>x.zoom){d.zoom(e[a]);break}return x.zoom};d.zoomOut=function(){for(var a=e.length-1;0<=a;a--)if(e[a]<x.zoom){d.zoom(e[a]);break}return x.zoom};
d.rotate=function(a){"number"===typeof a?x.rotation=Ub(a,"deg"):void 0!==a&&d.invalidArg("rotate","angle",a,"Angle must be an integer multiple of 90 degrees.");return x.rotation};d.showHidden=function(a){w.documentLoaded&&D.features().showhidden&&(void 0!==a&&-1==b.indexOf(a)?d.invalidArg("showHidden","mode",a,"Must be one of "+JSON.stringify(b)):D.showHidden(a))};var qa=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",
def:!0},{name:"direction",type:"string",legal:["up","down"],def:"down"},{name:"startACC",type:"number"},{name:"searchType",type:"string",legal:["string","dtsearch"],def:"string"}];d.find=function(a,b,c,e,g){if(w.documentLoaded){var n=d.processArguments("find",arguments,qa);n&&ba(ca,0,{finder:ja.findStart(n.searchType,n.searchTerm,n.caseSensitive,n.direction,g),callbackFn:n.callbackFn})}};var ia=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",
type:"boolean",def:!0},{name:"searchType",type:"string",legal:["string","dtsearch"],def:"string"}];d.findAll=function(a,b,c){if(w.documentLoaded){var e=d.processArguments("findAll",arguments,ia);e&&d.findAllArgs(e)}};d.findAllArgs=function(a){w.documentLoaded&&a&&ba(la,0,{finder:ja.findStart(a.searchType,a.searchTerm,a.caseSensitive),callbackFn:function(b){var c=!0;b?a.callbackFn&&(c=a.callbackFn.call(null,b.range)):(a.callbackFn&&a.callbackFn.call(null),c=!1);!1!==c&&(c=!0);return c},startIterationFn:null,
endIterationFn:null})};d.getRawText=function(a){w.documentLoaded&&(Na(a)?ba(Ba,0,{callbackFn:a,textBlockIndex:0}):d.invalidArg("getRawText","callbackFunction",a,"must be a function"))};var O=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"style",type:"string",req:!0},{name:"callbackFn",type:"function"},{name:"caseSensitive",type:"boolean",def:!0},{name:"properties",type:"object"},{name:"searchType",type:"string",legal:["string","dtsearch"],def:"string"}];d.highlight=function(a,b,c,e,g){if(w.documentLoaded)if(!1===
ja.hasRawText())d.logError("highlight","Search functionality has been disabled for this document");else if(M)if(!1===D.features().highlights)d.logError("highlight","Highlighting functionality is not available for this document type");else{var n=d.processArguments("highlight",arguments,O);n&&d.highlightArgs(n)}else d.logError("highlight","Highlighting functionality has been disabled for this document")};d.highlightArgs=function(a){if(w.documentLoaded&&a){var b=Ga.createProgressDialog(R.PLEASE_WAIT,
!0);M.beginBatch();ba(la,0,{finder:ja.findStart(a.searchType,a.searchTerm,a.caseSensitive),callbackFn:function(c){var d=!0;if(c){var e;if(c.terms){e=[];for(var g=0;g<c.terms.length;g++)e.push(c.terms[g].range);e=M.add(a.style,e,a.properties)}else e=M.add(a.style,c.range,a.properties);a.callbackFn&&(d=a.callbackFn.call(null,c.range,e))}else a.callbackFn&&a.callbackFn.call(null),d=!1;!1!==d&&(d=!0);d||(M.endBatch(),b.hide());return d},startIterationFn:function(a){0<a&&(Z.isPending()?b.update(10):b.update(a));
D.suspendUpdate()},endIterationFn:D.resumeUpdate})}};d.select=function(a,b){if(w.documentLoaded){var c=!1;if(!1===ja.hasRawText())d.logError("select","Javascript selection functionality has been disabled for this document");else if(null===a)c=P.select(null);else if(Xa(a)||Pa(a))c=P.select(a);else{var e=wa(a,!0,!0);e?(c=d.selection(),c=0!==Sa(e,c),!1!==b?B.movetoEx(e,{callbackFn:function(){P.select(e)},animate:!1}):P.select(e)):d.invalidArg("select","range",a,"must be a valid text range, cell range, or rect range")}return c}};
d.selectionType=function(){if(w.documentLoaded)return P.selectionType()};d.selectionMode=function(a){a&&(x.selectionMode=a);return x.selectionMode};d.selectionStyle=function(a){var b;void 0!==a&&null!==a&&"string"!==typeof a?d.invalidArg("selectionStyle","style",a,"Must be a valid CSS string"):b=P.style(a);return b};d.selection=function(){var a;if(w.documentLoaded)switch(P.selectionType()){case "text":a=P.textSelection();break;case "cell":a=P.cellSelection();break;case "rect":a=P.rectSelection()}return a};
d.textSelection=function(){if(w.documentLoaded)return P.textSelection()};d.cellSelection=function(){if(w.documentLoaded)return P.cellSelection()};d.rectSelection=function(){if(w.documentLoaded)return P.rectSelection()};d.getSelectedText=function(){if(w.documentLoaded)return D.getSelectedText()};d.textRange=function(){return fa.apply(this,arguments)};d.cellRange=function(){return ra.apply(this,arguments)};d.rectRange=function(){return lb.apply(this,arguments)};d.updateViewSize=function(){ha.dispatchResize()};
var H=function(){if(D.features().fitpage){var a=90==x.rotation||270==x.rotation,b,c=D.padding();b=D.margin();var d=c.left+c.right+b.left+b.right,c=c.top+c.bottom+b.top+b.bottom;a?(a=D.maxPageHeight(),b=D.maxPageWidth()):(a=D.maxPageWidth(),b=D.maxPageHeight());var a=a+B.annotationPaneWidth(),e=w.viewNode;return{w:W((e.clientWidth-d)/a),h:W((e.clientHeight-c)/b)}}};d.dispatchPageEvents=function(a,b){!1!==a&&(a=!0);if(w.documentLoaded&&!t){var c;if(x.zoomMode){var e=1;if(c=H()){switch(x.zoomMode){case "page":e=
Math.min(c.w,c.h);break;case "pagewidth":e=c.w;break;case "pageheight":e=c.h;break;case "mobile":switch(w.deType){case "page":e=c.h<c.w&&c.h>=.9*c.w?c.h:c.w;break;case "drawing":e=(e=ha.infoRaw())&&1557===e.fi?c.w:Math.min(c.w,c.h);break;case "slide":case "chart":case "bitmap":e=Math.min(c.w,c.h)}}e=W(e)}x.zoom=e}else if(w.nochrome||w.isMobile)if(c=H())c=Math.min(c.w,c.h),x.zoom<c&&(x.zoom=c);c=x.zoom;var e=V!=c||T!=x.zoomMode,g=J!=x.rotation;if(a||e||g)D.layoutChanged(b),ha.invalidateCanvas(),w.drawing&&
w.drawing.update(!0);if(a||e)V=c,T=x.zoomMode,d.on.zoom.dispatch(c,x.zoomMode,k);if(a||g)J=x.rotation,d.on.rotate.dispatch(x.rotation);ha.dispatchScroll(a)}};var n=function(){d.dispatchPageEvents(!0)};d.resetIdleTimer=function(){var a;v&&(sa(v),v=null);l&&(Oa(l),l=null);d.on.idle.hasListeners()?(m||(a=d.resetIdleTimer,y.listen("mousemove",a,!0),y.listen("touchmove",a,!0),y.listen("keydown",a,!0),d.onscroll(a),m=!0),v=ba(function(){l=qb(function(){d.on.idle.dispatch(!1)},50,d.on.idle)},200),r||(r=
qb(function(){d.on.idle.dispatch(!0)},500,d.on.idle))):(r&&(Oa(r),r=null),a=d.resetIdleTimer,y.unlisten("mousemove",a),y.unlisten("touchmove",a),y.unlisten("keydown",a),d.offscroll(a))};var C=function(){var a=D.pageRect(B.count()-1,"overlay");a&&(a=a.bottom-20*(B.count()-1),d.printCSS(".oit-view-root","height:"+a+"px;"));for(;void 0!==U;)if(B.on.change.disable(),a=B.page(U))if(a.overlay&&!a.overlay.isHidden()){a.load(!0,I);U=void 0;break}else U++;else{if(!w.documentComplete)break;d.logFatalError(null,
"No visible pages were found in the document");U=void 0;break}},I=function(a){B.moveto(a.index);w.documentLoaded=!0;w.documentLoading=!0;d.on.load.dispatch();w.documentLoading=!1;B.on.change.enable();B.dispatchChange(void 0,!0);d.dispatchPageEvents(!0);w.documentComplete&&d.on.done.dispatch()};d.installDocument=function(a,b){var c=!0,e=y.create("div");e.html(b);(e=e.byClass("oit-view-root"))&&0<e.length&&(e=e[0]);var g,n,f;e&&(g=e.data("icd"),n=e.data("json"),f=e.data("page"));if(!g&&!n||"none"==
n)c="This document can't be loaded into the web view.",ha.logFatalError("load","none"==n?c+" \nThe html file must be created in Ajax mode.":c+" \nThe html file does not appear to have been created by Web View Export.",b),c=!1;else{if(oc(a)){var e=Y.URL,C=e.indexOf("//");if(-1===C)w.URL=a;else{var C=C+2,h=e.lastIndexOf("/"),e=-1!=h&&h>C?e.substr(0,h+1):e+"/";"/"===a[0]&&(C=e.indexOf("/",C)+1,e=e.substr(0,C));w.URL=Ka(e,a)}}else w.URL=a;Z.initializeContent(n,g,f);d.initializeDocument()}return c};d.unload=
function(){var a=w.documentLoaded;try{D.unloadDisplay()}catch(Ca){d.logError("unload","Error while unloading display ("+Ca+")")}w.documentLoaded=!1;w.documentComplete=!1;w.hasHiddenText=!1;w.hasWorksheetRevisions=!1;try{P.reset()}catch(Ca){d.logError("unload","Error while resetting selection ("+Ca+")")}try{M.clear()}catch(Ca){d.logError("unload","Error while clearing highlights ("+Ca+")")}try{$b()}catch(Ca){d.logError("unload","Error while aborting timers ("+Ca+")")}try{db()}catch(Ca){d.logError("unload",
"Error while aborting AJAX requests ("+Ca+")")}try{d.on.reset.dispatch()}catch(Ca){d.logError("unload","Error while resetting view ("+Ca+")")}a&&d.on.unload.dispatch();x.zoom=1;x.zoomMode=null;k=!1;U=0;v&&(Oa(v),v=null);l&&(Oa(l),l=null);r&&(Oa(r),r=null);q={};G={};h=[];w.documentLoading=!1;u={};t=!1;S=null;g&&(g.destroy(),g=null);A&&(A.destroy(),A=null);w.drawing&&(w.drawing.destroy(),w.drawing=void 0);p&&(p.destroy(),p=void 0);z&&(z.destroy(),z=void 0);(a=w.viewNode)&&a.html("");w.URL=Y.URL;Z.onadd(C)};
d.initializeDocument=function(){w.viewNode&&(w.drawing=new Rc(w.viewNode),z=new Ab("screen"),0<B.count()&&d.updateViewSize())};d.screenCSS=function(a,b){if(z)if(null===b)z.deleteRule(a);else if("string"==typeof b)z.setRule(a+"{"+b+"}",a);else if("object"==typeof b){var c=a+"{",d;for(d in b)c+=d+":"+b[d]+";";z.setRule(c+"}",a)}};d.printCSS=function(a,b){p||(p=new Ab("print"));if(null===b)p.deleteRule(a);else if("string"==typeof b)p.setRule(a+"{"+b+"}",a);else if("object"==typeof b){var c=a+"{",d;for(d in b)c+=
d+":"+b[d]+";";p.setRule(c+"}",a)}};var ca=function(){var a=ja.findNext(this.finder);a||!Z.isPending()&&!ja.isPending()?(a?this.callbackFn.call(null,a.range):this.callbackFn.call(null),Z.offadd(ca),ja.offadd(ca)):(Z.onadd(this,ca),ja.onadd(this,ca))},la=function(){var a=!0,b=!1;this.curACC||(this.curACC=0);if(this.startIterationFn){var c=100*this.curACC/ja.lastACC();this.startIterationFn(c)}for(c=0;100>c;c++){var d=ja.findNext(this.finder);if(d){if(this.curACC=d.range.acc,!1===this.callbackFn.call(null,
d)){a=!1;b=!0;break}}else{Z.isPending()||ja.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}}if(a)ba(la,50,this);else if(b)Z.offadd(la),ja.offadd(la);else if(Z.isPending()||ja.isPending())Z.onadd(this,la),ja.onadd(this,la);this.endIterationFn&&this.endIterationFn()},Ba=function(){for(var a=!0,b=!1,c=0;10>c;c++){var d=ja.getRawTextBlock(this.textBlockIndex);if(d)if(d.text){var e=d.text,g=d.range.acc;if(void 0!==this.acc){var n=this.acc-d.range.acc;0<n&&(e=e.substring(n),g+=n)}this.acc=d.range.accend;
if(!1===this.callbackFn.call(null,e,g)){a=!1;b=!0;break}this.textBlockIndex++}else{a=!1;break}else{Z.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}}a?ba(Ba,50,this):b?(Z.offadd(Ba),ja.offadd(Ba)):(Z.onadd(this,Ba),ja.onadd(this,Ba))};d.removeExtraEmailHeaders=function(){x.removeExtraEmailHeaders=!0};d.externalLinks=function(){return h};var ma=function(a,b){t=!0;d.setOptions({showHiddenSheets:b,showHiddenColumns:b,showHiddenRows:b,showAnnotations:b,showSlideNotes:b,presentationMode:b?"normal":
"slideshow"});t=!1;B.updateShowSlideNotes();d.dispatchPageEvents(!0);ea();g.collapse();return!1};d.supressHiddenContentUpdate=function(){return t};var ea=function(){var a,b;if("none"===x.showHiddenContentNotification)g&&g.css("display","none");else if(!w.staging&&g&&!t){var c=[],d=!1,e=!1;for(b=0;b<f.length;b++)a=f[b],a.supported&&u[a.name]&&(c.push("<li>",R[a.message],"</li>"),x[a.option]!==a.optionValue?d=!0:e=!0);var n=[];0<c.length&&(n.push(R.HIDDEN_CONTENT_NOTIFICATION,"<div><ul>"),Array.prototype.push.apply(n,
c),n.push("</ul>"),d?n.push(R.HIDDEN_CONTENT_INVISIBLE,'</div><div><a class="oit-showhiddenlink">',R.HIDDEN_CONTENT_SHOWLINK,"</a></div>"):n.push(R.HIDDEN_CONTENT_ALREADY_VISIBLE,'</div><div><a class="oit-hidehiddenlink">',R.HIDDEN_CONTENT_HIDELINK,"</a></div>"));var c=[],C=!1;for(b=0;b<f.length;b++)a=f[b],!a.supported&&u[a.name]&&(c.push("<li>",R[a.message],"</li>"),C=!0);0<c.length&&(0<n.length&&n.push("<div>&nbsp;</div>"),n.push(R.HIDDEN_CONTENT_ORIGINAL_APPLICATION,"<div><ul>"),Array.prototype.push.apply(n,
c),n.push("</ul></div>"));n=n.join("");g.message(n);g.css("display",null);d||C?e?g.title(R.HIDDEN_CONTENT_PARTIAL):g.title(R.HIDDEN_CONTENT_HIDDEN):g.title(R.HIDDEN_CONTENT_VISIBLE);"expanded"===x.showHiddenContentNotification?g.expand(!1):g.collapse(!1);if(d){if(a=g.byClass("oit-showhiddenlink"))a[0].onclick(null,ma,!0),a[0].ontap(null,ma,!0)}else if(a=g.byClass("oit-hidehiddenlink"))a[0].onclick(null,ma,!1),a[0].ontap(null,ma,!1)}x.showAnnotations?w.viewNode.addClass("oit-showannotations"):w.viewNode.removeClass("oit-showannotations")};
d.hiddenContent=function(a){u[a]||(u[a]=!0,g||(g=new zc({title:R.HIDDEN_CONTENT_HIDDEN,collapseButton:!0}),g.onexpand(function(){x.showHiddenContentNotification="expanded"}),g.oncollapse(function(){x.showHiddenContentNotification="collapsed"})),ea(),d.on.hiddencontent.dispatch(u,f))};d.documentException=function(a){};d.showNotifications=function(){ea()};var Qa=function(a,b,c){N[c]=a;E||(E=ba(na,50))},na=function(){if(E){var a=N;N={};sa(E);E=void 0;d.on.optionschanged.dispatch(a)}};d.print=function(){Q.print()};
Z.onadd(C);Z.ondata(function(a,b,c){var e;if(a.properties)for(e in a.properties)q[e]=a.properties[e];if(a.external)for(e in a.external)G[e]=a.external[e];if(a.options){for(var g in a.options)if(b=a.options[g],c=g.indexOf("."),0<c){var n=g.substring(0,c);g=g.substring(c+1);if("glob"==n||"opt"==n)c="glob"==n?w:x,c.hasOwnProperty(g)&&(c[g]=b)}w.hasHiddenText&&d.hiddenContent("hidden-text-unsupported");w.hasWorksheetRevisions&&d.hiddenContent("tracked-changes-unsupported")}if(a.info&&a.info.status)for(e in a.info.status)a.info.status[e]&&
d.documentException(e);a.xlinks&&(h=h.concat(a.xlinks));a.revisions&&(S=S?S.concat(a.revisions):a.revisions.slice(0))});Z.onlast(function(){if(S){for(var a=!1,b=!1,c=!1,e=!1,g=0;g<S.length;g++){var n=S[g],f=!0;b&&e||"add"!==n.type&&"delete"!==n.type?a&&c||"hidden"!=n.type||(f=!1):f=!1;if(!f){var C;n.range&&(C=B.forRange(n.range),C||(f=B.lastPage(),n.range.acc>f.accend&&(C=f)));C&&"page"===C.type?"add"===n.type||"delete"===n.type?b=!0:"hidden"===n.type&&(a=!0):"add"===n.type||"delete"===n.type?e=!0:
"hidden"===n.type&&(c=!0)}}a&&d.hiddenContent("hidden-text");b&&d.hiddenContent("tracked-changes");c&&d.hiddenContent("hidden-text-unsupported");e&&d.hiddenContent("tracked-changes-unsupported")}w.documentComplete=!0;w.documentLoaded&&d.on.done.dispatch()});ha.onresize(function(){w.editingComment?M.alignComment():d.dispatchPageEvents(!0)});B.onchange(function(){1!=B.activeOverlay().length&&"vertical"==x.scrollMode||d.dispatchPageEvents(!0)});x.oncenterPages(n);x.onrotation(n);x.onshowHiddenSheets(ea);
x.onshowHiddenColumns(ea);x.onshowHiddenRows(ea);x.onshowAnnotations(ea);x.onshowSlideNotes(ea);x.onpresentationMode(ea);x.onshowHiddenContentNotification(ea);var n=x.items(),oa;for(oa in n)if(x.isPublic(oa))x["on"+oa](Qa)}}),B=ta.extend("pages",{exports:"count current info moveto movetoNext movetoPrev pageName ranges".split(" "),events:{change:{pub:!0,detail:function(d){return B.info(d.index)}},add:{pub:!0,detail:function(d){return{startPage:d}}},pageload:{},pageunload:{},overlayshow:{},overlayhide:{}},
install:function(d){var e=[],a=[],c=null,b=null,f=null,k=0,v=1,l,r,m,p=0,z=0,q=0,G,V,T,J={},N={},E,h;d.firstPage=function(){var b,c;for(c in a){b=a[c];break}return b};d.lastPage=function(){var b,c;for(c in a)b=a[c];return b};d.current=function(){return b?b.index:0};d.pageName=function(b){void 0===b&&(b=d.current());if(b=a[b])return b.name};d.count=function(){return a.length};d.each=function(b,c){wb(a,arguments)};d.eachOverlay=function(a,b){wb(e,arguments)};d.moveto=function(a,b){var c;Na(b)&&(c={callbackFn:b});
return d.movetoEx(a,c)};var u=function(a){d.updateActivePage(a.pageIndex);a.callbackFn&&a.callbackFn.call(null,b.index)};d.movetoEx=function(a,c){c=c||{};w.viewNode.cancelKinetic();if("number"===typeof a)return c.pageIndex=a,t(c);if("object"===typeof a){if(y.isElement(a)||y.isText(a)){c.gotoNode=a;var e=c,g=d.forNode(e.gotoNode);g?(e.pageIndex=S(g.index),e.pageIndex!=g.index&&(e.gotoNode=null),t(e)):(d.logError("moveto","The specified node was not found on any page in the document."),u(e));return b.index}if(e=
wa(a))return c.range=da(e),A(c);if("number"===typeof a.left&&"number"===typeof a.top&&"number"===typeof a.right&&"number"===typeof a.bottom)return c.rect=a,U(c)}d.logError("moveto","Invalid destination: "+Fb(a));return b.index};var g=function(a,b){var e=a.overlay,g=e!==c;if(!b&&!g)return!1;if(g){M.deactivate();P.select(null);D.unloadDisplay();var n=c,f=w.viewNode;n&&(n.saveScroll=f.scroll(),n.undisplay());e.display()}a.load(!1,function(){c=e;d.updateActivePage(a.index);D.loadDisplay(a)});e.show();
e.hasClass("oit-pagestream")?w.viewNode.addClass("oit-pagestream"):w.viewNode.removeClass("oit-pagestream");e.hasClass("oit-emailfill")?w.viewNode.addClass("oit-emailfill"):w.viewNode.removeClass("oit-emailfill");n=a.css("background")||null;w.viewNode.css("background",n);e.saveScroll?(f.scroll(e.saveScroll),delete e.saveScroll):g&&f.scroll(0,0);e.display();d.updateActivePage();return!0},t=function(e){var n=S(e.pageIndex);if(a[n])if(e.force||e.gotoNode||!b||n!=b.index){var f=a[n];d.touchPage(n);if(f.isLoaded()){n=
g(f,e.force);"sn"==f.type&&(x.showSlideNotes=!0);if("vertical"!=x.scrollMode||n)e.animate=!1;d.updateActivePage(f.index);"email"!==f.type&&D.moveto(b.index,u,e)||u(e)}else f.load(!0,function(){e.force=!0;t(e)}),"email"!==f.type&&f.overlay===c?D.moveto(f.index,null,{animate:!1}):c||g(f)}else e.pageIndex=b.index,u(e);else 0<=n&&Z.isPending()?Z.on.add.listenOnce(function(){t(e)}):(d.logError("moveto","Invalid page index: "+n),void 0!==w.singlePageIndex&&(e.pageIndex=w.singlePageIndex),u(e));if(b)return b.index},
A=function(a){if(w.documentLoading)ba(A,0,null,a);else{var c=d.nearestForRange(a.range);if(c)if(c.isPending())g(c),c.load(!0,function(){A(a)});else if(!b||c.overlay!==b.overlay||"vertical"!=x.scrollMode&&c!==b)c.overlay.show(),t({pageIndex:c.index,callbackFn:function(){A(a)}});else{if("sn"==c.type){x.showSlideNotes=!0;var e=d.page(c.index-1);"slide"==e.type&&e.hiddenFromSlideshow&&(x.presentationMode="normal")}else"slide"==c.type&&c.hiddenFromSlideshow&&(x.presentationMode="normal");D.loadRange(a.range,
function(){if(!D.moveto(a.range,u,a))if(d.inAnnotation(a.range)){var b=c.annotationPane();b&&b.activate(a.range,!0,!1,a.callbackFn)}else(b=D.rangeRect(a.range,"view"))?(a.rect=b,U(a)):(a.pageIndex=c.index,t(a))})}else Z.isPending()?Z.on.add.listenOnce(function(){A(a)}):(d.logError("moveto","The specified range was not found in the document: "+Fb(a.range)),u(a))}return b.index},U=function(a){var c=a.rect,d=w.viewNode,e=d.scroll(),g=c.left+e.left,n=c.right+e.left,f=c.top+e.top,h=c.bottom+e.top,t=e.left,
A=e.left+d.clientWidth,k=e.top,q=e.top+d.clientHeight,c=e.left,z=e.top;!0===a.moveToTop?z=f:f<k?(h-=d.clientHeight,0>h&&(h=0),z=f-20,z<h&&(z=h)):h>q&&(z=h+20-d.clientHeight,z>f&&(z=f));g<t?(n=g-d.clientWidth,0>n&&(n=0),c=g-20,c<n&&(c=n)):n>A&&(c=n+20-d.clientWidth,c>g&&(c=g));c!=e.left||z!=e.top?(F.on.scrollupdate.disable(),e=w.deType,e=!a.moveToTop&&"worksheet"!=e&&"database"!=e,a.animate||(e=!1),e=e?150:0,d.abortAnimation(),d.animate({scrollLeft:c,scrollTop:z,time:e,endFn:function(){F.on.scrollupdate.enable();
F.on.scrollupdate.dispatch();u(a)}})):u(a);return b.index};d.movetoPrev=function(a){var c=d.prev();c?d.moveto(c.index,a):a&&a.call(null,b.index);return b.index};d.movetoNext=function(a){var c=d.next();c?d.moveto(c.index,a):a&&a.call(null,b.index);return b.index};d.info=function(b){void 0===b&&(b=d.current());if(a[b])return a[b].info()};d.next=function(c,d){var e;void 0===c&&(c=b.index);var g=c+1;!1!==d&&a[g]&&"email"==a[c].type&&"rt"==a[g].type&&g++;if(a[g])for(;g<a.length;g++){var n=a[g];if(n&&n.isEnabled()&&
!n.overlay.isHidden()&&("sn"!=n.type||x.showSlideNotes)){e=n;break}}return e};d.prev=function(c,d){var e;void 0===c&&(c=b.index);var g=c-1;!1!==d&&a[g]&&a[g-1]&&"email"==a[g-1].type&&"rt"==a[g].type&&g--;if(a[g])for(;0<=g;g--){var n=a[g];if(n&&n.isEnabled()&&!n.overlay.isHidden()&&("sn"!=n.type||x.showSlideNotes)){e=n;break}}return e};var S=function(b){var c,d;for(d=b;d<a.length;d++)if((c=a[d])&&c.isEnabled()&&!c.overlay.isHidden())return d;for(d=b;0<d;d--)if((c=a[d])&&c.isEnabled()&&!c.overlay.isHidden())return d;
return 0};d.loadNextPageFromServer=function(){var b,d;d=D.visiblePages();if(0===d.length)return!1;var e=d[0].index,g=d[d.length-1].index;0>v?(e-=3,g+=1):g+=3;0>e&&(e=0);g>=a.length&&(g=a.length-1);if(0>v){if(void 0===l||l>g)l=g;for(;l>=e;l--)(d=a[l])&&d.overlay===c&&d.isPending()&&(d.load(!1),b=!0)}else{if(void 0===l||l<e)l=e;for(;l<=g;l++)(d=a[l])&&d.overlay===c&&d.isPending()&&(d.load(!1),b=!0)}return b};d.updateActivePage=function(a){if(c){var e=b,g=w.viewNode.scroll().top;void 0!==a?e=d.page(a)||
b:1==c.length?e=c.firstPage:"vertical"==x.scrollMode&&void 0===w.singlePageIndex&&g!=k&&(a=d.mapToPage(10,20,void 0,!0))&&(e=a.page);g!=k&&(v=g<k?-1:1,k=g);if(e!=b){b=e;c=b.overlay;e=D.visiblePages();for(g=0;g<e.length;g++)d.touchPage(e[g].index);d.dispatchChange(b)}}};d.page=function(b){return a[b]};d.byName=function(b){var c,d;for(d in a)if(a[d].name===b){c=a[d];break}return c};d.forNode=function(a){return y.wrap(a).ancestorData("page")};d.nearestForRange=function(b){var c,e,g,n=d.pagesForRange(b);
if(!n&&"text"===b.type)for(e=0;e<a.length;e++)if((g=a[e])&&"drawing"===g.type&&b.accend>=g.acc&&b.acc<=g.accend){n=[g];break}if(n)if(1==n.length)c=n[0];else if((e=D.visiblePages())&&0<e.length){var f=e[0].index,h=e[e.length-1].index,t;for(e=0;e<n.length;e++)if(g=n[e],g.isEnabled()){var A=g.index,k=0;A<f?k=f-A:A>h&&(k=A-h);!c||k<t?(c=g,t=k):0===k&&(A=D.rangeRect(b,"view"))&&0>A.bottom&&(c=g,t=k)}}return c};d.forRange=function(b,c,d){var e;if(b)switch(c=c||0,!0!==d&&(d=!1),b.type){case "text":for(;c<
a.length;c++){var g=a[c];if(g&&b.accend>=g.acc&&b.acc<=g.accend&&(!0!==d||"worksheet"!==g.type&&"database"!==g.type&&"email"!==g.type||g.isLoaded()||g.load(),g.containsRange(b))){e=g;break}}break;case "cell":case "rect":b.page>=c&&b.page<a.length&&(e=a[b.page])}return e};d.inAnnotation=function(b){var c=!1;if("text"==b.type)for(var d=0;d<a.length;d++){var e=a[d];if(e&&b.accend>=e.acc&&b.acc<=e.accend&&e.inAnnotation(b)){c=!0;break}}return c};d.pagesForRange=function(b,c){for(var e,g=0;g<a.length;){g=
d.forRange(b,g,c);if(!g)break;e||(e=[]);e.push(g);g=g.index+1}return e};d.top=function(){var a=D.visiblePages();if(a&&0<a.length)return a[0].index};d.bottom=function(){var a=D.visiblePages();if(a&&0<a.length)return a[a.length-1].index};d.mapToPage=function(e,g,f,h,t,A){var n;if(f)n=f.pageRect("view");else if(b){f=b;if(f.isHidden()||"sn"===f.type&&!x.showSlideNotes)(f=d.next(b.index))||(f=d.prev(b.index));var C=!0;!0!==h&&"email"==f.type&&(C=!1,0===f.index&&(f=2<=a.length?a[1]:null));f&&(n=f.pageRect("view"));
if("vertical"==x.scrollMode&&void 0===w.singlePageIndex&&1<c.length)for(;n;)if(g<n.top){h=d.prev(f.index,!1)||f;if(h===f||0===f.index||!C&&0===h.index)break;if(h.overlay!=f.overlay)break;var k=h.pageRect("view");if(g>k.bottom){n.top-g>g-k.bottom&&(f=h,n=k);break}f=h;n=k}else if(g>n.bottom){if(f.index==a.length-1)break;h=d.next(f.index,!1)||f;if(h===f||h.overlay!=f.overlay)break;k=h.pageRect("view");if(g<k.top){k.top-g<g-n.bottom&&(f=h,n=k);break}f=h;n=k}else break}C=!1;if(f){if(t&&(e>n.right||e>w.viewNode.clientWidth)&&
f.annotationPane()){t=w.viewNode;k=t.pos(y.body);h=e+k.left;var k=g+k.top,q=f.annotationPane().contentRect(y.body);q&&(h=h+t.scrollLeft-q.left,k=k+t.scrollTop-q.top,A||0<=h&&0<=k&&h<=q.width&&k<=q.height)&&(e=h,g=k,C=!0)}if(!C&&(n&&(e-=n.left,g-=n.top),D.features().zoom&&(n=x.zoom,1!=n&&(e=K(e/n),g=K(g/n))),D.features().rotate&&(A=x.rotation,0!==A)))switch(n=f.pageRect(),t=e,h=g,A){case 90:e=n.width-h;g=t;break;case 180:e=n.width-t;g=n.height-h;break;case 270:e=h,g=n.height-t}return{page:f,x:e,y:g,
inAnnotation:C}}};d.elementRect=function(a,b){var c;c=new ga(a.rect(w.viewNode),"view");c.origin=b;return c};d.findTextRange=function(d){if("text"===d.type){var e;if("vertical"!=x.scrollMode||void 0!==w.singlePageIndex)void 0!==b.acc&&d.acc<=b.accend&&d.accend>=b.acc&&(e=b.findTextRange(d));else for(var g in a){var f=a[g];if(f.overlay===c&&f.isLoaded()&&f.isEnabled()&&void 0!==f.acc&&d.acc<=f.accend&&d.accend>=f.acc&&(f=f.findTextRange(d)))if(e)for(var n=0;n<f.length;n++)e.push(f[n]);else e=f}return e}};
var W=function(a,b,c){var d=!1;if(c)if(Array.isArray(c))for(var e=0;e<c.length&&!(d=W(a,b,c[e]));e++);else c.range&&"text"===c.range.type&&a<=c.range.accend&&b>=c.range.acc&&(d=!0);return d};d.isAnnotationText=function(a,b,c){var e=!1;if(c)for(var g=0;!e&&g<c.length;g++)e=c[g],e=W(a,b,e.text)||W(a,b,e.oldtext)||W(a,b,e.author)||W(a,b,e.author_short)||W(a,b,e.last_save_date)||W(a,b,e.create_date)||W(a,b,e.date);else(c=F.revisions())&&(e=d.isAnnotationText(a,b,c)),!e&&h&&(e=d.isAnnotationText(a,b,h.revisions));
return e};d.isDocumentText=function(a,b){return d.forRange(fa(a,b),0,!0)?!0:d.isAnnotationText(a,b)};d.maxWidth=function(){if(c)return"vertical"!=x.scrollMode||void 0!==w.singlePageIndex?b.width:c.maxWidth};d.maxHeight=function(){if(c)return"vertical"!=x.scrollMode||void 0!==w.singlePageIndex?b.height:c.maxHeight};d.decomposeRange=function(b,c){var d;if(void 0!==b.page){var e=a[b.page];if(e){if("rect"===b.type)d=e.mapRectRangeToText(b);else if("cell"===b.type){var g=e.spreadsheetModel();g&&(d=g.decomposeRange(b,
c))}(e=e.mapRangeToEmbeds(b))&&(d=d?d.concat(e):e)}}return d};d.ranges=function(b){var c={};void 0===b&&(b=d.current());a[b]&&(b=a[b].textRanges())&&0<b.length&&(c.text=b);return c};var B=function(){if(w.dynamicContent){switch(x.memoryModel){case "none":q=z=0;break;case "large":z=5242880;q=100;break;case "small":z=1048576;q=20;break;case "micro":z=524288;q=10;break;default:w.isMobile?(z=1048576,q=20):(z=5242880,q=100)}d.applyMemoryLimit()}else q=z=0};d.applyMemoryLimit=function(a){var b,c=0;if(G)for(b=
G;b;)0<b.loadedSize&&c++,b=b.nextNewer;void 0!==a&&(p+=a,d.logMemory&&d.logMemory(p,z,c,q));if(0<z&&p>z||0<q&&c>q){if(G){b=G;var e=a=-1,g=D.visiblePages();0<g.length&&(a=g[0].index,e=g[g.length-1].index);for(;b;){g=b.nextNewer;if(0<b.loadedSize&&!b.locked&&(b.index<a||b.index>e)&&(p-=b.loadedSize,b.unload(),c--,p<=z&&c<q))break;b=g}}d.logMemory&&d.logMemory(p,z,c,q)}};d.touchPage=function(b){(b=a[b])&&b!=V&&(void 0===V?G=b:(b==G&&(G=b.nextNewer),b.nextNewer&&(b.nextNewer.nextOlder=b.nextOlder),b.nextOlder&&
(b.nextOlder.nextNewer=b.nextNewer),V.nextNewer=b,b.nextOlder=V,b.nextNewer=void 0),V=b)};var ia=function(){var a,b;b=(b=d.firstPage())&&b.isSpreadsheet();if(void 0===w.singlePageIndex&&(b||1<e.length)){r||(r=new Sc,r.addPrevNext(function(){d.movetoPrev()},function(){d.movetoNext()}));for(b=r.length();b<e.length;b++){a=e[b];var g=a.firstPage;if(!g)break;r.addTab(a.name,a.hidden,d.moveto,g.index);a.isHidden()&&r.hideTab(a.index)}r.show();c&&r.setActiveTab(c.index);if(h){g=[];if(x.showAnnotations)for(b=
0;b<h.revisions.length;b++)a=h.revisions[b],!a.page&&a.ref&&void 0!==a.ref.sheet&&(a.page=d.page(a.ref.sheet)),a.page&&("add_sheet"==a.type?g[a.page.overlay.index]="oit-anno-add":g[a.page.overlay.index]||(g[a.page.overlay.index]="oit-anno-change"));for(b=0;b<e.length;b++){var f=g[b];f||(a=e[b],1==a.length&&a.firstPage.comments()&&(f="oit-anno-change"));r.tabClass(b,f)}}}else r&&(r.destroy(),r=null)};d.dispatchChange=function(a,c){a||(a=b);if(a==f&&!c)return!0;f=a;r&&r.setActiveTab(a.overlay.index);
a.annotationPane()&&a.supportsAnnotationBar()&&d.createAnnotationBar();return d.on.change.dispatch(a)};d.overlayById=function(a){return kb(e,"id",a)};d.pageById=function(b){return kb(a,"id",b)};d.createAnnotationBar=function(){m||(m=new Tc)};d.activeOverlay=function(){return c};d.activePage=function(){return b};d.ssRevisions=function(){return h};var O=function(){ia();k=void 0};d.updateShowSlideNotes=function(){if(!F.supressHiddenContentUpdate()){var a=D.saveScrollPos();x.showSlideNotes?F.screenCSS(".oit-sn",
"display:block;"):(F.screenCSS(".oit-sn",null),b&&"sn"==b.type&&(M.deactivate(),P.select(null)));d.updateActivePage();D.layoutChanged();D.restoreScrollPos(a)}};d.overlayTabRect=function(a){if(r)return r.tabRect(a.index)};d.activeAnnotationPane=function(a){if(void 0!==a&&a!==E){var b=E;E=null;b&&b.deactivate();E=a}return E};d.deactivateAnnotation=function(){d.activeAnnotationPane(null)};d.scrollToAnnotationPane=function(a){if(x.showAnnotations&&d.activePage()&&d.activePage().supportsAnnotationPane()){var b=
w.viewNode;b.animate({scrollLeft:b.scrollWidth-b.clientWidth,endFn:a})}else a&&a()};d.annotationPaneWidth=function(){return x.showAnnotations&&c&&c.hasAnnotations()&&c.firstPage.supportsAnnotationPane()?338:0};var H=function(){!0===x.showHiddenSheets?d.eachOverlay(function(a){a.firstPage&&"worksheet"==a.firstPage.type&&a.show()}):!1===x.showHiddenSheets&&d.eachOverlay(function(a){a.hidden&&a.firstPage&&"worksheet"==a.firstPage.type&&a.hide()})};x.onmemoryModel(B);x.onnochrome(O);x.onshowSlideNotes(d.updateShowSlideNotes);
x.onscrollMode(function(){k=void 0});x.onshowHiddenSheets(H);x.onshowSlideNotes(function(){!1===x.showSlideNotes&&"vertical"!==x.scrollMode&&"sn"===d.activePage().type&&d.movetoPrev()});x.onshowAnnotations(ia);x.onannotationSort(function(){c&&c.each(function(a){(a=a.annotationPane())&&a.applySort()})});F.onreset(function(){for(var d in a){var g=a[d],t=g;p-=t.loadedSize;t.unload();g.destroy()}a=[];pa(e,"destroy");e=[];f=b=c=null;k=0;v=1;r&&(r.destroy(),r=null);m&&(m.destroy(),m=null);T&&(T.destroy(),
T=void 0,J={},N={});z=p=0;h=V=G=l=void 0});Z.ondata(function(b,c,g){var f;if(g=b.style){T||(T=new Ab);var n=[],t=[];for(c=0;c<g.length;c++){var k=g[c];if("string"===typeof k)t.push(k);else if(k.s&&k.p){var A=k.s,k=k.p;"@font-face"===A?J.hasOwnProperty(k)||(J[k]=!0,n.push(A,"{",k,"}")):N.hasOwnProperty(A)||(N[A]=!0,t.push(A,"{",k,"}"))}}0<n.length&&T.addCSSText(n.join(""));0<t.length&&T.addCSSText(t.join(""))}if(b.overlays)for(c=0;c<b.overlays.length;c++)g=b.overlays[c],d.overlayById(g.oid)||e.push(new Cc(e.length,
g));if(b.pages){f=a.length;for(c=0;c<b.pages.length;c++){g=b.pages[c];n=null;"email"===g.type&&(w.singlePageIndex=void 0);if(void 0!==g.index){if(t=parseInt(g.index,10),void 0===w.singlePageIndex||w.singlePageIndex===t)a[t]||(a[t]=new cb(t,g.type,g.id)),n=a[t]}else n=new cb(a.length,g.type,g.id),a.push(n);n&&n.processData(g)}d.applyMemoryLimit()}b.attachments&&(c=d.page(0))&&(c._attachments=b.attachments.slice(0));if(b.ssrevisions&&b.ssrevisions.revisions){h=b.ssrevisions;h.revisions.sort(function(a,
b){return a.seq-b.seq});g=null;for(c=0;c<h.revisions.length;c++)if(n=h.revisions[c],void 0!==Mb[n.type]&&F.hiddenContent("tracked-changes"),n.cells)for(t=0;t<n.cells.length;t++)if(A=n.cells[t],A.text)for(k=0;k<A.text.length;k++)g=Db(g,A.text[k].range);g?ja.loadRawText(g.acc,g.accend,function(){d.each("processSSRevisions");ia()}):(d.each("processSSRevisions"),ia())}b.revisions&&d.each("processRevisions");H();ia();void 0!==f&&a.length>f&&d.on.add.dispatch(f)});Z.onadd(function(){d.updateActivePage()});
F.onscrollupdate(d.updateActivePage);F.onload(function(){B();O();d.updateShowSlideNotes()});Va.onendscroll(d.updateActivePage);P.onselectionchanged(function(a,b){if(x.showAnnotations){var c=d.activeAnnotationPane();if(a){var e=d.nearestForRange(a);e&&e.annotationPane()&&(c=e.annotationPane())}c&&b&&c.activate(a,!1,!1)}});d.onoverlayshow(function(a){r&&r.showTab(a.index)});d.onoverlayhide(function(a){r&&r.hideTab(a.index);!b||b.isEnabled()&&!b.overlay.isHidden()||(a=S(b.index),d.moveto(a))})}}),M=
ta.extend("highlights",{exports:"activate active add addMultiple addNote addStamp apply autoHighlight autoHighlightOptions clear comment current deactivate defineStamp first getJSON hide hideComment isHidden label last moveto movetoNext movetoPrev next prev properties property range redact remove serialize setOptions show showComment style type validateStyles".split(" "),events:{activate:{pub:!0,detail:function(d,e,a){return{highlightid:d?d.id:void 0,before:e,after:a}}},add:{pub:!0,detail:function(d){return{highlightid:d.id}}},
remove:{pub:!0,detail:function(d){return{highlightid:d.id}}},move:{pub:!0,detail:function(d){return{highlightid:d.id}}},comment:{pub:!0,detail:function(d){return{highlightid:d.id}}},mode:{pub:!0,detail:function(d){return{autohighlight:d,autooptions:M.autoHighlightOptions(),selectionmode:F.selectionMode()}}}},userEventDef:{pub:!0,detail:function(d,e,a){return{highlightid:a.id,srcEvent:e}}},install:function(d){var e={},a=function(a){var b=a.toLowerCase();e[a]={w:"border"+a+"Width",c:"border"+a+"Color",
wp:"border-"+b+"-width",cp:"border-"+b+"-color",sp:"border-"+b+"-style"}};a("Top");a("Right");a("Bottom");a("Left");var c=0,b=[],f=0,k=0,v,l,r,m,p=-1,z=-1,q,G,V=!1,T=!1,J,N=!1,E=!1,h,u={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0},g=!0,t=[],A=!1,U={x:0,y:0},S=[];d.add=function(){var a=arguments,b=1,c={};ga(0,a,c,"add");c.invalid||(b=ba(b,a,c,"add"));c.invalid||(Array.isArray(c.range)?c.type=
"hl-"+c.range[0].type:Pa(c.range)||Xa(c.range)?c.type="hl-text":c.type="hl-"+c.range.type,ka(0,a,c,"add"));c.invalid||(b=ja(b,a,c,"properties","add"),b=ra(b,a,c,"comment","add"));c.invalid||sa(b,a,c,"add");if(!c.invalid)return oa(c)};d.addMultiple=function(a,b,c,e){var g=arguments,f=1,h={},n,t;ga(0,g,h,"addMultiple");if(!h.invalid){if(Array.isArray(b)){for(t=0;t<b.length;t++){if(!wa(b[t])){h.invalid=!0;break}if(n&&n!=b[t].type){h.invalid=!0;break}n=b[t].type}f++}else h.invalid=!0;n||(h.invalid=!0);
h.invalid&&d.invalidArg("addMultiple","rangeList",null,"Must be an array of ranges")}h.invalid||(h.type="hl-"+n.type,ka(0,g,h,"addMultiple"));h.invalid||ja(f,g,h,"properties","addMultiple");if(!h.invalid){g=[];d.beginBatch();for(t=0;t<b.length;t++)h.range=wa(b[t]),f=oa(h),g.push(f),e&&d.setOptions(f,e);d.endBatch();return g}};d.addNote=function(){var a=arguments,b=1,c={type:"note"};ga(0,a,c,"addNote");c.invalid||(b=ba(b,a,c,"addNote"));c.invalid||("cell"!==c.range.type&&"rect"!==c.range.type&&(d.invalidArg("addNote",
"range",c.range,"Anchored notes may only be added to rect or cell ranges"),c.invalid=!0),ka(0,a,c,"addNote"));c.invalid||(b=ja(b,a,c,"properties","addNote"),b=ra(b,a,c,"comment","addNote"));c.invalid||sa(b,a,c,"addNote");if(!c.invalid)return oa(c)};d.redact=function(){var a,c=arguments,d={type:"redaction"};a=ba(0,c,d,"redact");d.invalid||(a=ja(a,c,d,"properties","redact"),a=ra(a,c,d,"label","redact"));d.invalid||sa(a,c,d,"redact");if(!d.invalid){if("compound"===x.redactionMode||"hybrid"===x.redactionMode&&
"cell"===d.range.type)d.compound=!0;a:{a=d;c=!1;a.range.embedId?c=!1:"hybrid"===x.redactionMode?c="rect"===a.range.type:"simple"===x.redactionMode&&(c="rect"===a.range.type||"cell"===a.range.type);if(c){var e=B.decomposeRange(a.range);if(e){var d=[],g=a.range,f=B.page(g.page),h=D.rangeRect(g,f),n=a.activate;a.activate=!1;for(c=0;c<e.length;c++){a.range=e[c];var t=Ra(a);-1==d.indexOf(t)&&d.push(t)}if("drawing"===f.type||"slide"===f.type||"chart"===f.type){e=0===d.length;if(!e)for(c=0;c<d.length;c++)if(t=
b[d[c]].range,"rect"!==t.type){e=!0;break}else if(t=D.rangeRect(t,f),!t||!t.equals(h)){e=!0;break}e&&(a.range=g,d.unshift(Ra(a)))}if(0<d.length){n&&L(d[0]);1==d.length&&(d=d[0]);a=d;break a}}}a=oa(a)}return a}};d.apply=function(a,b){if(!Array.isArray(a)){try{a=JSON.parse(a)}catch(Uc){d.invalidArg("apply","highlights",a,"Error parsing JSON string: "+Uc.message);return}a&&a.range&&"object"==typeof a.range&&(a=[a])}if(Array.isArray(a))if(w.documentLoaded){b=Na(b)?b:null;for(var c=0;c<a.length;c++){var e=
a[c];if("sdef"==e.type)d.defineStamp(e.stamp,e.url);else{var g=aa();if(!b||b(g,e.properties))if(wa(e.range))if(g=[],"stamp"==e.type){var f={name:e.stamp};e.opacity&&(f.opacity=e.opacity);e.sizing&&(f.sizing=e.sizing);g.push(f);g.push(e.range);e.hasOwnProperty("properties")&&g.push(e.properties);e.hasOwnProperty("comment")&&g.push(e.comment);d.addStamp.apply(void 0,g)}else oa(e);else d.invalidArg("apply","highlight["+c+"]",e)}}}else v=v?a.concat(v):a};d.remove=function(a,b){if(Array.isArray(a)){d.beginBatch();
for(var c=0;c<a.length;c++)d.remove(a[c]);d.endBatch()}else(c=ua(a,q,"remove"))&&W(c,b)};var W=function(a,c){var e=a.id;void 0===c&&(c=!0);d.on.remove.dispatch(a);var g,h=!1,n=!1;e==q?(L(void 0,!1,!1,c),q=void 0,void 0!=a.prevId?(g=a.prevId,n=!0):void 0!=a.nextId&&(g=a.nextId,h=!0)):c=!1;d.hideComment(e);d.unmap(a);a.destroy();b[e]=null;f--;e<k&&(k=e);void 0!==g&&L(g,h,n,c,!1,!1)};d.removeFromRange=function(a){Array.isArray(a)?pa(a,d.removeFromRange):"text"===a.type&&d.each(qa,null,a)};var qa=function(a,
b){var c=a.range;"text"===c.type&&c.accend>=b.acc&&c.acc<=b.accend&&d.remove(a.id,!1)};d.count=function(){return f};d.clear=function(a){a=Na(a)?a:null;d.each(W,a,!1);a||(q=void 0,b=[],k=f=0,S=[])};a=function(){var a=x.highlightLabelFontFamily,b=x.highlightLabelFontSize,c="";a&&(c+="font-family:"+a+";");b&&(c+="font-size:"+b+";");F.screenCSS(".oit-highlight-label",c);d.each("showLabel",null,x.showHighlightLabels)};d.setOptions=function(a,b){b&&X(a,q,"setOptions",null,[b])};d.getOption=function(a,b){return X(a,
q,"getOption",null,[b])};d.style=function(a,b){var c,e=ua(a,q,"style");if(e)if(b){var g=ea(b,"hl-text"!=e.type);g?c=e.style(g):d.invalidArg("style","style",b)}else c=e.style();return c};d.comment=function(a,b,c){if(a=ua(a,q,"comment")){var e=a.comment();void 0!==b&&b!==e&&(c||a.id!==d.active()||a.isNote()?e=a.comment(b):(d.hideComment(),e=a.comment(b),d.showComment()),d.on.comment.dispatch(a));return e}};var ia=function(a){if("scale"==a||"stretch"==a||"image"==a)return a},O=function(a){if(a&&!isNaN(a)&&
(a=Number(a),0<=a&&1>=a))return a},H=function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y))return{x:Math.round(a.x),y:Math.round(a.y)}},n=function(a){a.img=new Image;a.img.src=a.url;a.img.onload=function(){a.height=this.height;a.width=this.width;a.defaultSize&&(this.style.width=a.defaultSize.x,this.style.height=a.defaultSize.y);delete a.img}};d.stamp=function(a){if(m)return m[a]};d.label=function(a,b){return X(a,q,"label",null,[b])};d.defineStamp=function(a,b,c){m||(m={});b?(c=c||{},b={url:b},c.sizing&&(b.sizing=
ia(c.sizing)),c.opacity&&(b.opacity=O(c.opacity)),c.defaultSize&&(b.defaultSize=H(c.defaultSize)),m[a]=b,n(m[a])):delete m[a]};var C=function(a){var b;if(a){var c;if(a instanceof String||"string"==typeof a)c={name:a};else{c={};for(var d in a)c[d]=a[d]}c.name&&m&&m[c.name]&&(c.type="stamp",c.stamp=m[c.name],b=c)}return b};d.addStamp=function(){var a,b=arguments,c=C(b[0]);if(c){c.sizing=ia(c.sizing)||c.stamp.sizing||"scale";c.opacity=O(c.opacity)||c.stamp.opacity||1;c.defaultSize=H(c.defaultSize)||
c.stamp.defaultSize;var e;e=ba(1,b,c,"addStamp");var g=c.range;g&&"rect"!=g.type&&"cell"!=g.type?(d.invalidArg("addStamp","range",g),c.invalid=!0):"rect"===g.type&&zb(g)?c.range=Ba(g.left,g.top,"rect",c):"cell"===g.type&&g.c1==g.c2&&g.r1==g.r2&&(c.range=Ba(g.c1,g.r1,"cell",c));c.invalid||(e=ja(e,b,c,"properties","addStamp"),e=ra(e,b,c,"comment","addStamp"));sa(e,b,c,"addStamp");c.invalid||(a=oa(c))}else d.invalidArg("addStamp","stamp",b[0],"Must be the name of a defined stamp");return a};d.getJSON=
function(a){if(a=ua(a,q,"getJSON"))return JSON.stringify(a.serialize())};d.serialize=function(a){var b=[],c,e;Na(a)?c=a:Array.isArray(a)?e=a:"number"===typeof a&&(e=[a]);d.each(I,c,b,{},e);return JSON.stringify(b,null,!1)};var I=function(a,b,c,d){d&&-1==d.indexOf(a.id)||(a=a.serialize(),a.stamp&&!c[a.stamp]&&(b.push({type:"sdef",stamp:a.stamp,url:m[a.stamp].url}),c[a.stamp]=!0),b.push(a))};d.properties=function(a,b){return X(a,q,"properties",null,[b])};d.property=function(a,b,c){return X(a,q,"property",
null,[b,c])};d.current=function(){return q};d.active=function(){if(!V&&!T)return q};d.moveto=function(a){(a=ua(a,q,"moveto"))&&L(a.id,!1,!1,!0,!0,!0);return q};d.movetoNext=function(a){if(void 0===q)void 0!==l&&d.moveto(l);else{var c=q;if(V&&b[c].filter(a)&&ma(c))return d.moveto(c);for(;;){c=b[c].nextId;if(void 0===c)break;var e=b[c];if(e.filter(a)&&(e=B.nearestForRange(e.range)))return e.isLoaded()?L(c):B.moveto(e.index,function(){d.movetoNext(a)}),c}}return q};d.movetoPrev=function(a){if(void 0===
q)void 0!==r&&d.moveto(r);else{var c=q;if(T&&b[c].filter(a)&&ma(c))return d.moveto(c);for(;;){c=b[c].prevId;if(void 0===c)break;var e=b[c];if(e.filter(a)&&(e=B.nearestForRange(e.range)))return e.isLoaded()?L(c):B.moveto(e.index,function(){d.movetoPrev(a)}),c}}return q};d.type=function(a){if(a=ua(a,q,"type"))switch(a.type){case "note":case "redaction":case "stamp":return a.type;default:return"highlight"}};d.range=function(a){if(a=ua(a,q,"range"))return a.range};d.show=function(a){void 0===a||Na(a)?
d.each("show",a):X(a,q,"show")};d.hide=function(a){void 0===a||Na(a)?d.each("hide",a):X(a,q,"hide");d.alignHighlight()};d.isHidden=function(a){return X(a,q,"isHidden")};d.showComment=function(a,c){Array.isArray(a)&&(a=a[0]);var e=ua(a,q,"showComment");if(e){c=c||{};c.mode||(c.mode="view");var g=d.active();if(void 0!==g&&(g=b[g],g.isNote()&&g.isEditing()))return;if(e.isNote())switch(c.mode){case "view":e.show();e.endEditText(!0);break;case "edit":e.beginEditText(!1);break;case "new":e.beginEditText(!0)}else e.dialog(c.mode)}};
d.hideComment=function(a){(a=ua(a,q,"hideComment"))&&(a.isNote()?a.collapse():a.hideDialog())};d.first=function(){return l};d.last=function(){return r};d.next=function(a){if(a=ua(a,q,"next"))return a.nextId};d.prev=function(a){if(a=ua(a,q,"prev"))return a.prevId};d.activate=function(a){(a=ua(a,q,"activate"))&&L(a.id)};d.deactivate=function(){L(void 0,!1,!1,!0)};var ca=function(a){if(a)for(var b in u)void 0!==a[b]&&(u[b]=a[b]);P.enableCellOffsets("note"===N||"stamp"===N);la();d.on.mode.dispatch(N)};
d.autoHighlightOptions=function(a){void 0!==a&&ca(a);a={};for(var b in u)a[b]=u[b];return a};d.autoHighlight=function(a,b){var c;if(!1===a){P.select(null);if(h){c=D.features();switch(h){case "text":c.textselection||(h=null);break;case "rect":c.rectselection||(h=null);break;case "cell":c.cellselection||(h=null);break;default:h=null}h&&(F.selectionMode(h),h=null)}N=!1;ca()}else if("selection"===a||"note"===a||"redaction"===a||"stamp"===a){b=b||{};u.comment=null;u.sticky=!1;u.properties=null;P.select(null);
if("stamp"===a){if(!C(b.stamp))return d.invalidArg("autoHighlight","options.stamp",b.stamp),N=!1}else if(("selection"===a||"note"===a)&&!ea(b.style,!0))return d.invalidArg("autoHighlight","options.style",b.style),N=!1;N=a;h||(h=F.selectionMode());if("note"===a||"redaction"===a||"stamp"===a)c=D.features(),c.rectselection||"redaction"===a&&c.rectredaction?F.selectionMode("rect"):c.cellselection&&F.selectionMode("cell");ca(b)}return N};d.pauseAutoHighlight=function(a){E=!!a};d.beginBatch=function(){c++};
d.endBatch=function(){0<c&&c--};d.batchMode=function(){return 0<c};var la=function(){if("selection"===N||"note"===N)P.style(u.style,!1);else if("redaction"===N){var a;x.redactionFillColor&&"compound"===x.redactionMode&&"rect"===F.selectionMode()?a=x.redactionFillColor:(a=ya(x.redactionColor),.7<a.a&&(a.a=.7),a=Ha(a.r,a.g,a.b,a.a));P.style("background-color:"+a+";",!1)}else if("stamp"===N)if(m&&(a=m[u.stamp]),a){var b="background:url("+a.url+") no-repeat";"number"===typeof a.opacity&&1!=a.opacity&&
(b+=";opacity:"+a.opacity);"scale"==a.sizing?b+=";background-size:contain":"stretch"==a.sizing&&(b+=";background-size:100% 100%");P.style(b)}else P.style(null);else P.style(null)},Ba=function(a,b,c,d){var e,g;d&&(d.defaultSize&&(e=d.defaultSize.x,g=d.defaultSize.y),e||(e=d.width),g||(g=d.height));e||(e=200);g||(g=200);a=B.mapToPage(a,b);d&&(a.x-=Math.floor(e/2),a.y-=Math.floor(g/2));return D.rangeFromRect(a.page.index,a.x,a.y,a.x+e,a.y+g,a.page,"move")},ma=function(a){return"slideshow"!=x.presentationMode?
!0:(a=wa(b[a].range))&&B.nearestForRange(a)?!0:!1};d.startSelection=function(){G=d.active();L(void 0,!1,!1,!1)};d.endSelection=function(){G=void 0};F.onselect(function(a,c,e,g,f){var h=!0;if(a&&N&&!E){var n=a,t="note"===N,k="stamp"===N;if(t&&!D.features().anchorednotes||(t||k)&&"text"===n.type&&!g)return!0;a=t||!0===u.comment;if(g)if((t||k)&&e&&void 0===G){var A;k&&((c=C(u.stamp))?A=c.stamp:n=null);n&&(c=D.features(),n=c.rectselection?Ba(e.x,e.y,"rect",A):c.cellselection?Ba(e.x,e.y,"cell",A):null);
n||P.select(null)}else P.select(null),n=null;else t&&c&&e&&"rect"===n.type&&(A=n.bottom-n.top,100>n.right-n.left&&(c.x<e.x?n.right=n.left+100:n.left=n.right-100),80>A&&(c.y<e.y?n.bottom=n.top+80:n.top=n.bottom-80));if(n&&void 0===f){var q;"text"===n.type&&(n=Y.getSelection());"redaction"===N?q=d.redact(n,u.properties,u.label):k?!C(u.stamp)||"rect"!==n.type&&"cell"!==n.type?P.select(null):q=d.addStamp(u.stamp,n,u.properties):t?"rect"===n.type||"cell"===n.type?q=d.addNote(u.style,n,u.properties):P.select(null):
q=d.add(u.style,n,u.properties);if(void 0!==q){e=Array.isArray(q)?q:[q];f="string"===typeof u.comment?u.comment:void 0;for(h=0;h<e.length;h++)q=b[e[h]],q.setOptions(u),f&&q.comment(f);P.select(null);d.activate(e[0]);a&&d.showComment(e,{mode:"new"});h=!1;u.sticky||d.autoHighlight(!1)}}}return h});d.alignComment=function(){d.each("alignDialog")};D.ondisplayload(function(a,b){p=a.index;z=b.index;d.each("addToPage",null,p);z>p&&M(p+1,z)});D.ondisplayunload(function(a,b){d.each("destroyDialog");z=p=-1});
B.onpageload(function(a){-1!=z&&a.index>z&&(z=B.activeOverlay().lastPage.index);0<b.length&&a.index>=p&&a.index<=z&&d.each("addToPage",null,a.index)});B.onpageunload(function(a){a.index>=p&&a.index<=z&&(d.each("removeFromPage",null,a.index),a.highlightLayer=void 0)});d.onEmailHeaderResize=function(a){d.each("addToPage",null,a);d.positionAll(B.activeOverlay())};d.alignHighlight=function(){void 0==q||V||T||L(q,!1,!1,!1,!1,!0)};d.move=function(a,b,c,d,e,g){var f;b=b||0;d=d||0;c=c||0;e=e||0;g=g||!1;if((a=
ua(a))&&(b||d||c||e)&&a.getOption("enableUserMove")){var h=da(a.range);if("rect"===h.type){g=g?1:10;var n=D.pageRange(h.page,h.type);h.left+=b*g;h.top+=c*g;h.right+=d*g;h.bottom+=e*g;g=h.right-h.left;f=h.bottom-h.top;b&&(0>h.left?(h.left=0,d&&(h.right=g)):h.left>=h.right&&(h.left=h.right-1));d&&(h.right<=h.left?h.right=h.left+1:h.right>n.right&&(h.right=n.right,b&&(h.left=h.right-g,0>h.left&&(h.left=0))));c&&(0>h.top?(h.top=0,e&&(h.bottom=h.top+f)):h.top>=h.bottom&&(h.top=h.bottom-1));e&&(h.bottom<=
h.top?h.bottom=h.top+1:h.bottom>n.bottom&&(h.bottom=n.bottom,c&&(h.top=h.bottom-f,0>h.top&&(h.top=0))))}else"cell"===h.type&&(n=D.pageRange(h.page,h.type),h.c1+=b,h.r1+=c,h.c2+=d,h.r2+=e,g=h.c2-h.c1,f=h.r2-h.r1,b&&(h.c1<n.c1?(h.c1=n.c1,d&&(h.c2=h.c1+g)):h.c1>h.c2&&(h.c1=h.c2)),d&&(h.c2<h.c1?h.c2=h.c1:h.c2>n.c2&&(h.c2=n.c2,b&&(h.c1=h.c2-g,h.c1<n.c1&&(h.c1=n.c1)))),c&&(h.r1<n.r1?(h.r1=n.r1,e&&(h.r2=h.r1+f)):h.r1>h.r2&&(h.r1=h.r2)),e&&(h.r2<h.r1?h.r2=h.r1:h.r2>n.r2&&(h.r2=n.r2,c&&(h.r1=h.r2-f,h.r1<n.r1&&
(h.r1=n.r1)))));a.setRange(h)}};var ea=function(a,b){if(!g)return a;var c;if("string"==typeof a){c=[];var d=pb(a,"color");d&&c.push("color:",d,";");(d=pb(a,"background-color"))&&c.push("background-color:",d,";");if(!b)(d=pb(a,"text-decoration"))&&c.push("text-decoration:",d,";");else if(b&&-1!=a.indexOf("border")){d=y.create("div");d.attr("style",a);d.css("display","none");y.body.append(d);var e=d.computedStyle(d),f=Qa(e,"Top"),h=Qa(e,"Left"),n=Qa(e,"Bottom"),t=Qa(e,"Right");f.w&&f.w==n.w&&f.w==h.w&&
f.w==t.w&&f.c==n.c&&f.c==h.c&&f.c==t.c?c.push("border:",f.w," solid ",f.c,";"):(na(e,f,c),na(e,h,c),na(e,n,c),na(e,t,c));d.destroy()}c=0===c.length?void 0:c.join("")}return c},Qa=function(a,b){b=e[b];return{e:b,w:a[b.w],c:a[b.c]}},na=function(a,b,c){b.w&&c.push(b.e.wp,",",b.w,";",b.e.sp,":solid;",b.e.cp,":",b.c,";")};d.map=function(a){if("text"===a.range.type){var b=S[a.range.acc];void 0!==b?b instanceof Array?b.push(a.id):S[a.range.acc]=[b,a.id]:S[a.range.acc]=a.id}};d.unmap=function(a){if("text"===
a.range.type){var b=S[a.range.acc];void 0!==b&&(b instanceof Array?1==b.length&&b[0]==a.id?delete S[a.range.acc]:Da(b,a.id):b===a.id&&delete S[a.range.acc])}};var oa=function(a){var b,c,d,e,g;if(Array.isArray(a.range)){g=a.range;a.compound=g;e=g[0].acc;c=g[0].accend;for(b=1;b<g.length;b++)d=g[b],d.acc<e&&(e=d.acc),d.accend>c&&(c=d.accend);a.range=fa(e,c)}else if(Pa(a.range)||Xa(a.range)){g=yb(a.range);if(!g)return;if(!Array.isArray(g))return a.range=g,oa(a);a.compound=g;e=g[0].acc;c=g[0].accend;for(b=
1;b<g.length;b++)d=g[b],d.acc<e&&(e=d.acc),d.accend>c&&(c=d.accend);a.range=fa(e,c)}if("text"===a.range.type){if((g=B.pagesForRange(a.range))&&2<=g.length){d=a.range;e=[];var f,h;for(b=0;b<g.length;b++)c=g[b],c.overlay!=h?(f=fa(c.acc,c.accend),e.push(f),h=c.overlay):(c.acc<f.acc&&(f.acc=c.acc),c.accend>f.accend&&(f.accend=c.accend));if(1<e.length){f=[];for(b=0;b<e.length;b++)a.range=e[b],a.range.acc<d.acc&&(a.range.acc=d.acc),a.range.accend>d.accend&&(a.range.accend=d.accend),h=Ra(a),-1==f.indexOf(h)&&
f.push(h);return 0===f.length?void 0:1==f.length?f[0]:f}}}else if("rect"===a.range.type&&(c=B.page(a.range.page))&&c.isEmailHeader())return;return Ra(a)},Ra=function(a){var c;if("text"===a.range.type){var e,g=a.properties,h=a.comment,n=a.label;null===g&&(g=void 0);null===h&&(h=void 0);null===n&&(n=void 0);var k=S[a.range.acc];if(void 0!==k)if(k instanceof Array)for(var A=0;A<k.length;A++){if(e=b[k[A]],e.matches(a.style,a.range,g,h,n)){c=e;break}}else e=b[k],e.matches(a.style,a.range,g,h,n)&&(c=e)}else c=
void 0;if(!c){"text"===P.selectionType()&&P.select(null);e="rect"===a.range.type||"cell"===a.range.type;g=aa();switch(a.type){case "redaction":c=new Vc(g,a);break;case "note":e&&(c=new Wc(g,a));break;case "stamp":e&&(c=new Xc(g,a));break;default:c=new fb(g,a)}if(!c)return;b[g]=c;f++;if(d.batchMode())t.push({highlight:c}),K();else if(e=c,e.addToDocument(),(g=ha.infoRaw())&&1557===g.fi&&"text"==e.range.type)for(g=B.count(),h=0;h<g;h++)(n=B.page(h))&&!n.isLoaded()&&n.containsRange(e.range)&&Q(h,!0,e);
d.link(c)}d.on.add.dispatch(c);!0===a.activate?L(c.id):U&&(d.activateNearest(U.x,U.y,null,!1),U=null);return c.id},K=function(){A||(A=!0,F.onidle(R))},M=function(a,c){if(0!==b.length&&!d.batchMode())for(var e=a;e<=c;e++){var g=B.page(e);g&&g.isLoaded()&&(t.push({pageIndex:e,loadPage:!1}),K())}},Q=function(a,b,c){t.push({pageIndex:a,loadPage:!!b,highlight:c});K()},R=function(){if(!d.batchMode()){D.suspendUpdate();for(var a=0;20>a&&0<t.length;a++){var c=t.shift();if(void 0!==c.pageIndex){var e=B.page(c.pageIndex);
if(e.isLoaded())if(void 0===c.highlight){if(e&&e.isLoaded())for(var g=0;g<b.length;g++){var f=b[g];f&&e.containsRange(f.range)&&Q(c.pageIndex,!1,f)}}else c.highlight.addToPage(c.pageIndex);else if(!0===c.loadPage){var h=c;e.load(!1,function(){t.unshift(h);K()})}}else void 0!==c.highlight&&c.highlight.addToDocument()}0===t.length&&A&&(A=!1,F.offidle(R));D.resumeUpdate()}};d.findNearest=function(a,c){if(void 0!==l){var d=B.mapToPage(a,c,null,!0,!0);if(d){var e=d.page;a=d.x;c=d.y;for(var g,f,h,n=0;n<
b.length;n++){var t=b[n];if(t&&!t.isHidden()&&t.isOnPage(e.index)){var k=t.distanceFromPoint(e.index,a,c,d.inAnnotation);void 0!==k&&(0===k.x&&0===k.y?(g||(g=[]),g.push(t),f=k):!g&&(void 0===f||k.ay<f.ay||k.ay==f.ay&&k.ax<f.ax)&&(f=k,h=t))}}if(g)return{highlights:g,distance:f};if(h)return{highlights:[h],distance:f}}}};d.activateNearest=function(a,c,e,g){var f=q,h=T,n=V;!1!==g&&(g=!0);if(void 0===l)U&&(U.x=a,U.y=c);else{var t=d.findNearest(a,c);if(t)if(f=void 0,n=h=!1,1<t.highlights.length){var k=
d.active();if(void 0!==k)for(var A=0;A<t.highlights.length;A++)if(t.highlights[A].id==k){++A>=t.highlights.length&&(A=0);f=t.highlights[A].id;break}void 0===f&&(f=t.highlights[0].id)}else f=t.highlights[0].id,h=t.distance,n=0>h.y||0===h.y&&0>h.x,h=0<h.y||0===h.y&&0<h.x;else{if(t=B.mapToPage(a,c,null,!0,!0))for(A=t.page,f=l;void 0!==f;f=b[f].nextId)if((t=B.forRange(b[f].range))&&t.index>=A.index){k=t;break}k||(f=r,k=B.forRange(b[f].range));k.index<A.index?h=!0:n=!0}}if(f!=q||h!=T||n!=V)!1!==g||n||
h?e||n||h||(n=!0):n=!0,L(f,n,h,!0,!1);return q};var L=function(a,c,e,g,f,h){var n;if(!J&&(a=(n=ua(a))?n.id:void 0,!0!==c&&(c=!1),!0!==e&&(e=!1),!1!==f&&(f=!0),(n=a!=q||c!=V||e!=T)&&(h=!1),n||h)){if(!h){if(n=b[q])n.hideDialog(),n.deactivate();n=q;q=a;void 0!==n&&b[n]&&b[n].isEmptyRedaction()&&d.remove(n,!0);V=c;T=e}if(void 0!==q&&!c&&!e&&b[q]){n=b[q];if(f){B.moveto(n.range,function(){L(a,c,e,g,!1,!0)});return}if(n.isNote())P.select(null);else{J=n;P.select(n.range,n.id);f=hb(n.style());var t;f.color&&
(t="color:"+f.color+";background-color: rgba(255,255,255,0);");P.hide(t);J=null}w.viewNode.focus();n.activate(h);n.comment()&&!n.isNote()&&d.showComment(n.id,{mode:"view"})}!1!==g&&(n=ua(q),d.on.activate.dispatch(n,V,T))}},X=function(a,b,c,d,e){d=d||c;if(a=ua(a,b,c))return"string"==typeof d?a[d].apply(a,e):d.apply(null,e)},ua=function(a,c,e){var g;void 0===a&&(a=c);"number"===typeof a&&b[a]?g=b[a]:e&&d.invalidArg(e,"id",a);return g};d.link=function(a){var c=a.id;d.unlink(a);var e=a.generateKey();
if(e)if(void 0===l)r=l=c;else for(var g=l;;){var f=b[g],h=f.key,n=!1;e.page<h.page?n=!0:e.page==h.page&&(e.y<h.y?n=!0:e.y==h.y&&(e.x<h.x?n=!0:e.x==h.x&&c<g&&(n=!0)));if(n){g===l?l=c:(a.prevId=f.prevId,b[a.prevId].nextId=c);a.nextId=g;f.prevId=c;break}if(g===r){a.prevId=g;r=f.nextId=c;break}g=f.nextId}};d.unlink=function(a){if(void 0!==a.prevId||void 0!==a.nextId||l==a.id){var c=void 0!==a.prevId?b[a.prevId]:null,d=void 0!==a.nextId?b[a.nextId]:null;c?c.nextId=a.nextId:l=a.nextId;a.nextId=void 0;d?
d.prevId=a.prevId:r=a.prevId;a.prevId=void 0}};d.positionAll=function(a){d.each("positionAll",a);d.alignHighlight()};d.validateStyles=function(a){void 0!==a&&(g=!1!==a);return g};d.updateHighlights=function(){M(p,z);d.positionAll(B.activeOverlay())};var aa=function(){for(;k<b.length&&b[k];)k++;k>=b.length&&(k=b.length,b.push(null));return k};d.each=function(a,c){wb(b,arguments)};var ba=function(a,b,c,e){if(a<b.length){b=b[a];if(Array.isArray(b)){c.range=b;for(var g=0;g<b.length;g++)wa(b[g])||(c.range=
null)}else Pa(b)||Xa(b)?c.range=b:c.range=wa(b);c.range&&a++}c.range||("text"===F.selectionType()&&(c.range=Y.getSelection(),c.range&&c.range.isCollapsed&&(c.range=void 0)),c.range||(c.range=F.selection()),c.range?c.activate=!0:(d.invalidArg(e,"range",null,"A range was not specified and nothing is currently selected"),c.invalid=!0));return a},ga=function(a,b,c,e){if(1>b.length||"string"!==typeof b[0])d.invalidArg(e,"style",null,"A highlight style must be specified"),c.invalid=!0},ka=function(a,b,
c,e){var g;a<b.length&&"string"===typeof b[a]&&(g=b[a]);c.style=ea(g,"hl-text"!=c.type);c.style?a++:(d.invalidArg(e,"style",g),c.invalid=!0);return a},ja=function(a,b,c,d,e){a<b.length&&(b=b[a],b instanceof Object||"object"==typeof b?(c[d]=b,a++):null!==b&&void 0!==b||a++);return a},ra=function(a,b,c,d,e){a<b.length&&(b=b[a],b instanceof String||"string"==typeof b?(c[d]=b,a++):null!==b&&void 0!==b||a++);return a},sa=function(a,b,c,e){for(;a<b.length&&void 0===b[a];)a++;a<b.length&&(d.invalidArg(e,
null,null,"Unexpected argument(s)"),c.invalid=!0);return a},ta=function(){d.each("updateStyle","isRedaction");la()};x.onredactionColor(ta);x.onredactionFillColor(ta);x.onnochrome(function(){d.positionAll(B.activeOverlay())});x.onshowSlideNotes(d.updateHighlights);x.onshowHighlightLabels(function(a){d.each("showLabel",null,a)});x.onhighlightLabelFontFamily(a);x.onhighlightLabelFontSize(a);x.onhighlightActivationBoxColor(function(a){if(null===a)F.screenCSS(".oit-highlight-active .oit-activation","display:none;"),
F.screenCSS(".oit-highlight-embed","display:none;"),F.screenCSS(".oit-highlight-active .oit-resize div","display:none;"),F.screenCSS(".oit-text-handle div:nth-child(2)","display:none;"),F.screenCSS(".oit-text-handle div:first-child","display:none;"),F.screenCSS(".oit-text-handle",null);else if(a=ya(a)){var b="rgb("+a.r+","+a.g+","+a.b+")",c="border:2px solid "+b+";opacity:"+a.a+";";F.screenCSS(".oit-highlight-active .oit-activation",c);c="border:1px solid "+b+";opacity:"+a.a+";";F.screenCSS(".oit-highlight-embed",
c);c="background-color:"+b+";";F.screenCSS(".oit-highlight-active .oit-resize div",c);F.screenCSS(".oit-text-handle div:nth-child(2)",c);F.screenCSS(".oit-text-handle div:first-child","border-bottom: 7px solid "+b+";");c="opacity:"+a.a+";";F.screenCSS(".oit-text-handle",c)}});a=function(a,b,c){a="tap"===b.type?w.viewNode.touchPos(b):w.viewNode.mousePos(b);d.activateNearest(a.x,a.y,b,!0);return void 0!==d.active()?!1:!0};d.on.click.setDefaultListener(a);d.on.tap.setDefaultListener(a);F.onscroll(function(){d.alignComment()});
F.onreset(function(){d.on.removeAllElements();d.clear();c=0;b=[];k=f=0;m=r=l=v=void 0;z=p=-1;G=q=void 0;T=V=!1;J=void 0;E=N=!1;h=void 0;u={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0};t=[];A&&(A=!1,F.offidle(R));U={x:0,y:0};S=[]});F.onload(function(){if(v){var a=v;v=null;d.apply(a)}});F.onzoom(function(a,b,c){d.positionAll(B.activeOverlay())});Z.ondata(function(a,b,c){a.highlights&&d.apply(a.highlights);
if(a.stamps)for(var e in a.stamps)m[e]=a.stamps[e]})}}),Dc=ta.extend("hyperlinks",{userEventDef:{pub:!0,detail:function(d,e,a){d={srcEvent:e,url:a.url};a.range&&(d.range=da(a.range));a.alt&&(d.alt=a.alt);d.external=0!==d.url.indexOf("#");return d}},install:function(d){var e,a,c={},b=0,f=!1,k=null,v=null,l,r=function(a,b,c){if(b){var e=c+10;e>b.length&&(e=b.length);for(;c<e;c++){var f=b[c],h=f.range;if(h)if("text"===h.type)G(a,f);else if("rect"==h.type&&h.page===a.index){if(!a.linkMap){var k=a.childByClass("oit-svg"),
g=k.byClass("oit-svg-text");if(g&&0<g.length){g=g[0];a.linkMap=y.create("div","oit-area-hyperlinks");a.linkMap.attr("style",g.attr("style"));if(g.classList)for(var t=0;t<g.classList.length;t++){var A=g.classList.item(t);"oit-svg-text"!==A&&a.linkMap.addClass(A)}k.append(a.linkMap)}}a.linkMap&&(h="left:"+h.left+"px;top:"+h.top+"px;width:"+(h.right-h.left)+"px;height:"+(h.bottom-h.top)+"px;",k=y.create("div"),k.attr("style",h),a.linkMap.append(k),d.on.addElement(k,f),h={anchorNode:k,page:a},f.anchors||
(f.anchors=[]),f.anchors.push(h))}}}return c},m=function(a,b,c){if(b){var d=c+10;d>b.length&&(d=b.length);for(;c<d;c++){var e=b[c],f=e.range;if(f&&"text"===f.type){var k=a.findRange(f.acc,f.accend);k&&pa(k,"addDataToRange",null,f,e)}}}return c},p=function(a,b,d){a=0;b&&(a=b.button||0);if(0!==a||!d.targetId)return!0;k=null;(b=c[d.targetId])?(d=y.byId(d.targetId)||b.range||b.page,void 0!==d&&B.movetoEx(d,{force:!0,moveToTop:!0}),f&&(Ga.hideMessage(),f=!1)):Z.isPending()?(f||(Ga.showMessage(OIT.local.PLEASE_WAIT_INITIALIZING),
f=!0),k=d,Z.on.add.listenOnce(function(){k&&p(null,null,k)})):f&&(Ga.hideMessage(),f=!1);return!1};d.on.click.setDefaultListener(p);d.on.tap.setDefaultListener(p);Z.ondata(function(d,f,k){var q;if(d.hyperlinks){e=e?e.concat(d.hyperlinks):d.hyperlinks;for(f=0;f<d.hyperlinks.length;f++)k=d.hyperlinks[f],k.type="hyperlink",k.id="oit-hl-"+ ++b,q=k.url,0===q.indexOf("#")&&(k.targetId=q.substring(1)+"."+y.expando,k.url="#"+k.targetId);k=B.count();for(q=0;q<k;q++)(f=B.page(q))&&f.isLoaded()&&!f.isHidden()&&
r(f,d.hyperlinks,0)}if(d.bookmarks){a=a?a.concat(d.bookmarks):d.bookmarks;for(f=0;f<d.bookmarks.length;f++)k=d.bookmarks[f],q=k.name,k.type="bookmark",k.id=q+"."+y.expando,c[k.id]||(c[k.id]=k);k=B.count();for(q=0;q<k;q++)(f=B.page(q))&&f.isLoaded()&&m(f,d.bookmarks,0)}});var z=function(){if(v){for(var b,c=0;c<v.length;c++){var d=v[c];if(d.page.isLoaded()){var f=!0;d.page.isHidden()?f=!1:(e&&(d.hindex=r(d.page,e,d.hindex),d.hindex<e.length&&(f=!1)),a&&(d.bindex=m(d.page,a,d.bindex),d.bindex<a.length&&
(f=!1)));f||(b||(b=[]),b.push(d))}}v=b}v||(l&&(Oa(l),l=void 0),F.offidle(z))},q=function(a,b,c){a.addDataToRange(b,c);"OIT.ihs(event)"==a.attr("onmouseover")&&a.attr("onmouseover",null);"OIT.ihs(event)"==a.attr("ontouchstart")&&a.attr("ontouchstart",null)},G=function(a,b){var c=b.range,d=a.findRange(c.acc,c.accend);d&&pa(d,q,null,c,b)};B.onpageload(function(a,b){v||(v=[]);if(-1==v.indexOf(a)&&(v.push({page:a,hindex:0,bindex:0}),1==v.length))if("rt"!=a.type&&"sn"!=a.type||l)l=qb(z,75);else F.onidle(z)});
B.onpageunload(function(a){if(e)for(var b=0;b<e.length;b++){var c=e[b];if(c.anchors)for(var f=c.anchors.length-1;0<=f;f--){var k=c.anchors[f];if(k.page===a){d.on.removeElement(k.anchorNode);1==c.anchors.length?c.anchors=void 0:c.anchors.splice(f,1);break}}}delete a.linkMap});F.onreset(function(){d.on.removeAllElements();a=e=void 0;c={};b=0;v=k=null;l&&(Oa(l),l=void 0)});nb("ihs",function(a){if(e)for(var b=yb(a.currentTarget),c,d=0;d<e.length;d++){var f=e[d];bb(b,f.range)&&(c||(c=B.forNode(a.currentTarget)),
c&&G(c,f))}})}}),rb=ta.extend("attachments",{exports:["describe","setOptions"],userEventDef:{pub:!0,detail:function(d,e,a){(d=rb.describe(a))?d.attachment=a:d={};d.srcEvent=e;return d},onListen:function(){rb.onListen()},onUnlisten:function(){rb.onUnlisten()},onAdd:function(){rb.onListen()},onRemove:function(){rb.onUnlisten()}},install:function(d){var e=[],a,c=0;d.item=function(a){return e[a]};d.describe=function(a){var b;0===arguments.length?b=ab(e):isNaN(a)||0<=a&&a<e.length&&(b=ab(e[a]));return b};
d.setOptions=function(b){b&&(a||(a=new Ab),b.hasOwnProperty("cursor")&&a.setRule(".oit-attachedFile {cursor:"+b.cursor+"}","cursor"),b.hasOwnProperty("color")&&a.setRule(".oit-attachedFile {color:"+b.color+"}","color"))};d.onListen=function(){0===c&&w.viewNode&&w.viewNode.addClass("oit-attachevents");c++};d.onUnlisten=function(){0<c&&0===--c&&w.viewNode&&w.viewNode.removeClass("oit-attachevents")};F.onload(function(){0<c?w.viewNode.addClass("oit-attachevents"):w.viewNode.removeClass("oit-attachevents")});
F.onreset(function(){e=[];a&&(a.destroy(),a=void 0)});Z.ondata(function(a,c,d){if(a.attachments)for(d=0;d<a.attachments.length;d++)c=a.attachments[d],c.id=e.length,e.push(c);if(a.pages)for(var b=0;b<a.pages.length;b++){var f=a.pages[b].attachments;if(f)for(d=0;d<f.length;d++)c=f[d],c.id=e.length,e[c.id]=c}})}}),Ec=ta.extend("archive",{userEventDef:{pub:!0,detail:function(d,e,a){return{nodeid:a,name:d.text(),srcEvent:e}}}}),xa=ta.extend("toolbars",{exports:["add","hide","remove","setSize","show"],
events:{add:{pub:!0,detail:function(d,e){return{id:d,edge:e}}},remove:{pub:!0,detail:function(d,e){return{id:d,edge:e}}},show:{pub:!0,detail:function(d,e,a,c){return{id:d,edge:e,width:a,height:c}}},hide:{pub:!0,detail:function(d,e){return{id:d,edge:e}}},resize:{pub:!0,detail:function(d,e,a,c){return{id:d,edge:e,width:a,height:c}}},resizeinternal:{}},install:function(d){var e=["left","top","right","bottom"],a=[],c,b,f=function(){jb(a,"refresh");ha.dispatchResize()};ha.onresize(f);B.onchange(function(){var a=
B.activeOverlay();a!=b&&(b=a,f())});d.add=function(b,f,k){var m;if(-1===e.indexOf(b))d.invalidArg("add","edge",b,"Must be one of "+JSON.stringify(MEMORY_MODELS));else if(y.isElement(f)){var p,z=!1,q=!1,l=!1,v;k&&(k.size&&((p="auto"===k.size?k.size:ub(k.size))||d.invalidArg("add","options.size",k.size,"Must be a valid CSS length or 'auto'")),!0===k.visible&&(z=!0),!0===k.overlay&&(q=!0),!0===k.resizable&&(l=!0),k.border&&(v=k.border));var r;c?(r=a[c],m=++c):m=c=1;k=w.viewNode;var J=k.scroll();f=new Nb(m,
b,y.wrap(f),v,r);q&&f.overlay(!0);l&&f.resizable(!0);a[m]=f;p&&f.setSize(p);k.scroll(J);d.on.add.dispatch(m,b);z&&d.show(m)}else d.invalidArg("add","elem",f,"Must be a valid DOM Element");return m};d.addInternal=function(b,c){a[b]=c};d.removeInternal=function(b){var c=a[b];c&&(c.remove(),delete a[b])};d.internalParent=function(b){var c,d;for(d in a)d=Number(d),d>b&&(void 0===c||d<c)&&(c=d);if(void 0!==c)return a[c]};d.remove=function(b){jb(a,k,b);f()};var k=function(b){var d=b.id;b.remove();for(a[d]=
void 0;!a[c];)if(0>=--c){c=void 0;break}return!0};d.setSize=function(b,c){b=Number(b);var e=a[b];e&&!e.isInternal()||d.invalidArg("setSize","id",b,"Must be a valid toolbar id returned by OIT.toolbars.add");var k="auto"===c?c:ub(c);k?e&&(e.setSize(k),f()):d.invalidArg("setSize","size",c,"Must be a valid CSS length or 'auto'")};d.show=function(b,c){jb(a,"show",b,c||{});f()};d.hide=function(b){jb(a,"hide",b);f()}}}),Eb,Ob,Fc;(function(){var d=null,e={},a=0;Eb=function(a,b,d,e,v,l){if(d&&"text"===b.type&&
b.accend>b.acc&&(v=a.findRange(b.acc,b.accend,v))&&0<v.length)return e={type:"style",id:e,priority:l||0},"string"===typeof d?e.className=d:e.props=d,!d.color&&v[0].hasClass("oit-tt")&&(l=v[0].computedStyle().color,l=ya(l),l.a=1,d.color=Ha(l)),pa(v,"addDataToRange",null,b,e),a.pageLayoutChanged(),v};OIUpdateStyle=function(a,b,d,e){d&&a&&0<a.length&&(b={type:"style",id:b,priority:e||0},"string"===typeof d?b.className=d:b.props=d,!d.color&&a[0].hasClass("oit-tt")&&(e=a[0].computedStyle().color,e=ya(e),
e.a=1,d.color=Ha(e)),pa(a,"changeData",null,b))};Ob=function(a,b){pa(a,"removeData",null,"style",b)};Fc=function(c){c=Xb(c,!0);var b=e[c];b||(b="oit-ss"+ ++a,e[c]=b,d||(d=new Ab),d.addCSSText("."+b+" {"+c+"}"));return b};F.onreset(function(){d&&(d.destroy(),d=null);e={};a=0})})();Fa.extend(["page","drawing","slide","chart"],{de:"page",showhidden:!1,cellselection:!1});Fa.extend("bitmap",{de:"page",showhidden:!1,textselection:!1,cellselection:!1,customtextselection:!1});Fa.extend("html",{de:"page",
rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1,elasticScroll:!1});Fa.extend("email",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});Fa.extend("rt",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});Fa.extend("sn",{de:"page",showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1});tb.extend("page",
{install:function(d){var e,a=1,c=null,b,f,k,v,l,r=w.isMobileOrTablet?10:20,m=!1,p,z=0,q=0,G;d.load=function(h){e=h.overlay;a=1;c=null;b=h.type;f=void 0;if(!w.isMobile&&void 0===w.singlePageIndex)F.onidle(g);V(h);B.onadd(d,T);B.onchange(d,t);P.onbeginselection(d,n);F.onscroll(d,C);if("email"===b)ha.onresize(d,A);x.onremoveExtraEmailHeaders(d,qa);x.onscrollMode(d,ia);x.onpresentationMode(d,O);x.onnochrome(d,H);x.onshowEmailAddresses(d,I);x.onshowAnnotations(d,ca);H(x.nochrome);u(h.index);ca();t()};
d.unload=function(){F.screenCSS(".oit-annopane",null);B.offadd(T);B.offchange(t);P.offbeginselection(n);F.offscroll(C);ha.offresize(A);x.offremoveExtraEmailHeaders(qa);x.offscrollMode(ia);x.offpresentationMode(O);x.offnochrome(H);x.offshowEmailAddresses(I);x.offshowAnnotations(ca);w.isMobile||F.offidle(g);f&&(f.destroy(),f=void 0);c&&c.hideStickyHeader();e=null;a=1;c=null;k=f=l=v=b=void 0;r=w.isMobileOrTablet?10:20};d.visiblePages=function(){var a=[];if("email"===b)e.each(function(b){a.push(b)});
else if("vertical"==x.scrollMode&&void 0===w.singlePageIndex){var c=B.count(),d,g,f,h=B.current();for(d=h-1;0<=d;d--)if((g=B.page(d))&&g.isEnabled()){if(g.overlay!=e)break;f=g.pageRect("view");if(0>=f.bottom)break;h=d}a.push(B.page(h));var n=w.viewNode.clientHeight-10;for(d=h+1;d<c;d++)if((g=B.page(d))&&g.isEnabled()){if(g.overlay!=e)break;f=g.pageRect("view");if(f.top>n)break;10<f.bottom&&a.push(g)}}else a.push(B.activePage());return a};d.saveScrollPos=function(){var a=B.page(d.visiblePages()[0]);
if(a){var b=a.pageRect("view");return{page:a,offset:b.top/b.height}}};d.restoreScrollPos=function(a){if(a&&a.page&&void 0!==a.offset){var b=a.page.pageRect("view");(a=b.top-a.offset*b.height)&&w.viewNode.dscroll(void 0,a)}};d.margin=function(){return{left:r,top:r,right:r,bottom:r}};var V=function(a){if(a._emailHeader){c=a._emailHeader;c.applyShowEmailAddresses();var b=a.overlay.firstPage,d=B.page(b.index+1);b&&b.load(!0,function(){d?d.load(!0,function(){d.parent()!=b.parent()&&b.parent().append(d);
A()}):A()})}};d.layoutChanged=function(b){if(e){var c=w.viewNode,d=x.zoom;b||(b={x:0,y:0});var g=c.scroll(),f=null,h=null,n;n=r/x.zoom;1!=d&&(f=["scale(",d,",",d,")"].join(""),h="left top");n=2*n+B.annotationPaneWidth();n="vertical"==x.scrollMode?n+e.maxWidth:n+B.activePage().width;e.css({transform:f,"transform-origin":h,"min-width":n+"px"});J();f=d/a;c.scroll((b.x+g.left)*f-b.x,(b.y+g.top)*f-b.y);a=d;t()}};var T=function(a){G||(G=ba(function(){G=void 0;J(!0);u()},500))},J=function(a){if(e){var c=
x.rotation,d={yOffset:0,maxWidth:0,height:0},g=B.top(),h=[],n=x.centerPages,t=r/x.zoom;if("email"===b)n=!1,h.push(".oit-emailbk{"),h.push("margin:",t,"px"),h.push("}"),h.push(".oit-email-stickyheader{"),h.push("left:",t,"px"),h.push("}");else if("html"===b||"rt"===b)n=!1;if(n){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");h.push("margin:",t,"px 0 ",t/2,"px 0");h.push("}");h.push(".oit-sn{");h.push("margin:0 0 ",2*t,"px 0");h.push("}");if(!x.nochrome&&0!==c){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");
switch(c){case 90:h.push("box-shadow:-1px 1px 5px 0 rgba(0,0,0,.25) !important");break;case 180:h.push("box-shadow:-1px -1px 5px 0 rgba(0,0,0,.25) !important");break;case 270:h.push("box-shadow:1px -1px 5px 0 rgba(0,0,0,.25) !important")}h.push("}")}h.push(".oit-page:last-of-type,.oit-bitmap:last-of-type,.oit-drawing:last-of-type,.oit-slide:last-of-type,.oit-chart:last-of-type,.oit-sn:last-of-type{margin-bottom:",t,"px;}")}"vertical"==x.scrollMode?e.each(N,null,h,c,n,t,d):N(B.activePage(),h,c,n,t,
d);0===d.maxWidth?e.css("width",null):(d.maxWidth+=r+r,e.css("width",d.maxWidth+"px"));0===d.height?e.css("height",null):(d.height+=r,e.css("height",d.height+"px"));h=h.join("");f||(f=new Ab);f.setCSSText(h);!g||k||a||"vertical"!=x.scrollMode||void 0!==w.singlePageIndex||(a=x.disableAnimation,x.disableAnimation=!0,B.moveto(g),x.disableAnimation=a);e.each(function(a){a.pageLayoutChanged();a.positionAnnotations()});M.positionAll(e)}},N=function(a,c,d,e,g,f){var h=0,n=0,t,k=w.viewNode.clientWidth,A=
B.annotationPaneWidth();a.resetCache();if("sn"==a.type)e&&(h=(k/x.zoom-(a.offsetWidth+A))/2,h<g&&(h=g)),n=f.yOffset;else{if("email"===b||"html"===b||"rt"===b)d=0;switch(d){case 0:e&&(h=(k/x.zoom-(a.offsetWidth+A))/2,h<g&&(h=g));break;case 90:e&&(n=(k/x.zoom-(a.offsetHeight+A))/2,n<g&&(n=g));h=-f.yOffset-a.offsetWidth;f.yOffset=f.yOffset-a.offsetHeight+a.offsetWidth;a.offsetHeight>f.maxWidth&&(f.maxWidth=a.offsetHeight);f.height+=a.offsetWidth+r;t="rotate(270deg) ";break;case 180:e&&(h=-((k/x.zoom-
(a.offsetWidth+A))/2),h>-g&&(h=-g));h-=a.offsetWidth;n=-a.offsetHeight;t="rotate(180deg) ";break;case 270:e&&(n=-((k/x.zoom-(a.offsetHeight+A))/2),n>-g&&(n=-g)),n-=a.offsetHeight,h=f.yOffset,f.yOffset=f.yOffset-a.offsetHeight+a.offsetWidth,a.offsetHeight>f.maxWidth&&(f.maxWidth=a.offsetHeight),f.height+=a.offsetWidth+r,t="rotate(90deg) "}}h=K(h);n=K(n);if(0!==h||0!==n||t){c.push("#",a.id.replace(/\./g,"\\."));c.push(" {");if(0!==h||0!==n||t)c.push(gb.transform,":"),t&&c.push(t),0===h&&0===n||c.push("translate(",
h,"px,",n,"px)"),c.push(";");c.push("}")}};d.moveto=function(a,d,e){var g=!1,f;e=e||{};if(cc(a))if(c)g=c.moveto(a,d,e);else{if("slide"==b&&(f=B.forRange(a))&&f.annotationPane()){var h=f.annotationPane().range();bb(h,a)&&f.annotationPane().activate(a,!0,!0,d,e)}}else"number"===typeof a&&(g=w.viewNode,f=B.page(a),u(f.index),(a=e.gotoNode)&&a!==f?a=B.elementRect(a,"overlay"):(a=f.pageRect("overlay").clone(),a.top-=r),f=g.scroll().top,a=f+(a.top-f),0>a&&(a=0),a!=f?(F.on.scrollupdate.disable(),g.abortAnimation(),
f=!1!==e.animate?150:0,k=!0,g.animate({scrollTop:a,time:f,endFn:E,args:[d,e]})):d&&d(e),g=!0);return g};var E=function(a,b,c){k=!1;F.on.scrollupdate.enable();F.on.scrollupdate.dispatch();b&&b(c)},h=function(a){"sn"!=a.type&&(l&&a.hiddenFromSlideshow?a.hide():a.show())},u=function(a){var c=!1;"vertical"===x.scrollMode&&void 0===w.singlePageIndex?w.viewNode.removeClass("oit-single"):w.viewNode.addClass("oit-single");if("vertical"==x.scrollMode&&void 0===w.singlePageIndex||"email"===b||"html"===b||"rt"===
b)void 0!==v&&(e.showPages(),v=void 0,c=!0,l=!1),a="slideshow"==x.presentationMode,a!=l&&(l=a,c=!0,e.each(h));else if(a=a||B.current(),a!=v){var d=B.page(a);if(d){var g;void 0===v?e.hidePages(d.index):(g=B.page(v),d.addClass("oit-noshadow"));d.show({insertLast:!0,animate:!0,endFn:function(){d.removeClass("oit-noshadow");g&&g.hide()}});v=a;c=!0;w.isMobileOrTablet&&e.css("min-height",d.height+r+r+"px")}}c&&(F.dispatchPageEvents(!0),M.positionAll(e))};d.pageRange=function(a,b){if("rect"===b){var c=B.page(a);
if(c)return c=c.pageRect(),lb(a,0,0,c.width,c.height)}};d.rangeRect=function(a,b,c,d){var e;if("text"===a.type){var g=B.forRange(a);g&&(e=g.textBoundingRect(a,d))}else"rect"===a.type&&(e=new ga(a),void 0!==a.embedId&&((d=B.page(a.page))&&(g=d.embeddingRect(a.embedId)),g?e.offset(g.left,g.top):e=void 0));e&&(e.origin=b);return e};d.rangeFromRect=function(a,b,c,d,e,g,f,h){var n;if(a=B.page(a))b=new ga(b,c,d,e,g),b.origin=a,c=void 0!==h?a.embeddingRect(h):a.pageRect(),"html"!==a.type&&"rt"!==a.type&&
"sn"!==a.type&&("move"===f?b.constrain(c):"select"!==f&&b.intersect(c)),void 0!==h?(b.offset(-c.left,-c.top),n=b.toRange(a),n.embedId=h,za(n,"pct")):n=b.toRange(a);return n};d.extendRange=function(a,b,c,e){var g=d.rangeRect(a,e);return d.rangeFromRect(a.page,g.left,g.top,b,c,e,"extend")};var g=function(a){if(!a)return B.loadNextPageFromServer()||F.offidle(g),!1},t=function(){if(!w.isMobile&&void 0===w.singlePageIndex)F.onidle(g);w.viewNode.scroll();for(var a=D.visiblePages(),b=0;b<a.length;b++){var c=
a[b];c&&c.isPending()&&c.load(!1)}},A=function(){e.each(W);c&&c.applyViewSize()},U=function(){if("email"===b){var a=w.viewNode.clientWidth-146;30>a&&(a=30);return a}},S=function(){if(this.hasClass("oit-ximage"))this.css("max-width",null),this.removeClass("oit-ximage"),this.addClass("oit-cimage");else if(this.hasClass("oit-cimage")){var a=U();this.css("max-width",""+a+"px");this.addClass("oit-ximage");this.removeClass("oit-cimage")}A();B.each("pageLayoutChanged")},W=function(a){if(a.hasClass("oit-rt")&&
a.isLoaded()){var b=U();if(b!==a.pageContentMaxWidth){a.pageContentMaxWidth=b;for(var c,d,e=0;;e++){var g=a.embeddingByIndex(e);if(!g)break;var f=y.byId(g.id);if(f&&(b&&(g.w>b?(f.hasClass("oit-cimage")||(f.css("max-width",""+b+"px"),f.addClass("oit-ximage")),f.onclick(S),f.ontap(S)):(f.css("max-width",null),f.removeClass("oit-ximage"),f.removeClass("oit-cimage"),f.offclick(S),f.offtap(S))),g=B.elementRect(f,a))){if(void 0===c||g.right>c)c=g.right;if(void 0===d||g.bottom>d)d=g.bottom}}void 0!==c&&
a.css("min-width",c+10+"px");void 0!==d&&a.css("min-height",d+10+"px");if(b&&(c=a.childByTagName("div"))&&(c=c.childrenByTagName("TABLE")))for(d=0;d<c.length;d++)c[d].css("max-width",""+b+"px");a.pageLayoutChanged()}}},qa=function(a){c&&a&&c.removeExtraEmailHeaders()},ia=function(){e&&(u(),w.viewNode.scroll(0,0),B.updateActivePage())},O=function(){e&&u()},H=function(a){e&&(r=a?0:w.isMobileOrTablet?10:20,u())},n=function(){c&&c.beginSelection()};d.startElasticScroll=function(){var a=x.scrollMode;"hswipe"!==
a&&"vswipe"!==a||!D.features().elasticScroll||(w.viewNode.css("overflow","hidden"),m=!0,q=z=0)};d.elasticScroll=function(a,b){if(m){var c=x.scrollMode,d="hswipe"===c,c="vswipe"===c,g=0,f=0;void 0!==a&&d&&(z=g=-a,e.css("left",g+"px"));void 0!==b&&c&&(q=f=-b,e.css("top",f+"px"));if(g||f){w.viewNode.cancelKinetic();var c=B.activePage(),h=c.annotationPane();h&&h.hide();var n;if(0<g||0<f)n=B.prev(B.current());else if(0>g||0>f)n=B.next(B.current());n&&n!==p&&(p&&(p.hide(),p.css({left:null,top:null,position:null}),
p=void 0),n.overlay==c.overlay&&(f=g=0,n.index<c.index?d?g=c.pos(e).left/x.zoom-r-n.width:f=c.pos(e).top/x.zoom-r-n.height:d?g=c.rect(e).right/x.zoom+r:f=c.rect(e).bottom/x.zoom+r,n.css({left:g+"px",top:f+"px",position:"absolute",transform:"none"}),n.show({animate:!1}),(h=n.annotationPane())&&h.hide(),p=n))}La()}};d.endElasticScroll=function(a,b){if(m){m=!1;w.viewNode.css("overflow",null);var c="hswipe"===x.scrollMode;w.viewNode.cancelKinetic();var d,g=B.activePage();c?(c=a/(g.width*x.zoom),d=a/w.viewNode.clientWidth):
(c=b/(g.height*x.zoom),d=b/w.viewNode.clientHeight);d=Math.max(c,d);var f=c=0,h=g;-.25>d?h=B.prev(g.index)||g:.25<d&&(h=B.next(g.index)||g);h!==g&&(c=(w.viewNode.clientWidth-h.width*x.zoom)/2,c<r&&(c=r),d=r,f=h.pos(w.viewNode),c=z+c-f.left,f=q+d-f.top);e.animate({offsetLeft:c,offsetTop:f,time:100,transition:h!==g?"ease-in":"ease-out",endFn:function(){p&&(p!==h&&p.hide(),p.css({left:null,top:null,transform:null}),p=void 0);e.css({left:null,top:null});h!==g&&(B.deactivateAnnotation(),w.viewNode.scroll(0,
0),B.movetoEx(h.index,{animate:!1}),M.each("addToPage",null,h.index));if(x.showAnnotations){var a=h.annotationPane();a&&a.show()}La()}});La()}};var C=function(){if(c)c.onScroll()},I=function(){c&&c.applyShowEmailAddresses()},ca=function(){var a=x.showAnnotations;if(a){var b=B.activePage();b&&!b.supportsAnnotationBar()&&F.screenCSS(".oit-annopane","width:338px !important;");B.scrollToAnnotationPane(M.updateHighlights)}else B.deactivateAnnotation(),F.screenCSS(".oit-annopane",null);e.each(function(b){(b=
b.annotationPane())&&(a?b.show():b.hide())});F.dispatchPageEvents()}}});Fa.extend(["worksheet","database"],{de:"ss",rotate:!1,textselection:!1,rectselection:!1,customtextselection:!1});tb.extend("ss",{install:function(d){var e,a,c,b,f=!1;d.load=function(f){e=f;b=c=a=null;if(a=f.spreadsheetModel())c=new Yc(a,e),(f=a.showHidden())?(f={columns:f.columns,rows:f.rows},d.showHidden(f)):c.showHidden(x.showHiddenColumns,x.showHiddenRows),c.doUpdate();x.onshowHiddenRows(d,k);x.onshowHiddenColumns(d,v);x.onshowAnnotations(d,
l);l()};d.unload=function(){x.offshowHiddenRows(k);x.offshowHiddenColumns(v);x.offshowAnnotations(l);b&&sa(b);c&&c.unload();b=c=a=null};d.maxPageWidth=function(){if(c)return c.maxPageWidth()};d.maxPageHeight=function(){if(c)return c.maxPageHeight()};d.padding=function(){if(c)return c.padding()};d.scrollOffset=function(){if(c)return c.scrollOffset()};d.getSelectedText=function(){return a?a.getSelectedText():""};d.select=function(b){return a?a.select(b):!1};d.keydown=function(b){var d=!0;if(c)switch(b.keyCode){case 33:w.viewNode.dscroll(0,
-(c.visibleHeight()+1));if(b=P.cellSelection())d=c.visibleRange(),d=d.r2-d.r1+1,b.c2=b.c1,b.r1-=d,0>b.r1&&(b.r1=0),b.r2=b.r1,P.select(b);d=!1;break;case 34:w.viewNode.dscroll(0,c.visibleHeight()+1);if(b=P.cellSelection())d=c.visibleRange(),d=d.r2-d.r1+1,b.c2=b.c1,b.r1+=d,d=a.rowCount()-1,b.r1>d&&(b.r1=d),b.r2=b.r1,P.select(b);d=!1;break;case 35:f=!f;d=!1;break;case 36:c.scrollToRange(0,0,0,0);b=ra(e.index,0,0);P.select(b);d=f=!1;break;case 27:c.hidePopup(!0);d=f=!1;break;case 37:case 38:case 39:case 40:break;
default:f=!1}return d};d.loadRange=function(b,c){a&&a.loadRange(b,c)};d.expandRange=function(b){a&&(b=a.expandRange(b));return b};d.moveto=function(a,b,d){return c?c.moveto(a,b,d):!1};d.showHidden=function(b){void 0===b&&(b="all");var d=a.showHidden(b);"string"===typeof b&&(b=d);c&&c.showHidden(b.columns,b.rows)};var k=function(){c&&c.showHidden(void 0,x.showHiddenRows)},v=function(){c&&c.showHidden(x.showHiddenColumns,void 0)},l=function(){P.select(null);a&&a.showAnnotations(x.showAnnotations);c&&
(c.showHidden(x.showHiddenColumns,x.showHiddenRows),c.update())};d.pageRange=function(b,c){if("cell"===c&&b==e.index)return ra(b,0,0,a.colCount()-1,a.rowCount()-1)};d.pageRect=function(a,b){if(c)return c.pageRect(a,b)};d.rangeRect=function(a,b,d){if(c)return c.rangeRect(a,b,d)};d.rangeFromRect=function(a,b,d,e,f,k,m,l){if(c)return c.rangeFromRect(a,b,d,e,f,k,m,l)};d.extendRange=function(a,b,d,e){if(c)return c.extendRange(a,b,d,e)};var r=function(b,c){var d=ka(b+c,0,a.colCount()-1);if(0!==c&&a.colHidden(d)){var e=
a.colCount()-1;do if(d+=c,0>d){for(d=0;d<=e&&a.colHidden(d);d++);break}else if(d>e){for(d=e;0<=d&&a.colHidden(d);d--);break}while(a.colHidden(d))}return d},m=function(b,c){var d=ka(b+c,0,a.rowCount()-1);if(0!==c&&a.rowHidden(d)){var e=a.rowCount()-1;do if(d+=c,0>d){for(d=0;d<=e&&a.rowHidden(d);d++);break}else if(d>e){for(d=e;0<=d&&a.rowHidden(d);d--);break}while(a.rowHidden(d))}return d};d.moveAnchor=function(b,d,e,k){k=!1;f&&(0>d?d=-a.colCount():0<d&&(d=a.colCount()),0>e?e=-a.rowCount():0<e&&(e=
a.rowCount()),f=!1);d=r(b.c1,d);e=m(b.r1,e);b.c1!=d&&(b.c1=d,k=!0);b.c2!=d&&(b.c2=d,k=!0);b.r1!=e&&(b.r1=e,k=!0);b.r2!=e&&(b.r2=e,k=!0);k&&c.scrollToRange(b.c1,b.r1,b.c1,b.r1);return k};d.incrementSelection=function(b,d,e,k,l){l=!1;f&&(0>e?e=-a.colCount():0<e&&(e=a.colCount()),0>k?k=-a.rowCount():0<k&&(k=a.rowCount()),f=!1);d.c2==b.c1?(e=r(d.c1,e),e!=d.c1&&(e<=d.c2?d.c1=e:(d.c1=d.c2,d.c2=e),l=!0)):(e=r(d.c2,e),e!=d.c2&&(e>=d.c1?d.c2=e:(d.c2=d.c1,d.c1=e),l=!0));d.r2==b.r1?(k=m(d.r1,k),k!=d.r1&&(k<=
d.r2?d.r1=k:(d.r1=d.r2,d.r2=k),l=!0)):(k=m(d.r2,k),k!=d.r2&&(k>=d.r1?d.r2=k:(d.r2=d.r1,d.r1=k),l=!0));l&&(k=d.c2==b.c1?d.c1:d.c2,b=d.r2==b.r1?d.r1:d.r2,c.scrollToRange(k,b,k,b));return l};d.layoutChanged=function(a){c&&c.layoutChanged(a)};d.update=function(a){c&&c.update(a)}}});Fa.extend(["archive","emailarchive"],{de:"arc",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,highlights:!1,rectselection:!1,cellselection:!1,anchorednotes:!1});tb.extend("arc",{install:function(d){var e,a,c,b,f=function(a){a.preventDefault();
m(this.parentNode.parentNode.parentNode,this)},k=function(a){m(this.parentNode.parentNode.parentNode,this)},v=function(c){b=a.scroll()},l=function(c){a.autoscroll(b.left-c.delta.x,b.top-c.delta.y)},r=function(){var b=a.scroll().left;b!=c&&(c=b,0===c?e.css("margin-left",null):e.css("margin-left",-c+"px"))};d.load=function(b){e=b.childByClass("oit-tree-head");a=b.childByClass("oit-tree-nodes");c=0;a.kinetic(!0);var d=y.byClass("oit-open-close");d&&(pa(d,"onclick",null,f),pa(d,"ontap",null,k));if(d=
y.byClass("oit-tree-nname"))for(b=0;b<d.length;b++){var q=d[b],m=q.attr("data-nodeid");null!==m&&""!==m&&(m=Number(m),isNaN(m)||Ec.on.addElement(q,m))}if(d=e.byClass("oit-col-header"))for(b=0;b<d.length;b++)d[b].ctrl=new p(d[b],e),d[b].ctrl.colClass="f"+b;b=e;var z;a:{try{for(var h=Y.styleSheets,d=0;d<h.length;d++){var u=h[d].cssRules||h[d].rules;if(0<u.length&&"div.f0"==u[0].selectorText){z=d;break a}}}catch(g){}z=null}b.ssIndex=z;a.onscroll(r);a.onpanstart(v);a.onpanmove(l)};d.unload=function(){Ec.on.removeAllElements()};
var m=function(a,b){var c=a.nextElementSibling;"none"!=c.style.display?(c.style.display="none",b&&b.addClass("closed")):(c.style.display="block",b&&b.removeClass("closed"))},p=function(a,b){L.call(this,"div","oit-col-dragger");this.append(y.create("div"));this.headerbar=b;var c=a.nextSiblingElem();c?e.insert(this,c):e.append(this);this.header=a;this.ondragstart(z);this.ondragmove(q);this.ondragend(G);this.ondragcancel(G)};X(p,L);var z=function(a){this.orgwidth=this.header.clientWidth;this.overlay||
(a=w.viewNode,this.overlay=y.create("div","oit-tree-overlay"),this.overlay.css({height:a.clientHeight-this.headerbar.clientHeight+"px",top:this.headerbar.clientHeight+2+"px",left:this.header.offsetLeft-3+"px"}),this.overlay.innerWidth=this.orgwidth+6,this.header.parent().append(this.overlay));return!1},q=function(a){a=this.orgwidth+a.delta.x-3;1>a&&(a=1);this.header.innerWidth=a;this.overlay.innerWidth=a+9;return!1},G=function(a){this.overlay.destroy();delete this.overlay;this.header.css("width",
null);var b=this.orgwidth+a.delta.x-3;1>b&&(b=1);b+="px";if(null!==this.headerbar.ssIndex){var c=Y.styleSheets[this.headerbar.ssIndex].cssRules,d="div."+this.colClass;for(a=0;a<c.length;a++)if(c[a].selectorText==d){c[a].style.width=b;break}}else for(c=this.headerbar.parent().byClass(this.colClass),a=0;a<c.length;a++)c[a].css("width",b);return!1}}});var ga=function(){var d=function(){var a=arguments;if(1===a.length)a=a[0],void 0!==a.units?("px"!==a.units&&(a=da(a),za(a,"px")),this.l=a.left,this.t=
a.top,this.r=a.right,this.b=a.bottom,this.o=B.page(a.page)):a.o&&(this.l=a.l,this.t=a.t,this.r=a.r,this.b=a.b,this.o=a.o);else if(2===a.length){var c=a[0];this.l=c.left;this.t=c.top;this.r=c.right;this.b=c.bottom;this.o=a[1]}else this.l=a[0],this.t=a[1],this.r=a[2],this.b=a[3],this.o=a[4];a=this.o&&("view"===this.o||"overlay"===this.o||this.o instanceof L);if(!(aa(this.l)&&aa(this.t)&&aa(this.r)&&aa(this.b)&&a))throw"Invalid Rectangle";this.l=K(this.l,1E4);this.t=K(this.t,1E4);this.r=K(this.r,1E4);
this.b=K(this.b,1E4);this.l>this.r&&(a=this.l,this.l=this.r,this.r=a);this.t>this.b&&(a=this.t,this.t=this.b,this.b=a);this.w=this.r-this.l;this.h=this.b-this.t},e=X(d);Object.defineProperties(e,{left:{enumerable:!0,get:function(){return this.l},set:function(a){this.verifyMutable();this.l=K(a,1E4);this.r=this.l+this.w}},top:{enumerable:!0,get:function(){return this.t},set:function(a){this.verifyMutable();this.t=K(a,1E4);this.b=this.t+this.h}},right:{enumerable:!0,get:function(){return this.r},set:function(a){this.verifyMutable();
this.r=K(a,1E4);this.l=this.r-this.w}},bottom:{enumerable:!0,get:function(){return this.b},set:function(a){this.verifyMutable();this.b=K(a,1E4);this.t=this.b-this.h}},width:{enumerable:!0,get:function(){return this.w},set:function(a){this.verifyMutable();0>a&&(a=0);this.w=K(a,1E4);this.r=this.l+this.w}},height:{enumerable:!0,get:function(){return this.h},set:function(a){this.verifyMutable();0>a&&(a=0);this.h=K(a,1E4);this.b=this.t+this.h}},origin:{enumerable:!0,get:function(){return this.o},set:function(a){this.verifyMutable();
this.convert(a)}}});var a=function(a,c,d){return"number"===typeof d&&(d=K(d,1E4),d!==a[c])?(a[c]=d,!0):!1};e.move=function(b,c,d,e){this.verifyMutable();b=a(this,"l",b);b|=a(this,"t",c);b|=a(this,"r",d);if(b|=a(this,"b",e))this.w=this.r-this.l,this.h=this.b-this.t;return b};e.movesize=function(b,c,d,e){this.verifyMutable();b=a(this,"l",b);b|=a(this,"t",c);b|=a(this,"w",d);if(b|=a(this,"h",e))this.r=this.l+this.w,this.b=this.t+this.h;return b};e.offset=function(a,c){this.verifyMutable();void 0!==a&&
(this.left+=a);void 0!==c&&(this.top+=c)};e.size=function(a,c){this.verifyMutable();void 0!==a&&(this.width=a);void 0!==c&&(this.height=c)};e.scale=function(a){void 0!==a&&(this.verifyMutable(),this.left*=a,this.top*=a,this.width*=a,this.height*=a)};var c=function(a,c){return a===c?!0:.999<(a>c?c/a:a/c)};e.equals=function(a){return c(this.l,a.left)&&c(this.t,a.top)&&c(this.r,a.right)&&c(this.b,a.bottom)};e.overlaps=function(a){return this.l<a.right&&this.r>a.left&&this.t<a.bottom&&this.b>a.top};e.contains=
function(a){return a.left>=this.l&&a.right<=this.r&&a.top>=this.t&&a.bottom<=this.b};e.containsPoint=function(a,c){return a>=this.l&&a<=this.r&&c>=this.t&&c<=this.b};e.union=function(a,c,d,e){if(1==arguments.length){var b=arguments[0];this.union(b.left,b.top,b.right,b.bottom)}else this.verifyMutable(),a=K(a,1E4),c=K(c,1E4),d=K(d,1E4),e=K(e,1E4),a<this.l&&(this.l=a),c<this.t&&(this.t=c),d>this.r&&(this.r=d),e>this.b&&(this.b=e),this.w=this.r-this.l,this.h=this.b-this.t};e.intersect=function(a,c,d,
e){if(1==arguments.length){var b=arguments[0];this.intersect(b.left,b.top,b.right,b.bottom)}else this.verifyMutable(),a=K(a,1E4),c=K(c,1E4),d=K(d,1E4),e=K(e,1E4),this.l=ka(this.l,a,d),this.r=ka(this.r,a,d),this.t=ka(this.t,c,e),this.b=ka(this.b,c,e),this.w=this.r-this.l,this.h=this.b-this.t};e.constrain=function(a,c,d,e){if(1==arguments.length){var b=arguments[0];this.constrain(b.left,b.top,b.right,b.bottom)}else{this.verifyMutable();a=K(a,1E4);c=K(c,1E4);d=K(d,1E4);e=K(e,1E4);var b=d-a,f=e-c;this.width>=
b?(this.l=a,this.r=d,this.w=b):this.left<a?this.left=a:this.right>d&&(this.right=d);this.height>=f?(this.t=c,this.b=e,this.h=f):this.t<c?this.top=c:this.b>e&&(this.bottom=e)}};e.clone=function(){return new d(this.left,this.top,this.right,this.bottom,this.origin)};e.toRange=function(a){var b=this;this.o!==a&&(b=this.clone(),b.origin=a);return lb(a.index,b.left,b.top,b.right,b.bottom)};e.readonly=function(a){"boolean"===typeof a&&(this._readonly=a);return!!this._readonly};e.verifyMutable=function(){if(this._readonly)throw"Attempted to modify a read-only Rectangle";
};e.distanceFrom=function(a,c,d,e,l){a=K(a,1E4);c=K(c,1E4);switch(d){case "left":a-=this.l;break;case "center":a-=(this.l+this.r)/2;break;case "right":a-=this.r;break;case "none":a=0;break;default:a=a<this.l?a-this.l:a>this.r?a-this.r:0}switch(e){case "top":c-=this.t;break;case "middle":c-=(this.t+this.b)/2;break;case "bottom":c-=this.b;break;case "none":c=0;break;default:c=c<this.t?c-this.t:c>this.b?c-this.b:0}if("xy"===l)l={x:a,y:c,ax:Math.abs(a),ay:Math.abs(c)};else if(0===a&&0===c)l=0;else if(l=
K(Math.sqrt(a*a+c*c),10),0>c||0===c&&0>a)l=-l;return l};e.convert=function(a){var b=this.o;if(a!==b){var c,d=x.rotation,e=x.zoom;if(a instanceof cb)if("view"===b||"overlay"===b){if(c=a,(b=c.pagePos(b))&&this.offset(-b.left,-b.top),c.features().zoom&&1!=e&&this.move(this.l/e,this.t/e,this.r/e,this.b/e),c.features().rotate&&0!==d)switch(d){case 90:this.move(c.width-this.b,this.l,c.width-this.t,this.r);break;case 180:this.move(c.width-this.r,c.height-this.b,c.width-this.l,c.height-this.t);break;case 270:this.move(this.t,
c.height-this.r,this.b,c.height-this.l)}}else if(b instanceof cb)b=b.pageRect(),c=a.pageRect(),this.offset(c.left-b.left,c.top-b.top);else throw"Unsupported Rectangle conversion";else if(b instanceof cb)if("view"===a||"overlay"===a){c=b;if(c.features().rotate&&0!==d)switch(d){case 90:this.move(this.t,c.width-this.r,this.b,c.width-this.l);break;case 180:this.move(c.width-this.r,c.height-this.b,c.width-this.l,c.height-this.t);break;case 270:this.move(c.height-this.b,this.l,c.height-this.t,this.r)}c.features().zoom&&
"email"!==c.type&&"rt"!==c.type&&1!=e&&this.move(this.l*e,this.t*e,this.r*e,this.b*e);(b=c.pagePos(a))&&this.offset(b.left,b.top)}else throw"Unsupported Rectangle conversion";else if("view"===a||"overlay"===a||a instanceof L)if("view"===b)b=D.padding(),c=D.scrollOffset(),this.left=this.left-b.left+c.left,this.top=this.top-b.top+c.top,a instanceof L&&(b=(c=a.ancestorByClass("oit-overlay"))?a.pos(c):a.pos(w.viewNode),this.left-=b.left,this.top-=b.top);else{if("overlay"===b||b instanceof L)b instanceof
L&&(b=(c=b.ancestorByClass("oit-overlay"))?b.pos(c):b.pos(w.viewNode),this.left+=b.left,this.top+=b.top),"view"===a&&(b=D.padding(),c=D.scrollOffset(),this.left=this.left+b.left-c.left,this.top=this.top+b.top-c.top)}else throw"Unsupported Rectangle conversion";this.o=a}return this};return d}(),ec=function(){var d=function(a){this._rects=[];this.add(a)},e=X(d);Object.defineProperties(e,{length:{enumerable:!0,get:function(){return this._rects.length}},left:{enumerable:!0,get:function(){return this.boundingRectangle().left}},
top:{enumerable:!0,get:function(){return this.boundingRectangle().top}},right:{enumerable:!0,get:function(){return this.boundingRectangle().right}},bottom:{enumerable:!0,get:function(){return this.boundingRectangle().bottom}},width:{enumerable:!0,get:function(){return this.boundingRectangle().width}},height:{enumerable:!0,get:function(){return this.boundingRectangle().height}}});e.item=function(a){return this._rects[a]};e.add=function(a){if(a){if(Array.isArray(a))for(var c=0;c<a.length;c++)this._rects.push(a[c]);
else this._rects.push(a);this._boundingRect=null}return this};e.convert=function(a){pa(this._rects,"convert",null,a);this._boundingRect=null;return this};e.boundingRect=function(){if(!this._boundingRect){for(var a=this._rects,c=a[0],b=c.left,d=c.top,e=c.right,v=c.bottom,l=1;l<a.length;l++)c=a[l],c.left<b&&(b=c.left),c.top<d&&(d=c.top),c.right>e&&(e=c.right),c.bottom>v&&(v=c.bottom);this._boundingRect=new ga(b,d,e,v,a[0].origin)}return this._boundingRect};e.interiorRect=function(a,c){for(var b=this._rects,
d=null,e=0,v=0;v<b.length;v++){var l=b[v];if(l.width>=a.width&&l.height>=a.height){d=l;break}else if(!d||l.width>d.width||l.height>d.height){var r=l.width/a.width,m=l.height/a.height,p=Math.min(r,m);c&&(r=l.height/a.width,m=l.width/a.height,p=Math.max(p,Math.min(r,m)));if(!d||p>e)d=l,e=p}}if(d)return d.clone()};return d}(),Ab=function(){var d=function(a){L.call(this,"style");a&&this.attr("media",a);this.append(y.createText(""));y.head.append(this);this.rulecount=0;this.indexLookup={};Object.defineProperty(this,
"sheet",{get:function(){return this.dom.sheet}})},e=X(d,L);e.addCSSText=function(a){this.html(this.html()+a)};e.setCSSText=function(a){this.html(a)};e.setRule=function(a,c){if(c&&this.indexLookup.hasOwnProperty(c))return this.updateRuleByIndex(a,this.indexLookup[c]);try{return this.sheet.insertRule(a,this.rulecount),c&&(this.indexLookup[c]=this.rulecount),this.rulecount++}catch(b){this.logError("setRule","Error inserting style rule: "+b.message)}};e.updateRuleByIndex=function(a,c){if(!isNaN(c)){try{this.sheet.deleteRule(c),
this.sheet.insertRule(a,c)}catch(b){this.logError("updateRuleByIndex","Error updating style rule: "+b.message)}return c}};e.updateRule=function(a,c){this.indexLookup.hasOwnProperty(c)?this.updateRuleByIndex(a,this.indexLookup[c]):this.updateRuleByIndex(a,c)};e.removeFromNames=function(a){for(var c in this.indexLookup)this.indexLookup[c]==a?delete this.indexLookup[c]:this.indexLookup[c]>a&&--this.indexLookup[c]};e.deleteRule=function(a){a=this.indexLookup.hasOwnProperty(a)?this.indexLookup[a]:a;!isNaN(a)&&
a<this.rulecount&&(this.sheet.deleteRule(a),this.removeFromNames(a),this.rulecount--)};e.hasRule=function(a){return this.indexLookup.hasOwnProperty(a)};return d}(),Lc=function(){var d=function(a,b){a/=b/2;if(1>a)return.5*a*a;a--;return-.5*(a*(a-2)-1)},e={ease:d,"ease-in-out":d,"ease-in":function(a,b){a/=b;return a*a*a},"ease-out":function(a,b){a/=b;a--;return a*a*a+1},linear:function(a,b){return a/b}},a="opacity offsetLeft offsetTop innerWidth innerHeight scrollLeft scrollTop".split(" "),c={scrollLeft:!1,
scrollTop:!1},b=[],f=function(a){pc(b,"step",null,a);0<b.length&&ib(f)},k=function(a){var c=a.elem;c&&c.dom&&(c.data("_animation")===a&&c.removeData("_animation"),c.removeClass("oit-animating"));Da(b,a)};F.onreset(function(){pa(b,"finish");b=[];for(var a in c)c.hasOwnProperty(a)&&(c[a]=!1)});var v=function(a,b,c){b=b[a];void 0!==b&&(c[a]=b)},l=function(a,b,c){b=b[a];Na(b)&&(c[a]=b)},r=function(a,b){var c=a[b];c&&(a.args?c.apply(a.context,a.args):c.call(a.context,a.elem))},m=function(a,b){var c=a[b];
c&&a.elem&&a.elem.dom&&a.elem.css(c)},p=function(k,m){this.elem=k;this.time=void 0!==m.time?m.time:120;l("startFn",m,this);l("stepFn",m,this);l("endFn",m,this);v("context",m,this);m.args&&(this.args=Array.prototype.slice.call(m.args,0),this.args.unshift(k));v("startCSS",m,this);v("endCSS",m,this);this.transFn=e[m.transition]||d;for(var q=x.disableAnimation||0>=this.time,z=0;z<a.length;z++){var p=a[z],r=m[p];if(void 0!==r){var E=k[p];E!=r&&(this.props||(this.props={}),this.props[p]={start:E,end:r},
q|=c[p])}}q||!this.props?this.finish():(b.push(this),k.data("_animation",this),k.addClass("oit-animating"),ib(f))},z=X(p);z.isEmpty=function(){return 0>=this.time||!this.props};z.step=function(a){var b=!1,c=this.elem;c&&c.dom&&void 0===this.startTime&&(m(this,"startCSS"),r(this,"startFn"),this.startTime=a,this.steps=0,c=this.elem);if(c&&c.dom&&(this.steps++,a-=this.startTime,a=a>=this.time?1:this.transFn(a,this.time),1>a)){var b=this.props,d;for(d in b){var e=b[d];c[d]=e.start+(e.end-e.start)*a}r(this,
"stepFn");b=!0}b||this.finish();return b};z.finish=function(){var a=this.elem;if(a){var b=this.props,d;if(this.steps&&4>this.steps)for(d in b)c.hasOwnProperty(d)&&(c[d]=!0);k(this);void 0===this.startTime&&(m(this,"startCSS"),r(this,"startFn"));if(a.dom)for(d in b)a[d]=b[d].end;m(this,"endCSS");r(this,"endFn");this.deleteAll()}};z.abort=function(){this.elem&&(k(this),this.deleteAll())};return p}(),Gc=function(){var d=[],e=OIT.DialogBox=function(a){L.call(this,"div","oit-dialog");a=a||{};this._resizable=
this._moveable=this._modal=this._visible=!1;d.push(this);this.css("opacity",0);this._form=y.create("form",this);this.move(a.x,a.y,a.width,a.height);void 0!==a.className&&this.addClass(a.className);void 0!==a.moveable&&this.moveable(a.moveable);void 0!==a.resizable&&this.resizable(a.resizable);void 0!==a.modal&&this.modal(a.modal);void 0!==a.resultFn&&(this._resultFn=a.resultFn);void 0!==a.destroyFn&&(this._destroyFn=a.destroyFn);void 0!==a.title&&this.title(a.title);void 0!==a.textColor&&this.css("color",
a.textColor);void 0!==a.backgroundColor&&this._form.css("background-color",a.backgroundColor);a.cancel&&(k(this,R.CANCEL,this.cancel),this.onkeydown(v));a.ok&&k(this,R.OK,this.ok);a.no&&k(this,R.NO,this.no);a.yes&&k(this,R.YES,this.yes);w.rootNode.append(this)},a=X(e,L),c=function(a){a=this.pos();this._dragX=a.left;this._dragY=a.top;this._header.css("cursor",Rb);return!1},b=function(a){this.move(this._dragX+a.delta.x,this._dragY+a.delta.y);this._header.css("cursor",Rb);return!1},f=function(a){this._header.css("cursor",
Qb);return!1},k=function(a,b,c){a._footer||(a._footer=y.create("footer",a),a._footerVisible=!0);b=new Wb(b);a._footer.append(b);b.onclick(a,c);b.ontap(a,c)},v=function(a){return 27==a.keyCode?!1:!0},l=function(a){var b=0;a._header&&(a._header.css("cursor",a._moveable?Qb:null),b=a._header.offsetHeight);if(a._footer&&a._footerVisible)a._footer.css("display",null),a._form.css({height:null,position:"absolute",top:b+"px",left:"0px",right:"0px",bottom:a._footer.offsetHeight+"px"});else{a._footer&&a._footer.css("display",
"none");var c=null;0<b&&(c=a.clientHeight-b+"px");a._form.css({position:null,left:null,right:null,top:null,bottom:null,height:c})}};a.destroy=function(){this.cancel();this.show(!1,{animate:!1});this._destroyFn&&this._destroyFn(this);Da(d,this);L.prototype.destroy.call(this)};a.exit=function(){this.cancel();this.show(!1,{endFn:this.destroy,context:this})};a.moveable=function(a){if(!0===a||!1===a)this._moveable=a,l(this);return this._moveable};a.resizable=function(a,b,c){if((!0===a||!1===a)&&a!=this._resizable){this._resizable=
a;var d,e;this._resizable?(this.addClass("oit-dialog-resizable"),void 0!==b&&(d=b+"px"),void 0!==c&&(e=c+"px")):this.removeClass("oit-dialog-resizable");this.css({"min-width":d,"min-height":e})}return this._resizable};a.modal=function(a){!0!==a&&!1!==a||a===this._modal||(this._modal=a,Ga.showModalOverlay(this._modal));return this._modal};a.title=function(a){if(a){var d;this._header||(this._header=y.create("header"),this.insert(this._header,this.firstChildElem()),this._header.ondragstart(this,c),this._header.ondragmove(this,
b),this._header.ondragend(this,f),this._header.ondragcancel(this,f));d=this._header;this._title||(this._title=y.create(),d.append(this._title));this._title.html(a);this._title.css("display",null);d.addClass("oit-dialog-header-shaded");l(this)}else null===a&&(this._title&&(this._title.destroy(),delete this._title),this._header&&(this._header.destroy(),delete this._header),l(this));return this._title?this._title.text():void 0};a.resetForm=function(){this._form.html("")};a.addLabel=function(a,b){var c=
y.create("label",this._form);c.html(a);b&&b.style&&c.css(b.style);return c};a.addTextArea=function(a,b){a&&(this.addLabel(a),y.create("br",this._form));var c=new jc;this._form.append(c);b&&(b.style&&c.css(b.style),b.placeholder&&c.attr("placeholder",b.placeholder));return c};a.show=function(a,b){!1!==a&&(a=!0);a&&(this._result=void 0);this.finishAnimation();if(this._visible==a)b&&(b.startFn&&b.startFn.call(b.context,this),b.endFn&&b.endFn.call(b.context,this));else{b=b||{};var c=0;!1!==b.animate&&
(c=200);a?(this.startFn=b.startFn,this.startContext=b.context,this.animate({opacity:1,time:c,startCSS:{opacity:0,display:"block"},startFn:r,endFn:b.endFn,context:this}),this._visible=!0,this._modal&&Ga.showModalOverlay(!0,c)):(this.animate({opacity:0,time:c,startFn:b.startFn,endCSS:{display:null},endFn:b.endFn,context:b.context}),this._visible=!1,this._modal&&Ga.showModalOverlay(!1,c))}return this._visible};var r=function(){l(this);this.startFn&&this.call(this.startContext,this);delete this.startFn;
delete this.startContext};a.showFooter=function(a){!0!==a&&!1!==a||a===this._footerVisible||(this._footerVisible=!1!==a,l(this));return this._footerVisible};a.move=function(a,b,c,d,e){var f=w.viewNode,k=f.size(),f=f.pos();void 0===c&&(c=this.offsetWidth);var h=k.width-10-10;c>h&&(c=h);void 0===d&&(d=this.offsetHeight);h=k.height-10-10;d>h&&(d=h);void 0!==a&&(h=f.left+k.width-10-c,a>h&&(a=h),a=K(a));void 0!==b&&(k=f.top+k.height-10-d,b>k&&(b=k),b=K(b));this._visible&&a!==this.offsetLeft||b!==this.offsetTop||
c!==this.innerWidth||d!=this.innerHeight?(k=e&&!0===e.animate?200:0,e&&(this.moveOptions=e),this.css("overflow","hidden"),this.animate({offsetLeft:a,offsetTop:b,innerWidth:c,innerHeight:d,time:k,endCSS:{overflow:null},endFn:m,context:this})):e&&e.endFn&&e.endFn.call(e.context,this)};var m=function(){l(this);var a=this.moveOptions;a&&a.endFn&&a.endFn.call(a.context,this);delete this.moveOptions};a.autoSize=function(a,b,c,d,e){(c=this.hasClass("oit-animating"))&&this.removeClass("oit-animating");var f=
["width","height","display","opacity"];d=this.css(f);this.removeCSS(f);this.css("display","block");this.css("opacity","1");var f=this.offsetWidth,k=this.offsetHeight;this.css(d);c&&this.addClass("oit-animating");this.move(a,b,f,k,e)};a.maxsize=function(a,b){var c={};void 0!=a&&(c["max-width"]=0===a?null:a+"px");void 0!=b&&(c["max-height"]=0===b?null:b+"px");this.css(c)};var p=function(a,b){a._visible||a.css("display","block");var c=a[b];a._visible||a.css("display",null);return c};a.width=function(){return p(this,
"offsetWidth")};a.height=function(){return p(this,"offsetHeight")};var z=function(a,b){void 0===a._result&&(a._result=b,a._resultFn&&a._resultFn(a,b))};a.cancel=function(){z(this,!1)};a.ok=function(){z(this,!0)};a.no=function(){z(this,0)};a.yes=function(){z(this,1)};a.result=function(){return this._result};F.onreset(function(){for(;0<d.length;)d.shift().destroy()});return e}();nb("TextRange",function(d,e){if(d>e){var a=d;d=e;e=a}this.type="text";this.acc=d;this.accend=e});nb("CellRange",function(d,
e,a,c,b,f,k,v,l){var r;e>c&&(r=e,e=c,c=r);a>b&&(r=a,a=b,b=r);this.type="cell";this.page=d;this.section=B.page(d).section;this.c1=e;this.r1=a;this.c2=c;this.r2=b;void 0!==f&&(this.offsets="number"===typeof f?{left:f,top:k,right:v,bottom:l}:{left:f.left,top:f.top,right:f.right,bottom:f.bottom})});nb("RectRange",function(d,e,a,c,b,f,k,v){var l;a>b&&(l=a,a=b,b=l);c>f&&(l=c,c=f,f=l);this.type="rect";void 0!==d&&(this.embedId=d);this.page=e;this.left=a;this.top=c;this.right=b;this.bottom=f;this.units=k;
if(void 0!==v)this.section=v;else if(d=B.page(e))this.section=d.section});var Pb=function(){var d=function(a,b,d){L.call(this,"div",b);this._layer=a;this._visible=!0;d?d.append(this):a.append(this);y.attach(this);"none"===this.computedStyleProp("display")&&(this._visible=!1);this.changed()},e=X(d,L);e.createChild=function(a){return new Aa(this,a)};e.layer=function(){return this._layer};e.moveToTop=function(){this.parent().append(this)};e.addClass=function(a){this.hasClass(a)||(L.prototype.addClass.apply(this,
arguments),delete this._borderOffset,this.changed());return this};e.removeClass=function(a){this.hasClass(a)&&(L.prototype.removeClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.defaultSize=function(){if(!this._defaultSize){var a=["transform","display","width","height"],b=this.css(a);this.removeCSS(a);this._defaultSize={width:this.offsetWidth,height:this.offsetHeight};this.css(b)}return this._defaultSize};e.setDefaultSize=function(a){this._defaultSize=a};e.resetDefaultSize=
function(){this._defaultSize&&(this._defaultSize=null)};e.setTitle=function(a){this.attr("title",a)};e.show=function(a){!1!==a&&(a=!0);a!==this._visible&&((this._visible=a)?(this.css("display","block"),this.changed()):this.css("display","none"));return this};e.hide=function(){return this.show(!1)};e.visible=function(){return this._visible&&this._layer.visible()};e.layoutObject=function(){if(!this._animating&&this.visible()){var a=this.position();if(a){var b={};b.left=a.left;this._borderOffset&&(b.left-=
this._borderOffset.left);b.left+="px";b.top=a.top;this._borderOffset&&(b.top-=this._borderOffset.top);b.top+="px";b.width=a.width+"px";b.height=a.height+"px";this.css(b);this._borderOffset||(this._borderOffset={left:this.clientLeft,top:this.clientTop},this._borderOffset.left&&this.css("left",a.left-this._borderOffset.left+"px"),this._borderOffset.top&&this.css("top",a.top-this._borderOffset.top+"px"))}}return this};e.changed=function(){this._dirty||(this._dirty=!0,this._parentObject?this._parentObject.childChanged(this):
this._layer.changed(this));return this};e.childChanged=function(a){this._dirty||(this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.update=function(c){this._dirty&&(c=!0,this._dirty=!1);c&&this.layoutObject();this.queryChildElements(a,c);return this};var a=function(a,b,d){a.update&&a.update(d)};return d}(),Aa=function(){var d=function(a,c){c=c||{};Pb.call(this,a.layer(),c.classList,a);this._parentObject=a;c.title&&this.setTitle(c.title);var b=c.margin||
0;this._margin={left:b,top:b,right:b,bottom:b};void 0!==c.hpos&&(this._hpos=c.hpos);void 0!==c.vpos&&(this._vpos=c.vpos);!0===c.inheritMoveable&&(this.inheritMoveable=!0)},e=X(d,Pb);e.resize=function(a,c){void 0!==a||void 0!==c?this._size&&this._size.width===a&&this._size.height===c||(this._size={width:a,height:c},this.changed()):this._size&&(delete this._size,this.changed());return this};e.setMargin=function(a,c,b,d){var e=!1;void 0!==a&&a!==this._margin.left&&(this._margin.left=a,e=!0);void 0!==
c&&c!==this._margin.top&&(this._margin.top=c,e=!0);void 0!==b&&b!==this._margin.right&&(this._margin.right=b,e=!0);void 0!==d&&d!==this._margin.bottom&&(this._margin.bottom=d,e=!0);e&&(this._pos&&(this._pos=void 0),this.changed());return this};e.position=function(){if(this._parentObject){var a=this._parentObject.position()||this._parentObject.defaultSize();if(this._pos&&a.width!=this._parentWidth||a.height!=this._parentHeight)this._pos=void 0;if(void 0===this._pos){this._parentWidth=a.width;this._parentHeight=
a.height;var c,b,d,e;if("fill"===this._hpos)c=this._margin.left,d=a.width-this._margin.left-this._margin.right;else if(void 0!==this._hpos)if(d=this._size&&0<this._size.width?this._size.width:this.defaultSize().width,"number"===typeof this._hpos)c=0<=this._hpos?this._margin.left+this._hpos:a.width-this._margin.right-d+this._hpos;else switch(this._hpos){case "left":c=this._margin.left;break;case "center":c=(a.width-d)/2;break;case "right":c=a.width-this._margin.right-d}if("fill"===this._vpos)b=this._margin.top,
e=a.height-this._margin.top-this._margin.bottom;else if(void 0!==this._vpos)if(e=this._size&&0<this._size.height?this._size.height:this.defaultSize().height,"number"===typeof this._vpos)b=0<=this._vpos?this._margin.top+this._vpos:a.height-this._margin.bottom-e+this._vpos;else switch(this._vpos){case "top":b=this._margin.top;break;case "middle":b=(a.height-e)/2;break;case "bottom":b=a.height-this._margin.bottom-e}void 0!==c||void 0!==b||void 0!==d||void 0!==e?(void 0===c&&(c=0),void 0===b&&(b=0),void 0===
d&&(d=this.defaultSize().width),void 0===e&&(e=this.defaultSize().height),this._pos=new ga(c,b,c+d,b+e,"overlay")):this._pos=null}}return this._pos};return d}(),Zc=function(){var d=function(a){Aa.call(this,a,{hpos:"center",vpos:"middle",classList:"oit-highlight-label",inheritMoveable:!0})},e=X(d,Aa);e.destroy=function(){this._parentObject&&this._parentObject.attr("title",null);Aa.prototype.destroy.call(this)};e.setText=function(a){this._labelText=a=a||"";this.html(a);this.setTitle(a);this.resetDefaultSize();
this.changed()};e.setColor=function(a,c){this.css("color",a)};e.setBoundingRect=function(a){a?this._parentRect=a.clone():delete this._parentRect;this.show()};e.position=function(){if(this._parentObject){var a=this._parentRect||this._parentObject.position();this.css("transform",null);this.showLabelText=!0;this.html(this._labelText);var c="",b=this.defaultSize(),d=b.width+4,e=b.height+4,v=!1;if(d>a.width||e>a.height){if(d>e&&a.width<a.height||d<e&&a.width>a.height)b={width:b.height,height:b.width},
d=b.width+4,e=b.height+4,c="rotate(270deg)",v=!0;if(d>a.width||e>a.height){var l=K(Math.min(a.width/d,a.height/e),1E3);.4>l?(c="",this.html(""),this.showLabelText=!1):(c+="scale("+l+","+l+")",d=b.width*l+4,e=b.height*l+4)}}this.css("transform",c);if(this.showLabelText)return c=a.left+(a.width-d)/2,a=a.top+(a.height-e)/2,v&&(a+=e),d=c+d,e=a+e,this.show(),new ga(c,a,d,e,"overlay");this.hide()}};return d}(),$c=function(){var d=function(a){Aa.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation",
inheritMoveable:!0})},e=X(d,Aa);e.setResizable=function(b){if(b){this._resizable||(this.addClass("oit-resize"),a(this,"oit-resize-n",!1,!0,!1,!1),a(this,"oit-resize-s",!1,!1,!1,!0),a(this,"oit-resize-e",!1,!1,!0,!1),a(this,"oit-resize-w",!0,!1,!1,!1),a(this,"oit-resize-ne",!1,!0,!0,!1),a(this,"oit-resize-nw",!0,!0,!1,!1),a(this,"oit-resize-se",!1,!1,!0,!0),a(this,"oit-resize-sw",!0,!1,!1,!0));var c=b.margin||0;0>c&&this.setMargin(c,c,c,c);this._resizable=b}else this._resizable&&(this._resizeHandles&&
(pa(this._resizeHandles,"destroy"),delete this._resizeHandles),delete this._resizable,this.removeClass("oit-resize"))};var a=function(a,c,d,e,p,z){c=y.create("div",c);c.ondragstart(a,b,d,e,p,z);c.ondragmove(a,f);c.ondragend(a,k);c.ondragcancel(a,k);a.append(c);a._resizeHandles||(a._resizeHandles=[]);a._resizeHandles.push(c)},c=function(a,b,c){b=b._parentObject;b.dispatchCustom(a,{drawingRect:b,newRect:c.curRect,moved:c.resized})},b=function(a,b,d,e,f){a=this._parentObject.position();this.resizeInfo=
b={left:b,top:d,right:e,bottom:f,startRect:a.clone(),curRect:a.clone(),resized:!1};c("resizestart",this,b);return!1},f=function(a){var b=this.resizeInfo;this.calculateResize(b,a);b.resized=!0;c("resizemove",this,b);if(!this._resizable.bindToObject){a=this._parentObject.position();var d=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(d+b.curRect.left-a.left,d+b.curRect.top-a.top,d+a.right-b.curRect.right,d+a.bottom-b.curRect.bottom)}return!1},k=function(a){a=this.resizeInfo;
if(!this._resizable.bindToObject){var b=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(b,b,b,b)}c("resizeend",this,a);delete this.resizeInfo;return!1};e.calculateResize=function(a,b){var c=b.delta.x,d=b.delta.y,e=a.startRect.left,f=a.startRect.top,k=a.startRect.right,l=a.startRect.bottom;a.left?(e+=c,k-e<this._resizable.minWidth&&(e=k-this._resizable.minWidth)):a.right&&(k+=c,k-e<this._resizable.minWidth&&(k=e+this._resizable.minWidth));a.top?(f+=d,l-f<this._resizable.minHeight&&
(f=l-this._resizable.minHeight)):a.bottom&&(l+=d,l-f<this._resizable.minHeight&&(l=f+this._resizable.minHeight));return e!=a.curRect.left||f!=a.curRect.top||k!=a.curRect.right||l!=a.curRect.bottom?(a.curRect.move(e,f,k,l),!0):!1};return d}(),ad=function(){var d,e=function(a){Aa.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation"});this._range=da(a._range);this._startHandle=c(this,b);this._endHandle=c(this,f)},a=X(e,Aa),c=function(a,b){var c=new Aa(a,{hpos:0,vpos:0,classList:"oit-text-handle"});
c.append(y.create("div")).append(y.create("div")).ondragstart(a,b).ondragmove(a,v).ondragend(a,l).ondragcancel(a,l);return c};a.showHandles=function(a){a=!1!==a?null:"none";this._startHandle.css("display",a);this._endHandle.css("display",a)};var b=function(a){var b=this._range;return k(this,this._startHandle,a,b.accend,b.acc)},f=function(a){var b=this._range;return k(this,this._endHandle,a,b.acc,b.accend)},k=function(a,b,c,d,e){a._anchor=d;a._focus=e;b=b.pos(w.viewNode);c=c.center;a._adjust={x:16-
(c.x-b.left),y:-(c.y-b.top)};return!1},v=function(a){var b=a.center;if(b&&(a=this._parentObject,b=B.mapToPage(b.x+this._adjust.x,b.y+this._adjust.y,null,!0,!0))){if(void 0===this._textAnchorRoot){var c=b.page.findACC(a._range.acc);this._textAnchorRoot=c?va(c[0]):null}if(c=b.page.mapPointToText(b.x,b.y,this._textAnchorRoot))c=c.acc,c!=this._focus&&(this._focus=c,this._focus>=this._anchor?(this._range.acc=this._anchor,this._range.accend=this._focus):(this._range.acc=this._focus,this._range.accend=this._anchor),
this.changed(),a.setRange(this._range),a.dispatchCustom("textmove",{range:this._range,page:b.page}))}return!1},l=function(a){a=this._parentObject;a.setRange(this._range);a.dispatchCustom("textmoveend",{range:this._range});delete this._anchor;delete this._focus;delete this._adjust;return!1};a.layoutObject=function(){if(this.visible()){var a=this._parentObject;Aa.prototype.layoutObject.call(this);d||(d=this._startHandle.defaultSize());var b=this._parentObject.position();if(b){this.show();var c=r(this._startHandle,
b,a.startHandleRect()),b=r(this._endHandle,b,a.endHandleRect());c||b||(c=B.pagesForRange(a._range),this.show(c&&-1!=c.indexOf(a._page)))}else this.hide()}};var r=function(a,b,c){c?(a.setMargin(c.left-b.left-d.width/2,c.bottom-b.top-1),a.resize(d.width,d.height),a.show()):a.hide();return c};return e}(),Ta=function(){var d=function(a,c,d){Pb.call(this,c,d);this._pos=new ga(0,0,0,0,"overlay")},e=X(d,Pb);e.setLabel=function(a,c,d){if(a){if(d=d||"#FFF",a!==this._labelText||c!=this._labelColor||d!=this._backgroundColor)if(this._labelText=
a,this._labelColor=c||"#000",this._labelBackground=d||"#FFF",this.setTitle(this._labelText),this._labels)for(a=0;a<this._labels.length;a++)c=this._labels[a],c.setText(this._labelText),c.setColor(this._labelColor,this._labelBackground)}else this._labelText&&(delete this._labelText,delete this._labelColor,delete this._labelBackground,this.setTitle(""),this._labels&&(pa(this._labels,"destroy"),delete this._labels));this.changed()};e.allocateLabelChildren=function(a){this._labels||(this._labels=[]);for(;this._labels.length<
a;){var b=new Zc(this);this._labels.push(b);b.setText(this._labelText);b.setColor(this._labelColor,this._labelBackground)}for(;this._labels.length>a;)this._labels.pop().destroy();return this._labels};e.labelChildCount=function(){return this._labels?this._labels.length:0};e.getLabelChild=function(a){if(this._labels)return this._labels[a]};e.move=function(b,d,e,v,l){this._pos.movesize(b,d,e,v)&&(this.changed(),this.finishAnimation(),l&&(b=this.position(),l.stepFn&&(this.stepMoveFn=l.stepFn),l.endFn&&
(this.endMoveFn=l.endFn),l={offsetLeft:b.left,offsetTop:b.top,innerWidth:b.width,innerHeight:b.height,transition:l.transition||"ease",time:l.timems,startFn:l.startFn,stepFn:a,endFn:c,context:this},this._animating=!0,this.animate(l)));return this};var a=function(a){this.update(!0);this.stepMoveFn&&this.stepMoveFn(this)},c=function(a){delete this._animating;this.changed();this.endMoveFn&&this.endMoveFn(this);delete this.stepMoveFn;delete this.endMoveFn};e.resize=function(a,c){return this.move(void 0,
void 0,a,c)};e.position=function(){return this._pos};return d}(),sb=function(){var d=function(a,c,b){Ta.call(this,a,c,b)},e=X(d,Ta);e.customEvent("resizestart");e.customEvent("resizemove");e.customEvent("resizeend");e.activate=function(a,c){this._rectActivation||(this._rectActivation=new $c(this),c&&this.insertFirst(this._rectActivation),this._resizable&&this._rectActivation.setResizable(this._resizable));this.moveToTop();return this};e.deactivate=function(){this._rectActivation&&(this._rectActivation.destroy(),
delete this._rectActivation);return this};e.resizable=function(a,c){if(!0===a){c=c||{};var b=!0,d=c.minWidth||0,e=c.minHeight||0,v=c.margin||0;!1===c.bindToObject&&(b=!1);this._resizable&&this._resizable.bindToObject==b&&this._resizable.onResizeStart==c.onResizeStart&&this._resizable.onResize==c.onResize&&this._resizable.onResizeEnd==c.onResizeEnd&&this._resizable.onResizeCancel==c.onResizeCancel&&this._resizable.context===c.context&&this._resizable.minWidth==d&&this._resizable.minHeight==e&&this._resizable.margin==
v||(this._resizable={bindToObject:b,minWidth:d,minHeight:e,margin:v},c.onResizeStart&&(this._resizable.onResizeStart=c.onResizeStart),c.onResize&&(this._resizable.onResize=c.onResize),c.onResizeEnd&&(this._resizable.onResizeEnd=c.onResizeEnd),c.onResizeCancel&&(this._resizable.onResizeCancel=c.onResizeCancel),this._resizable.context=c.context||this,this._rectActivation&&this._rectActivation.setResizable(this._resizable))}else this._resizable&&!1===a&&(delete this._resizable,this._rectActivation&&
this._rectActivation.setResizable(null));return this};e.layoutObject=function(){if(this.visible()&&!this._animating&&(Ta.prototype.layoutObject.call(this),this._labelText)){var a=this.position().clone();a.left=0;a.top=0;this.allocateLabelChildren(1)[0].setBoundingRect(a)}return this};return d}(),bd=function(){var d=function(a,c,b){Ta.call(this,a,c,b);a=this.defaultSize();this.move(void 0,void 0,a.width,a.height)},e=X(d,Ta);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};
e.deactivate=function(){this.removeClass("oit-active");return this};return d}(),cd=function(){var d=function(a,c,b,d){var e=["oit-badge"];b&&e.push(b);Ta.call(this,a,c,e);this.resize(20,20);this.text(d)},e=X(d,Ta);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return d}(),dd=function(){var d=function(a,b,d){Ta.call(this,a,b,d);this._page=B.page(a)},e=X(d,Ta);e.customEvent("textmove");e.customEvent("textmoveend");
e.activate=function(a){this._textActivation||(this._textActivation=new ad(this));this._textActivation.showHandles(this._showHandles);this.moveToTop();return this};e.deactivate=function(){this._textActivation&&(this._textActivation.destroy(),delete this._textActivation);return this};e.setRange=function(a){if(a&&"text"===a.type)if(!this._range)this._range=da(a),this.changed();else if(this._range.acc!=a.acc||this._range.accend!==a.accend)this._range.acc=a.acc,this._range.accend=a.accend,this.changed();
return this};e.showTextHandles=function(){this._showHandles=!0;this._textActivation&&this._textActivation.showHandles(!0);return this};e.hideTextHandles=function(){this._showHandles=!1;this._textActivation&&this._textActivation.showHandles(!1);return this};e.layoutObject=function(){if(this.visible()&&!this._animating){var a=this._page.textBoundingRect(this._range);a&&(a.origin="overlay",this.move(a.left,a.top,a.width,a.height));Ta.prototype.layoutObject.call(this);if(this._labelText){var b=this._page.textRects(this._range,
"overlay"),a=this._page.textBoundingRect(this._range);if(b&&a&&(a.origin="overlay",this.allocateLabelChildren(b.length),0<this._labels.length))for(var d=this.getLabelChild(0).defaultSize(),e=0;e<this._labels.length;e++){var v=this.getLabelChild(e);v.setDefaultSize(d);this._moveable?v.addClass("oit-moveable"):v.removeClass("oit-moveable");var l=b[e].interiorRect(d,!0);l&&l.offset(-a.left,-a.top);v.setBoundingRect(l)}}}return this};var a=function(a,b,d){var c=a._page.accRect(b,"overlay");if(!c)for(var e=
0<d?1:-1,f=e;!(c=a._page.accRect(b+f,"overlay"))&&f!=d;f+=e);c&&(c.width=0);return c};e.startHandleRect=function(){if(this._range)return a(this,this._range.acc,1)};e.endHandleRect=function(){if(this._range)return a(this,this._range.accend,-2)};return d}(),ed=function(){var d=function(a,b,d){L.call(this,"div","oit-drawinglayer oit-drawinglayer-"+b,d);this._drawing=a;this._name=b;this._visible=!0;y.attach(this);a.append(this);this.show()},e=X(d,L);e.drawing=function(){return this._drawing};e.show=function(a,
b){void 0===a&&(a=!0);a!==this._visible&&(!0===a?(this._visible=!0,this.css("display",null),!1!==b&&this.update(!0)):!1===a&&(this._visible=!1,this.css("display","none")))};e.hide=function(){this.show(!1)};e.visible=function(){return this._visible};e.update=function(c){this.queryChildElements(a,c)};var a=function(a,b,d){a.update&&a.update(d)};e.changed=function(){this._drawing.changed()};return d}(),Rc=function(){var d=function(a){L.call(this,"div","oit-drawingpanel");y.attach(this);this._origin=
null;a.append(this);a.onscroll(this,this.updateScroll)},e=X(d,L);e.destroy=function(){var a=this.parent();a&&a.offscroll(this.updateScroll);L.prototype.destroy.call(this)};e.update=function(c){!0!==c&&(c=!1);this._animationFrame&&(this._animationFrame=null);this.queryChildElements(a,c)};var a=function(a,b,d){a.update&&a.update(d)};e.changed=function(){this._animationFrame||(this._animationFrame=ib(this.update,this))};e.setOrigin=function(a,b){if(!this._origin)this._origin={x:a,y:b},this.updateScroll();
else if(this._origin.x!=a||this._origin.y!=b)this._origin.x=a,this._origin.y=b,this.updateScroll()};e.resetOrigin=function(){this._origin&&(this._origin=null,this.css({left:null,top:null}))};e.updateScroll=function(){if(this._origin){var a=this.parent().scroll();this.css({left:this._origin.x+a.left+"px",top:this._origin.y+a.top+"px"})}};return d}(),mb=function(){var d=function(a,c,d){L.call(this,a);this.acc=c;this.accend=d;void 0===this.accend&&(a=y.data(this,"accend"))&&(this.accend=Number(a));void 0===
this.accend&&(this.accend=c+this.text().length)},e=X(d,L);e.destroy=function(){this.unload();L.prototype.destroy.call(this)};e.unload=function(){c(this,null,null)};e.text=function(a){if(void 0!==a){var b=this._anchor||this;b.destroyChildren();b.dom.textContent=a}return this.dom.textContent};e.textNode=function(){return(this._anchor||this).dom.firstChild};e.createSplit=function(a){var b=new d("span",this.acc,a);this.copyDataTo(b);var c=this.text(),e=a-this.acc;b.text(c.substring(0,e));this.text(c.substring(e));
this.acc=a;this._changed=!0;return b};e.mergeSplit=function(a){var b=this.text()+a.text();this.text(b);this.accend=a.accend;this._changed=!0;a.destroy()};e.dataEquals=function(a){var b=!1,c=this._data;a=a._data;if(!c)b=!a;else if(a&&c.length==a.length)for(var b=!0,d=0;d<c.length;d++){var e=c[d],r=a[d];if(e.type!==r.type||e.id!==r.id){b=!1;break}}return b};e.addData=function(a){this._data||(this._data=[]);"hyperlink"===a.type?this._data.unshift(a):this._data.push(a);this._changed=!0};e.changeData=
function(a){if(this._data)for(var b=0;b<this._data.length;b++){var c=this._data[b];if(c.type===a.type&&c.id===a.id){this._data[b]=a;this._changed=!0;break}}};e.removeData=function(a,c){if(this._data)for(var b=0;b<this._data.length;b++){var d=this._data[b];if(d.type===a&&d.id===c){this._data.splice(b,1);0===this._data.length&&delete this._data;this._changed=!0;break}}};e.copyDataTo=function(a){this._data&&(a._data=a._data?a._data.concat(this._data):this._data.slice(0),a._changed=!0)};e.moveDataTo=
function(b){this._data&&(a(this,null,null,null,null),b._data=b._data?b._data.concat(this._data):this._data,delete this._data,this._changed=!0,b._changed=!0)};e.updateData=function(){if(this._changed){var b=null,c=null,d=null,e=null,l=void 0;if(this._data)for(var r=0,m=0;m<this._data.length;m++){var p=this._data[m];if("style"===p.type){if(p.className&&(e||(e=[]),e.push(p.className)),p.props)for(var z in p.props)if(p.props.hasOwnProperty(z)){var q=p.props[z];if("background-color"==z){var w=p.priority||
0;void 0===l||w>l?(l=w,r=1,d||(d={}),d[z]=q):w==l&&(d[z]=Yb(q,d[z],r,!0),r++)}else d||(d={}),d[z]=q}}else"hyperlink"===p.type?b=p:"bookmark"===p.type&&(c=p)}a(this,d,e,b,c);this._changed=!1}};var a=function(a,d,e,v,l){d?(d=Fc(d),d!=a._splitClass&&(a._splitClass&&a.removeClass(a._splitClass),a.addClass(d),a._splitClass=d)):a._splitClass&&(a.removeClass(a._splitClass),delete a._splitClass);a._appliedClasses&&(a.removeClass(a._appliedClasses),delete a._appliedClasses);e&&(a.addClass(e),a._appliedClasses=
e);c(a,v,l)},c=function(a,c,d){var b=a._anchor;if(c){var e=c&&0===c.url.indexOf("#");b||(b=e?a._anchor=y.create("span"):a._anchor=y.create("a"),b.text(a.text()),a.html(""),a.append(b));c&&(a.addClass("oit-hyperlink"),e||b.attr("href",c.url),Dc.on.addElement(b,c));d&&b.attr("id",d.id)}else d?a.attr("id",d.id):b&&(Dc.on.removeElement(b),c=b.text(),b.destroy(),delete a._anchor,a.removeClass("oit-hyperlink"),a.html(c))};return d}(),fd=function(){var d=RegExp("^[^\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]*?[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]"),
e=function(a,b,c){mb.call(this,a,b);this._origin=c},a=X(e,mb);a.unload=function(){this.discardLayout();pa(this._splits,"unload");mb.prototype.unload.call(this)};a.discardLayout=function(){delete this._charRects;delete this._spanRect};a.distanceFromPoint=function(a,b){var c=this.findClosestChar(a,b);if(c)return c.distance};a.overlapRange=function(a){var b=this.spanRect();if(b.overlaps(a)){if(a.contains(b))return fa(this.acc,this.accend);if(b=f(this)){for(var c,d,e=0;e<b.length;e++)a.overlaps(b[e])&&
(d=this.acc+e,void 0===c&&(c=d),d+=1);if(void 0!==c)return fa(c,d)}}};a.spanRect=function(){var a=this._spanRect;a||(a=B.elementRect(this,this._origin),0<a.width&&0<a.height&&(this._spanRect=a));return a};a.textAngle=function(){void 0===this._angle&&(this._angle=this.ancestorData("angle"),this._angle=void 0!==this._angle?Number(this._angle)*Math.PI/180:0);return this._angle};a.rtl=function(){void 0===this._rtl&&(this._rtl=!!d.test(this.text()));return this._rtl};a.findClosestChar=function(a,b){var c=
f(this),d,e,k;for(d=0;d<c.length;d++){var z=Math.abs(c[d].distanceFrom(a,b,"left","middle"));if(void 0===e||z<k)e=d,k=z,d==c.length-1&&(z=c[d].distanceFrom(a,b,"center","none"),0<z&&e++)}var q,v;if(this._splits){c=this._splits;for(d=z=0;d<c.length;d++){var V=c[d].textNode(),T=z+V.textContent.length;if(e>=z&&e<T){q=V;v=e-z;break}z=T}q||(q=c[c.length-1].textNode(),v=q.textContent.length)}else q=this.textNode(),v=e;return{node:q,offset:v,acc:this.acc+e,distance:k}};a.textRect=function(a){var b=this.spanRect();
if(this.hasClass("oit-hiddentext"))return new ga(b);if(0===b.width||0===b.height)return null;if(!a||a.acc<=this.acc&&a.accend>=this.accend)return new ga(b);if(a.acc<this.accend&&a.accend>this.acc&&(b=f(this))){var c=a.acc-this.acc;0>c&&(c=0);var d=a.accend-this.acc;d>b.length&&(d=b.length);a=new ga(b[c],this._origin);d==c&&(a.width=0);for(c+=1;c<d;c++)a.union(b[c]);return a}};a.findTextRange=function(a,b){var c,d,e,f,k=this._splits;if(k){if(a.acc<=this.acc&&(c=k[0].textNode(),d=0),a.accend>=this.accend&&
(e=k[k.length-1].textNode(),f=e.textContent.length),!c||!e)for(var q=0;q<k.length;q++){var v=k[q];if(a.accend<v.acc)break;if(!c&&a.acc<v.accend&&(c=v.textNode(),d=a.acc-v.acc,0>d&&(d=0),e))break;if(c&&!e&&a.accend<=v.accend){e=v.textNode();f=a.accend-v.acc;0>f&&(f=0);break}}}else c=e=this.textNode(),d=0,a.acc>this.acc&&(d+=a.acc-this.acc),f=this.text().length,a.accend<this.accend&&(f-=this.accend-a.accend);k=Y.createRange();k.setStart(c,d);k.setEnd(e,f);b.push(k)};var c=function(a,b,c,d){c._charRects.push(new ga(a.rect(d),
d))},b=function(a,c,d,e,f,p){var k;a=y.unwrap(a);if(3==a.nodeType){var m=a.textContent.length;for(k=0;k<m;k++){f.setStart(a,k);f.setEnd(a,k+1);var l=f.getBoundingClientRect(),l=new ga(l.left-e.left,l.top-e.top,l.right-e.left,l.bottom-e.top,d);l.origin=c._origin;p.push(l)}}else for(k=0;k<a.childNodes.length;k++)b(a.childNodes[k],c,d,e,f,p)},f=function(a){if(!a._charRects){var d=Y.createRange?Y.createRange():null;if(d&&d.getBoundingClientRect)try{var e,f;a._origin instanceof L&&!(a._origin instanceof
cb)?(e=a._origin,f=e.rect()):(e="view",f=w.viewNode.rect());var k=[];b(a,a,e,f,d,k);a._charRects=k}catch(q){}if(!a._charRects){f=a.text();e=new L;e.transferFrom(a);k=[];for(d=0;d<f.length;d++){k.push("<span>");k.push(f[d]);if(d+1<f.length){var p=f.charCodeAt(d),z=f.charCodeAt(d+1);1536<=p&&1791>=p&&1536<=z&&1791>=z&&k.push("&zwj;")}k.push("</span>")}a.html(k.join(""));a._charRects=[];a.forChildElements(c,a,a._origin);d=new ga(a.rect(a._origin),a._origin);a.html("");a.transferFrom(e);f=a.spanRect();
if(f.width!=d.width&&(e=f.width/d.width,!Zb(e,1)))for(f=f.left,d=0;d<a._charRects.length;d++)k=a._charRects[d],p=(k.left-f)*e+f,k.move(p,void 0,p+k.width*e,void 0)}}return a._charRects};a.createSplit=function(){var a=new mb("span",this.acc,this.accend);this.moveDataTo(a);a.transferFrom(this);return a};a.updateData=function(){var a=this._splits;a?pa(a,"updateData"):mb.prototype.updateData.call(this)};a.split=function(a){if(!a)return this._splits;if(!this._splits){if(a.acc<=this.acc&&a.accend>=this.accend||
this.hasClass("oit-hiddentext"))return[this];var b=this.createSplit();this.append(b);this._splits=[b]}for(var b=this._splits,c=[],d=0;d<b.length;d++){var e=b[d],f;if(!(a.acc>=e.accend)){if(a.accend<=e.acc)break;a.acc>e.acc&&(f=e.createSplit(a.acc),b.splice(d++,0,f),this.insert(f,e));a.accend<e.accend&&(f=e.createSplit(a.accend),b.splice(d++,0,f),this.insert(f,e),e=f);c.push(e)}}return c};a.join=function(){var a=this._splits;if(a){for(var b,c=a[a.length-1],d=a.length-2;0<=d;d--)b=a[d],b.dataEquals(c)&&
(b.mergeSplit(c),a.splice(d+1,1)),c=b;1==a.length&&(b=a[0],b.moveDataTo(this),this.text(b.text()),b.destroy(),delete this._splits)}};a.addDataToRange=function(a,b){var c=this.split(a);c&&(pa(c,"addData",null,b),this.join(),this.updateData(),"hyperlink"===b.type&&f(this))};a.changeData=function(a){mb.prototype.changeData.call(this,a);pa(this._splits,"changeData",null,a);this.updateData()};a.removeData=function(a,b){mb.prototype.removeData.call(this,a,b);pa(this._splits,"removeData",null,a,b);this.join();
this.updateData()};return e}(),Hc=function(){var d=function(a,c){this._page=a;this._contentRoot=c||a;this._spans=[];for(var b,d=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),e=d.firstACCNode();e;){var e=d.currentNode,v=y.data(e,"acc");v&&(b=Number(v));for(var v=!0,l=e.firstChild;l;l=l.nextSibling)if(3==l.nodeType){v=!1;break}v||void 0===b?e=d.nextACCNode():(b=new fd(e,b,this._contentRoot),this._spans.push(b),b=b.accend,(e=d.skipNode())&&(e=d.firstACCNode()))}this._layoutSettings={};
if(!a.checkedACCRange){if(d=this.getTextRange())d.acc<a.acc&&(a.acc=d.acc),d.accend>a.accend&&(a.accend=d.accend);a.checkedACCRange=!0}},e=X(d);e.destroy=function(){pa(this._spans,"unload");this.deleteAll()};e.discardLayout=function(){pa(this._spans,"discardLayout")};e.getTextRange=function(){for(var a,c=0;c<this._spans.length;c++){var b=this._spans[c];a?(b.acc<a.acc&&(a.acc=b.acc),b.accend>a.accend&&(a.accend=b.accend)):a=fa(b.acc,b.accend)}return a};e.textRanges=function(){for(var a=[],c,b=this._page.isEmailHeader(),
d=0;d<this._spans.length;d++){var e=this._spans[d];!b&&c&&c.accend+1>=e.acc?e.accend>c.accend&&(c.accend=e.accend):(c=fa(e.acc,e.accend),a.push(c))}return a};e.mapPointToSpan=function(a,c,b){if(0<this._spans.length){var d,e,v,l;this._page.pushShow();var r=[],m;for(l=0;l<this._spans.length;l++)if(v=this._spans[l],!v.hasClass("oit-hiddentext")&&(!b||v.equals(b)||v.isDescendantOf(b))&&(e=v.spanRect())&&0<e.width&&0<e.height){e=c<e.top?e.top-c:c>e.bottom?c-e.bottom:0;if(void 0===m||e<m)r.length=0,m=e;
e==m&&r.push(v)}m=void 0;if(1==r.length)d=r[0];else for(l=0;l<r.length;l++)if(v=r[l],e=Math.abs(v.distanceFromPoint(a,c)),void 0===m||e<m)d=v,m=e;this._page.popShow();return d}};e.findOverlappingText=function(a){if(0<this._spans.length){var c=[];this._page.pushShow();for(var b=0;b<this._spans.length;b++){var d=this._spans[b].overlapRange(a);d&&c.push(d)}this._page.popShow();if(0<c.length)return c}};e.findRange=function(a,c){for(var b=[],d=0;d<this._spans.length;d++){var e=this._spans[d];e.acc<=c&&
e.accend>a&&b.push(e)}if(0<b.length)return b};e.findACC=function(a){for(var c=[],b=0;b<this._spans.length;b++){var d=this._spans[b];a>=d.acc&&a<d.accend&&c.push(d)}if(0<c.length)return c};return d}(),cb=function(){var d=/\S/,e=function(a,b,c){var d=Y.getElementById(c);d?L.call(this,d):L.call(this,"div","oit-section oit-"+b+" oit-pending",c);this.prop("index",a);this.data("page",this);this._needArrange=!0;this._staticContent=!!this.firstChildElem()},a=X(e,L);a.processData=function(a){var b=this.isEmailHeader(),
d={},e=!1,g=!1,h;for(h in a){var f=a[h],u=null,k=!1;switch(h){case "embeds":case "frames":case "fields":case "attachments":case "comments":u="_"+h;break;case "data":case "src":u="_"+h+"URL";break;case "section":case "name":case "type":case "dpi":case "autodpi":case "hiddenFromSlideshow":u=h;break;case "acc":case "accend":u=h;k=!0;break;case "w":b||this.css("width",f);u="width";f=parseInt(f,10);k=!0;break;case "h":b||this.css("height",f);u="height";f=parseInt(f,10);k=!0;break;case "oid":(f=B.overlayById(a.oid))&&
f!==this.overlay&&(u="overlay",g=!0);break;case "background":this.css("background",f)}u&&!this.hasOwnProperty(u)&&(d[u]={value:f,writable:k,enumerable:!1},e=!0)}"sn"!==this.type||this.width||(b=B.page(this.index-1))&&b.width&&(d.width={value:b.width,writable:!1,enumerable:!1},e=!0,this.css("width",b.css("width")),D.layoutChanged());e&&Object.defineProperties(this,d);g&&this.overlay.add(this);a.content&&!this.isLoaded()&&(!0===this.deferContent?this.deferredContent=a.content:c(this,a.content));!this._ssmodel&&
a.ssdata&&(this._ssmodel=new gd(a.ssdata,this._embeds,this));if(a.comments){if(this.supportsAnnotations()){e=d=!1;ha.infoRaw();for(g=0;g<a.comments.length;g++)b=a.comments[g],b.range&&b.text?d=!0:e=!0;d&&F.hiddenContent("comments");e&&F.hiddenContent("comments-unsupported")}else F.hiddenContent("comments-unsupported");this.overlay.hasAnnotations(!0)}"sn"===a.type&&F.hiddenContent("speaker-notes");a.hiddenFromSlideshow&&F.hiddenContent("hidden-slides");a.hidden_columns&&F.hiddenContent("hidden-columns");
a.hidden_rows&&F.hiddenContent("hidden-rows");this._staticContent&&(r(this,!1),V(this))};a.supportsAnnotations=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":case "worksheet":case "database":return!0}return!1};a.supportsAnnotationPane=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":return!0}return!1};a.supportsAnnotationBar=function(){switch(this.type){case "worksheet":case "database":return!0}return!1};
var c=function(a,b){var c=y.create("div");c.html(b);var d=c.byClass("oit-view");if(d&&0<d.length)for(c=0;c<d.length;c++){var e=d[c].byClass("oit-section");if(e)for(var g=0;g<e.length;g++){var h=e[g],f=B.pageById(h.id);f&&!f.firstChildElem()&&(w.baseURL&&m(h),f.transferFrom(h),f.addClass(h.attr("class")))}}else w.baseURL&&m(c),a.transferFrom(c),a._needArrange=!0};a.destroy=function(){this.unload();L.prototype.destroy.call(this)};a.unload=function(){var a=this.isLoaded();this.abortLoad();this._needArrange=
!0;this._selRect&&(this._selRect.destroy(),delete this._selRect);this._ssmodel&&(this._ssmodel.unload(),delete this._ssmodel);this._spanMap&&(this._spanMap.destroy(),delete this._spanMap);this._annotationPane&&(this._annotationPane.destroy(),delete this._annotationPane);0<this.loadedSize&&(this.pageContentChanged(),this.html(""),this.addClass("oit-pending"),this.loadedSize=0);this.logUnload&&this.logUnload();a&&B.on.pageunload.dispatch(this)};a.show=function(a){var b;if(this.isHidden()){a=a||{};this.finishAnimation();
a.animate&&this.css("opacity",0);if(!this.parent()){var c;if(!a.insertLast)for(var d=this.index+1;;d++){b=B.page(d);if(!b||b.overlay!==this.overlay)break;if(!b.isHidden()){c=b;break}}c?this.overlay.insert(this,c):this.overlay.append(this);this._annotationPane&&this._annotationPane.show()}a.animate?(void 0===a.time&&(a.time=a.animate?150:0),a.opacity=1,this.animate(a)):a&&a.endFn&&a.endFn();"vertical"===x.scrollMode&&(b=B.page(this.index+1))&&"sn"===b.type&&x.showSlideNotes&&b.show()}else a&&a.endFn&&
a.endFn();return this};a.hide=function(){var a=y.unwrap(this).parentNode;a&&(this.finishAnimation(),a.removeChild(this.dom),this._annotationPane&&this._annotationPane.hide(),"vertical"===x.scrollMode&&(a=B.page(this.index+1))&&"sn"===a.type&&a.hide());return this};a.pushShow=function(){this._showState?this._showState.count++:(this._showState={count:1},this.parent()||(this._showState.pageHidden=!0,this.show(),this._annotationPane&&this._annotationPane.show()),this.overlay.isDisplayed()||(this._showState.overlayUndisplayed=
!0,this.overlay.display()),this.overlay.isHidden()&&(this._showState.overlayHidden=!0,this.overlay.show()),"none"===this.computedStyle().display&&(this._showState.pageDisplayNone=!0,this.css("display","block")))};a.popShow=function(){this._showState&&(this._showState.count--,0>=this._showState.count&&(this._showState.pageDisplayNone&&this.css("display",null),this._showState.overlayHidden&&this.overlay.hide(),this._showState.overlayUndisplayed&&this.overlay.undisplay(),this._showState.pageHidden&&
(this.hide(),this._annotationPane&&this._annotationPane.hide()),delete this._showState))};a.isHidden=function(){return this._hidden||!this.parent()||!this.overlay||this.overlay.isHidden()||!this.overlay.isDisplayed()};a.filter=function(a){return a!==this.index};a.info=function(){var a={page:this.index,type:this.type,typeEx:this.type,features:Fa.features(this.type),comments:!!this._annotationPane};if("slide"==a.type){var b=B.page(this.index+1);b&&"sn"===b.type?a.notes=!0:y.byId(this.id+".note")?a.notes=
!0:a.notes=!1}else"rt"==a.type?(0<this.index&&"email"==B.page(this.index-1).type&&(a.type="email"),"rt"==a.type&&(a.type="html")):"sn"==a.type&&(a.type="slide",a.notes=!0);void 0!=this.hiddenFromSlideshow&&(a.hiddenFromSlideshow=this.hiddenFromSlideshow);void 0!==this.acc&&(a.acc=this.acc,void 0!==this.accend&&(a.accend=this.accend));this.width&&this.height&&(a.width=this.width,a.height=this.height);return a};a.features=function(){return Fa.features(this.type)};a.isEmailHeader=function(){return this.hasClass("oit-emailheaderpage")||
"emailheader"===this.id||"emailheader.1"===this.id};a.isPending=function(){return this.hasClass("oit-pending")};a.isLoading=function(){return this.hasClass("oit-loading")};a.isLoaded=function(){return!this.hasClass("oit-pending")&&!this.hasClass("oit-loading")};a.isEnabled=function(){return"slideshow"!=x.presentationMode?!0:"slide"!=this.type||!this.hiddenFromSlideshow};a.mapPointToText=function(a,b,c,d){var e;d?e=this.annotationPane().mapPointToSpan(a,b,c):(d=this.getSpanMap())&&(e=d.mapPointToSpan(a,
b,c));if(e){var g=e.textAngle();c=e.spanRect();d=c.left;var h=c.top,f=c.right,t=c.bottom;if(0!==g){c=[{x:d,y:h},{x:f,y:h},{x:f,y:t},{x:d,y:t}];d=Math.cos(g);h=Math.sin(g);for(f=0;f<c.length;f++)t=c[f].x-a,g=c[f].y-b,c[f].x=a+t*d+g*h,c[f].y=b+-t*h+g*d;d=f=c[0].x;h=t=c[0].y;for(g=1;4>g;g++){var A=c[g];A.x<d?d=A.x:A.x>f&&(f=A.x);A.y<h?h=A.y:A.y>t&&(t=A.y)}}e=e.findClosestChar(a,b);e.overlaps=a>=d-2&&a<=f+2&&b>=h-2&&b<=t+2;return e}};a.findTextBoundary=function(a,b,c){a=Hb(a);if(ja&&void 0!==a&&(a+=b,
b=ja.findBoundaryStart(a,c),c=ja.findBoundaryEnd(b,c),void 0!==b&&void 0!==c)){c=fa(b,c);if(this._frames){var d,e;for(b=0;b<this._frames.length;b++){var g=this._frames[b];a>=g.acc&&a<g.accend&&(void 0===d?(d=g.acc,e=g.accend):(g.acc<d&&(d=g.acc),g.accend>e&&(e=g.accend)))}c.acc<d&&(c.acc=d);c.accend>e&&(c.accend=e)}if(d=this.findTextRange(c))return dc(d)}};a.resetCache=function(){delete this._cachedRects;if(this._annotationPane)this._annotationPane.onResize(!0)};var b=function(a){var b=a._cachedRects;
b||(b=a._cachedRects={});var c=w.viewNode,d=c.clientWidth,e=c.clientHeight,g=c.scroll(),c=g.left,g=g.top,h=a.offsetLeft;a=a.offsetTop;var f=x.zoom,u=x.rotation;if(b.viewWidth!=d||b.viewHeight!=e||b.scrollLeft!=c||b.scrollTop!=g||b.offsetLeft!=h||b.offsetTop!=a||b.zoom!=f||b.rotation!=u)b.view=null,b.overlay=null,b.pos=null,b.viewWidth=d,b.viewHeight=e,b.scrollLeft=c,b.scrollTop=g,b.offsetLeft=h,b.offsetTop=a,b.zoom=f,b.rotation=u;return b};a.pageRect=function(a){var c=b(this);if("view"===a||"overlay"===
a){var d=c[a];d||((d=D.pageRect(this.index,a))&&d.readonly(!0),c[a]=d);return d}c.page||(c.page=D.pageRect(this.index,this));return c.page};a.pagePos=function(a){if("overlay"===a)return a=b(this),a.pos||(a.pos=this.pos(this.overlay)),a.pos;if("view"===a){a=this.pagePos("overlay");a={left:a.left,top:a.top};var c=D.padding();c&&(a.left+=c.left,a.top+=c.top);if(c=D.scrollOffset())a.left-=c.left,a.top-=c.top;return a}};a.inAnnotation=function(a){var b=!1;this._annotationPane&&"text"===a.type&&(this.findRange(a.acc,
a.accend,"page")||this._annotationPane.findRange(a.acc,a.accend)&&(b=!0));return b};a.containsRange=function(a){if("text"!==a.type)return a.page==this.index;var b=!1,c;if(a.acc<=this.accend&&a.accend>=this.acc){switch(this.type){case "worksheet":case "database":(b=this.spreadsheetModel())&&!b.hasPendingContent()?(b=b.containsRange(a.acc,a.accend),b||(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)))):b=!0;break;default:if(this._frames)for(c=
0;c<this._frames.length;c++){var d=this._frames[c];if(a.acc<=d.accend&&a.accend>=d.acc){b=!0;break}}!b&&this.isLoaded()&&(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)));b||this._frames||this.isLoaded()||(b=!0)}!b&&this._comments&&(b=B.isAnnotationText(a.acc,a.accend,this._comments))}return b};var f=function(a,b){return a.acc-b.acc},k=function(a,b){if(b&&0<b.length){b.sort(f);for(var c=[],d,e=a.isEmailHeader(),g=0;g<b.length;g++){var h=b[g];
void 0!==h.acc&&(!e&&d&&d.accend+1>=h.acc?h.accend>d.accend&&(d.accend=h.accend):(d=fa(h.acc,h.accend),c.push(d)))}return c}};a.mapRectRangeToText=function(a){if("rect"===a.type){var b=this.getSpanMap();if(b)return a=new ga(a,this),k(this,b.findOverlappingText(a))}};a.textRanges=function(){var a=this.getSpanMap();if(a)return k(this,a.textRanges())};a.mapRangeToEmbeds=function(a){var b;if(this._embeds&&("rect"===a.type||"cell"===a.type)&&(a=D.rangeRect(a,this)))for(var c=0;c<this._embeds.length;c++){var d=
this._embeds[c],e=this.embeddingRect(d.uid);if(e&&e.overlaps(a)){var g=e.left,h=e.top;e.intersect(a);e.offset(-g,-h);b||(b=[]);d=lb(d.uid,this.index,e.left,e.top,e.right,e.bottom);za(d,"pct");b.push(d)}}return b};a.embeddingByIndex=function(a){var b;this._embeds&&0<=a&&a<this._embeds.length&&(b=this._embeds[a]);return b};a.embeddingByUID=function(a){var b;this._embeds&&(b=kb(this._embeds,"uid",a));return b};a.embeddingRect=function(a){if(this._embeds&&(a=kb(this._embeds,"uid",a))){var b;if(a.position)b=
a.position,b=new ga(b.left,b.top,b.right,b.bottom,this);else{var c=a.x,d=a.y;if(void 0===c||void 0===d){var e=y.byId(a.id);e&&(e=B.elementRect(e,this),void 0===c&&(c=e.left),void 0===d&&(d=e.top))}void 0!=c&&void 0!=d&&(b=new ga(c,d,c+a.w,d+a.h,this))}return b}};a.textBoundingRect=function(a,b){if(this.isLoaded()&&"text"===a.type){var c;if(this.isSpreadsheet())B.activeOverlay()==this.overlay&&(c=D.rangeRect(a,this));else{this.pushShow();var d=this.findRange(a.acc,a.accend,b);if(d&&0<d.length){for(var e=
va(d[0]),g=0;g<d.length;g++){var h=d[g].textRect(a);if(h){var f=va(d[g]);y.unwrap(f)===y.unwrap(e)&&(c?c.union(h):c=h)}}c||1!=d.length||(c=d[0],e=da(a),e.accend==c.acc&&e.accend++,c=d[0].textRect(e))}this.popShow()}return c}};a.frameForRange=function(a){var b;if(this.isLoaded()&&this._frames&&"text"===a.type)for(var c=0;c<this._frames.length;c++){var d=this._frames[c];if(a.accend>=d.acc&&a.acc<d.accend){b=y.byId(d.id);break}}return b};a.textRects=function(a,b,c){if(c||"text"!==a.type)Array.isArray(c)&&
(c=c.slice());else{if(this.isSpreadsheet()&&B.activeOverlay()==this.overlay){var d=D.rangeRect(a,b);d&&(e=[new ec(d)])}c=this.findRange(a.acc,a.accend)}if(c&&0<c.length){var e;this.pushShow();c.sort(function(a,b){var c=a.spanRect(),d=b.spanRect(),e=c.top-d.top;e||(e=c.left-d.left);return e});for(var g,h=[],d=0;d<c.length;d++){var f=c[d].textRect(a);f&&(g&&Zb(f.top,g.top)&&Zb(f.bottom,g.bottom)&&f.left<=g.right+1?g.union(f):(g=f,h.push(g)))}this.popShow();if(0<h.length)for(e||(e=[]),a=new ec(h[0]),
e.push(a),d=1;d<h.length;d++)if(c=h[d],8>c.width||8>c.height)a.add(c);else{for(var f=c.left-5,t=c.right+5,u=c.top-2,n=c.bottom+2,C=a.length-1;0<=C;C--)if(g=a.item(C),t>=g.left&&f<=g.right&&n>=g.top&&u<=g.bottom){a.add(c);c=null;break}c&&(a=new ec(c),e.push(a))}e&&("overlay"!==b&&"view"!==b||pa(e,"convert",null,b));return e}};a.accRect=function(a,b){var c,d=fa(a,a+1);if(this.isSpreadsheet())c=D.rangeRect(d,b);else{var e=this.findACC(a);if(e&&0<e.length){this.pushShow();for(var g=va(e[0]),h=0;h<e.length;h++){var f=
e[h].textRect(d);if(f){var t=va(e[h]);y.unwrap(t)===y.unwrap(g)&&(c?c.union(f):c=f)}}c&&(c.origin=b);this.popShow()}}return c};a.findTextRange=function(a){if("text"===a.type&&a.acc<=this.accend&&a.accend>=this.acc&&this.isLoaded()){var b=[],c=!1;if(this._frames&&"email"!==this.type)for(var d=0;d<this._frames.length;d++){var e=this._frames[d];if(a.acc<=e.accend&&a.accend>=e.acc)if((e=Y.getElementById(e.id))&&0===e.childNodes.length){var g=Y.createRange();g.setStart(e,0);g.setEnd(e,0);b.push(g)}else c=
!0}else c=!0;c&&(c=a.acc===a.accend?this.findACC(a.acc):this.findRange(a.acc,a.accend))&&pa(c,"findTextRange",null,a,b);if(0<b.length)return b}};a.layer=function(a){if(this.overlay)return this.selectionRect(),this.overlay.layer(a)};a.hasSelectionRect=function(){return!!this._selRect};a.selectionRect=function(){if(!this._selRect){var a=this.overlay?this.overlay.layer("selection"):void 0;this._selRect=new sb(this.index,a,"oit-sel-rect");this._selRect.hide()}return this._selRect};a.showSelectionRect=
function(a){this._selRect&&this._selRect.show(a)};a.findRange=function(a,b,c){var d;c=c||"all";if("all"===c||"page"===c){var e=this.getSpanMap();e&&(d=e.findRange(a,b))}!this._annotationPane||"all"!==c&&"annotations"!==c||(a=this._annotationPane.findRange(a,b))&&(d=d?d.concat(a):a);return d};a.findACC=function(a){var b,c=this.getSpanMap();c&&(b=c.findACC(a));this._annotationPane&&(a=this._annotationPane.findACC(a))&&(b=b?b.concat(a):a);return b};a.pageContentChanged=function(){delete this._cachedRects;
this._spanMap&&(this._spanMap.destroy(),delete this._spanMap)};a.pageLayoutChanged=function(){delete this._cachedRects;this._spanMap&&this._spanMap.discardLayout();if(this._annotationPane)this._annotationPane.onResize(!0)};a.isSpreadsheet=function(){return this._ssmodel||this._dataURL};a.spreadsheetModel=function(){return this._ssmodel};a.getSpanMap=function(){void 0===this._spanMap&&this.isLoaded()&&(this.isSpreadsheet()?this._spanMap=null:this._spanMap=new Hc(this));return this._spanMap};var v=
function(a){if(a.showProgressDialog&&void 0!==a.srcSize&&void 0!==a.dataSize){var b=a.srcSize+a.dataSize;262144<=b&&(b=100*(a.srcLoaded+a.dataLoaded)/b,a.progressDialog||(a.progressDialog=Ga.createProgressDialog(R.PLEASE_WAIT_INITIALIZING,!0)),a.progressDialog&&a.progressDialog.update(b))}},l=function(a){if(void 0===a.srcRequest&&void 0===a.dataRequest&&a.isLoading()){a.logLoad&&a.logLoad();a.removeClass("oit-loading");a.pageContentChanged();B.touchPage(a.index);a.loadedSize=0;a.dataSize&&(a.loadedSize+=
a.dataSize);a.srcSize&&(a.loadedSize+=a.srcSize);B.applyMemoryLimit(a.loadedSize);a.deferredContent&&(c(a,a.deferredContent),delete a.deferredContent,delete a.deferContent);r(a,!0);a.progressDialog&&(a.progressDialog.hide(),delete a.progressDialog);delete a.showProgressDialog;if(a.completionFuncs){for(var b=0;b<a.completionFuncs.length;b++)a.completionFuncs[b](a);delete a.completionFuncs}delete a.locked;V(a)}},r=function(a,b){var c;a&&"email"==a.type&&(c=a.childByClass("oit-emailheader"),c||(c=a.byId("oit-emailheader"))&&
c.addClass("oit-emailheader"),c&&(a.addClass("oit-emailheaderpage"),c=new hd(c),a._emailHeader=c));(c=a.childByClass("oit-email_page"))&&!c.firstChildElem()&&c.css("display","none");if("sn"===a.type){c=y.create("div","oit-noteheader");c.html('<span class="oit-notesicon"></span><span class="oit-unselectable"> '+R.NOTES+"</span>");var d=a.firstChildElem();d.addClass("oit-sn-content");a.insert(c,d)}a.hiddenFromSlideshow&&(c=y.create("div","oit-hiddenpage"),c.attr("title",R.HIDDEN_SLIDE),a.append(c));
u(a,a._comments);a.processRevisions();a.processSSRevisions();a.positionAnnotations();B.on.pageload.dispatch(a,!!b)},m=function(a){a=y.wrap(a);if(w.baseURL){a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT);for(var b;b=a.nextNode();)if("IMG"===b.tagName){var c=b.getAttribute("src");c&&("/"!=c.charAt(0)&&(c=Ka(w.baseURL,c)),b.setAttribute("src",c))}else"image"===b.tagName&&(c=b.getAttribute("xlink:href"))&&("/"!=c.charAt(0)&&(c=Ka(w.baseURL,c)),b.setAttribute("xlink:href",c))}};a.abortLoad=function(){this.isLoading()&&
(this.srcRequest&&(db(this.srcRequest),delete this.srcRequest),this.dataRequest&&(db(this.dataRequest),delete this.dataRequest),this.removeClass("oit-loading"),this.addClass("oit-pending"))};a.load=function(a,b){var c=this.isPending(),d=this.isLoading();(c||d)&&(this._srcURL||this._dataURL)?d?b&&this.completionFuncs.push(b):(this.srcLoaded=this.srcSize=this.dataLoaded=this.dataSize=0,this.completionFuncs=[],b&&this.completionFuncs.push(b),this.removeClass("oit-pending"),this.addClass("oit-loading"),
this.locked=!0,!0===a&&(this.showProgressDialog=!0),c=w.baseURL,this._dataURL&&(d=this._dataURL,c&&"/"!=d.charAt(0)&&(d=Ka(c,d)),this.dataRequest=Ia({url:d,context:this,loading:p,complete:z})),this._srcURL&&(d=this._srcURL,c&&"/"!=d.charAt(0)&&(d=Ka(c,d)),this.srcRequest=Ia({url:d,context:this,loading:q,complete:G}))):(c&&(this.removeClass("oit-pending"),r(this,!1)),b&&b(this))};var p=function(a,b,c){this.dataSize=b;c&&(this.dataLoaded=c.length);v(this)},z=function(a,b,c,d){this.dataSize=b;c&&(this.dataLoaded=
c.length,v(this));if(200===d)try{var e=JSON.parse(c);this.processData({ssdata:e})}catch(W){this.logAJAXError(null,"The data for page "+(this.index+1)+" is corrupt",a,d,c)}else this.logAJAXError(null,"Failed to load the data for page "+(this.index+1)+" from the server",a,d,c);delete this.dataRequest;l(this)},q=function(a,b,c){this.srcSize=b;c&&(this.srcLoaded=c.length);v(this)},G=function(a,b,c,d){this.srcSize=b;c&&(this.srcLoaded=c.length,v(this));200===d?(this.deferContent=!0,Z.isICD(c)?Z.processICD(c,
a,d):this.processData({content:c})):this.logAJAXError(null,"Failed to load the content for page "+(this.index+1)+" from the server",a,d,c);delete this.srcRequest;l(this)},V=function(a){var b=ha.infoRaw();if(b&&1557===b.fi){var c=(b=a.firstChildElem())?b.firstChildElem():null,d=c?c.nextSiblingElem():null,e=d?d.nextSiblingElem():null,g=e?e.nextSiblingElem():null,h=c?c.firstChildElem():null,f=h?h.firstChildElem():null,u=d?d.firstChildElem():null,k=e?e.firstChildElem():null,n=k?k.firstChildElem():null,
C=n?n.firstChildElem():null,m=C?C.firstChildElem():null;if(f&&!f.nextSiblingElem()&&u&&!u.nextSiblingElem()&&m&&!m.nextSiblingElem()){var z=k.size(),q=m.size(),p=!0;z&&q&&0<z.width&&0<z.height&&0<q.width&&0<q.height&&(p=q.height/z.height,p=.9<=q.width/z.width&&.9<=p);"DIV"==b.tagName&&b.hasClass("oit-svg")&&"DIV"==c.tagName&&c.hasClass("oit-svg-layer")&&"DIV"==d.tagName&&d.hasClass("oit-frame")&&"DIV"==e.tagName&&e.hasClass("oit-svg-layer")&&"svg"==h.tagName&&"rect"==f.tagName&&"DIV"==u.tagName&&
u.hasClass("oit-svg-text")&&"svg"==k.tagName&&"g"==n.tagName&&n.hasClass("oit-pagescale")&&"g"==C.tagName&&C.hasClass("oit-framescale")&&"image"==m.tagName&&!g&&p&&(a="#"+a.id.replace(".","\\.")+" .oit-svg-text",F.screenCSS(a+" div","color:rgba(0,0,0,0);"),F.screenCSS(a+" span","color:rgba(0,0,0,0);"),b.append(d))}}};a.comments=function(){return this._comments};var T=function(a,b){if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)T(a[c],b);else if(a.range&&"text"===a.range.type){if(void 0===b.acc||
a.range.acc<b.acc)b.acc=a.range.acc;if(void 0===b.accend||a.range.accend>b.accend)b.accend=a.range.accend}},J=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)J(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=ja.getRawText(a.range.acc,a.range.accend))},N=function(a){var b="";if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)b+=N(a[c]);else a.range&&"text"===a.range.type&&a.text&&(b=a.text);return b},E=function(a,b){if(a.isEmpty())b._annotationPane.destroy(),delete b._annotationPane;
else{b.supportsAnnotationBar()&&B.createAnnotationBar();var c=a.range();c&&(c.acc<b.acc&&(b.acc=c.acc),c.accend>b.accend&&(b.accend=c.accend));x.showAnnotations&&a.layout()}},h=function(a,b){a._annotationPane||(a._annotationPane=new id(a),x.showAnnotations?a._annotationPane.show():a._annotationPane.hide(),P.addAutoscrollRoot(a._annotationPane.scrollPane()));a._annotationPane.processAnnotations(b,E,a)},u=function(a,b,c){if(b&&a.supportsAnnotations()){for(var d={},e=0;e<b.length;e++){var g=b[e];T(g.text,
d);T(g.author,d);T(g.author_short,d);T(g.last_save_date,d);T(g.create_date,d);T(g.date,d)}void 0!==d.acc?ja.loadRawText(d.acc,d.accend,function(){for(var d=0;d<b.length;d++){var e=b[d];J(e.text);J(e.author);J(e.author_short);J(e.last_save_date);J(e.create_date);J(e.date)}c&&(b=c(a,b));h(a,b)}):(c&&(b=c(a,b)),h(a,b))}};a.processRevisions=function(){if(this.isLoaded()&&this.supportsAnnotations()){var a=F.revisions();if(a){for(var b=[],c=0;c<a.length;c++){var e=a[c];e.range&&this.findRange(e.range.acc,
e.range.accend,"page")&&b.push(e)}b.length&&u(this,b,function(a,b){for(var c=0;c<b.length;c++){var e=b[c],g=b[c-1];if(g&&e.range&&g.range&&("add"===e.type&&"delete"===g.type||"delete"===e.type&&"add"===g.type)){var h=N(e.author),f=N(g.author),u=N(e.last_save_date||e.create_date),t=N(g.last_save_date||g.create_date);h===f&&u===t&&(g.range.acc==e.range.acc&&g.range.accend==e.range.accend?"add"===g.type?b.splice(c-1,1):b.splice(c,1):(h=N(e.text),f=N(g.text),g.range.accend===e.range.acc&&d.test(h)&&d.test(f)&&
(h=b[c-1]={type:"change",id:e.id,author:e.author,last_save_date:e.last_save_date,create_date:e.create_date},"add"===e.type?(h.range=e.range,h.text=e.text,h.oldtext=g.text):(h.range=g.range,h.text=g.text,h.oldtext=e.text),b.splice(c,1))))}}return b})}}};a.processSSRevisions=function(){var a=B.ssRevisions();this._ssmodel&&a&&!this.processedSSRevisions&&(this.processedSSRevisions=!0,this._ssmodel.processRevisions(a,function(){u(this,this._ssmodel.revisions())},this))};a.positionAnnotations=function(){this._annotationPane&&
x.showAnnotations&&this._annotationPane.layout()};a.annotationPane=function(){return this._annotationPane};return e}(),Cc=function(){var d=function(a,c){var b={index:{value:a},length:{get:function(){return this.firstPage?this.lastPage.index-this.firstPage.index+1:0}}};c.name&&(b.name={value:c.name});c.hidden&&(b.hidden={value:!0},F.hiddenContent("hidden-pages"));Object.defineProperties(this,b);(b=Y.getElementById(c.oid))?L.call(this,b):(b="oit-overlay",c.cls&&(b=-1==c.cls.indexOf(b)?b+(" "+c.cls):
c.cls),L.call(this,"article",b,c.oid));w.viewNode.append(this);this.undisplay();this.hidden?this.hide():this.show()},e=X(d,L);e.updateCSS=function(){"text"!==x.selectionMode||Ga.modalOverlayVisible()?this.addClass("oit-unselectable"):this.removeClass("oit-unselectable");"rect"===x.selectionMode?this.css("cursor","crosshair"):this.css("cursor",null)};e.item=function(a){if(this.firstPage)return B.page(this.firstPage.index+a)};e.add=function(a){this.append(a);this.firstPage||(this.firstPage=a);this.lastPage=
a;if(!this.maxWidth||a.width>this.maxWidth)this.maxWidth=a.width;if(!this.maxHeight||a.height>this.maxHeight)this.maxHeight=a.height;this._pagesHidden&&a.hide()};e.containsPage=function(a){return B.page(a).overlay==this};e.display=function(){if(this.layers){var a=D.activeOverlay()===this;jb(this.layers,"show",null,a)}this.css("display","block");this.updateCSS()};e.undisplay=function(){this.layers&&jb(this.layers,"hide");this.css("display",null)};e.isDisplayed=function(){return"block"===this.css("display")};
e.show=function(){!1!==this._isHidden&&(this._isHidden=!1,B.on.overlayshow.dispatch(this))};e.hide=function(){!0!==this._isHidden&&(this._isHidden=!0,this.undisplay(),B.on.overlayhide.dispatch(this))};e.isHidden=function(){return void 0!==this._isHidden?this._isHidden:this.hidden};e.showPages=function(a){this.each("show",a);this._pagesHidden=!1};e.hidePages=function(a){this.each("hide",a);this._pagesHidden=!0};e.hasAnnotations=function(a){void 0!==a&&(this._hasAnnotations=!!a);return!!this._hasAnnotations||
!!F.revisions()};e.each=function(a,c){wb(this,arguments)};e.layer=function(a){var c;this.layers&&(c=this.layers[a]);c||(c=new ed(w.drawing,a,this.id+"."+a),this.layers||(this.layers={}),this.layers[a]=c);return c};return d}(),fb=function(){var d=function(a,b){this.id=a;this.range=da(b.range);this.type=b.type;b.style&&(this._style=b.style);b.cls&&(this._class=b.cls);b.comment&&(this._comment=b.comment);b.label&&(this._label=b.label);b.properties&&(this._properties=b.properties);b.options&&this.setOptions(b.options);
if(b.compound&&(this._compound=!0,Array.isArray(b.compound))){this._cRanges=[];for(var c=0;c<b.compound.length;c++){var d=da(b.compound[c]);"rect"===d.type&&za(d,"px");this._cRanges.push(d)}}this._pageInfo=[];"rect"===this.range.type&&(void 0!==this.range.embedId?za(this.range,"pct"):za(this.range,"px"));this.range=wa(this.range,!0);M.map(this)},e=X(d);e.isNote=function(){return!1};e.isRedaction=function(){return!1};e.isCompoundRedaction=function(){return!1};e.isEmptyRedaction=function(){return!1};
e.setRange=function(a){return void 0!==a&&0!==Sa(a,this.range)?("cell"==this.range.type&&this.eachPage(function(a,b){u(b,B.page(a.index))},null,this),M.unmap(this),this.range=da(a),M.map(this),delete this._cRanges,"text"==a.type&&this._compound&&(this._cRanges=[a]),this.updateStyle(),M.alignHighlight(),M.on.move.dispatch(this),!0):!1};e.updateStyle=function(){this._hidden||this.eachPage(a,null,this)};var a=function(a,b){var c=a.index;b.removeFromPage(a);b.addToPage(c)};e.filter=function(a){if(a){if("string"===
typeof a)return this[a]();if(a instanceof cb)return this.isOnPage(a.index);if(a instanceof Cc)return this.isInOverlay(a);if(!a(this.id,this._properties))return!1}return!0};e.properties=function(a){void 0!==a&&(this._properties=a);return this._properties};e.property=function(a,b){void 0!==b&&(this._properties||(this._properties={}),this._properties[a]=b);if(this._properties)return this._properties[a]};e.style=function(a){a&&(this._style=a,this.updateStyle());return this._style};e.highlightStyle=function(){var a=
this.style();this._active||"opacity"!==x.highlightActivationStyle||(a=this.highlightStyleProps(),a=Xb(a));return a};e.highlightStyleProps=function(){var a=hb(this.style());if(!this._active&&"opacity"===x.highlightActivationStyle){var b=a["background-color"];b&&(b=ya(b))&&(b.a*=.4,a["background-color"]=Ha(b))}return a};e.intervalStyleProps=function(){var a=this.highlightStyleProps()["background-color"];a&&(a=ya(a));if(a)return a.a*=.25,a=Ha(a),{"background-color":a}};e.fillStyle=function(){if("text"!==
this.range.type)return this._style};e.css=function(a){return pb(this._style,a)};e.matches=function(a,b,c,d,e){return this._style===a&&0===Sa(this.range,b)&&this._properties===c&&this._comment===d&&this._label===e};var c=function(a,b){b&&b.autodpi?za(a,"pct"):b&&"bitmap"===b.type?za(a,"px"):za(a,"tw")};e.serialize=function(){var a={type:this.type},b,d;a.range=da(this.range);"rect"===a.range.type&&(void 0!==a.range.embedId?za(a.range,"pct"):(b=B.page(a.range.page),c(a.range,b)));if(this.ttrects){var e=
[],g;for(g in this.ttrects){var h=this.ttrects[g];if(h){b=B.page(g);for(var f=0;f<h.length;f++)d=h[f].toRange(b),c(d,b),e.push(d)}}a.ttrects=[].concat.apply([],e)}this._style&&(a.style=this._style);this._properties&&(a.properties=this._properties);"string"===typeof this._comment&&(a.comment=this._comment);this._label&&(a.label=this._label);this._options&&(a.options=this._options);if(this._cRanges)for(a.compound=[],b=0;b<this._cRanges.length;b++)d=da(this._cRanges[b]),"rect"===d.type&&(void 0!==d.embedId?
za(d,"pct"):za(d,"tw")),a.compound.push(d);return a};e.destroy=function(){this.destroyDialog();this.eachPage(b,null,this);M.unlink(this);this.deleteAll()};var b=function(a,b){b.removeFromPage(a)};e.getOption=function(a){if("text"==this.range.type){if("enableUserMove"===a)return!1;if("enableUserResize"===a)for(var b in this._pageInfo){if(B.page(Number(b)).isSpreadsheet())return!1;break}}return(b=this._options)&&void 0!==b[a]?b[a]:!0};e.setOptions=function(a){if(a&&(g(this,"enableUserDelete",a,!0),
g(this,"enableUserComment",a,!0),g(this,"enableUserResize",a,!0),"text"!==this.range.type&&g(this,"enableUserMove",a,!0),this._options)){a=!1;for(var b in this._options)if(this._options.hasOwnProperty(b)){a=!0;break}a||delete this._options}};e.comment=function(a){void 0!==a&&(this._comment=null===a?void 0:String(a),this.updateComment(void 0,this._comment));return this._comment};e.dialog=function(a){var b=this._dialog;b?(b.abortAnimation(),b.show(!0)):b=this._dialog=new jd(this);b.loadComment();b.setMode(a);
b.align();return b};e.alignDialog=function(a){this._dialog&&this._dialog.align(a)};e.hideDialog=function(){var a=this._dialog;a&&a.show(!1,{endFn:a.close,context:a})};e.exitDialog=function(){this._dialog&&this._dialog.exit()};e.destroyDialog=function(){this._dialog&&this._dialog.destroy()};e.onDialogDestroy=function(a){a===this._dialog&&delete this._dialog};e.label=function(a){void 0!==a&&(this._label=null===a||""===a?void 0:String(a),this.eachPage(f,null,this));return this._label};var f=function(a,
b){b.applyLabel(a)};e.showLabel=function(a){this._label&&(!1===a?this._labelVisible=!1:delete this._labelVisible,this.eachPage(f,null,this))};e.isOnPage=function(a){return!!this._pageInfo[a]};e.isInOverlay=function(a){var b=a.lastPage.index;for(a=a.firstPage.index;a<=b;a++)if(this.isOnPage(a))return!0;return!1};var k=function(a,b){var c=a._pageInfo[b];c||(a._pageInfo[b]=c={index:b});return c};e.eachPage=function(a,b){qc(this._pageInfo,arguments)};e.activate=function(a){this.addToDocument();this._hidden&&
(this.show(),this._autohide=!0,D.update());this._active=!0;this.eachPage(l,null,this);this.positionAll()};var v=function(a,b){if("text"===b.range.type&&"opacity"===x.highlightActivationStyle)if(B.page(a.index).spreadsheetModel())b.removeFromPage(a.index),b.addToPage(a.index);else{var c=b.highlightStyleProps();a.spanList&&OIUpdateStyle(a.spanList,b.id,c,2);a.compoundSpanList&&pa(a.compoundSpanList,function(a,b){OIUpdateStyle(a.spans,b,c,2)},null,b.id);if(a.intervalSpanList){var d=b.intervalStyleProps();
d&&pa(a.intervalSpanList,OIUpdateStyle,null,b.id|1E9,d,-1)}}},l=function(a,b){var c=a.drawingRect;b.oldFocusPage=void 0;if("text"===b.range.type)"opacity"===x.highlightActivationStyle?v(a,b):c&&(c.addClass("oit-highlight-active"),c.setRange(b.range),b.getOption("enableUserResize")?c.ontextmove(b,r).ontextmoveend(b,p).showTextHandles():c.offtextmove(r).offtextmoveend(p).hideTextHandles(),c.activate());else if(c){c.addClass("oit-highlight-active");var d="cell"!==b.range.type;b.updateMoveable(!0,c);
b.updateResizable({bindToObject:d,minWidth:10,minHeight:10},c);c.activate()}a.embedRect&&a.embedRect.show()};e.updateMoveable=function(a,b,c){c=c||b;if(!1!==a&&this.getOption("enableUserMove"))b.addClass("oit-moveable").ondragstart(this,S,c).ondragmove(this,W,c).ondragend(this,F,c).ondragcancel(this,ia,c);else b.removeClass("oit-moveable").offdragstart(S).offdragmove(W).offdragend(F).offdragcancel(ia)};e.updateResizable=function(a,b,c){c=c||b;if(a&&this.getOption("enableUserResize"))c.resizable(!0,
a).onresizemove(this,O).onresizeend(this,H);else c.resizable(!1).offresizemove(O).offresizeend(H)};var r=function(a){var b=a.range;a=a.page;var c=B.pagesForRange(b);a!=this.oldFocusPage&&(this.oldFocusPage=a,this.eachPage(m,null,c,this));this._pageInfo[a.index]||this.addToPage(a.index,!0);this._cRanges&&(this._cRanges=[b]);h(this,a,this.highlightStyle(),b);this.alignDialog({animate:!1})},m=function(a,b,c){a.spanList&&(a=a.index,kb(b,"index",a)||u(c,B.page(a)))},p=function(a){this.setRange(a.range)};
e.deactivate=function(){this._active&&(delete this._active,this.eachPage(z,null,this),this._autohide&&(this.hide(),delete this._autohide,D.update()))};var z=function(a,b){var c=a.drawingRect;c&&c.removeClass("oit-highlight-active").deactivate();"text"===b.range.type?"opacity"===x.highlightActivationStyle&&v(a,b):c&&(b.updateMoveable(!1,c),b.updateResizable(!1,c));a.embedRect&&a.embedRect.hide()};e.show=function(){if(this._hidden){var a=this._hidden;delete this._hidden;for(var b=0;b<a.length;b++)this.addToPage(a[b])}delete this._autohide};
e.hide=function(){this._hidden||(this._hidden=[],this.eachPage(q,null,this))};var q=function(a,b){b._hidden.push(a.index);b.removeFromPage(a)};e.collapse=function(){};e.isHidden=function(){return this._hidden||this._autohide};var w=function(a,b){var c,d=a._pageInfo[b.index];if(d){if(!d.boundingRects)if(d.spanList||d.compoundSpanList){var e;if(d.spanList)e=b.textRects(a.range,b,d.spanList);else{var g=[];for(c=0;c<d.compoundSpanList.length;c++)Array.prototype.push.apply(g,d.compoundSpanList[c].spans);
for(c=0;c<a._cRanges.length;c++){var h=b.textRects(a._cRanges[c],b,g);e?Array.prototype.push.apply(e,h):e=h}}if(e)for(c=0;c<e.length;c++)for(g=e[c],h=0;h<g.length;h++){var f=g.item(h).clone();f.readonly(!0);d.boundingRects||(d.boundingRects=[]);d.boundingRects.push(f.clone())}}else"text"===a.range.type&&(c=b.textBoundingRect(a.range)),c||(c=D.rangeRect(a.range,b)),c&&(c=c.clone(),c.readonly(!0),d.boundingRects=[c]);return d.boundingRects}},V=function(a,b,c){var d;if(b){c=c||b;if("text"===a.range.type){var e=
w(a,b);if(e){d=e[0].clone();for(var g=1;g<e.length;g++)d.union(e[g]);d.origin=c}}d||(d=D.rangeRect(a.range,c||b))}return d};e.boundingRectList=function(a){var b=[];this.eachPage(T,null,a,b,this);if(0<b.length)return b};var T=function(a,b,c,d){(a=V(d,B.page(a.index),b))&&c.push(a)};e.addToDocument=function(){var a=B.pagesForRange(this.range);if(a){for(var b=0;b<a.length;b++)this.addToPage(a[b].index);M.link(this)}};var J=function(a){a.highlightLayer||(N(a),a.highlightLayer=a.layer("highlights"));return a.highlightLayer},
N=function(a){a.compoundHighlightLayer||(a.compoundHighlightLayer=a.layer("chighlights"));return a.compoundHighlightLayer};e.addToPage=function(a,b){var c=B.page(a),d=this._pageInfo[a];d&&b&&(this.removeFromPage(d),d=null);if(!this._hidden&&(!d||d.needRect||d.needApply)&&c&&c.isLoaded()&&!c.isHidden()&&(b||c.containsRange(this.range))){var e;c.pushShow();d&&d.needApply||(d=h(this,c,this.highlightStyle(),this.range));d&&delete d.boundingRects;if(M.batchMode())d&&(d.needApply=!0);else if(e=V(this,c,
"overlay")){d?(delete d.needRect,delete d.needApply):d=k(this,a);void 0===this.range.embedId||d.embedRect||(d.embedRect=new sb(a,J(c)),d.embedRect.addClass("oit-highlight-embed"),d.embedRect.hide());if(!d.drawingRect&&(d.drawingRect=this.createDrawingRect(c.index,J(c)),d.drawingRect&&(M.on.addElement(d.drawingRect,this),c.inAnnotation(this.range))))d.drawingRect.onwheel(this,function(a){var b=c.annotationPane();if(b)return b.scrollPane().redirectEvent(a)});var g=this.fillStyle();g?(d.styleDiv||(d.styleDiv=
y.create("div","oit-highlight-style"),d.drawingRect&&d.drawingRect.append(d.styleDiv)),d.styleDiv.attr("style",g)):d.styleDiv&&(d.styleDiv.destroy(),delete d.styleDiv);this._label&&this.applyLabel(d);E(this._pageInfo[a],this,e);this.updateComment(d,this._comment)}else d&&(d.needRect=!0);M.link(this);D.update(!1,!0);c.popShow()}};e.removeFromPage=function(a){"number"==typeof a&&(a=this._pageInfo[a]);if(a){var b=a.index;u(this,B.page(b));a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag);
a.drawingRect&&(M.on.removeElement(a.drawingRect,this),a.drawingRect.destroy());a.embedRect&&a.embedRect.destroy();this._pageInfo[b]=null;D.update(!1,!0)}};e.createDrawingRect=function(a,b){var c;"text"===this.range.type?"opacity"!==x.highlightActivationStyle&&(c=new dd(a,b),c.setRange(this.range)):c=new sb(a,b);return c};e.distanceFromPoint=function(a,b,c,d){var e;a=B.page(a);if(a=w(this,a))for(var g=0;g<a.length;g++){var h=a[g];if(!(h.origin instanceof cb)==d&&(h=h.distanceFrom(b,c,"nearest","nearest",
"xy"),void 0===e||h.ay<e.ay||h.ay==e.ay&&h.ax<e.ax)&&(e=h,0===e.x&&0===e.y))break}return e};var E=function(a,b,c){var d;if(a){d=a.index;var e=B.page(d);if(e.isHidden()||!e.isEnabled()){a.drawingRect&&a.drawingRect.hide();a.embedRect&&a.embedRect.hide();if(a.cRects)for(d=0;d<a.cRects.length;d++)a.cRects[d].rect.hide();a.needRect=!0}else if("text"===b.range.type)a.drawingRect&&a.drawingRect.show().changed();else if(c||(c=V(b,e,"overlay")),c){a.drawingRect&&a.drawingRect.show().move(c.left,c.top,c.width,
c.height);a.embedRect&&(c=B.page(d).embeddingRect(b.range.embedId))&&(c.origin="overlay",a.embedRect.show().move(c.left,c.top,c.width,c.height));if(a.cRects)for(d=0;d<a.cRects.length;d++)e=a.cRects[d],(c=D.rangeRect(e.range,"overlay"))&&e.rect.show().move(c.left,c.top,c.width,c.height);b.updateComment(a,b._comment)}}};e.positionAll=function(){this.eachPage(E,null,this)};e.generateKey=function(){var a,b=B.forRange(this.range,0);if(b&&void 0===this.prevId&&void 0===this.nextId){this.key&&this.key.page!=
b.index&&delete this.key;this.key||(this.key={page:b.index,x:0,y:0});if(this.inAnnotation())this.key.x=this.range.acc,this.key.y=9999999;else if(b.isEmailHeader()&&"text"===this.range.type)this.key.x=this.range.acc;else{var c;if(b&&(a=w(this,b))){c=a[0].left;for(var b=a[0].top,d=1;d<a.length;d++){var e=a[d];if(e.top<b||e.top==b&&e.left<c)c=e.left,b=e.top}c={left:c,top:b}}if(a=c)this.key.x=a.left,this.key.y=a.top}a=this.key}else delete this.key;return a};e.inAnnotation=function(){void 0===this._inComment&&
(this._inComment=B.inAnnotation(this.range));return this._inComment};e.applyLabel=function(a){if(a&&a.drawingRect)if(this._label&&!1!==this._labelVisible){var b=this.css("background-color"),c;a:{if(b&&(c=ya(b))){c.r=255-c.r;c.g=255-c.g;c.b=255-c.b;c=Ha(c.r,c.g,c.b);break a}c=void 0}c||(b=null);a.drawingRect.setLabel(this._label,c,b)}else a.drawingRect.setLabel(null)};var h=function(a,b,c,d){var e=null,g=0,h,f,n,t,A,m;a._active?g=2:"opacity"===x.highlightActivationStyle&&(g=1);var z=P.saveSelection();
u(a,b);if(a._compound){if(a._cRanges||(a._cRanges=B.decomposeRange(d,!0)),a._cRanges){(t=b.spreadsheetModel())&&t.addHighlight(a);var C="rect"===d.type,q;for(t=0;t<a._cRanges.length;t++){A=a._cRanges[t];if("text"===A.type){if(n||(n=hb(c)),n&&(f=Eb(b,A,n,a.id,void 0,g))){e||(e=k(a,b.index));e.compoundSpanList||(e.compoundSpanList=[]);for(var p=0;p<f.length;p++)if(h=f[p].split(A))for(m=0;m<h.length;m++)M.on.addElement(h[m],a);e.compoundSpanList.push({spans:f,range:A})}}else if(f=D.rangeRect(A,"overlay"))h=
new sb(b.index,N(b)),c&&(m=y.create("div","oit-highlight-style"),m.attr("style",c),h.append(m)),h.move(f.left,f.top,f.width,f.height),e||(e=k(a,b.index)),e.cRects||(e.cRects=[]),e.cRects.push({range:A,rect:h});C&&(A="text"===d.type?b.textBoundingRect(A):D.rangeRect(A,b))&&(q?q.union(A):q=A)}if(x.highlightTermIntervals&&"text"===a.range.type&&1<a._cRanges.length&&(g=-2,a._active&&(g=-1),d=a.intervalStyleProps())){c=[];f=a.acc;for(t=0;t<a._cRanges.length;t++)A=a._cRanges[t],A.acc>f&&c.push(fa(f,A.acc)),
f=A.accend;for(t=0;t<c.length;t++)if(A=c[t],f=Eb(b,A,d,a.id|1E9,void 0,g))e||(e=k(a,b.index)),e.intervalSpanList||(e.intervalSpanList=[]),e.intervalSpanList.push(f)}q&&(b=D.rangeFromRect(b.index,q.left,q.top,q.right,q.bottom,b,"highlight"))&&(a.range=b)}}else if("text"===d.type&&((t=b.spreadsheetModel())&&t.addHighlight(a)&&(e=k(a,b.index)),n=hb(c))&&(f=Eb(b,d,n,a.id))){e||(e=k(a,b.index));e.spanList=f;for(t=0;t<f.length;t++)if(h=f[t].split(d))for(m=0;m<h.length;m++)M.on.addElement(h[m],a);if((t=
ha.infoRaw())&&1557===t.fi)for(a.ttrects||(a.ttrects=[]),a=a.ttrects[b.index]=[],t=0;t<f.length;t++)f[t].hasClass("oit-tt")&&(b=f[t].textRect(d))&&a.push(b)}z&&P.restoreSelection(z);return e},u=function(a,b){var c,d=a._pageInfo[b.index];if(d){var e=P.saveSelection(),g=b.spreadsheetModel();g&&("text"===a.range.type||a._compound)&&g.removeHighlight(a);if(d.spanList){for(c=0;c<d.spanList.length;c++)if(g=d.spanList[c].split(a.range))for(var h=0;h<g.length;h++)M.on.removeElement(g[h],a);Ob(d.spanList,
a.id);delete d.spanList;b.pageLayoutChanged()}d.compoundSpanList&&(pa(d.compoundSpanList,function(b,d){var e=b.range,g=b.spans;for(c=0;c<g.length;c++){var h=g[c].split(e);if(h)for(var f=0;f<h.length;f++)M.on.removeElement(h[f],a)}Ob(g,d)},null,a.id),delete d.compoundSpanList,b.pageLayoutChanged());d.intervalSpanList&&(pa(d.intervalSpanList,Ob,null,a.id|1E9),delete d.intervalSpanList,b.pageLayoutChanged());if(d.cRects){for(c=0;c<d.cRects.length;c++)if(g=d.cRects[c].rect)M.on.removeElement(g,a),g.destroy();
delete d.cRects}e&&P.restoreSelection(e)}},g=function(a,b,c,d){var e=!1;c=c[b];void 0!==c&&(c==d?(d=a._options)&&void 0!==d[b]&&(delete d[b],e=!0,a.optionChanged(b)):(a._options||(a._options={}),a._options[b]=!!c,e=!0,a.optionChanged(b)));return e};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.id===M.active()&&this.activate(!0)}};var t=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?a.drawingRect&&(b?(a.commentFlag||(a.drawingRect.onmouseenter(this,
A).onmouseleave(this,U),a.commentFlag||(a.commentFlag=new Aa(a.drawingRect,{hpos:"right",vpos:"top",margin:2,classList:"oit-comment-flag"}))),a.commentFlag.show()):a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag)):this.eachPage(t,null,b,this)};var A=function(a){this.id!=M.active()&&M.showComment(this.id)},U=function(a){this.id!=M.active()&&M.hideComment(this.id)},S=function(a,b){if(this.getOption("enableUserMove")){var c=b.position();this._moveable={startRect:c.clone(),curRect:c.clone()};
return!1}return!0},W=function(a,b){if(this._moveable){var c=this.range,d,e=this._moveable.startRect;d=this._moveable.curRect;var g=a.delta;d.left=e.left+g.x;d.top=e.top+g.y;"cell"!==c.type||c.offsets?d=D.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId):(this.moveOriginalRect||(this.moveOriginalRect=D.rangeRect(c,d.origin)),e=this.moveOriginalRect.clone(),e.left=d.left,e.top=d.top,d=D.rangeFromRect(c.page,e.left,e.top,e.right,e.bottom,e.origin,"move",c.embedId),e=c.c2-
c.c1,g=c.r2-c.r1,d.c2-d.c1<e&&(d.c2=d.c1+e),d.r2-d.r1<g&&(d.r2=d.r1+g),delete d.offsets);0!==Sa(d,c)&&(d=D.rangeRect(d,"overlay"),b.move(d.left,d.top,d.width,d.height),this._active&&this._comment&&this._dialog&&this._dialog.align({rect:d,animate:!1}))}return!1},F=function(a,b){if(this._moveable){var c=this.range,d=this._moveable.curRect,d=D.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId);if("cell"===d.type&&!c.offsets){delete this.moveOriginalRect;var e=c.c2-c.c1,c=c.r2-
c.r1;d.c2-d.c1<e&&(d.c2=d.c1+e);d.r2-d.r1<c&&(d.r2=d.r1+c);delete d.offsets}this.setRange(d);delete this._moveable}return!1},ia=function(a,b){if(this._moveable){var c=a.center;M.activateNearest(c.x,c.y,a.srcEvent);delete this._moveable}return!1},O=function(a){var b=this.range,c=a.drawingRect;a=a.newRect;var d=D.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==d.type||b.offsets||delete d.offsets;if(d=wa(d,!0))b=D.rangeRect(d,"overlay"),"rect"===d.type&&(a=b),
c.move(b.left,b.top,b.width,b.height);this._active&&this._comment&&this._dialog&&this._dialog.align({rect:a,animate:!1})},H=function(a){var b=this.range;a=a.newRect;a=D.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==a.type||b.offsets||delete a.offsets;a=wa(a,!0);this.setRange(a)};return d}(),Vc=function(){var d=function(a,c){fb.call(this,a,c)},e=X(d,fb);e.isRedaction=function(){return!0};e.isCompoundRedaction=function(){return!0===this._compound};e.isEmptyRedaction=
function(){return!0===this._compound&&!this._cRanges};e.style=function(a){a=x.redactionColor;return"color:"+a+";background-color:"+a+";"};e.fillStyle=function(){if("text"!==this.range.type){var a;if(a=!this._compound||"rect"!==this.range.type&&"cell"!==this.range.type?x.redactionColor:x.redactionFillColor)return"background-color:"+a+";"}};e.css=function(a){if("color"===a||"background-color"===a)return x.redactionColor};return d}(),Wc=function(){var d=function(a,b){fb.call(this,a,b);this._newNote=
!0;this._state="oit-note-pinned";this._pinned=!0;this._hidden=this._hover=this._active=this._editing=!1},e=X(d,fb);e.isNote=function(){return!0};e.isEditing=function(){return this._editing};e.isHidden=function(){return this._hidden};e.removeFromPage=function(a){this.endEditText(!1);fb.prototype.removeFromPage.call(this,a)};e.activate=function(a){if(!this._active||a)this._active=!0,this.updateState(a)};e.deactivate=function(){this._active&&(this._active=!1,this.updateState())};e.show=function(){this._hidden&&
(this._hidden=!1,this.updateState())};e.hide=function(){this._hidden||(this._hidden=!0,this.updateState())};e.pin=function(){this._pinned||(this._pinned=!0,this.updateState())};e.unpin=function(){this._pinned&&(this.endEditText(!0),M.active()==this.id&&M.deactivate(),this._pinned=!1,this.updateState())};e.beginEditText=function(a){void 0!==a&&(this._newNote=a);this._editing||(this._editing=!0,w.editingComment++,this.updateState())};e.endEditText=function(a){this._editing&&(!1===a&&(this.buttons.textArea.value=
M.comment(this.id)),this._editing=!1,w.editingComment--,this.updateState(),this._newNote&&(a?delete this._newNote:M.remove(this.id)))};e.ok=function(){this.endEditText(!0);return!1};e.cancel=function(){this.endEditText(!1);return!1};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.updateState(!0)}};var a=function(){this.addClass("oit-note-expanding")},c=function(){this.removeClass("oit-note-expanding")},b=function(){this.addClass("oit-note-collapsing")},f=function(){this.removeClass("oit-note-collapsing")};
e.updateState=function(d){var e;e=this._editing?"oit-note-editing":this._active?this._pinned?"oit-note-active":"oit-note-shown":this._hidden?"oit-note-hidden":this._pinned?"oit-note-pinned":this._hover?"oit-note-hover":"oit-note-iconic";var k=this.noteRect;if(k){if(e!=this._state||d){var m=this._state;this._state=e;k.removeClass(m).addClass(e);switch(m){case "oit-note-editing":M.comment(this.id,this.buttons.textArea.value);Ga.showModalOverlay(!1);this.buttons.iconBar.focus();k.layer().removeClass("oit-note-layer-edit");
k.removeClass("oit-highlight-active").deactivate();break;case "oit-note-hidden":k.show();break;case "oit-note-iconic":"oit-note-hidden"!==e&&(d=this.originalRect,k.move(d.left,d.top,d.width,d.height,{timems:200,startFn:a,endFn:c}));break;case "oit-note-active":k.removeClass("oit-highlight-active").deactivate();case "oit-note-pinned":"oit-note-active"!==e&&"oit-note-pinned"!==e&&(this.updateMoveable(!1,this.buttons.iconBar,k),this.updateResizable(!1,k))}this.positionAll();switch(e){case "oit-note-hidden":k.hide();
break;case "oit-note-iconic":this.originalRect=k.position().clone();d=this.collapsedRect={left:this.originalRect.right-20,top:this.originalRect.top,width:20,height:20};"oit-note-hidden"===m?k.move(d.left,d.top,d.width,d.height):k.move(d.left,d.top,d.width,d.height,{timems:200,startFn:b,endFn:f});break;case "oit-note-editing":k.layer().addClass("oit-note-layer-edit");k.addClass("oit-highlight-active").activate(!1,!0);M.activate(this.id);Ga.showModalOverlay(!0);e=this.buttons.textArea;e.blur();e.focus();
this._newNote&&e.moveCaret(e.value.length||0);break;case "oit-note-active":k.addClass("oit-highlight-active").activate(!1,!0);case "oit-note-pinned":this.updateMoveable(!0,this.buttons.iconBar,k),this.updateResizable({bindToObject:"cell"!==this.range.type,minWidth:60,minHeight:45,margin:-5},k)}}k.update()}};e.createDrawingRect=function(a,b){var c=new sb(a,b),d={};this.noteRect=c;this.buttons=d;c.addClass("oit-note").addClass("oit-note-pinned");d.iconBar=new Aa(c,{classList:"oit-note-icons",inheritMoveable:!0});
d.iconBar.attr("tabindex","-1");d.cancel=new Aa(d.iconBar,{classList:"oit-note-cancel",title:R.DISCARD_CHANGES});d.cancel.onclick(this,this.cancel).ontap(this,this.cancel);d.ok=new Aa(d.iconBar,{classList:"oit-note-ok",title:R.SAVE_CHANGES});d.ok.onclick(this,this.ok).ontap(this,this.ok);d.pin=new Aa(c,{classList:"oit-note-pin"});d.pin.onmouseenter(this,k).onmouseleave(this,v).onclick(this,l).ontap(this,l);d.textArea=new jc;d.textArea.onfocus(this,m).ontap(this,r);d.textForm=y.create("form");d.textForm.append(d.textArea);
c.append(d.textForm);this.updateState(!0);return c};var k=function(a){this._hover=!0;this.updateState()},v=function(a){this._hover=!1;this.updateState()},l=function(a){this._pinned?this.unpin():this.pin();return!1},r=function(a){this.buttons.textArea.blur();this.buttons.textArea.focus()},m=function(a){this.getOption("enableUserComment")?this.beginEditText():this.buttons.textArea.blur()},p=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?this._hidden||this._editing||!this.buttons||
(this.buttons.textArea.value=b||""):this.eachPage(p,null,b,this)};return d}(),Xc=function(){var d=function(d,a){fb.call(this,d,a);a.name&&(this._name=a.name);a.sizing&&(this._sizing=a.sizing);a.opacity&&(this._opacity=a.opacity);if(!this._style){var c="background:url("+M.stamp(this._name).url+") no-repeat";1!=this._opacity&&(c+=";opacity:"+this._opacity);"scale"===this._sizing?c+=";background-size:contain":"stretch"===this._sizing&&(c+=";background-size:100% 100%");this._style=c}};X(d,fb).serialize=
function(){var d=fb.prototype.serialize.call(this);d.stamp=this._name;d.opacity=this._opacity;d.sizing=this._sizing;delete d.style;return d};return d}(),jd=function(){var d=200,e=150,a=function(a){var c="#000",d=a.css("background-color");d&&(d=Yb(d,"#FFFFFF"));if(d){var e=ya(d);128>e.r&&128>e.g&&128>e.b&&(c="#FFF")}Gc.call(this,{ok:!0,cancel:!0,className:"oit-dialog-comment",resultFn:b,destroyFn:f,textColor:c,backgroundColor:d});this._highlight=a},c=X(a,Gc),b=function(a,b){"view"!==a._mode&&(d=a.width(),
e=a.height(),"new"!==a._mode||b&&a._textarea.value?(b&&a.saveComment(),M.active()===a._highlight.id?a.setMode("view"):a._highlight.exitDialog()):(M.remove(a._highlight.id),P.select(null)))},f=function(a){a.setMode(null);a._highlight.onDialogDestroy(a)};c.setMode=function(a){if(a!==this._mode){if("edit"===this._mode||"new"===this._mode)w.editingComment--,this.removeClass("oit-comment-edit");this._mode=a;switch(a){case "view":this._highlight.comment()?(this._textarea&&(this._textarea.destroy(),delete this._textarea),
this._label||(this._label=this.addLabel(null),this._label.onclick(this,k).ontap(this,k).onmouseenter(this,v).onmouseleave(this,l)),this.resizable(!1),this.modal(!1),this.showFooter(!1),this.maxsize(d,e),this._mode=a,this.loadComment(),this.align(),this.show()):this._highlight.exitDialog();break;case "edit":case "new":w.editingComment++,this.addClass("oit-comment-edit"),this.modal(!0),this.align({endFn:r,context:this})}}};var k=function(){this._highlight.getOption("enableUserComment")&&this.setMode("edit")},
v=function(){M.showComment(this._highlight.id)},l=function(){var a=this._highlight.id,b=M.active();a!=b&&(M.hideComment(a),void 0!==b&&M.showComment(b))},r=function(){this.show(!0,{endFn:m,context:this})},m=function(){this._label&&(this._label.destroy(),delete this._label);this._textarea||(this.resetForm(),this._textarea=this.addTextArea(null),this._textarea.onfocus(this,p));this.loadComment();this.resizable(!0,180,100);this.showFooter(!0);this.maxsize(0,0);this._textarea&&this._textarea.focus&&this._textarea.focus()},
p=function(){var a=this._textarea;a&&("number"==typeof a.selectionStart?a.selectionStart=a.selectionEnd=a.value.length:"undefined"!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select()))};c.loadComment=function(){var a=this._highlight.comment()||"";this._textarea?this._textarea.value=a:this._label&&this._label.text(a)};c.saveComment=function(){this._textarea&&M.comment(this._highlight.id,this._textarea.value,!0)};c.align=function(a){var b;a:{var c=a?a.rect:null;if(this){var f=
this._highlight,k=f.isNote(),m,p,l;if(c)"view"!==c.origin&&(c=c.clone(),c.origin="view"),k?(b=c.left,m=c.top,p=c.right-c.left,l=c.bottom-c.top):(b=c.right+10,m=c.top);else if(c=f.boundingRectList("view"))for(f=0;f<c.length;f++){var h=c[f];k?(b=h.left,m=h.top,p=h.right-h.left,l=h.bottom-h.top):(b=h.right+10,m=h.top);0>m&&0<=h.bottom&&(m=0);if(0<=b&&0<=m)break}if(void 0!=b){10>b&&(b=10);10>m&&(m=10);k=w.viewNode.pos();b+=k.left;m+=k.top;if(p&&l){b={left:b,top:m,width:p,height:l};break a}b={left:b,top:m};
break a}}b=void 0}b&&(m=b.width||d,p=b.height||e,"view"===this._mode?this.autoSize(b.left,b.top,m,p,a):this.move(b.left,b.top,m,p,a))};return a}(),Nb=function(){var d=function(a,b,c,d,e){this.prop("id",a);this._edge=b;this._visible=!1;this._autoSize=!0;this._resizable=this._overlay=!1;this._height=this._width=void 0;switch(this._edge){case "top":this._dimension="height";this._border="borderBottom";this._direction=1;break;case "bottom":this._dimension="height";this._border="borderTop";this._direction=
-1;break;case "left":this._dimension="width";this._border="borderRight";this._direction=1;break;case "right":this._dimension="width",this._border="borderLeft",this._direction=-1}this._frame=y.create("div","oit-toolframe");this._toolbar=y.create("div","oit-toolbar oit-toolbar-"+this._edge);this._toolsParent=y.create("div","oit-toolbar-tool");this._toolsElem=c;this._content=y.create("div","oit-toolcontent");this._toolbar.append(this._toolsParent);this._toolsParent.append(this._toolsElem);this._frame.append(this._toolbar,
this._content);d&&(y.unwrap(this._toolbar).style[this._border]=d);a=e?e._content:w.rootNode;this._content.transferFrom(a);a.append(this._frame)},e=X(d);e.filter=function(a){return a===this.id};e.refresh=function(){this.applySize()};e.isInternal=function(){return 0>this.id};var a=function(a){this._startSize=this.size();return!1},c=function(a){var b=this._startSize;switch(this._edge){case "top":b+=a.delta.y;break;case "bottom":b-=a.delta.y;break;case "left":b+=a.delta.x;break;case "right":b-=a.delta.x}this.setSize(b);
return!1},b=function(a){delete this._startSize;return!1};e.overlay=function(a){"boolean"===typeof a&&((this._overlay=a)?this._toolbar.addClass("oit-toolbar-overlay"):this._toolbar.removeClass("oit-toolbar-overlay"),this._visible&&(this.hide(),this.show()));return this._overlay};e.resizable=function(d,e,v,l){"boolean"===typeof d&&((this._resizable=d)?("number"==typeof e&&"number"==typeof v&&"string"==typeof l&&(this._collapseSize=e,this._minSize=v,this._collapseHeader=y.create("div","oit-toolcollapse"),
this._collapseHeader.html(l),this._toolbar.append(this._collapseHeader)),this._toolbar.addClass("oit-toolbar-resizable"),this._resizeHandle||(this._resizeHandle=y.create("div","oit-toolresize"),this._resizeHandle.html("<div></div>"),this._resizeHandle.ondragstart(this,a),this._resizeHandle.ondragmove(this,c),this._resizeHandle.ondragend(this,b),this._resizeHandle.ondragcancel(this,b),this._resizeHandle.kinetic(!1),this._toolbar.append(this._resizeHandle))):(this._collapseHeader&&this._collapseHeader.destroy(),
delete this._collapseSize,delete this._minSize,delete this._collapseHeader,this._toolbar.removeClass("oit-toolbar-resizable"),this._resizeHandle&&(this._resizeHandle.destroy(),delete this._resizeHandle)),this._visible&&(this.hide(),this.show()));return this._resizable};e.remove=function(){var a=this._frame.parent();a&&(a.transferFrom(this._content),this._frame.destroy());this.isInternal()||xa.on.remove.dispatch(this.id,this._edge)};e.isVisible=function(){return this._visible};e.show=function(a){var b=
this._toolbar;a=a||{};if(!this._visible){this._autoSize=this._visible=!0;this._toolbar.css("display","block");if(void 0===this._borderSize&&(this._borderSize=0,y.unwrap(this._toolbar).style[this._border])){var c=this._toolbar.computedStyle();c&&(this._borderSize=parseInt(c[this._border+"Width"],10))}this.applySize(a.size,!0);this.isInternal()||xa.on.show.dispatch(this.id,this._edge,b.offsetWidth,b.offsetHeight)}this.dispatchSize(a.refresh)};e.hide=function(){this._visible&&(this._visible=!1,this._toolbar.css("display",
null),this.applySize(),this.isInternal()||xa.on.hide.dispatch(this.id,this._edge))};e.size=function(){return"width"===this._dimension?this._toolbar.innerWidth:this._toolbar.innerHeight};e.setSize=function(a){if("auto"===a)this._toolbar.css(this._dimension,null),this._autoSize=!0,this.applySize();else{this._visible&&void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._toolbar.css(this._dimension,a);this._autoSize=!1;switch(this._edge){case "top":case "bottom":this._resizeHandle&&(a-=this._resizeHandle.offsetHeight);
break;case "left":case "right":this._resizeHandle&&(a-=this._resizeHandle.offsetWidth)}this.applySize(a)}};e.applySize=function(a,b,c){if(void 0!==a||void 0===this._startSize){var d=this._toolbar,e=this._content,f=this._toolsElem,k=this._frame;if(this._visible){this._autoSize&&d.removeCSS(["bottom","top","right","left",this._dimension]);if(void 0===a){switch(this._edge){case "top":case "bottom":this._autoSize?this._size=f.offsetHeight:(this._size=d.offsetHeight,this._resizeHandle&&(this._size-=this._resizeHandle.offsetHeight));
break;case "left":case "right":this._autoSize?this._size=f.offsetWidth:(this._size=d.offsetWidth,this._resizeHandle&&(this._size-=this._resizeHandle.offsetWidth))}a=this._size}void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._collapseSize&&(a<this._collapseSize?this._collapsed||(this._collapseHeader.css("display","block"),this._toolsParent.css("display","none"),this._collapsed=!0):this._collapsed&&(this._collapseHeader.css("display",null),this._toolsParent.css("display",null),this._collapsed=
!1));void 0!==this._borderSize&&(a+=this._borderSize);var f=k.clientWidth,k=k.clientHeight,z=w.rootNode.clientWidth-10,q=w.rootNode.clientHeight-10;switch(this._edge){case "top":this._visible&&this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>q&&(a=q));d.css("bottom",k-a+"px");this._overlay||e.css("top",a+"px");break;case "bottom":this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>q&&(a=q));d.css("top",k-a+"px");this._overlay||e.css("bottom",a+"px");break;case "left":this._resizeHandle&&
(a+=this._resizeHandle.offsetWidth,a>z&&(a=z));d.css("right",f-a+"px");this._overlay||e.css("left",a+"px");break;case "right":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,a>z&&(a=z)),d.css("left",f-a+"px"),this._overlay||e.css("right",a+"px")}}else if(!this._overlay)switch(this._edge){case "top":e.css("top",0);break;case "bottom":e.css("bottom",0);break;case "left":e.css("left",0);break;case "right":e.css("right",0)}!0!==b&&this.dispatchSize(c)}};e.dispatchSize=function(a){var b=0,c=0;this._visible&&
(this._collapsed?(b=this._collapseHeader.clientWidth,c=this._collapseHeader.clientHeight):(b=this._toolsParent.clientWidth,c=this._toolsParent.clientHeight));if(a||b!=this._width||c!=this._height)this._width=b,this._height=c,ha.dispatchResize(),this.isInternal()?xa.on.resizeinternal.dispatch(this.id,this._edge,b,c,this._collapsed):xa.on.resize.dispatch(this.id,this._edge,b,c)};return d}(),Sc=function(){return function(){var d,e,a,c,b,f=[],k,v,l,r;this.show=function(){d&&d.show()};this.hide=function(){d&&
d.hide()};this.length=function(){return f.length};this.addPrevNext=function(d,f){if(!c){c=new Wb("\u25c4",R.PAGE_UP);d&&(c.onclick(d),c.ontap(d));b=new Wb("\u25ba",R.PAGE_DOWN);f&&(b.onclick(f),b.ontap(f));var k=y.create("div","oit-tab-nextprev");k.append(c,b);e.append(k);(k=k.size())&&k.width&&a.css("right",k.width+"px")}};this.addTab=function(b,c,d,e){var k=y.create("div","oit-tab");k.html("<div>"+b+"</div>");c&&k.addClass("oit-hidden");a.append(k);f.push(k);if(d instanceof Function)k.on("click",
null,m,d,e).on("tap",null,m,d,e);return f.length-1};var m=function(a,b,c){b(c)};this.showTab=function(a){0<=a&&a<f.length&&(f[a].css("display",null),p())};this.hideTab=function(a){0<=a&&a<f.length&&(f[a].css("display","none"),p())};this.tabClass=function(a,b){if(0<=a&&a<f.length){if(f[a].customClass){if(f[a].customClass===b)return;f[a].removeClass(f[a].customClass);delete f[a].customClass}b&&(f[a].addClass(b),f[a].customClass=b)}};this.setActiveTab=function(b){if(0<=b&&b<f.length&&b!=k&&(void 0!=
k&&f[k].removeClass("oit-tab-selected"),k=b,f[k].addClass("oit-tab-selected"),p(),void 0!==k)){b=f[k].rect(e);var c=a.rect(e),d=c.left;b.right>c.right?d-=b.right-c.right:0>b.left&&(d-=b.left);0<=d?a.css("left",null):a.css("left",d+"px")}};this.tabRect=function(a){if(0<=a&&a<f.length){a=f[k].rect(w.rootNode);a=new ga(a,"view");var b=w.viewNode.rect(w.rootNode);a.offset(-b.left,-b.top);return a}};this.destroy=function(){d&&xa.removeInternal(-2);e&&e.destroy();f=b=c=a=e=d=null};var p=function(){if(c){for(var a,
d,e=0;e<f.length;e++)"none"!==f[e].css("display")&&(d=e,void 0===a&&(a=e));c.disabled=k<=a;b.disabled=k>=d}};e=y.create("div","oit-tab-bar");a=y.create("div","oit-tab-list");e.append(a);a.kinetic(!0);a.ondragstart(function(b){b=a.rect(e);v=b.left;l=b.right;r=f[f.length-1].rect(e).right;return!1});a.ondragmove(function(b){var c=b.delta.x;b=v+c;0>b&&(c=r+c,c<l&&(b+=l-c));0<b&&(b=0);a.css("left",b+"px");return!1});d=new Nb(-2,"bottom",e,null,xa.internalParent(-2));xa.addInternal(-2,d);d.show()}}(),kd=
function(){return function(){var d,e,a;this.show=function(){d&&d.show()};this.hide=function(){d&&d.hide()};this.enable=function(){a.attr("disabled",null)};this.disable=function(){a.attr("disabled","disabled")};this.setText=function(b){b?a.attr("value",b):a.attr("value","")};this.destroy=function(){d&&xa.removeInternal(-4);e&&e.destroy();a=e=d=null};e=y.create("div","oit-formula-bar");var c=y.create("div","oit-formula-padding");a=y.create("input","oit-formula-text");a.attr("type","text");a.attr("readonly",
"readonly");c.append(a);e.append(c);d=new Nb(-4,"top",e,null,xa.internalParent(-4));xa.addInternal(-4,d);d.show()}}(),Ea=function(){var d=function(a,b,d){this._size=b;this._hidden=!1;a?(this._hidden=!0===a.hidden,void 0!==a.h?this._size=a.h:void 0!==a.w&&(this._size=a.w),this._title=void 0!==a.t?a.t:d,void 0!==a.st&&(this._styleIndex=a.st),this._acc=a.acc,this._accend=a.accend):this._title=d;this._originalHidden=this._hidden;this._originalSize=this._size},e=X(d);e.clone=function(){var a=new d(null,
this._size,this._title);a._size=this._size;a._originalSize=this._originalSize;a._hidden=this._hidden;a._originalHidden=this._originalHidden;a._title=this._title;void 0!==this._styleIndex&&(a._styleIndex=this._styleIndex);void 0!==this._acc&&(a._acc=this._acc);void 0!==this._accend&&(a._accend=this._accend);void 0!==this._revisions&&(a._revisions=this._revisions);void 0!==this._deleted&&(a._deleted=this._deleted);this._data&&(a._data=this._data.slice(0));a.clonedFrom=this;return a};e.title=function(){return this._title};
e.style=function(){return this._styleIndex};e.revision=function(a){void 0!==a&&(this._revisions||(this._revisions=[],this.clonedFrom&&(this.clonedFrom._revisions=this._revisions)),this._revisions.push(a),"delete_col"===a.type||"delete_row"===a.type)&&(this._deleted=!0);return this._revisions};e.setCellData=function(a){var b;this._data=a;if(void 0===this._acc){for(a=0;a<this._data.length;a++)if((b=this._data[a])&&b.t&&void 0!==b.a){this._acc=b.a;break}if(void 0!=this._acc)for(a=this._data.length-1;0<=
a;a--)if((b=this._data[a])&&b.t&&void 0!==b.a){this._accend=b.a+b.t.length-1;break}}};e.hidden=function(){return this._hidden};e.originalHidden=function(){return this._originalHidden};e.deleted=function(){return!!this._deleted};e.show=function(a){return this._hidden||5>this._size?(this._hidden=!1,5>this._size&&(this._size=a),!0):!1};e.reset=function(){var a=!1;void 0!=this._originalSize&&(this._size=this._originalSize,a=!0);!this._hidden&&this._originalHidden&&(a=this._hidden=!0);return a};e.size=
function(){return this._hidden?0:this._size};e.setSize=function(a){if("number"!==typeof a)throw"Invalid argument to setSize";this._size=a;this._hidden=0===a};e.getCellsForRange=function(a,b){if(this._data&&void 0!==this._acc&&a<=this._accend&&b>=this._acc){for(var c,d=0;d<this._data.length;d++){var e=this._data[d];e&&e.t&&void 0!==e.a&&a<=e.a+e.t.length&&b>=e.a&&(c||(c=[]),c.push(e))}return c}};e.getIndexForCell=function(a){if(this._data){for(var b=0,c=0;c<this._data.length;c++){var d=this._data[c];
if(d&&d==a)break;d&&d.e?b+=d.e:b++}return b}};var a=function(a,b){if(a._data){if(void 0===a._getCellIndex||b<a._getCellIndex)if(a._cellDataIndex=0,a._getCellIndex=0,a._getCellEmpty=0,0<a._data.length){var c=a._data[0];c?c.e&&(a._getCellEmpty=c.e):a._getCellEmpty=1}for(;a._getCellIndex<b;){0<a._getCellEmpty&&a._getCellEmpty--;if(0===a._getCellEmpty){a._cellDataIndex++;if(a._cellDataIndex>=a._data.length){a._getCellIndex=b;return}c=a._data[a._cellDataIndex];a._getCellEmpty=c?c.e||0:1}a._getCellIndex++}if(a._cellDataIndex<
a._data.length)return a._cellDataIndex}};e.getCell=function(c){c=a(this,c);if(void 0!==c)return this._data[c]};e.insertCell=function(c){this._data&&void 0!==a(this,c)&&this._data.splice(this._cellDataIndex,0,null)};return d}(),gd=function(){var d={add_row:!0,delete_row:!0},e={add_col:!0,delete_col:!0},a={add_row:!0,delete_row:!0,add_col:!0,delete_col:!0,new_cell:!0,clear_cell:!0,modify_cell:!0,move_cells:!0},c=function(a,b,c){this._page=c;this._top=this._left=null;this._extRowCount=this._extColCount=
this._bottom=this._right=void 0;this._merged=null;this._ajaxLoading=this._ajaxPending=0;this._hideMsg=!1;this._cellGridChanged=!0;this._showAnnotations=!1;this._fonts=a.sheet.fonts;this._styles=a.styles;a.formulas&&(this._formulas=a.formulas);a.sheet.hasOwnProperty("s")?this._sheetStyle=this.cellStyle(a.sheet.s):this._sheetStyle={};this._colMajor="colmajor"===a.sheet.order;this._defColWidth=a.sheet.defcw||80;this._defRowHeight=a.sheet.defrh||20;a.cols||(a.cols=[]);a.rows||(a.rows=[]);this._colCount=
0<a.sheet.c?a.sheet.c:a.cols.length;this._rowCount=0<a.sheet.r?a.sheet.r:a.rows.length;this._cols=[];for(var d=0;d<a.cols.length;d++){var e=a.cols[d];if(void 0!==e.s)for(var g=e.e||e.s,h=e.s;h<=g;h++)c=Ja(h),this._cols[h]=new Ea(e,this._defColWidth,c);else c=Ja(d),this._cols[d]=new Ea(e,this._defColWidth,c)}this._rows=[];for(d=0;d<a.rows.length;d++)if(e=a.rows[d],void 0!==e.s)for(g=e.e||e.s,h=e.s;h<=g;h++)c=Za(h),this._rows[h]=new Ea(e,this._defRowHeight,c);else c=Za(d),this._rows[d]=new Ea(e,this._defRowHeight,
c);a.cells&&k(this,a.cells);if(a.data)for(this._data=a.data,a=0;a<this._data.length;a++)c=this._data[a],c.f&&this._ajaxPending++,c.iend=a+1<this._data.length?this._data[a+1].i-1:this._colMajor?this._colCount:this._rowCount;this._embeds=b},b=X(c);b.showAnnotations=function(a){if(void 0!==a){var b=!1;!0!==a&&(a=!1);!0===a&&(this._annoRows||this._annoCols)?(this._annoRows&&this._rows!==this._annoRows&&(this._rows=this._annoRows,this._rowCount=this._annoRowCount,b=!0),this._annoCols&&this._cols!==this._annoCols&&
(this._cols=this._annoCols,this._colCount=this._annoColCount,b=!0)):(this._normalRows&&this._rows!==this._normalRows&&(this._rows=this._normalRows,this._rowCount=this._normalRowCount,b=!0),this._normalCols&&this._cols!==this._normalCols&&(this._cols=this._normalCols,this._colCount=this._normalColCount,b=!0));b&&(this._top=this._left=null,this._extRowCount=this._extColCount=this._bottom=this._right=void 0,this._cellGridChanged=!0,this._showAnnotations=a)}return this._showAnnotations};b.cellGridChanged=
function(a){void 0!==a&&(this._cellGridChanged=!!a);return this._cellGridChanged};b.getCellText=function(a,b){var c=this.getCell(a,b);return c?c.t||c.v||"":""};b.getCellComments=function(a,b,c){var d,e=this._page.comments();if(e)for(var g=0;g<e.length;g++){var h=e[g];if("cell"===h.type&&h.range&&"cell"===h.range.type){var f=h.range;this._showAnnotations&&h.annoRange&&(f=h.annoRange);a>=f.c1&&a<=f.c2&&b>=f.r1&&b<=f.r2&&(!c||f.c2==a&&f.r1==b)&&(d||(d=[]),d.push(h))}}return d};b.updateDimensions=function(){this._right=
this.colLeft(this._colCount);this._bottom=this.rowTop(this._rowCount);this._extColCount=this._colCount;this._extRowCount=this._rowCount;var a=this.embeddingCount();if(a){for(var b=0;b<a;b++){var c=this.embed(b);if(c){if(!c.expansionApplied){var d=this.embed(b);if(d.node&&!d.originApplied){d.originApplied=!0;d.adjustX=0;d.adjustY=0;var e=d.node.data("origin");e&&(e=e.split(","),2==e.length&&(d.adjustX=Number(e[0]),d.adjustY=Number(e[1])))}}var f=this.colWidth(c.c1),k=this.rowHeight(c.r1),m=c.x1,p=
c.y1;m>f&&(m=f);p>k&&(p=k);d=this.colLeft(c.c1)+m;e=this.rowTop(c.r1)+p;c.position={left:d,top:e};void 0===c.c2?(c.position.right=d+c.w,c.position.bottom=e+c.h):(f=this.colWidth(c.c2),k=this.rowHeight(c.r2),m=c.x2,p=c.y2,m>f&&(m=f),p>k&&(p=k),f=this.colLeft(c.c2)+m,p=this.rowTop(c.r2)+p,f<d&&(f=d),p<e&&(p=e),c.position.right=f,c.position.bottom=p);c.position.right>this._right&&(this._right=c.position.right);c.position.bottom>this._bottom&&(this._bottom=c.position.bottom)}}this._extColCount=this.colFromX(this._right)+
1;this._extRowCount=this.rowFromY(this._bottom)+1;this._right=this.colLeft(this._extColCount);this._bottom=this.rowTop(this._extRowCount)}};b.unload=function(){pa(this._data,function(a){a.ajax&&db(a.ajax)});this._embeds=this._styles=this._fonts=this._sheetStyle=this._merged=this._rows=this._cols=this._data=null};b.sheetStyle=function(){return this._sheetStyle};b.webFonts=function(){return this._fonts};b.getFormulaText=function(a,b){var c=this.getCell(a,b);if(c){if(!c.fa&&void 0!==c.fm){var d;a:{if(this._formulas&&
(d=this.getCell(a,b))&&"number"==typeof d.fm&&0<=d.fm&&d.fm<this._formulas.length){d=this._formulas[d.fm];break a}d=void 0}if(d){var e,h=b,f=d.f,u=0,k=0;e=a;if(this._showAnnotations)for(var m=0;m<e;m++){var p=this._cols[m];p&&p.title()==R.DEL&&e--}if(this._showAnnotations)for(m=0;m<h;m++)(p=this._rows[m])&&p.title()==R.DEL&&h--;c.fr||(u=e-d.c,k=h-d.r);d=ld(f,u,k,F.externalLinks());c.fa="="+d;c.fr&&(c.fa="{"+c.fa+"}")}}return c.fa}};b.showHidden=function(a){if(a){this._showHidden||(this._showHidden=
{columns:!1,rows:!1});if("string"===typeof a)switch(a){case "all":this._showHidden.columns=!0;this._showHidden.rows=!0;break;case "none":this._showHidden.columns=!1;this._showHidden.rows=!1;break;case "columns":this._showHidden.columns=!0;break;case "rows":this._showHidden.rows=!0}else void 0!==a.sheets&&void 0!==a.columns&&void 0!==a.rows&&(this._showHidden.columns=a.columns,this._showHidden.rows=a.rows);this.cellGridChanged(!0)}return this._showHidden};b.embeddingCount=function(){return this._embeds?
this._embeds.length:0};b.embed=function(a){if(this._embeds&&0<=a&&a<this._embeds.length)return(a=this._embeds[a])&&!a.node&&(a.node=y.byId(a.id),!a.node||a.node.hasClass("oit-svg-embed")||a.node.hasClass("oit-image-embed")||(a.node=a.node.parent())),a};b.embedByUID=function(a){return kb(this._embeds,"uid",a)};b.getCell=function(a,b){var c,d;this._colMajor?(d=this._cols[a])&&(c=d.getCell(b)):((d=this._rows[b])&&(c=d.getCell(a)),!c&&this._showAnnotations&&(d=this._cols[a])&&(c=d.getCell(b)));return c||
null};b.cellFromPos=function(a,b,c){this._right&&this._bottom||this.updateDimensions();a=this.colFromX(a);b=this.rowFromY(b);a>=this._extColCount&&(a=this._extColCount-1);b>=this._extRowCount&&(b=this._extRowCount-1);!1!==c&&(c=this.getMergedCell(a,b))&&(a=c.range.c1,b=c.range.r1);return ra(a,b)};b.prevTextCell=function(a,b){var c,d,e,h=a-50;0>h&&(h=0);if(this._colMajor)for(e=a-1;e>=h;e--){if((d=this._cols[e])&&(d=d.getCell(b))&&(d.t||d.v)){c=e;break}}else{var f=this._rows[b];if(f)for(e=a-1;e>=h;e--)if((d=
f.getCell(e))&&(d.t||d.v)){c=e;break}}return c};b.cellStyle=function(a){return this._styles&&void 0!==a&&0<=a&&a<this._styles.length?this._styles[a]:{}};b.rowCount=function(){void 0===this._bottom&&this.updateDimensions();return this._extRowCount};b.colCount=function(){void 0===this._right&&this.updateDimensions();return this._extColCount};b.eachRow=function(a){for(var b in this._rows)a(Number(b))};b.eachCol=function(a){for(var b in this._cols)a(Number(b))};b.rowHeight=function(a){return(a=this._rows[a])?
a.size():this._defRowHeight};b.colWidth=function(a){return(a=this._cols[a])?a.size():this._defColWidth};b.setRowHeight=function(a,b){var c=this._rows[a];c||(c=Za(a),this._rows[a]=c=new Ea(null,this._defRowHeight,c));c.setSize(b);this._top=null;this._right=void 0;this.cellGridChanged(!0)};b.setColWidth=function(a,b){var c=this._cols[a];c||(c=Ja(a),this._cols[a]=c=new Ea(null,this._defColWidth,c));c.setSize(b);this._left=null;this._bottom=void 0;this.cellGridChanged(!0)};b.showRow=function(a){return(a=
this._rows[a])&&a.show(this._defRowHeight)?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};b.showCol=function(a){return(a=this._cols[a])&&a.show(this._defColWidth)?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};b.resetRow=function(a){return(a=this._rows[a])&&a.reset()?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};b.resetCol=function(a){return(a=this._cols[a])&&a.reset()?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):
!1};b.colHidden=function(a){return(a=this._cols[a])?a.hidden():!1};b.colOriginalHidden=function(a){return(a=this._cols[a])?a.originalHidden():!1};b.rowHidden=function(a){return(a=this._rows[a])?a.hidden():!1};b.rowOriginalHidden=function(a){return(a=this._rows[a])?a.originalHidden():!1};b.colDeleted=function(a){return(a=this._cols[a])?a.deleted():!1};b.rowDeleted=function(a){return(a=this._rows[a])?a.deleted():!1};b.colStyle=function(a){return(a=this._cols[a])?this.cellStyle(a.style()):{}};b.rowTop=
function(a){if(!this._top){this._top=[];for(var b=0,c=0;c<=this._rows.length;c++){this._top.push(b);var d=this._rows[c],b=d?b+d.size():b+this._defRowHeight}}if(a<this._top.length)return this._top[a];b=this._top.length-1;return this._top[b]+(a-b)*this._defRowHeight};b.rowBottom=function(a){return this.rowTop(a+1)};b.rowFromY=function(a){for(var b=0;a>this.rowBottom(b);)b++;for(;!this.rowHeight(b)&&0<b;)b--;return b};b.colLeft=function(a){if(!this._left){this._left=[];for(var b=0,c=0;c<=this._cols.length;c++){this._left.push(b);
var d=this._cols[c],b=d?b+d.size():b+this._defColWidth}}if(a<this._left.length)return this._left[a];b=this._left.length-1;return this._left[b]+(a-b)*this._defColWidth};b.colRight=function(a){return this.colLeft(a+1)};b.colFromX=function(a){for(var b=0;a>this.colRight(b);)b++;for(;!this.colWidth(b)&&0<b;)b--;return b};b.sheetRight=function(){void 0===this._right&&this.updateDimensions();return this._right};b.sheetBottom=function(){void 0===this._bottom&&this.updateDimensions();return this._bottom};
b.colTitle=function(a,b){var c,d=this._cols[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedCols&&a>=this._colCount&&(a-=this._deletedCols),!1!==b&&(c=Ja(a)));return c};b.rowTitle=function(a,b){var c,d=this._rows[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedRows&&a>=this._rowCount&&(a-=this._deletedRows),!1!==b&&(c=Za(a)));return c};b.colType=function(a){var b;(a=this._cols[a])&&(b=a.type());return b};b.rowType=function(a){var b;(a=this._rows[a])&&(b=a.type());return b};
b.getMergedCell=function(a,b){var c;if(this._merged)for(var d=0;d<this._merged.length;d++){var e=this._merged[d].range;if(a>=e.c1&&a<=e.c2&&b>=e.r1&&b<=e.r2){c=this._merged[d];break}}return c};b.containsRange=function(a,b){if(this._colMajor)for(var c in this._cols){var d=this._cols[Number(c)];if(d&&d.getCellsForRange(a,b))return!0}else for(d in this._rows)if((c=this._rows[Number(d)])&&c.getCellsForRange(a,b))return!0;return!1};b.getCellsForRange=function(a,b){var c,d;if(this._colMajor)for(var e in this._cols){var f=
this._cols[Number(e)];f&&(d=f.getCellsForRange(a,b))&&(c=c?c.concat(d):d)}else for(f in this._rows)(e=this._rows[Number(f)])&&(d=e.getCellsForRange(a,b))&&(c=c?c.concat(d):d);return c};b.select=function(a){var b=!1,c,d;if(a&&"text"===a.type){if(0!==Sa(a,this._selectedRange)&&(this.select(null),c=this._selectedCells=this.getCellsForRange(a.acc,a.accend))){this._selectedRange=da(a);for(d=0;d<c.length;d++)b=c[d],b.selection=a,b.highlightsChanged=!0;b=!0}}else if(this._selectedCells){c=this._selectedCells;
delete this._selectedCells;delete this._selectedRange;for(d=0;d<c.length;d++)b=c[d],delete b.selection,b.highlightsChanged=!0;b=!0}return b};b.addHighlight=function(a){var b=!1,c,d;if(a)if("text"===a.range.type){var e=this.getCellsForRange(a.range.acc,a.range.accend);if(e){for(d=0;d<e.length;d++)c=e[d],c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);b=!0}!b&&this.hasPendingContent()&&(b=!0)}else if(a.isCompoundRedaction()&&
"cell"===a.range.type&&(e=this.mapToText(a.range)))for(d=0;d<e.length;d++)if(c=e[d],c=this.getCell(c.cell.c,c.cell.r))c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);return b};b.removeHighlight=function(a){if(a){var b,c;if("text"==a.range.type){var d=this.getCellsForRange(a.range.acc,a.range.accend);if(d){for(c=0;c<d.length;c++)b=d[c],b.highlights&&(Da(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=
!0);return!0}}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(d=this.mapToText(a.range)))for(c=0;c<d.length;c++)b=d[c],(b=this.getCell(b.cell.c,b.cell.r))&&b.highlights&&(Da(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0)}return!1};b.expandRange=function(a){a=da(a);if(this._merged){var b;do{b=!1;for(var c=0;c<this._merged.length;c++){var d=this._merged[c];a.c1<=d.range.c2&&a.c2>=d.range.c1&&a.r1<=d.range.r2&&a.r2>=d.range.r1&&(d.range.c1<a.c1&&(a.c1=d.range.c1,
b=!0),d.range.r1<a.r1&&(a.r1=d.range.r1,b=!0),d.range.c2>a.c2&&(a.c2=d.range.c2,b=!0),d.range.r2>a.r2&&(a.r2=d.range.r2,b=!0))}}while(b)}return a};b.getHoverText=function(){if(!x.showCellTooltips||this.isRangeSelected())return null;var a=P.cellSelection();return(a=this.getCell(a.c1,a.r1))&&a.clipped?a.t||a.v:null};b.isRangeSelected=function(){var a=!1,b=P.cellSelection();if(b&&(b.c1!=b.c2||b.r1!=b.r2)&&(a=!0,this._merged))for(var c=0;c<this._merged.length;c++){var d=this._merged[c];if(b.c1==d.range.c1&&
b.c2==d.range.c2&&b.r1==d.range.r1&&b.r2==d.range.r2){a=!1;break}}return a};b.getSelectedText=function(){var a="",b;switch(P.selectionType()){case "text":if(this._selectedCells){b=P.textSelection();for(var c=this._selectedCells,d=0;d<c.length;d++){var e=c[d];if(e.t){var f=b.acc-e.a;0>f&&(f=0);var k=b.accend-e.a;k>f&&(a&&(a+="\t"),a+=e.t.substring(f,k))}}}break;case "cell":if(b=P.cellSelection(),this.isRangeSelected())for(c=0,d=b.r1;d<=b.r2;d++){e=0;for(f=b.c1;f<=b.c2;f++){if(k=this.getCellText(f,
d)){if(0<c)for(1E3<c&&(c=1E3);0<c;c--)a+="\r\n";if(0<e)for(1E3<e&&(e=1E3);0<e;e--)a+="\t";a+=k}e++}c++}else a=this.getCellText(b.c1,b.r1)||""}return a};b.mapToCells=function(a){if("text"==a.type){var b=[],c=a.acc;a=a.accend;if(this._colMajor)for(var d in this._cols){var e=Number(d),f=e,e=this._cols[e],h=b;if(e){var k=e.getCellsForRange(c,a);if(k)for(var m=0;m<k.length;m++){var p=e.getIndexForCell(k[m]),l=this.getMergedCell(f,p);l?h.push(da(l.range)):h.push(ra(f,p))}}}else for(f in this._rows)if(d=
e=Number(f),e=this._rows[e],h=b,e&&(k=e.getCellsForRange(c,a)))for(m=0;m<k.length;m++)p=e.getIndexForCell(k[m]),(l=this.getMergedCell(p,d))?h.push(da(l.range)):h.push(ra(p,d));return b}};b.mapToText=function(a){if("cell"==a.type){var b;a=f(a);for(var c=a.r1;c<=a.r2;c++)for(var d=a.c1;d<=a.c2;d++){var e=this.getCell(d,c);if(e&&e.t&&void 0!==e.a){var h=e.a+e.t.length;b||(b=[]);e=fa(e.a,h);e.cell={c:d,r:c};b.push(e)}}return b}};b.decomposeRange=function(a,b){if("cell"==a.type){a=f(a);var c=this.mapToText(a);
if(b)c?c.push(a):c=[a];else{for(var d=[],e=a.r1;e<=a.r2;e++)for(var h=null,k=a.c1;k<=a.c2;k++){var m=this.getCell(k,e);m&&m.v&&(h&&h.c2==k-1?h.c2=k:(h=ra(a.page,k,e,k,e),d.push(h)))}if(0<d.length)for(c||(c=[]),e=0;e<d.length;e++)if(h=d[e]){for(k=e+1;k<d.length;k++)(m=d[k])&&m.r1==h.r2+1&&m.c1==h.c1&&m.c2==h.c2&&(h.r2=m.r2,d[k]=null);c.push(h)}}return c}};var f=function(a){var b=a;if("cell"==a.type&&a.offsets){var b=a.c1,c=a.c2,d=a.r1,e=a.r2,f;b>c&&(f=b,b=c,c=f);d>e&&(f=d,d=e,e=f);0>a.offsets.left&&
0<b&&b--;0<a.offsets.right&&c++;0>a.offsets.top&&0<d&&d--;0<a.offsets.bottom&&e++;b=ra(a.page,b,d,c,e)}return b},k=function(a,b){var c,d,e,f=a._colMajor?a._cols:a._rows;c=0;var h,k=[];for(e=0;e<b.length;e++){var m=b[e];m instanceof Array?h=c:(c=m.i,h=m.e||m.i,m=m.d);var u;u=a._colMajor?new Ea(null,a._defColWidth,null):new Ea(null,a._defRowHeight,null);for(var p=c;p<=h;p++){f[p]||(f[p]=u);f[p].setCellData(m);for(var l=0,n=0;l<m.length;l++){d=m[l];d.fr&&k.push(d);if(d.mh||d.mv)a._merged||(a._merged=
[]),c=a._colMajor?ra(p,n,p,n):ra(n,p,n,p),d.mh&&(c.c2+=d.mh),d.mv&&(c.r2+=d.mv),a._merged.push({cell:d,range:c});d.e?n+=d.e:n++}}c=h+1}for(e=0;e<k.length;e++)for(d=k[e],c=Gb(d.fr),f=c.c1;f<=c.c2;f++)for(h=c.r1;h<=c.r2;h++)(m=a.getCell(f,h))&&m!==d&&(m.fr=d.fr,m.fm=d.fm)},v=function(a,b,c,d,e,f,m){f.loaded=!0;delete f.ajax;0===--e._ajaxLoading&&e._hideMsg&&(Ga.hideMessage(),e._hideMsg=!1);if(200===d){var g=JSON.parse(c);g.cells&&(k(e,g.cells),M.each(function(a){e.addHighlight(a)},e._page),D.update(!0))}else e.logAJAXError(null,
"Failed to load the spreadsheet data for sheet "+(e._page+1)+" from the server",a,d,c);if(m){for(var g=[e],h=7;h<arguments.length;h++)g.push(arguments[h]);m.apply(null,g)}},l=function(a,b,c){if(b.f&&!b.loaded&&!b.ajax){var d=b.f;"/"!=d.charAt(0)&&(d=Ka(w.baseURL,d));b.ajax=Ia({url:d,context:a,complete:v,args:Array.prototype.slice.call(arguments)});a._ajaxPending--;a._ajaxLoading++;1!=a._ajaxLoading||Ga.messageVisible()||(Ga.showMessage(R.PLEASE_WAIT_DOWNLOADING),a._hideMsg=!0)}};b.hasPendingContent=
function(){return 0<this._ajaxPending||0<this._ajaxLoading};b.loadRange=function(a,b){if(this._data)switch(a.type){case "text":var c=this.mapToCells(a);c&&0!==c.length||ba(r,0,this,this,a,b);break;case "cell":this.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,b)}b&&b(a)};var r=function(a,b,c){var d=a.mapToCells(b);if(d&&0<d.length)c&&c(b);else for(d=0;d<a._data.length;d++){var e=a._data[d];if(e&&!e.loaded&&!e.ajax){l(a,e,r,b,c);break}}};b.loadDataForCells=function(a,b,c,d,e,f){if(void 0===a||void 0===b||
void 0===c||void 0===d)f&&f();else if(this._data){this._colMajor||(a=b,c=d);e&&this._deferredTimer&&(sa(this._deferredTimer),delete this._deferredTimer);var g;for(d=0;d<this._data.length;d++)if((b=this._data[d])&&!b.loaded&&!b.ajax){if(b.i>c)break;if(b.iend>=a){var h=!1;if(this._colMajor)for(var k=b.i;k<=b.iend;k++){if(!this.colHidden(k)){h=!0;break}}else for(k=b.i;k<=b.iend;k++)if(!this.rowHidden(k)){h=!0;break}h&&(g||(g=[]),g.push(b))}}g?e?this._deferredTimer=ba(m,200,this,g,f):m.call(this,g,f):
f&&f()}else f&&f()};var m=function(a,b){for(var c=0;c<a.length;c++)l(this,a[c],b)},p=function(a){var b;if(a&&void 0!==a.sheet){var c=B.page(a.sheet);if(c&&c.isLoaded()){var d=c.spreadsheetModel();if(d){b=a.c1;var e=a.r1,f=a.c2,h=a.r2,k=a=!1;void 0===b?(b=0,f=d.colCount()-1,a=!0):void 0===f&&(f=b);void 0===e?(e=0,h=d.rowCount()-1,k=!0):void 0===h&&(h=e);b=ra(c.index,b,e,f,h);a&&(b.selectingRows=!0);k&&(b.selectingCols=!0)}}}return b},z=function(a,b,c){for(a=0;a<b.cells.length;a++){c=b.cells[a];var d=
p(c.ref);d&&(delete c.ref,c.range=d)}},q=function(a){for(var b={t:""},c=0;c<a.text.length;c++){var d=a.text[c];if(d.range){var e=ja.getRawText(d.range.acc,d.range.accend);e&&(b.t+=e,b.a||(b.a=d.range.acc))}else d.text&&(b.t+=d.text,delete b.a)}return b},G=function(a,b,c){b.resolved||(b.ref&&(void 0===b.ref.sheet||b.page||(b.page=B.page(b.ref.sheet)),b.range=p(b.ref),b.range&&delete b.ref),b.oldref&&(b.oldrange=p(b.oldref),b.oldrange&&delete b.oldref),b.user&&(c&&(b.author=c[b.user]),delete b.user),
b.ref||b.oldref||(b.resolved=!0));b.resolved&&b.page&&b.page===a._page&&(a._revisions||(a._revisions=[]),-1==a._revisions.indexOf(b)&&(a._revisions.push(b),"delete_row"===b.type?a._deletedRows++:"delete_col"===b.type&&a._deletedCols++))},V=function(a,b){var c=b.indexOf(a);if(-1==c)for(var d in b){var e=b[d];if(e&&e.clonedFrom&&e.clonedFrom===a){c=parseInt(d,10);break}}return c},T=function(a,b){if(b&&(b.col||b.row)){var c=da(b),d,e=c.c1==c.c2,f=c.r1==c.r2;b.col&&(a._annoCols&&(d=V(b.col,a._annoCols),
-1!=d&&(c.c1=d)),delete b.col);b.col2?(a._annoCols&&(d=V(b.col2,a._annoCols),-1!=d&&(c.c2=d)),delete b.col2):e&&(c.c2=c.c1);b.row&&(a._annoRows&&(d=V(b.row,a._annoRows),-1!=d&&(c.r1=d)),delete b.row);b.row2?(a._annoRows&&(d=V(b.row2,a._annoRows),-1!=d&&(c.r2=d)),delete b.row2):f&&(c.r2=c.r1);return c}};b.processRevisions=function(a,b,c){var d=!1;if(a&&a.revisions){var e=this,f;e._deletedCols=0;for(f=e._deletedRows=0;f<a.revisions.length;f++)G(e,a.revisions[f],a.users);if(e._revisions){a=ra(e._page.index,
0,0,0,0);for(f=0;f<e._revisions.length;f++)d=e._revisions[f],Db(a,d.range),Db(a,d.oldrange);e.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,function(){var a,d=e._cols.slice(0),f=e._rows.slice(0);e._normalColCount=e._colCount;e._annoColCount=e._colCount+e._deletedCols;e._normalCols=e._cols;e._annoCols=e._cols.slice(0);e._normalRowCount=e._rowCount;e._annoRowCount=e._rowCount+e._deletedRows;e._normalRows=e._rows;e._annoRows=e._rows.slice(0);for(a=e._revisions.length-1;0<=a;a--){var g=e._revisions[a],h,k,
n,m=e;k=g;g=g.range;h=d;var p=f;if(g)switch(k.type){case "add_row":g.row=p[g.r1];g.row||(n=Za(g.r1),g.row=p[g.r1]=new Ea(null,m._defRowHeight,n),m._annoRows[g.r1]||(m._annoRows[g.r1]=g.row));g.col=h[g.c1];g.col2=h[g.c2];g.row.revision(k);p.splice(g.r1,1);break;case "add_col":g.col=h[g.c1];g.col||(n=Ja(g.c1),g.col=h[g.c1]=new Ea(null,m._defColWidth,n),m._annoCols[g.c1]||(m._annoCols[g.c1]=g.col));g.row=p[g.r1];g.row2=p[g.r2];g.col.revision(k);h.splice(g.c1,1);break;case "delete_row":n=g;var u=m,l=
k,t=new Ea(null,u._defRowHeight,R.DEL);t.revision(l);l.target=t;z(u,l,t);for(var u=0,A=[],E=0;E<l.cells.length;E++){var r=l.cells[E];r.range.c1>u&&(A.push({e:r.range.c1-u}),u=r.range.c1);A.push(q(r));u++}t.setCellData(A);n.row=t;g.col=h[g.c1];g.col2=h[g.c2];for(g.row.revision(k);g.r1>p.length;)p.push(null);p.splice(g.r1,0,g.row);h=0<g.r1?(h=p[g.r1-1])?m._annoRows.indexOf(h)+1:g.r1:(h=p[g.r1+1])?m._annoRows.indexOf(h):g.r1;for(;h>m._annoRows.length;)m._annoRows.push(null);m._annoRows.splice(h,0,g.row);
if(m._colMajor)for(n=0;n<m._annoCols.length;n++)if(h=m._annoCols[n])k=m._normalCols.indexOf(h),-1!=k&&(k=h,h=k.clone(),m._annoCols[n]=h,k=p.indexOf(k),-1!=k&&(p[k]=h)),h.insertCell(g.r1);break;case "delete_col":n=g;u=m;l=k;t=new Ea(null,u._defColWidth,R.DEL);t.revision(l);l.target=t;z(u,l,t);u=0;A=[];for(E=0;E<l.cells.length;E++)r=l.cells[E],r.range.r1>u&&(A.push({e:r.range.r1-u}),u=r.range.r1),A.push(q(r)),u++;t.setCellData(A);n.col=t;g.row=p[g.r1];g.row2=p[g.r2];for(g.col.revision(k);g.c1>h.length;)h.push(null);
h.splice(g.c1,0,g.col);h=0<g.c1?(h=h[g.c1-1])?m._annoCols.indexOf(h)+1:g.c1:(h=h[g.c1+1])?m._annoCols.indexOf(h):g.c1;for(;h>m._annoCols.length;)m._annoCols.push(null);m._annoCols.splice(h,0,g.col);if(!m._colMajor)for(n=0;n<m._annoRows.length;n++)if(h=m._annoRows[n])k=m._normalRows.indexOf(h),-1!=k&&(k=h,h=k.clone(),m._annoRows[n]=h,k=p.indexOf(k),-1!=k&&(p[k]=h)),h.insertCell(g.c1);break;case "clear_cell":for(;g.c2>=h.length;)n=Ja(h.length),k=new Ea(null,m._defColWidth,n),h.push(k),m._annoCols.push(k);
for(;g.r2>=p.length;)n=Za(p.length),k=new Ea(null,m._defRowHeight,n),p.push(k),m._annoCols.push(k);case "new_cell":case "modify_cell":case "move_cells":g.col=h[g.c1],g.row=p[g.r1],g.c2!=g.c1&&(g.col2=h[g.c2]),g.r2!=g.r1&&(g.row2=p[g.r2])}}for(a=0;a<e._revisions.length;a++){f=e;d=e._revisions[a];if(m=T(f,d.range))d.annoRange=m;if(f=T(f,d.oldrange))d.oldAnnoRange=f}if(a=e._page.comments())for(d=0;d<a.length;d++)g=a[d],"cell"===g.type&&g.range&&"cell"===g.range.type&&(f=g,m=e,g=g.range,m._normalCols&&
m._normalRows?(g.col=m._normalCols[g.c1],g.row=m._normalRows[g.r1],g.c2!=g.c1&&(g.col2=m._normalCols[g.c2]),g.r2!=g.r1&&(g.row2=m._normalRows[g.r2]),m=T(m,g)):m=void 0,f.annoRange=m);e.showAnnotations(x.showAnnotations);delete e._revisionMap;b&&b.call(c)});d=!0}}return d};b.revisions=function(){return this._revisions};b.rowRevisions=function(a){if(a=this._rows[a])return a.revision()};b.colRevisions=function(a){if(a=this._cols[a])return a.revision()};var J=function(a,b,c){a[b]?(Array.isArray(a[b])||
(a[b]=[a[b]]),a[b].push(c)):a[b]=c},N=function(a,b,c){for(var d=b.r1;d<=b.r2;d++)for(var e=b.c1;e<=b.c2;e++){var f=e,g=c,h=a[d];h||(h=a[d]=[]);h[f]?(Array.isArray(h[f])||(h[f]=[h[f]]),h[f].push(g)):h[f]=g}},E=function(a,b){a&&(b||(b=[]),Array.isArray(a)?Array.prototype.push.apply(b,a):b.push(a));return b};b.getCellRevisions=function(b,c){var f;if(this._revisions){if(!this._revisionMap){for(var h=this._revisions,k={cols:[],rows:[],cells:[]},m=0;m<h.length;m++){var p=h[m],l=p.annoRange||p.range,u=p.oldAnnoRange||
p.oldrange;d[p.type]?(l&&J(k.rows,l.r1,p),u&&J(k.rows,u.r1,p)):e[p.type]?(l&&J(k.rows,l.c1,p),u&&J(k.rows,u.c1,p)):a[p.type]&&(l&&N(k.cells,l,p),u&&N(k.cells,u,p))}this._revisionMap=k}f=E(this._revisionMap.cols[b],f);f=E(this._revisionMap.rows[c],f);(h=this._revisionMap.cells[c])&&(f=E(h[b],f))}return f};return c}(),md=function(){var d={f:"_font",s:"_fontSize",fs:"_fontStyle",fw:"_fontWeight",d:"_textdec",ba:"_baseline",ta:"_angle",c:"_color",w:"_wrap",a:"_align",i:"_indent",v:"_valign",bdr:"_bdr",
b:"_fill",bb:"_fillBg",bh:"_fillHatch"},e=function(a,b,c,e){this._data=a;this._model=b;this._style=a.s?b.cellStyle(a.s):{};a.t?this._text=a.t:a.v&&(this._text=a.v);var f=this._style,h=a.c?b.colStyle(c):{},k=b.sheetStyle();this._font="Arial";this._fontSize=10;this._align="g";this._indent=0;this._valign="b";for(var g in d)if(d.hasOwnProperty(g)){var m=f[g]||h[g]||k[g];void 0!==m&&(this[d[g]]=m)}a.c&&(this._color=a.c);if(this._angle&&"vertical"!==this._angle){for(;0>this._angle;)this._angle+=360;for(;360<=
this._angle;)this._angle-=360;0===this._angle?this._angle=null:(this._angle=(360-this._angle)*Math.PI/180,this._align="l",this._valign="b",this._indent=0)}this._bdr&&(this._topBorder=this._bdr[0],this._rightBorder=this._bdr[1],this._bottomBorder=this._bdr[2],this._leftBorder=this._bdr[3],a.bs&&(-1!=a.bs.indexOf("t")&&(this._topBorder=null),-1!=a.bs.indexOf("r")&&(this._rightBorder=null),-1!=a.bs.indexOf("b")&&(this._bottomBorder=null),-1!=a.bs.indexOf("l")&&(this._leftBorder=null)),delete this._bdr);
2>this._indent&&(this._indent=2);this._clearLeft=this._textRight=this._textLeft=0;this._clearRight=void 0;if(a=b.getCellComments(c,e,!0))this._comments=a;if(b=b.getCellRevisions(c,e))for(a=0;a<b.length;a++)if(f=b[a],f.range&&f.range.c1==c&&f.range.r1==e||f.oldrange&&f.oldrange.c1==c&&f.oldrange.r1==e){this._hasRevision=!0;break}},a=X(e);a.hasText=function(){return this._text&&0<this._text.length};a.textRight=function(){return this._textRight};a.horizontalMerge=function(){return this._data.mh||0};
a.verticalMerge=function(){return this._data.mv||0};a.horizontalAlign=function(){return this._align};a.leftBorder=function(){return this._leftBorder||null};a.topBorder=function(){return this._topBorder||null};a.rightBorder=function(){return this._rightBorder||null};a.bottomBorder=function(){return this._bottomBorder||null};a.rangeRect=function(a){var b=this._wrappedText;if("text"===a.type&&b){var c,d=a.acc-this._data.a;a=a.accend-this._data.a;0>d&&(d=0);a>this._text.length&&(a=this._text.length);
for(var e=0;e<b.length;e++)for(var f=b[e],k=f.x,g=f.y,m=f.o,p=0;p<f.spans.length;p++){var l=f.spans[p],q=m+l.t.length;if(q>d&&m<a){var m=k+l.w,z=g+f.h;c?(k<c.left&&(c.left=k),g<c.top&&(c.top=g),m>c.right&&(c.right=m),z>c.bottom&&(c.bottom=z)):c={left:k,top:g,right:m,bottom:z}}k+=l.w;m=q}return c}};a.drawTextBackground=function(a,b,c,d,e,f,k){if(0>this._textLeft||this._textRight>f)b=d+this._textLeft,d+=this._textRight,b<this._clearLeft&&(b=this._clearLeft),void 0!==this._clearRight&&d>=this._clearRight&&
(d=this._clearRight-1),a.oitrect(b+1,e+1,d-b-1,k-1,"#ffffff")};a.drawBackground=function(a,b,c,d,e,f,k){if(this._fill||this.horizontalMerge()||this.verticalMerge())if(this._fillHatch){b=new hc(8,8);c=b.getContext("2d");this._fillBg&&c.oitrect(0,0,8,8,this._fillBg);c.strokeStyle=this._fill||"#ffffff";c.lineCap="square";"d"==this._fillHatch.charAt(0)?c.lineWidth=2:c.lineWidth=1;switch(this._fillHatch){case "lv":case "dv":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);break;case "lh":case "dh":c.oitline(0,
1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "ldd":case "ddd":c.oitline(-.5,-.5,8.5,8.5);break;case "lud":case "dud":c.oitline(8.5,-.5,-.5,8.5);break;case "lg":case "dg":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "lt":case "dt":c.oitline(0,0,8,8),c.oitline(8,0,0,8)}b=a.createPattern(y.unwrap(b),"repeat");a.fillStyle=b;a.globalAlpha=1;a.fillRect(d+.5,e+.5,f+.5,k+.5)}else a.oitrect(d+.5,e+.5,f+.5,k+.5,this._fill||"#ffffff")};var c=function(a,
b,c,d,e){c||(c=1);var f=2*c;switch(b){case "dotted":b=[f,f];break;case "dashed":b=[2*f,f];break;case "dashdot":b=[2*f,f,f,f];break;case "dashdotdot":b=[2*f,f,f,f,f,f];break;case "double":b=[];c=Math.floor(c/3);1>c&&(c=1);break;default:b=[]}for(var k=f=0;k<b.length;k++)f+=b[k];e%=f;a.strokeStyle=d||"black";a.fillStyle=d||"black";a.lineWidth=c;a.setLineDash?(a.setLineDash(b),a.lineDashOffset=e):(a.mozDash=b,a.mozDashOffset=e)},b=function(a){var b=Math.floor(a.w/3);1>b&&(b=1);a=a.w-(b+b);1>a&&(a=1);
b=(b+a)/2;return[-b,b]},f=function(a,c){var d=0,e=0,f;a&&"double"===a.s&&(f=b(a),d=-f[0]);c&&"double"===c.s&&(f=b(c),e=f[1]);return d&&e?d>e?-d:-e:d?d:e},k=function(a,c){var d=0,e=0,f;a&&"double"===a.s&&(f=b(a),d=-f[0]);c&&"double"===c.s&&(f=b(c),e=f[1]);return d&&e?[-d,-e]:d?[-d,d]:[e,-e]},v=function(a,d,e,m,p,h,l,g,t){c(a,p.s,p.w,p.c,d);"double"===p.s?(p=b(p),h=k(h,l),g=k(g,t),h[0]||(h[0]=-.5),h[1]||(h[1]=-.5),g[0]||(g[0]=.5),g[1]||(g[1]=.5),a.beginPath(),a.moveTo(d-h[0],e+p[0]),a.lineTo(m+g[0],
e+p[0]),a.moveTo(d-h[1],e+p[1]),a.lineTo(m+g[1],e+p[1])):(p=f(h,l),g=f(g,t),p||(p=-.5),g||(g=.5),a.beginPath(),a.moveTo(d-p,e+.5),a.lineTo(m+g,e+.5));a.stroke()},l=function(a,d,e,m,p,h,l,g,t){c(a,p.s,p.w,p.c,e);"double"===p.s?(p=b(p),h=k(h,l),g=k(g,t),h[0]||(h[0]=-.5),h[1]||(h[1]=-.5),g[0]||(g[0]=.5),g[1]||(g[1]=.5),a.beginPath(),a.moveTo(d+p[0],e-h[0]),a.lineTo(d+p[0],m+g[0]),a.moveTo(d+p[1],e-h[1]),a.lineTo(d+p[1],m+g[1])):(p=f(h,l),g=f(g,t),p||(p=-.5),g||(g=.5),a.beginPath(),a.moveTo(d+.5,e-p),
a.lineTo(d+.5,m+g));a.stroke()},r=function(a,b){var c=null;a&&(c=a.bottomBorder());if(b){var d=b.topBorder();d&&(!c||d.w>c.w)&&(c=d)}return c},m=function(a,b){var c=null;a&&(c=a.rightBorder());if(b){var d=b.leftBorder();d&&(!c||d.w>c.w)&&(c=d)}return c};a.drawBorder=function(a,b,d,e,f,h,k,g){if(this._topBorder||this._rightBorder||this._bottomBorder||this._leftBorder){var p=e+h;k=f+k;a.lineCap="square";a.lineJoin="miter";a.globalAlpha=1;var q;this._leftBorder&&0<=this._textLeft&&0<b&&(b=r(g[0][0],
g[1][0]),q=r(g[1][0],g[2][0]),l(a,e,f,k,this._leftBorder,b,this._topBorder,q,this._bottomBorder));this._topBorder&&0<d&&(b=m(g[0][0],g[0][1]),d=m(g[0][1],g[0][2]),v(a,e,f,p,this._topBorder,b,this._leftBorder,d,this._rightBorder));this._rightBorder&&this._textRight<=h&&(d=r(g[0][2],g[1][2]),h=r(g[1][2],g[2][2]),l(a,p,f,k,this._rightBorder,this._topBorder,d,this._bottomBorder,h));this._bottomBorder&&(q=m(g[2][0],g[2][1]),h=m(g[2][1],g[2][2]),v(a,e,k,p,this._bottomBorder,this._leftBorder,q,this._rightBorder,
h));c(a,null)}};var p=function(a,b,c,d){if(c||d){var e={s:{},o:-1,oend:-1};"text"===b.type?(e.o=b.acc-a._data.a,0>e.o&&(e.o=0),e.oend=b.accend-a._data.a):(e.o=0,e.oend=a._text.length);c&&(e.s.c=c);d&&(e.s.bg=Ha(d));return e}};a.layoutText=function(a,b,c,d,e,f,k){if(this.hasText()){var g,h,m;c=!1;var l=null;g=this._data.selection;var u=this._data.highlights;if(g||u&&0<u.length){l=[];g&&(m=P.style()||"color:white;background-color:#3399FF;",h=pb(m,"color"),m=pb(m,"background-color"),(h=p(this,g,h,m))&&
l.push(h));if(u)for(g=0;g<u.length;g++){var r=u[g];m=r.highlightStyleProps();h=m.color;m=m["background-color"];(h=p(this,r.range,h,m))&&l.push(h)}delete this._data.highlightsChanged}this._wrappedText&&rc(l,this._highlightSpecs,!0)||(this._highlightSpecs&&!l?delete this._highlightSpecs:this._highlightSpecs=l,this._wrappedText=null);this.horizontalMerge()||this.verticalMerge()?(this._clearLeft=b,this._clearRight=b+d):(this._clearLeft=f,this._clearRight=k);d!=this._layoutWidth&&(this._wrappedText=null);
e!=this._layoutHeight&&(this._wrappedText=null,c=!0);if(!this._wrappedText&&(this._textLeft=0,this._layoutWidth=this._textRight=d,"l"==this._align?this._textLeft=this._indent:"r"==this._align&&(this._textRight=d-this._indent),g=this._textRight-this._textLeft,c=!0,this._wrap||this._angle?this._wrappedText=this.wrapText(a,g,e):this._data.cs||-1!=this._text.indexOf("\n")?this._wrappedText=this.wrapText(a,void 0,e):(b=this.createLine(0,this._text.length,null),z(a,b,this),q(a,b,this),this._wrappedText=
[b]),a=this._wrappedText))if(g=void 0!==this._data.v,g="r"==this._align||"rs"==this._align||g&&"g"==this._align,"c"==this._align||"cs"==this._align)for(g=0;g<a.length;g++)b=a[g],b.x=(d-b.w)/2,f=b.x+b.w,b.x<this._textLeft&&(this._textLeft=b.x),f>this._textRight&&(this._textRight=f);else if(g)for(g=0;g<a.length;g++)b=a[g],b.x=d-2-b.w-this._indent,b.x<this._textLeft&&(this._textLeft=b.x);else for(g=0;g<a.length;g++)b=a[g],b.x=this._indent,f=b.x+b.w,f>this._textRight&&(this._textRight=f);this._layoutHeight=
e;if(c)for(a=this._wrappedText,d=a[a.length-1],d=d.y+d.h-a[0].y,c=0,"c"==this._valign?c=(e-d)/2:"b"==this._valign&&(c=e-d-2),g=0;g<a.length;g++)b=a[g],b.y=c,c+=b.h}};a.drawText=function(a,b,c,d,e,f,k){if(b=this._wrappedText){c=!1;var g=b[b.length-1],g=g.y+g.h-b[0].y;this._data.clipped=!1;if(0>this._textLeft||this._textRight>f||g>k){f=d+this._textLeft;var h=d+this._textRight;if(f<this._clearLeft||void 0!==this._clearRight&&h>this._clearRight||g>k)f<this._clearLeft&&(f=this._clearLeft),void 0!==this._clearRight&&
h>this._clearRight&&(h=this._clearRight),a.save(),c=!0,a.beginPath(),a.fillStyle="black",a.rect(f,e,h-f,k),a.clip(),this._data.clipped=!0}a.globalAlpha=1;a.textAlign="left";a.textBaseline="alphabetic";this._angle&&"vertical"!==this._angle&&0<b.length&&(c||(a.save(),c=!0),a.translate(d+b[0].x,e+b[0].y),d=-b[0].x,e=-b[0].y,a.rotate(this._angle));for(f=0;f<b.length;f++){g=b[f];if(g.y>k)break;for(var h=d+g.x,m=e+g.y,p=0;p<g.spans.length;p++){var l=g.spans[p],q=this._font,u=this._fontSize,z=this._fontStyle,
r=this._fontWeight,v=this._color,n=this._textdec,C=this._baseline,w=null;l.s&&(l.s.f&&(q=l.s.f),l.s.s&&(u=l.s.s),l.s.fs&&(z=l.s.fs),l.s.fw&&(r=l.s.fw),l.s.c&&(v=l.s.c),l.s.d&&(n=l.s.d),l.s.ba&&(C=l.s.ba),l.s.bg&&(w=l.s.bg));l.hs&&(l.hs.c&&(v=l.hs.c),l.hs.bg&&(w=l.hs.bg));var E=K(m+g.a);C&&("sup"===C?(E+=-.35*g.a,u*=.65):"sub"===C&&(E+=.141*g.a,u*=.65));if(w){C=w;w=1;if(0===C.indexOf("rgba(")||0===C.indexOf("rgb(")){var y=ya(C);y&&(C=Ha(y.r,y.g,y.b),w=y.a)}a.fillStyle=C;a.globalAlpha=w;a.fillRect(h-
1,E-g.a,l.w+2,g.h+2)}a.font=x(q,u,z,r);a.fillStyle=v||"black";a.globalAlpha=1;a.fillText(l.t,h,E);if(n){var J,B,N;switch(n){case "u":N=1;J=E+N;break;case "d":N=1;J=E+N;B=J+N+N;break;case "l":N=1,J=E-.25*l.a}void 0!==J&&(J=K(J)+.5,a.strokeStyle=v,a.lineWidth=N,a.beginPath(),a.moveTo(h,J),a.lineTo(h+l.w,J),void 0!==B&&(B=K(B)+.5,a.moveTo(h,B),a.lineTo(h+l.w,B)),a.stroke(),a.closePath())}h+=l.w}}c&&a.restore()}};a.drawFlags=function(a,b,d,e,f,h,k){void 0!==this._data.fm&&(b=f+k,a.lineCap="square",a.lineJoin=
"miter",a.globalAlpha=1,a.strokeStyle="rgba(52,113,183,0.5)",a.fillStyle="rgba(52,113,183,0.5)",a.lineWidth=1,a.beginPath(),a.moveTo(e,b),a.lineTo(e,b-6),a.lineTo(e+6,b),a.lineTo(e,b),a.fill(),c(a,null));this._comments&&(e+=h,a.lineCap="square",a.lineJoin="miter",a.globalAlpha=1,a.strokeStyle="rgb(255,0,0)",a.fillStyle="rgb(255,0,0)",a.lineWidth=1,a.beginPath(),a.moveTo(e,f),a.lineTo(e,f+6),a.lineTo(e-6,f),a.lineTo(e,f),a.fill(),c(a,null))};a.createLine=function(a,b,c){var d={x:0,y:0,w:0,h:0,spans:[],
o:a},e,f,k,g;if(c){g=a;for(var m,p=0;p<c.length;p++){e=c[p];if(e.o>g&&(f=e.o,f>b&&(f=b),g=this._text.substring(g,f),d.spans.push({t:g,w:0,s:m}),g=f,g>=b))break;m=this._model.cellStyle(e.s)}g<b&&(g=this._text.substring(g,b),d.spans.push({t:g,w:0,s:m}))}else g=this._text.substring(a,b),d.spans.push({t:g,w:0});if(this._highlightSpecs)for(b=0;b<this._highlightSpecs.length;b++)for(c=this._highlightSpecs[b],g=a,m=0;m<d.spans.length;m++)p=d.spans[m],f=g+p.t.length,c.o<f&&c.oend>g&&(e=c.o-g,0<e&&(f=p.t.substring(0,
e),k=p.t.substring(e),e={t:f,w:0},p.s&&(e.s=p.s),p.hs&&(e.hs={},p.hs.c&&(e.hs.c=p.hs.c),p.hs.bg&&(e.hs.bg=p.hs.bg)),d.spans.splice(m,0,e),m++,p.t=k,g+=f.length,f=g+p.t.length),e=c.oend-g,e<p.t.length&&(f=p.t.substring(0,e),k=p.t.substring(e),e={t:k,w:0},p.s&&(e.s=p.s),p.hs&&(e.hs={},p.hs.c&&(e.hs.c=p.hs.c),p.hs.bg&&(e.hs.bg=p.hs.bg)),d.spans.splice(m+1,0,e),p.t=f,f=g+p.t.length),p.hs||(p.hs={}),c.s.c&&(p.hs.c=c.s.c),c.s.bg&&(p.hs.bg=c.s.bg)),g=f;return d};var z=function(a,b,c){for(var d=b.w=0;d<b.spans.length;d++){var e=
b.spans[d],f=c._font,k=c._fontSize,g=c._fontStyle,m=c._fontWeight,p=c._baseline;e.s&&(e.s.f&&(f=e.s.f),e.s.s&&(k=e.s.s),e.s.fs&&(g=e.s.fs),e.s.fw&&(m=e.s.fw),e.s.baseline&&(p=e.s.baseline));p&&("sup"===p?k*=.65:"sub"===p&&(k*=.65));a.font=x(f,k,g,m);e.w=a.measureText(e.t).width;b.w+=e.w}return b.w},q=function(a,b,c){Ma||(Ma=y.create("div","oit-textmeasure"),w.rootNode.append(Ma));b.h=0;b.a=0;Ma.css("display","inline");for(a=0;a<b.spans.length;a++){var d=b.spans[a],e=c._font,f=c._fontSize,k=c._fontStyle,
g=c._fontWeight;d.s&&(d.s.f&&(e=d.s.f),d.s.s&&(f=d.s.s),d.s.fs&&(k=d.s.fs),d.s.fw&&(g=d.s.fw));Ma.text(d.t);var m=y.create("span");Ma.append(m);Ma.css("font",x(e,f,k,g));Ma.offsetHeight>b.h&&(b.h=Ma.offsetHeight);d.a=m.offsetTop+1;d.a>b.h&&(d.a=b.h);d.a>b.a&&(b.a=d.a)}Ma.html("");Ma.attr("style","");Ma.css("display",null)};a.wrapText=function(a,b,c){var d=[];void 0!==b&&(b-=4);var e=0,f=0,k=0;if("vertical"===this._angle)b=0;else if(this._angle)if(this._angle===Math.PI/2||this._angle===3*Math.PI/2)b=
this._layoutHeight;else{var g=Math.tan(this._angle),m=-this._layoutHeight-g,p=2*this._layoutHeight+g,g=Math.min(Math.min(Math.sqrt(m*m),Math.sqrt(g*g+this._layoutHeight*this._layoutHeight)),Math.sqrt(this._layoutHeight*this._layoutHeight+p*p));g<b&&(b=g)}g=this._text;g=this._data.cs||void 0!==b?g.replace(/\s/g,"\ufffd"):g.replace(/\n/g,"\ufffd");for(m=0;e<this._text.length;){k=g.indexOf("\ufffd",k);-1==k&&(k=g.length);p=this.createLine(e,k,this._data.cs);z(a,p,this);var l=void 0!==b&&p.w>b;if(l||
"\n"==this._text[k]||k>=this._text.length){if(l)if(f>e)k=f,p=this.createLine(e,k,this._data.cs),z(a,p,this);else for(l=e+1;k>l&&!(k--,p=this.createLine(e,k,this._data.cs),z(a,p,this),p.w<=b););q(a,p,this);p.y=m;m+=p.h;d.push(p);if(void 0!==c&&m>=c)break;k<this._text.length&&(e=this._text[k]," "!=e&&"\t"!=e&&"\n"!=e||k++);e=k}else f=k++}if(0!==d.length)return d};var x=function(a,b,c,d){0>=b&&(b=10);var e="";c&&"normal"!==c&&(e+=c+" ");d&&"normal"!=d&&(e+=d+" ");return e+(b+"px "+a)};return e}(),Ma=
null,Yc=function(){return function(d,e){var a=this,c=d,b=e,f,k,v,l,r,m,p,z,q,G,D,T,J,N,E,h=[],u,g,t,A,U=0,S=0,W=40,L=22,R,O,H,n,C=x.zoom,I="database"!==e.type,ca,la=-1,Q=-1,ma=-1,ea=-1,Qa=!1,na,oa,Ra;this.unload=function(){Ra&&(sa(Ra),Ra=null);a.hidePopup(!0);na&&(na.destroy(),na=null);F.offscroll(Y);P.offselectionchanged(aa);B.offpageload(X);ha.offresize(Z);N&&N.destroy();for(var d=c.embeddingCount(),e=0;e<d;e++)c.embed(e).node=void 0;G&&(b.append(G),G=void 0);r&&r.destroy();p&&p.destroy();q&&q.destroy();
f&&f.destroy();Ma&&(Ma.destroy(),Ma=null);u=h=E=N=D=G=q=z=p=m=r=l=f=b=c=a=null};this.layoutChanged=function(b){x.zoom!=C&&(a.hidePopup(),Z())};var X=function(a){G&&(b.append(G),D=G=void 0);Z()};this.maxPageWidth=function(){var a=c.sheetRight();void 0!==ca&&ca>a&&(a=ca);return a};this.maxPageHeight=function(){return c.sheetBottom()};this.padding=function(){return{left:W,top:L,right:0,bottom:0}};this.visibleRange=function(){return ra(S,U,n,H)};this.visibleHeight=function(){return Ia(H)-Ya(U)};this.scrollOffset=
function(a,b){void 0===a&&(a=S);void 0===b&&(b=U);var d=K(c.colLeft(a)*C)+1,e=K(c.rowTop(b)*C)+1;return{left:d,top:e}};var Y=function(b,d,e,f,g){var h=U;f/=C;if(0<e)for(;!(c.rowBottom(h)>=f);)h++;else if(0>e)for(e=U;0<=e;e--)if(c.rowTop(e)<=f){h=e;break}e=S;f=d/C;if(0<b)for(;!(c.colRight(e)>=f);)e++;else if(0>b)for(b=S;0<=b;b--)if(c.colLeft(b)<=f){e=b;break}if(e!=S||h!=U)S=e,U=h,!1!==g&&(a.update(),a.hidePopup())},aa=function(a,d){if(d){if(E){var e=c.getSelectedText();E.html(e);E.select()}if(c.isRangeSelected())na.disable(),
na.setText(void 0);else if(e=F.cellSelection()){var f=c.getFormulaText(e.c1,e.r1);f||(f=c.getCellText(e.c1,e.r1))&&"="==f[0]&&(f="'"+f);na.enable();na.setText(f)}else na.setText(void 0);if(x.showAnnotations){var g,e=F.cellSelection(),f=b.annotationPane();if(e&&f){g=!c.isRangeSelected();!oa||oa.c==e.c1&&oa.r==e.r1||(oa=null);var h=oa?oa.anno:null,k=null,m=c.getCellComments(e.c1,e.r1),n=c.getCellRevisions(e.c1,e.r1);h&&g&&(m&&(g=m.indexOf(h),-1!=g&&((k=m[g+1])||(k=n?n[0]:m[0]))),!k&&n&&(g=n.indexOf(h),
-1!=g&&((k=n[g+1])||(k=m?m[0]:n[0]))));k||((k=Ea(m,e))||(k=Ea(n,e)),k||(m?k=m[0]:n&&(k=n[0])));k&&(oa={anno:k,c:e.c1,r:e.r1},f.activate(k))}}}ja();pa()};this.showHidden=function(d,e){if(c){var f=!1;!0===d?c.eachCol(function(a){c.showCol(a)&&(f=!0)}):!1===d&&c.eachCol(function(a){c.resetCol(a)&&(f=!0)});!0===e?c.eachRow(function(a){c.showRow(a)&&(f=!0)}):!1===e&&c.eachRow(function(a){c.resetRow(a)&&(f=!0)});f&&(ca=void 0,M.deactivate(),P.update(),a.update(),M.positionAll(b),F.dispatchPageEvents())}};
var Z=function(b){var d=w.viewNode;l&&k==d.clientWidth&&v==d.clientHeight&&C==x.zoom||(k=d.clientWidth,v=d.clientHeight,C=x.zoom,K(k/C),K(v/C),(d=gb())&&(1==C?d.css("transform",null):d.css("transform","scale("+C+","+C+")")),l&&(l.destroy(),m.destroy(),z.destroy()),r||(r=y.create("div","oit-ssgrid"),p=y.create("div","oit-sscolheader"),p.onmousemove(Na),p.ondragstart(Pa),p.ondragmove(Ha),p.ondragend(Da),p.ondragcancel(Da),p.onpress(Oa),p.onpressup(Wa),q=y.create("div","oit-ssrowheader"),q.onmousemove(Xa),
q.ondragstart(va),q.ondragmove(Ka),q.ondragend(Ta),q.ondragcancel(Ta),q.onpress(Va),q.onpressup(Ua),f.append(r,p,q)),f.css({width:k+"px",height:v+"px"}),W=q.offsetWidth,L=p.offsetHeight,l=r.createCanvas(),m=p.createCanvas(),z=q.createCanvas(),c.updateDimensions(),!1!==b&&a.update())};this.pageRect=function(a,d){if("view"===d||"overlay"===d||d===b){var e=0,f=0,g=c.sheetRight(),h=c.sheetBottom();if("view"===d||"overlay"===d){var k=x.zoom;1!=k&&(e*=k,f*=k,g*=k,h*=k);"view"===d&&(k=this.scrollOffset(),
e+=W-k.left,f+=L-k.top,g+=W-k.left,h+=L-k.top)}return new ga(e,f,g,h,d)}};this.rangeRect=function(a,d,e){var f;if("cell"===a.type){f=a.r1;var k=a.r2,m=a.c1,n=a.c2,p=a.offsets;a.offsets?f=new ga(c.colLeft(m)+p.left,c.rowTop(f)+p.top,c.colLeft(n)+p.right,c.rowTop(k)+p.bottom,b):(a.selectingRows&&(m=0,n=c.colCount()-1),a.selectingCols&&(f=0,k=c.rowCount()-1),f=new ga(c.colLeft(m)+1,c.rowTop(f)+1,c.colRight(n),c.rowBottom(k),b))}else if("rect"===a.type)"px"!==a.units&&(a=da(a),za(a,"px")),f=new ga(a),
void 0!==a.embedId&&(k=c.embedByUID(a.embedId),a=b.embeddingRect(a.embedId),k&&a&&f.offset(a.left,a.top));else if("text"==a.type)for(k=c.mapToCells(a),m=0;m<k.length;m++){var q=k[m],n=c.colLeft(q.c1),p=c.rowTop(q.r1),C;a:{C=q.c1;var z=q.r1;if(C>=u.c1&&C<=u.c2&&z>=u.r1&&z<=u.r2){var r=h[z-u.r1];if(r){C=r[C-u.c1];break a}}C=g&&C==t&&z==A?g:void 0}z=!1;C||(C=Ga(q.c1,q.r1),z=!0);z&&(z=l.getContext("2d"),z.save(),z.font="12px Arial,Helvetica,sans-serif",wa(z,q.c1,q.r1,C),z.restore());if(q=C.rangeRect(a))q.left+=
n,q.right+=n,q.top+=p,q.bottom+=p,f?f.union(q):f=new ga(q,b)}if(f)return!0===e&&(e=w.viewNode,e=new ga(0,0,e.clientWidth,e.clientHeight,"view"),e.origin=f.origin,f.intersect(e.left-100,e.top-100,e.right+100,e.bottom+100),0===f.width||0===f.height)&&(f=void 0),f&&d&&(f.origin=d),f};this.rangeFromRect=function(d,f,g,h,k,m,n,p,l,q){d=new ga(f,g,h,k,m);d.origin=b;if(void 0!==p)return l=e.embeddingRect(p),"move"===n?d.constrain(l):d.intersect(l),d.offset(-l.left,-l.left),f=d.toRange(),f.embedId=p,za(f,
"pct"),f;"move"!==n&&"resize"!==n&&"extend"!==n&&("view"===m&&(f-=W,g-=L),q|=f<c.colLeft(S),l|=g<c.rowTop(U));p=new ga(0,0,c.sheetRight(),c.sheetBottom(),b);"move"===n?d.constrain(p):d.intersect(p);p=!q&&!l;f=c.cellFromPos(d.left,d.top,p);p=c.cellFromPos(d.right,d.bottom,p);q?(f.c1=0,f.c2=c.colCount()-1,f.selectingRows=!0):f.c2=p.c1;l?(f.r1=0,f.r2=c.rowCount()-1,f.selectingCols=!0):f.r2=p.r1;if("move"===n||"resize"===n)n=a.rangeRect(f,b,!1),d.left-1>n.left&&f.c1<f.c2&&(f.c1+=1),d.top-1>n.top&&f.r1<
f.r2&&(f.r1+=1),d.right<n.right&&f.c1<f.c2&&--f.c2,d.bottom<n.bottom&&f.r1<f.r2&&--f.r2;q||l?(q&&(f.selectingRows=!0),l&&(f.selectingCols=!0)):(f.offsets={left:d.left-c.colLeft(f.c1),top:d.top-c.rowTop(f.r1),right:d.right-c.colLeft(f.c2),bottom:d.bottom-c.rowTop(f.r2)},f=c.expandRange(f));return f};this.extendRange=function(b,c,d,e){var f=a.rangeRect(b,e,!1),g=f.left,f=f.top,g=b.selectingRows?g-W:g+1,f=b.selectingCols?f-L:f+1;c=a.rangeFromRect(b.page,g,f,c,d,e,"extend",void 0,b.selectingCols,b.selectingRows);
c.offsets&&!b.offsets&&delete c.offsets;return c};this.update=function(a){Ra||(Ra=ba(this.doUpdate,0,this,a))};this.doUpdate=function(a){Ra&&(sa(Ra),Ra=null);var d=w.viewNode;if(!Qa){Qa=!0;var e=c.webFonts();if(e&&0<e.length)for(var f=e.length-1;0<=f;f--)yc.loadWebFont(e[f])}var g=K(-c.colLeft(S)*C),m=K(-c.rowTop(U)*C);w.drawing.setOrigin(g+W,m+L);O=S;n=void 0;for(var p=W;O<c.colCount();){if(!c.colHidden(O)&&(p+=K(c.colWidth(O)*C),p>=d.clientWidth)){p==d.clientWidth?n=O:(n=O-1,n<S&&(n=S));break}O++}void 0===
n&&(n=O);R=U;H=void 0;for(var q=L;R<c.rowCount();){if(!c.rowHidden(R)&&(q+=K(c.rowHeight(R)*C),q>=d.clientHeight)){q==d.clientHeight?H=R:(H=R-1,H<U&&(H=U));break}R++}void 0===H&&(H=R);c.loadDataForCells(S,U,O,R,!0);var z=fb();if(z){var t=w.viewNode,r=t.pos(t.parent());z.css({left:r.left+W+"px",top:r.top+L+"px",width:t.clientWidth-W+"px",height:t.clientHeight-L+"px"});gb().css({left:g+"px",top:m+"px"});for(var v=c.embeddingCount(),A=0;A<v;A++){var y=c.embed(A);if(y&&y.node&&y.position)if(void 0===
y.c2)y.node.css({left:y.position.left-y.adjustX+"px",top:y.position.top-y.adjustY+"px"});else if(y.position.left===y.position.right||y.position.top===y.position.bottom)y.node.css("display","none");else{var E=(y.position.right-y.position.left)/y.w,B=(y.position.bottom-y.position.top)/y.h,Ic,N;if(1!=E||1!=B)Ic="scale("+E+","+B+")",N="left top";y.node.css({display:null,left:y.position.left-y.adjustX*E+"px",top:y.position.top-y.adjustY*B+"px",transform:Ic,"transform-origin":N})}}}var G=l.getContext("2d");
G.clearRect(0,0,l.width,l.height);G.save();var ma,ea=u,D,na;c.cellGridChanged()?(h=ea=u=null,c.cellGridChanged(!1)):!0===a&&(u=null);var la=S;if(0<S)for(D=U;D<=R;D++)if(!c.rowHidden(D)&&(ma=c.getCell(S,D),!ma||!ma.t&&!ma.v)){var V=c.prevTextCell(S,D);void 0!==V&&V<la&&(la=V)}if(u&&(u.c1!=la||u.c2!=O||u.r1!=U||u.r2!=R)){if(la>u.c2||O<u.c1||U>u.r2||R<u.r1)h=ea=null;u=null}if(!u){u=ra(la,U,O,R);var oa=h;h=[];for(D=u.r1;D<=u.r2;D++)c.rowHidden(D)||(h[D-u.r1]=[]);var M=null,Q=null;for(D=u.r1;D<=u.r2;D++)if(!c.rowHidden(D))for(na=
u.c1;na<=u.c2;na++){ma=c.getCell(na,D);var X=c.colStyle(na),Ba=c.getCellComments(na,D),Y=c.getCellRevisions(na,D),ia=Ba||Y||ma!==M||null!==X?null:Q;if(ma&&!ia){if(ea){var Ca=D-ea.r1;if(0<=Ca&&Ca<oa.length&&oa[Ca]){var aa=na-ea.c1;0<=aa&&aa<oa[Ca].length&&(ia=oa[Ca][aa])}}ia||(ia=Ga(na,D,ma))}h[D-u.r1][na-u.c1]=ia;M=ma;Q=ia}}G.font="12px Arial,Helvetica,sans-serif";var qa=K((c.colRight(c.colCount()-1)-c.colLeft(S))*C),da=K((c.rowBottom(c.rowCount()-1)-c.rowTop(U))*C),ba=w.viewNode,fa=ba.clientWidth,
ga=ba.clientHeight;I||(fa>qa&&(fa=qa),ga>da&&(ga=da));G.oitrect(0,0,fa,ga,"#ffffff");G.fillStyle=I?"#f3f3f3":"#eaeaea";ba.clientWidth>qa&&G.fillRect(qa,0,ba.clientWidth-qa,ba.clientHeight);ba.clientHeight>da&&G.fillRect(0,da,ba.clientWidth,ba.clientHeight-da);G.oitline(.5,0,.5,ga,"#d0d0d0");for(var ha=!1,Kb=S+1;;Kb++){var ka=c.colHidden(Kb);if(!ka||!ha){var Cb=ab(Kb);if(Cb>fa)break;var Jb=Cb+.5;G.oitline(Jb,0,Jb,ga,"#e0e0e0")}ha=ka}G.oitline(0,.5,fa,.5,"#d0d0d0");for(var ha=!1,Bb=U+1;;Bb++){var xa=
c.rowHidden(Bb);if(!xa||!ha){var ya=Ya(Bb);if(ya>ga)break;var Aa=ya+.5;G.oitline(0,Aa,fa,Aa,"#e0e0e0")}ha=xa}var Fa=ca;c.colLeft(S);c.rowTop(U);for(var Ea=0,za=0;za<h.length;za++){var Ma=h[za],Na=za+u.r1,Ia=c.rowHeight(Na);if(0<Ia){var Da=0;u.c1!=S&&(Da=c.colLeft(u.c1)-c.colLeft(S));for(var Pa=Da,Ha=0;Ha<Ma.length;Ha++){var Oa=Ha+u.c1,Ja=c.colWidth(Oa);if(0<Ja){var La=Ma[Ha];if(La&&La.hasText()){wa(G,Oa,Na,La,Pa,Da,Ea,Ja,Ia);var Ta=c.colLeft(Oa)+La.textRight();if(void 0===ca||Ta>ca)ca=Ta;Pa=Da+Ja}Da+=
Ja}}Ea+=Ia}}var Wa=d.clientWidth,Xa=d.clientHeight,va,Ka=c.sheetRight(),Sa=c.sheetBottom();void 0!==ca&&ca>Ka&&(Ka=ca);b.width=Ka;b.height=Sa;var Va=w.viewNode,Ua=Va.clientWidth/C,Za=Va.clientHeight/C,$a=20/C,jb=W/C,kb=L/C,bb=Ka+jb+$a;if(bb>Ua){for(var cb=c.colCount()-1;c.colLeft(cb)<Ka;)cb++;for(var nb=cb,hb=c.colWidth(nb),ib=nb-1;0<=ib;ib--){var ob=hb+c.colWidth(ib);if(ob>Ua)break;hb=ob}va=Ua-hb;0>va&&(va=0);va+=$a;var pb=c.colRight(cb)+jb+va;pb>bb&&(bb=pb)}var db=Sa+kb+$a;if(db>Za){for(var eb=
c.rowCount()-1;c.rowTop(eb)<Sa;)eb++;for(var rb=eb,mb=c.rowHeight(rb),qb=rb-1;0<=qb;qb--){var Ab=mb+c.rowHeight(qb);if(Ab>Za)break;mb=Ab}va=Za-mb;0>va&&(va=0);va+=$a;var ic=c.rowBottom(eb)+kb+va;ic>db&&(db=ic)}void 0===T&&(T=vc(b),J=wc(b));var tb=Math.ceil(bb*C),ub=Math.ceil(db*C);tb>T&&(F.hiddenContent("large-sheet-unsupported"),tb=T);ub>J&&(F.hiddenContent("large-sheet-unsupported"),ub=J);b.css({width:tb+"px",height:ub+"px"});if(ca!=Fa||Wa!=d.clientWidth||Xa!=d.clientHeight)G.restore(),k=-1,Z();
else{G.scale(C,C);ta(G,"drawTextBackground");ta(G,"drawBackground");ta(G,"drawBorder",!0);G.restore();G.save();var wb=c.revisions();if(wb&&x.showAnnotations){G.save();for(var yb=0;yb<wb.length;yb++){var lb=wb[yb],Ib=lb.annoRange||lb.range,Db=lb.oldAnnoRange||lb.oldrange;switch(lb.type){case "new_cell":Lb(G,Ib,null,"rgba(44,156,58,0.5)");break;case "modify_cell":Lb(G,Ib,null,"rgba(148,57,174,0.5)");break;case "clear_cell":Lb(G,Ib,null,"rgba(213,61,61,0.5)");break;case "delete_row":var Eb=G,sb=Ib.r1;
if(sb<=R&&sb>=U){var Fb=ra(b.index,0,sb,c.colCount()-1,sb),vb=ua(Fb);Eb.oitrect(vb.left,vb.top,vb.width,vb.height,"rgba(234,158,158,0.1)")}break;case "delete_col":var Gb=G,xb=Ib.c1;if(xb<=O&&xb>=S){var Hb=ra(b.index,xb,0,xb,c.rowCount()-1),zb=ua(Hb);Gb.oitrect(zb.left,zb.top,zb.width,zb.height,"rgba(234,158,158,0.1)")}break;case "move_cells":Lb(G,Db,null,"rgba(213,61,61,0.5)"),Lb(G,Ib,null,"rgba(44,156,58,0.5)")}}G.restore()}G.scale(C,C);ta(G,"drawText");ta(G,"drawFlags");G.restore();ja();pa();P.update()}};
this.hidePopup=function(a){};this.moveto=function(a,b,d){var e=!1;if(cc(a))if("text"===a.type)(a=c.mapToCells(a))&&0<a.length&&(e=this.moveto(a[0],b,d));else if("cell"===a.type){for(e=a.c1;e<=a.c2;e++)if(c.colHidden(e)){x.showHiddenColumns=!0;break}for(e=a.r1;e<=a.r2;e++)if(c.rowHidden(e)){x.showHiddenRows=!0;break}a.selectingRows||a.selectingCols||(a=c.expandRange(a));e=w.viewNode.scroll();this.scrollToRange(a.c1,a.r1,a.c2,a.r2);a=w.viewNode.scroll();Y(a.left-e.left,a.left,a.top-e.top,a.top,!0);
b&&b(d);e=!0}return e};this.scrollToRange=function(a,b,d,e){var f=w.viewNode,g,h;if(a<S)g=a;else if(d>n){var k=f.clientWidth-W;for(g=d;0<=g;){k-=K(c.colWidth(g)*C);if(0===k)break;if(0>k){g++;break}if(0===g)break;g--}a<g&&(g=a)}if(b<U)h=b;else if(e>H){a=f.clientHeight-L;for(h=e+1;0<=h;){a-=K(c.rowHeight(h)*C);if(0===a)break;if(0>a){h++;break}if(0===h)break;h--}b<h&&(h=b)}b=this.scrollOffset(g,h);var m,p;void 0!==g&&(m=b.left);void 0!==h&&(p=b.top);f.scroll(m,p)};var ja=function(){var a=m.getContext("2d");
a.save();a.oitrect(0,0,p.clientWidth,p.clientHeight,"#eaeaea");a.oitrect(0,0,W,L,"#eaeaea");a.oitrect(W-11.5,L-11.5,8,8,"#d0d0d0","#e0e0e0");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var b=12;1<=C?a.font="12px Arial,Helvetica,sans-serif":(b*=C,8>b&&(b=8),a.font=b+"px Arial,Helvetica,sans-serif");for(var b=F.cellSelection(),d=L/2,e=0,f=!1,g=S,h=S;I||h<=c.colCount();h++){var k=0;c.colHidden(h)?e++:(k=K(c.colWidth(h)*C),0===k?e++:e&&(e=0,f=!0));if(1>=e){var n=ab(h)+W+.5;if(n>p.clientWidth)break;
f&&(n+=2,f=!1);var l=null;if(x.showAnnotations){var q=c.colRevisions(h);if(q){for(var z=!1,u=!1,t=0;t<q.length;t++)"add_col"==q[t].type?z=!0:u=!0;z&&u?l="rgba(201,156,214,0.5)":z?l="rgba(149,205,156,0.5)":u&&(l="rgba(234,158,158,0.5)")}}!l&&b&&h>=b.c1&&h<=b.c2&&(l="#d0d0d0");l&&(a.oitrect(n,0,k,L,"#FFF"),a.oitrect(n,0,k,L,l),a.fillStyle="black");a.strokeStyle=b&&h>b.c1&&h<=b.c2?"#c1c1c1":"#d0d0d0";a.oitline(n,0,n,L,a.strokeStyle);if(!I&&h>=c.colCount())break;0<k&&(a.save(),a.beginPath(),a.rect(n,
0,k,L),a.clip(),(l=c.colTitle(h,!1))||(l=Ja(g)),a.measureText(l).width>=k?(k=n+1,a.textAlign="left"):(k=n+k/2,a.textAlign="center"),c.colOriginalHidden(h)?a.fillStyle="#b2b2b2":a.fillStyle="#000",a.fillText(l,k,d),a.restore())}c.colDeleted(h)||g++}b=.5;a.oitline(0,b,p.clientWidth,b,"#d0d0d0");b=L+.5;a.oitline(0,b,p.clientWidth,b,"#d0d0d0");a.restore()},pa=function(){var a=z.getContext("2d");a.save();a.oitrect(0,0,q.clientWidth,q.clientHeight,"#eaeaea");a.fillStyle="black";a.textAlign="center";a.textBaseline=
"middle";var b=12;1<=C?a.font="12px Arial,Helvetica,sans-serif":(b*=C,8>b&&(b=8),a.font=b+"px Arial,Helvetica,sans-serif");for(var b=F.cellSelection(),d=W/2,e=0,f=!1,g=U,h=U;I||h<=c.rowCount();h++){var k=0;c.rowHidden(h)?e++:(k=K(c.rowHeight(h)*C),0===k?e++:e&&(e=0,f=!0));if(1>=e){var m=Ya(h)+.5;if(m>q.clientHeight)break;f&&(m+=2,f=!1);var n=null;if(x.showAnnotations){var p=c.rowRevisions(h);if(p){for(var l=!1,u=!1,t=0;t<p.length;t++)"add_row"==p[t].type?l=!0:u=!0;l&&u?n="rgba(201,156,214,0.5)":l?
n="rgba(149,205,156,0.5)":u&&(n="rgba(234,158,158,0.5)")}}!n&&b&&h>=b.r1&&h<=b.r2&&(n="#d0d0d0");n&&(a.oitrect(0,m,W,k,"#FFF"),a.oitrect(0,m,W,k,n),a.fillStyle="black");a.strokeStyle=b&&h>b.r1&&h<=b.r2?"#c1c1c1":"#d0d0d0";a.oitline(0,m,W,m,a.strokeStyle);if(!I&&h>=c.rowCount())break;0<k&&(a.save(),a.beginPath(),a.rect(0,m,W,k),a.clip(),(n=c.rowTitle(h,!1))||(n=Za(g)),k=m+k/2,c.rowOriginalHidden(h)?a.fillStyle="#b2b2b2":a.fillStyle="#000",a.fillText(n,d,k,W),a.restore())}c.rowDeleted(h)||g++}b=W+.5;
a.oitline(b,0,b,q.clientHeight,"#d0d0d0");a.restore()},ua=function(a){var b={left:0,top:0,right:0,bottom:0};b.left=ab(a.c1);b.right=La(a.c2);b.top=Ya(a.r1);b.bottom=Ia(a.r2);a=w.viewNode.clientWidth;var c=w.viewNode.clientHeight;b.left=ka(b.left,-100,a+100);b.right=ka(b.right,-100,a+100);b.top=ka(b.top,-100,c+100);b.bottom=ka(b.bottom,-100,c+100);b.width=b.right-b.left;b.height=b.bottom-b.top;return b},Lb=function(a,b,c,d){b&&b.c1<=O&&b.c2>=S&&b.r1<=R&&b.r2>=U&&(b=ua(b),a.oitrect(b.left+1,b.top+1,
b.width-2,b.height-2,null,"#FFF",2),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,c,d,2,[1,6]))},fa=function(a,b){return!a||0>b||b>=a.length?null:a[b]},ta=function(a,b,d){var e=0,f,g;d&&(f=[[null,null,null],[null,null,null],[null,null,null]]);for(var k,m=null,n=0<h.length?h[0]:null,p=0;p<h.length;p++){k=m;var m=n,n=p+1<h.length?h[p+1]:null,l=p+u.r1,q=c.rowHeight(l);if(0<q){var C=0;u.c1!=S&&(C=c.colLeft(u.c1)-c.colLeft(S));for(var z=0;z<m.length;z++){var t=z+u.c1,r=c.colWidth(t),O=m[z];if(0<r&&O){var v=
O.horizontalMerge(),A=O.verticalMerge(),y=r,w=q;for(g=1;g<=v;g++)y+=c.colWidth(t+g);for(g=1;g<=A;g++)w+=c.rowHeight(l+g);!0===d&&(f[0][0]=fa(k,z-1),f[0][1]=fa(k,z),f[0][2]=fa(k,z+1),f[1][0]=fa(m,z-1),f[1][1]=O,f[1][2]=fa(m,z+1),f[2][0]=fa(n,z-1),f[2][1]=fa(n,z),f[2][2]=fa(n,z+1));O[b](a,t,l,C,e,y,w,f)}C+=r}e+=q}}},wa=function(a,b,d,e,f,g,h,k,m){var n,p;void 0===g&&(g=c.colLeft(b)-c.colLeft(S));void 0===h&&(h=c.rowTop(d)-c.rowTop(U));void 0===k&&(k=c.colWidth(b));void 0===m&&(m=c.rowHeight(d));if(void 0===
f)for(f=g,n=b-1;0<=n;n--){var l=c.getCell(n,d);if(l&&(l.t||l.v))break;f=c.colLeft(n)-c.colLeft(S)}var l=e.horizontalMerge(),q=e.verticalMerge();if((n="cs"===e.horizontalAlign())||0<l)for(p=1;(n||p<=l)&&!(n&&(n=c.getCell(b+p,d),n=!n||n.t||n.v?!1:"cs"===c.cellStyle(n.s).a,!n&&p>l));)k+=c.colWidth(b+p),p++;for(p=1;p<=q;p++)m+=c.rowHeight(d+p);l=c.colLeft(S);q=c.colRight(O)-l;p=void 0;I||(p=c.colRight(b)-l);for(b+=1;;b++){n=c.getCell(b,d);if(!n)break;if(n.t||n.v){p=c.colLeft(b)-l;break}n=c.colRight(b)-
l;if(n>q)break;I||(p=n)}e.layoutText(a,g,h,k,m,f,p)},Ga=function(a,b,d){d||(d=c.getCell(a,b));if(d)return g=d=new md(d,c,a,b),t=a,A=b,d},xa=function(a){var b;if(a>=W){a-=W;for(var d=S;d<c.colCount();){var e=La(d),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(b=d,a<=e))break;d++}}return b},ya=function(a){var b;if(a>=W)for(a-=W,b=S;!(a<La(b));b++);return b},Aa=function(a){var b;if(a>=L){a-=L;for(var d=U;d<c.rowCount();){var e=Ia(d),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(b=d,a<=e))break;d++}}return b},
Fa=function(a){var b;if(a>=L)for(a-=L,b=U;!(a<Ia(b));b++);return b},Ea=function(a,b){var c;if(a)for(var d=0;d<a.length;d++){var e=a[d];if(0===Sa(e.range,b)){c=e;break}if(e.oldrange&&0===Sa(e.oldrange,b)){c=e;break}}return c},Na=function(a){-1==ea&&-1==Q&&(a=w.viewNode.mousePos(a),a=void 0!==xa(a.x)?"col-resize":null,m.css("cursor",a))},Pa=function(a){return-1==ea&&(a=xa(a.center.x),void 0!==a)?(Q=a,!1):!0},Ha=function(d){if(-1!=ea)d=ya(d.center.x),P.select(ra(b.index,ea,0,d,c.rowCount()-1));else if(-1!=
Q){d=K((d.center.x-W)/C)+c.colLeft(S);var e=c.colLeft(Q);d=d>=e?d-e:0;d!=c.colWidth(Q)&&(c.setColWidth(Q,d),P.update(),a.update(),M.positionAll(b))}return!1},Da=function(a){-1!=Q&&(Q=-1,Z(),M.positionAll(b));return!1},Oa=function(a){ea=ya(a.center.x);P.select(ra(b.index,ea,0,ea,c.rowCount()-1))},Wa=function(a){ea=-1},Xa=function(a){-1==ma&&-1==la&&(a=w.viewNode.mousePos(a),a=void 0!==Aa(a.y)?"row-resize":null,z.css("cursor",a))},va=function(a){return-1==ma&&(a=Aa(a.center.y),void 0!==a)?(la=a,!1):
!0},Ka=function(d){if(-1!=ma)d=Fa(d.center.y),P.select(ra(b.index,0,ma,c.colCount()-1,d));else if(-1!==la){d=K((d.center.y-L)/C)+c.rowTop(U);var e=c.rowTop(la);d=d>=e?d-e:0;d!=c.rowHeight(la)&&(c.setRowHeight(la,d),P.update(),a.update(),M.positionAll(b))}return!1},Ta=function(a){-1!==la&&(la=-1,Z(),M.positionAll(b));return!1},Va=function(a){ma=Fa(a.center.y);P.select(ra(b.index,0,ma,c.colCount()-1,ma))},Ua=function(a){ma=-1},Ya=function(a){return K((c.rowTop(a)-c.rowTop(U))*C)},Ia=function(a){return K((c.rowBottom(a)-
c.rowTop(U))*C)},ab=function(a){return K((c.colLeft(a)-c.colLeft(S))*C)},La=function(a){return K((c.colRight(a)-c.colLeft(S))*C)},fb=function(){void 0===G&&(G=b.childByClass("oit-sheet-embedpane"))&&w.viewNode.parent().append(G);return G},gb=function(){if(void 0===D){var a=fb();D=a?a.childByClass("oit-sheet-embedlist"):null}return D};(function(){var a=w.viewNode;f=a.parent().childByClass("oit-ssoverlay");f||(f=y.create("div","oit-ssoverlay"),a.parent().insert(f,a));f.html("");N=b.overlay.childByClass("oit-sel-text");
N||(N=y.create("div"),b.overlay.append(N));E=y.create("pre");N.addClass("oit-sel-text");N.html("");N.append(E);na=new kd;na.show();F.onscroll(Y);P.onselectionchanged(aa);B.onpageload(X);ha.onresize(Z);a=a.scroll();Y(a.left,a.left,a.top,a.top,!1);Z(!1)})()}}(),ld=function(){function d(a,b,c){this.value=a;this.type=b;this.subtype=c}function e(){this.items=[];this.add=function(a,b,c){c||(c="");a=new d(a,b,c);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=
function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function a(){this.items=[];this.pushToken=function(a,b,c){this.items.push(new d(a,
b,c))};this.push=function(a){this.items.push(a)};this.pop=function(){var a=this.items.pop();return new d(a.value,a.type,x)};this.token=function(){return 0<this.items.length?this.items[this.items.length-1]:null};this.value=function(){return this.token()?this.token().value:""};this.type=function(){return this.token()?this.token().type:""};this.subtype=function(){return this.token()?this.token().subtype:""}}function c(a,b,c,d){var e=!1,f=0,g=!1,h=0;a=a.replace(n,"");a=a.replace(I,"@");a=a.replace(ca,
"");var k=a.length,m=a.indexOf("!")+1,p="";0<m&&(p=a.slice(0,m-1));var l=a.slice(m,a.length),q=p.match(C);if(q&&d){var z=""+q[0],q="'";z.charCodeAt(0)==H&&(z=z.slice(1,z.length),q="");z=z.slice(1,z.length-1);z=parseInt(z,10);0<z&&z--;if(z<d.length){d=d[z];d=d.replace(P,"\\");var z=d.lastIndexOf("\\"),u;0<=z?(u=d.slice(z+1,d.length),d=d.slice(0,z+1)):(u=d,d="");0===d.indexOf("file:\\\\\\")&&(d=d.slice(8,d.length));p="'"+p.replace(C,d+"["+u+"]")+q;p=p.replace(la," ")}}q=a.charCodeAt(m);m<k&&q==D&&(e=
!0,m++,q=a.charCodeAt(m));for((d=m<k&&q>=L&&q<=K)||(g=e);m<k&&q>=L&&q<=K;)f=26*f+(q-L+1),m++,q=a.charCodeAt(m);16172<f&&(d=!1);m<k&&q==D&&(g=!0,m++,q=a.charCodeAt(m));for(z=m<k&&q>=M&&q<=O;m<k&&q>=M&&q<=O;)h=10*h+(q-M),m++,q=a.charCodeAt(m);e||(f+=b);g||(h+=c);0<f&&f--;""!==p&&(p+="!");return m==k&&(d||z)?p+(d?(e?"$":"")+Ja(f):"")+(z?(g?"$":"")+h:""):p+l}function b(b){for(var c=new e,d=new a,C=0,O=function(){return b.substr(C,1)},H="",I=!1,J=!1,G=!1,ca=!1;0<b.length;)if(" "==b.substr(0,1))b=b.substr(1);
else{"="==b.substr(0,1)&&(b=b.substr(1));break}for(var D=/^[1-9]{1}(\.[0-9]+)?E{1}$/;!(C>=b.length);)if(I)'"'==O()?'"'==b.substr(C+1,1)?(H+='"',C+=1):(I=!1,c.add('"'+H+'"',k,B),H=""):H+=O(),C+=1;else if(J)"'"==O()?"'"==b.substr(C+1,1)?(H+="'",C+=1):(H+=O(),J=!1):H+=O(),C+=1;else if(G)"]"==O()&&(G=!1),H+=O(),C+=1;else if(ca)H+=O(),C+=1,-1!=",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+H+",")&&(ca=!1,c.add(H,k,h),H="");else if(-1!="+-".indexOf(O())&&1<H.length&&H.match(D))H+=O(),C+=
1;else if('"'==O())0<H.length&&(c.add(H,y),H=""),I=!0,C+=1;else if("'"==O())0<H.length?(c.add(H,y),H=""):H+=O(),J=!0,C+=1;else if("["==O())G=!0,H+=O(),C+=1;else if("#"==O())0<H.length&&(c.add(H,y),H=""),ca=!0,H+=O(),C+=1;else if("{"==O())0<H.length&&(c.add(H,y),H=""),c.add("{",v,w),d.pushToken("}",v,x),c.add("",v,w),d.pushToken("",v,x),C+=1;else if(";"==O())0<H.length&&(c.add(H,k),H=""),c.addRef(d.pop()),c.add(";",r),c.add("",v,w),d.pushToken("",v,x),C+=1;else if("}"==O())0<H.length&&(c.add(H,k),
H=""),c.addRef(d.pop()),c.addRef(d.pop()),C+=1;else if(" "==O())for(0<H.length&&(c.add(H,k),H=""),c.add("",q),C+=1;" "==O()&&!(C>=b.length);)C+=1;else-1!=",>=,<=,<>,".indexOf(","+b.substr(C,2)+",")?(0<H.length&&(c.add(H,k),H=""),c.add(b.substr(C,2),p,E),C+=2):(-1!="+-*/^&=><".indexOf(O())?(0<H.length&&(c.add(H,k),H=""),c.add(O(),p)):-1!="%".indexOf(O())?(0<H.length&&(c.add(H,k),H=""),c.add(O(),z)):"("==O()?0<H.length?(c.add(H.replace(n,"")+"(",v,w),d.pushToken(")",v,x),H=""):(c.add("(",l,w),d.pushToken(")",
l,x)):","==O()?(0<H.length&&(c.add(H,k),H=""),d.type()!=v?c.add(O(),p,F):c.add(O(),r)):")"==O()?(0<H.length&&(c.add(H,k),H=""),c.addRef(d.pop())):H+=O(),C+=1);0<H.length&&c.add(H,k);for(d=new e;c.moveNext();)H=c.current(),H.type==q?c.BOF()||c.EOF()||(c.previous().type==v&&c.previous().subtype==x||c.previous().type==l&&c.previous().subtype==x||c.previous().type==k)&&(c.next().type==v&&c.next().subtype==w||c.next().type==l&&c.next().subtype==w||c.next().type==k)&&d.add(" ",p,A):d.addRef(H);for(;d.moveNext();)H=
d.current(),H.type==p&&"-"==H.value?d.BOF()?H.type=m:d.previous().type==v&&d.previous().subtype==x||d.previous().type==l&&d.previous().subtype==x||d.previous().type==z||d.previous().type==k?H.subtype=g:H.type=m:H.type==p&&"+"==H.value?d.BOF()?H.type=f:d.previous().type==v&&d.previous().subtype==x||d.previous().type==l&&d.previous().subtype==x||d.previous().type==z||d.previous().type==k?H.subtype=g:H.type=f:H.type==p&&0===H.subtype.length?-1!="<>=".indexOf(H.value.substr(0,1))?H.subtype=E:H.subtype=
"&"==H.value?t:g:H.type==k&&0===H.subtype.length?isNaN(parseFloat(H.value))?H.subtype="TRUE"==H.value||"FALSE"==H.value?E:u:H.subtype=N:H.type==v&&"@"==H.value.substr(0,1)&&(H.value=H.value.substr(1));d.reset();for(c=new e;d.moveNext();)d.current().type!=f&&c.addRef(d.current());c.reset();return c}var f="noop",k="operand",v="function",l="subexpression",r="argument",m="operator-prefix",p="operator-infix",z="operator-postfix",q="white-space",y="unknown",w="start",x="stop",B="text",N="number",E="logical",
h="error",u="range",g="math",t="concatenate",A="intersect",F="union",D=36,L=65,K=90,M=48,O=57,H=39,n=/\u005F[^\u002E]*\u002E/,C=/^'?\u005B[0-9]+\u005D/,I=/\u005B\u0023This Row\u005D/,ca=/\u005B\u005D/,la=/%20/g,P=/\u002F/g;return function(a,d,e,f){a=b(a);for(var g="",h;a.moveNext();){var k=a.current();if(k.subtype!=F&&k.type!=r||!h||h.subtype!=u||64!=h.value.charCodeAt(h.value.length-1)){if(k.subtype==u){h=k;var m;m=k.value;var n=d,p=e,l=f,q=m.lastIndexOf(":");m=0<q?c(m.slice(0,q),n,p,l)+":"+c(m.slice(q+
1),n,p,l):c(m,n,p,l);h.value=m}g+=k.value}h=k}return g}}(),hd=function(){var d={ATTACHMENTS:"ATTACHMENT",BADDRESS:"BUSINESSADDRESS",BPHONE:"BUSINESSPHONE",CALENDAREXCEPTIONS:"CALENDAR_EXCEPTION",CATEGORY:"CATEGORIES",CREATED:"CREATION_TIME",DUEDATE:"DUE_DATE",ENDDATE:"DTEND",ENDTIME:"DTEND",ENTRYTYPE:"ENTRY_TYPE",FAX:"BUSINESSFAX",HADDRESS:"HOMEADDRESS",HPHONE:"HOMEPHONE",IM:"IMADDRESS",LAST:"FAMILY",NAME:"FULLNAME",MOBILE:"MOBILEPHONE",OPTATTEND:"OPTATTENDEE",PERCENT:"PERCENT_COMPLETE",RECURRANGE:"RECURRENCE_RANGE",
RECURTYPE:"RECURRENCE_TYPE",REQATTEND:"REQATTENDEE",STARTDATE:"START_DATE",STARTTIME:"DTSTART",TOPIC:"CONVERSATION_TOPIC"},e={FI_OUTLOOK_MSG_APPT:"calendarentry",FI_OUTLOOK_MSG_CDSMAIL:"msg",FI_OUTLOOK_MSG_CONTACT:"contact",FI_OUTLOOK_MSG_DISTLIST:"contactgroup",FI_OUTLOOK_MSG_JOURNAL:"journal",FI_OUTLOOK_MSG_MAIL:"msg",FI_OUTLOOK_MSG_NDR:"msg",FI_OUTLOOK_MSG_NOTE:"note",FI_OUTLOOK_MSG_ODSMAIL:"msg",FI_OUTLOOK_MSG_POST:"note",FI_OUTLOOK_MSG_TASK:"task",FI_OUTLOOK_OFT_APPT:"calendarentry",FI_OUTLOOK_OFT_CDSMAIL:"msg",
FI_OUTLOOK_OFT_CONTACT:"contact",FI_OUTLOOK_OFT_DISTLIST:"contactgroup",FI_OUTLOOK_OFT_JOURNAL:"journal",FI_OUTLOOK_OFT_MAIL:"msg",FI_OUTLOOK_OFT_NDR:"msg",FI_OUTLOOK_OFT_NOTE:"note",FI_OUTLOOK_OFT_ODSMAIL:"msg",FI_OUTLOOK_OFT_POST:"note",FI_OUTLOOK_OFT_TASK:"task",ai:"vector",bmp:"image",cdr:"vector",cgm:"vector",chtml:"ie",cur:"image",dcx:"image",dgn:"vector",doc:"doc",docx:"doc",drw:"vector",dwg:"vector",dxf:"vector",emf:"vector",eml:"msg",fft:"text",gdf:"vector",gem:"vector",gif:"image",hdml:"ie",
hpgl:"vector",htm:"ie",html:"ie",ico:"image",ics:"calendar",img:"image",indd:"image",jpg:"image",lwp:"text",mhtml:"ie",mpg:"video",mpp:"project",msg:"msg",odg:"vector",odi:"image",odt:"text",oft:"text",pbm:"image",pcd:"image",pct:"image",pcx:"image",pdf:"pdf",pdfi:"image",pgm:"image",pic:"vector",pif:"vector",png:"image",ppm:"image",ppt:"ppt",pptx:"ppt",ps:"vector",psd:"image",psp:"image",pst:"msg",rtf:"text",sdw:"image",svg:"vector",tga:"image",tif:"image",txt:"text",vsd:"vsd",wbmp:"image",wmf:"vector",
wml:"ie",wmv:"video",wpd:"text",wpg:"image",xbm:"image",xhtml:"ie",xlc:"xls",xls:"xls",xlsb:"xls",xlsx:"xls",xml:"ie",xmp:"ie",xpm:"image",yim:"text",zip:"zip"},a=function(a){L.call(this,a);y.attach(this);this._page=B.forNode(a);if(!this._page._fields&&(a=(a=this.byClass("oit-maildata"))?a[0]:y.byId("oit-maildata"))){var c=this.byClass("oit-emhdrlabel"),E=this.byClass("oit-emhdrvalue"),h=[];if(c&&E&&c.length==E.length)for(var u=0;u<c.length;u++){var g=c[u],t=E[u];if("oit-email_attachments"!=g.id){var A=
{},J;g.id&&0===g.id.indexOf("oit-email_")&&(J=g.id.substring(10).toUpperCase(),A.id=d[J]||J);if(!A.id)for(J=0;;J++){var D=g.classList.item(J);if(!D)break;if(0===D.indexOf("oit-email_")){J=D.substring(10).toUpperCase();A.id=d[J]||J;break}}A.id||(A.label=g.html());g=t.attr("data-acc");1==t.dom.childElementCount?t=t.firstChildElem():(J=y.create("div"),J.transferFrom(t),t=J);g&&(t.attr("data-acc",g),"none"===g&&t.addClass("oit-noacc"));A.value=t.dom.outerHTML;h.push(A)}}this._page._fields=h;a.destroy()}this.html('<div class="oit-headerpadding"><table class="oit-maildata"></table><div class="oit_attachments oit-noacc" data-acc="none"></div></div><div class="oit-emextra"><div class="oit-em_allheaders"><table class="oit-emheadervalues"></table></div></div>');
this._hdrtable=this.byClass("oit-maildata")[0];a=this.parent().parent();a.hasClass("oit-emailstream")&&(c=y.create("div","oit-emailbk"),c.transferFrom(a),a.append(c),a.addClass("oit-emailfill"));c=this._page._fields;a=this.byClass("oit-em_allheaders")[0];if(x.removeExtraEmailHeaders||w.isMobile)a.destroy(),a=null;b(c);switch(this.data("subtype")){case "journal":E=x.journalHeader;break;case "contact":E=x.contactHeader;break;case "note":E=x.noteHeader;break;case "appt":E=x.appointmentHeader;break;case "task":E=
x.taskHeader;break;case "post":E=x.postHeader;break;case "dist":E=x.distroHeader;break;default:E=x.emailHeader}h=this._page._fields;if(E.subjectField)if(A=z(h,E.subjectField),u=z(h,E.dateField),!E.subjectField&&!E.dateField||A||!1===E.defaultSubject||(A=new Jc({id:"SUBJECT",value:'<div class="oit-emhdrvalue oit-textfield"><div><span></span></div></div>'})),A){if(A.addedToHeader=!0,t=this.subjectBar=y.create("div","oit-email-subjectbar"),g=A.clone(),g.addContainerClass("oit-email-subject"),g.appendAsDiv(t),
g.labelElem.html(""),this.fixedSubjectField=g,g.valueElem.text()||(g.valueElem.addClass("oit-nosubject"),g.valueElem.text(R.NO_SUBJECT)),g=this._hdrtable.parent(),g.insert(t,g.firstChildElem()),A.hide(),u&&(this.headerDateField=u,A=u.clone(),A.addContainerClass("oit-email-date"),A.appendAsDiv(t),this.fixedDateField=A,u.appendAsRow(this._hdrtable),u.hide()),!w.isMobile&&(u=t.clone(!0)))this.stickyHeader=y.create("div","oit-email-stickyheader"),this.stickyHeader.append(u),this.stickyHeader.onmouseover(this,
q),this.stickyHeader.onmouseout(this,G),this.stickyHeader.ontap(this,F),w.viewNode.parent().append(this.stickyHeader),this.stickyHeaderVisible=!1,this.stickyDateFixedField=this.stickyHeader.byClass("oit-email-date"),Array.isArray(this.stickyDateFixedField)&&(this.stickyDateFixedField=this.stickyDateFixedField[0])}else this.addClass("oit-nosubject");E.photoField&&(u=z(h,E.photoField))&&(u.addContainerClass("oit-email-photo"),u.insertAsDiv(this._hdrtable.parent(),this._hdrtable),u.labelElem.html(""));
E.logoField&&(u=z(h,E.logoField))&&(u.addContainerClass("oit-email-logo"),u.insertAsDiv(this._hdrtable.parent(),this._hdrtable),u.labelElem.html(""));if(E.headerFields)for(t=y.create("tbody"),A=0;A<E.headerFields.length;A++)if(g=E.headerFields[A],"string"==typeof g||Array.isArray(g))(J=z(h,g))&&J.appendAsRow(this._hdrtable);else if(g.fields)if(g.multi){J=[];for(u=0;u<g.fields.length;u++)p(h,g.fields[u],null,J);for(u=0;u<J.length;u++)J[u].appendAsRow(this._hdrtable)}else if(g.title){D=[];for(u=0;u<
g.fields.length;u++)if(J=z(h,g.fields[u]))J.showType(!1),D.push(J);if(0<D.length)for(t.html('<tr><td class="oit-emhdrsection" colspan="3"><span data-acc="none" class="oit-noacc">'+R["EMAIL_"+g.title]+R.LABEL_SEPARATOR+"</span></td></tr>"),this._hdrtable.append(t.firstChildElem()),u=0;u<D.length;u++)D[u].appendAsRow(this._hdrtable)}if(this.stickyHeader){this.stickyHeaderDetail=y.create("div","oit-shdetail");this.stickyHeaderDetailShown=!1;E=y.wrap(this._hdrtable.clone(!0));u=!1;t=0;for(A=E.firstChildElem();A;A=
h)h=A.nextSiblingElem(),t++,u||(20<t?u=!0:A.firstChildElem().hasClass("oit-emhdrsection")&&(u=!0)),u&&A.destroy();this.stickyHeaderDetail.append(E);this.stickyHeader.append(this.stickyHeaderDetail);this.stickyDateHeaderField=E.byClass("DATE");this.stickyDateHeaderField||(this.stickyDateHeaderField=E.byClass("RECEIVED"));Array.isArray(this.stickyDateHeaderField)&&(this.stickyDateHeaderField=this.stickyDateHeaderField[0]);this.stickyDateHeaderField&&(this.stickyDateHeaderField=this.stickyDateHeaderField.parent());
m(this.stickyHeader)}f(c)&&(this._emailExpander=y.create("div","oit-showemail"),this._emailExpander.onclick(this,r),this._emailExpander.ontap(this,r),this._hdrtable.parent().insert(this._emailExpander,this._hdrtable),x.showEmailAddresses?v.call(this):l.call(this));if(a)if(E=a.firstChildElem(),c=k(E,c))for(this.allHeaders=new nd(this,a,"oit-email_gear_icon",18,18,R.SHOWDETAILS,R.HIDEDETAILS),this.byClass("oit-headerpadding")[0].append(this.allHeaders),E=0;E<c.length;E++)c[E].tab=this.allHeaders;else a.destroy(),
a=null;a||this.removeExtraEmailHeaders();if((a=this._page._attachments)&&0<a.length){c=this.byClass("oit_attachments")[0];E=y.create("div");for(h=0;h<a.length;h++)u=a[h],u.ext||(t=u.name,A=t.lastIndexOf("."),u.ext="",-1!=A&&(u.ext=t.substring(A+1).toLowerCase())),(t=e[u.file_id]||e[u.ext])||(t="generic"),t=['<div class="oit-attached-file" data-index="',u.id,'">','<div class="oit-ficon oit-ficon-',t,'"><div></div></div>','<div class="oit-attinfo">',"<div>",u.displayName||u.name,"</div>"],u.size&&(t.push("<div>"),
u.size&&t.push(uc(u.size)),t.push("</div>")),t.push("</div></div>"),E.html(t.join("")),t=E.firstChildElem(),c.append(t),rb.on.addElement(t,u.id);E.html('<div style="clear:both;"></div>');c.append(E.firstChildElem())}this._page.pageContentChanged();this.applyShowEmailAddresses();this.onStyleChanged()},c=X(a,L);c.destroy=function(){rb.on.removeAllElements();this.stickyHeader&&this.stickyHeader.destroy();L.prototype.destroy.call(this)};var b=function(a,c){if(a)for(var d=0;d<a.length;d++){var e=a[d];
e.appendAsRow||(a[d]=new Jc(e,c));e.subfields&&b(e.subfields,a[d])}},f=function(a){var b=!1;if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d.addedToHeader&&d.hasEmailAddresses){b=!0;break}if(d.subfields&&(b=f(d.subfields)))break}return b},k=function(a,b,c){c||(c=[]);if(b){var d,e;for(d=0;d<b.length;d++)e=b[d],e.subfields||e.addedToHeader||!e.hasValue()||(e.appendToExtra(a),e.extra=!0,c.push(e));for(d=0;d<b.length;d++)if(e=b[d],e.subfields){var f=a,m=c,p=e.subfields;if(p)for(var l=!0,q=0;q<p.length;q++){var z=
p[q];if(!z.addedToHeader&&(z.hasValue()||z.subfields)){if(e&&l){var r=R["EMAIL_"+e.fieldId];if(r||e.fieldDef.label){var v,l=[];l.push('<tr><td class="oit-emhdrsection" colspan="2">');e.fieldType&&(v=e.fieldType.substring(1,e.fieldType.length-1));r?l.push('<span data-acc="none" class="oit-noacc">',r):l.push(e.fieldDef.label,'<span data-acc="none" class="oit-noacc">');v&&l.push(" (",v,")");l.push(R.LABEL_SEPARATOR,"</span></td><td></td></tr>");l=l.join("");r=y.create("tbody");r.html(l);f.append(r.firstChildElem())}l=
!1}z.appendToExtra(f);m.push(z)}z.subfields&&k(f,z.subfields,m)}}}return 0===c.length?null:c};c.applyShowEmailAddresses=function(){this._emailExpander&&(x.showEmailAddresses?v.call(this):l.call(this),this.applyViewSize(!0))};var v=function(){this._emailExpander&&(this._page.addClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.addClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-showemail").addClass("oit-hideemail"),B.each("pageLayoutChanged"))},l=function(){this._emailExpander&&
(this._page.removeClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.removeClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-hideemail").addClass("oit-showemail"),B.each("pageLayoutChanged"))},r=function(){x.showEmailAddresses=!x.showEmailAddresses},m=function(a){a.attr("data-acc")&&a.attr("data-acc","none");for(a=a.firstChildElem();a;a=a.nextSiblingElem())m(a)},p=function(a,b,c,d){if(b&&a){var e,f;if(Array.isArray(b))for(e=0;e<b.length;e++)p(a,b[e],null,d);else if(b.g)for(c=
b.t?";"+b.t+";":null,e=0;e<a.length;e++)f=a[e],f.subfields&&f.fieldId==b.g&&(c?f.fieldType&&-1!=f.fieldType.indexOf(c)&&p(f.subfields,b.id,b.d,d):p(f.subfields,b.id,b.d,d));else if("string"==typeof b)for(e=0;e<a.length;e++)if(f=a[e],f.fieldId==b&&!f.addedToHeader&&(f.hasValue()||f.isCompound())){d.push(f);var h=null;if(c&&"string"==typeof c)for(var k=0;k<a.length;k++){var m=a[k];if(m.hasValue()&&!m.addedToHeader&&m.fieldId==c){h=m;break}}f.setDisplayField(h)}}},z=function(a,b){if(a&&b){var c=[];p(a,
b,null,c);if(1<=c.length)return c[0]}},q=function(){if(this.stickyHeaderDetail&&!P.isSelecting()){var a=this.stickyHeaderDetail.firstChildElem().outerHeight;this.stickyHeaderDetail.css("height",""+a+"px");this.stickyHeaderDetailShown=!0}},G=function(){this.stickyHeaderDetail&&(this.stickyHeaderDetail.css("height",null),this.stickyHeaderDetailShown=!1)},F=function(){this.stickyHeaderDetailShown?G.call(this):q.call(this)};c.applyViewSize=function(a){var b;this.stickyHeader&&this.stickyHeader.css("width",
null);this.fixedSubjectField&&(a=this.fixedSubjectField.containerWidth(),this.fixedDateField&&(this.fixedDateField.show(),a+=this.fixedDateField.containerWidth()),b=w.viewNode.clientWidth,x.nochrome||(b-=42),a>b?(this.fixedDateField&&this.fixedDateField.hide(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display","none"),this.headerDateField&&this.headerDateField.show(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display",null)):(this.fixedDateField&&this.fixedDateField.show(),
this.stickyDateFixedField&&this.stickyDateFixedField.css("display",null),this.headerDateField&&this.headerDateField.hide(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display","none")));this.stickyHeader&&(a=this._page.parent().offsetWidth,b=w.viewNode.clientWidth,x.nochrome||(a-=2,b-=21),a>b&&(a=b),this.stickyHeader.css("width",a+"px"));if(!this._page.isHidden())M.onEmailHeaderResize(this._page.index);this._page.overlay.each("pageLayoutChanged")};c.finishAnimation=function(){this._page&&
this._page.finishAnimation()};c.showStickyHeader=function(){if(this.stickyHeader&&this.subjectBar&&(this.stickyHeaderVisible||(this.stickyHeader.addClass("oit-email-shvisible"),x.nochrome?this.stickyHeader.addClass("oit-nochrome"):this.stickyHeader.removeClass("oit-nochrome"),this.stickyHeaderVisible=!0),this.stickyHeaderVisible&&!x.nochrome)){var a=w.viewNode.scrollLeft;0===a?this.stickyHeader.css("left",null):this.stickyHeader.css("left",21-a+"px")}};c.hideStickyHeader=function(){this.stickyHeader&&
this.subjectBar&&this.stickyHeaderVisible&&(this.stickyHeader.removeClass("oit-email-shvisible"),this.stickyHeaderVisible=!1)};c.onScroll=function(){this.stickyHeader&&this.subjectBar&&(0>this.subjectBar.pos(this.stickyHeader.parent()).top?this.showStickyHeader():this.hideStickyHeader())};c.beginSelection=function(a){this._selectionPos=null;this.showEmailHeader(a)};c.getEmailFieldForRange=function(a){var b;if(a&&"text"==a.type){var c=this._page._fields,d;for(d in c){var e=c[d];if("custom"===d)for(var f=
0;f<e.length;f++){if(b=e[f].subfieldByRange(a))return b}else if(b=e.subfieldByRange(a))return b}}};c.moveto=function(a,b,c){return(a=this.showEmailHeader(a,b,c))&&a.tab?!0:!1};c.showEmailHeader=function(a,b,c){if(a&&"text"==a.type){var d=this.getEmailFieldForRange(a);if(d)if(d.field&&this.hideStickyHeader(),d.tab)c=c||{},d.tab.activate(null,!0),d.tab.scrollToRange(a),b&&b(c),this._selectionPos="tab";else{for(var e=d.addresses;!e&&d.groupField;)d=d.groupField,e=d.addresses;if(e&&!x.showEmailAddresses)for(var f=
0;f<e.length;f++){var k=e[f].address;if(k){var m=k.acc;if(m+k.text.length>=a.acc&&m<=a.accend){x.showEmailAddresses=!0;break}}}b&&b(c)}return d}};c.onStyleChanged=function(){this.applyEmailHeaderStyles()};c.applyEmailHeaderStyles=function(){try{this._headerStyle&&this.css(this._headerStyle),this.applyViewSize()}catch(J){this.logError("email header style","An error occurred setting email header style")}};var D=function(a,b){var c=!1;if(a.subfields)for(var d=a.subfields.length-1;0<=d;d--)D(a.subfields[d],
b)&&a.subfields.splice(d,1);if(!a.addedToHeader||a.extra)a.range&&b.push(a.range),c=!0;return c};c.removeExtraEmailHeaders=function(){this.allHeaders&&this.allHeaders.activate(null,!1);var a=this._page._fields;if(a){for(var b=[],c=a.length-1;0<=c;c--)D(a[c],b)&&a.splice(c,1);b.length&&(ja.replaceRawText(b),M.removeFromRange(b))}this.allHeaders&&(this.allHeaders.destroy(),delete this.allHeaders)};return a}(),nd=function(){var d=function(b,c,d,e,l,r,m){L.call(this,"div","oit-button");y.attach(this);
d&&this.addClass(d);this._header=b;this._minHeight=this._fullHeight=l;this._clientDiv=c;this._active=!1;this._utip=r;m&&(this._atip=m);r&&this.attr("title",r);if(this._clientDiv)this._clientDiv.on("scroll",null,a,this);this.on("click",this,this.activate,"toggle");this.on("tap",this,this.activate,"toggle")},e=X(d,L);e.destroy=function(){this._clientDiv&&(this._clientDiv.offscroll(a),delete this._clientDiv);this.offclick(this.activate);this.offtap(this.activate);L.prototype.destroy.call(this)};var a=
function(a,c){var b=c._clientDiv.scroll();c._scroll&&b.left==c._scroll.left&&b.top==c._scroll.top||(c._scroll=b,b=B.page(0),M.deactivate(),b.pageLayoutChanged(),M.positionAll(b))};e.isActive=function(){return this._active};e.containsRange=function(a){var b=y.wrap(a.startContainer);a=y.wrap(a.endContainer);var c=y.isDescendantOf(b,this._clientDiv);if(c||y.isDescendantOf(a,this._clientDiv))return{tab:this,rangeElem:c?b:a}};e.scrollToRange=function(b){if(this._clientDiv.childByClass("oit-emheadervalues")&&
(b=D.rangeRect(b,"view"))){var c=0,d=0,e=w.viewNode.clientWidth,l=w.viewNode.clientHeight;0>b.left?c=b.left-10:b.right>e&&(c=b.right+10-e);0>b.top?d=b.top-10:b.bottom>l&&(d=b.bottom+10-l);if(c||d)w.viewNode.dscroll(c,d),a(null,this)}};var c=function(a,c,d){(c=c.getEmailFieldForRange(a.range))&&c.tab&&(a.id==M.active()&&M.deactivate(),a.removeFromPage(d))};e.activate=function(a,d){var b=this._active;"toggle"==d?b=!b:"boolean"===typeof d&&(b=d);if(b!==this._active){var e=this._header._page;this._header.finishAnimation();
(this._active=b)||"tab"!==this._selectionPos||P.select(null);b||(M.each(c,e,this._header,e.index),w.viewNode.scroll(0,0));b?(this.addClass("oit-activetab"),this._clientDiv.parent().addClass("oit-activetab"),this._atip&&this.attr("title",this._atip)):(this.removeClass("oit-activetab"),this._clientDiv.parent().removeClass("oit-activetab"),this._utip&&this.attr("title",this._utip));this._header.applyViewSize()}};return d}(),Jc=function(){var d="TO CC BCC FROM EMAIL EMAIL2 EMAIL3 RCVD_REPRESENTING_ADDRESS RECEIVED_BY_EMAIL_ADDRESS SENDER_EMAIL_ADDRESS SENT_REPRESENTING_EMAIL_ADDRESS".split(" "),
e=["ORGANIZER","ATTENDEES"],a=function(a,b){L.call(this);this.fieldDef=a;a.id&&(this.fieldId=a.id);a.type&&(this.fieldType=";"+a.type+";");a.subfields&&(this.subfields=a.subfields);a.range&&(this.range=a.range);this.container=y.create("div");b&&(this.groupField=b,this.showGroupType=!0);this.addedToHeader=!1},c=X(a,L);c.clone=function(){return new a(this.fieldDef)};c.isCompound=function(){return this.subfields&&0<this.subfields.length&&-1!=e.indexOf(this.fieldId)};c.show=function(){this.container.css("display",
null);this.container.attr("data-acc",null)};c.hide=function(){this.container.css("display","none");this.container.attr("data-acc","none")};c.showType=function(a){this.showGroupType=!!a};c.subfieldById=function(a){var b,c;if(a)if(Array.isArray(a))for(c=0;c<a.length&&!(b=this.subfieldById(a[c]));c++);else for(c=0;c<this.subfields.length;c++){var d=this.subfields[c];if(d.fieldId==a){b=d;break}}return b};c.subfieldByRange=function(a){var b;if(this.subfields)for(var c in this.subfields){var d=this.subfields[c];
if("custom"==c)for(var e=0;e<d.length&&!(b=d[e].subfieldByRange(a));e++);else b=d.subfieldByRange(a);if(b)break}b||this.range&&Ac(this.range,a)&&(b=this);return b};c.toTagName=function(a,b){var c=f(this.container,a);if(this.labelElem){var d=f(this.labelElem,b);d.transferFrom(this.labelElem);c.append(d);this.labelElem=d}this.valueElem&&(d=f(this.valueElem,b),d.transferFrom(this.valueElem),c.append(d),this.valueElem=d);(d=this.container.parent())&&d.insert(c,this.container);this.container.destroy();
this.container=c};c.containerWidth=function(){return this.container.offsetWidth};c.addContainerClass=function(a){this.container.addClass(a)};c.prepForMainHeader=function(){this.addedToHeader||(this.addedToHeader=!0,this.parseEmailAddresses(),this.buildFieldValue())};c.appendAsRow=function(a){this.prepForMainHeader();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};c.appendAsDiv=function(a){this.prepForMainHeader();
"DIV"!==this.container.tagName&&this.toTagName("div","div");a.append(this.container)};c.insertAsDiv=function(a,b){this.prepForMainHeader();"DIV"!==this.container.tagName&&this.toTagName("div","div");a.insert(this.container,b)};c.appendToExtra=function(a){this.addedToHeader=!0;this.buildFieldValue();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};c.parseEmailAddresses=function(){this.addresses||(this.isCompound()?
(this.addresses=[],b(this,this.addresses),0===this.addresses.length&&delete this.addresses):this.fieldDef.value&&-1!=d.indexOf(this.fieldId)&&this.parseStandardEmailAddresses())};c.parseStandardEmailAddresses=function(){if(this.range){var a=y.create("div");a.html(this.fieldDef.value);for(var b,c=a.createTreeWalker(),d=c.firstACCNode(),a=[],e;d;){d=c.currentNode;if(1===d.nodeType)(d=y.data(d,"acc"))&&(b="none"===d?void 0:Number(d));else if(3===d.nodeType&&0<d.nodeValue.length&&void 0!==b){var f=b+
d.nodeValue.length;e&&e.accend!=b&&(e=null);e?e.accend=f:(e={text:d.nodeValue,acc:b,accend:f},a.push(e));b+=d.nodeValue.length}d=c.nextACCNode()}for(c=b=0;c<a.length;c++){e=a[c];d=e.text;e=e.acc;var f=[],k=d.toUpperCase(),v=(d.match(/@/g)||[]).length,w=(k.match(/CN=/g)||[]).length,k=(k.match(/((\[([^\[\]])*\/CN([^\[\]])*\])+)/g)||[]).length,v=0===w?v+k:0===k?v+w:v+Math.min(w,k);if(0===v)d=f;else{var x=r(d,/((?:[^;"']|"[^"]*"|'[^']*')+)/g,v),w=r(d,/((?:[^;"]|"[^"]*")+)/g,v),k=r(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,
v),v=r(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,v);if(!x||w.diff<x.diff)x=w;if(!x||k.diff<x.diff)x=k;if(!x||v.diff<x.diff)x=v;if(x){if(v=x.list)for(k=w=0;k<v.length;k++){var x=v[k],h=d.indexOf(x,w);if(-1==h)break;var h=e+h,w=w+x.length,u=null,g=null,t=-1,A=-1,B=x.lastIndexOf("<"),D=x.lastIndexOf(">"),F=x.lastIndexOf("["),L=x.lastIndexOf("]"),K=void 0,O=void 0;0<=B&&D>B?(K=B,O=D):0<=F&&L>F&&(K=F,O=L);void 0!==K&&O+1<x.length&&(K=void 0);void 0!==K?(u=x.substring(0,K),t=h,g=x.substring(K+1,O),A=h+K+1):(D=
x.toUpperCase(),B=D.indexOf("CN="),0<B&&"/"!==D.charAt(B-1)&&(B=-1),0<=B?(g=x,A=h,u=x.indexOf("/",B),-1==u&&(u=x.length),u=x.substring(B+3,u),t=h+B+3):-1!=x.indexOf("@")?(g=x,A=h):(u=x,t=h));u=l(u,t);g=l(g,A);u||(u=g,g=null);(u||g)&&f.push({name:u,address:g})}d=f}else d=void 0}d&&0<d.length&&(b++,this.addresses=this.addresses?this.addresses.concat(d):d)}b!=a.length&&delete this.addresses}};c.markAddedToHeader=function(a){this.addedToHeader=!0;if(a&&this.subfields)for(var b=0;b<this.subfields.length;b++)this.subfields[b].markAddedToHeader(a)};
var b=function(a,c){switch(a.fieldId){case "ORGANIZER":case "ATTENDEE":var d=a.subfieldById("DISPLAYAS"),e=a.subfieldById("EMAIL")||a.subfieldById("ORGANIZER");if(d&&d.fieldDef&&d.fieldDef.value&&d.fieldDef.range&&e&&e.fieldDef&&e.fieldDef.value&&e.fieldDef.range){var f=y.create("div");f.html(d.fieldDef.value);var k=f.text();f.html(e.fieldDef.value);f=f.text();k=l(k,d.fieldDef.range.acc);f=l(f,e.fieldDef.range.acc);k&&f&&(c.push({name:k,address:f}),a.markAddedToHeader(!0))}break;case "ATTENDEES":for(d=
0;d<a.subfields.length;d++)b(a.subfields[d],c)}};c.setDisplayField=function(a){if(a&&this.fieldDef.value&&this.range&&a.fieldDef.value&&a.range){var b=y.create("div");b.html(a.fieldDef.value);var c=l(b.text(),a.range.acc);b.html(this.fieldDef.value);b=l(b.text(),this.range.acc);c&&b&&(this.displayField=a,this.displayField.addedToHeader=!0,this.addresses=[{name:c,address:b}])}else delete this.displayField,delete this.addresses};c.hasValue=function(){return"string"==typeof this.fieldDef.imageurl||"string"==
typeof this.fieldDef.value};c.buildFieldValue=function(){var a=this.fieldDef,b;this.container.html("");if(!this.labelElem){var c;a.id&&(c=R["EMAIL_"+a.id])&&(a.label=c);var d=y.create("div","oit-emhdrlabel");b=[];c||("string"==typeof a.label?b.push(a.label):b.push(R.UNKNOWN_FIELD));b.push('<span data-acc="none" class="oit-noacc">');c&&b.push(a.label);this.groupField&&this.showGroupType&&this.groupField.fieldDef.type&&b.push(" (",this.groupField.fieldDef.type,")");a.label&&-1!=a.label.indexOf(R.LABEL_SEPARATOR)||
b.push(R.LABEL_SEPARATOR);b.push("</span>");d.html(b.join(""));this.labelElem=d}if(!this.valueElem){if("string"==typeof a.imageurl)b='<img src="'+a.imageurl+'"/>',this.valueElem=y.create("div","oit-fieldimage"),this.valueElem.html(b);else if(this.addresses){this.valueElem=y.create("div");this.valueElem.html(a.value);b=[];for(c=0;c<this.addresses.length;c++)d=this.addresses[c],b.push('<span class="oit-email-a">'),0<c&&k(", ",b),d.name&&v(d.name.text,d.name.acc,"oit-email-aname",d.address?d.address.text:
null,null,null,b),d.address&&(v(d.address.text,d.address.acc,"oit-email-aaddr",null," [","]",b),this.hasEmailAddresses=!0),b.push("</span>");this.valueElem.html(b.join(""));this.valueElem.removeData("acc")}else"string"==typeof a.value&&(this.valueElem=y.create("div"),this.valueElem.html(a.value));if(this.valueElem&&(this.valueElem.addClass("oit-emhdrvalue"),a.id&&(a=a.id,this.groupField&&(a=this.groupField.fieldDef.id+"/"+a),this.valueElem.attr("data-fieldid",a)),this.valueElem.hasClass("oit-noacc"))){var e;
this.valueElem.hasClass("oit-datetime-field")?e=xb(this.valueElem.text()):this.valueElem.hasClass("oit-date-field")?e=sc(this.valueElem.text()):this.valueElem.hasClass("oit-time-field")&&(e=tc(this.valueElem.text()));e&&this.valueElem.text(e)}}this.labelElem&&this.container.append(this.labelElem);this.valueElem&&this.container.append(this.valueElem)};var f=function(a,b){var c=y.create(b);c.addClass(a.attr("class"));var d=a.attr("data-acc");d&&c.attr("data-acc",d);(d=a.attr("data-fieldid"))&&c.attr("data-fieldid",
d);return c},k=function(a,b){b.push('<span class="oit-noacc" data-acc="none">',a,"</span>")},v=function(a,b,c,d,e,f,l){a=bc(a);d=bc(d);l.push("<span");d&&l.push(' title="',d,'"');0>b&&(c=c?c+" oit-noacc":"oit-noacc");c&&l.push(' class="',c,'"');e||f?(l.push(">"),e&&(0>b?l.push(e):k(e,l)),l.push("<span",' data-acc="'),0<b?l.push(b):l.push("none"),l.push('">',a,"</span>"),f&&(0>b?l.push(f):k(f,l))):(l.push(' data-acc="'),0<b?l.push(b):l.push("none"),l.push('">',a));l.push("</span>")},l=function(a,b){if(a){for(var c=
0;c<a.length&&/\s/.test(a[c]);c++)b++;a=a.trim();if(2<=a.length){var c=a.charAt(0),d=a.charAt(a.length-1);'"'!=c&&"'"!=c||c!=d||(b++,a=a.substring(1,a.length-1),(c=l(a,b))?(a=c.text,b=c.acc):a=null)}}return a?{text:a,acc:b}:null},r=function(a,b,c){if(a=a.match(b)){for(b=0;b<a.length;b++);b=0;if(a)for(var d=0;d<a.length;d++)(0<a[d].indexOf("@")||0<=a[d].indexOf("CN="))&&b++;if(0<b)return{list:a,count:b,diff:Math.abs(b-c)}}};return a}(),od=function(){var d=function(){L.call(this,"div","oit-scrollpane");
this.addClass("oit-scrollpanebar");this.html('<div class="oit-scrollpanecontent"></div><div class="oit-scrollbar"><div></div></div><div class="oit-scrollpaneup oit-fade"></div><div class="oit-scrollpanedn oit-fade"></div><div class="oit-scrollpaneup oit-ellip">&#x2022; &#x2022; &#x2022;</div><div class="oit-scrollpanedn oit-ellip">&#x2022; &#x2022; &#x2022;</div>');this.prop("scrollbar",this.childByClass("oit-scrollbar"),!1,!0);this.prop("scrollthumb",this.scrollbar.firstChildElem(),!1,!0);this.prop("scrollup",
this.byClass("oit-scrollpaneup"),!1,!0);this.prop("scrolldown",this.byClass("oit-scrollpanedn"),!1,!0);w.isMobileOrTablet&&(this.kinetic(!0),this.onpanstart(this,l),this.onpanmove(this,r));this.scrollbar.onclick(this,c);this.scrollbar.ontap(this,c);this.scrollthumb.ondragstart(this,b);this.scrollthumb.ondragmove(this,f);this.scrollthumb.ondragend(this,k);this.scrollthumb.ondragcancel(this,k);this.scrollthumb.onclick(this,v);this.prop("content",this.childByClass("oit-scrollpanecontent"),!1,!0);this.content.onwheel(this,
a);this.onmouseover(this,function(){this.addClass("oit-hover")});this.onmouseout(this,function(){this.removeClass("oit-hover")});y.attach(this)},e=X(d,L);Object.defineProperties(e,{scrollLeft:{get:function(){return 0},set:function(a){}},scrollTop:{get:function(){return-this.content.offsetTop},set:function(a){this.setScrollTop(a,!0)}},minScroll:{get:function(){return 0}},maxScroll:{get:function(){var a=this.content.outerHeight-this.clientHeight;0>a&&(a=0);return a}},contentHeight:{get:function(){return this.content.outerHeight}},
visibleHeight:{get:function(){return this.clientHeight}},enabled:{get:function(){return this.content.outerHeight>this.clientHeight}}});e.setScrollTop=function(a,b){if("number"===typeof a){var c=this.minScroll,d=this.maxScroll;a<c?a=c:a>d&&(a=d);this.content.offsetTop!=-a?(this.content.offsetTop=-a,!1!==b&&this.update(a),"function"===typeof Q.UIEvent?c=new UIEvent("scroll"):(c=Y.createEvent("UIEvents"))&&c.initUIEvent&&c.initUIEvent("scroll",!0,!1,Q,null,2),c&&this.dispatchCustom("scroll",c)):!1!==
b&&this.update(a);return a}};e.scrollIntoView=function(a){var b;a instanceof L?b=a.rect(this.content):a instanceof ga&&(b=a);b&&(a=this.scrollTop,b.bottom>=a+this.visibleHeight&&(a=b.bottom+11-this.visibleHeight),b.top<=a&&(a=b.top-11),this.scrollTop=a)};e.isVisible=function(a){var b;a instanceof ga?b=a:a instanceof L&&(b=a.rect(this.content));return b?(a=this.scrollTop*x.zoom,b.top<a+this.visibleHeight*x.zoom&&b.bottom>a):!1};e.update=function(a){if(void 0===a)this.setScrollTop(this.scrollTop);else{if(this.scrollbar){var b=
this.content.outerHeight,c=this.clientHeight;c>=b?(this.scrollbar.css("display","none"),this.removeClass("oit-scrollable")):(c=100*c/b,1>c&&(c=1),this.scrollthumb.css({top:100*a/b+"%",height:c+"%"}),this.scrollbar.css("display",null),this.addClass("oit-scrollable"))}if(this.scrollup){b=0<a;c=a<this.maxScroll;for(a=0;a<this.scrollup.length;a++)this.scrollup[a].css("opacity",b?null:0);for(a=0;a<this.scrolldown.length;a++)this.scrolldown[a].css("opacity",c?null:0)}}};var a=function(a){if(!a.ctrlKey&&
this.enabled){var b=a.deltaY;if(1==a.deltaMode||2==a.deltaMode)b*=12;this.scrollTop+=b;return!1}},c=function(a){if(a.offsetY){var b=this.content.outerHeight,c=this.clientHeight,d=this.scrollTop/b;a=a.offsetY/this.clientHeight;a<d?this.scrollTop-=c:a>d+c/b&&(this.scrollTop+=c)}},b=function(a){this.scrollthumb._topPercent=100*this.scrollTop/this.content.outerHeight;this.scrollbar.css("opacity",.1);return!1},f=function(a){var b=this.content.outerHeight,c=100*(b-this.clientHeight)/b;a=this.scrollthumb._topPercent+
100*a.delta.y/this.clientHeight;0>a?a=0:a>c&&(a=c);this.scrollTop=a*b/100;return!1},k=function(a){delete this.scrollthumb._topPercent;this.scrollbar.css("opacity",null);return!1},v=function(a){return!1},l=function(a){return!1},r=function(a){this.scrollTop-=a.delta.y;return!1};e.redirectEvent=function(b){var c=!0;"wheel"==b.type&&(a.call(this,b),c=!1);return c};return d}(),Mb={paragraph:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,
title:"COMMENT"},slide:{requireText:!1,skipIfNoText:!1,showIcon:!0,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},page:{requireText:!1,skipIfNoText:!1,showIcon:!0,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},cell:{requireText:!0,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},add:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,
textCls:"oit-anno-add",badgeCls:null,title:"INSERTED_TEXT"},"delete":{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:null,title:"DELETED_TEXT"},change:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!0,checkRanges:!0,textCls:"oit-anno-change",badgeCls:null,title:"CHANGED_TEXT"},hidden:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:"oit-badge-delete",title:"HIDDEN_TEXT"},
add_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_ROW"},delete_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_ROW"},add_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_COLUMN"},delete_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,
textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_COLUMN"},new_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"NEW_CELL"},modify_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MODIFIED_CELL"},clear_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"CLEAR_CELL"},move_cells:{requireText:!1,
skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MOVED_CELLS"},add_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_SHEET"},rename_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"RENAMED_SHEET"}},id=function(){var d=/\S/,e="#ffbc2b #9439ae #61b34a #de2f40 #43bee6 #ef5f11 #0078ff".split(" "),
a=['<div class="oit-annoblock"><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable oit-annotitle"> ',R.ANNOTATIONS,'</span><span class="oit-sortselect"><span class="oit-unselectable">',R.SORT_BY,'</span><select name="oit-sort" class="oit-sort"><option value="location">',R.LOCATION,'</option><option value="author">',R.AUTHOR_A_TO_Z,'</option><option value="rauthor">',R.AUTHOR_Z_TO_A,'</option><option value="date">',R.OLDEST_FIRST,'</option><option value="rdate">',
R.NEWEST_FIRST,'</option><option value="type">',R.ANNOTATION_TYPE,"</option></select></span></div></div>"].join(""),c=function(b){L.call(this,"div","oit-annopane");this._page=b;this._annos=[];this._groups=[];this._newGroups=[];this._groupOffsets=[];this._badgeColorIndex=0;this._authorColors={};this._showLeader=!0;this._batches=[];this._needLayout=!0;this.html(a);this._block=this.byClass("oit-annoblock")[0];this._header=this.byClass("oit-annoheader")[0];this._title=this.byClass("oit-annotitle")[0];
this._commentIcon=this.byClass("oit-commentsicon")[0];this._sortSpan=this.byClass("oit-sortselect")[0];this._sortSelect=this.byClass("oit-sort")[0];this._scrollPane=new od;this._block.append(this._scrollPane);this.onclick(B.deactivateAnnotation);this.ontap(B.deactivateAnnotation);this._sortSelect.onchange(this,E);this._scrollPane.onscroll(this,Z);ha.onresize(this,Z);F.onzoom(this,Z);this._isHidden=!0;this.css("display","none");this.attach()},b=X(c,L);b.destroy=function(){this._scrollPane.offscroll(this,
Z);F.offzoom(this,Z);ha.offresize(this,Z);F.offidle(this,p);F.offidle(this,Q);for(var a=0;a<this._newGroups.length;a++)this._newGroups[a].groupDiv.destroy();L.prototype.destroy.call(this)};b.update=function(){this.isHidden()||this._resizeTimer||(Z.call(this),this.layout(),this.scrollPane().update())};var f=function(a){var b=100;0<a._batches.length?b=0:0<a._newGroups.length&&(b=a._groups.length/(a._newGroups.length+a._groups.length),b=Math.floor(100*b));100<=b?a._title.text(R.ANNOTATIONS):a._title.text(R.LOADING+
" ("+b+"%)")};b.isLoading=function(){return 0<this._batches.length||0<this._newGroups.length};b.isEmpty=function(){return 0===this._annos.length&&0===this._batches.length&&0===this._newGroups.length};b.toolbarMode=function(a){!0===a?this._toolbarMode=!0:delete this._toolbarMode};b.attach=function(){if(!this.parent()){var a=this._page;if(a.supportsAnnotationPane()){var b=a.parent();b&&(a.nextSiblingElem()?b.insert(this,a.nextSiblingElem()):b.append(this))}}};b.range=function(){return this._range};
var k=function(a,b){var c=!1;if(a)if(Array.isArray(a))for(var d=0;d<a.length&&!(c=k(a[d],b));d++);else a.range&&(c=bb(a.range,b));return c},v=function(a,b){var c=a.anno;return k(c.text,b)||k(c.oldtext,b)||k(c.last_save_date||c.create_date||c.date,b)||k(c.author,b)},l=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)l(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=ja.getRawText(a.range.acc,a.range.accend))},r=function(a,b,c,d){var e=null,f;if("string"===typeof b)e=y.create("p"),
c.append(e),f=y.create("span"),e.append(f),m(a,b,f);else if(Array.isArray(b))for(var g=!0,h=0;h<b.length;h++){var k=b[h];k.range&&d&&(g=a._page.containsRange(k.range));g&&(e||(e=y.create("p"),c.append(e)),l(k),k.text?(f=y.create("span"),e.append(f),m(a,k,f)):e=null)}},m=function(a,b,c){b&&("string"===typeof b?(c.attr("data-acc","none"),c.addClass("oit-noacc"),c.text(b)):b.text&&(b.range&&b.range.acc?(c.attr("data-acc",b.range.acc),a._range?(b.range.acc<a._range.acc&&(a._range.acc=b.range.acc),b.range.accend>
a._range.accend&&(a._range.accend=b.range.accend)):a._range=da(b.range)):(c.attr("data-acc","none"),c.addClass("oit-noacc")),c.text(b.text),b.b&&c.css("font-weight","bold"),b.i&&c.css("font-style","italic")))},p=function(){if(0<this._batches.length){var a=this._batches.shift();if(a&&0<a.length){for(var b=this._page,c=b.overlay?b.overlay.layer("comments"):void 0,g,k=0;k<a.length;k++){var l=a[k],q=Mb[l.type],u=!!q;if(q&&q.skipIfNoText){var v=l,z=!1;if(v.text)for(g=0;g<v.text.length;g++){var w=v.text[g];
if(w.text&&d.test(w.text)){z=!0;break}}z||(u=!1)}if(u&&l.range){v=u=null;if(l.parentid)for(z=0;z<this._annos.length;z++)if(g=this._annos[z],g.anno.id==l.parentid){u=g;v=g.groupInfo;break}v||(v={groupDiv:y.create("div","oit-annogroup"),annos:[]},this._newGroups.push(v));z=y.create("div","oit-anno");z.attr("id","oita"+l.id);g=y.create("div","oit-anno-text");if(w=q.title)switch(w=R[w],l.type){case "add_row":w+=" "+Za(l.range.r1);break;case "delete_row":w+=" "+Za(l.range.r1);break;case "add_col":w+=" "+
Ja(l.range.c1);break;case "delete_col":w+=" "+Ja(l.range.c1);break;case "cell":w+=" "+eb(l.range);break;case "new_cell":w+=" "+eb(l.range);break;case "modify_cell":w+=" "+eb(l.range);break;case "clear_cell":w+=" "+eb(l.range);break;case "move_cells":w+=" "+eb(l.oldrange)+" to "+eb(l.range)}if(l.oldtext){if(q.showFromTo){var x=y.create("div","oit-anno-change-sep oit-noacc");x.attr("data-acc","none");x.text(R.ANNO_CHANGE_FROM);g.append(x)}r(this,l.oldtext,g,q.checkRanges);q.showFromTo&&(x=y.create("div",
"oit-anno-change-sep oit-noacc"),x.attr("data-acc","none"),x.text(R.ANNO_CHANGE_TO),g.append(x))}if(l.text)r(this,l.text,g,q.checkRanges);else if(q.requireText){x=y.create("p","oit-noacc oit-unsupportedcontent");x.attr("data-acc","none");var B=y.create("span");B.text(R.UNSUPPORTED_CONTENT);x.append(B);g.append(x)}x=y.create("div","oit-anno-meta");if(B=l.last_save_date||l.create_date||l.date){var D=null;"string"===typeof B?D=xb(B):B.text&&(D=xb(B.text));if(D){var E=y.create("span","oit-anno-date");
D===B.text?m(this,B,E):(E.text(D),E.addClass("oit-noacc"),E.attr("data-acc","none"));x.append(E)}}D="";B=null;l.author&&(D=y.create("span","oit-anno-author"),m(this,l.author,D),x.append(D),D=D.text().trim(),0<D.length&&(B=this._authorColors[D],B||(this._authorColors[D]=B=e[this._badgeColorIndex++],this._badgeColorIndex>=e.length&&(this._badgeColorIndex=0)),D=D.charAt(0).toUpperCase()));if(w){E=y.create("div","oit-anno-type oit-noacc");E.attr("data-acc","none");if(D){var G=y.create("div","oit-badge");
B&&G.css("background",B);G.text(D);E.append(G)}G=y.create("span");G.text(w);E.append(G);z.append(E)}z.append(g,x);v.groupDiv.append(z);g={anno:l,annoDiv:z,groupInfo:v};v.annos.push(g);z.onclick(this,t,g);z.ontap(this,t,g);"text"===l.range.type?(g.spans=Eb(b,l.range,q.textCls,l.id,"page"),u||(g.badge=new cd(b.index,c,q.badgeCls,D),B&&g.badge.css("background",B),g.badge.onclick(this,A,g),g.badge.ontap(this,A,g),g.badge.onmouseover(this,U,g),g.badge.onmouseout(this,S,g),g.badge.hide())):q.showIcon&&
(u?(g.parent=u,g.icon=u.icon,u.icon.removeClass("oit-commenticon"),u.icon.addClass("oit-commenticonmulti"),u.icon.resetDefaultSize(),l=u.icon.defaultSize(),u.icon.move(void 0,void 0,l.width,l.height)):(l=new bd(b.index,c,"oit-commenticon"),v.groupDiv.data("commenticon",l),l.data("comment",v.groupDiv),l.onclick(this,A,g),l.ontap(this,A,g),l.onmouseover(this,U,g),l.onmouseout(this,S,g),g.icon=l,l.hide()));g.index=this._annos.length;this._annos.push(g)}}Y(this)}h(this,!0);this.update()}0===this._batches.length&&
(F.offidle(this,p),this._processingBatches=!1,this.layout(),this._processBatchCallbackFn&&(this._processBatchCallbackFn(this,this._processBatchCallbackArg),delete this._processBatchCallbackFn,delete this._processBatchCallbackArg));f(this)};b.processAnnotations=function(a,b,c){if(a){if(500>=a.length)this._batches.push(a);else for(var d=0;d<a.length;d+=500){var e=d+500;e>a.length&&(e=a.length);e=a.slice(d,e);this._batches.push(e)}this._processingBatches||(this._processingBatches=!0,b&&(this._processBatchCallbackFn=
b,this._processBatchCallbackArg=c),F.onidle(this,p),p.call(this));f(this)}};b.show=function(){this.attach();if(this.parent()){this._isHidden=!1;this.css("display",null);for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&("slide"!==b.anno.type&&b!==this._activeAnno||b.icon.show());b.badge&&b.badge.show();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.onclick(this,A,b);d.ontap(this,A,b);d.onmouseover(this,U,b);d.onmouseout(this,S,b)}}Y(this);h(this);
this.update()}};b.hide=function(){this._isHidden=!0;this.css("display","none");for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&b.icon.hide();b.badge&&b.badge.hide();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.offclick(this,A);d.offtap(this,A);d.offmouseover(this,U);d.offmouseout(this,S)}}u(this)};b.isHidden=function(){return!!this._isHidden};b.panelRect=function(a){return B.elementRect(this._scrollPane,a)};b.contentRect=function(a){return B.elementRect(this._scrollPane.content,
a)};b.getSpanMap=function(){this._spanMap||(this._spanMap=new Hc(this._page,this._scrollPane.content));return this._spanMap};b.scrollPane=function(){return this._scrollPane};b.findACC=function(a){var b=this.getSpanMap();if(b)return b.findACC(a)};b.findRange=function(a,b){var c=this.getSpanMap();if(c)return c.findRange(a,b)};b.mapPointToSpan=function(a,b,c){var d=this.getSpanMap();if(d)return d.mapPointToSpan(a,b,c)};b.containsRange=function(a){var b=!1;"text"===a.type&&this._range&&a.acc<=this._range.accend&&
a.accend>=this._range.acc&&(a.acc===a.accend?b=!!this.findACC(a.acc):(a=this.findRange(a.acc,a.accend),void 0!==a&&0<a.length&&(b=!0)));return b};b.annoRect=function(a,b,c){var d=null,e;c||(c=a.anno.annoRange||a.anno.range);if(a.spans||a.anno.embeds){if(a.spans)for(var f=0;f<a.spans.length;f++)(e=a.spans[f].textRect(c))&&(d?b?e.bottom>d.bottom?d=e:e.bottom==d.bottom&&d.union(e):d.union(e):d=e);if(a.anno.embeds)for(b=0;b<a.anno.embeds.length;b++)(e=this._page.embeddingRect(a.anno.embeds[b].uid))&&
(d?d.union(e):d=e)}else if(a.icon)(e=a.icon.isHidden())&&a.icon.show(),d=new ga(a.icon.rect(w.viewNode),"view"),e&&a.icon.hide();else if("cell"===c.type)switch(a.anno.type){case "add_sheet":case "rename_sheet":d=B.overlayTabRect(this._page.overlay);break;case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":d=D.rangeRect(c,"view");break;default:d=D.expandRange(c),d=D.rangeRect(d,"view")}else d=D.rangeRect(c,"view",
!1,"page"),d||"text"!==c.type||(a=this._page.frameForRange(c))&&(a=a.firstChildElem())&&"DIV"===a.tagName&&(d=a.rect(w.viewNode),d=new ga(d,"view"),d.width=0,d.height=0);return d};b.annoTextHeight=function(a,b){var c=0;if(a.spans){for(var d,e=0;e<a.spans.length;e++){var f=a.spans[e].textRect(a.anno.range);f&&(!d||f.bottom>d.bottom?d=f:f.bottom==d.bottom&&d.union(f))}d&&(d.origin=b,c=d.height)}return c};var z=function(a,b){var c=a.annos[0],d=b.annos[0],c=Sa(c.anno.annoRange||c.anno.range,d.anno.annoRange||
d.anno.range);0===c&&(c=G(a,b));return c},q=function(a,b){return-z(a,b)},G=function(a,b){var c=a.annos[0].anno,d=b.annos[0].anno,c=c.last_save_date||c.create_date||c.date,d=d.last_save_date||d.create_date||d.date;c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=a.annos[0].index-b.annos[0].index);return e},K=function(a,b){return-G(a,b)},T=function(a,b){var c=a.annos[0].anno.author,d=b.annos[0].anno.author;c&&c.text&&
(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=G(a,b));return e},J=function(a,b){return-T(a,b)},N=function(a,b){var c=a.annos[0].anno.type,d=b.annos[0].anno.type,e=Mb[c],f=Mb[d];e&&e.title&&(c=R[e.title]);f&&f.title&&(d=R[f.title]);e=0;c&&d&&(e=c.localeCompare(d));0===e&&(e=z(a,b));return e},E=function(){var a=y.unwrap(this._sortSelect),a=a.item(a.selectedIndex);x.annotationSort=a?a.value:"index"};b.applySort=function(a){var b=
x.annotationSort;if(!this.isLoading()&&(a||b!==this._sort)){this._sort=b;switch(b){case "date":a=G;break;case "rdate":a=K;break;case "rlocation":a=q;break;case "author":a=T;break;case "rauthor":a=J;break;case "type":a=N;break;default:a=z}this._groups.sort(a);for(a=this._groups.length-1;0<=a;a--)this._groups[a].groupDiv.detach();for(a=0;a<this._groups.length;a++)this._scrollPane.content.append(this._groups[a].groupDiv);y.unwrap(this._sortSelect).value=b;delete this._spanMap;this._groupOffsets=[];this.update()}};
var h=function(a,b){if(!a.isHidden())if(a.isLoading()||2>a._annos.length)a._showSort=!1,delete a._headerWidth,a._sortSpan.css("display","none");else{var c=a._header.clientWidth;if(b||!a._headerWidth||a._showSort&&c<a._headerWidth||!a._showSort&&c>a._headerWidth){a._sortSpan.css("display",null);var c=a._sortSpan.pos(a._header),d=a._commentIcon.rect(a._header),e=!0;c.top>=d.bottom&&(e=!1);e||a._sortSpan.css("display","none");a._showSort=e}}};b.onResize=function(a){var b=this._header.clientWidth;if(!0===
a||b!=this._headerWidth){this._headerWidth=b;if(this._resizeTimer)sa(this._resizeTimer);else for(a=0;a<this._groups.length;a++)b=this._groups[a],b.visible&&b.groupDiv.css("height",null);this._resizeTimer=ba(function(){this._groupOffsets=[];for(var a=0;a<this._groups.length;a++){var b=this._groups[a];b.height&&(b.groupDiv.css("height",null),delete b.height)}this._spanMap&&this._spanMap.discardLayout();h(this);delete this._resizeTimer;this.update()},100,this)}};b.layout=function(){var a=this._page,
b=a.pageRect("overlay");if(!a.parent()||!this.parent()||this.isHidden())this.css("display","none");else if(this&&b){delete this._needLayout;var c,d,e=x.zoom;this._toolbarMode?this.css({top:null,left:null,height:null,display:null}):(this.css({top:b.top/e+"px",left:b.right/e+"px",height:b.height/e+"px",display:null}),150>b.height?(this._header.css("display","none"),this._scrollPane.css("top","0")):(this._header.css("display",null),this._scrollPane.css("top",null)));this._scrollPane.update();a.pagePos("overlay");
for(e=0;e<this._annos.length;e++){var f=this._annos[e];if(f.badge){var g=this.annoRect(f,!1);if(g){g.origin="overlay";c=b.left+5;d=(g.top+g.bottom)/2-10;var g=b.bottom-20-5,h;do{if(d>g)break;for(var k=h=0;k<e;k++)if(k!=e&&this._annos[k].badge){var l=this._annos[k].badge.position(),m=l.bottom- -2;d>l.top-l.height+-2&&d<m&&(d=m,h++)}}while(h&&20>=h);d>g||20<h?(f.badge.destroy(),delete f.badge):(f.badge.show(),f.badge.move(c,d))}else f.badge.hide()}if(f.icon&&!f.parent){if(f.anno.range)switch(f.anno.range.type){case "rect":c=
f.anno.range.left;d=f.anno.range.top;break;case "text":if(g=D.rangeRect(f.anno.range,a))c=g.left,d=g.top,f.icon.css("opacity",.3)}else c=f.anno.x,d=f.anno.y;void 0!==c&&void 0!==d&&(g=new ga(c,d,c+20,d+20,a),0>g.left?g.left=0:g.right>a.width&&(g.right=a.width),0>g.top?g.top=0:g.bottom>a.height&&(g.bottom=a.height),g.origin="overlay",f.icon.move(g.left,g.top),this._isHidden||"slide"!==f.anno.type&&f!==this._activeAnno||f.icon.show())}}}};var u=function(a){a._hasUpdateListener||(ha.onupdate(a,g),a._hasUpdateListener=
!0);ha.invalidateCanvas()};b.showLeader=function(a){!1!==a&&(a=!0);a!==this._showLeader&&(this._showLeader=!1!==a,ha.invalidateCanvas())};var g=function(a){if(!this._isHidden&&x.showAnnotations&&this._activeAnno){var b=this._activeAnno;if(b&&this._showLeader){var c;if(b.anno.oldrange&&"cell"===b.anno.oldrange.type){var d=P.cellSelection(),e=b.anno.annoRange||b.anno.range,f=b.anno.oldrange;d&&!bb(d,e)&&bb(d,f)&&(c=f)}if(d=this.annoRect(b,!0,c)){e=w.rootNode;f=w.viewNode;c=f.rect(e);d.origin="view";
d.offset(c.left,c.top);var g=d.left,h=d.top,k=d.right,l=d.bottom;0>g&&0<k&&(g=0);k>f.clientWidth&&g<f.clientWidth&&(k=f.clientWidth);0>h&&0<l&&(h=0);l>f.clientHeight&&h<f.clientHeight&&(l=f.clientHeight);d.move(g,h,k,l);k=b.annoDiv.rect(e);0===k.height&&(k=b.groupInfo.groupDiv.rect(e));D.padding();var m=10;b.spans&&(m=.7*this.annoTextHeight(b,"view"),10>m?m=10:40<m&&(m=40));var p,q,r;p="cell"===b.anno.range.type;q="add_sheet"===b.anno.type||"rename_sheet"===b.anno.type;var h=!1,l=!0,t=k.top+20,u=
k.bottom-20,f=k.left,g=t,b=f-10;if(p)h=!0,q?(m=(d.right+d.left)/2,p=d.top,q=m,r=p-10,l=!1):(m=d.right+2,p=d.top+d.height/2,q=m+10,q>b&&(q=m),r=p);else{var v=d.top-m;r=d.bottom+m;m=(d.right+d.left)/2;p=d.bottom;q=m;var z=this._page.pageRect("view").clone();z.offset(c.left,c.top);if(r>=z.bottom||g<p&&v>z.top)p=d.top,r=v;g=r>u?u:r<t?t:r}e=this._scrollPane.rect(e);g<e.top?g=e.top:g>e.bottom&&(g=e.bottom);d=!0;g<k.top?(g=e.bottom,d=!1):g>k.bottom&&(g=e.top,d=!1);l&&q>=b&&(q=m,r=p,b=f);if(m<f||!l)a.save(),
e=w.rootNode.rect(),e=e.right-e.left-c.left,a.beginPath(),a.rect(c.left,c.top,e,c.bottom-c.top),a.clip(),a.beginPath(),h&&a.arc(m,p,2,0,2*Math.PI,!0),a.moveTo(m,p),a.lineTo(q,r),a.lineTo(b,g),d&&a.lineTo(f,g),a.strokeStyle="rgba(255,255,255,0.1)",a.lineWidth=9,a.stroke(),a.strokeStyle="rgba(255,255,255,0.3)",a.lineWidth=7,a.stroke(),a.strokeStyle="rgba(255,255,255,0.5)",a.lineWidth=5,a.stroke(),a.strokeStyle="rgba(0,0,0,0.25)",a.lineWidth=3,a.stroke(),a.restore()}}}};b.deactivate=function(a,b){this.activate(null,
!1,!1,a,b)};b.activate=function(a,b,c,d,e){var f=this;if(f._activating)d&&d(e);else{!1!==b&&(b=!0);var g,h,k;if(a)if(h=wa(a))for(k=0;k<f._annos.length;k++){if(v(f._annos[k],h)){g=f._annos[k];break}}else if(a.anno&&a.groupInfo.groupDiv)g=a;else if(a.id)for(k=0;k<f._annos.length;k++)if(f._annos[k].anno===a){g=f._annos[k];break}if(g)B.deactivateAnnotation(),f._activating=g,x.showAnnotations||(x.showAnnotations=!0),B.movetoEx(this._page.index,{animate:!0,callbackFn:function(){B.scrollToAnnotationPane(function(){f._activeAnno=
g;B.activeAnnotationPane(f);if(g.spans||g.anno.embeds){if(g.spans)for(var a=0;a<g.spans.length;a++)g.spans[a].addClass("oit-active")}else g.icon&&(g.icon.show(),g.icon.activate());u(f);g.annoDiv.addClass("oit-active");if(b){var k;h&&(k=f.getSpanMap().findRange(h.acc,h.accend));if(k){for(var l,a=0;a<k.length;a++){var m=k[a].textRect(h);m&&(l?l.union(m):l=m)}l&&(l.origin=f._scrollPane.content,l.scale(1/x.zoom),f._scrollPane.scrollIntoView(l))}else f._scrollPane.scrollIntoView(g.groupInfo.groupDiv),
f._scrollPane.scrollIntoView(g.annoDiv)}if(k=g.anno.annoRange||g.anno.range)if(D.moveto(k),c&&"cell"===k.type&&"add_sheet"!==g.anno.type&&"rename_sheet"!=g.anno.type){k=(l=P.cellSelection())&&g.anno.oldrange&&!bb(l,k)&&bb(l,g.anno.oldrange)?da(g.anno.oldrange):da(k);switch(g.anno.type){case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":k.autoExpand=!1}M.pauseAutoHighlight(!0);P.select(k);M.pauseAutoHighlight(!1)}d&&
d(e);delete f._activating})}});else{a=f._activeAnno;f._activeAnno=null;if(a){if(a.spans||a.anno.embeds){if(a.spans)for(k=0;k<a.spans.length;k++)a.spans[k].removeClass("oit-active")}else a.icon&&(a.icon.deactivate(),"slide"!==a.anno.type&&a.icon.hide());u(f);a.annoDiv.removeClass("oit-active");B.activeAnnotationPane(null);a=null}d&&d(e)}}};var t=function(a,b){this.activate(b,!1,!0);return!1},A=function(a,b){if(0===y.selectedText().length)return M.deactivate(),P.reset(),this.activate(b,!0,!0),!1},U=
function(a,b){b.groupInfo.groupDiv.addClass("oit-hover")},S=function(a,b){b.groupInfo.groupDiv.removeClass("oit-hover")},Q=function(){if(!this.isHidden()&&!this._needLayout){for(var a=0;30>a;a++){var b=this._newGroups.shift();if(!b)break;this._scrollPane.content.append(b.groupDiv);this._groups.push(b)}this._scrollPane.update();f(this);Z.call(this);0===this._newGroups.length&&(this._processingGroups=!1,F.offidle(this,Q),h(this,!0),this.applySort(!0),M.each("addToPage",null,this._page.index,!0))}},
Y=function(a){!a._processingGroups&&0<a._newGroups.length&&!a.isHidden()&&(a._processingGroups=!0,a._addGroupInterval=F.onidle(a,Q),f(a),Q.call(a))},Z=function(){if(!this._isHidden){var a,b,c;c=-1;for(a=0;a<this._groups.length;a++)if(b=this._groups[a],!b.height&&(-1==c&&(c=a),!b.visible)){b.visible=!0;for(var d=0;d<b.annos.length;d++)b.annos[d].annoDiv.css("display",null)}d=0;if(-1!=c){var e=x.zoom;for(a=c;a<this._groups.length;a++)b=this._groups[a],void 0===b.height&&(c=b.groupDiv.rect(this._scrollPane.content),
this._groupOffsets[a]=c.top,d++,0<c.height&&(b.height=this._toolbarMode?c.height-1:c.height/e-1,b.groupDiv.css("height",b.height+"px")))}if(d<this._groups.length)for(a=0;a<this._groups.length;a++)void 0===this._groupOffsets[a]&&(b=this._groups[a],c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top);this._groupOffsets[this._groups.length]=this._scrollPane.content.outerHeight;c=this.clientHeight;d=this._scrollPane.scrollTop;this._toolbarMode||(c*=x.zoom,d*=x.zoom);for(a=0;a<this._groups.length;a++)if(b=
this._groups[a],e=this._groupOffsets[a]-d,e=0<this._groupOffsets[a+1]-d&&e<c,e!=b.visible)for(var e=(b.visible=e)?null:"none",f=0;f<b.annos.length;f++)b.annos[f].annoDiv.css("display",e);u(this)}};return c}(),Tc=function(){return function(){var d='<div><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable"> '+R.ANNOTATIONS+"</span></div></div>",e,a,c;this.show=function(){if(e&&c){var a=x.annoBarWidth;0<a?e.show({size:a}):e.show();c.show()}};this.hide=function(){e&&
(c&&c.hide(),e.hide())};this.destroy=function(){xa.offresizeinternal(this,f);B.offchange(this,b);x.offshowAnnotations(this,b);x.offannoBarWidth(this,b);e&&xa.removeInternal(-3);a&&a.destroy();a=e=null};var b=function(){var b=B.activePage(),b=b?b.annotationPane():null;b!==c&&(c&&(c.css("width",null),c.hide(),B.activeAnnotationPane(null),a.remove(c),c.toolbarMode(!1),c=null),c=b)&&(B.activeAnnotationPane(c),a.append(c),c.toolbarMode(!0),c.scrollPane().setScrollTop(0,!0));b=x.annoBarWidth;0>=b&&(b=void 0);
e.applySize(b,void 0,!0);c&&x.showAnnotations?this.show():this.hide()},f=function(b,d,e,f,m){-3===b&&a&&c&&(0<e&&(x.annoBarWidth=e,e+="px",a.css("width",e),c.css("width",e)),c.showLeader(!m),c.onResize(),ha.invalidateCanvas())};a=y.create("div","oit-annobar");e=new Nb(-3,"right",a,null,xa.internalParent(-3));e.resizable(!0,60,30,d);xa.addInternal(-3,e);xa.onresizeinternal(this,f);B.onchange(this,b);x.onshowAnnotations(this,b);x.onannoBarWidth(this,b);b.call(this)}}(),zc=function(){var d,e=function(){if(d){var a=
w.viewNode,a=a.offsetHeight-a.clientHeight;0===a?d.css("bottom",null):d.css("bottom",a+"px")}};ha.onresize(e);F.onzoom(e);var a=function(a){a=a||{};L.call(this,"div","oit-toast");a.className&&this.addClass(a.className);var b=[];a.collapseButton&&b.push('<input class="oit-collapsebutton" type="button" value="&#x25bc;">');a.closeButton&&b.push('<input class="oit-closebutton" type="button" value="x">');b.push('<div class="oit-title"></div><div class="oit-body"></div>');this.html(b.join(""));a.collapseButton&&
(this.prop("collapseButton",this.childByClass("oit-collapsebutton")),this.collapseButton.onclick(this,r),this.collapseButton.ontap(this,r));a.closeButton&&(this.prop("closeButton",this.childByClass("oit-closebutton")),this.closeButton.onclick(this,p),this.closeButton.ontap(this,p));this.prop("titletext",this.childByClass("oit-title"));this.prop("messagetext",this.childByClass("oit-body"));this._collapsed=!0;this.onclick(this,m);this.ontap(this,m);this.onmouseenter(this,f);this.onmouseleave(this,k);
y.attach(this);d||(d=y.create("div","oit-toastpane"),w.viewNode.parent().append(d),e());b=d.firstChildElem();a.collapseButton||!b?d.append(this):d.insert(this,b);a.title&&this.title(a.title);a.content&&this.message(a.content)},c=X(a,L);c.customEvent("expand");c.customEvent("collapse");var b=function(a){a._collapsed?a._colSize&&a.css({width:a._colSize.width+"px",height:a._colSize.height+"px"}):a._expSize&&a.css({width:a._expSize.width+"px",height:a._expSize.height+"px"})};c.title=function(a){if(void 0!==
a){this.titletext.html(a);a=this.attr("class");var c=this.css("display");this.attr("class","oit-toast");this.css("display",null);this.css({width:null,height:null});this._colSize={width:this.innerWidth,height:this.innerHeight};b(this);this.attr("class",a);this.css("display",c)}return this.titletext.html()};c.message=function(a){if(void 0!==a){this.messagetext.html(a);a=this.attr("class");var c=this.css("display");this.attr("class","oit-toast oit-expanded");this.css("display",null);this.css({width:null,
height:null});this._expSize={width:this.innerWidth,height:this.innerHeight};b(this);this.attr("class",a);this.css("display",c)}return this.messagetext.html()};c.isCollapsed=function(){return this._collapsed};c.hide=function(a){this._hidden||this._pendingHidden?a&&a():(this._pendingHidden=!0,this._hideCallback=a)};c.hideNow=function(){this._hidden=!0;this._pendingHidden=!1;this.animate({opacity:0,time:300,endCSS:{display:"none"},endFn:this._hideCallback})};c.show=function(){if(this._hidden||this._pendingHidden)this._pendingHidden=
this._hidden=!1,this.css("display",null),delete this._hideCallback};var f=function(){this._mouse=!0},k=function(){this._mouse=!1;this._pendingHidden&&this.hideNow()},v=function(){this.offtransitionend(v);this._tto&&(sa(this._tto),delete this._tto);this.removeClass("oit-collapsing");this.dispatchCustom("collapse",{});La()};c.collapse=function(a){if(this._collapsed)return!1;this._tto&&sa(this._tto);this._collapsed=!0;!1===a?(this.removeClass("oit-expanded"),b(this),this.dispatchCustom("collapse",{})):
(this.addClass("oit-collapsing"),this.removeClass("oit-expanded"),this.ontransitionend(v),ba(function(){b(this)},0,this),this._tto=ba(function(){delete this._tto;v.call(this)},400,this));La();return!0};var l=function(){this.offtransitionend(l);this._tto&&(sa(this._tto),delete this._tto);this.addClass("oit-expanded");this.removeClass("oit-expanding");this.dispatchCustom("expand",{});La()};c.expand=function(a){if(!this._collapsed)return!1;this._tto&&sa(this._tto);this._collapsed=!1;!1===a?(this.addClass("oit-expanded"),
b(this),this.dispatchCustom("expand",{})):(this.addClass("oit-expanding"),this.ontransitionend(l),b(this),this._tto=ba(function(){delete this._tto;l.call(this)},400,this));La();return!0};var r=function(a){if(this.collapse())return!1},m=function(a){if(this.expand())return!1},p=function(a){this.hideNow()};F.onreset(function(){d&&(d.destroy(),d=null)});return a}();w.libversion="2018.3.0.354";(function(d){Ua.install.dispatch();Ua.install.reset();Q.addEventListener("load",function(){Ua.init.dispatch();
Ua.init.reset()})})(!1)})(window,document);
//# sourceURL=oit.js 
