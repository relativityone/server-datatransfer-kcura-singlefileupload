/*
 oit.js 
 Portions (C) 1991, 2016, Oracle Corp, and (C) 2017, Relativity ODA LLC. 
 Version 2018.5.0.424 
*/
(function(S,W){var Tb,Ub;if(S.OIT){var ka=S.OIT.view;ka&&(ka.detach?ka.detach():ka.unload&&ka.unload())}S.OIT=function(){var c={};Object.defineProperties(c,{uninstall:{value:function(){ic&&ic(this)},writable:!0}});return c}();var X=function(c,e){e||(e=Pc);return c.prototype=Object.create(e.prototype)},ic=function(){if(S.OIT){var c=S.OIT.view;c&&c.detach();S.OIT=void 0}},hb=function(c,e,a){Object.defineProperty(OIT,c,{value:e,writable:!!a})},x=function(){var c=/^[.#\w][-_\.\w\d]*$/,e=("oit"+Math.random()).replace(/\W/g,
""),a=[],b=1,d=function(a){if(c.test(a)){if(0===a.lastIndexOf("#",0))return d.byId(a.slice(1));if(0===a.lastIndexOf(".",0))return d.byClass(a.slice(1));if(0===a.indexOf(" "))return d.byTagName(a)}return d.bySelector(a)};Object.defineProperties(d,{html:{get:function(){return d.wrap(W.documentElement)}},body:{get:function(){return d.wrap(W.body)}},head:{get:function(){return d.wrap(d.html.childByTagName("head"))}},expando:{value:e}});d.byId=function(a){return d.wrap(W.getElementById(a))};d.byClass=
function(a){return d.wrap(W.getElementsByClassName(a))};d.byTagName=function(a){return d.wrap(W.getElementsByTagName(a))};d.bySelector=function(a){return d.wrap(W.querySelectorAll(a))};d.attach=function(a){(a=d.wrap(a))&&a.data("_elem",a);return a};d.detach=function(a){a&&d.removeData(a,"_elem")};d.query=function(a){return d.data(a,"_elem")};d.isElement=function(a){return a&&(a.dom||1===a.nodeType)};d.isText=function(a){return a&&3===a.nodeType};d.isDescendantOf=function(a,b){a=d.unwrap(a);if(b=d.unwrap(b))for(;a&&
a.parentNode;){if(a.parentNode===b)return!0;a=a.parentNode}return!1};d.nodeIndex=function(a){a=d.unwrap(a);for(var b=0;;){a=a.previousSibling;if(!a)break;++b}return b};d.unwrap=function(a){a&&a.dom&&(a=a.dom);return a};d.wrap=function(a){if(a){var b;if(!d.isElement(a)&&0<=a.length&&("function"===typeof a.item?b=[]:Array.isArray(a)&&(b=a),b)){for(var c=0;c<a.length;c++)b[c]=d.wrap(a[c]);0===b.length&&(b=null);return b}if(a.tagName&&!a.dom)return(b=d.query(a))||(b=new V(a)),b}return a};d.acceptsData=
function(a){return a&&(1===a.nodeType||9===a.nodeType)};d.data=function(c,g,k){c=d.unwrap(c);if(d.acceptsData(c)&&g){var t=c[e];if(void 0!==k){if(!t){do t=b++;while(void 0!==a[t]);Object.defineProperty(c,e,{value:t})}a[t]||(a[t]={});a[t].domNode=d.nodeToString(c);return a[t][g]=k}var q;t&&(k=a[t])&&(q=k[g]);void 0===q&&c.getAttribute&&(q=c.getAttribute("data-"+g),null===q&&(q=void 0));return q}};d.destroyData=function(c){c=d.unwrap(c);d.acceptsData(c)&&(c=c[e])&&(a[c]=void 0,c<b&&(b=c))};d.removeData=
function(b,c){b=d.unwrap(b);if(d.acceptsData(b)){var g=b[e];if(g)if(c){if(g=a[g]){delete g[c];var t;a:{for(t in g)if(Object.prototype.hasOwnProperty.call(g,t)){t=!0;break a}t=!1}t||d.removeData(b)}}else a[g]=void 0}b&&b.removeAttribute&&b.removeAttribute("data-"+c)};d.removeSubtreeData=function(a){d.removeData(a);for(a=a.firstElementChild;a;a=a.nextElementSibling)d.removeSubtreeData(a)};d.reset=function(){var c,e;for(e in a){var g=a[e];g&&(d.logUnreleasedData&&d.logUnreleasedData(g),c||(c=[]),c[e]=
g)}c?a=c:(a=[],b=1)};d.hasClass=function(a,b){if(Array.isArray(b)){for(var c=0;c<b.length;c++)if(d.hasClass(a,b[c]))return!0;return!1}if(a=d.unwrap(a)){if(a.classList)return a.classList.contains(b);if(a.getAttribute&&(c=a.getAttribute("class")))return c=" "+c+" ",b=" "+b.trim()+" ",-1!=c.indexOf(b)}return!1};var g=function(a,b){if(a.classList)a.classList.add(b);else if(a.getAttribute&&!d.hasClass(a,b)){var c=a.getAttribute("class");a.setAttribute("class",c+(" "+b))}};d.addClass=function(a,b){if((a=
d.unwrap(a))&&b){var c;if(Array.isArray(b))for(c=0;c<b.length;c++)g(a,b[c]);else if(-1!=b.indexOf(" "))for(b=b.split(" "),c=0;c<b.length;c++)g(a,b[c]);else g(a,b)}};var k=function(a,b){if(a.classList)a.classList.remove(b);else if(a.getAttribute){var d=a.getAttribute("class").replace(b,"");a.setAttribute("class",d)}};d.removeClass=function(a,b){if((a=d.unwrap(a))&&b){var c;if(Array.isArray(b))for(c=0;c<b.length;c++)k(a,b[c]);else if(-1!=b.indexOf(" "))for(b=b.split(" "),c=0;c<b.length;c++)k(a,b[c]);
else k(a,b)}};d.create=function(a,b,d,c){return new V(a,b,d,c)};d.createText=function(a){return W.createTextNode(a)};d.listen=function(){return W.addEventListener.apply(W,arguments)};d.unlisten=function(){return W.removeEventListener.apply(W,arguments)};d.cursor=function(a){void 0!==a&&(W.body.style.cursor=a);return W.body.style.cursor};d.clearSelection=function(){S.focus();if(S.getSelection){var a=S.getSelection();null!==a&&a.removeAllRanges()}};d.selectRange=function(a,b,d,c){S.focus();if(S.getSelection){var e;
Ra(a)?e=a:(e=W.createRange(),e.setStart(a,b),e.setEnd(d,c));a=S.getSelection();a.removeAllRanges();a.addRange(e)}};d.selectedText=function(){var a;if(S.getSelection){var b=S.getSelection();b&&(a=b.toString())}else W.selection&&"Control"!=W.selection.type&&(a=W.selection.createRange().text);a||(a="");return a};d.nodeToString=function(a){if((a=d.unwrap(a))&&1===a.nodeType){var b=[];b.push("<",a.tagName.toLowerCase());if(a.classList)for(var c=0;c<a.classList.length;c++)b.push(".",a.classList[c]);a.id&&
b.push("#",a.id);b.push(">");return b.join("")}};return d}(),Pc=function(){var c=function(){},e=c.prototype;e.prop=function(a,b,d,c){"string"===typeof a&&void 0!==b&&Object.defineProperty(this,a,{value:b,writable:!!d})};e.deleteAll=function(){for(var a in this)this.hasOwnProperty(a)&&delete this[a]};e.invalidArg=function(a,b,d,c){var e="",e=b?e+("Invalid value specified for argument '"+b+"'"):e+"Invalid argument";d&&(e+=": '"+Gb(d)+"'");c&&(e+=", "+c);this.logError(a,e)};e.logError=function(a,b){var d;
this.publicName&&a&&(d=this.publicName+"."+a+": ");b&&(d=(d?d+": ":"")+String(b));d&&0<d.length&&E.on.error.dispatch(d,!1)&&console.error(d)};e.logFatalError=function(a,b,d,c){var e;this.publicName&&a&&(e=this.publicName+"."+a+": ");b&&(e=(e?e+": ":"")+String(b));d&&(e=(e?e+" ":"")+String(d));e&&0<e.length&&E.on.error.dispatch(e,!0)&&("warn"!==c&&(c="error"),console[c](e),ka.unload(),ka.showDocumentError(b))};e.logAJAXError=function(a,b,d,c,e){c===jc?b+=" (Request aborted)":c===Vb?b+=" (Request timed out)":
void 0!==c&&(b=b+" (HTTP Status "+c+")");c=[];d&&c.push(" [",d,"]");void 0!==e&&c.push(" responseText='",e,"'");this.logFatalError(a,b,c.join(""))};return c}(),V=function(){var c=[];c[0]=c[23]="right";c[5]=c[6]="up";c[11]=c[12]="left";c[17]=c[18]="down";for(var e=function(a){void 0===a&&(a="div");if("string"==typeof a){var b=this.dom=W.createElement(a),d=1;if(d<arguments.length){var c;"string"==typeof arguments[d]?c=arguments[d++]:Array.isArray(arguments[d])&&(c=arguments[d++].join(" "));c&&c.length&&
b.setAttribute("class",c)}d<arguments.length&&"string"==typeof arguments[d]&&(b.id=arguments[d++]);d<arguments.length&&(b=x.wrap(arguments[d++]))&&x.isElement(b)&&b.append(this)}else x.isElement(a)&&(this.dom=x.unwrap(a))},a=X(e),b="clientLeft clientTop clientWidth clientHeight offsetWidth offsetHeight scrollWidth scrollHeight parentNode tagName classList".split(" "),d=function(b){Object.defineProperty(a,b,{get:function(){return this.dom[b]}})},g=0;g<b.length;g++)d(b[g]);Object.defineProperties(a,
{id:{get:function(){return this.dom.id},set:function(a){this.dom.id=a}},opacity:{get:function(){return Number(this.computedStyleProp("opacity"))},set:function(a){this.dom.style.opacity=a}},offsetLeft:{get:function(){return this.dom.offsetLeft},set:function(a){this.dom.style.left=P(a)+"px"}},offsetTop:{get:function(){return this.dom.offsetTop},set:function(a){this.dom.style.top=P(a)+"px"}},scrollLeft:{get:function(){return this.dom.scrollLeft},set:function(a){this.dom.scrollLeft=P(a)}},scrollTop:{get:function(){return this.dom.scrollTop},
set:function(a){this.dom.scrollTop=P(a)}},innerWidth:{get:function(){var a=this.computedStyleProp("width");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientWidth},set:function(a){this.dom.style.width=P(a)+"px"}},innerHeight:{get:function(){var a=this.computedStyleProp("height");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientHeight},set:function(a){this.dom.style.height=P(a)+"px"}},outerWidth:{get:function(){var a=this.dom.offsetWidth,b=S.getComputedStyle(this.dom);b.marginLeft&&b.marginRight&&
(a+=parseFloat(b.marginLeft)+parseFloat(b.marginRight));return a}},outerHeight:{get:function(){var a=this.dom.offsetHeight,b=S.getComputedStyle(this.dom);b.marginTop&&b.marginBottom&&(a+=parseFloat(b.marginTop)+parseFloat(b.marginBottom));return a}}});a.focus=function(){this.dom.focus()};a.blur=function(){this.dom.blur()};a.toString=function(){return x.nodeToString(this)};a.parent=function(){if(this.dom)return x.wrap(this.dom.parentNode)};a.firstChildElem=function(){if(this.dom)return x.wrap(this.dom.firstElementChild)};
a.nextSiblingElem=function(){if(this.dom)return x.wrap(this.dom.nextElementSibling)};a.detach=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom)}};a.destroy=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom);this.destroyChildren();x.destroyData(this.dom);this.deleteAll()}};var k=function(a){for(var b=a.firstElementChild;b;b=a){a=b.nextElementSibling;k(b);var d=x.query(b);d?d.destroy():x.removeData(b)}};a.destroyChildren=function(){k(this.dom)};a.equals=
function(a){return this.dom==x.unwrap(a)};a.html=function(a){void 0!==a&&(this.destroyChildren(),this.dom.innerHTML=a);return this.dom.innerHTML};a.text=function(a){void 0!==a&&(this.destroyChildren(),this.dom.textContent=a);return this.dom.textContent};a.data=function(a,b){return x.data(this.dom,a,b)};a.ancestorData=function(a){for(var b,d=this.dom,c=x.unwrap(u.rootNode);d;){b=x.data(d,a);if(void 0!==b)break;if(d==c)break;d=d.parentNode}return b};a.removeData=function(a){x.removeData(this.dom,a)};
a.hasClass=function(a){return x.hasClass(this.dom,a)};a.addClass=function(a){x.addClass(this.dom,a);return this};a.removeClass=function(a){x.removeClass(this.dom,a);return this};a.attr=function(a,b){var d;if(Array.isArray(a)){for(var c={},f=0;f<a.length;f++)d=a[f],c[d]=this.dom.getAttribute(d);return c}if(void 0===b){if("string"===typeof a)return this.dom.getAttribute(a);for(d in a)a.hasOwnProperty(d)&&this.dom.setAttribute(d,a[d])}else null===b?this.dom.removeAttribute(a):this.dom.setAttribute(a,
b);return this};a.css=function(a,b){var d=this.dom;if(d){var d=d.style,c;try{if(Array.isArray(a)){for(var f={},e=0;e<a.length;e++)c=a[e],f[c]=d.getPropertyValue(Za[c]||c);return f}if(void 0===b)if("string"===typeof a){if(-1==a.indexOf(":"))return d.getPropertyValue(Za[a]||a);(f=ib(a))&&this.css(f)}else for(c in a)a.hasOwnProperty(c)&&(e=a[c],null===e||void 0===e?d.removeProperty(Za[c]||c):d.setProperty(Za[c]||c,e,""));else null===b?d.removeProperty(Za[a]||a):d.setProperty(Za[a]||a,b,"")}catch(wa){}}return this};
a.removeCSS=function(a){var b=this.dom;if(Array.isArray(a))for(var d=0;d<a.length;d++)b.style.removeProperty(a[d]);else if("string"===typeof a)b.style.removeProperty(a);else for(d in a)a.hasOwnProperty(d)&&b.style.removeProperty(d);return this};a.resetStyle=function(){return this.attr("style",null)};a.computedStyle=function(){return S.getComputedStyle(this.dom)};a.computedStyleProp=function(a){return this.computedStyle().getPropertyValue(a)};a.show=function(){this._hidden&&(this.css("display",null),
delete this._hidden);return this};a.hide=function(){this._hidden||(this.css("display","none"),this._hidden=!0);return this};a.isHidden=function(){return this._hidden};a.autoscroll=function(a,b){var d=this.dom;switch(arguments.length){case 0:return{left:d.scrollLeft,top:d.scrollTop};case 1:return this.autoscroll(a.left,a.top);case 2:void 0!==a&&(d.scrollLeft=a),void 0!==b&&(d.scrollTop=b)}return this};a.scroll=function(a,b){void 0===a&&void 0===b||this.cancelKinetic();return this.autoscroll.apply(this,
arguments)};a.dscroll=function(a,b){this.cancelKinetic();a&&(this.scrollLeft+=a);b&&(this.scrollTop+=b);return this};a.animate=function(a){a&&(this.finishAnimation(),this.dom&&new Qc(this,a));return this};a.finishAnimation=function(){var a=this.data("_animation");a&&a.finish();return this};a.abortAnimation=function(){var a=this.data("_animation");a&&a.abort();return this};a.append=function(){if(this.dom)for(var a=arguments,b=0;b<a.length;b++){var d=a[b];Array.isArray(d)?this.append.apply(this,d):
this.dom.appendChild(x.unwrap(d))}return this};a.insert=function(a,b){this.dom&&this.dom.insertBefore(x.unwrap(a),x.unwrap(b));return this};a.insertAfter=function(a,b){this.dom&&(a=x.unwrap(a),b=x.unwrap(b),b=b.nextSibling,this.dom.insertBefore(a,b));return this};a.insertFirst=function(a){this.dom&&this.dom.insertBefore(x.unwrap(a),this.dom.firstChild);return this};a.remove=function(a){this.dom&&this.dom.removeChild(x.unwrap(a));return this};a.clone=function(a){return this.dom?this.dom.cloneNode(!!a):
null};a.transferFrom=function(a){a=x.unwrap(a);if(this.dom&&a)for(;0<a.childNodes.length;)this.dom.appendChild(a.childNodes[0]);return this};a.forElementAndAncestors=function(a){for(var b=this,d=x.unwrap(u.rootNode);b&&!1!==a(b)&&b!=d;)b=b.parent();return this};a.forChildElements=function(a){return n.call(this,a,!1,arguments)};a.queryChildElements=function(a){return n.call(this,a,!0,arguments)};var n=function(a,b,d){for(var c=[null,-1],f=1;f<d.length;f++)c.push(d[f]);d=0;for(var e=this.dom.firstElementChild;e;e=
f,d++)if(f=e.nextElementSibling,e=!0===b?x.query(e):x.wrap(e))if(c[0]=e,c[1]=d,!1===a.apply(null,c))break;return this};a.pos=function(a){var b=this.dom;a=x.unwrap(a);if(a==b)return{left:0,top:0};for(;b&&!b.getBoundingClientRect;)b=b.parentNode;if(b)return b=b.getBoundingClientRect(),b={left:b.left,top:b.top},a&&a!==W.body&&(a=a.getBoundingClientRect(),b.left-=a.left,b.top-=a.top),b};a.size=function(){for(var a=this.dom;a&&!a.getBoundingClientRect;)a=a.parentNode;if(a)return a=a.getBoundingClientRect(),
{width:a.width,height:a.height}};a.rect=function(a){a=x.unwrap(a);for(var b=this.dom;b&&!b.getBoundingClientRect;)b=b.parentNode;if(b){var d=b.getBoundingClientRect(),d={left:d.left,top:d.top,right:d.right,bottom:d.bottom,width:d.width,height:d.height};a&&a!==W.body&&(a==b?(d.right-=d.left,d.bottom-=d.top,d.left=0,d.top=0):(a=a.getBoundingClientRect(),d.left-=a.left,d.top-=a.top,d.right-=a.left,d.bottom-=a.top));return d}};a.inRect=function(a,b){var d=this.dom;return d&&0<=a&&0<=b&&a<=d.clientWidth&&
b<=d.clientHeight};a.ancestorByClass=function(a){for(var b=this.parent(),d=u.rootNode;b&&b.hasClass;){if(b.hasClass(a))return b;if(b.equals(d))break;b=b.parent()}return null};a.childByTagName=function(a){a=a.toUpperCase();for(var b=this.dom.firstElementChild;b;b=b.nextElementSibling)if(b.tagName.toUpperCase()===a)return x.wrap(b);return null};a.childrenByTagName=function(a){var b=null;a=a.toUpperCase();for(var d=this.dom.firstElementChild;d;d=d.nextElementSibling)d.tagName.toUpperCase()===a&&(b||
(b=[]),b.push(x.wrap(d)));return b};a.childByClass=function(a){if(this)for(var b=this.firstChildElem();b;b=b.nextSiblingElem())if(b.hasClass(a))return b;return null};a.byClass=function(a){return x.wrap(this.dom.getElementsByClassName(a))};a.byId=function(a){for(var b=[x.unwrap(this.dom)];0<b.length;)for(var d=b.shift().firstElementChild;d;d=d.nextElementSibling){if(d.id===a)return x.wrap(d);b.push(d)}return null};a.byTag=function(a){a=a.toUpperCase();for(var b=[x.unwrap(this.dom)],d=[];0<b.length;)for(var c=
b.shift().firstElementChild;c;c=c.nextElementSibling)c.tagName.toUpperCase()===a?d.push(x.wrap(c)):b.push(c);if(d.length)return d};a.isDescendantOf=function(a){return x.isDescendantOf(this.dom,a)};a.mousePos=function(a){a||(a=S.event);for(var b={x:0,y:0},d=this.dom;d;d=d.offsetParent)b.x+=d.offsetLeft,b.y+=d.offsetTop;if(a.pageX||a.pageY)b.x=a.pageX-b.x,b.y=a.pageY-b.y;else if(a.clientX||a.clientY)b.x=a.clientX+W.body.scrollLeft+W.documentElement.scrollLeft-b.x,b.y=a.clientY+W.body.scrollTop+W.documentElement.scrollTop-
b.y;return b};a.touchPos=function(a){if(a){var b={identifier:a.identifier,x:0,y:0};if(a.center&&a.target){var d=x.wrap(a.target).pos(this);b.x=a.center.x+d.left;b.y=a.center.y+d.top}else{for(d=this.dom;d;d=d.offsetParent)b.x+=d.offsetLeft,b.y+=d.offsetTop;b.x=a.pageX-b.x;b.y=a.pageY-b.y}return b}};a.select=function(){S.focus();if(S.getSelection){var a=W.createRange();a.selectNodeContents(this.dom);x.selectRange(a)}else W.selection&&W.body.createTextRange&&(a=W.body.createTextRange(),a.moveToElementText(this.dom),
a.select())};var r=function(a){for(var b=!0;b;){var d=a.currentNode;if(1===d.nodeType)if("svg"===d.nodeName)b=a.skipNode();else if(d=x.data(d,"acc"),void 0!==d)if("none"===d)b=a.skipNode();else break;else break;else if(3===d.nodeType)break;else b=a.nextNode()}return b},v=function(){for(var a;!(a=this.nextSibling())&&this.parentNode(););return a},t=function(a){for(;this.currentNode!==a&&this.nextNode(););return this.currentNode===a},q=function(){return r(this)},m=function(){var a=this.nextNode();a&&
(a=r(this));return a};a.createTreeWalker=function(a,b,d){void 0===a&&(a=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);void 0===b&&(b=null);void 0===d&&(d=!1);a=W.createTreeWalker(this.dom,a,b,d);a.skipNode=v;a.skipToNode=t;a.firstACCNode=q;a.nextACCNode=m;return a};a.createCanvas=function(){return new kc(this)};a.on=function(a,b,d){void 0===d&&(d=b,b=void 0);if("function"!==typeof d)this.invalidArg("on"+a,"listener",d,"Must be a function");else{var c=Array.prototype.slice.call(arguments,2);c[0]=null;
b=b||this;var f,e=this.dom;f=a;var p=x.data(e,"_events");p||(p={},x.data(e,"_events",p));(e=p[f])||(e=p[f]=[]);f=e;for(p=0;p<f.length;p++)if(e=f[p],e.fn===d){e.ref=b;e.args=c;d=null;break}d&&(f.push({fn:d,ref:b,args:c}),1==f.length&&(c=this._events[a])&&c.add&&c.add(this,a))}return this};a.off=function(a,b,d){void 0===d&&(d=b);if("function"===typeof d&&(b=l(this.dom,a))){for(var c=0;c<b.length;c++)if(b[c].fn===d){b.splice(c,1);break}0===b.length&&(d=this._events[a])&&d.remove&&d.remove(this,a)}return this};
for(var l=function(a,b){var d=x.data(a,"_events");if(d&&(d=d[b])&&0<d.length)return d},K=function(a,b,d){a["on"+b]=function(a,d){1==arguments.length&&(d=a,a=null);if(2<arguments.length){for(var c=[b,a,d],f=2;f<arguments.length;f++)c.push(arguments[f]);return this.on.apply(this,c)}return this.on(b,a,d)};a["off"+b]=function(a,d){return this.off(b,a,d)};a._events||(a._events={});a._events[b]=d},M=function(a){var b=l(a.currentTarget,a.type);if(b){for(var d=!0,c=0;c<b.length;c++){var f=b[c];f.args[0]=
a;!1===f.fn.apply(f.ref,f.args)&&(d=!1);f.args[0]=null}d||jb(a)}},b="mouseover mouseout mouseenter mouseleave mousedown mousemove mouseup wheel touchstart touchmove touchend touchcancel click dblclick contextmenu keydown keyup keypress blur focus scroll change transitionend".split(" "),d={add:function(a,b){a.dom.addEventListener(b,M)},remove:function(a,b){a.dom.removeEventListener(b,M)}},g=0;g<b.length;g++)K(a,b[g],d);for(var b="tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
I=function(a){return"dragstart"===a||"dragmove"===a||"dragend"===a||"dragcancel"===a},H=function(a,b){var d=a.data("_gestures");!d&&b&&(d={listenerCount:0},a.data("_gestures",d));return d},d={add:function(a,b){var d=H(a,!0);d.touches||(d.touches=[],a.ontouchstart(y));d.listenerCount++;I(b)&&(d.dragCount||(d.dragCount=0,a.onmousedown(J)),d.dragCount++)},remove:function(a,b){var d=H(a);d&&(d.listenerCount--,0===d.listenerCount&&(a.removeData("_gestures"),a.offtouchstart(y)),I(b)&&0<d.dragCount&&(d.dragCount--,
d.dragCount||a.offmousedown(J)))}},g=0;g<b.length;g++)K(a,b[g],d);var O={add:function(a,b){},remove:function(a,b){}};a.customEvent=function(a){K(this,a,O)};a.dispatchCustom=function(a,b){var d=!0,c=l(this.dom,a);if(c)for(var f=0;f<c.length;f++){var e=c[f];e.args[0]=b;!1===e.fn.apply(e.ref,e.args)&&(d=!1);d&&b.defaultPrevented&&b.defaultPrevented()&&(d=!1);e.args[0]=null}return d};var C=function(a,b,d,f,e){for(var p=!0;a&&a.dom&&!l(a.dom,b);)a=a.parent();a&&!a.dom&&(a=null);if(a&&a.dom){var p=d.start,
D=d.current,m=p.center,g=D.center,K=d.delta;K||(K=d.delta={x:0,y:0});K.x=g.x-m.x;K.y=g.y-m.y;if(K.x||K.y)d.moved=!0;var q=d.moved||!1,t=d.press?!!d.press.started:!1,ja=P(Wb(m.x,m.y,g.x,g.y)),h=m.x,k=m.y,Z=g.x,B=g.y,h=P(h==Z&&k==B?0:Math.atan2(k-B,Z-h),100),oa;0<ja&&(oa=c[Math.floor((12*h/Math.PI+24)%24)]);k=1;Z=0;d.touches&&1<d.touches.length&&(0<p.distance&&(k=D.distance/p.distance),Z=Xb(D.angle-p.angle));d={type:b,srcEvent:f,target:a.dom,distance:ja,angle:h,scale:k,rotation:Z,start:m,center:g,delta:K,
direction:oa,moved:q,press:t,kinetic:!!e};S.OILogGesture&&S.OILogGesture(b,a,d);p=a.dispatchCustom(b,d);for(a=a.parent();p&&a&&a.dom;a=a.parent())l(a.dom,b)&&(p=a.dispatchCustom(b,d))}return p},R=function(a,b,d){b.press&&(b.press.started=!0,C(a,"press",b,d))},A=function(a,b,d){b.press&&(b.press.started&&C(a,"pressup",b,d),b.press.timer&&ta(b.press.timer),delete b.press)},f=function(a,b,d,c,e,p){a=d.kinetic;var l=!1,m;if(a){d.start=e;d.current=p;var D=Date.now()-a.frameTime,D=Math.exp(-D/325),g;a.ax&&
(m=-a.ax*D,.5>Math.abs(m)&&(m=0),d.current.center.x=e.center.x+a.tx+m);a.ay&&(g=-a.ay*D,.5>Math.abs(g)&&(g=0),d.current.center.y=e.center.y+a.ty+g);if(m||g)m=d.dragCount?"dragmove":"panmove",C(b,m,d,c,!0),l=!0,a.anim=qb(f,null,b,d,c,e,p)}l||(m=d.dragCount?"dragend":"panend",C(b,m,d,c,!0),delete d.kinetic,delete d.start,delete d.current)},h=function(a,b,d){b.pan&&(C(a,"pancancel",b,d),delete b.pan)},B=function(a){if(a){var b=Date.now();if(1==a.length){var d=a[0];a={x:P(d.x),y:P(d.y)};return{distance:0,
angle:0,center:a,time:b}}if(2<=a.length){for(var c=0,f,e=a.length-1,p=0;p<e;p++)for(var l=a[p],m=p+1;m<a.length;m++){var D=a[m],D=Wb(l.x,l.y,D.x,D.y);D>c&&(c=D,f=l,d=a[m])}a:{if(a){var g,K;if(1==a.length){e=a[0];a={x:e.x,y:e.y};break a}if(2==a.length){e=a[0];g=a[1];a={x:(e.x+g.x)/2,y:(e.y+g.y)/2};break a}if(2<a.length){e={x:0,y:0};p=0;l=a.length-1;for(m=0;m<a.length;m++){g=a[m];K=m<l?a[m+1]:a[0];D=g.x;g=g.y;var q=K.x;K=K.y;var t=D*K-q*g,p=p+t;e.x+=(D+q)*t;e.y+=(g+K)*t}p*=3;e.x/=p;e.y/=p;a=e;break a}}a=
void 0}a.x=P(a.x);a.y=P(a.y);c=P(c);e=f.x;f=f.y;p=d.x;d=d.y;return{distance:c,angle:P(e==p&&f==d?0:Math.atan2(f-d,p-e),100),center:a,time:b}}}};a.kinetic=function(a){!0===a?H(this,!0).enableKinetic=!0:!1===a&&(a=H(this))&&delete a.enableKinetic};a.cancelKinetic=function(){var a=H(this);a&&a.kinetic&&(a.kinetic.anim&&Yb(a.kinetic.anim),delete a.kinetic)};var y=function(a){var b=H(this);if(b){this.cancelKinetic();var d=b.touches,c=a.changedTouches,f=u.viewNode,e=null;b.dragCount||(e=this.pos(f));for(var p=
0;p<c.length;p++){var l=f.touchPos(c[p]);e&&(l.x-=e.left,l.y-=e.top);l.ox=l.x;l.oy=l.y;d.push(l)}b.current=B(b.touches);b.start=b.current;1==d.length?(delete b.tap,b.tap={time:b.current.time},A(this,b,a),a=da(R,500,null,this,b,a),b.press={timer:a}):1<d.length&&!b.pinch&&(delete b.tap,A(this,b,a),h(this,b,a),delete b.distance,b.pinch||(b.pinch={},C(this,"pinchstart",b,a)));Va.setTouchCapture(L,ca,Y,this);return!1}},L=function(a){var b=H(this);if(b){for(var d=b.touches,c,f=a.changedTouches,e=b.dragCount?
u.viewNode:this,p=0;p<f.length;p++)for(var l=e.touchPos(f[p]),m=0;m<d.length;m++)if(c=d[m],c.identifier===l.identifier){c.x=l.x;c.y=l.y;c.dx=l.x-c.ox;c.dy=l.y-c.oy;break}c=b.current;f=B(b.touches);if(f.distance!==c.distance||f.angle!==c.angle||f.center.x!==c.center.x||f.center.y!==c.center.y)if(b.previous=c,b.current=f,1!=d.length||b.multi)1<d.length&&(b.multi=!0,b.pinch&&(d=b.previous,c=b.current,f=b.start,0<f.distance&&(e=P(d.distance/f.distance,100),P(c.distance/f.distance,100)!=e&&C(this,"pinchmove",
b,a)),c.angle!=d.angle&&(b.rotate||(b.rotate={start:b.start.angle},C(this,"rotatestart",b,a)),C(this,"rotatemove",b,a))));else if(c=d[0],d=b.distance=Wb(c.dx,c.dy,0,0),c=f.time-b.start.time,10<d&&50<c&&(delete b.tap,b.press&&b.press.started||A(this,b,a),b.pan||(h(this,b,a),b.pan={startTime:b.current.time},b.enableKinetic&&!b.press&&(b.kinetic={vx:0,vy:0,frameTime:b.current.time,frameX:0,frameY:0}),C(this,b.dragCount?"dragstart":"panstart",b,a)),b.pan&&(C(this,b.dragCount?"dragmove":"panmove",b,a),
a=b.kinetic)))d=b.current.time,c=d-a.frameTime,f=b.delta,b.pan.moveTime=d,b=f.y-a.frameY,a.vx=1E3*(f.x-a.frameX)/(c+1)*.8+.2*a.vx,a.vy=1E3*b/(c+1)*.8+.2*a.vy,a.frameTime=d,a.frameX=f.x,a.frameY=f.y;return!1}},ca=function(a){ma(this,a,!1)},Y=function(a){ma(this,a,!0)},ma=function(a,b,d){var c=H(a);if(c){var e=c.touches,p=e.length-b.changedTouches.length;try{if(1==e.length)if(d)delete c.tap,A(a,c,b),h(a,c,b);else{if(c.pan){var l=Date.now(),m=l-c.pan.startTime;d=!1;var D,g=c.kinetic;g&&(150<l-c.pan.moveTime&&
(g.vx=0,g.vy=0),10<Math.abs(g.vx)&&(g.ax=.8*g.vx,g.tx=Math.round(c.delta.x+g.ax)),10<Math.abs(g.vy)&&(g.ay=.8*g.vy,g.ty=Math.round(c.delta.y+g.ay)),g.ax||g.ay?(g.frameTime=l,g.anim=qb(f,null,a,c,b,c.start,c.current),d=!0):delete c.kinetic);d||(D=c.dragCount?"dragend":"panend",C(a,D,c,b));if(!(c.dragCount||c.press&&c.press.started)&&1E3>m){var K=c.touches[0],q=Math.abs(K.dx),t=Math.abs(K.dy);60<=q&&60>t?D=0>K.dx?"swiperight":"swipeleft":60<=t&&60>q&&(D=0>K.dy?"swipeup":"swipedown");D&&C(a,D,c,b)}delete c.pan}A(a,
c,b);c.tap&&(200>Date.now()-c.tap.time&&C(a,"tap",c,b),delete c.tap)}else 1<e.length&&1>=p&&(d?(c.rotate&&(C(a,"rotatecancel",c,b),delete c.rotate),c.pinch&&(C(a,"pinchcancel",c,b),delete c.pinch)):(c.rotate&&(C(a,"rotateend",c,b),delete c.rotate),c.pinch&&(C(a,"pinchend",c,b),delete c.pinch)))}catch(kb){E.logError(null,kb)}a=b.changedTouches;for(b=0;b<a.length;b++)for(l=a[b],m=0;m<e.length;m++)if(e[m].identifier===l.identifier){e.splice(m,1);break}delete c.distance;0===e.length&&(delete c.start,
delete c.current,delete c.previous,delete c.multi,Va.releaseTouchCapture());return!1}},N=function(a){a=u.viewNode.mousePos(a);return{distance:0,angle:0,center:{x:a.x,y:a.y}}},J=function(a){if(0===(a.button||0)){var b=N(a),d=H(this,!0);d.start=b;d.current=b;if(!C(this,"dragstart",d,a))return Va.setMouseCapture(p,D,this),!1}},p=function(a){var b=N(a),d=H(this,!0);if(d&&d.current){var c=d.current.center;if(b.center.x!=c.x||b.center.y!=c.y)d.current=b,C(this,"dragmove",d,a);return!1}},D=function(a){var b=
H(this,!0);C(this,"dragend",b,a);Va.releaseMouseCapture();return!1};return e}(),Zb=function(){var c=function(a,b,d){V.call(this,"input",d);this.dom.type="button";"string"===typeof a&&(this.dom.value=a);"string"===typeof b&&(this.dom.title=b)},e=X(c,V);Object.defineProperties(e,{disabled:{get:function(){return this.dom.disabled},set:function(a){this.dom.disabled=a}}});return c}(),lc=function(){var c=function(a,b){V.call(this,"textarea",b);"string"===typeof a&&(this.dom.value=a)},e=X(c,V);Object.defineProperties(e,
{value:{get:function(){return this.dom.value},set:function(a){this.dom.value=a}}});e.moveCaret=function(a){var b=this.dom;b.createTextRange?(b=b.createTextRange(),b.move("character",a),b.select()):void 0!==b.selectionStart?(b.focus(),b.setSelectionRange(a,a)):b.focus()};return c}(),kc=function(){var c=function(a,b){V.call(this,"canvas");2===arguments.length?(this.dom.width=a,this.dom.height=b):1===arguments.length&&(this.dom.width=a.clientWidth,this.dom.height=a.clientHeight,x.wrap(a).append(this))},
e=X(c,V);Object.defineProperties(e,{width:{get:function(){return this.dom.width}},height:{get:function(){return this.dom.height}}});var a=function(a,b,c,e,r,v,t,q){this.globalAlpha=1;void 0!==r&&(this.fillStyle=r);v?(this.strokeStyle=v,this.lineWidth=t||1,this.lineCap="square",this.beginPath(),this.setLineDash(q||[]),this.rect(a,b,c,e),r&&this.fill(),this.stroke(),this.closePath()):(this.lineWidth=0,this.fillRect(a,b,c,e))},b=function(a,b,c,e,r,v,t){void 0!==r&&(this.strokeStyle=r);this.lineWidth=
v||1;this.lineCap="square";this.globalAlpha=1;this.beginPath();this.setLineDash(t||[]);this.moveTo(a,b);this.lineTo(c,e);this.stroke();this.closePath()};e.getContext=function(d){d=this.dom.getContext(d);d.oitrect=a;d.oitline=b;return d};return c}(),Wa=function(){var c=function(c,a){this.prop("list",c);this.prop("name",a)};X(c);return c}(),rb=function(){var c=function(a){this._createFn=a;this._plugins={}},e=X(c);e.item=function(a){return this._plugins[a]};e.items=function(){return this._plugins};e.extend=
function(a,b){if(Array.isArray(a))for(var d=0;d<a.length;d++)this.extend.call(this,a[d],b);else{if("string"===typeof a)return d=this._plugins[a],d||(d=this._createFn.call(this,a))&&(this._plugins[a]=d),d&&d.extend.call(d,b),d;if("object"===typeof a)for(d in a)this.extend.call(this,d,a[d])}};return c}(),u=function(){var c=new rb(function(e){return new mc(c,e)});c.reset=function(c,a){if("string"===typeof c){"boolean"!==typeof a&&(a=!0);var b=this._plugins[c];b&&b.reset(a)}};c.resetAll=function(c){"boolean"!==
typeof c&&(c=!0);for(var a in this._plugins)this._plugins[a].reset(c)};c.defaultVal=function(c){if(c=this._plugins[c])return c.defaultVal()};c.setProperty=function(c,a,b){(c=this._plugins[c])&&c.setProperty(a,b)};return c}(),mc=function(){var c=function(a,b){Wa.call(this,a,b)},e=X(c,Wa);e.extend=function(a){a=a||{};var b={_v:{value:void 0,writable:!0}};a.init&&(b.init={value:a.init});void 0!==a.def&&(b.def={value:a.def});this.list!==u&&(!0===a.pub&&(b.pub={value:a.pub}),a.legal&&(b.legal={value:a.legal}),
a.validate&&(b.validate={value:a.validate}),a.type&&(b.type={value:a.type||"boolean"},"number"===a.type||Array.isArray(a.type)&&-1!=a.type.indexOf("number")))&&("number"===typeof a.min&&(b.min={value:a.min}),"number"===typeof a.max&&(b.max={value:a.max}));Object.defineProperties(this,b);var d=this;this.list["on"+this.name]=function(a,b){return d.listen(a,b)};this.list["off"+this.name]=function(a,b){return d.unlisten(a,b)};Object.defineProperty(this.list,this.name,{enumerable:!0,get:function(){return void 0===
d._v&&(d.init&&(d._v=d.init()),void 0===d._v)?d.defaultVal():d._v},set:function(a){d.set(a)}})};e.listen=function(a,b){void 0===b&&(b=a,a=void 0);this._listeners||(this._listeners=[]);this._listeners.push({context:a,fn:b})};e.unlisten=function(a,b){if(this._listeners){void 0===b&&(b=a);for(var d=0;d<this._listeners.length;d++)if(this._listeners[d].fn==b){this._listeners.splice(d,1);break}}};e.set=function(a,b){if(a!==this._v){if(void 0!==a){var d=!0;if(this.type){var c=null===a?"null":typeof a,d=
c===this.type;!d&&Array.isArray(this.type)&&(d=-1!=this.type.indexOf(c));d||"string"!==c||(d="color"===this.type,!d&&Array.isArray(this.type)&&(d=-1!=this.type.indexOf("color")),d&&(c="color"));d&&"color"===c?Ga(a)||(this.pub&&E.invalidArg("setOptions",this.name,a,"Must be a CSS color string"),a=this._v):d||("null"===c?a=void 0:(this.pub&&(c=Array.isArray(this.type)?"Must be one of these types: "+JSON.stringify(this.type):"Must be of type "+this.type,E.invalidArg("setOptions",this.name,a,c)),a=this._v))}d&&
(this.legal&&-1==this.legal.indexOf(a)?(this.pub&&E.invalidArg("setOptions",this.name,a,"Must be one of "+JSON.stringify(this.legal)),a=this._v):void 0!==this.min&&a<this.min?(this.pub&&E.invalidArg("setOptions",this.name,a,"Using minimum value of "+this.min,!1),a=this.min):void 0!==this.max&&a>this.max?(this.pub&&E.invalidArg("setOptions",this.name,a,"Using maximum value of "+this.max,!1),a=this.max):this.validate&&(a=this.validate(this.name,a,this._v)))}if(a!==this._v){d=this._v;if("object"===this.type){this._v=
{};for(var e in a)a.hasOwnProperty(e)&&(this._v[e]=a[e])}else this._v=a;if(!1!==b&&this._listeners)for(e=0;e<this._listeners.length;e++)c=this._listeners[e],c.fn.call(c.context,this._v,d,this.name)}}};e.setProperty=function(a,b){if("object"===this.type||Array.isArray(this.type)&&-1!=this.type.indexOf("object")&&(!this._v||this._v[a]!==b))if(this._v||(this._v={}),this._v[a]!==b&&(this._v[a]=b,this._listeners))for(var d=0;d<this._listeners.length;d++){var c=this._listeners[d];c.fn.call(c.context,this._v,
null,this.name)}};e.reset=function(a){this.set(void 0,a)};e.defaultVal=function(){return this.def};return c}();u.extend({URL:{init:function(){return W.URL}},baseURL:{init:function(){return w.outputBaseUrl}},viewNode:{init:function(){var c=u.rootNode;if(c)return x.attach(c.childByClass("oit-view"))}},rootNode:{init:function(){var c=x.byClass("oit-view-root");if(c&&0<c.length)return x.attach(c[0])}},deType:{},drawing:{},libversion:{},documentLoading:{def:!1},documentLoaded:{def:!1},documentComplete:{def:!1},
documentUnloading:{def:!1},dynamicContent:{def:!1},enableRawText:{},guid:{},singlePageIndex:{},isMobile:{init:function(){return nc()}},isMobileOrTablet:{init:function(){return oc()}},editingComment:{def:0},staging:{def:!1},hasHiddenText:{def:!1},hasWorksheetRevisions:{def:!1},httpHeaders:{def:null},withCredentials:{def:!1}});var w=function(){var c=new rb(function(e){return new mc(c,e)});c.isPublic=function(c){return(c=this._plugins[c])&&c.pub};c.reset=function(c){$a(this._plugins,"reset",null,c)};
c.reset=function(c,a){if("string"===typeof c){"boolean"!==typeof a&&(a=!0);var b=this._plugins[c];b&&b.reset(a)}};c.resetAll=function(c){"boolean"!==typeof c&&(c=!0);for(var a in this._plugins)this._plugins[a].reset(c)};c.defaultVal=function(c){if(c=this._plugins[c])return c.defaultVal()};c.setProperty=function(c,a,b){(c=this._plugins[c])&&c.setProperty(a,b)};return c}();w.extend({disableAnimation:{pub:!0,type:"boolean",init:function(){return!1}},memoryModel:{pub:!0,type:"string",legal:["large","small",
"micro","none"],init:function(){return u.isMobileOrTablet?"small":"large"}},detectBaseUrl:{pub:!0,type:"boolean",def:!0},outputBaseUrl:{pub:!0,type:"string",def:""},centerPages:{pub:!0,type:"boolean",def:!0},redactionColor:{pub:!0,type:"color",def:"#000"},redactionFillColor:{pub:!0,type:"color",def:null},showHighlightLabels:{pub:!0,type:"boolean",def:!0},highlightLabelFontFamily:{pub:!0,type:"string",def:null},highlightLabelFontSize:{pub:!0,type:"string",def:null},highlightActivationBoxColor:{pub:!0,
type:["color","null"],def:null},redactionMode:{pub:!0,type:"string",legal:["simple","compound","hybrid"],def:"hybrid"},contentTimeout:{pub:!0,type:"number",min:1,def:2E4},doubleClickInterval:{pub:!0,type:"number",def:500,min:1,max:1E4},removeExtraEmailHeaders:{pub:!0,type:"boolean",def:!1},emailHeaderStyle:{pub:!0,type:"object",def:null},zoom:{type:"number",def:1,min:.1,max:40},zoomMode:{type:["string","null"],legal:[null,"page","pagewidth","pageheight","mobile"],init:function(){return u.isMobileOrTablet?
"mobile":null}},rotation:{type:"number",legal:[0,90,180,270],def:0},selectionMode:{type:"string",legal:["text","rect","cell","none"],def:"text",validate:function(c,e,a){return T.validateMode(e,a)}},nochrome:{pub:!0,type:"boolean",def:!1,init:function(){return!1}},scrollMode:{pub:!0,type:"string",legal:["single","vertical","hswipe","vswipe"],def:"vertical",init:function(){return u.isMobileOrTablet?"hswipe":"vertical"}},showSlideNotes:{pub:!0,type:"boolean",def:!1},showAnnotations:{pub:!0,type:"boolean",
def:!1},presentationMode:{pub:!0,type:"string",legal:["normal","slideshow"],def:"normal"},showEmailAddresses:{pub:!0,type:"boolean",def:!1},showHiddenSheets:{pub:!0,type:"boolean",def:!1},showHiddenRows:{pub:!0,type:"boolean",def:!1},showHiddenColumns:{pub:!0,type:"boolean",def:!1},showCellTooltips:{type:"boolean",def:!1},showHiddenContentNotification:{pub:!0,type:"string",legal:["none","expanded","collapsed"],def:"collapsed"},appointmentHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",headerFields:[["ORGANIZER",
"FROM"],"IMPORTANCE","LOCATION","DTSTART","DTEND","CATEGORIES","ATTENDEES","REQATTENDEE","OPTATTENDEE"]}},contactHeader:{pub:!0,type:"object",def:{subjectField:["SUBJECT","DISPLAYAS","FILEAS","FULLNAME"],defaultSubject:!1,dateField:null,photoField:[{g:"PHOTO",id:"PHOTO"},"PHOTO"],logoField:[{g:"LOGO",id:"LOGO"},"LOGO"],headerFields:["COMPANY",[{g:"NAME",id:"FIRST"},"FIRST"],[{g:"NAME",id:"MIDDLE"},"MIDDLE"],[{g:"NAME",id:"FAMILY"},"FAMILY"],[{g:"NAME",id:"SUFFIX"},"SUFFIX"],[{g:"NAME",id:"TITLE"},
"TITLE","JOBTITLE"],{multi:!0,fields:[{g:"TELENUMBER",t:"Work",id:"TELENUMBER",l:"EMAIL_BUSINESSPHONE"},{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},"BUSINESSPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Cell",id:"TELENUMBER",l:"EMAIL_MOBILEPHONE"},"MOBILEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Pager",id:"TELENUMBER",l:"EMAIL_PAGERPHONE"},"PAGERPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Home",id:"TELENUMBER",
l:"EMAIL_HOMEPHONE"},{g:"ADDRESS",t:"Home",id:"PHONE",l:"EMAIL_HOMEPHONE"},"HOMEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Postal",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},{g:"ADDRESS",t:"Postal",id:"PHONE",l:"EMAIL_OTHERPHONE"},{g:"TELENUMBER",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},"TELENUMBER","OTHERPHONE"]},{multi:!0,fields:[{g:"EMAIL",id:"EMAIL",d:"DISPLAYAS"},"EMAIL"]},"WEBPAGE","IMADDRESS","DISPLAYAS",{title:"BUSINESSADDRESS",fields:[[{g:"ADDRESS",t:"Work",id:"POBOX"},{g:"BUSINESSADDRESS",id:"BUSINESSPOBOX"},
"BUSINESSPOBOX"],[{g:"ADDRESS",t:"Work",id:"STREET"},{g:"BUSINESSADDRESS",id:"BUSINESSSTREET"},"BUSINESSSTREET"],[{g:"ADDRESS",t:"Work",id:"CITY"},{g:"BUSINESSADDRESS",id:"BUSINESSCITY"},"BUSINESSCITY"],[{g:"ADDRESS",t:"Work",id:"STATE"},{g:"BUSINESSADDRESS",id:"BUSINESSSTATE"},"BUSINESSSTATE"],{g:"ADDRESS",t:"Work",id:"REGION"},[{g:"ADDRESS",t:"Work",id:"POSTALCODE"},{g:"BUSINESSADDRESS",id:"BUSINESSPOSTALCODE"},"BUSINESSPOSTALCODE"],[{g:"ADDRESS",t:"Work",id:"COUNTRY"},{g:"BUSINESSADDRESS",id:"BUSINESSCOUNTRY"},
"BUSINESSCOUNTRY"],[{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE2"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE2"},"BUSINESSPHONE2"],[{g:"ADDRESS",t:"Work",id:"BUSINESSFAX"},{g:"BUSINESSADDRESS",id:"BUSINESSFAX"},"BUSINESSFAX"]]},{title:"HOMEADDRESS",fields:[[{g:"ADDRESS",t:"Home",id:"POBOX"},"HOMEPOBOX"],[{g:"ADDRESS",t:"Home",id:"STREET"},"HOMESTREET"],[{g:"ADDRESS",t:"Home",id:"CITY"},"HOMECITY"],[{g:"ADDRESS",t:"Home",id:"STATE"},"HOMESTATE"],{g:"ADDRESS",t:"Home",id:"REGION"},[{g:"ADDRESS",t:"Home",id:"POSTALCODE"},
"HOMEPOSTALCODE"],[{g:"ADDRESS",t:"Home",id:"COUNTRY"},"HOMECOUNTRY"],[{g:"ADDRESS",t:"Home",id:"PHONE2"},"HOMEPHONE2"],[{g:"ADDRESS",t:"Home",id:"FAX"},"HOMEFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",t:"Postal",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",t:"Postal",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",t:"Postal",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",t:"Postal",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",t:"Postal",id:"REGION"},[{g:"ADDRESS",t:"Postal",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",
t:"Postal",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",t:"Postal",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",t:"Postal",id:"FAX"},"OTHERFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",id:"REGION"},[{g:"ADDRESS",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",
id:"FAX"},"OTHERFAX"]]}]}},distroHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:[]}},journalHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"START",headerFields:["ENTRY_TYPE","COMPANY","DURATION","CATEGORIES"]}},emailHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:["CLIENT_SUBMIT_TIME","DATE"],headerFields:["FROM","TO","CC","BCC"]}},noteHeader:{pub:!0,type:"object",def:{subjectField:null,dateField:null,headerFields:["CREATION_TIME",
"CATEGORIES"]}},postHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"CREATION_TIME",headerFields:["FROM","CLIENT_SUBMIT_TIME","CONVERSATION_TOPIC"]}},taskHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:"START_DATE STATUS DUE_DATE PRIORITY OWNER PERCENT_COMPLETE CATEGORIES".split(" ")}},annoBarWidth:{pub:!0,type:"number",init:function(){return Math.min(u.viewNode.clientWidth/2,320)}},highlightTermIntervals:{pub:!0,type:"boolean",def:!0},highlightActivationStyle:{pub:!0,
type:"string",legal:["box","opacity"],def:"opacity"},annotationSort:{pub:!0,type:"string",legal:"location date rdate author rauthor type".split(" "),def:"location"},normalizeAccentsForSearch:{pub:!0,type:"boolean",def:!0}});var Rc=function(){var c=function(a,b,d){Wa.call(this,b,d);this.prop("host",a,!1,!0)},e=X(c,Wa),a=function(a,b,d){var c=a._int;if(c)for(var e=0;e<c.length;e++){var m=c[e];if(!(m.fn!==b||void 0!==d&&m.context!==d||a._xint&&-1!==a._xint.indexOf(e)))return e}return-1},b=function(a,
b){var d=a._pub;return d?d.indexOf(b):-1},d=function(b,d,c,e){void 0===c&&(c=d,d=void 0);if(-1===a(b,c,d)){var l=!b.hasListeners(),m={context:d,fn:c};!0===e&&(m.listenOnce=!0);b.single&&b.hasListeners()?b.logError(null,"Only one listener may be registered for the "+b.name+" event."):(b._int||b.prop("_int",[],!0),b._int.push(m),l&&b.isSystemEvent()&&b.list.addElementListeners(b.name),b.onListen&&b.onListen.call(null,b,c,d))}},g=function(a,b){-1!=b&&(a.dispatching?(a._xint||(a._xint=[]),a._xint.push(b)):
(a._int.splice(b,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onUnlisten&&a.onUnlisten.call(null,a)))},k=function(a,b){-1!=b&&(a.dispatching?(a._xpub||(a._xpub=[]),a._xpub.push(b)):(a._pub.splice(b,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onRemove&&a.onRemove.call(null,a)))},n=function(){var a;this.detail&&(a=this.detail.apply(null,arguments));var b=this.systemEventName||this.name,d=W.createEvent("CustomEvent");d.initCustomEvent(b,
!0,!0,a);return d},r=function(){var a=!0,b,d;this.dispatching=!0;var c=this._int;if(c)for(b=c.length,d=0;d<b;d++){var e=c[d];e.listenOnce&&g(this,d);!1===e.fn.apply(e.context,arguments)&&(a=!1)}c=this._pub;if(a&&c){a=n.apply(this,arguments);b=c.length;for(d=0;d<b;d++)c[d].call(void 0,a);a=!a.defaultPrevented}a&&this._def&&(a=this._def.fn.apply(this._def.context,arguments));this.dispatching=!1;if(this._xint){for(d=this._xint.length-1;0<=d;d--)g(this,this._xint[d]);delete this._xint}if(this._xpub){for(d=
this._xpub.length-1;0<=d;d--)k(this,this._xpub[d]);delete this._xpub}return a};e.extend=function(a){a&&(!0===a.pub&&(this.prop("pub",!0),a.detail&&this.prop("detail",a.detail)),!0===a.systemEvent&&this.prop("systemEventName","_"+this.name),0<a.delay&&this.prop("delay",a.delay),!0===a.single&&this.prop("single",!0),this.prop("onListen",a.onListen),this.prop("onUnlisten",a.onUnlisten),this.prop("onAdd",a.onAdd),this.prop("onRemove",a.onRemove),Object.defineProperty(this.list,this.name,{enumerable:!0,
value:this}))};e.enable=function(){this.disabled=!1};e.disable=function(){this.disabled=!0};e.hasListeners=function(){return!!this._def||this._int&&0<this._int.length||this._pub&&0<this._pub.length};e.isSystemEvent=function(){return!!this.systemEventName};e.setDefaultListener=function(a,b){if(a){this._def&&this.setDefaultListener(null);var d=!this.hasListeners();this._def={context:b,fn:a};d&&this.isSystemEvent()&&this.list.addElementListeners(this.name);this.onListen&&this.onListen.call(null,this,
a,b)}else this._def&&(delete this._def,!this.hasListeners()&&this.isSystemEvent()&&this.list.removeElementListeners(this.name),this.onUnlisten&&this.onUnlisten.call(null,this))};e.listen=function(a,b){d(this,a,b,!1)};e.listenOnce=function(a,b){d(this,a,b,!0)};e.unlisten=function(b,d){void 0===d&&(d=b,b=void 0);g(this,a(this,d,b))};e.addPublicListener=function(a){var d=!1;if(this.pub&&"function"===typeof a)if(-1!==b(this,a))d=!0;else{var c=!this.hasListeners();this.single&&this.hasListeners()?this.logError(null,
"Only one listener may be registered for the "+this.name+" event."):(this._pub||this.prop("_pub",[],!0),this._pub.push(a),c&&this.isSystemEvent()&&this.list.addElementListeners(this.name),this.onAdd&&this.onAdd.call(null,this,a),d=!0)}return d};e.removePublicListener=function(a){a=b(this,a);if(-1==a)return!1;k(this,a);return!0};e.dispatch=function(){this.logDispatch&&this.logDispatch.apply(this,arguments);if(this.hasListeners()&&!this.disabled){if(!this.delay||u.documentUnloading)return r.apply(this,
arguments);this._dispatchTimer&&ta(this._dispatchTimer);this._ddArgs=arguments;this._dispatchTimer=da(v,this.delay,this)}return!0};var v=function(){r.apply(this,this._ddArgs);delete this._ddArgs};e.dispatchTo=function(a,b){var d=n.apply(this,b);a.call(void 0,d);return!d.defaultPrevented};e.reset=function(){this._int&&(this._int=[]);this._pub&&(this._pub=[]);delete this._def};return c}(),pc=function(){var c="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel".split(" "),
e=function(a){for(a=x.unwrap(a);a;){var b=x.data(a,"dispatcherData");if(b)return b;a=a.parentNode}},a=function(a){return new Rc(this._host,this,a)},b=function(b,d){rb.call(this,a);this.name=d;this._host=b;this._eventElements=[];var c=this;this.onSystemEvent=function(a){var b=!0,d=c[a.type];if(d&&d.hasListeners()&&!d.disabled){var g=e(a.currentTarget||a.target);if(g)for(var m=0;b&&m<g.length;m++){var l=g[m];l.args[1]=a;b=d.dispatch.apply(d,l.args);l.args[1]=null}}b||jb(a);return b}},d=X(b,rb);d.enable=
function(){this.disabled=!1};d.disable=function(){this.disabled=!0};d.addElementListeners=function(a){if(this[a])if(-1!==c.indexOf(a))for(var b=0;b<this._eventElements.length;b++){var d=this._eventElements[b];d.addEventListener(a,this.onSystemEvent,!1)}else for(b=0;b<this._eventElements.length;b++)d=this._eventElements[b],x.wrap(d).on(a,this,this.onSystemEvent)};d.removeElementListeners=function(a){if(this[a])if(-1!==c.indexOf(a))for(var b=0;b<this._eventElements.length;b++)this._eventElements[b].removeEventListener(a,
this.onSystemEvent);else for(b=0;b<this._eventElements.length;b++)x.wrap(this._eventElements[b]).off(a,this,this.onSystemEvent)};d.addElement=function(a,b){if((a=x.unwrap(a))&&a.addEventListener){var d;if(-1==this._eventElements.indexOf(a))for(d in this._eventElements.push(a),this._plugins){var g=this[d];if(g.isSystemEvent()&&g.hasListeners())if(-1!==c.indexOf(d))a.addEventListener(d,this.onSystemEvent,!1);else x.wrap(a).on(d,this,this.onSystemEvent)}g={context:b,args:[x.wrap(a),null]};for(d=1;d<
arguments.length;d++)g.args.push(arguments[d]);var k=e(a);k||(k=[],x.data(a,"dispatcherData",k));var t=!1;for(d=0;d<k.length;d++)if(k[d].context===b){k[d]=g;t=!0;break}t||k.push(g)}};d.removeElement=function(a,b){a=x.unwrap(a);var d=this._eventElements.indexOf(a);if(-1!=d){var g=!0;if(void 0===b)x.removeData(a,"dispatcherData");else{var k=e(a);if(k){for(var t=0;t<k.length;t++)if(k[t].context===b){1==k.length?k=null:k.splice(t,1);break}k&&0!==k.length?g=!1:x.removeData(a,"dispatcherData")}}if(g){this._eventElements.splice(d,
1);for(var q in this._plugins)d=this[q],d.isSystemEvent()&&d.hasListeners()&&(-1!==c.indexOf(q)?a.removeEventListener(q,this.onSystemEvent):x.wrap(a).off(q,this,this.onSystemEvent))}}};d.removeAllElements=function(){for(var a=this._eventElements.length-1;0<=a;a--)this.removeElement(this._eventElements[a])};d.eventMessage=function(){if(!this._eventMessage){for(var a in this._plugins)this._eventMessage=this._eventMessage?this._eventMessage+","+a:"Must be one of ["+a;this._eventMessage&&(this._eventMessage+=
"]")}return this._eventMessage};return b}(),Xa=new pc(null,"globalEvents");Xa.extend({install:{},init:{}});var Aa=function(){return new rb(function(c){return new Sc(c)})}(),Sc=function(){var c="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
e=function(a){Wa.call(this,Aa,a)},a=X(e,Wa),b=function(a,b){a["on"+b.name]=function(a,d){b.listen(a,d)};a["off"+b.name]=function(a,d){b.unlisten(a,d)}};a.extend=function(a){this.def=a;Xa.install.listen(this,this.install);var d=a.events;a=a.userEventDef;if(d||a){this.on||(this.on=new pc(this,this.name));if(d)for(var e in d){var g=d[e],v=this.on.extend.call(this.on,e,g);b(this,v);g&&g.pub&&(this.hasPublicEvents=!0)}a&&(a.systemEvent=!0,this.on.extend.call(this.on,c,a),a.pub&&(this.hasPublicEvents=!0))}};
a.install=function(){var a=this,b=this.def;delete this.def;b.install&&b.install(this);if(a.hasPublicEvents||b.exports&&0<b.exports.length){OIT[a.name]||(hb(a.name,{}),a.publicName="OIT."+a.name);var d={};a.hasPublicEvents&&(a.addEventListener||(d.addEventListener={value:function(b,d){var c=!1,e=a.on[b];e?c=e.addPublicListener(d):a.invalidArg("addEventListener","name",b,a.on.eventMessage());return c}}),a.removeEventListener||(d.removeEventListener={value:function(b,d){var c=!1,e=a.on[b];e?c=e.removePublicListener(d):
a.invalidArg("removeEventListener","name",b,a.on.eventMessage());return c}}));if(b.exports&&0<b.exports.length)for(var c=0;c<b.exports.length;c++){var e=b.exports[c],t=a[e];void 0!==t&&(d||(d={}),d[e]={value:t})}Object.defineProperties(OIT[a.name],d)}};var d=function(a,b){if(Array.isArray(b))for(var c=0;c<b.length;c++){if(d(a,b[c]))return!0}else{if(void 0===a)return!0;switch(b){case "null":if(null===a)return!0;break;case "function":if(null===a||Pa(a))return!0;break;case "DOMRange":if(null===a||Ra(a))return!0;
break;case "DOMSelection":if(null===a||Ba(a))return!0;break;case "RegExp":if(null===a||a instanceof RegExp)return!0;break;case "string":if(null===a||"string"===typeof a)return!0;break;default:if(typeof a===b)return!0}}return!1};a.processArguments=function(a,b,c){for(var e={},g=0,t=0;g<c.length;g++){var q=c[g];e&&q.def&&(e[q.name]=q.def);if(t>=b.length)q.req&&(this.logError(a,"Argument '"+q.name+"' is required"),e=null);else{var m=b[t];if(d(m,q.type)){var l=null;q.val?l=q.val(m):q.legal&&-1==q.legal.indexOf(m)&&
(l="Must be one of "+JSON.stringify(q.legal));l?(this.invalidArg(a,q.name,m,l),e=null):e&&(e[q.name]=m);t++}else q.req&&(this.invalidArg(a,q.name,m,"Must be of type "+JSON.stringify(q.type)),t++,e=null)}}return e};return e}(),ub=function(){return new rb(function(c){return new Tc(c)})}(),Tc=function(){var c=function(a){Wa.call(this,ub,a)},e=X(c,Wa);e.extend=function(a){this.def=a;Xa.install.listen(this,this.install)};e.install=function(){var a=this.def;delete this.def;a.install&&a.install(this)};e.init=
function(a){if(a.isLoaded())this.load(a);else{var b=this;a.load(!0,function(){b.load(a)})}};e.load=function(a){};e.unload=function(){};e.visiblePages=function(){return[z.activePage()]};e.saveScrollPos=function(){};e.restoreScrollPos=function(a){};e.maxPageWidth=function(){return z.maxWidth()};e.maxPageHeight=function(){return z.maxHeight()};e.padding=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollPadding=function(){};e.margin=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollOffset=
function(){return u.viewNode.scroll()};e.startElasticScroll=function(){};e.elasticScroll=function(a,b){};e.endElasticScroll=function(a,b){};e.getSelectedText=function(){return x.selectedText()};e.select=function(a){return!1};e.keydown=function(a){return!0};e.showHidden=function(a){};e.loadRange=function(a,b){b&&b(a)};e.expandRange=function(a){return a};e.moveto=function(a,b,d){return!1};e.pageRange=function(a,b){};e.pageRect=function(a,b,d){return z.elementRect(z.page(a),b)};e.rangeRect=function(a,
b,d,c){};e.rangeFromRect=function(a,b,d,c,e,n,r){};e.extendRange=function(a,b,d,c){};e.moveAnchor=function(a,b,d,c){return!1};e.incrementSelection=function(a,b,d,c,e){return!1};e.layoutChanged=function(a){};e.update=function(a){};return c}(),Ha=function(){var c=new rb(function(c){return new Uc(c)});c.createDisplay=function(e){if(e=c.item(e))return ub.item(e.de)};c.features=function(e){if(e=c.item(e))return e.features};return c}(),Uc=function(){var c="zoom rotate showhidden pages fitpage highlights textselection rectselection rectredaction cellselection customtextselection anchorednotes elasticScroll".split(" "),
e=function(a){Wa.call(this,Ha,a)};X(e,Wa).extend=function(a){this.de=a.de;for(var b=this.features={},d=0;d<c.length;d++){var e=c[d],k=a[e];void 0===k&&(k=!0);b[e]=k}};return e}(),Za,ib,$b,db,Ja,Ga,ac,vb,fa=function(c){return"number"===typeof c},Ia=function(c){return"string"===typeof c};(function(){var c={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",
brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",
darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",
khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",
maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",
paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",
tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"rgba(0,0,0,0)"},e=1/6,a=1/3,b=2/3,d=function(a,d,c){0>c?c+=1:1<c&&--c;c<e?a+=(d-a)*c*6:.5>c?a=d:c<b&&(a+=(d-a)*(b-c)*6);return 255*a|0},g=[{property:"webkit",css:"-webkit-"},{property:"Moz",css:"-moz-"},{property:"ms",css:"-ms-"},{property:"O",css:"-o-"}],k=function(a,b,d){var c=W.documentElement;
if(Ia(c.style[a]))return b;if(!1!==d)for(a=a.charAt(0).toUpperCase()+a.slice(1),d=0;d<g.length;d++)if(Ia(c.style[g[d].property+a]))return g[d].css+b},n=function(a,b){for(var d,c=W.createElement("div"),e=0;e<b.length;e++)if(c.style[a]=b[e],c.style[a]===b[e]){d=b[e];break}return d};Za={transform:k("transform","transform"),"transform-origin":k("transformOrigin","transform-origin")};Tb=n("cursor",["grab","-webkit-grab","-moz-grab","move"]);Ub=n("cursor",["grabbing","-webkit-grabbing","-moz-grabbing",
"move"]);var r=function(a,b){if(-1!=b)for(var d=a.chars;b<d.length;b++){var c=d[b];if(" "!==c&&"\n"!==c&&"\r"!==c&&"\t"!==c){"/"===c&&"*"===d[b+1]&&(d=a.string.indexOf("*/",b+2),b=-1==d?a.string.length:d+2);break}}return b},v=function(a,b,d){return-1!=b&&a.chars[b]!==d?-1:++b};ib=function(a){var b;if(a){b={};a={string:a,chars:a.split("")};for(var d=0;-1!=d&&d<a.chars.length;){var c=a,e=d,d=b,g={},k=e=r(c,e);if(-1!=k){for(var t=c.chars,e=k;e<t.length;e++){var n=t[e];if(!("a"<=n&&"z">=n||"A"<=n&&"Z">=
n||"0"<=n&&"9">=n)&&"-"!==n&&"_"!==n)break}e>k?(g.name=c.string.substring(k,e),k=e):k=-1}e=k;e=r(c,e);e=v(c,e,":");k=e=r(c,e);if(-1!=k){t=c.chars;for(e=k;e<t.length;e++){n=t[e];if("!"===n||";"===n)break;if('"'===n||"'"===n||"("===n){"("===n&&(n=")");for(var C=e+1;C<t.length;C++){var R=t[C];if(R===n){e=C;break}else if("\\"===R){R=t[++C];if("0"<=R&&"9">=R||"a"<=R&&"f">=R||"A"<=R&&"F">=R){do R=t[++C];while("0"<=R&&"9">=R||"a"<=R&&"f">=R||"A"<=R&&"F">=R)}e=C;break}}}}e>k?(g.value=c.string.substring(k,
e),k=e):k=-1}e=k;e=r(c,e);k=g;-1!=e&&"!important"===c.string.substring(e,e+10)&&(k.important=!0,e+=10);e=r(c,e);e<c.chars.length&&(e=v(c,e,";"));-1!=e&&(d[g.name]=g.value);d=e}}return b};$b=function(a,b){var d=[];if(a)for(var c in a)a.hasOwnProperty(c)&&(b?d.push(c,":",a[c]," !important;"):d.push(c,":",a[c],";"));return d.join("")};db=function(a,b){if(a&&Ia(a)&&Ia(b)){for(var d=0;;){d=a.indexOf(b,d);if(-1===d||0===d)break;var c=a.charAt(d-1);if(";"==c||" "==c)break;d++}if(-1!=d){for(d+=b.length;" "===
a.charAt(d);)d++;if(":"===a.charAt(d)){for(d++;" "===a.charAt(d);)d++;c=a.indexOf(";",d);-1===c&&(c=a.length);for(;c>d&&" "===a.charAt(c-1);)c--;return a.substring(d,c)}}}};Ja=function(){var a=arguments;if(1==a.length){a=a[0];if(Ia(a))a=Ga(a);else if(void 0===a.r||void 0===a.g||void 0===a.b)a=void 0;if(a)return Ja(a.r,a.g,a.b,a.a)}else if(3==a.length||4==a.length){var b=P(na(a[0],0,255)),d=P(na(a[1],0,255)),c=P(na(a[2],0,255)),e=1;4==a.length&&void 0!==a[3]&&(e=na(a[3],0,1));if(1!=e)return"rgba("+
b+","+d+","+c+","+e+")";b=b.toString(16);d=d.toString(16);c=c.toString(16);2>b.length&&(b="0"+b);2>d.length&&(d="0"+d);2>c.length&&(c="0"+c);return"#"+b+d+c}};Ga=function(b){if(b){var e,m;if(0===b.indexOf("#")){if(e={r:parseInt(b.substring(1,3),16),g:parseInt(b.substring(3,5),16),b:parseInt(b.substring(5,7),16),a:1},isNaN(e.b)){m=b.substring(1,2);var l=b.substring(2,3);b=b.substring(3,4);l+=l;b+=b;e.r=parseInt(m+m,16);e.g=parseInt(l,16);e.b=parseInt(b,16)}}else if(0===b.indexOf("rgba(")||0===b.indexOf("rgb(")){e=
b.replace(/[^\d.,]/g,"").split(",");for(m=0;m<e.length;m++)e[m]=Number(e[m]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);e={r:e[0],g:e[1],b:e[2],a:e[3]}}else if(0===b.indexOf("hsla(")||0===b.indexOf("hsl(")){e=b.replace(/[^\d.,]/g,"").split(",");for(m=0;m<e.length;m++)e[m]=Number(e[m]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);m=e[0];b=e[1];l=e[2];m/=360;b/=100;l/=100;if(0===b)l=b=m=255*l|0;else{var g=.5>l?l*(1+b):l+b-l*b,k=2*l-g,l=d(k,g,m+a);b=d(k,g,m);m=d(k,g,m-a)}e={r:l,g:b,
b:m,a:e[3]}}else if(m=c[b.toLowerCase()])return Ga(m);if(e)return e.r=na(e.r,0,255),e.g=na(e.g,0,255),e.b=na(e.b,0,255),e.a=na(e.a,0,1),e}};ac=function(a,b,d,c){1<d||(d=1);var e=Ga(a);b=Ga(b);if(!e||!b)return a;var l;!0===c?(a=(e.r+b.r*d)/(1+d),c=(e.g+b.g*d)/(1+d),l=(e.b+b.b*d)/(1+d),d=(e.a+b.a*d)/(1+d)):(b.a=1-e.a,a=e.r*e.a+b.r*b.a,c=e.g*e.a+b.g*b.a,l=e.b*e.a+b.b*b.a,d=1);return Ja(a,c,l,d)};vb=function(a){if(void 0!==a&&null!==a&&""!==a){var b=Number(a);if(!isNaN(b))return b+"px";if(a.match(/(\d|\.)+(em|ex|px|in|pt|pc|mm|cm|\%)/))return a}else return null}})();
var U;OIT.local||hb("local",{ADDED_COLUMN:"Inserted Column",ADDED_ROW:"Inserted Row",ADDED_SHEET:"Added Sheet",ANNO_CHANGE_FROM:"from",ANNO_CHANGE_TO:"to",ANNOTATIONS:"Annotations",ANNOTATION_TYPE:"Annotation Type",AUTHOR_A_TO_Z:"Author A-Z",AUTHOR_Z_TO_A:"Author Z-A",CANCEL:"Cancel",CHANGED_TEXT:"Changed Text",CLEAR_CELL:"Cleared Cell",COLUMN:"Column",COMMENT:"Comment",DEL:"DEL",DELETED_COLUMN:"Deleted Column",DELETED_ROW:"Deleted Row",DELETED_TEXT:"Deleted Text",DISCARD_CHANGES:"Discard changes",
DOCUMENT_ERROR:"Error occurred, document incomplete.",HIDDEN_SLIDE:"This slide is hidden in presentation mode",HIDDEN_TEXT:"Hidden Text",INSERTED_TEXT:"Inserted Text",LABEL_SEPARATOR:":",LOADING:"Loading",LOCATION:"Location",MODIFIED_CELL:"Modified Cell",MOVED_CELLS:"Moved Cells",NEW_CELL:"New Cell",NEWEST_FIRST:"Newest first",NO:"No",NO_SUBJECT:"(No Subject)",NOTES:"Notes",OK:"OK",OLDEST_FIRST:"Oldest first",PAGE_DOWN:"Next Page",PAGE_UP:"Previous Page",PLEASE_WAIT:"Please wait",PLEASE_WAIT_CONVERTING:"Document conversion in progress...",
PLEASE_WAIT_DOWNLOADING:"Loading document, please wait",PLEASE_WAIT_INITIALIZING:"Please wait while your<br>document is loaded...",PREPARING_TO_PRINT:"Preparing to print...",RENAMED_SHEET:"Renamed Sheet",ROW:"Row",SAVE_CHANGES:"Save changes",SHOWDETAILS:"Show Details",SORT_BY:"Sort by: ",HIDEDETAILS:"Hide Details",UNKNOWN_FIELD:"[Unknown Field]",UNSUPPORTED_CONTENT:"(Unsupported Content)",YES:"Yes",HIDDEN_CONTENT_HIDDEN:"Hidden content (Not Visible)",HIDDEN_CONTENT_PARTIAL:"Hidden content (Partially Visible)",
HIDDEN_CONTENT_VISIBLE:"Hidden content (Visible)",HIDDEN_CONTENT_NOTIFICATION:"This document contains hidden information:",HIDDEN_CONTENT_INVISIBLE:"These items are not currently visible in the viewer.",HIDDEN_CONTENT_SHOWLINK:"Show these items",HIDDEN_CONTENT_ALREADY_VISIBLE:"These items are already visible in the viewer.",HIDDEN_CONTENT_ORIGINAL_APPLICATION:"This document contains information that cannot be displayed in the browser. Open the document in the native application to view the full document content:",
HIDDEN_CONTENT_HIDELINK:"Hide these items",HIDDEN_CONTENT_ANNOTATIONS:"Annotations",HIDDEN_CONTENT_PAGES:"Hidden pages",HIDDEN_CONTENT_COLUMNS:"Hidden columns",HIDDEN_CONTENT_ROWS:"Hidden rows",HIDDEN_CONTENT_COMMENTS:"Comments",HIDDEN_CONTENT_SPEAKER_NOTES:"Speaker Notes",HIDDEN_CONTENT_SLIDES:"Hidden slides",HIDDEN_CONTENT_TEXT:"Hidden text",HIDDEN_CONTENT_TRACKED_CHANGES:"Tracked changes",HIDDEN_CONTENT_LARGE_SHEET:"The worksheet is larger than the browser can display",DOCUMENT_ERRORS:"Document Errors",
DOCUMENT_EXCEPTION_NOTIFICATION:"Errors were encountered while processing this document:",DOCEX_MISSING_MAP:"Some text could not be mapped to displayable characters",DOCEX_VERTICAL_TEXT:"Vertical text was present, but could not be displayed correctly",DOCEX_TEXT_EFFECTS:"Some text had unsupported text effects applied",DOCEX_UNSUPPORTED_COMPRESSION:"An embedded graphic used an unsupported compression",DOCEX_UNSUPPORTED_COLOR_SPACE:"An embedded graphic used an unsupported color space",DOCEX_FORMS:"Forms were present but could not be displayed correctly",
DOCEX_RIGHT_TO_LEFT_TABLES:"A table had right to left columns",DOCEX_ALIASED_FONT:"A required font was missing, but a font alias was used",DOCEX_MISSING_FONT:"A required font was not present on the system",DOCEX_SUBDOC_FAILED:"Part of the document could not be converted",DOCEX_TYPE_THREE_FONT:"An unsupported font was required by the document",DOCEX_UNSUPPORTED_SHADING:"The document used an unsupported shading type",DOCEX_INVALID_HTML:"Invalid HTML was encountered",DOCEX_VECTOR_OBJECT_LIMIT:"Not all of the vector objects could be displayed",
DOCEX_INVALID_ANNOTATIONS_NOT_APPLIED:"An invalid annotation could not be applied",DOCEX_INLINE_IMAGE_FOUND:"An embedded graphic could not be rendered",EMAIL_TO:"To",EMAIL_CC:"CC",EMAIL_BCC:"BCC",EMAIL_SUBJECT:"Subject",EMAIL_MSGFLAG:"Message Flag",EMAIL_FLAGSTS:"Flag Status",EMAIL_EXPIRES:"Expires",EMAIL_CATEGORIES:"Categories",EMAIL_IMPORTANCE:"Importance",EMAIL_SENSITIVITY:"Sensitivity",EMAIL_LOCATION:"Location",EMAIL_FULLNAME:"Full Name",EMAIL_JOBTITLE:"Job Title",EMAIL_COMPANY:"Company",EMAIL_EMAIL:"Email",
EMAIL_WEBPAGE:"Webpage",EMAIL_WORKPHONE:"Work Telephone",EMAIL_HOMEPHONE:"Telephone",EMAIL_FROM:"From",EMAIL_ATTACHMENT:"Attachments",EMAIL_RTFBODY:"RTF Embedded Body",EMAIL_RECEIVED:"Received",EMAIL_SIZE:"Size",EMAIL_LASTMODIFIED:"Last Modified",EMAIL_NEWSGROUPS:"Newsgroups",EMAIL_SUBMITTIME:"Submit Time",EMAIL_CCME:"CC Me",EMAIL_ALTERNATE_RECIPIENT_ALLOWED:"Alternate Recipient Allowed",EMAIL_CLIENT_SUBMIT_TIME:"Sent",EMAIL_CREATION_TIME:"Created",EMAIL_CONVERSATION_INDEX:"Conversation Index",EMAIL_CONVERSATION_TOPIC:"Topic",
EMAIL_MESSAGE_SUBMISSION_ID:"Message Submission ID",EMAIL_MESSAGE_CLASS:"Message Class",EMAIL_ORIGINATOR_DELIVERY_REPORT_REQUESTED:"Originator Delivery Report Requested",EMAIL_READ_RECEIPT_REQUESTED:"Read Receipt Requested",EMAIL_RCVD_REPRESENTING_ADDRTYPE:"Received Representing Address Type",EMAIL_RCVD_REPRESENTING_EMAIL_ADDRESS:"Received Representing Email",EMAIL_RCVD_REPRESENTING_ENTRYID:"Received Representing Entry ID",EMAIL_RCVD_REPRESENTING_NAME:"Received Representing Name",EMAIL_RCVD_REPRESENTING_SEARCH_KEY:"Received Representing Search Key",
EMAIL_RECEIVED_BY_ADDRTYPE:"Received By Address Type",EMAIL_RECEIVED_BY_EMAIL_ADDRESS:"Received By Email",EMAIL_RECEIVED_BY_ENTRYID:"Received By Entry ID",EMAIL_RECEIVED_BY_NAME:"Received By Name",EMAIL_RECEIVED_BY_SEARCH_KEY:"Received By Search Key",EMAIL_RTF_IN_SYNC:"RTF In Sync",EMAIL_RTF_SYNC_BODY_COUNT:"RTF Sync Body Count",EMAIL_RTF_SYNC_BODY_CRC:"RTF Sync Body CRC",EMAIL_RTF_SYNC_BODY_TAG:"RTF Sync Body Tag",EMAIL_RTF_SYNC_PREFIX_COUNT:"RTF Sync Prefix Count",EMAIL_RTF_SYNC_TRAILING_COUNT:"RTF Sync Trailing Count",
EMAIL_SEARCH_KEY:"Search Key",EMAIL_SENDER_ADDRTYPE:"Sender Address",EMAIL_SENDER_EMAIL_ADDRESS:"Sender Email",EMAIL_SENDER_ENTRYID:"Sender Entry ID",EMAIL_SENDER_NAME:"Sender Name",EMAIL_SENDER_SEARCH_KEY:"Sender Search Key",EMAIL_SENT_REPRESENTING_ADDRTYPE:"Sent Representing Addr Type",EMAIL_SENT_REPRESENTING_EMAIL_ADDRESS:"Sent Representing Email",EMAIL_SENT_REPRESENTING_ENTRYID:"Sent Representing Entry ID",EMAIL_SENT_REPRESENTING_SEARCH_KEY:"Sent Representing Search Key",EMAIL_TRANSPORT_MESSAGE_HEADERS:"Transport Message Headers",
EMAIL_PRIORITY:"Priority",EMAIL_AUTO_FORWARDED:"Auto Forwarded",EMAIL_DEFERRED_DELIVERY_TIME:"Deferred Delivery Type",EMAIL_EXPIRY_TIME:"Expiry Time",EMAIL_LATEST_DELIVERY_TIME:"Latest Delivery Time",EMAIL_RECIPIENT_REASSIGNMENT_PROHIBITED:"Recipient Reassignment Prohibited",EMAIL_REPLY_TIME:"Reply Time",EMAIL_REPORT_TAG:"Report Tag",EMAIL_RESPONSE_REQUESTED:"Response Requested",EMAIL_REPLY_REQUESTED:"Reply Requested",EMAIL_DELETE_AFTER_SUBMIT:"Delete After Submit",EMAIL_MESSAGE_LOCALE_ID:"Message Locale ID",
EMAIL_CREATOR_NAME:"Creator Name",EMAIL_CREATOR_ENTRYID:"Creator Entry ID",EMAIL_LAST_MODIFIER_NAME:"Last Modifier Name",EMAIL_LAST_MODIFIER_ENTRYID:"Last Modifier Entry ID",EMAIL_INTERNET_ARTICLE_NUMBER:"Internet Artical Number",EMAIL_NT_SECURITY_DESCRIPTOR:"NT Security Descriptor",EMAIL_TRUST_SENDER:"Trust Sender",EMAIL_INTERNET_MESSAGE_ID:"Internet Message ID",EMAIL_ATTR_HIDDEN:"Hidden",EMAIL_ATTR_SYSTEM:"System",EMAIL_ATTR_READONLY:"Read Only",EMAIL_INTERNET_CPID:"Internet CPID",EMAIL_MESSAGE_CODEPAGE:"Message Codepage",
EMAIL_SENDER_FLAGS:"Sender Flags",EMAIL_SENT_REPRESENTING_FLAGS:"Sent Representing Flags",EMAIL_RCVD_BY_FLAGS:"Recived By Flags",EMAIL_RCVD_REPRESENTING_FLAGS:"Received Representing Flags",EMAIL_INET_MAIL_OVERRIDE_FORMAT:"Internet Mail Override Format",EMAIL_MSG_EDITOR_FORMAT:"MSG Editor Format",EMAIL_PROFILE_CONNECT_FLAGS:"Profile Connect Flags",EMAIL_SENT_REPRESENTING_NAME:"Sent Representing Name",EMAIL_ENTRYID:"Entry ID",EMAIL_NORMALIZED_SUBJECT:"Normalized Subject",EMAIL_ATTENDEES:"Attendees",
EMAIL_REQATTENDEE:"Required Attendees",EMAIL_OPTATTENDEE:"Optional Attendees",EMAIL_FILEAS:"File as",EMAIL_DISPLAYAS:"Display As (E-mail)",EMAIL_TITLE:"Title",EMAIL_SUFFIX:"Suffix",EMAIL_NICKNAME:"Nickname",EMAIL_PROFESSION:"Profession",EMAIL_DEPARTMENT:"Department",EMAIL_OFFICE:"Office",EMAIL_ANNIVERSARY:"Anniversary",EMAIL_BIRTHDATE:"Birth date",EMAIL_ASSISTANTSNAME:"Assistant's Name",EMAIL_SPOUSESNAME:"Spouse's Name",EMAIL_MANAGERSNAME:"Manager's Name",EMAIL_BUSINESSADDRESS:"Business Address",
EMAIL_BUSINESSPHONE:"Telephone",EMAIL_HOMEADDRESS:"Home Address",EMAIL_OTHERADDRESS:"Other Address",EMAIL_MOBILEPHONE:"Mobile",EMAIL_BUSINESSFAX:"Fax",EMAIL_IMADDRESS:"IM",EMAIL_INTERNETFREEBUSYADDR:"Internet Free Busy Address",EMAIL_REMINDERTOPIC:"Reminder Topic",EMAIL_CONTACTS:"Contacts",EMAIL_CALLBACKPHONE:"Callback Telephone",EMAIL_FIRST:"First",EMAIL_FAMILY:"Last",EMAIL_TELENUMBER:"Telephone",EMAIL_BUSINESSPHONE2:"Telephone 2",EMAIL_RADIOPHONE:"Radio Telephone",EMAIL_CARPHONE:"Car Telephone",
EMAIL_OTHERPHONE:"Telephone",EMAIL_PAGERPHONE:"Pager",EMAIL_OTHERFAX:"Fax",EMAIL_HOMEFAX:"Fax",EMAIL_TELEXPHONE:"Telex Telephone",EMAIL_ISDN:"ISDN Telephone",EMAIL_ASSISTANTPHONE:"Assistant Telephone",EMAIL_HOMEPHONE2:"Telephone 2",EMAIL_MIDDLE:"Middle",EMAIL_TTYTTDPHONE:"TTY/TTD Telephone",EMAIL_GENDER:"Gender",EMAIL_PERSONALHOMEPAGE:"Personal Home Page",EMAIL_COMPANYPHONE:"Company Telephone",EMAIL_HOMECITY:"City",EMAIL_HOMECOUNTRY:"Country",EMAIL_POSTALCODE:"Postal Code",EMAIL_HOMESTATE:"State",
EMAIL_HOMESTREET:"Street",EMAIL_HOMEPOBOX:"PO Box",EMAIL_OTHERCITY:"City",EMAIL_OTHERCOUNTRY:"Country",EMAIL_OTHERPOSTALCODE:"Postal Code",EMAIL_OTHERSTATE:"State",EMAIL_OTHERSTREET:"Street",EMAIL_OTHERPOBOX:"PO Box",EMAIL_BUSINESSSTREET:"Street",EMAIL_BUSINESSCITY:"City",EMAIL_BUSINESSSTATE:"State",EMAIL_BUSINESSPOSTALCODE:"Postal Code",EMAIL_BUSINESSCOUNTRY:"Country",EMAIL_BUSINESSPOBOX:"PO Box",EMAIL_DISPLAYAS2:"Display As (E-mail 2)",EMAIL_EMAIL2:"Email 2",EMAIL_DISPLAYAS3:"Display As (E-mail 3)",
EMAIL_EMAIL3:"Email 3",EMAIL_DTSTART:"Start Time",EMAIL_DTEND:"End Time",EMAIL_START:"Start",EMAIL_DURATION:"Duration",EMAIL_ACCUREATTYPE1:"Accurate Type 1",EMAIL_ENTRY_TYPE:"Entry Type",EMAIL_STATUS:"Status",EMAIL_PERCENT_COMPLETE:"Percent Complete",EMAIL_START_DATE:"Start Date",EMAIL_DUE_DATE:"Due Date",EMAIL_COMPLETED:"Completed",EMAIL_ACTUALWORK:"Actual Work",EMAIL_TOTAL_WORK:"Total Work",EMAIL_OWNER:"Owner",EMAIL_BILLING:"Billing",EMAIL_MILEAGE:"Mileage",EMAIL_PROOF_OF_DELIVERY_REQUESTED:"Proof of Delivery Requested",
EMAIL_PROOF_OF_SUBMISSION_REQUESTED:"Proof of Submission Requested",EMAIL_IN_REPLY_TO_ID:"In Reply To ID",EMAIL_TASK_COMPLETE:"Task Complete",EMAIL_APPOINTMENT_DURATION:"Appointment Duration",EMAIL_RECURRENCE_TYPE:"Recurrence Type",EMAIL_RECURRENCE_RANGE:"Recurrence Range",EMAIL_ORGANIZER:"Organizer",EMAIL_CALENDAR_EXCEPTION:"Calendar Exceptions",EMAIL_RSVP:"RSVP",EMAIL_ROLE:"Role",EMAIL_ATTENDEE:"Attendee",EMAIL_ADDRESS:"Address",EMAIL_POBOX:"PO Box",EMAIL_EXTADDRESS:"Ext Address",EMAIL_STREET:"Street",
EMAIL_CITY:"City",EMAIL_REGION:"Region",EMAIL_COUNTRY:"Country",EMAIL_TYPE:"Type",EMAIL_NAME:"Name",EMAIL_LOGO:"Logo",EMAIL_PHOTO:"Photo",EMAIL_ALARM:"Alarm",EMAIL_DESCRIPTION:"Description",EMAIL_DATE:"Date"});U=OIT.local;var ab,eb,jc=598,Vb=599;(function(){var c=[],e=Date.now(),a=function(a){return bb(c,"request",a)},b=function(b){var d=a(this);if(!d)throw"request.start(): Invalid request object";if(!d.aborted){if(void 0!==this.status)throw"request.start(): Request is already completed";if("number"!==
typeof b||0>b)throw"request.start(): fileSize must be a non-negative integer indicating the total size of the requested file in bytes";if(void 0!==d.contentLength)throw"request.start(): start should only be called once per request";d.contentLength=b;q(d,"")}},d=function(b){var d=a(this);if(!d)throw"request.loading(): Invalid request object";if(!d.aborted){if(void 0!==this.status)throw"request.loading(): Request is already completed";if("string"!==typeof b)throw"request.loading(): responseText must be a string containing the partial or complete contents of the requested file";
if(void 0!==this.contentLength&&b.length>this.contentLength)throw"request.loading(): responseText length must not exceed the size specified to request.start";d.responseText=b;void 0!==d.contentLength&&q(d,b)}},g=function(b){var d=a(this);if(!d)throw"request.done(): Invalid request object";if(!d.aborted){if("number"!==typeof b||0>=b)throw"request.done(): status must be a positive integer HTTP status code";if(0===b)d.timeout=!0;else if(200===b){if(void 0===d.responseText)throw"request.done(): request.loading() was never called";
if(void 0!==d.contentLength&&d.responseText.length!==d.contentLength)throw"request.done(): responseText length must be equal to the contentLength passed in to request.start()";}Object.defineProperty(this,"status",{value:b});d.contentLength=d.responseText.length;Object.defineProperty(this,"responseText",{value:d.responseText});Ka(c,d);t(d)}},k=function(){var b=a(this);if(!b)throw"request.abort(): Invalid request object";b.aborted=!0;t(b)},n=function(a,e){var l={};Object.defineProperties(l,{url:{value:a},
start:{value:b},loading:{value:d},done:{value:g},abort:{value:k}});e.request=l;e.isLocal=!0;c.push(e);return l},r=function(a){a.inDispatch=!0;E.on.ajax.dispatch(a.request);a.inDispatch=!1},v=function(a,b){var d=a[b];if(d){var c=Array.prototype.slice.call(arguments,2);a.args&&(c=c.concat(a.args));d.apply(a.context,c)}},t=function(a){var b="unknown"!=typeof a.request.responseText?a.request.responseText:void 0,d=a.request.status;0===d||a.aborted?(d=jc,a.aborted=!0,E.on.ajax.hasListeners()&&E.on.ajaxabort.hasListeners()&&
E.on.ajaxabort.dispatch(this)):a.timeout&&(d=Vb);a.contentLength=b.length;200===d?v(a,"success",a.url,a.contentLength,b,d):v(a,"error",a.url,a.contentLength,b,d);v(a,"complete",a.url,a.contentLength,b,d)},q=function(a,b){v(a,"loading",a.url,a.contentLength,b)};ab=function(a){var b=a.url,d;if("string"===typeof b&&0<b.length){var g={context:null},l;for(l in a)g[l]=a[l];if(E.on.ajax.hasListeners())n(b,g),da(r,0,null,g),d=g;else if(S.XMLHttpRequest){g.request=new XMLHttpRequest;!1===a.cache&&(b=-1!=b.indexOf("?")?
b+"&":b+"?",++e,b+="_="+e);g.request.onreadystatechange=function(){if(!g.aborted)switch(g.request.readyState){case 2:g.contentLength=Number(g.request.getResponseHeader("Content-Length"));q(g,"");break;case 3:q(g,"unknown"!=typeof g.request.responseText?g.request.responseText:void 0);break;case 4:t(g),Ka(c,g)}};g.request.ontimeout=function(){g.timeout=!0;t(g)};u.withCredentials&&(g.request.withCredentials=!0);g.request.open("GET",b,!0);if(a=u.httpHeaders)for(var m in a)a.hasOwnProperty(m)&&g.request.setRequestHeader(m,
a[m]);g.request.send();c.push(g);d=g}}return d};var m=function(a){a.aborted=!0;a.request&&a.request.abort()};eb=function(a){a?(Ka(c,a),m(a)):(aa(c,m),c=[])}})();var P=function(c,e){return e&&1<e?Math.round(c*e)/e:Math.floor(0>c?c-.5:c+.5)},na=function(c,e,a){c<e?c=e:c>a&&(c=a);return c},Wb=function(c,e,a,b){if(c==a&&e==b)return 0;c=a-c;e=b-e;return P(Math.sqrt(c*c+e*e))},Xb=function(c,e){if("deg"===e)c%=360,0>c&&(c+=360);else{var a=Math.PI,b=2*a;c%=b;c<-a?c+=b:c>a&&(c-=b)}return c},bc=function(c,
e,a){void 0===a&&(a=1.01);return(c>e?Math.abs(c/e):Math.abs(e/c))<=a},cc,wb,Qa,da,ta,qb,Yb;(function(){for(var c=[],e=[],a=[],b=S.requestAnimationFrame,d=S.cancelAnimationFrame,g=0,k=["ms","moz","webkit","o"],n=0;n<k.length&&!b;++n)b=S[k[n]+"RequestAnimationFrame"],d=S[k[n]+"CancelAnimationFrame"]||S[k[n]+"CancelRequestAnimationFrame"];b||(b=function(a){var b=(new Date).getTime(),d=Math.max(0,16-(b-g)),c=S.setTimeout(function(){a(b+d)},d);g=b+d;return c});d||(d=function(a){S.clearTimeout(a)});cc=
function(){var b;for(b=0;b<c.length;b++)S.clearInterval(c[b].id);c=[];for(b=0;b<e.length;b++)S.clearTimeout(e[b].id);e=[];for(b=0;b<a.length;b++)d.call(S,a[b].id);a=[]};var r=function(a,b,d,c){var e=0;c={fn:a[e++],remove:!!c};b&&(c.timeout=a[e++]);c.context=a[e++];d&&(c.args=[0],c.ts=!0);a.length>e&&(a=Array.prototype.slice.call(a,e),c.args=c.args?c.args.concat(a):a);return c},v=function(a,b,d){try{a.remove&&Ka(b,a),a.ts&&(a.args[0]=d),a.fn.apply(a.context,a.args)}catch(l){S.OILogDebugError&&S.OILogDebugError("Error in asynchronous timer function: "+
l.message)}};wb=function(a,b,d){var e=r(arguments,!0,!1,!1);c.push(e);e.id=S.setInterval(function(){v(e,c)},e.timeout);return e.id};Qa=function(a){S.clearInterval(a);xb(c,"id",a)};da=function(a,b,d){var c=r(arguments,!0,!1,!0);e.push(c);c.id=S.setTimeout(function(){v(c,e)},b);return c.id};ta=function(a){S.clearTimeout(a);xb(e,"id",a)};qb=function(d,c){for(var e,g=0;g<a.length;g++)if(e=a[g],e.fn===d&&e.context===c)return e.id;e=r(arguments,!1,!0,!0);a.push(e);e.id=b.call(S,function(b){v(e,a,b)});return e.id};
Yb=function(b){d.call(S,b);xb(a,"id",b)};Xa.install.listen(function(){E.onreset(function(){cc();c=[];e=[];a=[]})})})();var La,jb,Ib,Ma,Ya,Pa,Ra,Ba,qc,Sa,Ua,aa,yb,rc,$a,sc,tc,Ka,xb,bb,dc,Gb,zb,uc,vc,Jb,wc,fb,xc,yc,zc,nc,oc;(function(){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,a=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/,
b=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,d=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,k=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},r=Math.pow(2,53),v="oit-emhdrvalue oit-emhdrlabel oit-emhdrsection oit-email oit-rt oit-sn oit-comment-text oit-comment-date oit-comment-author oit-anno-text oit-anno-date oit-anno-author oit-overlay".split(" ");La=function(a){for(a=x.unwrap(a);a&&!x.isElement(a);)a=a.parentNode;var b;a&&(a=x.wrap(a),b=a.hasClass(v)?a:a.ancestorByClass(v));return b?b:null};jb=function(a){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()};
Ib=function(a,b,d){var c=a.indexOf(":");if(0<c){var e=Ib(a.slice(0,c),b,d);a=Ib(a.slice(c+1),b,d);e.c2=a.c1;e.r2=a.r1;return e}var e=!1,c=0,g=!1,m=0,l=0,f=a.length,h=a.charCodeAt(l);l<f&&36==h&&(e=!0,l++,h=a.charCodeAt(l));for(!1===(l<f&&65<=h&&90>=h)&&(g=e);l<f&&65<=h&&90>=h;)c=26*c+(h-65+1),l++,h=a.charCodeAt(l);l<f&&36==h&&(g=!0,l++,h=a.charCodeAt(l));for(;l<f&&48<=h&&57>=h;)m=10*m+(h-48),l++,h=a.charCodeAt(l);0<c&&c--;0<m&&m--;!e&&b&&(c+=b);!g&&d&&(m+=d);return sa(c,m,c,m)};Ma=function(a){if("number"==
typeof a&&!(0>a)){if(26>a)return c[a];var b=a%26,d=(a-b)/26-1;if(702>a)return c[d]+c[b];a=Math.floor(d);d=a%26;return c[(a-d)/26-1]+c[d]+c[b]}};Ya=function(a){if("number"==typeof a&&!(0>a))return(a+1).toString()};Pa=function(a){return"[object Function]"==Object.prototype.toString.call(a)};Ra=function(a){return a&&void 0!==a.startContainer&&void 0!==a.startOffset&&void 0!==a.endContainer&&void 0!==a.endOffset?!0:!1};Ba=function(a){return a&&void 0!==a.anchorNode&&void 0!==a.anchorOffset&&void 0!==
a.focusNode&&void 0!==a.focusOffset?!0:!1};qc=function(a){return!/^(?:[a-z]+:)?\/\//i.test(a)};Sa=function(a,b){return a&&0!==a.length?b&&0!==b.length?"/"==a.charAt(a.length-1)?"/"==b.charAt(0)?a+b.substr(1):a+b:"/"==b.charAt(0)?a+b:a+"/"+b:a:b};Ua=function(a){var b;if(Array.isArray(a)){b=[];for(var d=0;d<a.length;d++)b[d]=Ua(a[d])}else{if(Pa(a))return null;if(null===a)b=null;else switch(typeof a){case "object":b={};for(d in a)a.hasOwnProperty(d)&&!Pa(a[d])&&(b[d]=Ua(a[d]));break;case "string":b=
new String(a);break;case "number":case "boolean":case "undefined":b=a}}return b};aa=function(a,b,d){t(!1,!1,null,arguments)};yb=function(a,b){t(!1,!1,a,b)};rc=function(a,b,d){t(!1,!0,null,arguments)};$a=function(a,b,d){t(!0,!1,null,arguments)};sc=function(a,b){t(!0,!1,a,b)};var t=function(a,b,d,c){var e=0;d||(d=c[e++]);if(d&&(a||0<d.length)){var g,l=c[e++],k=c[e++],f="string"==typeof l;f||e--;c=c.length>e?Array.prototype.slice.call(c,e):void 0;f?e=m:(e=q,c||(c=[null]));if(a)for(g in d)d.hasOwnProperty(g)&&
e(d[g],l,k,c);else if(b?(g=d.length-1,b=a=-1):(g=0,a=d.length,b=1),d.item)for(;g!=a;g+=b)e(d.item(g),l,k,c);else for(;g!=a;g+=b)e(d[g],l,k,c)}},q=function(a,b,d,c){null===a||void 0===a||null!==d&&void 0!==d&&!a.filter(d)||(c[0]=a,b.apply(null,c))},m=function(a,b,d,c){a&&(null===d||void 0===d||a.filter(d))&&a[b].apply(a,c)};tc=function(a,b,d){if(a===b)return!0;if(null===a||void 0===a)return null===b||void 0===b;if(null===b||void 0===b||"[object Array]"!==Object.prototype.toString.call(a)||"[object Array]"!==
Object.prototype.toString.call(b)||a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])if(!0===d){if(JSON.stringify(a[c])!==JSON.stringify(b[c]))return!1}else return!1;return!0};Ka=function(a,b){var d=a.indexOf(b);-1!=d&&a.splice(d,1)};xb=function(a,b,d){b=dc(a,b,d);-1!=b&&a.splice(b,1)};bb=function(a,b,d){b=dc(a,b,d);if(-1!=b)return a[b]};dc=function(a,b,d){if(Array.isArray(a)&&"string"===typeof b)for(var c=0;c<a.length;c++){var e=a[c];if(e&&e[b]===d)return c}return-1};Gb=function(a){return Ra(a)?
"[DOM Range]":Ba(a)?"[DOM Selection]":x.isElement(a)?x.unwrap(a).outerHTML:x.isText(a)?'"'+a.textContent+'"':JSON.stringify(a)};zb=function(a){a&&(a=a.replace(/[&<>"']/g,function(a){return n[a]}));return a};var l;a:{try{(new Date).toLocaleDateString("i")}catch(K){l="RangeError"===K.name;break a}l=!1}uc=function(b){if(l&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleDateString()}catch(M){}return b};vc=function(b){if(l&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleTimeString()}catch(M){}return b};
Jb=function(b){if(l&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleString()}catch(M){}return b};wc=function(a){1073741824<a?(a=Math.floor(a/1073741824*10)/10,a=""+a+" GB"):1048576<a?(a=Math.floor(a/1048576*10)/10,a=""+a+" MB"):1024<a?(a=Math.floor(a/1024*10)/10,a=""+a+" KB"):a=""+Math.floor(a)+" B";return a};fb=function(){if(u.isMobileOrTablet){var a=z.activePage();if(a){var b=x.create("div");a.append(b);da(function(){b.destroy()},10)}}};xc=function(a){for(var b=a.css("width"),d=1,c=r;d<c;){var e=
Math.ceil((d+c)/2);a.css("width",e+"px");a.clientWidth!=e?c=e-1:d=e}a.css("width",b);return d};yc=function(a){for(var b=a.css("height"),d=1,c=r;d<c;){var e=Math.ceil((d+c)/2);a.css("height",e+"px");a.clientHeight!=e?c=e-1:d=e}a.css("height",b);return d};zc=function(a){var b=!1;switch(a){case "firefox":b=-1!=navigator.userAgent.toLowerCase().indexOf("firefox")}return b};nc=function(){var a=!1,c=navigator.userAgent||navigator.vendor||S.opera;if(b.test(c)||d.test(c.substr(0,4)))a=!0;return a};oc=function(){var a=
!1,b=navigator.userAgent||navigator.vendor||S.opera;if(g.test(b)||k.test(b.substr(0,4)))a=!0;return a}})();var Vc=function(){function c(){}function e(){console.log(Array.prototype.slice.call(arguments).join(" "))}var a={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},b={icate:"ic",ative:"",alize:"al",
iciti:"ic",ical:"ic",ful:"",ness:""};return function(d,g){var k,n,r,v,t,q;q=g?e:c;if(3>d.length)return d;r=d.substr(0,1);"y"==r&&(d=r.toUpperCase()+d.substr(1));v=/^(.+?)(ss|i)es$/;n=/^(.+?)([^s])s$/;v.test(d)?(d=d.replace(v,"$1$2"),q("1a",v,d)):n.test(d)&&(d=d.replace(n,"$1$2"),q("1a",n,d));v=/^(.+?)eed$/;n=/^(.+?)(ed|ing)$/;v.test(d)?(n=v.exec(d),v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,v.test(n[1])&&(v=/.$/,d=d.replace(v,""),q("1b",v,d))):n.test(d)&&(n=n.exec(d),k=n[1],n=/^([^aeiou][^aeiouy]*)?[aeiouy]/,
n.test(k)&&(d=k,q("1b",n,d),n=/(at|bl|iz)$/,t=/([^aeiouylsz])\1$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,n.test(d)?(d+="e",q("1b",n,d)):t.test(d)?(v=/.$/,d=d.replace(v,""),q("1b",t,d)):k.test(d)&&(d+="e",q("1b",k,d))));v=/^(.*[aeiouy].*)y$/;v.test(d)&&(n=v.exec(d),k=n[1],d=k+"i",q("1c",v,d));v=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;v.test(d)&&(n=v.exec(d),k=n[1],n=n[2],v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
v.test(k)&&(d=k+a[n],q("2",v,d)));v=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;v.test(d)&&(n=v.exec(d),k=n[1],n=n[2],v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,v.test(k)&&(d=k+b[n],q("3",v,d)));v=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;n=/^(.+?)(s|t)(ion)$/;v.test(d)?(n=v.exec(d),k=n[1],v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,v.test(k)&&(d=k,q("4",v,d))):n.test(d)&&(n=n.exec(d),
k=n[1]+n[2],n=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,n.test(k)&&(d=k,q("4",n,d)));v=/^(.+?)e$/;v.test(d)&&(n=v.exec(d),k=n[1],v=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,n=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,t=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,v.test(k)||n.test(k)&&!t.test(k))&&(d=k,q("5",v,n,t,d));v=/ll$/;n=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;
v.test(d)&&n.test(d)&&(v=/.$/,d=d.replace(v,""),q("5",v,n,d));"y"==r&&(d=r.toLowerCase()+d.substr(1));return d}}(),Ac={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u1ea4":"A","\u1eae":"A","\u1eb2":"A","\u1eb4":"A","\u1eb6":"A","\u1ea6":"A","\u1eb0":"A","\u0202":"A","\u00c7":"C","\u1e08":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u1ebe":"E","\u1e16":"E","\u1ec0":"E","\u1e14":"E","\u1e1c":"E","\u0206":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I",
"\u1e2e":"I","\u020a":"I","\u00d0":"D","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u1ed0":"O","\u1e4c":"O","\u1e52":"O","\u020e":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u1ea5":"a","\u1eaf":"a","\u1eb3":"a","\u1eb5":"a","\u1eb7":"a","\u1ea7":"a","\u1eb1":"a","\u0203":"a","\u00e7":"c","\u1e09":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e",
"\u1ebf":"e","\u1e17":"e","\u1ec1":"e","\u1e15":"e","\u1e1d":"e","\u0207":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u1e2f":"i","\u020b":"i","\u00f0":"d","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u1ed1":"o","\u1e4d":"o","\u1e53":"o","\u020f":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00ff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C",
"\u0109":"c","\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0110":"D","\u0111":"d","\u0112":"E","\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u01f4":"G","\u011d":"g","\u01f5":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H","\u0125":"h","\u0126":"H","\u0127":"h","\u1e2a":"H","\u1e2b":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i",
"\u012c":"I","\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u1e30":"K","\u1e31":"k","\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u013f":"L","\u0140":"l","\u0141":"l","\u0142":"l","\u1e3e":"M","\u1e3f":"m","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0149":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0154":"R","\u0155":"r",
"\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","\u0212":"R","\u0213":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s","\u015e":"S","\u0218":"S","\u0219":"s","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u021b":"t","\u021a":"T","\u0164":"T","\u0165":"t","\u0166":"T","\u0167":"t","\u0168":"U","\u0169":"u","\u016a":"U","\u016b":"u","\u016c":"U","\u016d":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0216":"U","\u0217":"u","\u0174":"W",
"\u0175":"w","\u1e82":"W","\u1e83":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u017f":"s","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U","\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u","\u01d9":"U","\u01da":"u","\u01db":"U","\u01dc":"u","\u1ee8":"U","\u1ee9":"u","\u1e78":"U","\u1e79":"u","\u01fa":"A",
"\u01fb":"a","\u01fe":"O","\u01ff":"o","\u1e54":"P","\u1e55":"p","\u1e64":"S","\u1e65":"s","\u0403":"\u0413","\u0453":"\u0433","\u040c":"\u041a","\u045c":"\u043a","\u1ed2":"O","\u1ed3":"o","\u1e50":"O","\u1e51":"o","\u1eea":"U","\u1eeb":"u","\u1e80":"W","\u1e81":"w","\u1ef2":"Y","\u1ef3":"y","\u0200":"A","\u0201":"a","\u0204":"E","\u0205":"e","\u0208":"I","\u0209":"i","\u020c":"O","\u020d":"o","\u0210":"R","\u0211":"r","\u0214":"U","\u0215":"u","\u01e6":"G","\u01e7":"g","\u021e":"H","\u021f":"h",
"\u01e8":"K","\u01e9":"k","\u1e66":"S","\u1e67":"s","\u1e10":"D","\u1e11":"d","\u0228":"E","\u0229":"e","\u1e28":"H","\u1e29":"h"},Wc=Object.keys(Ac).join("|"),Xc=new RegExp(Wc,"g"),ec=function(c){return c.replace(Xc,function(c){return Ac[c]})},Bc=function(){var c=[{rule:/(\S{3})(\S*)(ies)$/,replace:"y"},{rule:/(\S{3})(\S*)(ing)$/,replace:""},{rule:/(\S{4})(\S*)(ness)$/,replace:""},{rule:/(\S{0})(\S*)(ss)$/,replace:"ss"},{rule:/(\S{3})(\S*)(s)$/,replace:""},{rule:/(\S{4})(\S*)(ion)$/,replace:""},
{rule:/(\S{4})(\S*)(ism)$/,replace:""},{rule:/(\S{4})(\S*)(ly)$/,replace:""},{rule:/(\S{3})(\S*)(eed)$/,replace:"ee"},{rule:/(\S{4})(\S*)(ied)$/,replace:"y"},{rule:/(\S{4})(\S*)(ed)$/,replace:""},{rule:/(\S{3})(\S*)(ed)$/,replace:"e"},{rule:/(\S{4})(\S*)(er)$/,replace:""},{rule:/(\S{4})(\S*)(ful)$/,replace:""},{rule:/(\S{4})(\S*)(able)$/,replace:""},{rule:/(\S{4})(\S*)(ible)$/,replace:""},{rule:/(\S{3})(\S*)(v)$/,replace:"f"},{rule:/(\S{4})(\S*)(e)$/,replace:""},{rule:/(\S{3})(\S*)(dd)$/,replace:"d"},
{rule:/(\S{3})(\S*)(gg)$/,replace:"g"},{rule:/(\S{3})(\S*)(ll)$/,replace:"l"},{rule:/(\S{3})(\S*)(mm)$/,replace:"m"},{rule:/(\S{3})(\S*)(nn)$/,replace:"n"},{rule:/(\S{3})(\S*)(pp)$/,replace:"p"},{rule:/(\S{3})(\S*)(rr)$/,replace:"r"},{rule:/(\S{3})(\S*)(ss)$/,replace:"s"},{rule:/(\S{3})(\S*)(tt)$/,replace:"t"}];return function(e,a){for(var b=0,d=e;b<c.length;){var g=c[b].rule.exec(d);if(g)if(rStem=g[1]+g[2]+c[b].replace,rStem===d)break;else b=0,d=rStem;else b++}return d}}(),Cc=Aa.extend("fonts",{events:{fontload:{}},
install:function(c){var e=["serif","sans-serif","monospace","cursive","fantasy"],a={},b=0,d;c.loadWebFont=function(c){var e=a[c];if(void 0===e){var k=u.rootNode;if(k){e=x.create("div","oit-fontpreloader");e.css("font-family",c);var v=x.create("span");e.append(v);v.html("AEIMNOTaeimnot130");k.append(e);a[c]=e}b=0;d||(d=da(g,250))}};var g=function(){var k=!1,n=!1,r,v;d=void 0;for(r in a)if((v=a[r])&&!0!==v){for(var t=!0,q,m=0;m<e.length;m++){v.css("font-family",r+","+e[m]);var l=v.offsetWidth;if(0<
m&&l!=q){t=!1;break}q=l}t?(v.destroy(),n=a[r]=!0):(v.css("font-family",r),k=!0)}if(k)if(b++,20>b)d=da(g,250);else for(r in a)(v=a[r])&&!0!==v&&(v.destroy(),a[r]=!1);n?c.on.fontload.dispatch():0===b%2&&c.on.fontload.dispatch()};E.onreset(function(){for(var c in a){var e=a[c];e&&!0!==e&&e.destroy()}a=[];b=0;d=void 0})}}),ka=Aa.extend("view",{exports:"attach detach fitToContainer height info stage load unload width hasFeature".split(" "),events:{resize:{delay:80},detach:{},update:{}},install:function(c){var e,
a=0,b,d,g,k,n={},r,v=0,t=0,q,m,l,K,M,I,H;c.hasFeature=function(a){var b=!1;switch(a){case "string":case "dtsearch":case "lucene":case "phsterms":case "literal":case "literal*":case "enhancedhighlight":b=!0}return b};var O=function(){r&&(r.hide(),r=null)};c.dispatchResize=function(){var a=u.viewNode;a&&(g&&C(),b!=a.clientWidth||d!=a.clientHeight)&&(b=a.clientWidth,d=a.clientHeight,c.on.resize.dispatch())};var C=function(){if(g){var a=g.computedStyle(),b=g.offsetWidth-parseInt(a.borderLeftWidth,10)-
parseInt(a.borderRightWidth,10),a=g.offsetHeight-parseInt(a.borderTopWidth,10)-parseInt(a.borderBottomWidth,10);u.rootNode.css({width:b+"px",height:a+"px"})}};c.dispatchScroll=function(a){var b=u.viewNode;if(b&&(c.invalidateCanvas(),E.on.scrollupdate.dispatch(),b=b.scroll(),a||b.left!=t||b.top!=v)){a=b.left-t;var d=b.top-v;t=b.left;v=b.top;E.on.scroll.dispatch(a,b.left,d,b.top)}};var R=function(){},A=function(){},f=function(){w.nochrome?u.viewNode.addClass("oit-nochrome"):u.viewNode.removeClass("oit-nochrome")},
h=function(){var b=u.rootNode;b&&(b.addClass("oit-view-root"),b=u.viewNode,b||(b=x.attach(x.create("div","oit-view")),u.viewNode=b),e="oitview"+a++,b.id=e,f(),b.attr("tabindex","-1"),b.onscroll(c.dispatchScroll),c.fitToContainer());S.matchMedia&&(b=S.matchMedia("print"))&&b.addListener(function(a){});S.addEventListener("beforeprint",R);S.addEventListener("afterprint",A);S.addEventListener("resize",c.dispatchResize)};Xa.init.listen(function(){var a=u.rootNode;if(a){var b=a.data("json"),d=a.data("icd"),
c=a.data("page");if(b||d)k=a.parent();h();ha.initializeContent(b,d,c);E.initializeDocument()}});c.attach=function(a){a&&a!==x.unwrap(g)&&(c.detach(),g=x.wrap(a),a=u.rootNode,a||(a=u.rootNode=x.attach(x.create("div"))),a.addClass("oit-view-embedded"),g.append(a),h())};c.detach=function(){E.unload();u.viewNode&&(u.viewNode.offscroll(c.dispatchScroll),u.viewNode.removeData("_events"),x.detach(u.viewNode));u.rootNode&&x.detach(u.rootNode);x.reset();c.on.detach.dispatch();var a=u.viewNode;if(a)try{a.destroy()}catch(N){}if(a=
u.rootNode)try{a.destroy()}catch(N){}S.removeEventListener("beforeprint",R);S.removeEventListener("afterprint",A);S.removeEventListener("resize",c.dispatchResize);u.rootNode=u.viewNode=null;e=g=k=void 0};c.stage=function(a){u.staging=!0;c.load(a)};var B=function(a){c.logAJAXError("load","Timed out waiting for document to load",a)};c.load=function(a,b){g||k?void 0===a?u.staging&&(u.staging=!1,E.showNotifications()):(c.unload(),u.dynamicContent=!0,u.documentLoading=!0,b&&(b.headers&&(u.httpHeaders=
b.headers),b.withCredentials&&(u.withCredentials=!0)),m&&ta(m),m=da(B,3E4,null,a),ab({url:a,loading:y,success:L,error:ca}),r=ua.createProgressDialog(U.PLEASE_WAIT)):c.logError("load","Call OIT.view.attach before OIT.view.load")};var y=function(a,b,d){m&&ta(m);m=da(B,3E4,null,a);a=d?d.length:0;r&&r.update(80*a/b)},L=function(a,b,d,e){b=!0;m&&(ta(m),m=void 0);try{0===d.length?(c.logAJAXError("load","The document is empty or is still being exported",a,e,d),b=!1):b=E.installDocument(a,d)}catch(D){c.logAJAXError("load",
"The document could not be installed ("+D.message+")",a,e,d),b=!1}b||O()},ca=function(a,b,d,e){m&&(ta(m),m=void 0);c.logAJAXError("load","Failed to load the document index file from the server",a,e,d);O()};c.unload=function(){E.unload();u.httpHeaders=null;u.withCredentials=!1;x.reset()};c.fitToContainer=function(){g&&(C(),c.dispatchResize())};c.width=function(a){a=vb(a);null!==a&&(g&&g.css("width",a),u.rootNode.css("width",a),c.dispatchResize());return u.rootNode.offsetWidth};c.height=function(a){a=
vb(a);null!==a&&(g&&g.css("height",a),u.rootNode.css("height",a),c.dispatchResize());return u.rootNode.offsetHeight};c.info=function(){var a=Ua(n);a.libversion=u.libversion?Ua(u.libversion):"Unknown";var b=ha.manifest();b&&(a.manifest=Ua(b));return a};c.infoRaw=function(){return n};c.showDocumentError=function(a){q||(q=new Dc({title:U.DOCUMENT_ERRORS,closeButton:!0,className:"oit-toast-error"}));q.message(a);q.expand(!1)};var Y=function(){var a=u.rootNode,b=a.clientWidth,d=a.clientHeight,e;l=void 0;
I&&(K!=b||M!=d?(I.destroy(),I=null):(e=I.getContext("2d"),e.clearRect(0,0,b,d)));I||(H||(H=x.create("div","oit-viewcanvas"),a.insertFirst(H)),K=b,M=d,I=H.createCanvas());e||(e=I.getContext("2d"));c.on.update.dispatch(e)};c.invalidateCanvas=function(){!l&&c.on.update.hasListeners()&&(l=qb(Y,this))};u.onviewNode(function(a,b){b&&b.destroy();if(a){for(var d=u.rootNode,c=d.childByClass("oit-toolframe");c;){c=c.childByClass("oit-toolcontent");if(!c)break;d=c;c=d.childByClass("oit-toolframe")}d&&d.append(a)}});
E.onreset(function(){O();q&&(q.destroy(),q=null);I&&(I.destroy(),I=null);H&&(H.destroy(),H=null);l&&(Yb(l),l=void 0);M=K=-1;d=b=void 0;n={};t=v=0});ha.ondata(function(a,b,d){if(a.info){n||(n={});for(var c in a.info)n[c]=a.info[c];n.fi||(n.fi=1999);n.fistring||(n.fistring="Unknown");n.product||(n.product="Outside In Technology");n.version||(n.version="Unknown")}b&&O()});w.onnochrome(f)}}),ua=Aa.extend("dialog",{install:function(c){var e=[],a=null,b=!1,d,g=!1;c.createProgressDialog=function(a,b){var d=
{dialog:null,text:null,ticks:null,spinner:null,percentDone:0,active:!1,suppressed:!1,message:a,showTicks:b,display:n,update:r,hide:t};e.push(d);S.performance&&S.performance.now?(d.startTime=performance.now(),d.interval=wb(k,200,d)):d.display();return d};var k=function(){var a=performance.now()-this.startTime;0<this.percentDone?(a=100*a/this.percentDone,a=1E3<=a):a=500<=a;a&&(Qa(this.interval),this.display())},n=function(){var a=e.indexOf(this);if(!this.active&&0===a&&!this.dialog)if(this.active=!0,
E.on.showmessage.dispatch(this.message,!0,this.showTicks)){this.suppressed=!1;c.showModalOverlay(!0,200);if(a=u.rootNode){this.dialog=x.create("div","oit-dialog oit-progress-dialog");this.text=x.create("div","oit-dialog-text");this.ticks=x.create("div","oit-progress-dialog-ticks");for(var b=0;20>b;b++)this.ticks.append(x.create("div"));this.spinner=x.create("div","oit-pending oit-progress-dialog-ticks");this.dialog.append(this.text,this.ticks,this.spinner);a.append(this.dialog)}!1===this.showTicks?
(this.ticks.css("display",null),this.spinner.css("display","block")):(this.spinner.css("display",null),this.ticks.css("display","block"));this.tickCount=void 0;this.update(this.percentDone);this.text.html(this.message);this.dialog.css({opacity:0,display:"block"});this.dialog.abortAnimation();this.dialog.animate({opacity:1,time:200,startCSS:{display:"block"}})}else this.suppressed=!0},r=function(a){"number"===typeof a&&(0>a?a=0:100<a&&(a=100),this.percentDone=a,this.active&&(E.on.progress.dispatch(a),
this.dialog&&(a=Math.floor(21*a/100),20<a&&(a=20),a!=this.tickCount&&(this.tickCount=a,this.ticks.forChildElements(v,a)))))},v=function(a,b,d){b<d?a.addClass("filled"):a.removeClass("filled")},t=function(){var a=this;a.interval&&(Qa(a.interval),a.interval=void 0);a.active&&E.on.hidemessage.dispatch();a.dialog&&(a.dialog.abortAnimation(),a.dialog.animate({opacity:0,endCSS:{display:"none"},endFn:function(){a.dialog.destroy();a.dialog=null},time:200}),c.showModalOverlay(!1,200));Ka(e,a)};c.showModalOverlay=
function(a,b){b=b||200;var c=g;if(a){if(!d){var e=u.rootNode;e&&(d=x.create("div","oit-screen"),e.append(d))}d&&!g&&(g=!0,d.abortAnimation(),d.animate({opacity:.5,time:b,startCSS:{opacity:0,display:"block"}}))}else g&&(g=!1,d.abortAnimation(),d.animate({opacity:0,time:b,endCSS:{display:null}}));g!=c&&(c=z.activeOverlay())&&c.updateCSS()};c.modalOverlayVisible=function(){return g};c.showMessage=function(d){b&&c.hideMessage();if(E.on.showmessage.dispatch(d,!1,!1)){if(!a){var e=u.rootNode;e&&(a=x.create("div",
"oit-background-message"),e.append(a))}a&&(b||(a.abortAnimation(),a.animate({opacity:.8,time:200,startCSS:{opacity:0,display:"block"}})),a.html(d))}b=!0};c.hideMessage=function(){b&&(E.on.hidemessage.dispatch(),a&&(a.abortAnimation(),a.animate({opacity:0,time:200,endCSS:{display:null}})),b=!1)};c.messageVisible=function(){return b};E.onreset(function(){for(;0<e.length;)e[e.length-1].hide();a&&a.destroy();d&&d.destroy();a=null;b=!1;d=null;g=!1})}}),Ec=function(){function c(a){if(-1===a.indexOf("*"))return!1;
for(var b=0;b<a.length;b++)if("*"!==a.charAt(b))return!1;return!0}function e(a,b,d){this.value=a;this.type=b;this.subtype=d}function a(){this.items=[];this.add=function(a,b,d){d||(d="");a=new e(a,b,d);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=
function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function b(a,b){this.regEx=b;this.type=a}function d(b,c){for(var e=new a,f=b.slice(0);f;){for(var D=0;D<c.length;D++){var g=f.match(c[D].regEx);if(g){var h=c[D].type;if("LUCENE_WITHIN"===h){var l,h=e,m=/\"(.*)\"~(\d+)/.exec(g[0]);if(m){var B=d(m[1],t);if(B&&B.items&&B.items.length){var k=0,y=0;
for(l=0;l<B.items.length;l++){var n=B.items[l];"OPEN_PAREN"===n.type?y++:"CLOSE_PAREN"===n.type&&y--;if(0===y){k=l+1;break}}for(l=0;l<k;l++)h.addRef(B.items[l]);l=Number(m[2]);isNaN(l)||l++;h.add("WI"+l,"WITHIN",0);for(l=k;l<B.items.length;l++)h.addRef(B.items[l])}}}else"CONNECTOR_TILDE"===h?e.add(g[0].substring(0,g[0].length-1),"WORD",0):e.add(g[0],h,0);f=f.slice(g[0].length);break}}D==c.length&&(f=f.slice(1))}return e}function g(a,b,d){a.push("(");!1===d&&a.push("?:");a.push(b);a.push(")")}function k(a,
b,d,c,e){a.push("(");!1===c&&a.push("?:");n(a,b,d,e);a.push(")")}function n(a,b,d,c){var e;e=b.replace(/([\^\$\+\.\|\(\)\{\}\[\]\\])/g,"\\$1");w.normalizeAccentsForSearch&&(e=ec(e));e=e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]");e=e.replace(/[\u0022\u201C\u201D\u030B\u030F]/g,"[\\u0022\\u201C\\u201D\\u030B\\u030F]");e=e.replace(/\s+/g,"\\s+");if(d)d=e.replace(/\?/g,"[\\u003F]"),d=d.replace(/\*/g,"[\\u002A]");else if(d=e.replace(/\?/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]"),
d=d.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),"dtsearch"===c.searchType)if(d=d.replace(/=/g,"[=\\d]"),c.stemAll||"~"===d.substring(d.length-1))b=0,"~"===d.substring(d.length-1)&&(b=1),d=d.substring(0,d.length-b).toLowerCase(),d=c.stemmerFunction(d),c.stems.push(d),d+="\ue000*";else{if(c.fuzzies&&0<=d.indexOf("%")&&(b=d.indexOf("%"),0<=b)){var f=d.lastIndexOf("%")-b+1;d=d.replace(/%/g,"");d=
d.toLowerCase();c.fuzzies.push({searchTerm:d,minMatch:b,maxDistance:f});0<b&&b--;d=d.slice(0,b)+"\ue001+";e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]")}}else if(c.fuzzies&&"lucene"===c.searchType&&0<=d.indexOf("~")){b=0;f=1;e=d.lastIndexOf("~");if(e+1<d.length){var p=Number(d.slice(e+1,d.length));isNaN(p)||(f=p)}d=d.slice(0,e);d=d.toLowerCase();c.fuzzies.push({searchTerm:d,minMatch:b,maxDistance:f});d=d.slice(0,b)+"\ue001+"}a.push(d)}var r="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",
v=[new b("NUMERICAL_PATTERN",/^(=[=\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]*)/),new b("CONNECTOR_TILDE",/^(\bNOT~(?=\s|$)|\bnot~(?=\s|\)|$))/),new b("CONNECTOR_TILDE",/^(\bAND~(?=\s|$)|\band~(?=\s|\)|$))/),new b("CONNECTOR_TILDE",/^(\bOR~(?=\s|$)|\bor~(?=\s|\)|$))/),new b("NOT_WITHIN",/^(\bNOT\b|\bnot\b)\s+(\bw\/|\bW\/|\bw \/|\bW \/)/),new b("AND_NOT",/^(\bAND\b|\band\b)\s+(\bNOT\b|\bnot\b)/),new b("OR_NOT",/^(\bOR\b|\bor\b)\s+(\bNOT\b|\bnot\b)/),new b("AND",/^(\bAND\b|\band\b)/),new b("OR",/^(\bOR\b|\bor\b)/),
new b("NOT",/^(\bNOT\b|\bnot\b)/),new b("AndAny",/^(\bAndAny\b|\bandany\b)/),new b("XFIRSTWORD",/^(\bxfirstword\b)/),new b("XLASTWORD",/^(\bxlastword\b)/),new b("DATE",/^\b[dD][aA][tT][eE]\(\s*\**\s*\)/),new b("DATE_WITH_PARAM",/^\b[dD][aA][tT][eE]\([^\)]*\)/),new b("MAIL",/^\b[mM][aA][iI][lL]\(\s*\**\s*\)/),new b("MAIL_WITH_PARAM",/^\b[mM][aA][iI][lL]\([^\)]*\)/),new b("CREDITCARD",/^\b[cC][rR][eE][dD][iI][tT][cC][aA][rR][dD]\(\s*\**\s*\)/),new b("CREDITCARD_WITH_PARAM",/^\b[cC][rR][eE][dD][iI][tT][cC][aA][rR][dD]\([^\)]*\)/),
new b("VISA_CREDIT_CARD_REGEX",/^\bvisacreditcard\(\)/),new b("WITHIN",/^(\bw\/|\bW\/|\bw \/|\bW \/|\bWI\d+|\bwi\d+)/),new b("PRE",/^(\bpre\/|\bPRE\/|\bpre \/|\bPRE \/)/),new b("OPEN_PAREN",/^\(/),new b("CLOSE_PAREN",/^\)/),new b("DTSEARCH_REGULAREXPRESSION",/^\"##[^\"]*\"/),new b("WHITESPACE",/^\s+/),new b("PHRASE",/^"[^"]*"/),new b("WORD",/^[^\s)]+/)],t=[new b("AND",/^(\bAND\b|\s*\u0026\u0026\s*|\s*\u002B\s*)/),new b("OR",/^(\bOR\b|\s*\u007C\u007C\s*)/),new b("NOT",/^(\bNOT\b|\s*\u0021\s*|\s*\u002D\s*)/),
new b("LUCENE_WITHIN",/^\"[^\"]*\"~\d+/),new b("OPEN_PAREN",/^\(/),new b("CLOSE_PAREN",/^\)/),new b("LUCENE_REGULAREXPRESSION",/^\/[^\/]*\//),new b("WHITESPACE",/^\s+/),new b("PHRASE",/^"[^"]*"/),new b("WORD",/^[^\s)]+/)],q="(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",r="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",q=
"(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",m=function(a,b,d){var c,e=null;a.lastHit=pa(d,d+b[0].length);var f=b.length;for(c=1;c<b.length;c++)void 0===b[c]&&f--;if(0<f){e={range:a.lastHit,terms:[]};for(f=1;f<b.length;f++)if(b[f]){var g=b[f],h=a.modifier;"\ue010"===g?c="\ue010+":(c=!!g.match(r),g=g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),
c=c?["(",g,")"].join(""):["(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))(",g,")",q].join(""));c=new RegExp(c,h);for(h=null;g=c.exec(b[0]);){h||(h=g);if(0===g.index)break;if(g.index+g[0].length>=b[0].length){h=g;break}}if(h){g=h[0];c=h.index;if(h[1]){var l=h[0].indexOf(h[1]);-1!=l&&(g=h[1],c+=l)}var l=d+c,m=l+g.length,B=!1;for(c=0;c<
e.terms.length;c++){var k=e.terms[c];if(k.range.acc<m&&l<k.range.accend){l<k.range.acc&&(k.range.acc=l);m>k.range.accend&&(k.range.accend=m);B=!0;break}}!B&&(c=pa(l,m),e.terms.push({term:g,range:c}),h=h.index+h[0].length-1,0===a.nextOffset||a.nextOffset>h)&&(a.nextOffset=h)}}if(0===e.terms.length)e=null;else{b=e.terms[0].range;d=e.terms[0].range;e.range=ga(e.terms[0].range);for(c=1;c<e.terms.length;c++)f=e.terms[c].range,f.acc<e.range.acc&&(e.range.acc=f.acc),f.accend>e.range.accend&&(e.range.accend=
f.accend),f.acc<b.acc&&(b=f),f.accend>d.accend&&(d=f);a.lastHit=pa(b.acc,b.accend);e.lastTermACC=d.acc}}return e},l=function(a,b){var d=b.minMatch,c=b.searchTerm,e=b.maxDistance;if(a.length<d||c.length<d)return null;for(var f=0;f<d;f++)if(c.charAt(f)!==a.charAt(f))return null;for(var g=0,h=f,l,m,B,k,y=0;c.length-y>f&&a.length-y>f&&c.charAt(c.length-1-y)===a.charAt(a.length-1-y);)y++;for(var n=a.slice(0,a.length-y),q=c.slice(0,c.length-y);f<q.length;)if(l=q.charAt(f),c=h<n.length?n.charAt(h):0,f++,
h++,l!==c){g++;if(g>e)return null;m=f<q.length?q.charAt(f):0;B=h<n.length?n.charAt(h):0;l===B?(l=f+1<q.length?q.charAt(f+1):0,k=h+1<n.length?n.charAt(h+1):0,m===c&&l===k?(f++,h++):m===c&&l===B?f++:m===k?h++:m===B?(f++,h++):m===c?(f++,h++):(f>=q.length||y)&&h++):m===c?(l=f+1<q.length?q.charAt(f+1):0,h+1<n.length&&n.charAt(h+1),l===B?f++:m===B?(f++,h++):f++):m===B&&(f++,h++)}n.length>h&&(g+=n.length-h);if(g>e)return null;0<d&&d--;e=a.slice(0,d);for(h=d;h<a.length;h++)e+="\ue001";return e},K=new RegExp("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))((?:([1-2][0-9]{3})(?:[[/\\-,\\u0020]+))?(?:(1[0-2]|0?[1-9]|january|jan(?:\\.)?|february|feb(?:\\.)?|march|mar(?:\\.)?|april|apr(?:\\.)?|may|june|jun(?:\\.)?|july|jul(?:\\.)?|august|aug(?:\\.)?|september|sept(?:\\.)?|sep(?:\\.)?|october|oct(?:\\.)?|november|nov(?:\\.)?|december|dec(?:\\.)?)(?:[ \\t]+(?:of|the)[ \\t]+|[/\\-\\u0020]+)((?:3[01]|[12][0-9]|0?[1-9])(?:(?:st|th|rd|nd)?)|(?:(?:thirty[\\- \\t]?)?(?:first|one))|(?:(?:twenty[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:teen)?(?:th)?|seven(?:teen)?(?:th)?|eighth|eight(?:een(?:th)?)?|ninth|nine(?:teen)?(?:th)?))|(?:thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))|((?:3[01]|[12][0-9]|0?[1-9])(?:(?:st|th|rd|nd)?)|(?:(?:thirty[\\- \\t]?)?(?:first|one))|(?:(?:twenty[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:teen)?(?:th)?|seven(?:teen)?(?:th)?|eighth|eight(?:een(?:th)?)?|ninth|nine(?:teen)?(?:th)?))|(?:thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))(?:[ \\t]+(?:of|the)[ \\t]+|[/\\-\\u0020]+)(1[0-2]|0?[1-9]|january|jan(?:\\.)?|february|feb(?:\\.)?|march|mar(?:\\.)?|april|apr(?:\\.)?|may|june|jun(?:\\.)?|july|jul(?:\\.)?|august|aug(?:\\.)?|september|sept(?:\\.)?|sep(?:\\.)?|october|oct(?:\\.)?|november|nov(?:\\.)?|december|dec(?:\\.)?))(?:(?:[ \\t\\-,/]+)(?:((?:[0-9]{2})?[0-9]{2})|((?:(?:(?:(?:(?:twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety)[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:ty)?(?:teen)?(?:th)?|seven(?:ty)?(?:teen)?(?:th)?|eight(?:y)?(?:een)?(?:h)?|ninth|nine(?:ty)?(?:teen)?(?:th)?))|(?:forty|fifty|sixty|seventy|eighty|ninety|thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))(?:[\\-\\u0020]?(?:hundred|thousand)?(?:and| )*)){1,3})))?)"+
q,"ig"),M=/(\w+)/ig,I=function(a){var b=parseInt(a,10);2==a.length&&(b=50>a?b+2E3:b+1900);return b},H="jan feb mar apr may jun jul aug sep oct nov dec".split(" "),O=function(a){if("0"<=a.charAt(0)&&"9">=a.charAt(0))return parseInt(a);if(2<a.length)return a=a.slice(0,3),a=a.toLowerCase(),H.indexOf(a)+1},C="thousandth hundredth twentieth thirtieth fortieth fiftieth sixtieth seventieth eightieth ninetieth".split(" "),R="thousand hundred twenty thirty forty fifty sixty seventy eighty ninety".split(" "),
A="zero one two three four five six seven eight nine".split(" "),f="ten eleven twelve thirteen fourteen fifteen sixteen seventeen eighteen nineteen".split(" "),h="zeroth first second third fourth fifth sixth seventh eighth ninth tenth eleventh twelfth thirteenth fourteenth fifteenth sixteenth seventeenth eighteenth nineteenth".split(" "),B=["st","th","rd","nd"],y=function(a,b){for(var d=0;d<b.length;d++)if(0===a.indexOf(b[d]))return d;return-1},L=function(a){result=0;var b,d=0;for(a=a.toLowerCase();a;)if("0"<=
a.charAt(0)&&"9">=a.charAt(0)){for(b=1;b<a.length&&!("0">a.charAt(0)||"9"<a.charAt(0));b++);result=parseInt(a.slice(0,b));a=a.slice(b)}else b=y(a,C),0<=b?a=a.slice(C[b].length):(b=y(a,R),0<=b&&(a=a.slice(R[b].length))),0<=b?0==b?(0<d?result-=d:d=1,result+=1E3*d,d=0):1==b?(0<d?result-=d:d=1,result+=100*d,d=0):(result===d&&0<d&&100>d&&(result*=100),d=10*b,result+=d):(b=y(a,h),0<=b?(d=b,result+=b,a=a.slice(h[b].length)):(b=y(a,f),0<=b?(result===d&&0<d&&100>d&&(result*=100),d=b+10,result+=d,a=a.slice(f[b].length)):
(b=y(a,A),0<=b?(d=b,result+=b,a=a.slice(A[b].length)):(b=y(a,B),a=0<=b?a.slice(B[b].length):a.slice(1)))));return result},ca=function(a,b,d,c,e,f,g,h){a=0;b?a=1E4*I(b):g?a=1E4*I(g):h&&(a=1E4*L(h));d&&c?(a+=100*O(d),a+=L(c)):f&&e?(a+=100*O(f),a+=L(e)):a=0;if(1E7>a||2901E4<=a)a=null;return a},u=function(a,b){function d(a,d,c,e){d=d.toLowerCase();if(b.stems)for(e=0;e<b.stems.length;e++)if(d.charAt(0)==b.stems[e].charAt(0)&&(c=b.stemmerFunction(d),c===b.stems[e])){for(a=c.length;a<d.length;a++)c+="\ue000";
return c}if(b.fuzzies)for(e=0;e<b.fuzzies.length;e++)if(c=l(d,b.fuzzies[e]))return c;return a}function c(a,d,c,e,f,p,g,h,l,m,B){if(b.dates)for(c=ca(d,c,e,f,p,g,h,l),i=0;i<b.dates.length;i++)if(c>=b.dates[i].startDate&&c<=b.dates[i].endDate){c="";for(e=0;e<a.length-d.length;e++)c+=a.charAt(e);d=a.length;if(f=a.match(/( and)+$/))d=f.index;for(;e<d;e++)c+="\ue010";for(;e<a.length;e++)c+=a.charAt(e);return c}return a}if(a){if(b.fuzzies&&0<b.fuzzies.length||b.stems&&0<b.stems.length)a=a.replace(M,d);b.dates&&
0<b.dates.length&&(a=a.replace(K,c))}return a};return{findStart:function(a,b,e,f,h,l,m){e=!1===e?"ig":"g";f={type:a,reverse:"up"===f,hits:[],hitIndex:0,lastHit:null,modifier:e,stemAll:!!l,stemmer:m};"number"==typeof h&&(f.startACC=h);if("string"==typeof b)if("dtsearch"===a||"lucene"===a){if(c(b))e=null;else{var p="\\S*(?:\\s+\\S+)",D=!1;h=!1;b.match(r)&&(p="(?:\\s*\\S)",D=!0);b="lucene"===a?d(b,t):d(b,v);var B=null;b&&(B=b.items);var y=[];b={searchType:a,stems:[],fuzzies:[],dates:[],stemAll:f.stemAll,
stemmerFunction:f.stemmer};f.stemmer&&("dtsearch"===f.stemmer?b.stemmerFunction=Bc:"porter"===f.stemmer&&(b.stemmerFunction=Vc));b.stemmerFunction||"dtsearch"!==a||(b.stemmerFunction=Bc);var ja=[],Z=0;m=l=!1;for(var M=!0,L,G,H,I=0;I<B.length;I++)if(G=B[I],0<Z)"OPEN_PAREN"===G.type?Z++:"CLOSE_PAREN"===G.type?(Z--,1===Z&&Z--):1===Z&&"WHITESPACE"!==G.type&&Z--;else{L=!1;if("WORD"===G.type){L=G.value.match(r);y.push("(");y.push("?:");L||y.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))");
y.push("(");!1===M&&y.push("?:");n(y,G.value,!1,b);for(I++;I<B.length;I++)if("WHITESPACE"===B[I].type&&I+1<B.length&&"WORD"===B[I+1].type)"lucene"===a?y.push("|"):y.push("\\s+");else if("WORD"===B[I].type)n(y,B[I].value,!1,b);else{I--;break}y.push(")");L||y.push(q);y.push(")");L=!0}else if("PHRASE"===G.type)L=G.value.match(r),y.push("("),y.push("?:"),L||y.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"),
k(y,G.value.substring(1,G.value.length-1),!0,M,b),L||y.push(q),y.push(")"),L=!0;else if("WHITESPACE"!==G.type)if("WITHIN"===G.type){if(I+1<B.length)if("WI"===G.value.substring(0,2)||"wi"===G.value.substring(0,2))G=Number(G.value.slice(2,G.value.length)),isNaN(G)||(ja.push(y.length),0<G&&G--,G=p+"{0,"+G+"}",D&&(G+="\\s*"),y.push(G));else if("WORD"===B[I+1].type)if(G=Number(B[I+1].value),!isNaN(G))I++,ja.push(y.length),0<G&&G--,G=p+"{0,"+G+"}",D&&(G+="\\s*"),y.push(G);else if("S"===B[I+1].value||"s"===
B[I+1].value)I++,ja.push(y.length),y.push("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)");else if("P"===B[I+1].value||"p"===B[I+1].value)I++,ja.push(y.length),y.push("(?:[^\\u000a\\u000d]*)")}else if("NOT_WITHIN"===G.type)I+1<B.length&&"WORD"===B[I+1].type&&(G=Number(B[I+1].value),isNaN(G)||(I++,ja.push(y.length),M=!1,0<G&&G--,G="(?!("+p+"{0,"+G+"})",D&&(G+="\\s*"),y.push(G)));else if("PRE"===G.type)I+1<B.length&&"WORD"===B[I+1].type&&(G=Number(B[I+1].value),isNaN(G)||(I++,0<G&&G--,G=p+"{0,"+
G+"}",D&&(G+="\\s*"),y.push(G)));else if("MAIL"===G.type)g(y,'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))(@)((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',M),L=!0;else if("MAIL_WITH_PARAM"===G.type)G=G.value.substring(5,G.value.length-1),G=G.replace(/\s+$/,""),1<G.length&&(k(y,G,!1,M,b),L=!0);else if("CREDITCARD"===G.type)g(y,"(?:\\d[ -]*?){13,16}",M),L=!0;else if("CREDITCARD_WITH_PARAM"===G.type)G=G.value.substring(11,G.value.length-
1),G=G.replace(/\s+$/,""),1<G.length&&(k(y,G,!1,M,b),L=!0);else if("VISA_CREDIT_CARD_REGEX"===G.type)g(y,"(4[0-9]{12}(?:[0-9]{3})?)|(4[0-9]{3}-[0-9]{4}-[0-9]{4}-[0-9](?:[0-9]{3})?)",M),L=!0;else if("DATE"===G.type)b.dates.push({startDate:1E7,endDate:2901E4}),y.push("(\ue010+)"),L=!0;else if("DATE_WITH_PARAM"===G.type){var N=G.value.substring(5,G.value.length-1);if(L=K.exec(N))G=L=ca(L[1],L[2],L[3],L[4],L[5],L[6],L[7],L[8]),(N=K.exec(N))&&(G=ca(N[1],N[2],N[3],N[4],N[5],N[6],N[7],N[8])),L&&G&&(L>G&&
(N=L,L=G,G=N),b.dates.push({startDate:L,endDate:G})),y.push("(\ue010+)");L=!0}else"AND"===G.type?y.push("|"):"OR"===G.type?y.push("|"):"NOT"===G.type?Z=1:"AND_NOT"===G.type?Z=1:"OR_NOT"===G.type?Z=1:"AndAny"===G.type?y.push("|"):"XFIRSTWORD"===G.type?(y.push("("),y.push("?:"),y.push("^\\s*"),y.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),y.push(")"),l=L=!0):"XLASTWORD"===G.type?(y.push("("),y.push("?:"),
y.push("\\s*"),y.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),y.push("\\s*$"),y.push(")"),m=L=!0):"DTSEARCH_REGULAREXPRESSION"===G.type?(y.push("("),y.push(G.value.substring(3,G.value.length-1)),y.push(")"),L=!0):"LUCENE_REGULAREXPRESSION"===G.type?(y.push("("),y.push(G.value.substring(1,G.value.length-1)),y.push(")"),L=!0):"OPEN_PAREN"===G.type?(y.push("("),y.push("?:")):"CLOSE_PAREN"===G.type?(y.push(")"),
L=!0):"NUMERICAL_PATTERN"===G.type&&(y.push("("),y.push("?:"),y.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]))"),y.push("("),!1===M&&y.push("?:"),L=y,G=G.value.replace(/([\^\(\)\[\]])/g,"\\$1"),G=G.replace(/\s+$/,""),G=G.replace(/[\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]+/g,"[\\u0020!@,:;<>\\$\\+\\-\\.\\\\\\/\\^\\{\\|\\}\\(\\)\\*\\?#~\\u2012\\u2013\\u2014\\uFE58\\uFF0D]+"),
G=G.replace(/=/g,"[=\\d]"),L.push("[\\(]?"+G),y.push(")"),y.push(q),y.push(")"),L=!0);if(0<ja.length&&L){N=ja[ja.length-1];H=0;G=N-1;for(var J=N+1;J<y.length;J++)"("===y[J]?H++:")"===y[J]&&H--;if(0===H&&")"==y[G])for(;0<=G&&(")"===y[G]?H++:"("===y[G]&&H--,0!==H);G--);L=y[N];if(0===H&&"(?!("===L.substring(0,4))y.push(")");else if(0===H){h=!0;y.push(")");y.push("|");y.push("(");y.push("?:");for(var C=[],M=N+1;M<J;M++)if(y.push(y[M]),"^\\s*"===y[M])for(C.push("^\\s*"),H=G;H<N;H++)C.push(y[H]);else if("\\s*$"===
y[M]){for(H=G;H<N;H++)C.push(y[H]);C.push("\\s*$")}y.push(y[N]);for(M=G;M<N;M++)if(y.push(y[M]),"^\\s*"===y[M])for(C.push("^\\s*"),H=N+1;H<J;H++)C.push(y[H]);else if("\\s*$"===y[M]){for(H=N+1;H<J;H++)C.push(y[H]);C.push("\\s*$")}y.push(")");if(C.length)for(y.push("|"),H=0;H<C.length;H++)y.push(C[H]);y.push(")");y.push(" ");y.push(" ");y.push(" ");y.push(" ");for(M=y.length;M>G+4;M--)y[M-1]=y[M-5];y[G]="(";y[G+1]="?:";y[G+2]="(";y[G+3]="?:";if("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===
L||"(?:[^\\u000a\\u000d]*)"===L)for(M=G;M<y.length;M++)if(y[M]===L)for(M++;M<y.length;M++)if("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"===y[M]){y[M]="(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===L?"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002D\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))":
"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))";break}ja.pop();M=!0}}}y=y.join("");1==B.length&&(l?y="^\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))":m&&(y="\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))\\s*$"));
console.log("RegEx: "+y);a=null;if(0!==y.length)try{a=new RegExp(y,e)}catch(Db){}p=e=a;l?p=a=null:m&&(e=a=null);0===b.stems.length&&0===b.fuzzies.length&&0===b.dates.length&&(b=null);e={regex:a,first:e,last:p,searchParameters:b,checkForMultipleMatches:h}}f.regex=e}else{h=null;w.normalizeAccentsForSearch&&(b=ec(b));if(!1===c(b)||"literal"===a)b=b.replace(/([\^\$\+\?\.\|\(\)\{\}\[\]\\])/g,"\\$1"),b=b.replace(/^\s+/,""),b=b.replace(/\s+$/,""),b=b.replace(/['\u0060\u00B4\u2018\u2019]/g,"['\\u0060\\u00B4\\u2018\\u2019]"),
b=b.replace(/[\"\u201C\u201D\u030B\u030F]/g,'[\\"\\u201C\\u201D\\u030B\\u030F]'),b=b.replace(/\s+/g,"\\s+"),"phsterms"===a||"string"===a?(a=b.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),h=b.replace(/\*/g,r+"*"),h=new RegExp("(?:^|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])("+
a+")(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])|(?="+r+")("+h+")",e)):"literal*"===a?(b=b.replace(/\*/g,"[^\\s]*"),h=new RegExp("("+b+")",e)):"literal"===a&&(b=b.replace(/\*/g,"\\*"),h=new RegExp("("+b+")",e));f.regex={regex:h}}else b instanceof RegExp&&(f.regex={regex:b});return f},findNext:function(a,b){if(a.regex){if(void 0===a.blockIndex){if(void 0!==
a.startACC){var d;a:{d=a.startACC;for(var c=0;c<b.length;c++){var e=b[c].range;if(d>=e.acc&&d<e.accend){d=c;break a}if(c==b.length-1&&(d=e.accend)){d=c;break a}}d=void 0}a.blockIndex=d}if(void 0===a.blockIndex)if(a.reverse){if(ha.isPending())return;a.blockIndex=b.length-1}else a.blockIndex=0}for(;;){if(a.hitIndex>=a.hits.length){a.hits=[];a.hitIndex=0;for(d=a.reverse?0:b.length;0===a.hits.length;){c=b[a.blockIndex];if(!c)break;if(!c.text)break;var f,e=0;f=a.regex.searchParameters;var g=a.regex.regex;
a.regex.last&&!ha.isPending()&&a.blockIndex==b.length-1&&(g=a.regex.last);a.regex.first&&0===a.blockIndex&&(g=a.regex.first);if(g){var h=c.text;for(f&&(h=u(c.text,f));(f=g.exec(h))&&""!==f[0];){var l=c.range.acc+f.index;a.nextOffset=0;if(!a.lastHit||l>a.lastHit.acc){var B=m(a,f,l);if(B){if("dtsearch"===a.type||"lucene"===a.type){for(var y=B.lastTermACC-l,k=null;0<y;){var y=f[0].substring(0,y),n=g.source,q="";g.global&&(q+="g");g.ignoreCase&&(q+="i");g.multiline&&(q+="m");y=(new RegExp(n,q)).exec(y);
if(!y||""===y[0])break;y=m(a,y,l+y.index);if(!y)break;k||(k=[]);k.push(y);y=y.lastTermACC-l}if(k)for(l=k.length-1;0<=l;l--)a.hits.push(k[l])}a.hits.push(B)}}f.index>e&&(e=f.index);e+=a.nextOffset+1;g.lastIndex=e}}if(a.blockIndex==d)break;a.blockIndex+=a.reverse?-1:1}a.reverse&&(a.hits=a.hits.reverse())}if(a.hitIndex>=a.hits.length)break;for(;a.hitIndex<a.hits.length;)if(d=a.hits[a.hitIndex++],c=!0,void 0!==a.startACC&&(c=a.reverse?d.range.acc<=a.startACC:d.range.acc>=a.startACC),c&&z.isDocumentText(d.range.acc,
d.range.accend-1))return d}}}}}(),ia=Aa.extend("rawtext",{events:{add:{}},install:function(c){var e=/(\r\n|\r|\n)/g,a=/\s/g,b=[],d,g,k=function(){if(void 0===d)for(var a=d=0;a<b.length;a++)b[a].text&&d++;return d};c.findStart=function(a,b,d,c,e,g,k){return Ec.findStart(a,b,d,c,e,g,k)};c.findNext=function(a){return Ec.findNext(a,b)};c.findBoundaryStart=function(d,c){var g;if(0<b.length){var l="line"===c?e:a;l.lastIndex=0;for(var m=r(d);void 0!=m;){var k=b[m];if(!k.text)break;for(var n;n=l.exec(k.text);){n=
k.range.acc+n.index;if(n>d)break;g=n+1}if(void 0!==g)break;if(0===m)break;m--}}void 0===g&&(g=d);return g};c.findBoundaryEnd=function(d,c){var g;if(0<b.length){var l="line"===c?e:a;l.lastIndex=0;for(var m=r(d);void 0!=m;){var k=b[m];if(!k.text)break;for(var n;n=l.exec(k.text);)if(n=k.range.acc+n.index,n>d){g=n;break}if(void 0!==g)break;if(m+1>=b.length)break;m++}}void 0===g&&(g=d);return g};c.firstACC=function(){if(0<b.length)return b[0].range.acc};c.lastACC=function(){if(0<b.length)return b[b.length-
1].range.accend};c.hasRawText=function(){if(0<b.length)return!0;if(!ha.isPending())return!1};c.isPending=function(){return ha.isPending()?!0:k()<b.length};c.getRawTextBlock=function(a){if(0<=a&&a<b.length)return a=b[a],a.text||v(a),a};var n=function(){var a=r(this.acc),d=r(this.accend);if(void 0===a||void 0===d)c.isPending()?(c.onadd(this,n),ha.onadd(this,n)):(c.offadd(this,n),ha.offadd(this,n),this.callback());else{for(var e=0,g=a;g<=d;g++){var k=b[g];!k.text&&k.src?v(k,n,this):e++}e==d-a+1&&(c.offadd(this,
n),ha.offadd(this,n),this.callback())}};c.loadRawText=function(a,b,d){n.call({acc:a,accend:b,callback:d})};c.getRawText=function(a,d){for(var c=r(a),e=r(d),g;c<=e;c++){var l=b[c];if(!l.text){g=void 0;break}var m=a-l.range.acc;0>m&&(m=0);var k=d-l.range.acc;k>l.text.length&&(k=l.text.length);l=l.text.substring(m,k);g=g?g+l:l}return g};var r=function(a){for(var d=0;d<b.length;d++){var c=b[d].range;if(a>=c.acc&&a<c.accend||d==b.length-1&&(a=c.accend))return d}},v=function(a,b,d){if(!a.text&&a.src){if(b){a.callbacks||
(a.callbacks=[]);for(var c=!1,e=0;e<a.callbacks.length;e++)if(a.callbacks[e].func==b&&a.callbacks[e].context==d){c=!0;break}c||a.callbacks.push({func:b,context:d})}a.loading||(b=Sa(u.baseURL,a.src),k(),a.loading=!0,ab({url:b,complete:t,args:[a]}))}else b&&b.call(d,a)},t=function(a,e,g,k,n){n.loading=!1;200==k?ha.isICD(g)?ha.processContentData(g):(n.text=g,q(n)):(n.text="",c.logAJAXError(null,"Failed to load a document text block from the server",a,k,g));d++;e=b.indexOf(n);a=b[e-1];e=b[e+1];a&&a.text&&
(n.text=a.text.substr(a.text.length-2048,2048)+n.text,n.range.acc-=2048);e&&e.text&&(e.text=n.text.substr(n.text.length-2048,2048)+e.text,e.range.acc-=2048);if(n.callbacks){for(a=0;a<n.callbacks.length;a++)n.callbacks[a].func.call(n.callbacks[a].context,n);delete n.callbacks}200==k&&c.on.add.dispatch(n.range.acc,n.range.accend)};c.replaceRawText=function(a){if(a&&(g=g?g.concat(a):a,0<b.length))for(a=0;a<b.length;a++)q(b[a])};var q=function(a){if(g&&g.length&&a.text)for(var b,d=a.range.acc,c=a.range.acc+
a.text.length,e=0;e<g.length;e++)if(b=g[e],b.acc<=c&&b.accend>=d){var k=b.acc-d;0>k&&(k=0);b=b.accend-d;b>a.text.length&&(b=a.text.length);for(var m=b-k,n="";0<m--;)n+=" ";a.text=a.text.substr(0,k)+n+a.text.substr(b)}a.text&&w.normalizeAccentsForSearch&&(a.text=ec(a.text))};E.onreset(function(){g=d=void 0;b=[]});ha.ondata(function(a,d,c){if(a.text)for(d=0;d<a.text.length;d++){c=a.text[d];q(c);for(var e=0;e<b.length;e++)if(0===Na(c.range,b[e].range)){b[e].text=c.text;c=null;break}c&&(b.push(c),v(c))}})}}),
fc,xa,pa,Ab,Bb,sa,mb,va,Na,Fc,gb,ga,Gc,gc,Nb,sb,Eb;(function(){var c=function(c,a){return c.acc-a.acc};fc=function(c){return!!xa(c,!1,!1)};xa=function(c,a,b){var d;if(c&&c.type)switch(c.type){case "text":fa(c.acc)&&fa(c.accend)&&(d=c);d&&b&&(c=z.forRange(d,0,!0))&&c.isEmailHeader()&&(c=z.findTextRange(d))&&(c=c[0].startContainer)&&(x.isText(c)||x.isElement(c))&&(c=La(c),c=Bb(c))&&(Array.isArray(c)&&(c=pa(c[0].acc,c[c.length-1].accend)),d.acc<c.acc||d.accend>c.accend)&&(d=ga(d),d.acc<c.acc&&(d.acc=
c.acc),d.accend>c.accend&&(d.accend=c.accend));break;case "cell":if(fa(c.page)&&fa(c.c1)&&fa(c.r1)&&fa(c.c2)&&fa(c.r2)&&(d=c,0>d.page?d=void 0:d.page<z.count()?(b=z.page(d.page))&&"worksheet"!==b.type&&"database"!=b.type&&(d=void 0):d.offsets&&(fa(d.offsets.left)&&fa(d.offsets.top)&&fa(d.offsets.right)&&fa(d.offsets.bottom)||(d=void 0)),d&&!0===a&&(b=z.page(c.page)))&&(b=b.spreadsheetModel())){var e=b.colCount()-1;a=b.rowCount()-1;if(c.c1>e||0>c.c2||c.r1>a||0>c.r2)d=void 0;else{b=na(c.c1,0,e);var e=
na(c.c2,0,e),k=na(c.r1,0,a);a=na(c.r2,0,a);if(b!==c.c1||e!==c.c2||k!==c.r1||a!==c.r2)d=ga(c),d.c1=b,d.c2=e,d.r1=k,d.r2=a}}break;case "rect":if(fa(c.page)&&fa(c.left)&&fa(c.top)&&fa(c.right)&&fa(c.bottom)&&Ia(c.units)&&("px"===c.units||"tw"===c.units||"pct"===c.units)&&(d=c,"pct"!==c.units||fa(c.embedId)?0>d.page?d=void 0:void 0===c.embedId&&d.page<z.count()&&(b=z.page(d.page))&&"page"!==b.type&&"drawing"!==b.type&&"slide"!==b.type&&"chart"!==b.type&&"bitmap"!==b.type&&"email"!==b.type&&"html"!==b.type&&
"rt"!==b.type&&"sn"!==b.type&&(d=void 0):d=void 0,d&&void 0===c.embedId&&!0===a&&(b=z.page(c.page))&&(a=b.pageRect())))if(c.left>a.right||c.right<a.left||c.top>a.bottom||c.bottom<a.top)d=void 0;else{var e=na(c.left,a.left,a.right),k=na(c.top,a.top,a.bottom),n=na(c.bottom,k,a.bottom),r=c.right;"html"!==b.type&&(r=na(c.right,e,a.right));if(e!=c.left||r!=c.right||k!=c.top||n!=c.bottom)d=ga(c),d.left=e,d.right=r,d.top=k,d.bottom=n}}return d};pa=function(){var c=arguments,a,b;switch(c.length){case 2:fa(c[0])&&
fa(c[1])&&(a=c[0],b=c[1]);break;case 1:if(fa(c[0]))a=c[0],b=c[0];else if(Ra(c[0])||Ba(c[0])){if(c=Bb(c[0]))Array.isArray(c)?(a=c[0].acc,b=c[c.length-1].accend):(a=c.acc,b=c.accend)}else if((c=xa(c[0]))&&"cell"===c.type){var d=z.page(c.page);if(d&&("worksheet"===d.type||"database"===d.type)&&(d=d.spreadsheetModel()))return d.mapToText(c)}}var g;fa(a)&&fa(b)&&(g=new OIT.TextRange(a,b));return g};Ab=function(c,a){c=x.unwrap(c);a=a||0;var b;a:{if(1===c.nodeType&&c.childNodes&&(b=c.childNodes[a]))break a;
b=void 0}b&&(c=b,a=0);var d;b=u.viewNode;for(var e=c;e;e=e.parentNode){var k=x.data(e,"acc");if(void 0!==k){"none"!==k&&(d=x.wrap(e));break}if(e===b)break}if(b=d){d=parseInt(b.data("acc"),10);if(!b.equals(c))for(b=b.createTreeWalker(),e=b.firstACCNode();e;){e=b.currentNode;if(e===c)break;1===e.nodeType?(e=x.data(e,"acc"))&&(d=parseInt(e,10)):3===e.nodeType&&(d+=e.nodeValue.length);e=b.nextACCNode()}return d+a}};Bb=function(c){var a;Ra(c)?a=c:Ba(c)&&"number"===typeof c.rangeCount&&0<c.rangeCount?a=
c.getRangeAt(0):x.isElement(c)&&(a=W.createRange(),a.selectNode(x.unwrap(c)));if(a){c=a.startContainer;var b=a.startOffset,d=a.endContainer,e=a.endOffset,k,n;if(c===d){k=Ab(c,b);if(b===e)return pa(k,k);if(x.isText(c))return pa(k,k+e-b)}for(var r=a.commonAncestorContainer;r&&!x.isElement(r);)r=r.parentNode;r=x.wrap(r);a=Ab(r);var v=[],t,r=r.createTreeWalker();k=r.firstACCNode();for(var q=!1,m=!1,l=!1;k;){var K=r.currentNode;K===c&&x.isText(c)?q=!0:q||K.parentNode!==c||(m=!0,0!==b&&x.nodeIndex(K)!=
b)||(q=!0);m&&!q&&(x.isDescendantOf(K,c)||(q=!0));if(l&&!x.isDescendantOf(K,d))break;1===K.nodeType?(k=x.data(K,"acc"))&&(a="none"===k?void 0:Number(k)):3===K.nodeType&&void 0!==a&&(q&&0<K.nodeValue.length&&(k=a,K===c&&(k+=b),n=a+K.nodeValue.length,K===d&&(n=a+e),t&&t.accend!=a&&t.accend!=a-1&&(t=null),t?t.accend=n:(t=pa(k,n),v.push(t))),a+=K.nodeValue.length);if(K===d&&x.isText(d))break;else if(K.parentNode===d&&(l=!0,0===e||x.nodeIndex(K)>=e))break;k=r.nextACCNode()}v=Gc(v);0===v.length?v=void 0:
1==v.length&&(v=v[0]);return v}};sa=function(){var c,a,b,d,g,k,n,r=arguments;switch(r.length){case 9:a=r[0];b=r[1];d=r[2];g=r[3];k=r[4];n={left:r[5],top:r[6],right:r[7],bottom:r[8]};break;case 5:a=r[0];b=r[1];d=r[2];g=r[3];k=r[4];break;case 4:b=r[0];d=r[1];g=r[2];k=r[3];break;case 3:a=r[0];b=r[1];d=r[2];g=r[1];k=r[2];break;case 2:b=r[0];d=r[1];g=r[0];k=r[1];break;case 1:if((r=xa(r[0]))&&"text"===r.type&&(c=z.forRange(r))&&("worksheet"===c.type||"database"===c.type)&&(c=c.spreadsheetModel()))return c.mapToCells(r)}if(void 0===
a)a=z.current();else if(Ia(a)){if(c=z.byName(a))a=c.index}else if(fa(a)){if(0>a||a>=z.count())a=void 0}else a=void 0;var v;fa(a)&&fa(b)&&fa(d)&&fa(g)&&fa(k)?v=new OIT.CellRange(a,b,d,g,k,n):E.invalidArg("cellRange");return v};mb=function(){var c,a,b,d,g,k,n="px",r=arguments;if(2<=r.length&&6>=r.length){var v=0;if(Ia(r[v])){var t=z.byName(r[v]);t&&(a=t.index,v++)}for(var t=0,q=v;q<r.length;q++)if(fa(r[q]))t++;else break;switch(t){case 6:c=r[v++];case 5:a=r[v++];case 4:b=r[v++];d=r[v++];g=r[v++];k=
r[v++];break;case 3:a=r[v++];case 2:b=r[v++],d=r[v++],g=b,k=d}v<r.count&&Ia(r[v])&&(n=r[v++])}if(void 0===a)a=z.current();else if(fa(a)){if(0>a||a>=z.count())a=void 0}else a=void 0;var m;fa(a)&&fa(b)&&fa(d)&&fa(g)&&fa(k)&&("px"===n||"tw"===n||"pct"===n)?m=new OIT.RectRange(c,a,b,d,g,k,n):E.invalidArg("rectRange");return m};va=function(c,a){if(c&&"rect"===c.type&&c.units!==a){var b,d,e;switch(a){case "px":"tw"===c.units?(b=z.page(c.page))&&b.dpi&&(c.left=P(c.left*b.dpi/1440,1E4),c.top=P(c.top*b.dpi/
1440,1E4),c.right=P(c.right*b.dpi/1440,1E4),c.bottom=P(c.bottom*b.dpi/1440,1E4),c.units="px"):"pct"===c.units&&void 0!==c.embedId&&(b=z.page(c.page))&&(b=b.embeddingRect(c.embedId))&&(d=b.width/100,e=b.height/100,c.left=P(c.left*d,1E4),c.right=P(c.right*d,1E4),c.top=P(c.top*e,1E4),c.bottom=P(c.bottom*e,1E4),c.units="px");break;case "tw":"px"===c.units&&(b=z.page(c.page))&&b.dpi&&(c.left=P(1440*c.left/b.dpi,1E4),c.top=P(1440*c.top/b.dpi,1E4),c.right=P(1440*c.right/b.dpi,1E4),c.bottom=P(1440*c.bottom/
b.dpi,1E4),c.units="tw");break;case "pct":if("px"===c.units&&(b=z.page(c.page))){if(void 0!==c.embedId){if(b=b.embeddingRect(c.embedId))d=100/b.width,e=100/b.height}else e=b.pageRect(),d=100/e.width,e=100/e.height;void 0!==d&&(c.units="pct",c.left=P(c.left*d,1E4),c.right=P(c.right*d,1E4),c.top=P(c.top*e,1E4),c.bottom=P(c.bottom*e,1E4))}}}};Na=function(c,a){if(!c)return a?-1:0;if(!a)return 1;if(c.page<a.page)return-1;if(c.page>a.page)return 1;if(c.type===a.type)switch(c.type){case "text":return c.acc<
a.acc?-1:a.acc<c.acc?1:c.accend<a.accend?-1:a.accend<c.accend?1:0;case "cell":if(c.r1<a.r1)return-1;if(a.r1<c.r1)return 1;if(c.c1<a.c1)return-1;if(a.c1<c.c1)return 1;if(c.r2<a.r2)return-1;if(a.r2<c.r2)return 1;if(c.c2<a.c2)return-1;if(a.c2<c.c2)return 1;if(c.offsets)if(a.offsets){if(c.offsets.top<a.offsets.top)return-1;if(c.offsets.top>a.offsets.top)return 1;if(c.offsets.left<a.offsets.left)return-1;if(c.offsets.left>a.offsets.left)return 1;if(c.offsets.bottom<a.offsets.bottom)return-1;if(c.offsets.bottom>
a.offsets.bottom)return 1;if(c.offsets.right<a.offsets.right)return-1;if(c.offsets.right>a.offsets.right)return 1}else return 1;else if(a.offsets)return-1;return 0;case "rect":return c.units!=a.units&&(a=ga(a),va(a,c.units)),c.top<a.top?-1:a.top<c.top?1:c.left<a.left?-1:a.left<c.left?1:c.bottom<a.bottom?-1:a.bottom<c.bottom?1:c.right<a.right?-1:a.right<c.right?1:0}};Fc=function(c,a){if(c.type===a.type)switch(c.type){case "text":return a.acc>=c.acc&&a.accend<=c.accend}return!1};gb=function(c,a){if(c&&
a&&a.type===c.type)switch(a.type){case "text":return c.accend>a.acc&&c.acc<a.accend;case "cell":return c.c2>=a.c1&&c.c1<=a.c2&&c.r2>=a.r1&&c.r1<=a.r2;case "rect":return c.right>=a.left&&c.left<=a.right&&c.bottom>=a.top&&c.top<=a.bottom}return!1};ga=function(c){var a;if(c)switch(c.type){case "text":a=new OIT.TextRange(c.acc,c.accend);break;case "cell":a=new OIT.CellRange(c.page,c.c1,c.r1,c.c2,c.r2);!0===c.selectingCols&&(a.selectingCols=!0);!0===c.selectingRows&&(a.selectingRows=!0);c.offsets&&(a.offsets=
{left:c.offsets.left,top:c.offsets.top,right:c.offsets.right,bottom:c.offsets.bottom});break;case "rect":a=new OIT.RectRange(c.embedId,c.page,c.left,c.top,c.right,c.bottom,c.units,c.section)}return a};Eb=function(c,a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)c=Eb(a[b],c);else if(!c)c=ga(a);else if(c.type===a.type)switch(c.type){case "cell":a.c1<c.c1&&(c.c1=a.c1);a.r1<c.r1&&(c.r1=a.r1);a.c2>c.c2&&(c.c2=a.c2);a.r2>c.r2&&(c.r2=a.r2);break;case "text":a.acc<c.acc&&(c.acc=a.acc),a.accend>c.accend&&
(c.accend=a.accend)}return c};Gc=function(e){if(e&&1<e.length){e.sort(c);for(var a=[],b,d=0;d<e.length;d++){var g=e[d];b&&3>g.acc-b.accend?g.accend>b.accend&&(b.accend=g.accend):(b=g,a.push(g))}e=a}return e};gc=function(c){if(1===c.length)return c[0];if(1<c.length){var a=c[0],b=W.createRange();b.setStart(a.startContainer,a.startOffset);b.setEnd(a.endContainer,a.endOffset);for(var a=La(a.startContainer),d=1;d<c.length;d++){var e=c[d],k=La(e.endContainer);x.unwrap(k)==x.unwrap(a)&&b.setEnd(e.endContainer,
e.endOffset)}return b}};Nb=function(c){if(c=xa(c))switch(c.type){case "text":return c.acc==c.accend;case "cell":return!1;case "rect":return c.left==c.right||c.top==c.bottom}return!0};sb=function(c){if(c)switch(c.type){case "cell":var a=[];a.push(Ma(c.c1),c.r1+1);c.c2==c.c1&&c.r2==c.r1||a.push(":",Ma(c.c2),c.r2+1);return a.join("")}}})();var F=Aa.extend("display",{events:{displayload:{},displayunload:{}},install:function(c){var e={zoom:!1,rotate:!1,showhidden:!1,pages:!1,fitpage:!1,highlights:!1,textselection:!1,
rectselection:!1,rectredaction:!1,cellselection:!1,customtextselection:!1,anchorednotes:!1},a=null,b=null,d=e,g=!1,k;c.loadDisplay=function(e){c.unloadDisplay();var g=e.type;e.overlay&&e.overlay.firstPage&&(g=e.overlay.firstPage.type);if(a=Ha.createDisplay(g))b=e.overlay,u.deType=g,d=Ha.features(g),u.drawing.resetOrigin(),a.init(e),c.on.displayload.dispatch(b.firstPage,b.lastPage)};c.unloadDisplay=function(){a&&(c.on.displayunload.dispatch(b.firstPage,b.lastPage),a.unload(),b=a=null,u.deType=null);
d=e};c.features=function(){var a=d;if("vertical"!==w.scrollMode){var b=z.activePage();b&&(a=Ha.features(b.type))}return a};c.isSelectionModeSupported=function(a){var b=!1;switch(a){case "none":b=!0;break;case "text":c.features().textselection&&(b=!0);break;case "rect":c.features().rectselection&&(b=!0);break;case "cell":c.features().cellselection&&(b=!0)}return b};c.isHighlightModeSupported=function(a){var b=c.isSelectionModeSupported(a);b||"text"!==a||"worksheet"!==u.deType&&"database"!==u.deType||
(b=!0);return b};c.visiblePages=function(){return a?a.visiblePages():[]};c.startElasticScroll=function(){if(a)return a.startElasticScroll()};c.elasticScroll=function(b,c){if(a)return a.elasticScroll(b,c)};c.endElasticScroll=function(b,c){if(a)return a.endElasticScroll(b,c)};c.saveScrollPos=function(){if(a)return a.saveScrollPos()};c.restoreScrollPos=function(b){a&&a.restoreScrollPos(b)};c.maxPageWidth=function(){if(a)return a.maxPageWidth()};c.maxPageHeight=function(){if(a)return a.maxPageHeight()};
c.padding=function(){if(a)return a.padding()};c.scrollPadding=function(){if(a)return a.scrollPadding()};c.margin=function(){if(a)return a.margin()};c.scrollOffset=function(){if(a)return a.scrollOffset()};c.keydown=function(b){return a?a.keydown(b):!0};c.showHidden=function(b){a&&a.showHidden(b)};c.loadRange=function(b,c){a&&a.loadRange(b,c)};c.expandRange=function(b){a&&(b=a.expandRange(b));return b};c.moveto=function(b,c,d){return a?a.moveto(b,c,d||{}):!1};c.getSelectedText=function(){return a?a.getSelectedText():
""};c.select=function(b){return a?a.select(b):!1};c.pageRange=function(c,d){if(a&&b.containsPage(c))return a.pageRange(c,d)};c.pageRect=function(c,d){if(a&&b.containsPage(c))return a.pageRect(c,d)};c.rangeRect=function(c,d,e,g){if(a&&("text"===c.type||b.containsPage(c.page)))return a.rangeRect(c,d,e,g)};c.rangeFromRect=function(c,d,e,g,k,m,l,K){if(a&&b.containsPage(c))return a.rangeFromRect(c,d,e,g,k,m,l,K)};c.extendRange=function(b,c,d,e){if(a)return a.extendRange(b,c,d,e)};c.moveAnchor=function(b,
c,d,e){return a?a.moveAnchor(b,c,d,e):!1};c.incrementSelection=function(b,c,d,e,g){return a?a.incrementSelection(b,c,d,e,g):!1};c.suspendUpdate=function(){g||(g=!0)};c.resumeUpdate=function(){g&&(g=!1,c.update())};c.layoutChanged=function(b){a&&a.layoutChanged(b)};c.update=function(b,d){if(!g)if(!0===d)k&&ta(k),k=da(c.update,50,this,b,!1);else if(a)return a.update(b);return!1};c.activeOverlay=function(){return b};E.onreset(c.unloadDisplay);Cc.onfontload(function(){c.update(!0)})}}),T=Aa.extend("selection",
{events:{beginselection:{},selectionchanged:{}},install:function(c){var e=null,a=!0,b,d=null,g=!0,k=!1,n=!0,r=!1,v,t,q,m,l,K,M,I,H,O,C,R=0,A,f,h,B=0,y,L,ca=0,Y=0,ma,N,J,p=[],D,ja,Z,oa;c.reset=function(){c.select(null);w.selectionMode=c.validateMode(w.selectionMode)};c.style=function(a,b){g=!1===b?!1:!0;null!==a&&"string"!==typeof a||a===d||(d=a,e=ib(d),Da(),ea());return d};c.isSelecting=function(){return r};var Da=function(a){if(!a&&e){a="";e.color&&(a+="color:"+e.color+";");var b=e["background-color"];
b&&(a+="background-color:"+b+";")}a&&0<a.length?(D||(D=x.create("style"),D.type="text/css",x.byTagName("head")[0].append(D)),D.html(".oit-view ::selection, .oit-annopane ::selection { "+a+"}")):D&&D.html("")},ea=function(){if(t){var a=t.selectionRect();a.resetStyle();e?(a.removeClass("oit-sel-rect"),a.css(e)):a.addClass("oit-sel-rect");a.update()}};c.textSelection=function(){if(q){if("text"===q.type)return ga(q);if("cell"===q.type)return pa(q)}};c.cellSelection=function(){if(q&&"cell"===q.type)return ga(q)};
c.rectSelection=function(){if(q&&"rect"===q.type)return ga(q)};c.selectionType=function(){return q?q.type:"none"};c.hide=function(d){a=!1;b=d;zc("firefox")?c.select(null):b?Da(b):Da("background-color: rgba(255,255,255,0);");t&&t.showSelectionRect(!1)};c.select=function(d,f,e,p){var g=!1;a=!0;b=null;if(null===d)g=!!q,la(),c.update();else if(d)if(Ba(d)||Ra(d))g=c.select(pa(d));else if(d=xa(d),!d||d.selectingRows||d.selectingCols||!1===d.autoExpand||(d=F.expandRange(d)),d&&0!==Na(d,q)){var h=z.forRange(d,
0,!0);h&&(g=!0,c.on.beginselection.dispatch(d),la(),t=h,q=ga(d),v=ga(d),ea(),c.update())}if(g||f!==oa)c.on.selectionchanged.dispatch(q,!0),oa=f,E.on.select.dispatch(q,e||null,p||null,Nb(q),f)&&(u.drawing&&u.drawing.update(!0),q&&void 0===f&&(d=F.rangeRect(q,"view"),"text"===q.type&&c.update(),d&&Q.activateNearest(d.left,d.top)));return g};c.saveSelection=function(){if(!q)return null;var c={range:ga(q)};a||(c.visible=!1,c.hideStyle=b);return c};c.restoreSelection=function(a){if(a){var b=a.range,d=
z.forRange(b,0,!0);d&&(c.on.beginselection.dispatch(b),la(),t=d,q=ga(b),v=ga(b),ea(),c.update(),a.visible||c.hide(a.hideStyle))}};c.startRectSelection=function(d,f,e){la();z.deactivateAnnotation();r=!0;F.isSelectionModeSupported("text")||Q.startSelection();e=z.mapToPage(d,f,null,!0);c.logRect&&c.logRect(e.page,e.x,e.y,!0);m={x:d,y:f};t=e.page;M=e.x;I=e.y;H=d;O=f;a=K=!0;b=null;q=F.rangeFromRect(t.index,M,I,M,I,t,"select");"cell"!==q.type||k||delete q.offsets;v=ga(q);c.on.beginselection.dispatch(q);
ea();c.update();c.on.selectionchanged.dispatch(q,!1);return!0};c.extendRectSelection=function(a,b,d){v&&(K&&(d=Math.abs(b-O),2<Math.abs(a-H)||2<d)&&(K=!1,F.isSelectionModeSupported("text")&&Q.startSelection()),wa(l,a,b),a=z.mapToPage(a,b,t,!0),c.logRect&&c.logRect(a.page,a.x,a.y),q=F.extendRange(v,a.x,a.y,a.page),n&&(q=xa(q,!0)),c.update(),c.on.selectionchanged.dispatch(q,!1))};c.endRectSelection=function(a,b,d){qa();r=!1;c.extendRectSelection(a,b);c.on.selectionchanged.dispatch(q,!0);var f={x:a,
y:b},e=K;oa=void 0;E.on.select.dispatch(q,m,f,K)&&"rect"===w.selectionMode&&c.select(null);e&&d&&(f=x.wrap(d.target),f.isDescendantOf(z.activeOverlay())||f.isDescendantOf(u.drawing))&&((f=z.activePage())&&f.isSpreadsheet()?Q.activateNearest(a,b,d,!0):(a=Q.findNearest(a,b))&&0===a.distance.ax&&0===a.distance.ay||Q.deactivate());Q.endSelection()};c.cancelRectSelection=function(a,b){qa();c.select(null)};c.startTouchTextSelection=function(d,f){a=!0;b=null;ja&&c.abortTouchTextSelection();r=!0};c.updateTouchTextSelection=
function(){var a=S.getSelection();!a.anchorNode||Z&&Z.anchorNode==a.anchorNode&&Z.anchorOffset==a.anchorOffset&&Z.focusNode==a.focusNode&&Z.focusOffset==a.focusOffset||(Z||(Z={}),Z.anchorNode=a.anchorNode,Z.anchorOffset=a.anchorOffset,Z.focusNode=a.focusNode,Z.focusOffset=a.focusOffset,ja=pa(a))};c.abortTouchTextSelection=function(){ja=null;r=!1};c.startTextSelection=function(d,e,p,g){la();r=!0;h=C=null;l=x.wrap(g.target);a=!0;b=null;m={x:d,y:e};K=!0;H=d;O=e;if(!F.features().customtextselection)return!1;
d=z.mapToPage(d,e,null,!0,!0);d.inAnnotation||z.deactivateAnnotation();e=d.page.mapPointToText(d.x,d.y,null,d.inAnnotation);if(!e||!e.overlaps)return!1;L=d;f=La(e.node);var D;if("line"===p||"word"===p)D=d.page.findTextBoundary(e.node,e.offset,p);D?(y=p,A=D,C=A.startContainer,R=A.startOffset,h=A.endContainer,B=A.endOffset):(y=void 0,C=e.node,R=e.offset,h=e.node,B=e.offset);if(C&&h&&(c.update(),x.selectRange(C,R,h,B),p=S.getSelection(),p.anchorNode&&p.focusNode))if(p=pa(p))c.on.beginselection.dispatch(p);
else return h=C=null,!1;return!0};c.extendTextSelection=function(a,b,c){if(!F.features().customtextselection)return!1;K&&(c=Math.abs(b-O),2<Math.abs(a-H)||2<c)&&(K=!1,F.isSelectionModeSupported("text")&&Q.startSelection());wa(l,a,b);c=null;var d=!1;L&&L.inAnnotation&&(c=L.page,d=!0);a=z.mapToPage(a,b,c,!0,!0,d);b=a.page.mapPointToText(a.x,a.y,f,a.inAnnotation);if(!b)return!1;if(b.node!=h||b.offset!=B){if(y){if(b=a.page.findTextBoundary(b.node,b.offset,y))a=b.compareBoundaryPoints(Range.START_TO_START,
A),-1==a?(h=b.startContainer,B=b.startOffset,C=A.endContainer,R=A.endOffset):(C=A.startContainer,R=A.startOffset,h=b.endContainer,B=b.endOffset)}else h=b.node,B=b.offset;C&&h&&(C==h?R>B?x.selectRange(h,B,C,R):x.selectRange(C,R,h,B):(a=C.compareDocumentPosition(h),2==a?x.selectRange(h,B,C,R):x.selectRange(C,R,h,B)))}return!0};c.endTextSelection=function(a,b,d){qa();r=!1;L=l=null;if("text"==w.selectionMode){var f,e=K;y&&(e=!1);ja?(f=ja,ja=null):(f=S.getSelection(),f=f.anchorNode&&f.focusNode?pa(f):
null);if(!f)la(),Q.autoHighlight()&&x.clearSelection();else if(0!==Na(f,q)){f.acc!==f.accend&&(e=!1);var p=z.forRange(f);p&&(K=!1,O=H=I=M=void 0,t=p,q=f,v=ga(f),c.on.selectionchanged.dispatch(q,!0),f={x:a,y:b},oa=void 0,E.on.select.dispatch(q,m,f,Nb(q)))}e&&d&&(d=x.wrap(d.target),d.isDescendantOf(z.activeOverlay())||d.isDescendantOf(u.drawing))&&((a=Q.findNearest(a,b))&&0===a.distance.ax&&0===a.distance.ay||Q.deactivate());C=void 0;R=0;h=A=void 0;B=0;y=void 0}Q.endSelection()};c.incrementSelection=
function(a,b,d){var f=!1;q&&(f=F.incrementSelection(v,q,a,b,d))&&(c.update(),c.on.selectionchanged.dispatch(q,!0));return f};c.moveAnchor=function(a,b,d){var f=!1;v&&(f=F.moveAnchor(v,a,b,d))&&(q=ga(v),c.update(),c.on.selectionchanged.dispatch(q,!0));return f};c.update=function(){if(q)if("text"===q.type){x.clearSelection();c.logUpdate&&c.logUpdate(q);var b=z.findTextRange(q);b&&x.selectRange(gc(b))}else{if(t)if(b=F.rangeRect(q,"overlay",!0),c.logUpdate&&c.logUpdate(q,b),!b)t.showSelectionRect(!1);
else if(t.hasSelectionRect()){var d=t.selectionRect();d.move(b.left,b.top,b.width,b.height);d.show(a&&(!K||g)&&("rect"===q.type||"cell"===q.type))}}else x.clearSelection();F.select(q)&&F.update()};var la=function(){x.clearSelection();t&&t.showSelectionRect(!1);r=!1;a=!0;b=null;K=!1;O=H=I=M=void 0;q=v=t=null;Da();ea()};c.validateMode=function(a,b){F.isSelectionModeSupported(a)||("rect"===a?F.features().rectredaction&&"redaction"==OIT.highlights.autoHighlight()||(a=void 0):a=void 0);a||(b?a=c.validateMode(b):
F.isSelectionModeSupported("text")?a="text":F.isSelectionModeSupported("rect")?a="rect":F.isSelectionModeSupported("cell")&&(a="cell"));return a};c.addAutoscrollRoot=function(a){p.push(x.wrap(a))};var wa=function(a,b,c){if(b!=ma||c!=N){var d=u.viewNode;ma=b;for(N=c;a&&-1==p.indexOf(a);){if(a===d||!(a instanceof V)){a=null;break}a=a.parent()}var f;a?(f=a.pos(d),b-=f.left,c-=f.top,f=a.clientWidth*w.zoom,d=a.clientHeight*w.zoom):(a=d,f=d.clientWidth,d=d.clientHeight);1>=b?(ca=b-1,-30<ca&&(ca=-30)):b>=
f-1?(ca=b-(f-1),30>ca&&(ca=30)):ca=0;1>=c?(Y=c-1,-30<Y&&(Y=-30)):c>=d-1?(Y=c-(d-1),30>Y&&(Y=30)):Y=0;ca||Y?J||(J=wb(ra,100,null,a)):qa()}},ra=function(a){a.dscroll(ca,Y);C?c.extendTextSelection(ma,N):c.extendRectSelection(ma,N)},qa=function(){J&&(Qa(J),J=void 0,Y=ca=0)};c.enableCellOffsets=function(a){k=!!a};c.bindSelectionToPage=function(a){n=!!a};la();w.onselectionMode(function(a){c.select(null);(a=z.activeOverlay())&&a.updateCSS()});E.onreset(function(){c.reset();p=[]});F.ondisplayload(c.reset);
ka.ondetach(function(){d=e=null;D&&(D.destroy(),D=null)});E.onzoom(function(a,b,d){c.update()})}}),Va=Aa.extend("user",{events:{beginscroll:{},endscroll:{},beginpinchzoom:{},endpinchzoom:{}},install:function(c){var e=!1,a=!1,b=!1,d=!1,g,k,n=null,r,v,t,q=null,m,l,K,M,I,H,O,C,R,A=0,f=0,h=0,B=0;E.onload(function(){var a=u.rootNode;a.onmousedown(ca);a.onwheel(ma);S.addEventListener("mouseup",Y,!1);S.addEventListener("keydown",y,!1);u.isMobileOrTablet&&(a=u.viewNode,a.kinetic(!0),a.ontap(wa),a.onpress(ra),
a.onpressup(qa),a.onpanstart(Fa),a.onpanmove(G),a.onpanend(Ca),a.onpancancel(Ca),a.onpinchstart(Lb),a.onpinchmove(kb),a.onpinchend(P),a.onpinchcancel(P),a.onrotatestart(Mb),a.onrotatemove(U),a.onrotateend(V),a.onrotatecancel(V))});E.onreset(function(){var a=u.rootNode;a&&(a.offmousedown(ca),a.offwheel(ma));S.removeEventListener("mouseup",Y);S.removeEventListener("keydown",y);u.isMobileOrTablet&&(a=u.viewNode)&&(a.offtap(wa),a.offpress(ra),a.offpressup(qa),a.offpanstart(Fa),a.offpanmove(G),a.offpanend(Ca),
a.offpancancel(Ca),a.offpinchstart(Lb),a.offpinchmove(kb),a.offpinchend(P),a.offpinchcancel(P),a.offrotatestart(Mb),a.offrotatemove(U),a.offrotateend(V),a.offrotatecancel(V))});var y=function(a){var b,d;c.logKeydown&&c.logKeydown(a);if(c.isViewEventTarget(a.target)||e&&a.target==W.body){if((d=E.on.keydown.dispatch(a))&&!u.editingComment&&(d=F.keydown(a))){b=u.viewNode;var f=Q.active(),p=0,g=0;switch(a.keyCode){case 33:F.features().pages&&(b.finishAnimation(),z.updateActivePage(),0<b.scrollTop?b.dscroll(void 0,
-b.clientHeight):z.movetoPrev(),d=!1);break;case 34:F.features().pages&&(b.finishAnimation(),z.updateActivePage(),b.scrollTop<Math.max(b.clientHeight,b.scrollHeight,b.offsetHeight)-b.innerHeight?b.dscroll(void 0,b.clientHeight):z.movetoNext(),d=!1);break;case 35:b.scroll(b.scrollWidth,b.scrollHeight);d=!1;break;case 36:b.scroll(0,0);d=!1;break;case 37:p=-1;break;case 38:g=-1;break;case 39:p=1;break;case 40:g=1;break;case 45:void 0!==f&&Q.getOption(f,"enableUserComment")&&(Q.showComment(f,{mode:"edit",
removeOnCancel:!1}),d=!1);break;case 46:void 0!==f&&Q.getOption(f,"enableUserDelete")&&(Q.remove(),f=void 0,d=!1);break;case 48:a.ctrlKey&&(E.zoom(1),d=!1);break;case 187:a.ctrlKey&&(E.zoomIn(),d=!1);break;case 189:a.ctrlKey&&(E.zoomOut(),d=!1)}if(p||g){var h;void 0!==f&&(b=Q.range(f))&&(h=b.type);h||(h=w.selectionMode);if("cell"===h||"rect"===h)if(h=a.ctrlKey,void 0!==f){if(a.shiftKey){var D=b=0,l=0,y=0;d=w.rotation;switch(d){case 0:l=p;y=g;break;case 90:y=p;b=-g;break;case 180:b=-p;D=-g;break;case 270:D=
-p,l=g}Q.move(f,b,D,l,y,h)}else{d=w.rotation;if(0!==d)switch(b=p,D=g,d){case 90:p=-D;g=b;break;case 180:p=-b;g=-D;break;case 270:p=D,g=-b}Q.move(f,p,g,p,g,h)}(b=Q.range(f))&&z.moveto(b);d=!1}else d=a.shiftKey?!T.incrementSelection(p,g,h):!T.moveAnchor(p,g,h)}}!1===d&&jb(a);return d}},L=function(a){(a.button||0)==I&&(c.releaseMouseCapture(),c.on.endscroll.dispatch());I=void 0},ca=function(f){e=!1;c.logMouse&&c.logMouse(f);if(!u.editingComment){var p=u.viewNode,g=p.mousePos(f);if(c.isViewEventTarget(f.target)){var h=
f.button||0,D=p.inRect(g.x,g.y);if(1==h||0===h&&!D)c.on.beginscroll.dispatch(),I=h,c.setMouseCapture(null,L);else{D=!0;p.focus();e=!0;if(0===h){p=w.selectionMode;if("rect"===p||"cell"===p)T.startRectSelection(g.x,g.y,f)&&(b=!0,c.setMouseCapture(Da)),D=!1;else if("text"==p){var y,p=1;if(void 0!==m){var k;if(f.pageX||f.pageY)y=f.pageX,k=f.pageY;else if(f.clientX||f.clientY)y=f.clientX,k=f.clientY;y=Math.abs(y-l.x);k=Math.abs(k-l.y);3>=y&&3>=k&&((new Date).getTime()-m<=w.doubleClickInterval&&(p=K+1),
m=void 0)}y=p;var B;2===y?B="word":y=1;if(T.startTextSelection(g.x,g.y,B,f))if(d=!0,c.setMouseCapture(ea),g=y,m=(new Date).getTime(),K=g,f.pageX||f.pageY)l={x:f.pageX,y:f.pageY};else if(f.clientX||f.clientY)l={x:f.clientX,y:f.clientY};D=!1}a=!0}!1===D&&jb(f);return D}}}},Y=function(f){var e;c.logMouse&&c.logMouse(f);if(k)e=k.call(n,f);else if(a){e=!0;if(!u.editingComment){var p=u.viewNode.mousePos(f);0===(f.button||0)&&(b?(b=!1,c.releaseMouseCapture(),T.endRectSelection(p.x,p.y,f)):(d&&(d=!1,c.releaseMouseCapture()),
T.endTextSelection(p.x,p.y,f)),e=!1)}a=!1}!1===e&&jb(f);return e},ma=function(a){if(!u.editingComment&&c.isViewEventTarget(a.target))if(a.ctrlKey){if(!w.browserZoom)return 0<a.wheelDelta?OIT.document.zoomIn():0>a.wheelDelta&&OIT.document.zoomOut(),jb(a),!1}else c.on.beginscroll.dispatch(),void 0!==M&&ta(M),M=da(N,500)},N=function(){M=void 0;c.on.endscroll.dispatch()};c.setMouseCapture=function(a,b,d){c.releaseMouseCapture();"function"===typeof a&&(S.addEventListener("mousemove",J,!0),g=a);"function"===
typeof b&&(k=b);if(g||k)x.body.onmouseover(p),x.body.onmouseout(D);n=d};var J=function(a){if(g&&!1===g.call(n,a))return jb(a),!1},p=function(a){if(H){var b=la(a);if(b!==H.buttons&&H.buttons&1&&!(b&1)){var b=H,d;W.createEvent?(d=W.createEvent("MouseEvent"),d.initMouseEvent("mouseup",!0,!0,S,null,b.screenX,b.screenY,b.clientX,b.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.relatedTarget)):d=new MouseEvent("mouseup",{screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY,ctrlKey:a.ctrlKey,
shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:0,buttons:a.buttons,relatedTarget:a.relatedTarget,region:a.region});Y(d)}H=void 0}},D=function(a){H={buttons:la(a),screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}};c.releaseMouseCapture=function(){g&&(S.removeEventListener("mousemove",g,!1),g=null);k=null;x.body.offmouseover(p);x.body.offmouseout(D)};c.setTouchCapture=function(a,b,d,f){c.releaseTouchCapture();"function"===typeof a&&(x.listen("touchmove",ja,{capture:!0,
passive:!1}),r=a);"function"===typeof b&&(x.listen("touchend",Z,{capture:!0,passive:!1}),v=b);"function"===typeof d&&(x.listen("touchcancel",oa,{capture:!0,passive:!1}),t=d);q=f};var ja=function(a){r&&r.call(q,a)},Z=function(a){v&&v.call(q,a)},oa=function(a){t&&t.call(q,a)};c.releaseTouchCapture=function(){r&&(x.unlisten("touchmove",ja,!1),r=null);q=t=v=null};var Da=function(a){if(b){var d=u.viewNode.mousePos(a);T.extendRectSelection(d.x,d.y,a);return!1}return!0},ea=function(a){if(d){var b=u.viewNode.mousePos(a);
T.extendTextSelection(b.x,b.y,a);return!1}return!0};c.isViewEventTarget=function(a){for(var b=u.viewNode;a;){if(b.equals(a))return!0;if("TEXTAREA"===a.tagName||"SELECT"===a.tagName)break;if("oit-em_allheaders"===a.id)break;if(x.hasClass(a,"oit-emheadervalues")||x.hasClass(a,"oit-em_allheaders")||x.hasClass(a,"oit-note-icons")||x.hasClass(a,"oit-ssoverlay"))return!0;if(x.hasClass(a,"oit-button")||x.hasClass(a,"oit-note")||x.hasClass(a,"oit-expander"))break;a=a.parentNode}return!1};var la=function(a){var b;
if(void 0!==a.buttons)b=a.buttons;else switch(a.button){case 0:b=1;break;case 1:b=4;break;case 2:b=2;break;case 3:b=8;break;case 4:b=16}return b},wa=function(a){"text"===T.selectionType()&&T.select(null);z.deactivateAnnotation();var b=a.center;Q.activateNearest(b.x,b.y,a.srcEvent)},ra=function(a){e=!1;if(!u.editingComment){var c=a.center;u.viewNode.focus();e=!0;var f=w.selectionMode;"rect"===f||"cell"===f?(b=!0,T.startRectSelection(c.x,c.y)):"text"==f&&T.startTextSelection(c.x,c.y,"word",a)&&(d=!0)}},
qa=function(a){var c;if(b||d)b?(b=!1,c=a.center,T.endRectSelection(c.x,c.y,a.srcEvent)):d&&(d=!1,c=a.center,T.endTextSelection(c.x,c.y,a.srcEvent))},Fa=function(a){a.press||(a=u.viewNode,O=a.scroll(),f=A=0,h=a.scrollWidth-a.clientWidth,B=a.scrollHeight-a.clientHeight,F.startElasticScroll())},G=function(a){if(a.press)b?(a=a.center,T.extendRectSelection(a.x,a.y)):d&&(a=a.center,T.extendTextSelection(a.x,a.y));else if(O){var c=u.viewNode,e=a.delta,p=O.left-e.x,e=O.top-e.y,g=na(p,0,h),D=na(e,0,B);c.autoscroll(g,
D);a.kinetic||(A=p-g,f=e-D,(A||f)&&F.elasticScroll(A,f))}},Ca=function(a){a.press||(O=void 0,F.endElasticScroll(A,f),f=A=0)},Lb=function(a){C=w.zoom;c.on.beginpinchzoom.dispatch()},kb=function(a){C&&E.zoom(C*a.scale,a.center,!0)},P=function(a){C=void 0;c.on.endpinchzoom.dispatch()},Mb=function(a){R=w.rotation},U=function(a){if(void 0!==R){var b=R;a=Xb(180*a.rotation/Math.PI,"deg");60<a&&300>a&&(b=135>a?b+90:225>a?b+180:b+270);E.rotate(b)}},V=function(a){R=void 0}}}),ha=Aa.extend("content",{events:{data:{},
add:{},first:{},last:{}},install:function(c){var e=!1,a=!0,b=!1,d=[],g=[],k,n,r,v=0,t=!1,q=!1,m=null,l=[],K=function(){k&&(k.hide(),k=null)},M=function(a){a&&(g.push({data:a}),e&&!r&&(r=da(h,0)),(a=d.shift())&&a.destroy())},I=function(a){a={url:a,cache:!0,retryDelay:0,pendingText:""};a.ajax=ab({url:a.url,cache:a.cache,complete:R,args:[a]});g.push(a)};c.isPending=function(){return 0<g.length||0<l.length||!u.documentComplete};c.manifest=function(){return m};c.initializeContent=function(a,b,d){OIT.content&&
(M(OIT.content),delete OIT.content);d?(u.singlePageIndex=Number(d),b&&u.dynamicContent&&O(b)):b?(u.dynamicContent=!0,O(b)):a&&"none"!==a&&(u.dynamicContent=!0,C(a));e=!0;0<g.length&&!r&&(r=da(h,0))};var H=function(a){if(!n&&a){if((void 0===w.outputBaseUrl||null===w.outputBaseUrl||""===w.outputBaseUrl)&&w.detectBaseUrl&&"/"!=a[0]&&0!==a.search(/http/i)){var b=u.URL.lastIndexOf("/");if(-1!=b){b=u.URL.substr(0,b+1);if(0===b.search(/http/i)){var d=W.createElement("a");d.href=b;b=d.pathname||d.pathName;
"/"!=b[0]&&(b="/"+b)}0!==a.indexOf(b)&&(u.baseURL=b||null)}}n=u.baseURL}return n},O=function(a){if(a){var b=H(a);b&&"/"!=a.charAt(0)&&(a=Sa(b,a));0===u.URL.indexOf("file://")?(b=x.create("script"),b.attr("src",a),x.head.append(b),d.push(b)):I(a)}},C=function(a){if(a&&"none"!==a){var b=H(a);b&&"/"!=a.charAt(0)&&(a=Sa(b,a));I(a)}},R=function(b,d,f,e,h){h.status=e;404===e&&(f="");200===e||404==e?0===f.length||0===f.indexOf("%")?(f!==h.pendingText&&(h.pendingText=f,h.retryDelay=0),h.retryDelay>w.contentTimeout?
(K(),c.logAJAXError(null,"Timed out while loading the document content data from the server",b,Vb),eb(),g=[]):(a&&(k||(k=ua.createProgressDialog(U.PLEASE_WAIT_INITIALIZING,!1))),h.cache=!1,h.retryDelay+=200,da(function(){h.ajax=ab({url:h.url,cache:h.cache,complete:R,args:[h]})},200))):(A(h,f),K()):(K(),c.logAJAXError(null,"Failed to load the document content data from the server",b,e,f),eb(),g=[])};c.isICD=function(a){return"if(window.OIT&&OIT.icd)OIT.icd("==a.substring(0,31)};var A=function(a,b){var d,
f=b.indexOf("else OIT.content={");-1!=f?(f+=18,d=b.lastIndexOf("}"),-1!=d&&(b="{"+b.substring(f,d)+"}")):c.isICD(b)&&(f=31,d=b.lastIndexOf(");"),-1!=d&&(b=b.substring(f,d)));try{var e=JSON.parse(b);a.data=e;r||(r=da(h,0))}catch(N){c.logAJAXError(null,"Document data is corrupt ("+N+")",a.url,a.status,b)}},f=function(a){ab({url:a,complete:function(a,b,d,f){if(200==f)try{m=JSON.parse(d);var e=m.files?m.files.content:null;if(e){for(b=1;b<e.length;b++)l.push(e[b].url);h()}}catch(J){c.logAJAXError(null,
"The document manifest is corrupt ("+J+")",a,f,d),q=!1,m=null}else c.logAJAXError(null,"Failed to load the document manifest from the server",a,f,d),q=!1,m=null}})},h=function(){r=void 0;if(e&&!t&&0<g.length&&g[0].data){for(var d=a;0<g.length&&g[0].data;){var h=g.shift();if(h.data.info&&h.data.info.manifest&&u.dynamicContent){var k=h.data.info.manifest,m=H(k);m&&"/"!=k.charAt(0)&&(k=Sa(m,k));f(k);q=!0}B(h.data);a=!1;void 0===u.singlePageIndex?h.data.nextContent?q||O(h.data.nextContent):h.data.nextData?
q||C(h.data.nextData):b=!0:b=!0}d&&c.on.first.dispatch();c.on.add.dispatch();b&&c.on.last.dispatch()}for(;20>g.length&&0<l.length;)C(l.shift())},B=function(b){if(b){if(b.info&&b.info.version){var d=b.info.version.split("."),f=parseInt(d[0],10),e=parseInt(d[1],10),d=parseInt(d[2],10);0<f&&0<=e&&9>=e&&0<=d&&9>=d&&(v=f+e/10+d/100)}c.on.data.dispatch(b,a,v)}};c.processICD=function(a,b,d){if(c.isICD(a)){var f=a.lastIndexOf(");");if(-1!=f){a=a.substring(31,f);try{a=JSON.parse(a),B(a)}catch(ma){c.logAJAXError(null,
"ICD data is corrupt ("+ma+")",b,d,a)}}}};E.onreset(function(){r&&ta(r);K();e=!1;a=!0;b=!1;d=[];g=[];r=n=k=void 0;v=0;q=t=!1;m=null;l=[];u.singlePageIndex=void 0;c.on.add.reset()});Va.onbeginscroll(function(){t=!0});Va.onendscroll(function(){t=!1;h()});hb("icd",M)}}),E=Aa.extend("document",{exports:"cellRange cellSelection externalData externalValue find findAll getOptions getRawText getSelectedText highlight print properties rectRange rectSelection removeExtraEmailHeaders rotate select selection selectionMode selectionStyle selectionType setOptions showHidden textRange textSelection updateViewSize zoom zoomIn zoomOut".split(" "),
events:{load:{pub:!0,detail:function(){return{url:u.URL}},onAdd:function(c,e){u.documentLoaded&&da(function(){c.dispatchTo(e)},0)}},reset:{},unload:{pub:!0},zoom:{pub:!0,detail:function(c,e,a){return{zoom:c,mode:e}}},rotate:{pub:!0,detail:function(c){return{angle:c}}},resize:{},idle:{pub:!0,onListen:function(){E.resetIdleTimer()},onUnlisten:function(){E.resetIdleTimer()},onAdd:function(){E.resetIdleTimer()},onRemove:function(){E.resetIdleTimer()}},error:{pub:!0,detail:function(c,e){return{message:c,
fatal:!!e}}},select:{pub:!0,detail:function(c,e,a,b,d){c={selection:c,empty:b};e&&a&&(c.start=e,c.end=a);void 0!==d&&(c.highlightid=d);return c}},scroll:{pub:!0,detail:function(c,e,a,b){e=u.viewNode;c=z.mapToPage(0,0);e=z.mapToPage(e.clientWidth,e.clientHeight);return c&&e?{viewUpperLeft:{pageIndex:c.page.index,x:c.x,y:c.y},viewLowerRight:{pageIndex:e.page.index,x:e.x,y:e.y}}:{viewUpperLeft:{pageIndex:0,x:0,y:0},viewLowerRight:{pageIndex:0,x:0,y:0}}}},scrollupdate:{delay:200},keydown:{pub:!0,detail:function(c){return{srcEvent:c}}},
optionschanged:{pub:!0,detail:function(c){return c}},showmessage:{pub:!0,detail:function(c,e,a){return{message:c||"",modal:e||!1,progress:a||!1}}},progress:{pub:!0,detail:function(c){return{percentDone:c||0}}},hidemessage:{pub:!0},done:{pub:!0},hiddencontent:{pub:!0,detail:function(c,e){var a={},b,d;for(d=0;d<e.length;d++)b=e[d],b.supported&&c[b.name]&&(w[b.option]!==b.optionValue?(a.supportedNotVisible||(a.supportedNotVisible=[]),a.supportedNotVisible.push(U[b.message])):(a.supportedVisible||(a.supportedVisible=
[]),a.supportedVisible.push(U[b.message])));for(d=0;d<e.length;d++)b=e[d],!b.supported&&c[b.name]&&(a.unsupported||(a.unsupported=[]),a.unsupported.push(U[b.message]));return a}},ajax:{pub:!0,single:!0,detail:function(c){return{request:c}}},ajaxabort:{pub:!0,single:!0,detail:function(c){return{request:c}}},highlight:{pub:!0,detail:function(c,e,a,b){return{highlights:c,searchTerm:e,style:a,properties:b}}}},install:function(c){var e=[.1,.25,.5,.75,1,1.25,1.5,2,3,5,10,20,40],a=e[0],b=e[e.length-1],d=
["rows","columns","all","none"],g=[{name:"hidden-pages",supported:!0,message:"HIDDEN_CONTENT_PAGES",option:"showHiddenSheets",optionValue:!0},{name:"hidden-columns",supported:!0,message:"HIDDEN_CONTENT_COLUMNS",option:"showHiddenColumns",optionValue:!0},{name:"hidden-rows",supported:!0,message:"HIDDEN_CONTENT_ROWS",option:"showHiddenRows",optionValue:!0},{name:"hidden-text",supported:!0,message:"HIDDEN_CONTENT_TEXT",option:"showAnnotations",optionValue:!0},{name:"comments",supported:!0,message:"HIDDEN_CONTENT_COMMENTS",
option:"showAnnotations",optionValue:!0},{name:"tracked-changes",supported:!0,message:"HIDDEN_CONTENT_TRACKED_CHANGES",option:"showAnnotations",optionValue:!0},{name:"speaker-notes",supported:!0,message:"HIDDEN_CONTENT_SPEAKER_NOTES",option:"showSlideNotes",optionValue:!0},{name:"hidden-slides",supported:!0,message:"HIDDEN_CONTENT_SLIDES",option:"presentationMode",optionValue:"normal"},{name:"comments-unsupported",supported:!1,message:"HIDDEN_CONTENT_COMMENTS"},{name:"hidden-text-unsupported",supported:!1,
message:"HIDDEN_CONTENT_TEXT"},{name:"tracked-changes-unsupported",supported:!1,message:"HIDDEN_CONTENT_TRACKED_CHANGES"},{name:"large-sheet-unsupported",supported:!1,message:"HIDDEN_CONTENT_LARGE_SHEET"}],k=!1,n,r,v,t=!1,q=0,m,l,K={},M={},I,H,O,C={},R,A=[],f={},h,B=!1,y,L=0,ca;c.properties=function(){if(u.documentLoaded)return Ua(K)};c.externalValue=function(a){if(u.documentLoaded)return M[a]};c.externalData=function(){if(u.documentLoaded)return M};c.revisions=function(){return ca};c.getOptions=
function(a){if(void 0===a){a=w.items();var b={},d;for(d in a)w.isPublic(d)&&(b[d]=w[d]);b.showSlideComments=b.showAnnotations;return b}if(a&&"string"==typeof a&&("showSlideComments"===a&&(a="showAnnotations"),w.isPublic(a)))return w[a]};c.setOptions=function(a){if(a){for(var b in a){"showSlideComments"===b&&(b="showAnnotations");var d=a[b];w.isPublic(b)&&w[b]!=d&&(w[b]=d)}qa()}};Va.onbeginpinchzoom(function(a,b){k=!0});Va.onendpinchzoom(function(){k=!1;c.dispatchPageEvents(!0);fb()});var Y=function(d){d<
a?d=a:d>b&&(d=b);return d};c.zoom=function(a,b,d){if("number"===typeof a){var f=Y(a);f!=a&&(d||c.invalidArg("zoom","zoom",a,"using fallback zoom factor "+f,!1),a=f);if(w.zoomMode||a!=w.zoom)w.zoom=a,w.zoomMode=null,c.dispatchPageEvents(!1,b)}else"string"===typeof a?a!=w.zoomMode&&(w.zoomMode=a,c.dispatchPageEvents(!1,b)):"undefined"===typeof a||d||c.invalidArg("zoom","zoom",a);return w.zoom};c.zoomIn=function(){for(var a=0;a<e.length;a++)if(e[a]>w.zoom){c.zoom(e[a]);break}return w.zoom};c.zoomOut=
function(){for(var a=e.length-1;0<=a;a--)if(e[a]<w.zoom){c.zoom(e[a]);break}return w.zoom};c.rotate=function(a){"number"===typeof a?w.rotation=Xb(a,"deg"):void 0!==a&&c.invalidArg("rotate","angle",a,"Angle must be an integer multiple of 90 degrees.");return w.rotation};c.showHidden=function(a){u.documentLoaded&&!u.documentUnloading&&F.features().showhidden&&(void 0!==a&&-1==d.indexOf(a)?c.invalidArg("showHidden","mode",a,"Must be one of "+JSON.stringify(d)):F.showHidden(a))};var ma=[{name:"searchTerm",
type:["string","RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"direction",type:"string",legal:["up","down"],def:"down"},{name:"startACC",type:"number"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];c.find=function(a,b,d,f,e){if(u.documentLoaded&&!u.documentUnloading){var p=c.processArguments("find",arguments,ma);p&&da(oa,0,{finder:ia.findStart(p.searchType,p.searchTerm,
p.caseSensitive,p.direction,e),callbackFn:p.callbackFn})}};var N=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"searchType",type:"string",legal:"string dtsearch lucene phsterms literal literal*".split(" "),def:"string"}];c.findAll=function(a,b,d){if(u.documentLoaded&&!u.documentUnloading){var f=c.processArguments("findAll",arguments,N);f&&c.findAllArgs(f)}};c.findAllArgs=function(a){u.documentLoaded&&
!u.documentUnloading&&a&&c.on.idle.listenOnce({finder:ia.findStart(a.searchType,a.searchTerm,a.caseSensitive),callbackFn:function(b){var d=!0;if(!b){if(a.callbackFn)try{a.callbackFn.call(null)}catch(Hb){c.logError("findAll","Exception in callback function: "+Hb)}d=!1}else if(a.callbackFn)try{var f=ia.getRawText(b.range.acc,b.range.accend),d=a.callbackFn.call(null,b.range,f)}catch(Hb){c.logError("findAll","Exception in callback function: "+Hb),d=!1}!1!==d&&(d=!0);return d},startIterationFn:null,endIterationFn:null},
Da)};c.getRawText=function(a){u.documentLoaded&&(Pa(a)?da(ea,0,{callbackFn:a,textBlockIndex:0}):c.invalidArg("getRawText","callbackFunction",a,"must be a function"))};var J=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"style",type:"string",req:!0},{name:"callbackFn",type:"function"},{name:"caseSensitive",type:"boolean",def:!0},{name:"properties",type:"object"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];c.highlight=
function(a,b,d,f,e){if(u.documentLoaded)if(!1===ia.hasRawText())c.logError("highlight","Search functionality has been disabled for this document");else if(Q)if(!1===F.features().highlights)c.logError("highlight","Highlighting functionality is not available for this document type");else if("object"===typeof b){var p=b,p={searchTerm:a,style:p.style,searchType:p.mode||"string",properties:p.properties,callbackFn:p.callbackFn,caseSensitive:!1!==p.caseSensitive,visible:!1!==p.visible,enableUserDelete:!1!==
p.enableUserDelete,enableUserMove:!1!==p.enableUserMove,enableUserResize:!1!==p.enableUserResize,enableUserComment:!1!==p.enableUserComment,stemAll:!0===p.stemAll,stemmer:p.stemmer};c.highlightArgs(p)}else(p=c.processArguments("highlight",arguments,J))&&c.highlightArgs(p);else c.logError("highlight","Highlighting functionality has been disabled for this document")};c.highlightArgs=function(a){u.documentLoaded&&a&&(a.batchStarted=!1,a.highlights=[],a.complete=!1,a.iteration=0,c.on.idle.listenOnce({finder:ia.findStart(a.searchType,
a.searchTerm,a.caseSensitive,"down",void 0,a.stemAll,a.stemmer),callbackFn:function(b){var d=!0;if(b){var f;if(b.terms){f=[];for(var e=0;e<b.terms.length;e++)f.push(b.terms[e].range);f=Q.add(a.style,f,a.properties)}else f=Q.add(a.style,b.range,a.properties);a.highlights.push(f);!1===a.visible&&Q.hide(f);if(!1===a.enableUserDelete||!1===a.enableUserMove||!1===a.enableUserResize||!1===a.enableUserComment)e={},!1===a.enableUserDelete&&(e.enableUserDelete=!1),!1===a.enableUserMove&&(e.enableUserMove=
!1),!1===a.enableUserResize&&(e.enableUserResize=!1),!1===a.enableUserComment&&(e.enableUserComment=!1),Q.setOptions(f,e);if(a.callbackFn)try{var p=ia.getRawText(b.range.acc,b.range.accend),d=a.callbackFn.call(null,b.range,f,a.highlights,a.searchTerm,a.style,a.properties,p)}catch(Db){c.logError("findAll","Exception in callback function: "+Db),d=!1}}else{if(a.callbackFn)try{a.callbackFn.call(null,null,null,a.highlights,a.searchTerm,a.style,a.properties)}catch(Db){c.logError("findAll","Exception in callback function: "+
Db)}d=!1}!1!==d&&(d=!0);d||(a.batchStarted&&Q.endBatch(),a.complete=!0,c.on.highlight.dispatch(a.highlights,a.searchTerm,a.style,a.properties));return d},startIterationFn:function(b){F.suspendUpdate();a.iteration++},endIterationFn:function(){!a.complete&&!a.batchStarted&&2<=a.iteration&&(Q.beginBatch(),a.batchStarted=!0);F.resumeUpdate()}},Da))};c.select=function(a,b){if(u.documentLoaded){var d=!1;if(!1===ia.hasRawText())c.logError("select","Javascript selection functionality has been disabled for this document");
else if(null===a)d=T.select(null);else if(Ba(a)||Ra(a))d=T.select(a);else{var f=xa(a,!0,!0);f?(d=c.selection(),d=0!==Na(f,d),!1!==b?z.movetoEx(f,{callbackFn:function(){T.select(f)},animate:!1}):T.select(f)):c.invalidArg("select","range",a,"must be a valid text range, cell range, or rect range")}return d}};c.selectionType=function(){if(u.documentLoaded)return T.selectionType()};c.selectionMode=function(a){a&&(w.selectionMode=a);return w.selectionMode};c.selectionStyle=function(a){var b;void 0!==a&&
null!==a&&"string"!==typeof a?c.invalidArg("selectionStyle","style",a,"Must be a valid CSS string"):b=T.style(a);return b};c.selection=function(){var a;if(u.documentLoaded)switch(T.selectionType()){case "text":a=T.textSelection();break;case "cell":a=T.cellSelection();break;case "rect":a=T.rectSelection()}return a};c.textSelection=function(){if(u.documentLoaded)return T.textSelection()};c.cellSelection=function(){if(u.documentLoaded)return T.cellSelection()};c.rectSelection=function(){if(u.documentLoaded)return T.rectSelection()};
c.getSelectedText=function(){if(u.documentLoaded)return F.getSelectedText()};c.textRange=function(){return pa.apply(this,arguments)};c.cellRange=function(){return sa.apply(this,arguments)};c.rectRange=function(){return mb.apply(this,arguments)};c.updateViewSize=function(){ka.dispatchResize()};var p=function(){if(F.features().fitpage){var a=90==w.rotation||270==w.rotation,b,d=F.padding();b=F.margin();var c=d.left+d.right+b.left+b.right,d=d.top+d.bottom+b.top+b.bottom;a?(a=F.maxPageHeight(),b=F.maxPageWidth()):
(a=F.maxPageWidth(),b=F.maxPageHeight());var a=a+z.annotationPaneWidth(),f=u.viewNode;return{w:Y((f.clientWidth-c)/a),h:Y((f.clientHeight-d)/b)}}};c.dispatchPageEvents=function(a,b){!1!==a&&(a=!0);if(u.documentLoaded&&!B){var d;if(w.zoomMode){var f=1;if(d=p()){switch(w.zoomMode){case "page":f=Math.min(d.w,d.h);break;case "pagewidth":f=d.w;break;case "pageheight":f=d.h;break;case "mobile":switch(u.deType){case "page":f=d.h<d.w&&d.h>=.9*d.w?d.h:d.w;break;case "drawing":f=(f=ka.infoRaw())&&1557===f.fi?
d.w:Math.min(d.w,d.h);break;case "slide":case "chart":case "bitmap":f=Math.min(d.w,d.h)}}f=Y(f)}w.zoom=f}else if(u.nochrome||u.isMobile)if(d=p())d=Math.min(d.w,d.h),w.zoom<d&&(w.zoom=d);d=w.zoom;var f=I!=d||H!=w.zoomMode,e=O!=w.rotation;if(a||f||e)F.layoutChanged(b),ka.invalidateCanvas(),u.drawing&&u.drawing.update(!0);if(a||f)I=d,H=w.zoomMode,c.on.zoom.dispatch(d,w.zoomMode,k);if(a||e)O=w.rotation,c.on.rotate.dispatch(w.rotation);ka.dispatchScroll(a)}};var D=function(){c.dispatchPageEvents(!0)};
c.pauseIdleTimer=function(a){q++;1==q&&c.resetIdleTimer()};c.resumeIdleTimer=function(a){0<q&&(q--,0==q&&c.resetIdleTimer())};c.resetIdleTimer=function(){var a;n&&(ta(n),n=null);r&&(Qa(r),r=null);c.on.idle.hasListeners()&&u.documentLoaded&&!u.documentUnloading&&0===q?(t||(a=c.resetIdleTimer,x.listen("mousemove",a,!0),x.listen("touchmove",a,!0),x.listen("keydown",a,!0),c.onscroll(a),t=!0),n=da(function(){r=wb(function(){c.on.idle.dispatch(!1)},50,c.on.idle)},200),v||(v=wb(function(){c.on.idle.dispatch(!0)},
200,c.on.idle))):(v&&(Qa(v),v=null),a=c.resetIdleTimer,x.unlisten("mousemove",a),x.unlisten("touchmove",a),x.unlisten("keydown",a),c.offscroll(a))};var ja=function(){var a=F.pageRect(z.count()-1,"overlay");a&&(a=a.bottom-20*(z.count()-1),c.printCSS(".oit-view-root","height:"+a+"px;"));for(;void 0!==L;)if(z.on.change.disable(),a=z.page(L))if(a.overlay&&!a.overlay.isHidden()){a.load(!0,Z);L=void 0;break}else L++;else{if(!u.documentComplete)break;c.logFatalError(null,"No visible pages were found in the document");
L=void 0;break}},Z=function(a){z.moveto(a.index);u.documentLoaded=!0;c.on.load.dispatch();u.documentLoading=!1;z.on.change.enable();z.dispatchChange(void 0,!0);c.dispatchPageEvents(!0);u.documentComplete&&c.on.done.dispatch();c.resetIdleTimer()};c.installDocument=function(a,b){var d=!0,f=x.create("div");f.html(b);(f=f.byClass("oit-view-root"))&&0<f.length&&(f=f[0]);var e,p,g;f&&(e=f.data("icd"),p=f.data("json"),g=f.data("page"));if(!e&&!p||"none"==p)d="This document can't be loaded into the web view.",
ka.logFatalError("load","none"==p?d+" \nThe html file must be created in Ajax mode.":d+" \nThe html file does not appear to have been created by Web View Export.",b),d=!1;else{if(qc(a)){var f=W.URL,h=f.indexOf("//");if(-1===h)u.URL=a;else{var h=h+2,D=f.lastIndexOf("/"),f=-1!=D&&D>h?f.substr(0,D+1):f+"/";"/"===a[0]&&(h=f.indexOf("/",h)+1,f=f.substr(0,h));u.URL=Sa(f,a)}}else u.URL=a;ha.initializeContent(p,e,g);c.initializeDocument()}return d};c.unload=function(){var a=u.documentLoaded;u.documentUnloading=
!0;F.suspendUpdate();c.resetIdleTimer();try{F.unloadDisplay()}catch(Ca){c.logError("unload","Error while unloading display ("+Ca+")")}u.documentLoaded=!1;u.documentComplete=!1;u.hasHiddenText=!1;u.hasWorksheetRevisions=!1;try{T.reset()}catch(Ca){c.logError("unload","Error while resetting selection ("+Ca+")")}try{Q.clear()}catch(Ca){c.logError("unload","Error while clearing highlights ("+Ca+")")}try{cc()}catch(Ca){c.logError("unload","Error while aborting timers ("+Ca+")")}try{eb()}catch(Ca){c.logError("unload",
"Error while aborting AJAX requests ("+Ca+")")}try{c.on.reset.dispatch()}catch(Ca){c.logError("unload","Error while resetting view ("+Ca+")")}a&&c.on.unload.dispatch();w.zoom=1;w.zoomMode=null;k=!1;L=0;n&&(Qa(n),n=null);r&&(Qa(r),r=null);v&&(Qa(v),v=null);q=0;K={};M={};A=[];u.documentLoading=!1;f={};B=!1;ca=null;h&&(h.destroy(),h=null);y&&(y.destroy(),y=null);u.drawing&&(u.drawing.destroy(),u.drawing=void 0);m&&(m.destroy(),m=void 0);l&&(l.destroy(),l=void 0);(a=u.viewNode)&&a.html("");u.URL=W.URL;
ha.onadd(ja);u.documentUnloading=!1;F.resumeUpdate()};c.initializeDocument=function(){u.viewNode&&(u.drawing=new Yc(u.viewNode),l=new Cb("screen"),0<z.count()&&c.updateViewSize())};c.screenCSS=function(a,b){if(l)if(null===b)l.deleteRule(a);else if("string"==typeof b)l.setRule(a+"{"+b+"}",a);else if("object"==typeof b){var d=a+"{",c;for(c in b)d+=c+":"+b[c]+";";l.setRule(d+"}",a)}};c.printCSS=function(a,b){m||(m=new Cb("print"));if(null===b)m.deleteRule(a);else if("string"==typeof b)m.setRule(a+"{"+
b+"}",a);else if("object"==typeof b){var d=a+"{",c;for(c in b)d+=c+":"+b[c]+";";m.setRule(d+"}",a)}};var oa=function(){var a=ia.findNext(this.finder);if(a||!ha.isPending()&&!ia.isPending()){if(a){var b=ia.getRawText(a.range.acc,a.range.accend);this.callbackFn.call(null,a.range,b)}else this.callbackFn.call(null);ha.offadd(oa);ia.offadd(oa)}else ha.onadd(this,oa),ia.onadd(this,oa)},Da=function(){var a=!0,b=!1;if(!this.aborted){this.curACC||(this.curACC=0);if(this.startIterationFn){var d=100*this.curACC/
ia.lastACC();this.startIterationFn(d)}var f;S.performance&&(f=S.performance.now());for(d=0;;d++){var e=ia.findNext(this.finder);if(e){if(this.curACC=e.range.acc,!1===this.callbackFn.call(null,e)){a=!1;b=!0;break}}else{ha.isPending()||ia.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}if(20<=d)if(void 0!==f){if(0==d%20&&50<S.performance.now()-f)break}else if(100<=d)break}if(a)c.on.idle.listenOnce(this,Da);else if(b)ha.offadd(this,Da),ia.offadd(this,Da),this.aborted=!0;else if(ha.isPending()||
ia.isPending())ha.onadd(this,Da),ia.onadd(this,Da);this.endIterationFn&&this.endIterationFn()}},ea=function(){for(var a=!0,b=!1,d=0;10>d;d++){var c=ia.getRawTextBlock(this.textBlockIndex);if(c)if(c.text){var f=c.text,e=c.range.acc;if(void 0!==this.acc){var p=this.acc-c.range.acc;0<p&&(f=f.substring(p),e+=p)}this.acc=c.range.accend;if(!1===this.callbackFn.call(null,f,e)){a=!1;b=!0;break}this.textBlockIndex++}else{a=!1;break}else{ha.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}}a?da(ea,
50,this):b?(ha.offadd(ea),ia.offadd(ea)):(ha.onadd(this,ea),ia.onadd(this,ea))};c.removeExtraEmailHeaders=function(){w.removeExtraEmailHeaders=!0};c.externalLinks=function(){return A};var la=function(a,b){B=!0;c.setOptions({showHiddenSheets:b,showHiddenColumns:b,showHiddenRows:b,showAnnotations:b,showSlideNotes:b,presentationMode:b?"normal":"slideshow"});B=!1;z.updateShowSlideNotes();c.dispatchPageEvents(!0);wa();h.collapse();return!1};c.supressHiddenContentUpdate=function(){return B};var wa=function(){var a,
b;if("none"===w.showHiddenContentNotification)h&&h.css("display","none");else if(!u.staging&&h&&!B){var d=[],c=!1,e=!1;for(b=0;b<g.length;b++)a=g[b],a.supported&&f[a.name]&&(d.push("<li>",U[a.message],"</li>"),w[a.option]!==a.optionValue?c=!0:e=!0);var p=[];0<d.length&&(p.push(U.HIDDEN_CONTENT_NOTIFICATION,"<div><ul>"),Array.prototype.push.apply(p,d),p.push("</ul>"),c?p.push(U.HIDDEN_CONTENT_INVISIBLE,'</div><div><a class="oit-showhiddenlink">',U.HIDDEN_CONTENT_SHOWLINK,"</a></div>"):p.push(U.HIDDEN_CONTENT_ALREADY_VISIBLE,
'</div><div><a class="oit-hidehiddenlink">',U.HIDDEN_CONTENT_HIDELINK,"</a></div>"));var d=[],D=!1;for(b=0;b<g.length;b++)a=g[b],!a.supported&&f[a.name]&&(d.push("<li>",U[a.message],"</li>"),D=!0);0<d.length&&(0<p.length&&p.push("<div>&nbsp;</div>"),p.push(U.HIDDEN_CONTENT_ORIGINAL_APPLICATION,"<div><ul>"),Array.prototype.push.apply(p,d),p.push("</ul></div>"));p=p.join("");h.message(p);h.css("display",null);c||D?e?h.title(U.HIDDEN_CONTENT_PARTIAL):h.title(U.HIDDEN_CONTENT_HIDDEN):h.title(U.HIDDEN_CONTENT_VISIBLE);
"expanded"===w.showHiddenContentNotification?h.expand(!1):h.collapse(!1);if(c){if(a=h.byClass("oit-showhiddenlink"))a[0].onclick(null,la,!0),a[0].ontap(null,la,!0)}else if(a=h.byClass("oit-hidehiddenlink"))a[0].onclick(null,la,!1),a[0].ontap(null,la,!1)}w.showAnnotations?u.viewNode.addClass("oit-showannotations"):u.viewNode.removeClass("oit-showannotations")};c.hiddenContent=function(a){f[a]||(f[a]=!0,h||(h=new Dc({title:U.HIDDEN_CONTENT_HIDDEN,collapseButton:!0}),h.onexpand(function(){w.showHiddenContentNotification=
"expanded"}),h.oncollapse(function(){w.showHiddenContentNotification="collapsed"})),wa(),c.on.hiddencontent.dispatch(f,g))};c.documentException=function(a){};c.showNotifications=function(){wa()};var ra=function(a,b,d){C[d]=a;R||(R=da(qa,50))},qa=function(){if(R){var a=C;C={};ta(R);R=void 0;c.on.optionschanged.dispatch(a)}};c.print=function(){S.print()};ha.onadd(ja);ha.ondata(function(a,b,d){var f;if(a.properties)for(f in a.properties)K[f]=a.properties[f];if(a.external)for(f in a.external)M[f]=a.external[f];
if(a.options){for(var e in a.options)if(b=a.options[e],d=e.indexOf("."),0<d){var p=e.substring(0,d);e=e.substring(d+1);if("glob"==p||"opt"==p)d="glob"==p?u:w,d.hasOwnProperty(e)&&(d[e]=b)}u.hasHiddenText&&c.hiddenContent("hidden-text-unsupported");u.hasWorksheetRevisions&&c.hiddenContent("tracked-changes-unsupported")}if(a.info&&a.info.status)for(f in a.info.status)a.info.status[f]&&c.documentException(f);a.xlinks&&(A=A.concat(a.xlinks));a.revisions&&(ca=ca?ca.concat(a.revisions):a.revisions.slice(0))});
ha.onlast(function(){if(ca){for(var a=!1,b=!1,d=!1,f=!1,e=0;e<ca.length;e++){var p=ca[e],g=!0;b&&f||"add"!==p.type&&"delete"!==p.type?a&&d||"hidden"!=p.type||(g=!1):g=!1;if(!g){var h;p.range&&(h=z.forRange(p.range),h||(g=z.lastPage(),p.range.acc>g.accend&&(h=g)));h&&"page"===h.type?"add"===p.type||"delete"===p.type?b=!0:"hidden"===p.type&&(a=!0):"add"===p.type||"delete"===p.type?f=!0:"hidden"===p.type&&(d=!0)}}a&&c.hiddenContent("hidden-text");b&&c.hiddenContent("tracked-changes");d&&c.hiddenContent("hidden-text-unsupported");
f&&c.hiddenContent("tracked-changes-unsupported")}u.documentComplete=!0;u.documentLoaded&&c.on.done.dispatch()});ka.onresize(function(){u.editingComment?Q.alignComment():c.dispatchPageEvents(!0)});z.onchange(function(){1!=z.activeOverlay().length&&"vertical"==w.scrollMode||c.dispatchPageEvents(!0)});w.oncenterPages(D);w.onrotation(D);w.onshowHiddenSheets(wa);w.onshowHiddenColumns(wa);w.onshowHiddenRows(wa);w.onshowAnnotations(wa);w.onshowSlideNotes(wa);w.onpresentationMode(wa);w.onshowHiddenContentNotification(wa);
var D=w.items(),Fa;for(Fa in D)if(w.isPublic(Fa))w["on"+Fa](ra)}}),z=Aa.extend("pages",{exports:"count current info moveto movetoNext movetoPrev pageName ranges".split(" "),events:{change:{pub:!0,detail:function(c){return z.info(c.index)}},add:{pub:!0,detail:function(c){return{startPage:c}}},pageload:{},pageunload:{},overlayshow:{},overlayhide:{}},install:function(c){var e=[],a=[],b=null,d=null,g=null,k=0,n=1,r,v,t,q=0,m=0,l=0,K,M,I,H={},O={},C,R;c.firstPage=function(){var b,d;for(d in a){b=a[d];
break}return b};c.lastPage=function(){var b,d;for(d in a)b=a[d];return b};c.current=function(){return d?d.index:0};c.pageName=function(b){void 0===b&&(b=c.current());if(b=a[b])return b.name};c.count=function(){return a.length};c.each=function(b,d){yb(a,arguments)};c.eachOverlay=function(a,b){yb(e,arguments)};c.moveto=function(a,b){var d;Pa(b)&&(d={callbackFn:b});return c.movetoEx(a,d)};var A=function(a){c.updateActivePage(a.pageIndex);a.callbackFn&&a.callbackFn.call(null,d.index)};c.movetoEx=function(a,
b){b=b||{};u.viewNode.cancelKinetic();if("number"===typeof a)return b.pageIndex=a,h(b);if("object"===typeof a){if(x.isElement(a)||x.isText(a)){b.gotoNode=a;var f=b,e=c.forNode(f.gotoNode);e?(f.pageIndex=L(e.index),f.pageIndex!=e.index&&(f.gotoNode=null),h(f)):(c.logError("moveto","The specified node was not found on any page in the document."),A(f));return d.index}if(f=xa(a))return b.range=ga(f),B(b);if("number"===typeof a.left&&"number"===typeof a.top&&"number"===typeof a.right&&"number"===typeof a.bottom)return b.rect=
a,y(b)}c.logError("moveto","Invalid destination: "+Gb(a));return d.index};var f=function(a,d){var f=a.overlay,e=f!==b;if(!d&&!e)return!1;if(e){Q.deactivate();T.select(null);F.unloadDisplay();var p=b,g=u.viewNode;p&&(p.saveScroll=g.scroll(),p.undisplay());f.display()}a.load(!1,function(){b=f;c.updateActivePage(a.index);e&&F.loadDisplay(a)});f.show();f.hasClass("oit-pagestream")?u.viewNode.addClass("oit-pagestream"):u.viewNode.removeClass("oit-pagestream");f.hasClass("oit-emailfill")?u.viewNode.addClass("oit-emailfill"):
u.viewNode.removeClass("oit-emailfill");p=a.css("background")||null;u.viewNode.css("background",p);f.saveScroll?(g.scroll(f.saveScroll),delete f.saveScroll):e&&g.scroll(0,0);f.display();c.updateActivePage();return!0},h=function(e){var p=L(e.pageIndex);if(a[p])if(e.force||e.gotoNode||!d||p!=d.index){var g=a[p];c.touchPage(p);if(g.isLoaded()){p=f(g,e.force);"sn"==g.type&&(w.showSlideNotes=!0);if("vertical"!=w.scrollMode||p)e.animate=!1;c.updateActivePage(g.index);"email"!==g.type&&F.moveto(d.index,
A,e)||A(e)}else g.load(!0,function(){e.force=!0;h(e)}),"email"!==g.type&&g.overlay===b?F.moveto(g.index,null,{animate:!1}):b||f(g)}else e.pageIndex=d.index,A(e);else 0<=p&&ha.isPending()?ha.on.add.listenOnce(function(){h(e)}):(c.logError("moveto","Invalid page index: "+p),void 0!==u.singlePageIndex&&(e.pageIndex=u.singlePageIndex),A(e));if(d)return d.index},B=function(a){if(u.documentLoading)da(B,0,null,a);else{var b=c.nearestForRange(a.range);if(b)if(b.isPending())f(b),b.load(!0,function(){B(a)});
else if(!d||b.overlay!==d.overlay||"vertical"!=w.scrollMode&&b!==d)b.overlay.show(),h({pageIndex:b.index,callbackFn:function(){B(a)}});else{if("sn"==b.type){w.showSlideNotes=!0;var e=c.page(b.index-1);"slide"==e.type&&e.hiddenFromSlideshow&&(w.presentationMode="normal")}else"slide"==b.type&&b.hiddenFromSlideshow&&(w.presentationMode="normal");F.loadRange(a.range,function(){if(!F.moveto(a.range,A,a))if(c.inAnnotation(a.range)){var d=b.annotationPane();d&&d.activate(a.range,!0,!1,a.callbackFn)}else(d=
F.rangeRect(a.range,"view"))?(a.rect=d,y(a)):(a.pageIndex=b.index,h(a))})}else ha.isPending()?ha.on.add.listenOnce(function(){B(a)}):(c.logError("moveto","The specified range was not found in the document: "+Gb(a.range)),A(a))}return d.index},y=function(a){var b=a.rect,c=u.viewNode,f=c.scroll(),e=F.scrollPadding(),p=b.left+f.left,g=b.right+f.left,h=b.top+f.top,l=b.bottom+f.top,k=f.left,B=f.left+c.clientWidth,m=f.top,y=f.top+c.clientHeight;e&&(e.left&&(k+=e.left),e.right&&(B-=e.right),e.top&&(m+=e.top),
e.bottom&&(y-=e.bottom));var b=f.left,q=f.top;!0===a.moveToTop?q=h:h<m?(l-=c.clientHeight,0>l&&(l=0),m=20,e&&e.top&&(m+=e.top),q=h-m,q<l&&(q=l)):l>y&&(m=20,e&&e.bottom&&(m+=e.bottom),q=l+m-c.clientHeight,q>h&&(q=h));p<k?(g=p-c.clientWidth,0>g&&(g=0),m=20,e&&e.left&&(m+=e.left),b=p-m,b<g&&(b=g)):g>B&&(m=20,e&&e.right&&(m+=e.right),b=g+m-c.clientWidth,b>p&&(b=p));b!=f.left||q!=f.top?(E.on.scrollupdate.disable(),f=u.deType,f=!a.moveToTop&&"worksheet"!=f&&"database"!=f,a.animate||(f=!1),f=f?150:0,c.abortAnimation(),
c.animate({scrollLeft:b,scrollTop:q,time:f,endFn:function(){E.on.scrollupdate.enable();E.on.scrollupdate.dispatch();A(a)}})):A(a);return d.index};c.movetoPrev=function(a){var b=c.prev();b?c.moveto(b.index,a):a&&a.call(null,d.index);return d.index};c.movetoNext=function(a){var b=c.next();b?c.moveto(b.index,a):a&&a.call(null,d.index);return d.index};c.info=function(b){void 0===b&&(b=c.current());if(a[b])return a[b].info()};c.next=function(b,c){var f;void 0===b&&(b=d.index);var e=b+1;!1!==c&&a[e]&&"email"==
a[b].type&&"rt"==a[e].type&&e++;if(a[e])for(;e<a.length;e++){var p=a[e];if(p&&p.isEnabled()&&!p.overlay.isHidden()&&("sn"!=p.type||w.showSlideNotes)){f=p;break}}return f};c.prev=function(b,c){var f;void 0===b&&(b=d.index);var e=b-1;!1!==c&&a[e]&&a[e-1]&&"email"==a[e-1].type&&"rt"==a[e].type&&e--;if(a[e])for(;0<=e;e--){var p=a[e];if(p&&p.isEnabled()&&!p.overlay.isHidden()&&("sn"!=p.type||w.showSlideNotes)){f=p;break}}return f};var L=function(b){var d,c;for(c=b;c<a.length;c++)if((d=a[c])&&d.isEnabled()&&
!d.overlay.isHidden())return c;for(c=b;0<c;c--)if((d=a[c])&&d.isEnabled()&&!d.overlay.isHidden())return c;return 0};c.loadNextPageFromServer=function(){var d,c;c=F.visiblePages();if(0===c.length)return!1;var f=c[0].index,e=c[c.length-1].index;0>n?(f-=3,e+=1):e+=3;0>f&&(f=0);e>=a.length&&(e=a.length-1);if(0>n){if(void 0===r||r>e)r=e;for(;r>=f;r--)(c=a[r])&&c.overlay===b&&c.isPending()&&(c.load(!1),d=!0)}else{if(void 0===r||r<f)r=f;for(;r<=e;r++)(c=a[r])&&c.overlay===b&&c.isPending()&&(c.load(!1),d=
!0)}return d};c.updateActivePage=function(a){if(b){var f=d,e=u.viewNode.scroll().top;void 0!==a?f=c.page(a)||d:1==b.length?f=b.firstPage:"vertical"==w.scrollMode&&void 0===u.singlePageIndex&&e!=k&&(a=c.mapToPage(10,20,void 0,!0))&&(f=a.page);e!=k&&(n=e<k?-1:1,k=e);if(f!=d){d=f;b=d.overlay;f=F.visiblePages();for(e=0;e<f.length;e++)c.touchPage(f[e].index);c.dispatchChange(d)}}};c.page=function(b){return a[b]};c.byName=function(b){var d,c;for(c in a)if(a[c].name===b){d=a[c];break}return d};c.forNode=
function(a){return x.wrap(a).ancestorData("page")};c.nearestForRange=function(b){var d,f,e,p=c.pagesForRange(b);if(!p&&"text"===b.type)for(f=0;f<a.length;f++)if((e=a[f])&&"drawing"===e.type&&b.accend>=e.acc&&b.acc<=e.accend){p=[e];break}if(p)if(1==p.length)d=p[0];else if((f=F.visiblePages())&&0<f.length){var g=f[0].index,h=f[f.length-1].index,l;for(f=0;f<p.length;f++)if(e=p[f],e.isEnabled()){var k=e.index,B=0;k<g?B=g-k:k>h&&(B=k-h);!d||B<l?(d=e,l=B):0===B&&(k=F.rangeRect(b,"view"))&&0>k.bottom&&(d=
e,l=B)}}return d};c.forRange=function(b,d,c){var f;if(b)switch(d=d||0,!0!==c&&(c=!1),b.type){case "text":for(;d<a.length;d++){var e=a[d];if(e&&b.accend>=e.acc&&b.acc<=e.accend&&(!0!==c||"worksheet"!==e.type&&"database"!==e.type&&"email"!==e.type||e.isLoaded()||e.load(),e.containsRange(b))){f=e;break}}break;case "cell":case "rect":b.page>=d&&b.page<a.length&&(f=a[b.page])}return f};c.inAnnotation=function(b){var d=!1;if("text"==b.type)for(var c=0;c<a.length;c++){var f=a[c];if(f&&b.accend>=f.acc&&b.acc<=
f.accend&&f.inAnnotation(b)){d=!0;break}}return d};c.pagesForRange=function(b,d){for(var f,e=0;e<a.length;){e=c.forRange(b,e,d);if(!e)break;f||(f=[]);f.push(e);e=e.index+1}return f};c.top=function(){var a=F.visiblePages();if(a&&0<a.length)return a[0].index};c.bottom=function(){var a=F.visiblePages();if(a&&0<a.length)return a[a.length-1].index};c.mapToPage=function(f,e,g,h,l,k){var p;if(g)p=g.pageRect("view");else if(d){g=d;if(g.isHidden()||"sn"===g.type&&!w.showSlideNotes)(g=c.next(d.index))||(g=
c.prev(d.index));var B=!0;!0!==h&&"email"==g.type&&(B=!1,0===g.index&&(g=2<=a.length?a[1]:null));g&&(p=g.pageRect("view"));if("vertical"==w.scrollMode&&void 0===u.singlePageIndex&&1<b.length)for(;p;)if(e<p.top){h=c.prev(g.index,!1)||g;if(h===g||0===g.index||!B&&0===h.index)break;if(h.overlay!=g.overlay)break;var m=h.pageRect("view");if(e>m.bottom){p.top-e>e-m.bottom&&(g=h,p=m);break}g=h;p=m}else if(e>p.bottom){if(g.index==a.length-1)break;h=c.next(g.index,!1)||g;if(h===g||h.overlay!=g.overlay)break;
m=h.pageRect("view");if(e<m.top){m.top-e<e-p.bottom&&(g=h,p=m);break}g=h;p=m}else break}B=!1;if(g){if(l&&(f>p.right||f>u.viewNode.clientWidth)&&g.annotationPane()){l=u.viewNode;m=l.pos(x.body);h=f+m.left;var m=e+m.top,y=g.annotationPane().contentRect(x.body);y&&(h=h+l.scrollLeft-y.left,m=m+l.scrollTop-y.top,k||0<=h&&0<=m&&h<=y.width&&m<=y.height)&&(f=h,e=m,B=!0)}if(!B&&(p&&(f-=p.left,e-=p.top),F.features().zoom&&(p=w.zoom,1!=p&&(f=P(f/p),e=P(e/p))),F.features().rotate&&(k=w.rotation,0!==k)))switch(p=
g.pageRect(),l=f,h=e,k){case 90:f=p.width-h;e=l;break;case 180:f=p.width-l;e=p.height-h;break;case 270:f=h,e=p.height-l}return{page:g,x:f,y:e,inAnnotation:B}}};c.elementRect=function(a,b){var d;d=new ba(a.rect(u.viewNode),"view");d.origin=b;return d};c.findTextRange=function(c){if("text"===c.type){var f;if("vertical"!=w.scrollMode||void 0!==u.singlePageIndex)void 0!==d.acc&&c.acc<=d.accend&&c.accend>=d.acc&&(f=d.findTextRange(c));else for(var e in a){var g=a[e];if(g.overlay===b&&g.isLoaded()&&g.isEnabled()&&
void 0!==g.acc&&c.acc<=g.accend&&c.accend>=g.acc&&(g=g.findTextRange(c)))if(f)for(var p=0;p<g.length;p++)f.push(g[p]);else f=g}return f}};var ca=function(a,b,d){var c=!1;if(d)if(Array.isArray(d))for(var f=0;f<d.length&&!(c=ca(a,b,d[f]));f++);else d.range&&"text"===d.range.type&&a<=d.range.accend&&b>=d.range.acc&&(c=!0);return c};c.isAnnotationText=function(a,b,d){var f=!1;if(d)for(var e=0;!f&&e<d.length;e++)f=d[e],f=ca(a,b,f.text)||ca(a,b,f.oldtext)||ca(a,b,f.author)||ca(a,b,f.author_short)||ca(a,
b,f.last_save_date)||ca(a,b,f.create_date)||ca(a,b,f.date);else(d=E.revisions())&&(f=c.isAnnotationText(a,b,d)),!f&&R&&(f=c.isAnnotationText(a,b,R.revisions));return f};c.isDocumentText=function(a,b){return c.forRange(pa(a,b),0,!0)?!0:c.isAnnotationText(a,b)};c.maxWidth=function(){if(b)return"vertical"!=w.scrollMode||void 0!==u.singlePageIndex?d.width:b.maxWidth};c.maxHeight=function(){if(b)return"vertical"!=w.scrollMode||void 0!==u.singlePageIndex?d.height:b.maxHeight};c.decomposeRange=function(b,
d){var c;if(void 0!==b.page){var f=a[b.page];if(f){if("rect"===b.type)c=f.mapRectRangeToText(b);else if("cell"===b.type){var e=f.spreadsheetModel();e&&(c=e.decomposeRange(b,d))}(f=f.mapRangeToEmbeds(b))&&(c=c?c.concat(f):f)}}return c};c.ranges=function(b){var d={};void 0===b&&(b=c.current());a[b]&&(b=a[b].textRanges())&&0<b.length&&(d.text=b);return d};var Y=function(){if(u.dynamicContent){switch(w.memoryModel){case "none":l=m=0;break;case "large":m=5242880;l=100;break;case "small":m=1048576;l=20;
break;case "micro":m=524288;l=10;break;default:u.isMobile?(m=1048576,l=20):(m=5242880,l=100)}c.applyMemoryLimit()}else l=m=0};c.applyMemoryLimit=function(a){var b,d=0;if(K)for(b=K;b;)0<b.loadedSize&&d++,b=b.nextNewer;void 0!==a&&(q+=a,c.logMemory&&c.logMemory(q,m,d,l));if(0<m&&q>m||0<l&&d>l){if(K){b=K;var f=a=-1,e=F.visiblePages();0<e.length&&(a=e[0].index,f=e[e.length-1].index);for(;b;){e=b.nextNewer;if(0<b.loadedSize&&!b.locked&&(b.index<a||b.index>f)&&(q-=b.loadedSize,b.unload(),d--,q<=m&&d<l))break;
b=e}}c.logMemory&&c.logMemory(q,m,d,l)}};c.touchPage=function(b){(b=a[b])&&b!=M&&(void 0===M?K=b:(b==K&&(K=b.nextNewer),b.nextNewer&&(b.nextNewer.nextOlder=b.nextOlder),b.nextOlder&&(b.nextOlder.nextNewer=b.nextNewer),M.nextNewer=b,b.nextOlder=M,b.nextNewer=void 0),M=b)};var ma=function(){var a,d;d=(d=c.firstPage())&&d.isSpreadsheet();if(void 0===u.singlePageIndex&&(d||1<e.length)){v||(v=new Zc,v.addPrevNext(function(){c.movetoPrev()},function(){c.movetoNext()}));for(d=v.length();d<e.length;d++){a=
e[d];var f=a.firstPage;if(!f)break;v.addTab(a.name,a.hidden,c.moveto,f.index);a.isHidden()&&v.hideTab(a.index)}v.show();b&&v.setActiveTab(b.index);if(R){f=[];if(w.showAnnotations)for(d=0;d<R.revisions.length;d++)a=R.revisions[d],!a.page&&a.ref&&void 0!==a.ref.sheet&&(a.page=c.page(a.ref.sheet)),a.page&&("add_sheet"==a.type?f[a.page.overlay.index]="oit-anno-add":f[a.page.overlay.index]||(f[a.page.overlay.index]="oit-anno-change"));for(d=0;d<e.length;d++){var g=f[d];g||(a=e[d],1==a.length&&a.firstPage.comments()&&
(g="oit-anno-change"));v.tabClass(d,g)}}}else v&&(v.destroy(),v=null)};c.dispatchChange=function(a,b){a||(a=d);if(a==g&&!b)return!0;g=a;v&&v.setActiveTab(a.overlay.index);a.annotationPane()&&a.supportsAnnotationBar()&&c.createAnnotationBar();return c.on.change.dispatch(a)};c.overlayById=function(a){return bb(e,"id",a)};c.pageById=function(b){return bb(a,"id",b)};c.createAnnotationBar=function(){t||(t=new $c)};c.activeOverlay=function(){return b};c.activePage=function(){return d};c.ssRevisions=function(){return R};
var N=function(){ma();k=void 0};c.updateShowSlideNotes=function(){if(!E.supressHiddenContentUpdate()){var a=F.saveScrollPos();w.showSlideNotes?E.screenCSS(".oit-sn","display:block;"):(E.screenCSS(".oit-sn",null),d&&"sn"==d.type&&(Q.deactivate(),T.select(null)));c.updateActivePage();F.layoutChanged();F.restoreScrollPos(a)}};c.overlayTabRect=function(a){if(v)return v.tabRect(a.index)};c.activeAnnotationPane=function(a){if(void 0!==a&&a!==C){var b=C;C=null;b&&b.deactivate();C=a}return C};c.deactivateAnnotation=
function(){c.activeAnnotationPane(null)};c.scrollToAnnotationPane=function(a){if(w.showAnnotations&&c.activePage()&&c.activePage().supportsAnnotationPane()){var b=u.viewNode;b.animate({scrollLeft:b.scrollWidth-b.clientWidth,endFn:a})}else a&&a()};c.annotationPaneWidth=function(){return w.showAnnotations&&b&&b.hasAnnotations()&&b.firstPage.supportsAnnotationPane()?338:0};var J=function(){!0===w.showHiddenSheets?c.eachOverlay(function(a){a.firstPage&&"worksheet"==a.firstPage.type&&a.show()}):!1===w.showHiddenSheets&&
c.eachOverlay(function(a){a.hidden&&a.firstPage&&"worksheet"==a.firstPage.type&&a.hide()})};w.onmemoryModel(Y);w.onnochrome(N);w.onshowSlideNotes(c.updateShowSlideNotes);w.onscrollMode(function(){k=void 0});w.onshowHiddenSheets(J);w.onshowSlideNotes(function(){!1===w.showSlideNotes&&"vertical"!==w.scrollMode&&"sn"===c.activePage().type&&c.movetoPrev()});w.onshowAnnotations(ma);w.onannotationSort(function(){b&&b.each(function(a){(a=a.annotationPane())&&a.applySort()})});E.onreset(function(){for(var c in a){var f=
a[c],h=f;q-=h.loadedSize;h.unload();f.destroy()}a=[];aa(e,"destroy");e=[];g=d=b=null;k=0;n=1;v&&(v.destroy(),v=null);t&&(t.destroy(),t=null);I&&(I.destroy(),I=void 0,H={},O={});m=q=0;R=M=K=r=void 0});ha.ondata(function(b,d,f){var g;if(f=b.style){I||(I=new Cb);var h=[],p=[];for(d=0;d<f.length;d++){var l=f[d];if("string"===typeof l)p.push(l);else if(l.s&&l.p){var k=l.s,l=l.p;"@font-face"===k?H.hasOwnProperty(l)||(H[l]=!0,h.push(k,"{",l,"}")):O.hasOwnProperty(k)||(O[k]=!0,p.push(k,"{",l,"}"))}}0<h.length&&
I.addCSSText(h.join(""));0<p.length&&I.addCSSText(p.join(""))}if(b.overlays)for(d=0;d<b.overlays.length;d++)f=b.overlays[d],c.overlayById(f.oid)||e.push(new Hc(e.length,f));if(b.pages){g=a.length;for(d=0;d<b.pages.length;d++){f=b.pages[d];h=null;"email"===f.type&&(u.singlePageIndex=void 0);if(void 0!==f.index){if(p=parseInt(f.index,10),void 0===u.singlePageIndex||u.singlePageIndex===p)a[p]||(a[p]=new nb(p,f.type,f.id)),h=a[p]}else h=new nb(a.length,f.type,f.id),a.push(h);h&&h.processData(f)}c.applyMemoryLimit()}b.attachments&&
(d=c.page(0))&&(d._attachments=b.attachments.slice(0));if(b.ssrevisions&&b.ssrevisions.revisions){R=b.ssrevisions;R.revisions.sort(function(a,b){return a.seq-b.seq});f=null;for(d=0;d<R.revisions.length;d++)if(h=R.revisions[d],void 0!==Ob[h.type]&&E.hiddenContent("tracked-changes"),h.cells)for(p=0;p<h.cells.length;p++)if(k=h.cells[p],k.text)for(l=0;l<k.text.length;l++)f=Eb(f,k.text[l].range);f?ia.loadRawText(f.acc,f.accend,function(){c.each("processSSRevisions");ma()}):(c.each("processSSRevisions"),
ma())}b.revisions&&c.each("processRevisions");J();ma();void 0!==g&&a.length>g&&c.on.add.dispatch(g)});ha.onadd(function(){c.updateActivePage()});E.onscrollupdate(c.updateActivePage);E.onload(function(){Y();N();c.updateShowSlideNotes()});Va.onendscroll(c.updateActivePage);T.onselectionchanged(function(a,b){if(w.showAnnotations){var d=c.activeAnnotationPane();if(a){var f=c.nearestForRange(a);f&&f.annotationPane()&&(d=f.annotationPane())}d&&b&&d.activate(a,!1,!1)}});c.onoverlayshow(function(a){v&&v.showTab(a.index)});
c.onoverlayhide(function(a){v&&v.hideTab(a.index);!d||d.isEnabled()&&!d.overlay.isHidden()||(a=L(d.index),c.moveto(a))})}}),Q=Aa.extend("highlights",{exports:"activate active add addMultiple addNote addStamp apply autoHighlight autoHighlightOptions clear comment current deactivate defineStamp first getJSON hide hideComment isHidden label last logVisibleHighlights moveto movetoNext movetoPrev next prev properties property range redact remove serialize setOptions show showComment style type validateStyles".split(" "),
events:{activate:{pub:!0,detail:function(c,e,a){return{highlightid:c?c.id:void 0,before:e,after:a}}},add:{pub:!0,detail:function(c){return{highlightid:c.id}}},remove:{pub:!0,detail:function(c){return{highlightid:c.id}}},move:{pub:!0,detail:function(c){return{highlightid:c.id}}},comment:{pub:!0,detail:function(c){return{highlightid:c.id}}},mode:{pub:!0,detail:function(c){return{autohighlight:c,autooptions:Q.autoHighlightOptions(),selectionmode:E.selectionMode()}}}},userEventDef:{pub:!0,detail:function(c,
e,a){return{highlightid:a.id,srcEvent:e}}},install:function(c){var e={},a=function(a){var b=a.toLowerCase();e[a]={w:"border"+a+"Width",c:"border"+a+"Color",wp:"border-"+b+"-width",cp:"border-"+b+"-color",sp:"border-"+b+"-style"}};a("Top");a("Right");a("Bottom");a("Left");var b=0,d=[],g=0,k=0,n,r,v,t,q=-1,m=-1,l,K,M=!1,I=!1,H,O=!1,C=!1,R,A={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0},f=!0,h=
[],B=!1,y={x:0,y:0},L=[];c.add=function(){var a=arguments,b=1,d={};ta(0,a,d,"add");d.invalid||(b=sa(b,a,d,"add"));d.invalid||(Array.isArray(d.range)?d.type="hl-"+d.range[0].type:Ra(d.range)||Ba(d.range)?d.type="hl-text":d.type="hl-"+d.range.type,Aa(0,a,d,"add"));d.invalid||(b=va(b,a,d,"properties","add"),b=ya(b,a,d,"comment","add"));d.invalid||ua(b,a,d,"add");if(!d.invalid)return qa(d)};c.addMultiple=function(a,b,d,f){var e=arguments,g=1,h={},p,l;ta(0,e,h,"addMultiple");if(!h.invalid){if(Array.isArray(b)){for(l=
0;l<b.length;l++){if(!xa(b[l])){h.invalid=!0;break}if(p&&p!=b[l].type){h.invalid=!0;break}p=b[l].type}g++}else h.invalid=!0;p||(h.invalid=!0);h.invalid&&c.invalidArg("addMultiple","rangeList",null,"Must be an array of ranges")}h.invalid||(h.type="hl-"+p.type,Aa(0,e,h,"addMultiple"));h.invalid||va(g,e,h,"properties","addMultiple");if(!h.invalid){e=[];c.beginBatch();for(l=0;l<b.length;l++)h.range=xa(b[l]),g=qa(h),e.push(g),f&&c.setOptions(g,f);c.endBatch();return e}};c.addNote=function(){var a=arguments,
b=1,d={type:"note"};ta(0,a,d,"addNote");d.invalid||(b=sa(b,a,d,"addNote"));d.invalid||("cell"!==d.range.type&&"rect"!==d.range.type&&(c.invalidArg("addNote","range",d.range,"Anchored notes may only be added to rect or cell ranges"),d.invalid=!0),Aa(0,a,d,"addNote"));d.invalid||(b=va(b,a,d,"properties","addNote"),b=ya(b,a,d,"comment","addNote"));d.invalid||ua(b,a,d,"addNote");if(!d.invalid)return qa(d)};c.redact=function(){var a,b=arguments,c={type:"redaction"};a=sa(0,b,c,"redact");c.invalid||(a=va(a,
b,c,"properties","redact"),a=ya(a,b,c,"label","redact"));c.invalid||ua(a,b,c,"redact");if(!c.invalid){if("compound"===w.redactionMode||"hybrid"===w.redactionMode&&"cell"===c.range.type)c.compound=!0;a:{a=c;b=!1;a.range.embedId?b=!1:"hybrid"===w.redactionMode?b="rect"===a.range.type:"simple"===w.redactionMode&&(b="rect"===a.range.type||"cell"===a.range.type);if(b){var f=z.decomposeRange(a.range);if(f){var c=[],e=a.range,g=z.page(e.page),h=F.rangeRect(e,g),p=a.activate;a.activate=!1;for(b=0;b<f.length;b++){a.range=
f[b];var l=Fa(a);-1==c.indexOf(l)&&c.push(l)}if("drawing"===g.type||"slide"===g.type||"chart"===g.type){f=0===c.length;if(!f)for(b=0;b<c.length;b++)if(l=d[c[b]].range,"rect"!==l.type){f=!0;break}else if(l=F.rangeRect(l,g),!l||!l.equals(h)){f=!0;break}f&&(a.range=e,c.unshift(Fa(a)))}if(0<c.length){p&&da(c[0]);1==c.length&&(c=c[0]);a=c;break a}}}a=qa(a)}return a}};c.apply=function(a,b){if(!Array.isArray(a)){try{a=JSON.parse(a)}catch(ad){c.invalidArg("apply","highlights",a,"Error parsing JSON string: "+
ad.message);return}a&&a.range&&"object"==typeof a.range&&(a=[a])}if(Array.isArray(a))if(u.documentLoaded){b=Pa(b)?b:null;for(var d=0;d<a.length;d++){var f=a[d];if("sdef"==f.type)c.defineStamp(f.stamp,f.url);else{var e=na();if(!b||b(e,f.properties))if(xa(f.range))if(e=[],"stamp"==f.type){var g={name:f.stamp};f.opacity&&(g.opacity=f.opacity);f.sizing&&(g.sizing=f.sizing);e.push(g);e.push(f.range);f.hasOwnProperty("properties")&&e.push(f.properties);f.hasOwnProperty("comment")&&e.push(f.comment);c.addStamp.apply(void 0,
e)}else qa(f);else c.invalidArg("apply","highlight["+d+"]",f)}}}else n=n?a.concat(n):a};c.remove=function(a,b){if(Array.isArray(a)){c.beginBatch();for(var d=0;d<a.length;d++)c.remove(a[d]);c.endBatch()}else(d=ba(a,l,"remove"))&&ca(d,b)};var ca=function(a,b){var f=a.id;void 0===b&&(b=!0);c.on.remove.dispatch(a);var e,h=!1,p=!1;f==l?(lb(b),l=void 0,void 0!=a.prevId?(e=a.prevId,p=!0):void 0!=a.nextId&&(e=a.nextId,h=!0)):b=!1;c.hideComment(f);c.unmap(a);a.destroy();d[f]=null;g--;f<k&&(k=f);void 0!==e&&
da(e,h,p,b,!1,!1)};c.removeFromRange=function(a){Array.isArray(a)?aa(a,c.removeFromRange):"text"===a.type&&c.each(Y,null,a)};var Y=function(a,b){var d=a.range;"text"===d.type&&d.accend>=b.acc&&d.acc<=b.accend&&c.remove(a.id,!1)};c.count=function(){return g};c.clear=function(a){a=Pa(a)?a:null;lb();c.each(ca,a,!1);a||(l=void 0,d=[],k=g=0,L=[])};a=function(){var a=w.highlightLabelFontFamily,b=w.highlightLabelFontSize,d="";a&&(d+="font-family:"+a+";");b&&(d+="font-size:"+b+";");E.screenCSS(".oit-highlight-label",
d);c.each("showLabel",null,w.showHighlightLabels)};c.setOptions=function(a,b){b&&ia(a,l,"setOptions",null,[b])};c.getOption=function(a,b){return ia(a,l,"getOption",null,[b])};c.style=function(a,b){var d,f=ba(a,l,"style");if(f)if(b){var e=la(b,"hl-text"!=f.type);e?d=f.style(e):c.invalidArg("style","style",b)}else d=f.style();return d};c.comment=function(a,b,d){if(a=ba(a,l,"comment")){var f=a.comment();void 0!==b&&b!==f&&(d||a.id!==c.active()||a.isNote()?f=a.comment(b):(c.hideComment(),f=a.comment(b),
c.showComment()),c.on.comment.dispatch(a));return f}};var ma=function(a){if("scale"==a||"stretch"==a||"image"==a)return a},N=function(a){if(a&&!isNaN(a)&&(a=Number(a),0<=a&&1>=a))return a},J=function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y))return{x:Math.round(a.x),y:Math.round(a.y)}},p=function(a){a.img=new Image;a.img.src=a.url;a.img.onload=function(){a.height=this.height;a.width=this.width;a.defaultSize&&(this.style.width=a.defaultSize.x,this.style.height=a.defaultSize.y);delete a.img}};c.stamp=function(a){if(t)return t[a]};
c.label=function(a,b){return ia(a,l,"label",null,[b])};c.defineStamp=function(a,b,d){t||(t={});b?(d=d||{},b={url:b},d.sizing&&(b.sizing=ma(d.sizing)),d.opacity&&(b.opacity=N(d.opacity)),d.defaultSize&&(b.defaultSize=J(d.defaultSize)),t[a]=b,p(t[a])):delete t[a]};var D=function(a){var b;if(a){var d;if(a instanceof String||"string"==typeof a)d={name:a};else{d={};for(var c in a)d[c]=a[c]}d.name&&t&&t[d.name]&&(d.type="stamp",d.stamp=t[d.name],b=d)}return b};c.addStamp=function(){var a,b=arguments,d=
D(b[0]);if(d){d.sizing=ma(d.sizing)||d.stamp.sizing||"scale";d.opacity=N(d.opacity)||d.stamp.opacity||1;d.defaultSize=J(d.defaultSize)||d.stamp.defaultSize;var f;f=sa(1,b,d,"addStamp");var e=d.range;e&&"rect"!=e.type&&"cell"!=e.type?(c.invalidArg("addStamp","range",e),d.invalid=!0):"rect"===e.type&&Nb(e)?d.range=Da(e.left,e.top,"rect",d):"cell"===e.type&&e.c1==e.c2&&e.r1==e.r2&&(d.range=Da(e.c1,e.r1,"cell",d));d.invalid||(f=va(f,b,d,"properties","addStamp"),f=ya(f,b,d,"comment","addStamp"));ua(f,
b,d,"addStamp");d.invalid||(a=qa(d))}else c.invalidArg("addStamp","stamp",b[0],"Must be the name of a defined stamp");return a};c.getJSON=function(a){if(a=ba(a,l,"getJSON"))return JSON.stringify(a.serialize())};c.serialize=function(a){var b=[],d,f;Pa(a)?d=a:Array.isArray(a)?f=a:"number"===typeof a&&(f=[a]);c.each(ja,d,b,{},f);return JSON.stringify(b,null,!1)};var ja=function(a,b,d,c){c&&-1==c.indexOf(a.id)||(a=a.serialize(),a.stamp&&!d[a.stamp]&&(b.push({type:"sdef",stamp:a.stamp,url:t[a.stamp].url}),
d[a.stamp]=!0),b.push(a))};c.properties=function(a,b){return ia(a,l,"properties",null,[b])};c.property=function(a,b,d){return ia(a,l,"property",null,[b,d])};c.current=function(){return l};c.active=function(){if(!M&&!I)return l};c.moveto=function(a){(a=ba(a,l,"moveto"))&&da(a.id,!1,!1,!0,!0,!0);return l};c.movetoNext=function(a){if(void 0===l)void 0!==r&&c.moveto(r);else{var b=l;if(M&&d[b].filter(a)&&ea(b))return c.moveto(b);for(;;){b=d[b].nextId;if(void 0===b)break;var f=d[b];if(f.filter(a)&&(f=z.nearestForRange(f.range)))return f.isLoaded()?
da(b):z.moveto(f.index,function(){c.movetoNext(a)}),b}}return l};c.movetoPrev=function(a){if(void 0===l)void 0!==v&&c.moveto(v);else{var b=l;if(I&&d[b].filter(a)&&ea(b))return c.moveto(b);for(;;){b=d[b].prevId;if(void 0===b)break;var f=d[b];if(f.filter(a)&&(f=z.nearestForRange(f.range)))return f.isLoaded()?da(b):z.moveto(f.index,function(){c.movetoPrev(a)}),b}}return l};c.type=function(a){if(a=ba(a,l,"type"))switch(a.type){case "note":case "redaction":case "stamp":return a.type;default:return"highlight"}};
c.range=function(a){if(a=ba(a,l,"range"))return a.range};c.show=function(a){if(void 0===a||Pa(a))c.beginBatch(),c.each(function(a){U(a)},a),c.endBatch();else if(Array.isArray(a)){c.beginBatch();for(var b=0;b<a.length;b++){var d=ba(a[b]);d&&U(d)}c.endBatch()}else ia(a,l,"show")};c.hide=function(a){if(void 0===a||Pa(a))c.beginBatch(),c.each(function(a){V(a)},a),c.endBatch();else if(Array.isArray(a)){c.beginBatch();for(var b=0;b<a.length;b++){var d=ba(a[b]);d&&V(d)}c.endBatch()}else ia(a,l,"hide");c.alignHighlight()};
c.isHidden=function(a){return ia(a,l,"isHidden")};c.logVisibleHighlights=function(){var a=c.first();if(void 0===a)console.log("No visible highlights.");else for(;void 0!==a;){var b=d[a];console.log("["+b.id+"]: range="+JSON.stringify(b.range)+", key="+JSON.stringify(b.key));a=c.next(a)}};c.showComment=function(a,b){Array.isArray(a)&&(a=a[0]);var f=ba(a,l,"showComment");if(f){b=b||{};b.mode||(b.mode="view");var e=c.active();if(void 0!==e&&(e=d[e],e.isNote()&&e.isEditing()))return;if(f.isNote())switch(b.mode){case "view":f.show();
f.endEditText(!0);break;case "edit":f.beginEditText(!1);break;case "new":f.beginEditText(!0)}else f.dialog(b.mode)}};c.hideComment=function(a){(a=ba(a,l,"hideComment"))&&(a.isNote()?a.collapse():a.hideDialog())};c.first=function(){return r};c.last=function(){return v};c.next=function(a){if(a=ba(a,l,"next"))return a.nextId};c.prev=function(a){if(a=ba(a,l,"prev"))return a.prevId};c.activate=function(a){(a=ba(a,l,"activate"))&&da(a.id)};c.deactivate=function(){lb(!0)};var Z=function(a){if(a)for(var b in A)void 0!==
a[b]&&(A[b]=a[b]);T.enableCellOffsets("note"===O||"stamp"===O);oa();c.on.mode.dispatch(O)};c.autoHighlightOptions=function(a){void 0!==a&&Z(a);a={};for(var b in A)a[b]=A[b];return a};c.autoHighlight=function(a,b){var d;if(!1===a){T.select(null);if(R){d=F.features();switch(R){case "text":d.textselection||(R=null);break;case "rect":d.rectselection||(R=null);break;case "cell":d.cellselection||(R=null);break;default:R=null}R&&(E.selectionMode(R),R=null)}O=!1;Z()}else if("selection"===a||"note"===a||"redaction"===
a||"stamp"===a){b=b||{};A.comment=null;A.sticky=!1;A.properties=null;T.select(null);if("stamp"===a){if(!D(b.stamp))return c.invalidArg("autoHighlight","options.stamp",b.stamp),O=!1}else if(("selection"===a||"note"===a)&&!la(b.style,!0))return c.invalidArg("autoHighlight","options.style",b.style),O=!1;O=a;R||(R=E.selectionMode());if("note"===a||"redaction"===a||"stamp"===a)d=F.features(),d.rectselection||"redaction"===a&&d.rectredaction?E.selectionMode("rect"):d.cellselection&&E.selectionMode("cell");
Z(b)}return O};c.pauseAutoHighlight=function(a){C=!!a};c.beginBatch=function(){b++};c.endBatch=function(){0<b&&b--};c.batchMode=function(){return 0<b};var oa=function(){if("selection"===O||"note"===O)T.style(A.style,!1);else if("redaction"===O){var a;w.redactionFillColor&&"compound"===w.redactionMode&&"rect"===E.selectionMode()?a=w.redactionFillColor:(a=Ga(w.redactionColor),.7<a.a&&(a.a=.7),a=Ja(a.r,a.g,a.b,a.a));T.style("background-color:"+a+";",!1)}else if("stamp"===O)if(t&&(a=t[A.stamp]),a){var b=
"background:url("+a.url+") no-repeat";"number"===typeof a.opacity&&1!=a.opacity&&(b+=";opacity:"+a.opacity);"scale"==a.sizing?b+=";background-size:contain":"stretch"==a.sizing&&(b+=";background-size:100% 100%");T.style(b)}else T.style(null);else T.style(null)},Da=function(a,b,d,c){var f,e;c&&(c.defaultSize&&(f=c.defaultSize.x,e=c.defaultSize.y),f||(f=c.width),e||(e=c.height));f||(f=200);e||(e=200);a=z.mapToPage(a,b);c&&(a.x-=Math.floor(f/2),a.y-=Math.floor(e/2));return F.rangeFromRect(a.page.index,
a.x,a.y,a.x+f,a.y+e,a.page,"move")},ea=function(a){return"slideshow"!=w.presentationMode?!0:(a=xa(d[a].range))&&z.nearestForRange(a)?!0:!1};c.startSelection=function(){K=c.active();lb(!1)};c.endSelection=function(){K=void 0};E.onselect(function(a,b,f,e,g){var h=!0;if(a&&O&&!C){var p=a,l="note"===O,k="stamp"===O;if(l&&!F.features().anchorednotes||(l||k)&&"text"===p.type&&!e)return!0;a=l||!0===A.comment;if(e)if((l||k)&&f&&void 0===K){var B;k&&((b=D(A.stamp))?B=b.stamp:p=null);p&&(b=F.features(),p=b.rectselection?
Da(f.x,f.y,"rect",B):b.cellselection?Da(f.x,f.y,"cell",B):null);p||T.select(null)}else T.select(null),p=null;else l&&b&&f&&"rect"===p.type&&(B=p.bottom-p.top,100>p.right-p.left&&(b.x<f.x?p.right=p.left+100:p.left=p.right-100),80>B&&(b.y<f.y?p.bottom=p.top+80:p.top=p.bottom-80));if(p&&void 0===g){var m;"text"===p.type&&(p=W.getSelection());"redaction"===O?m=c.redact(p,A.properties,A.label):k?!D(A.stamp)||"rect"!==p.type&&"cell"!==p.type?T.select(null):m=c.addStamp(A.stamp,p,A.properties):l?"rect"===
p.type||"cell"===p.type?m=c.addNote(A.style,p,A.properties):T.select(null):m=c.add(A.style,p,A.properties);if(void 0!==m){f=Array.isArray(m)?m:[m];g="string"===typeof A.comment?A.comment:void 0;for(h=0;h<f.length;h++)m=d[f[h]],m.setOptions(A),g&&m.comment(g);T.select(null);c.activate(f[0]);a&&c.showComment(f,{mode:"new"});h=!1;A.sticky||c.autoHighlight(!1)}}}return h});c.alignComment=function(){c.each("alignDialog")};F.ondisplayload(function(a,b){q=a.index;m=b.index;c.eachOnPage("addToPage",z.page(q));
m>q&&Q(q+1,m)});F.ondisplayunload(function(a,b){c.each("destroyDialog");m=q=-1});z.onpageload(function(a){"ss"!==a.type&&"db"!==a.type&&(-1!=m&&a.index>m&&(m=z.activeOverlay().lastPage.index),0<d.length&&a.index>=q&&a.index<=m&&c.eachOnPage(function(b){b.addToPage(a.index)},a))});z.onpageunload(function(a){a.index>=q&&a.index<=m&&(c.each("removeFromPage",null,a.index),a.highlightLayer=void 0)});c.onEmailHeaderResize=function(a){c.each("addToPage",null,a);c.positionAll(z.activeOverlay())};c.alignHighlight=
function(){void 0==l||M||I||da(l,!1,!1,!1,!1,!0)};c.move=function(a,b,d,c,f,e){var g;b=b||0;c=c||0;d=d||0;f=f||0;e=e||!1;if((a=ba(a))&&(b||c||d||f)&&a.getOption("enableUserMove")){var h=ga(a.range);if("rect"===h.type){e=e?1:10;var p=F.pageRange(h.page,h.type);h.left+=b*e;h.top+=d*e;h.right+=c*e;h.bottom+=f*e;e=h.right-h.left;g=h.bottom-h.top;b&&(0>h.left?(h.left=0,c&&(h.right=e)):h.left>=h.right&&(h.left=h.right-1));c&&(h.right<=h.left?h.right=h.left+1:h.right>p.right&&(h.right=p.right,b&&(h.left=
h.right-e,0>h.left&&(h.left=0))));d&&(0>h.top?(h.top=0,f&&(h.bottom=h.top+g)):h.top>=h.bottom&&(h.top=h.bottom-1));f&&(h.bottom<=h.top?h.bottom=h.top+1:h.bottom>p.bottom&&(h.bottom=p.bottom,d&&(h.top=h.bottom-g,0>h.top&&(h.top=0))))}else"cell"===h.type&&(p=F.pageRange(h.page,h.type),h.c1+=b,h.r1+=d,h.c2+=c,h.r2+=f,e=h.c2-h.c1,g=h.r2-h.r1,b&&(h.c1<p.c1?(h.c1=p.c1,c&&(h.c2=h.c1+e)):h.c1>h.c2&&(h.c1=h.c2)),c&&(h.c2<h.c1?h.c2=h.c1:h.c2>p.c2&&(h.c2=p.c2,b&&(h.c1=h.c2-e,h.c1<p.c1&&(h.c1=p.c1)))),d&&(h.r1<
p.r1?(h.r1=p.r1,f&&(h.r2=h.r1+g)):h.r1>h.r2&&(h.r1=h.r2)),f&&(h.r2<h.r1?h.r2=h.r1:h.r2>p.r2&&(h.r2=p.r2,d&&(h.r1=h.r2-g,h.r1<p.r1&&(h.r1=p.r1)))));a.setRange(h)}};var la=function(a,b){if(!f)return a;var d;if("string"==typeof a){d=[];var c=db(a,"color");c&&d.push("color:",c,";");(c=db(a,"background-color"))&&d.push("background-color:",c,";");if(!b)(c=db(a,"text-decoration"))&&d.push("text-decoration:",c,";");else if(b&&-1!=a.indexOf("border")){c=x.create("div");c.attr("style",a);c.css("display","none");
x.body.append(c);var e=c.computedStyle(c),h=wa(e,"Top"),g=wa(e,"Left"),p=wa(e,"Bottom"),l=wa(e,"Right");h.w&&h.w==p.w&&h.w==g.w&&h.w==l.w&&h.c==p.c&&h.c==g.c&&h.c==l.c?d.push("border:",h.w," solid ",h.c,";"):(ra(e,h,d),ra(e,g,d),ra(e,p,d),ra(e,l,d));c.destroy()}d=0===d.length?void 0:d.join("")}return d},wa=function(a,b){b=e[b];return{e:b,w:a[b.w],c:a[b.c]}},ra=function(a,b,d){b.w&&d.push(b.e.wp,",",b.w,";",b.e.sp,":solid;",b.e.cp,":",b.c,";")};c.map=function(a){if("text"===a.range.type){var b=L[a.range.acc];
void 0!==b?b instanceof Array?b.push(a.id):L[a.range.acc]=[b,a.id]:L[a.range.acc]=a.id}};c.unmap=function(a){if("text"===a.range.type){var b=L[a.range.acc];void 0!==b&&(b instanceof Array?1==b.length&&b[0]==a.id?delete L[a.range.acc]:Ka(b,a.id):b===a.id&&delete L[a.range.acc])}};var qa=function(a){var b,d,c,f,e;if(Array.isArray(a.range)){e=a.range;a.compound=e;f=e[0].acc;d=e[0].accend;for(b=1;b<e.length;b++)c=e[b],c.acc<f&&(f=c.acc),c.accend>d&&(d=c.accend);a.range=pa(f,d)}else if(Ra(a.range)||Ba(a.range)){e=
Bb(a.range);if(!e)return;if(!Array.isArray(e))return a.range=e,qa(a);a.compound=e;f=e[0].acc;d=e[0].accend;for(b=1;b<e.length;b++)c=e[b],c.acc<f&&(f=c.acc),c.accend>d&&(d=c.accend);a.range=pa(f,d)}if("text"===a.range.type){if((e=z.pagesForRange(a.range))&&2<=e.length){c=a.range;f=[];var h,g;for(b=0;b<e.length;b++)d=e[b],d.overlay!=g?(h=pa(d.acc,d.accend),f.push(h),g=d.overlay):(d.acc<h.acc&&(h.acc=d.acc),d.accend>h.accend&&(h.accend=d.accend));if(1<f.length){h=[];for(b=0;b<f.length;b++)a.range=f[b],
a.range.acc<c.acc&&(a.range.acc=c.acc),a.range.accend>c.accend&&(a.range.accend=c.accend),g=Fa(a),-1==h.indexOf(g)&&h.push(g);return 0===h.length?void 0:1==h.length?h[0]:h}}}else if("rect"===a.range.type&&(d=z.page(a.range.page))&&d.isEmailHeader())return;return Fa(a)},Fa=function(a){var b;if("text"===a.range.type){var f,e=a.properties,p=a.comment,l=a.label;null===e&&(e=void 0);null===p&&(p=void 0);null===l&&(l=void 0);var k=L[a.range.acc];if(void 0!==k)if(k instanceof Array)for(var B=0;B<k.length;B++){if(f=
d[k[B]],f.matches(a.style,a.range,e,p,l)){b=f;break}}else f=d[k],f.matches(a.style,a.range,e,p,l)&&(b=f)}else b=void 0;if(!b){"text"===T.selectionType()&&T.select(null);f="rect"===a.range.type||"cell"===a.range.type;e=na();switch(a.type){case "redaction":b=new bd(e,a);break;case "note":f&&(b=new cd(e,a));break;case "stamp":f&&(b=new dd(e,a));break;default:b=new cb(e,a)}if(!b)return;d[e]=b;g++;f=!0;c.batchMode()&&(f=(f=z.forRange(b.range))&&f.spreadsheetModel()?f.spreadsheetModel().containsRange(b.range):
!1);if(f){if(f=b,f.addToDocument(),(e=ka.infoRaw())&&1557===e.fi&&"text"==f.range.type)for(e=z.count(),p=0;p<e;p++)(l=z.page(p))&&!l.isLoaded()&&l.containsRange(f.range)&&X(p,!0,f)}else h.push({type:"add",highlight:b}),G();c.link(b)}c.on.add.dispatch(b);!0===a.activate?da(b.id):y&&(c.activateNearest(y.x,y.y,null,!1),y=null);return b.id},G=function(){B||(B=!0,E.onidle(fa))},Q=function(a,b){if(0!==d.length&&!c.batchMode())for(var f=a;f<=b;f++){var e=z.page(f);e&&e.isLoaded()&&(h.push({type:"addall",
pageIndex:f,loadPage:!1}),G())}},P=function(a,b){for(var d=h.length-1;0<=d;d--){var c=h[d];c.highlight!==a||b&&-1==b.indexOf(c.type)||h.splice(d,1)}},U=function(a){P(a);h.push({type:"show",highlight:a});G()},V=function(a){P(a);h.push({type:"hide",highlight:a});G()},X=function(a,b,d){h.push({type:"addtopage",pageIndex:a,loadPage:!!b,highlight:d});G()},fa=function(){F.suspendUpdate();var a=[],b;S.performance&&(b=S.performance.now());for(var f=0;0<h.length;f++){var e=h.shift();if(void 0!==e.pageIndex){var g=
z.page(e.pageIndex);if(g.isLoaded())if(void 0===e.highlight){if(g&&g.isLoaded())for(var p=0;p<d.length;p++){var l=d[p];l&&g.containsRange(l.range)&&X(e.pageIndex,!1,l)}}else e.highlight.addToPage(e.pageIndex);else if(!0===e.loadPage){var k=e;g.load(!1,function(){h.unshift(k);G()})}}else void 0!==e.highlight&&("show"===e.type&&e.highlight.isHidden()?e.highlight.show():"hide"===e.type?e.highlight.hide():(e.highlight.addToDocument(!1),a.push(e.highlight)));if(10<=f)if(void 0!==b){if(0==f%10&&50<S.performance.now()-
b)break}else if(20<=f)break}for(b=0;b<a.length;b++)c.link(a[b]);0===h.length&&B&&(B=!1,E.offidle(fa));F.resumeUpdate()};c.findNearest=function(a,b){if(void 0!==r){var c=z.mapToPage(a,b,null,!0,!0);if(c){var f=c.page;a=c.x;b=c.y;for(var e,h,g,p=0;p<d.length;p++){var l=d[p];if(l&&!l.isHidden()&&l.isOnPage(f.index)){var k=l.distanceFromPoint(f.index,a,b,c.inAnnotation);void 0!==k&&(0===k.x&&0===k.y?(e||(e=[]),e.push(l),h=k):!e&&(void 0===h||k.ay<h.ay||k.ay==h.ay&&k.ax<h.ax)&&(h=k,g=l))}}if(e)return{highlights:e,
distance:h};if(g)return{highlights:[g],distance:h}}}};c.activateNearest=function(a,b,f,e){var h=l,g=I,p=M;!1!==e&&(e=!0);if(void 0===r)y&&(y.x=a,y.y=b);else{var k=c.findNearest(a,b);if(k)if(h=void 0,p=g=!1,1<k.highlights.length){var B=c.active();if(void 0!==B)for(var m=0;m<k.highlights.length;m++)if(k.highlights[m].id==B){++m>=k.highlights.length&&(m=0);h=k.highlights[m].id;break}void 0===h&&(h=k.highlights[0].id)}else h=k.highlights[0].id,g=k.distance,p=0>g.y||0===g.y&&0>g.x,g=0<g.y||0===g.y&&0<
g.x;else{if(k=z.mapToPage(a,b,null,!0,!0))for(m=k.page,h=r;void 0!==h;h=d[h].nextId)if((k=z.forRange(d[h].range))&&k.index>=m.index){B=k;break}B||(h=v,B=z.forRange(d[h].range));B.index<m.index?g=!0:p=!0}}if(h!=l||g!=I||p!=M)return!1!==e||p||g?f||p||g||(p=!0):p=!0,da(h,p,g,!0,!1),c.active()};var lb=function(a){da(void 0,!1,!1,a)},da=function(a,b,f,e,h,g){var p;if(!H&&(a=(p=ba(a))?p.id:void 0,!0!==b&&(b=!1),!0!==f&&(f=!1),!1!==h&&(h=!0),(p=a!=l||b!=M||f!=I)&&(g=!1),p||g)){void 0!==a&&c.isHidden(a)&&
(a=void 0);if(!g){if(p=d[l])p.hideDialog(),p.deactivate();p=l;l=a;void 0!==p&&d[p]&&d[p].isEmptyRedaction()&&c.remove(p,!0);M=b;I=f}if(void 0!==l&&!b&&!f&&d[l]){p=d[l];if(h){z.moveto(p.range,function(){da(a,b,f,e,!1,!0)});return}if(p.isNote())T.select(null);else{H=p;T.select(p.range,p.id);h=ib(p.style());var k;h.color&&(k="color:"+h.color+";background-color: rgba(255,255,255,0);");T.hide(k);H=null}u.viewNode.focus();p.activate(g);p.comment()&&!p.isNote()&&c.showComment(p.id,{mode:"view"})}!1!==e&&
(p=ba(l),c.on.activate.dispatch(p,M,I))}};c.highlight=function(a){return d[a]};var ia=function(a,b,d,c,f){c=c||d;if(a=ba(a,b,d))return"string"==typeof c?a[c].apply(a,f):c.apply(null,f)},ba=function(a,b,f){var e;void 0===a&&(a=b);"number"===typeof a&&d[a]?e=d[a]:f&&c.invalidArg(f,"id",a);return e};c.link=function(a){var b=a.id;c.unlink(a,!0);if(!a.isHidden()){var f=a.generateKey();if(f)if(void 0===r)v=r=b;else for(var e=v;;){var h=d[e],g=h.key,p=!1;f.page>g.page?p=!0:f.page==g.page&&(f.y>g.y?p=!0:
f.y==g.y&&(f.x>g.x?p=!0:f.x==g.x&&b>e&&(p=!0)));if(p){e===v?v=b:(a.nextId=h.nextId,d[a.nextId].prevId=b);a.prevId=e;h.nextId=b;break}if(e===r){a.nextId=e;r=h.prevId=b;break}e=h.prevId}}};c.unlink=function(a,b){!0!==b&&a.id==l&&(lb(),l=void 0);if(void 0!==a.prevId||void 0!==a.nextId||r==a.id){var c=void 0!==a.prevId?d[a.prevId]:null,f=void 0!==a.nextId?d[a.nextId]:null;c?c.nextId=a.nextId:r=a.nextId;a.nextId=void 0;f?f.prevId=a.prevId:v=a.prevId;a.prevId=void 0}};c.positionAll=function(a){c.each("positionAll",
a);c.alignHighlight()};c.validateStyles=function(a){void 0!==a&&(f=!1!==a);return f};c.updateHighlights=function(){Q(q,m);c.positionAll(z.activeOverlay())};var na=function(){for(;k<d.length&&d[k];)k++;k>=d.length&&(k=d.length,d.push(null));return k};c.each=function(a,b){yb(d,arguments)};c.eachOnPage=function(a,b){aa(d,a,function(a){return b.containsRange(d[a].range)},b.index)};var sa=function(a,b,d,f){if(a<b.length){b=b[a];if(Array.isArray(b)){d.range=b;for(var e=0;e<b.length;e++)xa(b[e])||(d.range=
null)}else Ra(b)||Ba(b)?d.range=b:d.range=xa(b);d.range&&a++}d.range||("text"===E.selectionType()&&(d.range=W.getSelection(),d.range&&d.range.isCollapsed&&(d.range=void 0)),d.range||(d.range=E.selection()),d.range?d.activate=!0:(c.invalidArg(f,"range",null,"A range was not specified and nothing is currently selected"),d.invalid=!0));return a},ta=function(a,b,d,f){if(1>b.length||"string"!==typeof b[0])c.invalidArg(f,"style",null,"A highlight style must be specified"),d.invalid=!0},Aa=function(a,b,
d,f){var e;a<b.length&&"string"===typeof b[a]&&(e=b[a]);d.style=la(e,"hl-text"!=d.type);d.style?a++:(c.invalidArg(f,"style",e),d.invalid=!0);return a},va=function(a,b,d,c,f){a<b.length&&(b=b[a],b instanceof Object||"object"==typeof b?(d[c]=b,a++):null!==b&&void 0!==b||a++);return a},ya=function(a,b,d,c,f){a<b.length&&(b=b[a],b instanceof String||"string"==typeof b?(d[c]=b,a++):null!==b&&void 0!==b||a++);return a},ua=function(a,b,d,f){for(;a<b.length&&void 0===b[a];)a++;a<b.length&&(c.invalidArg(f,
null,null,"Unexpected argument(s)"),d.invalid=!0);return a},za=function(){c.each("updateStyle","isRedaction");oa()};w.onredactionColor(za);w.onredactionFillColor(za);w.onnochrome(function(){c.positionAll(z.activeOverlay())});w.onshowSlideNotes(c.updateHighlights);w.onshowHighlightLabels(function(a){c.each("showLabel",null,a)});w.onhighlightLabelFontFamily(a);w.onhighlightLabelFontSize(a);w.onhighlightActivationBoxColor(function(a){if(null===a)E.screenCSS(".oit-highlight-active .oit-activation","display:none;"),
E.screenCSS(".oit-highlight-embed","display:none;"),E.screenCSS(".oit-highlight-active .oit-resize div","display:none;"),E.screenCSS(".oit-text-handle div:nth-child(2)","display:none;"),E.screenCSS(".oit-text-handle div:first-child","display:none;"),E.screenCSS(".oit-text-handle",null);else if(a=Ga(a)){var b="rgb("+a.r+","+a.g+","+a.b+")",d="border:2px solid "+b+";opacity:"+a.a+";";E.screenCSS(".oit-highlight-active .oit-activation",d);d="border:1px solid "+b+";opacity:"+a.a+";";E.screenCSS(".oit-highlight-embed",
d);d="background-color:"+b+";";E.screenCSS(".oit-highlight-active .oit-resize div",d);E.screenCSS(".oit-text-handle div:nth-child(2)",d);E.screenCSS(".oit-text-handle div:first-child","border-bottom: 7px solid "+b+";");d="opacity:"+a.a+";";E.screenCSS(".oit-text-handle",d)}});a=function(a,b,d){if((a=z.activePage())&&a.isSpreadsheet()&&!d.inAnnotation())return!0;a="tap"===b.type?u.viewNode.touchPos(b):u.viewNode.mousePos(b);void 0===c.activateNearest(a.x,a.y,b,!0)&&d&&c.activate(d.id);return void 0!==
c.active()?!1:!0};c.on.click.setDefaultListener(a);c.on.tap.setDefaultListener(a);E.onscroll(function(){c.alignComment()});E.onreset(function(){c.on.removeAllElements();c.clear();b=0;d=[];k=g=0;t=v=r=n=void 0;m=q=-1;K=l=void 0;I=M=!1;H=void 0;C=O=!1;R=void 0;A={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0};h=[];B&&(B=!1,E.offidle(fa));y={x:0,y:0};L=[]});E.onload(function(){if(n){var a=n;n=null;
c.apply(a)}});E.onzoom(function(a,b,d){c.positionAll(z.activeOverlay())});ha.ondata(function(a,b,d){a.highlights&&c.apply(a.highlights);if(a.stamps)for(var f in a.stamps)t[f]=a.stamps[f]})}}),Ic=Aa.extend("hyperlinks",{userEventDef:{pub:!0,detail:function(c,e,a){c={srcEvent:e,url:a.url};a.range&&(c.range=ga(a.range));a.alt&&(c.alt=a.alt);c.external=0!==c.url.indexOf("#");return c}},install:function(c){var e,a,b={},d=0,g=!1,k=null,n=null,r,v=function(a,b,d){if(b){var e=d+10;e>b.length&&(e=b.length);
for(;d<e;d++){var g=b[d],l=g.range;if(l)if("text"===l.type)K(a,g);else if("rect"==l.type&&l.page===a.index){if(!a.linkMap){var k=a.childByClass("oit-svg"),f=k.byClass("oit-svg-text");if(f&&0<f.length){f=f[0];a.linkMap=x.create("div","oit-area-hyperlinks");a.linkMap.attr("style",f.attr("style"));if(f.classList)for(var h=0;h<f.classList.length;h++){var B=f.classList.item(h);"oit-svg-text"!==B&&a.linkMap.addClass(B)}k.append(a.linkMap)}}a.linkMap&&(l="left:"+l.left+"px;top:"+l.top+"px;width:"+(l.right-
l.left)+"px;height:"+(l.bottom-l.top)+"px;",k=x.create("div"),k.attr("style",l),a.linkMap.append(k),c.on.addElement(k,g),l={anchorNode:k,page:a},g.anchors||(g.anchors=[]),g.anchors.push(l))}}}return d},t=function(a,b,d){if(b){var c=d+10;c>b.length&&(c=b.length);for(;d<c;d++){var e=b[d],g=e.range;if(g&&"text"===g.type){var l=a.findRange(g.acc,g.accend);l&&aa(l,"addDataToRange",null,g,e)}}}return d},q=function(a,d,c){a=0;d&&(a=d.button||0);if(0!==a||!c.targetId)return!0;k=null;(d=b[c.targetId])?(c=
x.byId(c.targetId)||d.range||d.page,void 0!==c&&z.movetoEx(c,{force:!0,moveToTop:!0}),g&&(ua.hideMessage(),g=!1)):ha.isPending()?(g||(ua.showMessage(OIT.local.PLEASE_WAIT_INITIALIZING),g=!0),k=c,ha.on.add.listenOnce(function(){k&&q(null,null,k)})):g&&(ua.hideMessage(),g=!1);return!1};c.on.click.setDefaultListener(q);c.on.tap.setDefaultListener(q);ha.ondata(function(c,g,l){var k;if(c.hyperlinks){e=e?e.concat(c.hyperlinks):c.hyperlinks;for(g=0;g<c.hyperlinks.length;g++)l=c.hyperlinks[g],l.type="hyperlink",
l.id="oit-hl-"+ ++d,k=l.url,0===k.indexOf("#")&&(l.targetId=k.substring(1)+"."+x.expando,l.url="#"+l.targetId);l=z.count();for(k=0;k<l;k++)(g=z.page(k))&&g.isLoaded()&&!g.isHidden()&&v(g,c.hyperlinks,0)}if(c.bookmarks){a=a?a.concat(c.bookmarks):c.bookmarks;for(g=0;g<c.bookmarks.length;g++)l=c.bookmarks[g],k=l.name,l.type="bookmark",l.id=k+"."+x.expando,b[l.id]||(b[l.id]=l);l=z.count();for(k=0;k<l;k++)(g=z.page(k))&&g.isLoaded()&&t(g,c.bookmarks,0)}});var m=function(){if(n){for(var b,d=0;d<n.length;d++){var c=
n[d];if(c.page.isLoaded()){var g=!0;c.page.isHidden()?g=!1:(e&&(c.hindex=v(c.page,e,c.hindex),c.hindex<e.length&&(g=!1)),a&&(c.bindex=t(c.page,a,c.bindex),c.bindex<a.length&&(g=!1)));g||(b||(b=[]),b.push(c))}}n=b}n||(r&&(Qa(r),r=void 0),E.offidle(m))},l=function(a,b,d){a.addDataToRange(b,d);"OIT.ihs(event)"==a.attr("onmouseover")&&a.attr("onmouseover",null);"OIT.ihs(event)"==a.attr("ontouchstart")&&a.attr("ontouchstart",null)},K=function(a,b){var d=b.range,c=a.findRange(d.acc,d.accend);c&&aa(c,l,
null,d,b)};z.onpageload(function(a,b){n||(n=[]);if(-1==n.indexOf(a)&&(n.push({page:a,hindex:0,bindex:0}),1==n.length))if("rt"!=a.type&&"sn"!=a.type||r)r=wb(m,75);else E.onidle(m)});z.onpageunload(function(a){if(e)for(var b=0;b<e.length;b++){var d=e[b];if(d.anchors)for(var g=d.anchors.length-1;0<=g;g--){var l=d.anchors[g];if(l.page===a){c.on.removeElement(l.anchorNode);1==d.anchors.length?d.anchors=void 0:d.anchors.splice(g,1);break}}}delete a.linkMap});E.onreset(function(){c.on.removeAllElements();
a=e=void 0;b={};d=0;n=k=null;r&&(Qa(r),r=void 0)});hb("ihs",function(a){if(e)for(var b=Bb(a.currentTarget),d,c=0;c<e.length;c++){var g=e[c];gb(b,g.range)&&(d||(d=z.forNode(a.currentTarget)),d&&K(d,g))}})}}),ob=Aa.extend("attachments",{exports:["describe","setOptions"],userEventDef:{pub:!0,detail:function(c,e,a){(c=ob.describe(a))?c.attachment=a:c={};c.srcEvent=e;return c},onListen:function(){ob.onListen()},onUnlisten:function(){ob.onUnlisten()},onAdd:function(){ob.onListen()},onRemove:function(){ob.onUnlisten()}},
install:function(c){var e=[],a,b=0;c.item=function(a){return e[a]};c.describe=function(a){var b;0===arguments.length?b=Ua(e):isNaN(a)||0<=a&&a<e.length&&(b=Ua(e[a]));return b};c.setOptions=function(b){b&&(a||(a=new Cb),b.hasOwnProperty("cursor")&&a.setRule(".oit-attachedFile {cursor:"+b.cursor+"}","cursor"),b.hasOwnProperty("color")&&a.setRule(".oit-attachedFile {color:"+b.color+"}","color"))};c.onListen=function(){0===b&&u.viewNode&&u.viewNode.addClass("oit-attachevents");b++};c.onUnlisten=function(){0<
b&&0===--b&&u.viewNode&&u.viewNode.removeClass("oit-attachevents")};E.onload(function(){0<b?u.viewNode.addClass("oit-attachevents"):u.viewNode.removeClass("oit-attachevents")});E.onreset(function(){e=[];a&&(a.destroy(),a=void 0)});ha.ondata(function(a,b,c){if(a.attachments)for(c=0;c<a.attachments.length;c++)b=a.attachments[c],b.id=e.length,e.push(b);if(a.pages)for(var d=0;d<a.pages.length;d++){var g=a.pages[d].attachments;if(g)for(c=0;c<g.length;c++)b=g[c],b.id=e.length,e[b.id]=b}})}}),Jc=Aa.extend("archive",
{userEventDef:{pub:!0,detail:function(c,e,a){return{nodeid:a,name:c.text(),srcEvent:e}}}}),ya=Aa.extend("toolbars",{exports:["add","hide","remove","setSize","show"],events:{add:{pub:!0,detail:function(c,e){return{id:c,edge:e}}},remove:{pub:!0,detail:function(c,e){return{id:c,edge:e}}},show:{pub:!0,detail:function(c,e,a,b){return{id:c,edge:e,width:a,height:b}}},hide:{pub:!0,detail:function(c,e){return{id:c,edge:e}}},resize:{pub:!0,detail:function(c,e,a,b){return{id:c,edge:e,width:a,height:b}}},resizeinternal:{}},
install:function(c){var e=["left","top","right","bottom"],a=[],b,d,g=function(){$a(a,"refresh");ka.dispatchResize()};ka.onresize(g);z.onchange(function(){var a=z.activeOverlay();a!=d&&(d=a,g())});c.add=function(d,g,k){var n;if(-1===e.indexOf(d))c.invalidArg("add","edge",d,"Must be one of "+JSON.stringify(MEMORY_MODELS));else if(x.isElement(g)){var q,m=!1,l=!1,r=!1,M;k&&(k.size&&((q="auto"===k.size?k.size:vb(k.size))||c.invalidArg("add","options.size",k.size,"Must be a valid CSS length or 'auto'")),
!0===k.visible&&(m=!0),!0===k.overlay&&(l=!0),!0===k.resizable&&(r=!0),k.border&&(M=k.border));var v;b?(v=a[b],n=++b):n=b=1;k=u.viewNode;var H=k.scroll();g=new Pb(n,d,x.wrap(g),M,v);l&&g.overlay(!0);r&&g.resizable(!0);a[n]=g;q&&g.setSize(q);k.scroll(H);c.on.add.dispatch(n,d);m&&c.show(n)}else c.invalidArg("add","elem",g,"Must be a valid DOM Element");return n};c.addInternal=function(b,d){a[b]=d};c.removeInternal=function(b){var d=a[b];d&&(d.remove(),delete a[b])};c.internalParent=function(b){var d,
c;for(c in a)c=Number(c),c>b&&(void 0===d||c<d)&&(d=c);if(void 0!==d)return a[d]};c.remove=function(b){$a(a,k,b);g()};var k=function(d){var c=d.id;d.remove();for(a[c]=void 0;!a[b];)if(0>=--b){b=void 0;break}return!0};c.setSize=function(b,d){b=Number(b);var e=a[b];e&&!e.isInternal()||c.invalidArg("setSize","id",b,"Must be a valid toolbar id returned by OIT.toolbars.add");var k="auto"===d?d:vb(d);k?e&&(e.setSize(k),g()):c.invalidArg("setSize","size",d,"Must be a valid CSS length or 'auto'")};c.show=
function(b,d){$a(a,"show",b,d||{});g()};c.hide=function(b){$a(a,"hide",b);g()}}}),Fb,Qb,Rb,Kc;(function(){var c=null,e={},a=0;Fb=function(a,d,c,e,n,r){if(c&&"text"===d.type&&d.accend>d.acc&&(n=a.findRange(d.acc,d.accend,n))&&0<n.length)return e={type:"style",id:e,priority:r||0},"string"===typeof c?e.className=c:e.props=c,!c.color&&n[0].hasClass("oit-tt")&&(r=n[0].computedStyle().color,r=Ga(r),r.a=1,c.color=Ja(r)),aa(n,"addDataToRange",null,d,e),a.pageLayoutChanged(),n};Rb=function(a,d,c,e){c&&a&&
0<a.length&&(d={type:"style",id:d,priority:e||0},"string"===typeof c?d.className=c:d.props=c,!c.color&&a[0].hasClass("oit-tt")&&(e=a[0].computedStyle().color,e=Ga(e),e.a=1,c.color=Ja(e)),aa(a,"changeData",null,d))};Qb=function(a,d){aa(a,"removeData",null,"style",d)};Kc=function(b){b=$b(b,!0);var d=e[b];d||(d="oit-ss"+ ++a,e[b]=d,c||(c=new Cb),c.addCSSText("."+d+" {"+b+"}"));return d};E.onreset(function(){c&&(c.destroy(),c=null);e={};a=0})})();Ha.extend(["page","drawing","slide","chart"],{de:"page",
showhidden:!1,cellselection:!1});Ha.extend("bitmap",{de:"page",showhidden:!1,textselection:!1,cellselection:!1,customtextselection:!1});Ha.extend("html",{de:"page",rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1,elasticScroll:!1});Ha.extend("email",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});Ha.extend("rt",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,
anchorednotes:!1,elasticScroll:!1});Ha.extend("sn",{de:"page",showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1});ub.extend("page",{install:function(c){var e,a=1,b=null,d,g,k,n,r,v=u.isMobileOrTablet?10:20,t=!1,q,m=0,l=0,K;c.load=function(l){e=l.overlay;a=1;b=null;d=l.type;g=void 0;if(!u.isMobile&&void 0===u.singlePageIndex)E.onidle(f);M(l);z.onadd(c,I);z.onchange(c,h);T.onbeginselection(c,p);E.onscroll(c,D);if("email"===d)ka.onresize(c,B);w.onremoveExtraEmailHeaders(c,
Y);w.onscrollMode(c,ma);w.onpresentationMode(c,N);w.onnochrome(c,J);w.onshowEmailAddresses(c,ja);w.onshowAnnotations(c,Z);J(w.nochrome);A(l.index);Z();h()};c.unload=function(){E.screenCSS(".oit-annopane",null);z.offadd(I);z.offchange(h);T.offbeginselection(p);E.offscroll(D);ka.offresize(B);w.offremoveExtraEmailHeaders(Y);w.offscrollMode(ma);w.offpresentationMode(N);w.offnochrome(J);w.offshowEmailAddresses(ja);w.offshowAnnotations(Z);u.isMobile||E.offidle(f);g&&(g.destroy(),g=void 0);b&&b.hideStickyHeader();
e=null;a=1;b=null;k=g=r=n=d=void 0;v=u.isMobileOrTablet?10:20};c.visiblePages=function(){var a=[];if("email"===d)e.each(function(b){a.push(b)});else if("vertical"==w.scrollMode&&void 0===u.singlePageIndex){var b=z.count(),c,f,h,g=z.current();for(c=g-1;0<=c;c--)if((f=z.page(c))&&f.isEnabled()){if(f.overlay!=e)break;h=f.pageRect("view");if(0>=h.bottom)break;g=c}a.push(z.page(g));var p=u.viewNode.clientHeight-10;for(c=g+1;c<b;c++)if((f=z.page(c))&&f.isEnabled()){if(f.overlay!=e)break;h=f.pageRect("view");
if(h.top>p)break;10<h.bottom&&a.push(f)}}else a.push(z.activePage());return a};c.saveScrollPos=function(){var a=z.page(c.visiblePages()[0]);if(a){var b=a.pageRect("view");return{page:a,offset:b.top/b.height}}};c.restoreScrollPos=function(a){if(a&&a.page&&void 0!==a.offset){var b=a.page.pageRect("view");(a=b.top-a.offset*b.height)&&u.viewNode.dscroll(void 0,a)}};c.scrollPadding=function(){if(b)return b.scrollPadding()};c.margin=function(){return{left:v,top:v,right:v,bottom:v}};var M=function(a){if(a._emailHeader){b=
a._emailHeader;b.applyShowEmailAddresses();var d=a.overlay.firstPage,c=z.page(d.index+1);d&&d.load(!0,function(){c?c.load(!0,function(){c.parent()!=d.parent()&&d.parent().append(c);B()}):B()})}};c.layoutChanged=function(b){if(e){var d=u.viewNode,c=w.zoom;b||(b={x:0,y:0});var f=d.scroll(),g=null,p=null,l;l=v/w.zoom;1!=c&&(g=["scale(",c,",",c,")"].join(""),p="left top");l=2*l+z.annotationPaneWidth();l="vertical"==w.scrollMode?l+e.maxWidth:l+z.activePage().width;e.css({transform:g,"transform-origin":p,
"min-width":l+"px"});H();g=c/a;d.scroll((b.x+f.left)*g-b.x,(b.y+f.top)*g-b.y);a=c;h()}};var I=function(a){K||(K=da(function(){K=void 0;H(!0);A()},500))},H=function(a){if(e){var b=w.rotation,c={yOffset:0,maxWidth:0,height:0},f=z.top(),h=[],p=w.centerPages,l=v/w.zoom;if("email"===d)p=!1,h.push(".oit-emailbk{"),h.push("margin:",l,"px"),h.push("}"),h.push(".oit-email-stickyheader{"),h.push("left:",l,"px"),h.push("}");else if("html"===d||"rt"===d)p=!1;if(p){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");
h.push("margin:",l,"px 0 ",l/2,"px 0");h.push("}");h.push(".oit-sn{");h.push("margin:0 0 ",2*l,"px 0");h.push("}");if(!w.nochrome&&0!==b){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");switch(b){case 90:h.push("box-shadow:-1px 1px 5px 0 rgba(0,0,0,.25) !important");break;case 180:h.push("box-shadow:-1px -1px 5px 0 rgba(0,0,0,.25) !important");break;case 270:h.push("box-shadow:1px -1px 5px 0 rgba(0,0,0,.25) !important")}h.push("}")}h.push(".oit-page:last-of-type,.oit-bitmap:last-of-type,.oit-drawing:last-of-type,.oit-slide:last-of-type,.oit-chart:last-of-type,.oit-sn:last-of-type{margin-bottom:",
l,"px;}")}"vertical"==w.scrollMode?e.each(O,null,h,b,p,l,c):O(z.activePage(),h,b,p,l,c);0===c.maxWidth?e.css("width",null):(c.maxWidth+=v+v,e.css("width",c.maxWidth+"px"));0===c.height?e.css("height",null):(c.height+=v,e.css("height",c.height+"px"));h=h.join("");g||(g=new Cb);g.setCSSText(h);!f||k||a||"vertical"!=w.scrollMode||void 0!==u.singlePageIndex||(a=w.disableAnimation,w.disableAnimation=!0,z.moveto(f),w.disableAnimation=a);e.each(function(a){a.pageLayoutChanged();a.positionAnnotations()});
Q.positionAll(e)}},O=function(a,b,c,f,e,h){var g=0,p=0,l,k=u.viewNode.clientWidth,B=z.annotationPaneWidth();a.resetCache();if("sn"==a.type)f&&(g=(k/w.zoom-(a.offsetWidth+B))/2,g<e&&(g=e)),p=h.yOffset;else{if("email"===d||"html"===d||"rt"===d)c=0;switch(c){case 0:f&&(g=(k/w.zoom-(a.offsetWidth+B))/2,g<e&&(g=e));break;case 90:f&&(p=(k/w.zoom-(a.offsetHeight+B))/2,p<e&&(p=e));g=-h.yOffset-a.offsetWidth;h.yOffset=h.yOffset-a.offsetHeight+a.offsetWidth;a.offsetHeight>h.maxWidth&&(h.maxWidth=a.offsetHeight);
h.height+=a.offsetWidth+v;l="rotate(270deg) ";break;case 180:f&&(g=-((k/w.zoom-(a.offsetWidth+B))/2),g>-e&&(g=-e));g-=a.offsetWidth;p=-a.offsetHeight;l="rotate(180deg) ";break;case 270:f&&(p=-((k/w.zoom-(a.offsetHeight+B))/2),p>-e&&(p=-e)),p-=a.offsetHeight,g=h.yOffset,h.yOffset=h.yOffset-a.offsetHeight+a.offsetWidth,a.offsetHeight>h.maxWidth&&(h.maxWidth=a.offsetHeight),h.height+=a.offsetWidth+v,l="rotate(90deg) "}}g=P(g);p=P(p);if(0!==g||0!==p||l){b.push("#",a.id.replace(/\./g,"\\."));b.push(" {");
if(0!==g||0!==p||l)b.push(Za.transform,":"),l&&b.push(l),0===g&&0===p||b.push("translate(",g,"px,",p,"px)"),b.push(";");b.push("}")}};c.moveto=function(a,c,f){var e=!1,h;f=f||{};if(fc(a))if(b)e=b.moveto(a,c,f);else{if("slide"==d&&(h=z.forRange(a))&&h.annotationPane()){var g=h.annotationPane().range();gb(g,a)&&h.annotationPane().activate(a,!0,!0,c,f)}}else"number"===typeof a&&(e=u.viewNode,h=z.page(a),A(h.index),(a=f.gotoNode)&&a!==h?a=z.elementRect(a,"overlay"):(a=h.pageRect("overlay").clone(),a.top-=
v),h=e.scroll().top,a=h+(a.top-h),0>a&&(a=0),a!=h?(E.on.scrollupdate.disable(),e.abortAnimation(),h=!1!==f.animate?150:0,k=!0,e.animate({scrollTop:a,time:h,endFn:C,args:[c,f]})):c&&c(f),e=!0);return e};var C=function(a,b,d){k=!1;E.on.scrollupdate.enable();E.on.scrollupdate.dispatch();b&&b(d)},R=function(a){"sn"!=a.type&&(r&&a.hiddenFromSlideshow?a.hide():a.show())},A=function(a){var b=!1;"vertical"===w.scrollMode&&void 0===u.singlePageIndex?u.viewNode.removeClass("oit-single"):u.viewNode.addClass("oit-single");
if("vertical"==w.scrollMode&&void 0===u.singlePageIndex||"email"===d||"html"===d||"rt"===d)void 0!==n&&(e.showPages(),n=void 0,b=!0,r=!1),a="slideshow"==w.presentationMode,a!=r&&(r=a,b=!0,e.each(R));else if(a=a||z.current(),a!=n){var c=z.page(a);if(c){var f;void 0===n?e.hidePages(c.index):(f=z.page(n),c.addClass("oit-noshadow"));c.show({insertLast:!0,animate:!0,endFn:function(){c.removeClass("oit-noshadow");f&&f.hide()}});n=a;b=!0;u.isMobileOrTablet&&e.css("min-height",c.height+v+v+"px")}}b&&(E.dispatchPageEvents(!0),
Q.positionAll(e))};c.pageRange=function(a,b){if("rect"===b){var d=z.page(a);if(d)return d=d.pageRect(),mb(a,0,0,d.width,d.height)}};c.rangeRect=function(a,b,d,c){var f;if("text"===a.type){var e=z.forRange(a);e&&(f=e.textBoundingRect(a,c))}else"rect"===a.type&&(f=new ba(a),void 0!==a.embedId&&((c=z.page(a.page))&&(e=c.embeddingRect(a.embedId)),e?f.offset(e.left,e.top):f=void 0));f&&(f.origin=b);return f};c.rangeFromRect=function(a,b,d,c,f,e,h,g){var p;if(a=z.page(a))b=new ba(b,d,c,f,e),b.origin=a,
d=void 0!==g?a.embeddingRect(g):a.pageRect(),"html"!==a.type&&"rt"!==a.type&&"sn"!==a.type&&("move"===h?b.constrain(d):"select"!==h&&b.intersect(d)),void 0!==g?(b.offset(-d.left,-d.top),p=b.toRange(a),p.embedId=g,va(p,"pct")):p=b.toRange(a);return p};c.extendRange=function(a,b,d,f){var e=c.rangeRect(a,f);return c.rangeFromRect(a.page,e.left,e.top,b,d,f,"extend")};var f=function(a){if(!a)return z.loadNextPageFromServer()||E.offidle(f),!1},h=function(){if(!u.isMobile&&void 0===u.singlePageIndex)E.onidle(f);
u.viewNode.scroll();for(var a=F.visiblePages(),b=0;b<a.length;b++){var d=a[b];d&&d.isPending()&&d.load(!1)}},B=function(){e.each(ca);b&&b.applyViewSize()},y=function(){if("email"===d){var a=u.viewNode.clientWidth-146;30>a&&(a=30);return a}},L=function(){if(this.hasClass("oit-ximage"))this.css("max-width",null),this.removeClass("oit-ximage"),this.addClass("oit-cimage");else if(this.hasClass("oit-cimage")){var a=y();this.css("max-width",""+a+"px");this.addClass("oit-ximage");this.removeClass("oit-cimage")}B();
z.each("pageLayoutChanged")},ca=function(a){if(a.hasClass("oit-rt")&&a.isLoaded()){var b=y();if(b!==a.pageContentMaxWidth){a.pageContentMaxWidth=b;for(var d,c,f=0;;f++){var e=a.embeddingByIndex(f);if(!e)break;var h=x.byId(e.id);if(h&&(b&&(e.w>b?(h.hasClass("oit-cimage")||(h.css("max-width",""+b+"px"),h.addClass("oit-ximage")),h.onclick(L),h.ontap(L)):(h.css("max-width",null),h.removeClass("oit-ximage"),h.removeClass("oit-cimage"),h.offclick(L),h.offtap(L))),e=z.elementRect(h,a))){if(void 0===d||e.right>
d)d=e.right;if(void 0===c||e.bottom>c)c=e.bottom}}void 0!==d&&a.css("min-width",d+10+"px");void 0!==c&&a.css("min-height",c+10+"px");if(b&&(d=a.childByTagName("div"))&&(d=d.childrenByTagName("TABLE")))for(c=0;c<d.length;c++)d[c].css("max-width",""+b+"px");a.pageLayoutChanged()}}},Y=function(a){b&&a&&b.removeExtraEmailHeaders()},ma=function(){e&&(A(),u.viewNode.scroll(0,0),z.updateActivePage())},N=function(){e&&A()},J=function(a){e&&(v=a?0:u.isMobileOrTablet?10:20,A())},p=function(){b&&b.beginSelection()};
c.startElasticScroll=function(){var a=w.scrollMode;"hswipe"!==a&&"vswipe"!==a||!F.features().elasticScroll||(u.viewNode.css("overflow","hidden"),t=!0,l=m=0)};c.elasticScroll=function(a,b){if(t){var d=w.scrollMode,c="hswipe"===d,d="vswipe"===d,f=0,h=0;void 0!==a&&c&&(m=f=-a,e.css("left",f+"px"));void 0!==b&&d&&(l=h=-b,e.css("top",h+"px"));if(f||h){u.viewNode.cancelKinetic();var d=z.activePage(),g=d.annotationPane();g&&g.hide();var p;if(0<f||0<h)p=z.prev(z.current());else if(0>f||0>h)p=z.next(z.current());
p&&p!==q&&(q&&(q.hide(),q.css({left:null,top:null,position:null}),q=void 0),p.overlay==d.overlay&&(h=f=0,p.index<d.index?c?f=d.pos(e).left/w.zoom-v-p.width:h=d.pos(e).top/w.zoom-v-p.height:c?f=d.rect(e).right/w.zoom+v:h=d.rect(e).bottom/w.zoom+v,p.css({left:f+"px",top:h+"px",position:"absolute",transform:"none"}),p.show({animate:!1}),(g=p.annotationPane())&&g.hide(),q=p))}fb()}};c.endElasticScroll=function(a,b){if(t){t=!1;u.viewNode.css("overflow",null);var d="hswipe"===w.scrollMode;u.viewNode.cancelKinetic();
var c,f=z.activePage();d?(d=a/(f.width*w.zoom),c=a/u.viewNode.clientWidth):(d=b/(f.height*w.zoom),c=b/u.viewNode.clientHeight);c=Math.max(d,c);var h=d=0,g=f;-.25>c?g=z.prev(f.index)||f:.25<c&&(g=z.next(f.index)||f);g!==f&&(d=(u.viewNode.clientWidth-g.width*w.zoom)/2,d<v&&(d=v),c=v,h=g.pos(u.viewNode),d=m+d-h.left,h=l+c-h.top);e.animate({offsetLeft:d,offsetTop:h,time:100,transition:g!==f?"ease-in":"ease-out",endFn:function(){q&&(q!==g&&q.hide(),q.css({left:null,top:null,transform:null}),q=void 0);
e.css({left:null,top:null});g!==f&&(z.deactivateAnnotation(),u.viewNode.scroll(0,0),z.movetoEx(g.index,{animate:!1}),Q.eachOnPage("addToPage",g));if(w.showAnnotations){var a=g.annotationPane();a&&a.show()}fb()}});fb()}};var D=function(){if(b)b.onScroll()},ja=function(){b&&b.applyShowEmailAddresses()},Z=function(){var a=w.showAnnotations;if(a){var b=z.activePage();b&&!b.supportsAnnotationBar()&&E.screenCSS(".oit-annopane","width:338px !important;");z.scrollToAnnotationPane(Q.updateHighlights)}else z.deactivateAnnotation(),
E.screenCSS(".oit-annopane",null);e.each(function(b){(b=b.annotationPane())&&(a?b.show():b.hide())});E.dispatchPageEvents()}}});Ha.extend(["worksheet","database"],{de:"ss",rotate:!1,textselection:!1,rectselection:!1,customtextselection:!1});ub.extend("ss",{install:function(c){var e,a,b,d,g=!1;c.load=function(g){e=g;d=b=a=null;if(a=g.spreadsheetModel())b=new ed(a,e),(g=a.showHidden())?(g={columns:g.columns,rows:g.rows},c.showHidden(g)):b.showHidden(w.showHiddenColumns,w.showHiddenRows),b.doUpdate();
w.onshowHiddenRows(c,k);w.onshowHiddenColumns(c,n);w.onshowAnnotations(c,r);r()};c.unload=function(){w.offshowHiddenRows(k);w.offshowHiddenColumns(n);w.offshowAnnotations(r);d&&ta(d);b&&b.unload();d=b=a=null};c.maxPageWidth=function(){if(b)return b.maxPageWidth()};c.maxPageHeight=function(){if(b)return b.maxPageHeight()};c.padding=function(){if(b)return b.padding()};c.scrollOffset=function(){if(b)return b.scrollOffset()};c.getSelectedText=function(){return a?a.getSelectedText():""};c.select=function(b){return a?
a.select(b):!1};c.keydown=function(d){var c=!0;if(b)switch(d.keyCode){case 33:u.viewNode.dscroll(0,-(b.visibleHeight()+1));if(d=T.cellSelection())c=b.visibleRange(),c=c.r2-c.r1+1,d.c2=d.c1,d.r1-=c,0>d.r1&&(d.r1=0),d.r2=d.r1,T.select(d);c=!1;break;case 34:u.viewNode.dscroll(0,b.visibleHeight()+1);if(d=T.cellSelection())c=b.visibleRange(),c=c.r2-c.r1+1,d.c2=d.c1,d.r1+=c,c=a.rowCount()-1,d.r1>c&&(d.r1=c),d.r2=d.r1,T.select(d);c=!1;break;case 35:g=!g;c=!1;break;case 36:b.scrollToRange(0,0,0,0);d=sa(e.index,
0,0);T.select(d);c=g=!1;break;case 27:b.hidePopup(!0);c=g=!1;break;case 37:case 38:case 39:case 40:break;default:g=!1}return c};c.loadRange=function(b,d){a&&a.loadRange(b,d)};c.expandRange=function(b){a&&(b=a.expandRange(b));return b};c.moveto=function(a,d,c){return b?b.moveto(a,d,c):!1};c.showHidden=function(d){void 0===d&&(d="all");var c=a.showHidden(d);"string"===typeof d&&(d=c);b&&b.showHidden(d.columns,d.rows)};var k=function(){b&&b.showHidden(void 0,w.showHiddenRows)},n=function(){b&&b.showHidden(w.showHiddenColumns,
void 0)},r=function(){T.select(null);a&&a.showAnnotations(w.showAnnotations);b&&(b.showHidden(w.showHiddenColumns,w.showHiddenRows),b.update())};c.pageRange=function(b,d){if("cell"===d&&b==e.index)return sa(b,0,0,a.colCount()-1,a.rowCount()-1)};c.pageRect=function(a,d){if(b)return b.pageRect(a,d)};c.rangeRect=function(a,d,c){if(b)return b.rangeRect(a,d,c)};c.rangeFromRect=function(a,d,c,e,g,k,n,t){if(b)return b.rangeFromRect(a,d,c,e,g,k,n,t)};c.extendRange=function(a,d,c,e){if(b)return b.extendRange(a,
d,c,e)};var v=function(b,d){var c=na(b+d,0,a.colCount()-1);if(0!==d&&a.colHidden(c)){var e=a.colCount()-1;do if(c+=d,0>c){for(c=0;c<=e&&a.colHidden(c);c++);break}else if(c>e){for(c=e;0<=c&&a.colHidden(c);c--);break}while(a.colHidden(c))}return c},t=function(b,d){var c=na(b+d,0,a.rowCount()-1);if(0!==d&&a.rowHidden(c)){var e=a.rowCount()-1;do if(c+=d,0>c){for(c=0;c<=e&&a.rowHidden(c);c++);break}else if(c>e){for(c=e;0<=c&&a.rowHidden(c);c--);break}while(a.rowHidden(c))}return c};c.moveAnchor=function(d,
c,e,k){k=!1;g&&(0>c?c=-a.colCount():0<c&&(c=a.colCount()),0>e?e=-a.rowCount():0<e&&(e=a.rowCount()),g=!1);c=v(d.c1,c);e=t(d.r1,e);d.c1!=c&&(d.c1=c,k=!0);d.c2!=c&&(d.c2=c,k=!0);d.r1!=e&&(d.r1=e,k=!0);d.r2!=e&&(d.r2=e,k=!0);k&&b.scrollToRange(d.c1,d.r1,d.c1,d.r1);return k};c.incrementSelection=function(d,c,e,k,n){n=!1;g&&(0>e?e=-a.colCount():0<e&&(e=a.colCount()),0>k?k=-a.rowCount():0<k&&(k=a.rowCount()),g=!1);c.c2==d.c1?(e=v(c.c1,e),e!=c.c1&&(e<=c.c2?c.c1=e:(c.c1=c.c2,c.c2=e),n=!0)):(e=v(c.c2,e),e!=
c.c2&&(e>=c.c1?c.c2=e:(c.c2=c.c1,c.c1=e),n=!0));c.r2==d.r1?(k=t(c.r1,k),k!=c.r1&&(k<=c.r2?c.r1=k:(c.r1=c.r2,c.r2=k),n=!0)):(k=t(c.r2,k),k!=c.r2&&(k>=c.r1?c.r2=k:(c.r2=c.r1,c.r1=k),n=!0));n&&(k=c.c2==d.c1?c.c1:c.c2,d=c.r2==d.r1?c.r1:c.r2,b.scrollToRange(k,d,k,d));return n};c.layoutChanged=function(a){b&&b.layoutChanged(a)};c.update=function(a){b&&b.update(a)}}});Ha.extend(["archive","emailarchive"],{de:"arc",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,rectselection:!1,cellselection:!1,anchorednotes:!1});
ub.extend("arc",{install:function(c){var e,a,b,d,g=function(a){a.preventDefault();t(this.parentNode.parentNode.parentNode,this)},k=function(a){t(this.parentNode.parentNode.parentNode,this)},n=function(b){d=a.scroll()},r=function(b){a.autoscroll(d.left-b.delta.x,d.top-b.delta.y)},v=function(){var d=a.scroll().left;d!=b&&(b=d,0===b?e.css("margin-left",null):e.css("margin-left",-b+"px"))};c.load=function(d){e=d.childByClass("oit-tree-head");a=d.childByClass("oit-tree-nodes");b=0;a.kinetic(!0);var c=
x.byClass("oit-open-close");c&&(aa(c,"onclick",null,g),aa(c,"ontap",null,k));if(c=x.byClass("oit-tree-nname"))for(d=0;d<c.length;d++){var l=c[d],m=l.attr("data-nodeid");null!==m&&""!==m&&(m=Number(m),isNaN(m)||Jc.on.addElement(l,m))}if(c=e.byClass("oit-col-header"))for(d=0;d<c.length;d++)c[d].ctrl=new q(c[d],e),c[d].ctrl.colClass="f"+d;d=e;var t;a:{try{for(var M=W.styleSheets,c=0;c<M.length;c++){var K=M[c].cssRules||M[c].rules;if(0<K.length&&"div.f0"==K[0].selectorText){t=c;break a}}}catch(f){}t=
null}d.ssIndex=t;a.onscroll(v);a.onpanstart(n);a.onpanmove(r)};c.unload=function(){Jc.on.removeAllElements()};var t=function(a,b){var d=a.nextElementSibling;"none"!=d.style.display?(d.style.display="none",b&&b.addClass("closed")):(d.style.display="block",b&&b.removeClass("closed"))},q=function(a,b){V.call(this,"div","oit-col-dragger");this.append(x.create("div"));this.headerbar=b;var d=a.nextSiblingElem();d?e.insert(this,d):e.append(this);this.header=a;this.ondragstart(m);this.ondragmove(l);this.ondragend(K);
this.ondragcancel(K)};X(q,V);var m=function(a){this.orgwidth=this.header.clientWidth;this.overlay||(a=u.viewNode,this.overlay=x.create("div","oit-tree-overlay"),this.overlay.css({height:a.clientHeight-this.headerbar.clientHeight+"px",top:this.headerbar.clientHeight+2+"px",left:this.header.offsetLeft-3+"px"}),this.overlay.innerWidth=this.orgwidth+6,this.header.parent().append(this.overlay));return!1},l=function(a){a=this.orgwidth+a.delta.x-3;1>a&&(a=1);this.header.innerWidth=a;this.overlay.innerWidth=
a+9;return!1},K=function(a){this.overlay.destroy();delete this.overlay;this.header.css("width",null);var b=this.orgwidth+a.delta.x-3;1>b&&(b=1);b+="px";if(null!==this.headerbar.ssIndex){var d=W.styleSheets[this.headerbar.ssIndex].cssRules,c="div."+this.colClass;for(a=0;a<d.length;a++)if(d[a].selectorText==c){d[a].style.width=b;break}}else for(d=this.headerbar.parent().byClass(this.colClass),a=0;a<d.length;a++)d[a].css("width",b);return!1}}});var ba=function(){var c=function(){var a=arguments;if(1===
a.length)a=a[0],void 0!==a.units?("px"!==a.units&&(a=ga(a),va(a,"px")),this.l=a.left,this.t=a.top,this.r=a.right,this.b=a.bottom,this.o=z.page(a.page)):a.o&&(this.l=a.l,this.t=a.t,this.r=a.r,this.b=a.b,this.o=a.o);else if(2===a.length){var b=a[0];this.l=b.left;this.t=b.top;this.r=b.right;this.b=b.bottom;this.o=a[1]}else this.l=a[0],this.t=a[1],this.r=a[2],this.b=a[3],this.o=a[4];a=this.o&&("view"===this.o||"overlay"===this.o||this.o instanceof V);if(!(fa(this.l)&&fa(this.t)&&fa(this.r)&&fa(this.b)&&
a))throw"Invalid Rectangle";this.l=P(this.l,1E4);this.t=P(this.t,1E4);this.r=P(this.r,1E4);this.b=P(this.b,1E4);this.l>this.r&&(a=this.l,this.l=this.r,this.r=a);this.t>this.b&&(a=this.t,this.t=this.b,this.b=a);this.w=this.r-this.l;this.h=this.b-this.t},e=X(c);Object.defineProperties(e,{left:{enumerable:!0,get:function(){return this.l},set:function(a){this.verifyMutable();this.l=P(a,1E4);this.r=this.l+this.w}},top:{enumerable:!0,get:function(){return this.t},set:function(a){this.verifyMutable();this.t=
P(a,1E4);this.b=this.t+this.h}},right:{enumerable:!0,get:function(){return this.r},set:function(a){this.verifyMutable();this.r=P(a,1E4);this.l=this.r-this.w}},bottom:{enumerable:!0,get:function(){return this.b},set:function(a){this.verifyMutable();this.b=P(a,1E4);this.t=this.b-this.h}},width:{enumerable:!0,get:function(){return this.w},set:function(a){this.verifyMutable();0>a&&(a=0);this.w=P(a,1E4);this.r=this.l+this.w}},height:{enumerable:!0,get:function(){return this.h},set:function(a){this.verifyMutable();
0>a&&(a=0);this.h=P(a,1E4);this.b=this.t+this.h}},origin:{enumerable:!0,get:function(){return this.o},set:function(a){this.verifyMutable();this.convert(a)}}});var a=function(a,b,c){return"number"===typeof c&&(c=P(c,1E4),c!==a[b])?(a[b]=c,!0):!1};e.move=function(b,c,e,n){this.verifyMutable();b=a(this,"l",b);b|=a(this,"t",c);b|=a(this,"r",e);if(b|=a(this,"b",n))this.w=this.r-this.l,this.h=this.b-this.t;return b};e.movesize=function(b,c,e,n){this.verifyMutable();b=a(this,"l",b);b|=a(this,"t",c);b|=a(this,
"w",e);if(b|=a(this,"h",n))this.r=this.l+this.w,this.b=this.t+this.h;return b};e.offset=function(a,b){this.verifyMutable();void 0!==a&&(this.left+=a);void 0!==b&&(this.top+=b)};e.size=function(a,b){this.verifyMutable();void 0!==a&&(this.width=a);void 0!==b&&(this.height=b)};e.scale=function(a){void 0!==a&&(this.verifyMutable(),this.left*=a,this.top*=a,this.width*=a,this.height*=a)};var b=function(a,b){return a===b?!0:.999<(a>b?b/a:a/b)};e.equals=function(a){return b(this.l,a.left)&&b(this.t,a.top)&&
b(this.r,a.right)&&b(this.b,a.bottom)};e.overlaps=function(a){return this.l<a.right&&this.r>a.left&&this.t<a.bottom&&this.b>a.top};e.contains=function(a){return a.left>=this.l&&a.right<=this.r&&a.top>=this.t&&a.bottom<=this.b};e.containsPoint=function(a,b){return a>=this.l&&a<=this.r&&b>=this.t&&b<=this.b};e.union=function(a,b,c,e){if(1==arguments.length){var d=arguments[0];this.union(d.left,d.top,d.right,d.bottom)}else this.verifyMutable(),a=P(a,1E4),b=P(b,1E4),c=P(c,1E4),e=P(e,1E4),a<this.l&&(this.l=
a),b<this.t&&(this.t=b),c>this.r&&(this.r=c),e>this.b&&(this.b=e),this.w=this.r-this.l,this.h=this.b-this.t};e.intersect=function(a,b,c,e){if(1==arguments.length){var d=arguments[0];this.intersect(d.left,d.top,d.right,d.bottom)}else this.verifyMutable(),a=P(a,1E4),b=P(b,1E4),c=P(c,1E4),e=P(e,1E4),this.l=na(this.l,a,c),this.r=na(this.r,a,c),this.t=na(this.t,b,e),this.b=na(this.b,b,e),this.w=this.r-this.l,this.h=this.b-this.t};e.constrain=function(a,b,c,e){if(1==arguments.length){var d=arguments[0];
this.constrain(d.left,d.top,d.right,d.bottom)}else{this.verifyMutable();a=P(a,1E4);b=P(b,1E4);c=P(c,1E4);e=P(e,1E4);var d=c-a,g=e-b;this.width>=d?(this.l=a,this.r=c,this.w=d):this.left<a?this.left=a:this.right>c&&(this.right=c);this.height>=g?(this.t=b,this.b=e,this.h=g):this.t<b?this.top=b:this.b>e&&(this.bottom=e)}};e.clone=function(){return new c(this.left,this.top,this.right,this.bottom,this.origin)};e.toRange=function(a){var b=this;this.o!==a&&(b=this.clone(),b.origin=a);return mb(a.index,b.left,
b.top,b.right,b.bottom)};e.readonly=function(a){"boolean"===typeof a&&(this._readonly=a);return!!this._readonly};e.verifyMutable=function(){if(this._readonly)throw"Attempted to modify a read-only Rectangle";};e.distanceFrom=function(a,b,c,e,r){a=P(a,1E4);b=P(b,1E4);switch(c){case "left":a-=this.l;break;case "center":a-=(this.l+this.r)/2;break;case "right":a-=this.r;break;case "none":a=0;break;default:a=a<this.l?a-this.l:a>this.r?a-this.r:0}switch(e){case "top":b-=this.t;break;case "middle":b-=(this.t+
this.b)/2;break;case "bottom":b-=this.b;break;case "none":b=0;break;default:b=b<this.t?b-this.t:b>this.b?b-this.b:0}if("xy"===r)r={x:a,y:b,ax:Math.abs(a),ay:Math.abs(b)};else if(0===a&&0===b)r=0;else if(r=P(Math.sqrt(a*a+b*b),10),0>b||0===b&&0>a)r=-r;return r};e.convert=function(a){var b=this.o;if(a!==b){var d,c=w.rotation,e=w.zoom;if(a instanceof nb)if("view"===b||"overlay"===b){if(d=a,(b=d.pagePos(b))&&this.offset(-b.left,-b.top),d.features().zoom&&1!=e&&this.move(this.l/e,this.t/e,this.r/e,this.b/
e),d.features().rotate&&0!==c)switch(c){case 90:this.move(d.width-this.b,this.l,d.width-this.t,this.r);break;case 180:this.move(d.width-this.r,d.height-this.b,d.width-this.l,d.height-this.t);break;case 270:this.move(this.t,d.height-this.r,this.b,d.height-this.l)}}else if(b instanceof nb)b=b.pageRect(),d=a.pageRect(),this.offset(d.left-b.left,d.top-b.top);else throw"Unsupported Rectangle conversion";else if(b instanceof nb)if("view"===a||"overlay"===a){d=b;if(d.features().rotate&&0!==c)switch(c){case 90:this.move(this.t,
d.width-this.r,this.b,d.width-this.l);break;case 180:this.move(d.width-this.r,d.height-this.b,d.width-this.l,d.height-this.t);break;case 270:this.move(d.height-this.b,this.l,d.height-this.t,this.r)}d.features().zoom&&"email"!==d.type&&"rt"!==d.type&&1!=e&&this.move(this.l*e,this.t*e,this.r*e,this.b*e);(b=d.pagePos(a))&&this.offset(b.left,b.top)}else throw"Unsupported Rectangle conversion";else if("view"===a||"overlay"===a||a instanceof V)if("view"===b)b=F.padding(),d=F.scrollOffset(),this.left=this.left-
b.left+d.left,this.top=this.top-b.top+d.top,a instanceof V&&(b=(d=a.ancestorByClass("oit-overlay"))?a.pos(d):a.pos(u.viewNode),this.left-=b.left,this.top-=b.top);else{if("overlay"===b||b instanceof V)b instanceof V&&(b=(d=b.ancestorByClass("oit-overlay"))?b.pos(d):b.pos(u.viewNode),this.left+=b.left,this.top+=b.top),"view"===a&&(b=F.padding(),d=F.scrollOffset(),this.left=this.left+b.left-d.left,this.top=this.top+b.top-d.top)}else throw"Unsupported Rectangle conversion";this.o=a}return this};return c}(),
hc=function(){var c=function(a){this._rects=[];this.add(a)},e=X(c);Object.defineProperties(e,{length:{enumerable:!0,get:function(){return this._rects.length}},left:{enumerable:!0,get:function(){return this.boundingRectangle().left}},top:{enumerable:!0,get:function(){return this.boundingRectangle().top}},right:{enumerable:!0,get:function(){return this.boundingRectangle().right}},bottom:{enumerable:!0,get:function(){return this.boundingRectangle().bottom}},width:{enumerable:!0,get:function(){return this.boundingRectangle().width}},
height:{enumerable:!0,get:function(){return this.boundingRectangle().height}}});e.item=function(a){return this._rects[a]};e.add=function(a){if(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._rects.push(a[b]);else this._rects.push(a);this._boundingRect=null}return this};e.convert=function(a){aa(this._rects,"convert",null,a);this._boundingRect=null;return this};e.boundingRect=function(){if(!this._boundingRect){for(var a=this._rects,b=a[0],d=b.left,c=b.top,e=b.right,n=b.bottom,r=1;r<a.length;r++)b=
a[r],b.left<d&&(d=b.left),b.top<c&&(c=b.top),b.right>e&&(e=b.right),b.bottom>n&&(n=b.bottom);this._boundingRect=new ba(d,c,e,n,a[0].origin)}return this._boundingRect};e.interiorRect=function(a,b){for(var d=this._rects,c=null,e=0,n=0;n<d.length;n++){var r=d[n];if(r.width>=a.width&&r.height>=a.height){c=r;break}else if(!c||r.width>c.width||r.height>c.height){var v=r.width/a.width,t=r.height/a.height,q=Math.min(v,t);b&&(v=r.height/a.width,t=r.width/a.height,q=Math.max(q,Math.min(v,t)));if(!c||q>e)c=
r,e=q}}if(c)return c.clone()};return c}(),Cb=function(){var c=function(a){V.call(this,"style");a&&this.attr("media",a);this.append(x.createText(""));x.head.append(this);this.rulecount=0;this.indexLookup={};Object.defineProperty(this,"sheet",{get:function(){return this.dom.sheet}})},e=X(c,V);e.addCSSText=function(a){this.html(this.html()+a)};e.setCSSText=function(a){this.html(a)};e.setRule=function(a,b){if(b&&this.indexLookup.hasOwnProperty(b))return this.updateRuleByIndex(a,this.indexLookup[b]);try{return this.sheet.insertRule(a,
this.rulecount),b&&(this.indexLookup[b]=this.rulecount),this.rulecount++}catch(d){this.logError("setRule","Error inserting style rule: "+d.message)}};e.updateRuleByIndex=function(a,b){if(!isNaN(b)){try{this.sheet.deleteRule(b),this.sheet.insertRule(a,b)}catch(d){this.logError("updateRuleByIndex","Error updating style rule: "+d.message)}return b}};e.updateRule=function(a,b){this.indexLookup.hasOwnProperty(b)?this.updateRuleByIndex(a,this.indexLookup[b]):this.updateRuleByIndex(a,b)};e.removeFromNames=
function(a){for(var b in this.indexLookup)this.indexLookup[b]==a?delete this.indexLookup[b]:this.indexLookup[b]>a&&--this.indexLookup[b]};e.deleteRule=function(a){a=this.indexLookup.hasOwnProperty(a)?this.indexLookup[a]:a;!isNaN(a)&&a<this.rulecount&&(this.sheet.deleteRule(a),this.removeFromNames(a),this.rulecount--)};e.hasRule=function(a){return this.indexLookup.hasOwnProperty(a)};return c}(),Qc=function(){var c=function(a,b){a/=b/2;if(1>a)return.5*a*a;a--;return-.5*(a*(a-2)-1)},e={ease:c,"ease-in-out":c,
"ease-in":function(a,b){a/=b;return a*a*a},"ease-out":function(a,b){a/=b;a--;return a*a*a+1},linear:function(a,b){return a/b}},a="opacity offsetLeft offsetTop innerWidth innerHeight scrollLeft scrollTop".split(" "),b={scrollLeft:!1,scrollTop:!1},d=[],g=function(a){rc(d,"step",null,a);0<d.length&&qb(g)},k=function(a){var b=a.elem;b&&b.dom&&(b.data("_animation")===a&&b.removeData("_animation"),b.removeClass("oit-animating"));Ka(d,a)};E.onreset(function(){aa(d,"finish");d=[];for(var a in b)b.hasOwnProperty(a)&&
(b[a]=!1)});var n=function(a,b,d){b=b[a];void 0!==b&&(d[a]=b)},r=function(a,b,d){b=b[a];Pa(b)&&(d[a]=b)},v=function(a,b){var d=a[b];d&&(a.args?d.apply(a.context,a.args):d.call(a.context,a.elem))},t=function(a,b){var d=a[b];d&&a.elem&&a.elem.dom&&a.elem.css(d)},q=function(l,k){this.elem=l;this.time=void 0!==k.time?k.time:120;r("startFn",k,this);r("stepFn",k,this);r("endFn",k,this);n("context",k,this);k.args&&(this.args=Array.prototype.slice.call(k.args,0),this.args.unshift(l));n("startCSS",k,this);
n("endCSS",k,this);this.transFn=e[k.transition]||c;for(var m=w.disableAnimation||0>=this.time,t=0;t<a.length;t++){var q=a[t],v=k[q];if(void 0!==v){var C=l[q];C!=v&&(this.props||(this.props={}),this.props[q]={start:C,end:v},m|=b[q])}}m||!this.props?this.finish():(d.push(this),l.data("_animation",this),l.addClass("oit-animating"),qb(g))},m=X(q);m.isEmpty=function(){return 0>=this.time||!this.props};m.step=function(a){var b=!1,d=this.elem;d&&d.dom&&void 0===this.startTime&&(t(this,"startCSS"),v(this,
"startFn"),this.startTime=a,this.steps=0,d=this.elem);if(d&&d.dom&&(this.steps++,a-=this.startTime,a=a>=this.time?1:this.transFn(a,this.time),1>a)){var b=this.props,c;for(c in b){var e=b[c];d[c]=e.start+(e.end-e.start)*a}v(this,"stepFn");b=!0}b||this.finish();return b};m.finish=function(){var a=this.elem;if(a){var d=this.props,c;if(this.steps&&4>this.steps)for(c in d)b.hasOwnProperty(c)&&(b[c]=!0);k(this);void 0===this.startTime&&(t(this,"startCSS"),v(this,"startFn"));if(a.dom)for(c in d)a[c]=d[c].end;
t(this,"endCSS");v(this,"endFn");this.deleteAll()}};m.abort=function(){this.elem&&(k(this),this.deleteAll())};return q}(),Lc=function(){var c=[],e=OIT.DialogBox=function(a){V.call(this,"div","oit-dialog");a=a||{};this._resizable=this._moveable=this._modal=this._visible=!1;c.push(this);this.css("opacity",0);this._form=x.create("form",this);this.move(a.x,a.y,a.width,a.height);void 0!==a.className&&this.addClass(a.className);void 0!==a.moveable&&this.moveable(a.moveable);void 0!==a.resizable&&this.resizable(a.resizable);
void 0!==a.modal&&this.modal(a.modal);void 0!==a.resultFn&&(this._resultFn=a.resultFn);void 0!==a.destroyFn&&(this._destroyFn=a.destroyFn);void 0!==a.title&&this.title(a.title);void 0!==a.textColor&&this.css("color",a.textColor);void 0!==a.backgroundColor&&this._form.css("background-color",a.backgroundColor);a.cancel&&(k(this,U.CANCEL,this.cancel),this.onkeydown(n));a.ok&&k(this,U.OK,this.ok);a.no&&k(this,U.NO,this.no);a.yes&&k(this,U.YES,this.yes);u.rootNode.append(this)},a=X(e,V),b=function(a){a=
this.pos();this._dragX=a.left;this._dragY=a.top;this._header.css("cursor",Ub);return!1},d=function(a){this.move(this._dragX+a.delta.x,this._dragY+a.delta.y);this._header.css("cursor",Ub);return!1},g=function(a){this._header.css("cursor",Tb);return!1},k=function(a,b,d){a._footer||(a._footer=x.create("footer",a),a._footerVisible=!0);b=new Zb(b);a._footer.append(b);b.onclick(a,d);b.ontap(a,d)},n=function(a){return 27==a.keyCode?!1:!0},r=function(a){var b=0;a._header&&(a._header.css("cursor",a._moveable?
Tb:null),b=a._header.offsetHeight);if(a._footer&&a._footerVisible)a._footer.css("display",null),a._form.css({height:null,position:"absolute",top:b+"px",left:"0px",right:"0px",bottom:a._footer.offsetHeight+"px"});else{a._footer&&a._footer.css("display","none");var d=null;0<b&&(d=a.clientHeight-b+"px");a._form.css({position:null,left:null,right:null,top:null,bottom:null,height:d})}};a.destroy=function(){this.cancel();this.show(!1,{animate:!1});this._destroyFn&&this._destroyFn(this);Ka(c,this);V.prototype.destroy.call(this)};
a.exit=function(){this.cancel();this.show(!1,{endFn:this.destroy,context:this})};a.moveable=function(a){if(!0===a||!1===a)this._moveable=a,r(this);return this._moveable};a.resizable=function(a,b,d){if((!0===a||!1===a)&&a!=this._resizable){this._resizable=a;var c,e;this._resizable?(this.addClass("oit-dialog-resizable"),void 0!==b&&(c=b+"px"),void 0!==d&&(e=d+"px")):this.removeClass("oit-dialog-resizable");this.css({"min-width":c,"min-height":e})}return this._resizable};a.modal=function(a){!0!==a&&
!1!==a||a===this._modal||(this._modal=a,ua.showModalOverlay(this._modal));return this._modal};a.title=function(a){if(a){var c;this._header||(this._header=x.create("header"),this.insert(this._header,this.firstChildElem()),this._header.ondragstart(this,b),this._header.ondragmove(this,d),this._header.ondragend(this,g),this._header.ondragcancel(this,g));c=this._header;this._title||(this._title=x.create(),c.append(this._title));this._title.html(a);this._title.css("display",null);c.addClass("oit-dialog-header-shaded");
r(this)}else null===a&&(this._title&&(this._title.destroy(),delete this._title),this._header&&(this._header.destroy(),delete this._header),r(this));return this._title?this._title.text():void 0};a.resetForm=function(){this._form.html("")};a.addLabel=function(a,b){var d=x.create("label",this._form);d.html(a);b&&b.style&&d.css(b.style);return d};a.addTextArea=function(a,b){a&&(this.addLabel(a),x.create("br",this._form));var d=new lc;this._form.append(d);b&&(b.style&&d.css(b.style),b.placeholder&&d.attr("placeholder",
b.placeholder));return d};a.show=function(a,b){!1!==a&&(a=!0);a&&(this._result=void 0);this.finishAnimation();if(this._visible==a)b&&(b.startFn&&b.startFn.call(b.context,this),b.endFn&&b.endFn.call(b.context,this));else{b=b||{};var d=0;!1!==b.animate&&(d=200);a?(this.startFn=b.startFn,this.startContext=b.context,this.animate({opacity:1,time:d,startCSS:{opacity:0,display:"block"},startFn:v,endFn:b.endFn,context:this}),this._visible=!0,this._modal&&ua.showModalOverlay(!0,d)):(this.animate({opacity:0,
time:d,startFn:b.startFn,endCSS:{display:null},endFn:b.endFn,context:b.context}),this._visible=!1,this._modal&&ua.showModalOverlay(!1,d))}return this._visible};var v=function(){r(this);this.startFn&&this.call(this.startContext,this);delete this.startFn;delete this.startContext};a.showFooter=function(a){!0!==a&&!1!==a||a===this._footerVisible||(this._footerVisible=!1!==a,r(this));return this._footerVisible};a.move=function(a,b,d,c,e){var g=u.viewNode,k=g.size(),g=g.pos();void 0===d&&(d=this.offsetWidth);
var l=k.width-10-10;d>l&&(d=l);void 0===c&&(c=this.offsetHeight);l=k.height-10-10;c>l&&(c=l);void 0!==a&&(l=g.left+k.width-10-d,a>l&&(a=l),a=P(a));void 0!==b&&(k=g.top+k.height-10-c,b>k&&(b=k),b=P(b));this._visible&&a!==this.offsetLeft||b!==this.offsetTop||d!==this.innerWidth||c!=this.innerHeight?(k=e&&!0===e.animate?200:0,e&&(this.moveOptions=e),this.css("overflow","hidden"),this.animate({offsetLeft:a,offsetTop:b,innerWidth:d,innerHeight:c,time:k,endCSS:{overflow:null},endFn:t,context:this})):e&&
e.endFn&&e.endFn.call(e.context,this)};var t=function(){r(this);var a=this.moveOptions;a&&a.endFn&&a.endFn.call(a.context,this);delete this.moveOptions};a.autoSize=function(a,b,d,c,e){(d=this.hasClass("oit-animating"))&&this.removeClass("oit-animating");var g=["width","height","display","opacity"];c=this.css(g);this.removeCSS(g);this.css("display","block");this.css("opacity","1");var g=this.offsetWidth,k=this.offsetHeight;this.css(c);d&&this.addClass("oit-animating");this.move(a,b,g,k,e)};a.maxsize=
function(a,b){var d={};void 0!=a&&(d["max-width"]=0===a?null:a+"px");void 0!=b&&(d["max-height"]=0===b?null:b+"px");this.css(d)};var q=function(a,b){a._visible||a.css("display","block");var d=a[b];a._visible||a.css("display",null);return d};a.width=function(){return q(this,"offsetWidth")};a.height=function(){return q(this,"offsetHeight")};var m=function(a,b){void 0===a._result&&(a._result=b,a._resultFn&&a._resultFn(a,b))};a.cancel=function(){m(this,!1)};a.ok=function(){m(this,!0)};a.no=function(){m(this,
0)};a.yes=function(){m(this,1)};a.result=function(){return this._result};E.onreset(function(){for(;0<c.length;)c.shift().destroy()});return e}();hb("TextRange",function(c,e){if(c>e){var a=c;c=e;e=a}this.type="text";this.acc=c;this.accend=e});hb("CellRange",function(c,e,a,b,d,g,k,n,r){var v;e>b&&(v=e,e=b,b=v);a>d&&(v=a,a=d,d=v);this.type="cell";this.page=c;this.section=z.page(c).section;this.c1=e;this.r1=a;this.c2=b;this.r2=d;void 0!==g&&(this.offsets="number"===typeof g?{left:g,top:k,right:n,bottom:r}:
{left:g.left,top:g.top,right:g.right,bottom:g.bottom})});hb("RectRange",function(c,e,a,b,d,g,k,n){var r;a>d&&(r=a,a=d,d=r);b>g&&(r=b,b=g,g=r);this.type="rect";void 0!==c&&(this.embedId=c);this.page=e;this.left=a;this.top=b;this.right=d;this.bottom=g;this.units=k;if(void 0!==n)this.section=n;else if(c=z.page(e))this.section=c.section});var Sb=function(){var c=function(a,d,c){V.call(this,"div",d);this._layer=a;this._visible=!0;c?c.append(this):a.append(this);x.attach(this);"none"===this.computedStyleProp("display")&&
(this._visible=!1);this.changed()},e=X(c,V);e.createChild=function(a){return new za(this,a)};e.layer=function(){return this._layer};e.moveToTop=function(){this.parent().append(this)};e.addClass=function(a){this.hasClass(a)||(V.prototype.addClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.removeClass=function(a){this.hasClass(a)&&(V.prototype.removeClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.defaultSize=function(){if(!this._defaultSize){var a=
["transform","display","width","height"],d=this.css(a);this.removeCSS(a);this._defaultSize={width:this.offsetWidth,height:this.offsetHeight};this.css(d)}return this._defaultSize};e.setDefaultSize=function(a){this._defaultSize=a};e.resetDefaultSize=function(){this._defaultSize&&(this._defaultSize=null)};e.setTitle=function(a){this.attr("title",a)};e.show=function(a){!1!==a&&(a=!0);a!==this._visible&&((this._visible=a)?(this.css("display","block"),this.changed()):this.css("display","none"));return this};
e.hide=function(){return this.show(!1)};e.visible=function(){return this._visible&&this._layer.visible()};e.layoutObject=function(){if(!this._animating&&this.visible()){var a=this.position();if(a){var d={};d.left=a.left;this._borderOffset&&(d.left-=this._borderOffset.left);d.left+="px";d.top=a.top;this._borderOffset&&(d.top-=this._borderOffset.top);d.top+="px";d.width=a.width+"px";d.height=a.height+"px";this.css(d);this._borderOffset||(this._borderOffset={left:this.clientLeft,top:this.clientTop},
this._borderOffset.left&&this.css("left",a.left-this._borderOffset.left+"px"),this._borderOffset.top&&this.css("top",a.top-this._borderOffset.top+"px"))}}return this};e.changed=function(){this._dirty||(this._dirty=!0,this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.childChanged=function(a){this._dirty||(this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.update=function(b){this._dirty&&(b=!0,this._dirty=
!1);b&&this.layoutObject();this.queryChildElements(a,b);return this};var a=function(a,d,c){a.update&&a.update(c)};return c}(),za=function(){var c=function(a,b){b=b||{};Sb.call(this,a.layer(),b.classList,a);this._parentObject=a;b.title&&this.setTitle(b.title);var d=b.margin||0;this._margin={left:d,top:d,right:d,bottom:d};void 0!==b.hpos&&(this._hpos=b.hpos);void 0!==b.vpos&&(this._vpos=b.vpos);!0===b.inheritMoveable&&(this.inheritMoveable=!0)},e=X(c,Sb);e.resize=function(a,b){void 0!==a||void 0!==
b?this._size&&this._size.width===a&&this._size.height===b||(this._size={width:a,height:b},this.changed()):this._size&&(delete this._size,this.changed());return this};e.setMargin=function(a,b,d,c){var e=!1;void 0!==a&&a!==this._margin.left&&(this._margin.left=a,e=!0);void 0!==b&&b!==this._margin.top&&(this._margin.top=b,e=!0);void 0!==d&&d!==this._margin.right&&(this._margin.right=d,e=!0);void 0!==c&&c!==this._margin.bottom&&(this._margin.bottom=c,e=!0);e&&(this._pos&&(this._pos=void 0),this.changed());
return this};e.position=function(){if(this._parentObject){var a=this._parentObject.position()||this._parentObject.defaultSize();if(this._pos&&a.width!=this._parentWidth||a.height!=this._parentHeight)this._pos=void 0;if(void 0===this._pos){this._parentWidth=a.width;this._parentHeight=a.height;var b,d,c,e;if("fill"===this._hpos)b=this._margin.left,c=a.width-this._margin.left-this._margin.right;else if(void 0!==this._hpos)if(c=this._size&&0<this._size.width?this._size.width:this.defaultSize().width,
"number"===typeof this._hpos)b=0<=this._hpos?this._margin.left+this._hpos:a.width-this._margin.right-c+this._hpos;else switch(this._hpos){case "left":b=this._margin.left;break;case "center":b=(a.width-c)/2;break;case "right":b=a.width-this._margin.right-c}if("fill"===this._vpos)d=this._margin.top,e=a.height-this._margin.top-this._margin.bottom;else if(void 0!==this._vpos)if(e=this._size&&0<this._size.height?this._size.height:this.defaultSize().height,"number"===typeof this._vpos)d=0<=this._vpos?this._margin.top+
this._vpos:a.height-this._margin.bottom-e+this._vpos;else switch(this._vpos){case "top":d=this._margin.top;break;case "middle":d=(a.height-e)/2;break;case "bottom":d=a.height-this._margin.bottom-e}void 0!==b||void 0!==d||void 0!==c||void 0!==e?(void 0===b&&(b=0),void 0===d&&(d=0),void 0===c&&(c=this.defaultSize().width),void 0===e&&(e=this.defaultSize().height),this._pos=new ba(b,d,b+c,d+e,"overlay")):this._pos=null}}return this._pos};return c}(),fd=function(){var c=function(a){za.call(this,a,{hpos:"center",
vpos:"middle",classList:"oit-highlight-label",inheritMoveable:!0})},e=X(c,za);e.destroy=function(){this._parentObject&&this._parentObject.attr("title",null);za.prototype.destroy.call(this)};e.setText=function(a){this._labelText=a=a||"";this.html(a);this.setTitle(a);this.resetDefaultSize();this.changed()};e.setColor=function(a,b){this.css("color",a)};e.setBoundingRect=function(a){a?this._parentRect=a.clone():delete this._parentRect;this.show()};e.position=function(){if(this._parentObject){var a=this._parentRect||
this._parentObject.position();this.css("transform",null);this.showLabelText=!0;this.html(this._labelText);var b="",d=this.defaultSize(),c=d.width+4,e=d.height+4,n=!1;if(c>a.width||e>a.height){if(c>e&&a.width<a.height||c<e&&a.width>a.height)d={width:d.height,height:d.width},c=d.width+4,e=d.height+4,b="rotate(270deg)",n=!0;if(c>a.width||e>a.height){var r=P(Math.min(a.width/c,a.height/e),1E3);.4>r?(b="",this.html(""),this.showLabelText=!1):(b+="scale("+r+","+r+")",c=d.width*r+4,e=d.height*r+4)}}this.css("transform",
b);if(this.showLabelText)return b=a.left+(a.width-c)/2,a=a.top+(a.height-e)/2,n&&(a+=e),c=b+c,e=a+e,this.show(),new ba(b,a,c,e,"overlay");this.hide()}};return c}(),gd=function(){var c=function(a){za.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation",inheritMoveable:!0})},e=X(c,za);e.setResizable=function(b){if(b){this._resizable||(this.addClass("oit-resize"),a(this,"oit-resize-n",!1,!0,!1,!1),a(this,"oit-resize-s",!1,!1,!1,!0),a(this,"oit-resize-e",!1,!1,!0,!1),a(this,"oit-resize-w",
!0,!1,!1,!1),a(this,"oit-resize-ne",!1,!0,!0,!1),a(this,"oit-resize-nw",!0,!0,!1,!1),a(this,"oit-resize-se",!1,!1,!0,!0),a(this,"oit-resize-sw",!0,!1,!1,!0));var d=b.margin||0;0>d&&this.setMargin(d,d,d,d);this._resizable=b}else this._resizable&&(this._resizeHandles&&(aa(this._resizeHandles,"destroy"),delete this._resizeHandles),delete this._resizable,this.removeClass("oit-resize"))};var a=function(a,b,c,e,q,m){b=x.create("div",b);b.ondragstart(a,d,c,e,q,m);b.ondragmove(a,g);b.ondragend(a,k);b.ondragcancel(a,
k);a.append(b);a._resizeHandles||(a._resizeHandles=[]);a._resizeHandles.push(b)},b=function(a,b,d){b=b._parentObject;b.dispatchCustom(a,{drawingRect:b,newRect:d.curRect,moved:d.resized})},d=function(a,d,c,e,g){a=this._parentObject.position();this.resizeInfo=d={left:d,top:c,right:e,bottom:g,startRect:a.clone(),curRect:a.clone(),resized:!1};b("resizestart",this,d);return!1},g=function(a){var d=this.resizeInfo;this.calculateResize(d,a);d.resized=!0;b("resizemove",this,d);if(!this._resizable.bindToObject){a=
this._parentObject.position();var c=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(c+d.curRect.left-a.left,c+d.curRect.top-a.top,c+a.right-d.curRect.right,c+a.bottom-d.curRect.bottom)}return!1},k=function(a){a=this.resizeInfo;if(!this._resizable.bindToObject){var d=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(d,d,d,d)}b("resizeend",this,a);delete this.resizeInfo;return!1};e.calculateResize=function(a,b){var d=b.delta.x,c=b.delta.y,
e=a.startRect.left,g=a.startRect.top,k=a.startRect.right,n=a.startRect.bottom;a.left?(e+=d,k-e<this._resizable.minWidth&&(e=k-this._resizable.minWidth)):a.right&&(k+=d,k-e<this._resizable.minWidth&&(k=e+this._resizable.minWidth));a.top?(g+=c,n-g<this._resizable.minHeight&&(g=n-this._resizable.minHeight)):a.bottom&&(n+=c,n-g<this._resizable.minHeight&&(n=g+this._resizable.minHeight));return e!=a.curRect.left||g!=a.curRect.top||k!=a.curRect.right||n!=a.curRect.bottom?(a.curRect.move(e,g,k,n),!0):!1};
return c}(),hd=function(){var c,e=function(a){za.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation"});this._range=ga(a._range);this._startHandle=b(this,d);this._endHandle=b(this,g)},a=X(e,za),b=function(a,b){var d=new za(a,{hpos:0,vpos:0,classList:"oit-text-handle"});d.append(x.create("div")).append(x.create("div")).ondragstart(a,b).ondragmove(a,n).ondragend(a,r).ondragcancel(a,r);return d};a.showHandles=function(a){a=!1!==a?null:"none";this._startHandle.css("display",a);this._endHandle.css("display",
a)};var d=function(a){var b=this._range;return k(this,this._startHandle,a,b.accend,b.acc)},g=function(a){var b=this._range;return k(this,this._endHandle,a,b.acc,b.accend)},k=function(a,b,d,c,e){a._anchor=c;a._focus=e;b=b.pos(u.viewNode);d=d.center;a._adjust={x:16-(d.x-b.left),y:-(d.y-b.top)};return!1},n=function(a){var b=a.center;if(b&&(a=this._parentObject,b=z.mapToPage(b.x+this._adjust.x,b.y+this._adjust.y,null,!0,!0))){if(void 0===this._textAnchorRoot){var d=b.page.findACC(a._range.acc);this._textAnchorRoot=
d?La(d[0]):null}if(d=b.page.mapPointToText(b.x,b.y,this._textAnchorRoot))d=d.acc,d!=this._focus&&(this._focus=d,this._focus>=this._anchor?(this._range.acc=this._anchor,this._range.accend=this._focus):(this._range.acc=this._focus,this._range.accend=this._anchor),this.changed(),a.setRange(this._range),a.dispatchCustom("textmove",{range:this._range,page:b.page}))}return!1},r=function(a){a=this._parentObject;a.setRange(this._range);a.dispatchCustom("textmoveend",{range:this._range});delete this._anchor;
delete this._focus;delete this._adjust;return!1};a.layoutObject=function(){if(this.visible()){var a=this._parentObject;za.prototype.layoutObject.call(this);c||(c=this._startHandle.defaultSize());var b=this._parentObject.position();if(b){this.show();var d=v(this._startHandle,b,a.startHandleRect()),b=v(this._endHandle,b,a.endHandleRect());d||b||(d=z.pagesForRange(a._range),this.show(d&&-1!=d.indexOf(a._page)))}else this.hide()}};var v=function(a,b,d){d?(a.setMargin(d.left-b.left-c.width/2,d.bottom-
b.top-1),a.resize(c.width,c.height),a.show()):a.hide();return d};return e}(),Ta=function(){var c=function(a,b,c){Sb.call(this,b,c);this._pos=new ba(0,0,0,0,"overlay")},e=X(c,Sb);e.setLabel=function(a,b,c){if(a){if(c=c||"#FFF",a!==this._labelText||b!=this._labelColor||c!=this._backgroundColor)if(this._labelText=a,this._labelColor=b||"#000",this._labelBackground=c||"#FFF",this.setTitle(this._labelText),this._labels)for(a=0;a<this._labels.length;a++)b=this._labels[a],b.setText(this._labelText),b.setColor(this._labelColor,
this._labelBackground)}else this._labelText&&(delete this._labelText,delete this._labelColor,delete this._labelBackground,this.setTitle(""),this._labels&&(aa(this._labels,"destroy"),delete this._labels));this.changed()};e.allocateLabelChildren=function(a){this._labels||(this._labels=[]);for(;this._labels.length<a;){var b=new fd(this);this._labels.push(b);b.setText(this._labelText);b.setColor(this._labelColor,this._labelBackground)}for(;this._labels.length>a;)this._labels.pop().destroy();return this._labels};
e.labelChildCount=function(){return this._labels?this._labels.length:0};e.getLabelChild=function(a){if(this._labels)return this._labels[a]};e.move=function(d,c,e,n,r){this._pos.movesize(d,c,e,n)&&(this.changed(),this.finishAnimation(),r&&(d=this.position(),r.stepFn&&(this.stepMoveFn=r.stepFn),r.endFn&&(this.endMoveFn=r.endFn),r={offsetLeft:d.left,offsetTop:d.top,innerWidth:d.width,innerHeight:d.height,transition:r.transition||"ease",time:r.timems,startFn:r.startFn,stepFn:a,endFn:b,context:this},this._animating=
!0,this.animate(r)));return this};var a=function(a){this.update(!0);this.stepMoveFn&&this.stepMoveFn(this)},b=function(a){delete this._animating;this.changed();this.endMoveFn&&this.endMoveFn(this);delete this.stepMoveFn;delete this.endMoveFn};e.resize=function(a,b){return this.move(void 0,void 0,a,b)};e.position=function(){return this._pos};return c}(),tb=function(){var c=function(a,b,d){Ta.call(this,a,b,d)},e=X(c,Ta);e.customEvent("resizestart");e.customEvent("resizemove");e.customEvent("resizeend");
e.activate=function(a,b){this._rectActivation||(this._rectActivation=new gd(this),b&&this.insertFirst(this._rectActivation),this._resizable&&this._rectActivation.setResizable(this._resizable));this.moveToTop();return this};e.deactivate=function(){this._rectActivation&&(this._rectActivation.destroy(),delete this._rectActivation);return this};e.resizable=function(a,b){if(!0===a){b=b||{};var d=!0,c=b.minWidth||0,e=b.minHeight||0,n=b.margin||0;!1===b.bindToObject&&(d=!1);this._resizable&&this._resizable.bindToObject==
d&&this._resizable.onResizeStart==b.onResizeStart&&this._resizable.onResize==b.onResize&&this._resizable.onResizeEnd==b.onResizeEnd&&this._resizable.onResizeCancel==b.onResizeCancel&&this._resizable.context===b.context&&this._resizable.minWidth==c&&this._resizable.minHeight==e&&this._resizable.margin==n||(this._resizable={bindToObject:d,minWidth:c,minHeight:e,margin:n},b.onResizeStart&&(this._resizable.onResizeStart=b.onResizeStart),b.onResize&&(this._resizable.onResize=b.onResize),b.onResizeEnd&&
(this._resizable.onResizeEnd=b.onResizeEnd),b.onResizeCancel&&(this._resizable.onResizeCancel=b.onResizeCancel),this._resizable.context=b.context||this,this._rectActivation&&this._rectActivation.setResizable(this._resizable))}else this._resizable&&!1===a&&(delete this._resizable,this._rectActivation&&this._rectActivation.setResizable(null));return this};e.layoutObject=function(){if(this.visible()&&!this._animating&&(Ta.prototype.layoutObject.call(this),this._labelText)){var a=this.position().clone();
a.left=0;a.top=0;this.allocateLabelChildren(1)[0].setBoundingRect(a)}return this};return c}(),id=function(){var c=function(a,b,d){Ta.call(this,a,b,d);a=this.defaultSize();this.move(void 0,void 0,a.width,a.height)},e=X(c,Ta);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return c}(),jd=function(){var c=function(a,b,d,c){var e=["oit-badge"];d&&e.push(d);Ta.call(this,a,b,e);this.resize(20,20);this.text(c)},
e=X(c,Ta);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return c}(),kd=function(){var c=function(a,d,c){Ta.call(this,a,d,c);this._page=z.page(a)},e=X(c,Ta);e.customEvent("textmove");e.customEvent("textmoveend");e.activate=function(a){this._textActivation||(this._textActivation=new hd(this));this._textActivation.showHandles(this._showHandles);this.moveToTop();return this};e.deactivate=function(){this._textActivation&&
(this._textActivation.destroy(),delete this._textActivation);return this};e.setRange=function(a){if(a&&"text"===a.type)if(!this._range)this._range=ga(a),this.changed();else if(this._range.acc!=a.acc||this._range.accend!==a.accend)this._range.acc=a.acc,this._range.accend=a.accend,this.changed();return this};e.showTextHandles=function(){this._showHandles=!0;this._textActivation&&this._textActivation.showHandles(!0);return this};e.hideTextHandles=function(){this._showHandles=!1;this._textActivation&&
this._textActivation.showHandles(!1);return this};e.layoutObject=function(){if(this.visible()&&!this._animating){var a=this._page.textBoundingRect(this._range);a&&(a.origin="overlay",this.move(a.left,a.top,a.width,a.height));Ta.prototype.layoutObject.call(this);if(this._labelText){var d=this._page.textRects(this._range,"overlay"),a=this._page.textBoundingRect(this._range);if(d&&a&&(a.origin="overlay",this.allocateLabelChildren(d.length),0<this._labels.length))for(var c=this.getLabelChild(0).defaultSize(),
e=0;e<this._labels.length;e++){var n=this.getLabelChild(e);n.setDefaultSize(c);this._moveable?n.addClass("oit-moveable"):n.removeClass("oit-moveable");var r=d[e].interiorRect(c,!0);r&&r.offset(-a.left,-a.top);n.setBoundingRect(r)}}}return this};var a=function(a,d,c){var b=a._page.accRect(d,"overlay");if(!b)for(var e=0<c?1:-1,g=e;!(b=a._page.accRect(d+g,"overlay"))&&g!=c;g+=e);b&&(b.width=0);return b};e.startHandleRect=function(){if(this._range)return a(this,this._range.acc,1)};e.endHandleRect=function(){if(this._range)return a(this,
this._range.accend,-2)};return c}(),ld=function(){var c=function(a,d,c){V.call(this,"div","oit-drawinglayer oit-drawinglayer-"+d,c);this._drawing=a;this._name=d;this._visible=!0;x.attach(this);a.append(this);this.show()},e=X(c,V);e.drawing=function(){return this._drawing};e.show=function(a,d){void 0===a&&(a=!0);a!==this._visible&&(!0===a?(this._visible=!0,this.css("display",null),!1!==d&&this.update(!0)):!1===a&&(this._visible=!1,this.css("display","none")))};e.hide=function(){this.show(!1)};e.visible=
function(){return this._visible};e.update=function(b){this.queryChildElements(a,b)};var a=function(a,d,c){a.update&&a.update(c)};e.changed=function(){this._drawing.changed()};return c}(),Yc=function(){var c=function(a){V.call(this,"div","oit-drawingpanel");x.attach(this);this._origin=null;a.append(this);a.onscroll(this,this.updateScroll)},e=X(c,V);e.destroy=function(){var a=this.parent();a&&a.offscroll(this.updateScroll);V.prototype.destroy.call(this)};e.update=function(b){!0!==b&&(b=!1);this._animationFrame&&
(this._animationFrame=null);this.queryChildElements(a,b)};var a=function(a,d,c){a.update&&a.update(c)};e.changed=function(){this._animationFrame||(this._animationFrame=qb(this.update,this))};e.setOrigin=function(a,d){if(!this._origin)this._origin={x:a,y:d},this.updateScroll();else if(this._origin.x!=a||this._origin.y!=d)this._origin.x=a,this._origin.y=d,this.updateScroll()};e.resetOrigin=function(){this._origin&&(this._origin=null,this.css({left:null,top:null}))};e.updateScroll=function(){if(this._origin){var a=
this.parent().scroll();this.css({left:this._origin.x+a.left+"px",top:this._origin.y+a.top+"px"})}};return c}(),pb=function(){var c=function(a,b,c){V.call(this,a);this.acc=b;this.accend=c;void 0===this.accend&&(a=x.data(this,"accend"))&&(this.accend=Number(a));void 0===this.accend&&(this.accend=b+this.text().length)},e=X(c,V);e.destroy=function(){this.unload();V.prototype.destroy.call(this)};e.unload=function(){b(this,null,null)};e.text=function(a){if(void 0!==a){var b=this._anchor||this;b.destroyChildren();
b.dom.textContent=a}return this.dom.textContent};e.textNode=function(){return(this._anchor||this).dom.firstChild};e.createSplit=function(a){var b=new c("span",this.acc,a);this.copyDataTo(b);var d=this.text(),e=a-this.acc;b.text(d.substring(0,e));this.text(d.substring(e));this.acc=a;this._changed=!0;return b};e.mergeSplit=function(a){var b=this.text()+a.text();this.text(b);this.accend=a.accend;this._changed=!0;a.destroy()};e.dataEquals=function(a){var b=!1,d=this._data;a=a._data;if(!d)b=!a;else if(a&&
d.length==a.length)for(var b=!0,c=0;c<d.length;c++){var e=d[c],v=a[c];if(e.type!==v.type||e.id!==v.id){b=!1;break}}return b};e.addData=function(a){this._data||(this._data=[]);"hyperlink"===a.type?this._data.unshift(a):this._data.push(a);this._changed=!0};e.changeData=function(a){if(this._data)for(var b=0;b<this._data.length;b++){var d=this._data[b];if(d.type===a.type&&d.id===a.id){this._data[b]=a;this._changed=!0;break}}};e.removeData=function(a,b){if(this._data)for(var d=0;d<this._data.length;d++){var c=
this._data[d];if(c.type===a&&c.id===b){this._data.splice(d,1);0===this._data.length&&delete this._data;this._changed=!0;break}}};e.copyDataTo=function(a){this._data&&(a._data=a._data?a._data.concat(this._data):this._data.slice(0),a._changed=!0)};e.moveDataTo=function(b){this._data&&(a(this,null,null,null,null),b._data=b._data?b._data.concat(this._data):this._data,delete this._data,this._changed=!0,b._changed=!0)};e.updateData=function(){if(this._changed){var b=null,c=null,e=null,n=null,r=void 0;if(this._data)for(var v=
0,t=0;t<this._data.length;t++){var q=this._data[t];if("style"===q.type){if(q.className&&(n||(n=[]),n.push(q.className)),q.props)for(var m in q.props)if(q.props.hasOwnProperty(m)){var l=q.props[m];if("background-color"==m){var u=q.priority||0;void 0===r||u>r?(r=u,v=1,e||(e={}),e[m]=l):u==r&&(e[m]=ac(l,e[m],v,!0),v++)}else e||(e={}),e[m]=l}}else"hyperlink"===q.type?b=q:"bookmark"===q.type&&(c=q)}a(this,e,n,b,c);this._changed=!1}};var a=function(a,c,e,n,r){c?(c=Kc(c),c!=a._splitClass&&(a._splitClass&&
a.removeClass(a._splitClass),a.addClass(c),a._splitClass=c)):a._splitClass&&(a.removeClass(a._splitClass),delete a._splitClass);a._appliedClasses&&(a.removeClass(a._appliedClasses),delete a._appliedClasses);e&&(a.addClass(e),a._appliedClasses=e);b(a,n,r)},b=function(a,b,c){var d=a._anchor;if(b){var e=b&&0===b.url.indexOf("#");d||(d=e?a._anchor=x.create("span"):a._anchor=x.create("a"),d.text(a.text()),a.html(""),a.append(d));b&&(a.addClass("oit-hyperlink"),e||d.attr("href",b.url),Ic.on.addElement(d,
b));c&&d.attr("id",c.id)}else c?a.attr("id",c.id):d&&(Ic.on.removeElement(d),b=d.text(),d.destroy(),delete a._anchor,a.removeClass("oit-hyperlink"),a.html(b))};return c}(),md=function(){var c=RegExp("^[^\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]*?[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]"),e=function(a,b,d){pb.call(this,a,b);this._origin=d},a=X(e,pb);a.unload=function(){this.discardLayout();aa(this._splits,"unload");pb.prototype.unload.call(this)};a.discardLayout=
function(){delete this._charRects;delete this._spanRect};a.distanceFromPoint=function(a,b){var d=this.findClosestChar(a,b);if(d)return d.distance};a.overlapRange=function(a){var b=this.spanRect();if(b.overlaps(a)){if(a.contains(b))return pa(this.acc,this.accend);if(b=g(this)){for(var d,c,e=0;e<b.length;e++)a.overlaps(b[e])&&(c=this.acc+e,void 0===d&&(d=c),c+=1);if(void 0!==d)return pa(d,c)}}};a.spanRect=function(){var a=this._spanRect;a||(a=z.elementRect(this,this._origin),0<a.width&&0<a.height&&
(this._spanRect=a));return a};a.textAngle=function(){void 0===this._angle&&(this._angle=this.ancestorData("angle"),this._angle=void 0!==this._angle?Number(this._angle)*Math.PI/180:0);return this._angle};a.rtl=function(){void 0===this._rtl&&(this._rtl=!!c.test(this.text()));return this._rtl};a.findClosestChar=function(a,b){var d=g(this),c,e,k;for(c=0;c<d.length;c++){var m=Math.abs(d[c].distanceFrom(a,b,"left","middle"));if(void 0===e||m<k)e=c,k=m,c==d.length-1&&(m=d[c].distanceFrom(a,b,"center","none"),
0<m&&e++)}var l,n;if(this._splits){d=this._splits;for(c=m=0;c<d.length;c++){var M=d[c].textNode(),I=m+M.textContent.length;if(e>=m&&e<I){l=M;n=e-m;break}m=I}l||(l=d[d.length-1].textNode(),n=l.textContent.length)}else l=this.textNode(),n=e;return{node:l,offset:n,acc:this.acc+e,distance:k}};a.textRect=function(a){var b=this.spanRect();if(this.hasClass("oit-hiddentext"))return new ba(b);if(0===b.width||0===b.height)return null;if(!a||a.acc<=this.acc&&a.accend>=this.accend)return new ba(b);if(a.acc<this.accend&&
a.accend>this.acc){var d=this.text(),b=a.acc-this.acc;0>b&&(b=0);a=a.accend-this.acc;a>d.length&&(a=d.length);if(d=g(this,b,a)){var c;c=new ba(d[b],this._origin);a==b&&(c.width=0);for(b+=1;b<a;b++)c.union(d[b]);return c}}};a.findTextRange=function(a,b){var d,c,e,g,k=this._splits;if(k){if(a.acc<=this.acc&&(d=k[0].textNode(),c=0),a.accend>=this.accend&&(e=k[k.length-1].textNode(),g=e.textContent.length),!d||!e)for(var l=0;l<k.length;l++){var n=k[l];if(a.accend<n.acc)break;if(!d&&a.acc<n.accend&&(d=
n.textNode(),c=a.acc-n.acc,0>c&&(c=0),e))break;if(d&&!e&&a.accend<=n.accend){e=n.textNode();g=a.accend-n.acc;0>g&&(g=0);break}}}else d=e=this.textNode(),c=0,a.acc>this.acc&&(c+=a.acc-this.acc),g=this.text().length,a.accend<this.accend&&(g-=this.accend-a.accend);k=W.createRange();k.setStart(d,c);k.setEnd(e,g);b.push(k)};var b=function(a,b,d,c){d._charRects.push(new ba(a.rect(c),c))},d=function(a,b,c,e,g,q,m,l,u){var k;a=x.unwrap(a);if(3==a.nodeType){if(k=a.textContent.length,b<=u&&b+k>=l)for(l-=b,
0>l&&(l=0),u-=b,u>k&&(u=k),k=l;k<u;k++)m[k+b]||(q.setStart(a,k),q.setEnd(a,k+1),l=q.getBoundingClientRect(),l=new ba(l.left-g.left,l.top-g.top,l.right-g.left,l.bottom-g.top,e),l.origin=c._origin,m[k+b]=l)}else for(k=0;k<a.childNodes.length&&b<=u;k++){var n=a.childNodes[k],t=b+n.textContent.length;l<=t&&b<=u&&d(n,b,c,e,g,q,m,l,u);b=t}},g=function(a,c,e){c||(c=0);e||(e=a.text().length);var g=W.createRange?W.createRange():null;if(g&&g.getBoundingClientRect)try{var k,q;a._origin instanceof V&&!(a._origin instanceof
nb)?(k=a._origin,q=k.rect()):(k="view",q=u.viewNode.rect());var m=a._charRects||[];d(a,0,a,k,q,g,m,c,e);a._charRects=m}catch(l){}else if(!a._charRects){g=a.text();e=new V;e.transferFrom(a);k=[];for(c=0;c<g.length;c++)k.push("<span>"),k.push(g[c]),c+1<g.length&&(q=g.charCodeAt(c),m=g.charCodeAt(c+1),1536<=q&&1791>=q&&1536<=m&&1791>=m&&k.push("&zwj;")),k.push("</span>");a.html(k.join(""));a._charRects=[];a.forChildElements(b,a,a._origin);c=new ba(a.rect(a._origin),a._origin);a.html("");a.transferFrom(e);
g=a.spanRect();if(g.width!=c.width&&(e=g.width/c.width,!bc(e,1)))for(g=g.left,c=0;c<a._charRects.length;c++)k=a._charRects[c],q=(k.left-g)*e+g,k.move(q,void 0,q+k.width*e,void 0)}return a._charRects};a.createSplit=function(){var a=new pb("span",this.acc,this.accend);this.moveDataTo(a);a.transferFrom(this);return a};a.updateData=function(){var a=this._splits;a?aa(a,"updateData"):pb.prototype.updateData.call(this)};a.split=function(a){if(!a)return this._splits;if(!this._splits){if(a.acc<=this.acc&&
a.accend>=this.accend||this.hasClass("oit-hiddentext"))return[this];var b=this.createSplit();this.append(b);this._splits=[b]}for(var b=this._splits,d=[],c=0;c<b.length;c++){var e=b[c],g;if(!(a.acc>=e.accend)){if(a.accend<=e.acc)break;a.acc>e.acc&&(g=e.createSplit(a.acc),b.splice(c++,0,g),this.insert(g,e));a.accend<e.accend&&(g=e.createSplit(a.accend),b.splice(c++,0,g),this.insert(g,e),e=g);d.push(e)}}return d};a.join=function(){var a=this._splits;if(a){for(var b,d=a[a.length-1],c=a.length-2;0<=c;c--)b=
a[c],b.dataEquals(d)&&(b.mergeSplit(d),a.splice(c+1,1)),d=b;1==a.length&&(b=a[0],b.moveDataTo(this),this.text(b.text()),b.destroy(),delete this._splits)}};a.addDataToRange=function(a,b){var d=this.split(a);d&&(aa(d,"addData",null,b),this.join(),this.updateData(),"hyperlink"===b.type&&g(this))};a.changeData=function(a){pb.prototype.changeData.call(this,a);aa(this._splits,"changeData",null,a);this.updateData()};a.removeData=function(a,b){pb.prototype.removeData.call(this,a,b);aa(this._splits,"removeData",
null,a,b);this.join();this.updateData()};return e}(),Mc=function(){var c=function(a,b){this._page=a;this._contentRoot=b||a;this._spans=[];if(1024<this._contentRoot.text().length)for(var d=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),c=d.firstACCNode();c;){for(var e=d.currentNode,n=!0,c=e.firstChild;c;c=c.nextSibling)if(3!==c.nodeType){n=!1;break}if(n&&1024<e.textContent.length){(c=d.skipNode())&&(c=d.firstACCNode());for(var n=e.textContent,r=[],v=0;v<n.length;v+=1024){var t=n.substring(v,
v+1024),t=zb(t);r.push("<span>",t,"</span>")}e.innerHTML=r.join("");e.textContent.length!=n.length&&(e.textContent=n)}else c=d.nextACCNode()}for(var q,d=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),c=d.firstACCNode();c;){e=d.currentNode;(c=x.data(e,"acc"))&&(q=Number(c));n=!0;for(c=e.firstChild;c;c=c.nextSibling)if(3==c.nodeType){n=!1;break}n||void 0===q?c=d.nextACCNode():(e=new md(e,q,this._contentRoot),this._spans.push(e),q=e.accend,(c=d.skipNode())&&(c=d.firstACCNode()))}this._layoutSettings=
{};if(!a.checkedACCRange){if(d=this.getTextRange())d.acc<a.acc&&(a.acc=d.acc),d.accend>a.accend&&(a.accend=d.accend);a.checkedACCRange=!0}},e=X(c);e.destroy=function(){aa(this._spans,"unload");this.deleteAll()};e.discardLayout=function(){aa(this._spans,"discardLayout")};e.getTextRange=function(){for(var a,b=0;b<this._spans.length;b++){var d=this._spans[b];a?(d.acc<a.acc&&(a.acc=d.acc),d.accend>a.accend&&(a.accend=d.accend)):a=pa(d.acc,d.accend)}return a};e.textRanges=function(){for(var a=[],b,d=this._page.isEmailHeader(),
c=0;c<this._spans.length;c++){var e=this._spans[c];!d&&b&&b.accend+1>=e.acc?e.accend>b.accend&&(b.accend=e.accend):(b=pa(e.acc,e.accend),a.push(b))}return a};e.mapPointToSpan=function(a,b,c){if(0<this._spans.length){var d,e,n,r;this._page.pushShow();var v=[],t;for(r=0;r<this._spans.length;r++)if(n=this._spans[r],!n.hasClass("oit-hiddentext")&&(!c||n.equals(c)||n.isDescendantOf(c))&&(e=n.spanRect())&&0<e.width&&0<e.height){e=b<e.top?e.top-b:b>e.bottom?b-e.bottom:0;if(void 0===t||e<t)v.length=0,t=e;
e==t&&v.push(n)}t=void 0;if(1==v.length)d=v[0];else for(r=0;r<v.length;r++)if(n=v[r],e=Math.abs(n.distanceFromPoint(a,b)),void 0===t||e<t)d=n,t=e;this._page.popShow();return d}};e.findOverlappingText=function(a){if(0<this._spans.length){var b=[];this._page.pushShow();for(var c=0;c<this._spans.length;c++){var e=this._spans[c].overlapRange(a);e&&b.push(e)}this._page.popShow();if(0<b.length)return b}};e.findRange=function(a,b){for(var c=[],e=0;e<this._spans.length;e++){var k=this._spans[e];k.acc<=b&&
k.accend>a&&c.push(k)}if(0<c.length)return c};e.findACC=function(a){for(var b=[],c=0;c<this._spans.length;c++){var e=this._spans[c];a>=e.acc&&a<e.accend&&b.push(e)}if(0<b.length)return b};return c}(),nb=function(){var c=/\S/,e=function(a,b,c){var d=W.getElementById(c);d?V.call(this,d):V.call(this,"div","oit-section oit-"+b+" oit-pending",c);this.prop("index",a);this.data("page",this);this._needArrange=!0;this._staticContent=!!this.firstChildElem()},a=X(e,V);a.processData=function(a){var c=this.isEmailHeader(),
d={},e=!1,f=!1,g;for(g in a){var l=a[g],k=null,m=!1;switch(g){case "embeds":case "frames":case "fields":case "attachments":case "comments":k="_"+g;break;case "data":case "src":k="_"+g+"URL";break;case "section":case "name":case "type":case "dpi":case "autodpi":case "hiddenFromSlideshow":k=g;break;case "acc":case "accend":k=g;m=!0;break;case "w":c||this.css("width",l);k="width";l=parseInt(l,10);m=!0;break;case "h":c||this.css("height",l);k="height";l=parseInt(l,10);m=!0;break;case "oid":(l=z.overlayById(a.oid))&&
l!==this.overlay&&(k="overlay",f=!0);break;case "background":this.css("background",l)}k&&!this.hasOwnProperty(k)&&(d[k]={value:l,writable:m,enumerable:!1},e=!0)}"sn"!==this.type||this.width||(c=z.page(this.index-1))&&c.width&&(d.width={value:c.width,writable:!1,enumerable:!1},e=!0,this.css("width",c.css("width")),F.layoutChanged());e&&Object.defineProperties(this,d);f&&this.overlay.add(this);a.content&&!this.isLoaded()&&(!0===this.deferContent?this.deferredContent=a.content:b(this,a.content));!this._ssmodel&&
a.ssdata&&(this._ssmodel=new nd(a.ssdata,this._embeds,this));if(a.comments){if(this.supportsAnnotations()){e=d=!1;ka.infoRaw();for(f=0;f<a.comments.length;f++)c=a.comments[f],c.range&&c.text?d=!0:e=!0;d&&E.hiddenContent("comments");e&&E.hiddenContent("comments-unsupported")}else E.hiddenContent("comments-unsupported");this.overlay.hasAnnotations(!0)}"sn"===a.type&&E.hiddenContent("speaker-notes");a.hiddenFromSlideshow&&E.hiddenContent("hidden-slides");a.hidden_columns&&E.hiddenContent("hidden-columns");
a.hidden_rows&&E.hiddenContent("hidden-rows");this._staticContent&&(v(this,!1),M(this))};a.supportsAnnotations=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":case "worksheet":case "database":return!0}return!1};a.supportsAnnotationPane=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":return!0}return!1};a.supportsAnnotationBar=function(){switch(this.type){case "worksheet":case "database":return!0}return!1};
var b=function(a,b){var c=x.create("div");c.html(b);var d=c.byClass("oit-view");if(d&&0<d.length)for(c=0;c<d.length;c++){var e=d[c].byClass("oit-section");if(e)for(var f=0;f<e.length;f++){var h=e[f],g=z.pageById(h.id);g&&!g.firstChildElem()&&(u.baseURL&&t(h),g.transferFrom(h),g.addClass(h.attr("class")))}}else u.baseURL&&t(c),a.transferFrom(c),a._needArrange=!0};a.destroy=function(){this.unload();V.prototype.destroy.call(this)};a.unload=function(){var a=this.isLoaded();this.abortLoad();this._needArrange=
!0;this._selRect&&(this._selRect.destroy(),delete this._selRect);this._ssmodel&&(this._ssmodel.unload(),delete this._ssmodel);this._spanMap&&(this._spanMap.destroy(),delete this._spanMap);this._annotationPane&&(this._annotationPane.destroy(),delete this._annotationPane);0<this.loadedSize&&(this.pageContentChanged(),this.html(""),this.addClass("oit-pending"),this.loadedSize=0);this.logUnload&&this.logUnload();a&&z.on.pageunload.dispatch(this)};a.show=function(a){var b;if(this.isHidden()){a=a||{};this.finishAnimation();
a.animate&&this.css("opacity",0);if(!this.parent()){var c;if(!a.insertLast)for(var d=this.index+1;;d++){b=z.page(d);if(!b||b.overlay!==this.overlay)break;if(!b.isHidden()){c=b;break}}c?this.overlay.insert(this,c):this.overlay.append(this);this._annotationPane&&this._annotationPane.show()}a.animate?(void 0===a.time&&(a.time=a.animate?150:0),a.opacity=1,this.animate(a)):a&&a.endFn&&a.endFn();"vertical"===w.scrollMode&&(b=z.page(this.index+1))&&"sn"===b.type&&w.showSlideNotes&&b.show()}else a&&a.endFn&&
a.endFn();return this};a.hide=function(){var a=x.unwrap(this).parentNode;a&&(this.finishAnimation(),a.removeChild(this.dom),this._annotationPane&&this._annotationPane.hide(),"vertical"===w.scrollMode&&(a=z.page(this.index+1))&&"sn"===a.type&&a.hide());return this};a.pushShow=function(){this._showState?this._showState.count++:(this._showState={count:1},this.parent()||(this._showState.pageHidden=!0,this.show(),this._annotationPane&&this._annotationPane.show()),this.overlay.isDisplayed()||(this._showState.overlayUndisplayed=
!0,this.overlay.display()),this.overlay.isHidden()&&(this._showState.overlayHidden=!0,this.overlay.show()),"none"===this.computedStyle().display&&(this._showState.pageDisplayNone=!0,this.css("display","block")))};a.popShow=function(){this._showState&&(this._showState.count--,0>=this._showState.count&&(this._showState.pageDisplayNone&&this.css("display",null),this._showState.overlayHidden&&this.overlay.hide(),this._showState.overlayUndisplayed&&this.overlay.undisplay(),this._showState.pageHidden&&
(this.hide(),this._annotationPane&&this._annotationPane.hide()),delete this._showState))};a.isHidden=function(){return this._hidden||!this.parent()||!this.overlay||this.overlay.isHidden()||!this.overlay.isDisplayed()};a.filter=function(a){return a!==this.index};a.info=function(){var a={page:this.index,type:this.type,typeEx:this.type,features:Ha.features(this.type),comments:!!this._annotationPane};if("slide"==a.type){var b=z.page(this.index+1);b&&"sn"===b.type?a.notes=!0:x.byId(this.id+".note")?a.notes=
!0:a.notes=!1}else"rt"==a.type?(0<this.index&&"email"==z.page(this.index-1).type&&(a.type="email"),"rt"==a.type&&(a.type="html")):"sn"==a.type&&(a.type="slide",a.notes=!0);void 0!=this.hiddenFromSlideshow&&(a.hiddenFromSlideshow=this.hiddenFromSlideshow);void 0!==this.acc&&(a.acc=this.acc,void 0!==this.accend&&(a.accend=this.accend));this.width&&this.height&&(a.width=this.width,a.height=this.height);return a};a.features=function(){return Ha.features(this.type)};a.isEmailHeader=function(){return this.hasClass("oit-emailheaderpage")||
"emailheader"===this.id||"emailheader.1"===this.id};a.isPending=function(){return this.hasClass("oit-pending")};a.isLoading=function(){return this.hasClass("oit-loading")};a.isLoaded=function(){return!this.hasClass("oit-pending")&&!this.hasClass("oit-loading")};a.isEnabled=function(){return"slideshow"!=w.presentationMode?!0:"slide"!=this.type||!this.hiddenFromSlideshow};a.mapPointToText=function(a,b,c,d){var e;d?e=this.annotationPane().mapPointToSpan(a,b,c):(d=this.getSpanMap())&&(e=d.mapPointToSpan(a,
b,c));if(e){var f=e.textAngle();c=e.spanRect();d=c.left;var h=c.top,g=c.right,B=c.bottom;if(0!==f){c=[{x:d,y:h},{x:g,y:h},{x:g,y:B},{x:d,y:B}];d=Math.cos(f);h=Math.sin(f);for(g=0;g<c.length;g++)B=c[g].x-a,f=c[g].y-b,c[g].x=a+B*d+f*h,c[g].y=b+-B*h+f*d;d=g=c[0].x;h=B=c[0].y;for(f=1;4>f;f++){var l=c[f];l.x<d?d=l.x:l.x>g&&(g=l.x);l.y<h?h=l.y:l.y>B&&(B=l.y)}}e=e.findClosestChar(a,b);e.overlaps=a>=d-2&&a<=g+2&&b>=h-2&&b<=B+2;return e}};a.findTextBoundary=function(a,b,c){a=Ab(a);if(ia&&void 0!==a&&(a+=b,
b=ia.findBoundaryStart(a,c),c=ia.findBoundaryEnd(b,c),void 0!==b&&void 0!==c)){c=pa(b,c);if(this._frames){var d,e;for(b=0;b<this._frames.length;b++){var f=this._frames[b];a>=f.acc&&a<f.accend&&(void 0===d?(d=f.acc,e=f.accend):(f.acc<d&&(d=f.acc),f.accend>e&&(e=f.accend)))}c.acc<d&&(c.acc=d);c.accend>e&&(c.accend=e)}if(d=this.findTextRange(c))return gc(d)}};a.resetCache=function(){delete this._cachedRects;if(this._annotationPane)this._annotationPane.onResize(!0)};var d=function(a){var b=a._cachedRects;
b||(b=a._cachedRects={});var c=u.viewNode,d=c.clientWidth,e=c.clientHeight,f=c.scroll(),c=f.left,f=f.top,g=a.offsetLeft;a=a.offsetTop;var l=w.zoom,k=w.rotation;if(b.viewWidth!=d||b.viewHeight!=e||b.scrollLeft!=c||b.scrollTop!=f||b.offsetLeft!=g||b.offsetTop!=a||b.zoom!=l||b.rotation!=k)b.view=null,b.overlay=null,b.pos=null,b.viewWidth=d,b.viewHeight=e,b.scrollLeft=c,b.scrollTop=f,b.offsetLeft=g,b.offsetTop=a,b.zoom=l,b.rotation=k;return b};a.pageRect=function(a){var b=d(this);if("view"===a||"overlay"===
a){var c=b[a];c||((c=F.pageRect(this.index,a))&&c.readonly(!0),b[a]=c);return c}b.page||(b.page=F.pageRect(this.index,this));return b.page};a.pagePos=function(a){if("overlay"===a)return a=d(this),a.pos||(a.pos=this.pos(this.overlay)),a.pos;if("view"===a){a=this.pagePos("overlay");a={left:a.left,top:a.top};var b=F.padding();b&&(a.left+=b.left,a.top+=b.top);if(b=F.scrollOffset())a.left-=b.left,a.top-=b.top;return a}};a.inAnnotation=function(a){var b=!1;if("text"===a.type&&!this.findRange(a.acc,a.accend,
"page")){var c;this._annotationPane&&(c=this._annotationPane.findRange(a.acc,a.accend));if(c)b=!0;else if(this._comments)for(c=0;c<this._comments.length;c++){var d=this._comments[c];if(d.text){for(var e=0;e<d.text.length;e++){var f=d.text[e].range;if(f&&gb(a,f)){b=!0;break}}if(b)break}}}return b};a.containsRange=function(a){if("text"!==a.type)return a.page==this.index;var b=!1,c;if(a.acc<=this.accend&&a.accend>=this.acc){switch(this.type){case "worksheet":case "database":(b=this.spreadsheetModel())&&
!b.hasPendingContent()?(b=b.containsRange(a),b||(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)))):b=!0;break;default:if(this._frames)for(c=0;c<this._frames.length;c++){var d=this._frames[c];if(a.acc<=d.accend&&a.accend>=d.acc){b=!0;break}}!b&&this.isLoaded()&&(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)));b||this._frames||this.isLoaded()||(b=!0)}!b&&this._comments&&(b=z.isAnnotationText(a.acc,
a.accend,this._comments))}return b};var g=function(a,b){return a.acc-b.acc},k=function(a,b){if(b&&0<b.length){b.sort(g);for(var c=[],d,e=a.isEmailHeader(),f=0;f<b.length;f++){var h=b[f];void 0!==h.acc&&(!e&&d&&d.accend+1>=h.acc?h.accend>d.accend&&(d.accend=h.accend):(d=pa(h.acc,h.accend),c.push(d)))}return c}};a.mapRectRangeToText=function(a){if("rect"===a.type){var b=this.getSpanMap();if(b)return a=new ba(a,this),k(this,b.findOverlappingText(a))}};a.textRanges=function(){var a=this.getSpanMap();
if(a)return k(this,a.textRanges())};a.mapRangeToEmbeds=function(a){var b;if(this._embeds&&("rect"===a.type||"cell"===a.type)&&(a=F.rangeRect(a,this)))for(var c=0;c<this._embeds.length;c++){var d=this._embeds[c],e=this.embeddingRect(d.uid);if(e&&e.overlaps(a)){var f=e.left,g=e.top;e.intersect(a);e.offset(-f,-g);b||(b=[]);d=mb(d.uid,this.index,e.left,e.top,e.right,e.bottom);va(d,"pct");b.push(d)}}return b};a.embeddingByIndex=function(a){var b;this._embeds&&0<=a&&a<this._embeds.length&&(b=this._embeds[a]);
return b};a.embeddingByUID=function(a){var b;this._embeds&&(b=bb(this._embeds,"uid",a));return b};a.embeddingRect=function(a){if(this._embeds&&(a=bb(this._embeds,"uid",a))){var b;if(a.position)b=a.position,b=new ba(b.left,b.top,b.right,b.bottom,this);else{var c=a.x,d=a.y;if(void 0===c||void 0===d){var e=x.byId(a.id);e&&(e=z.elementRect(e,this),void 0===c&&(c=e.left),void 0===d&&(d=e.top))}void 0!=c&&void 0!=d&&(b=new ba(c,d,c+a.w,d+a.h,this))}return b}};a.textBoundingRect=function(a,b){if(this.isLoaded()&&
"text"===a.type){var c;if(this.isSpreadsheet())z.activeOverlay()==this.overlay&&(c=F.rangeRect(a,this));else{this.pushShow();var d=this.findRange(a.acc,a.accend,b);if(d&&0<d.length){for(var e=La(d[0]),f=0;f<d.length;f++){var h=d[f].textRect(a);if(h){var g=La(d[f]);x.unwrap(g)===x.unwrap(e)&&(c?c.union(h):c=h)}}c||1!=d.length||(c=d[0],e=ga(a),e.accend==c.acc&&e.accend++,c=d[0].textRect(e))}this.popShow()}return c}};a.frameForRange=function(a){var b;if(this.isLoaded()&&this._frames&&"text"===a.type)for(var c=
0;c<this._frames.length;c++){var d=this._frames[c];if(a.accend>=d.acc&&a.acc<d.accend){b=x.byId(d.id);break}}return b};a.textRects=function(a,b,c){if(c||"text"!==a.type)Array.isArray(c)&&(c=c.slice());else{if(this.isSpreadsheet()&&z.activeOverlay()==this.overlay){var d=F.rangeRect(a,b);d&&(e=[new hc(d)])}c=this.findRange(a.acc,a.accend)}if(c&&0<c.length){var e;this.pushShow();c.sort(function(a,b){var c=a.spanRect(),d=b.spanRect(),e=c.top-d.top;e||(e=c.left-d.left);return e});for(var f,h=[],d=0;d<
c.length;d++){var g=c[d].textRect(a);g&&(f&&bc(g.top,f.top)&&bc(g.bottom,f.bottom)&&g.left<=f.right+1?f.union(g):(f=g,h.push(f)))}this.popShow();if(0<h.length)for(e||(e=[]),a=new hc(h[0]),e.push(a),d=1;d<h.length;d++)if(c=h[d],8>c.width||8>c.height)a.add(c);else{for(var g=c.left-5,l=c.right+5,B=c.top-2,p=c.bottom+2,k=a.length-1;0<=k;k--)if(f=a.item(k),l>=f.left&&g<=f.right&&p>=f.top&&B<=f.bottom){a.add(c);c=null;break}c&&(a=new hc(c),e.push(a))}e&&("overlay"!==b&&"view"!==b||aa(e,"convert",null,b));
return e}};a.accRect=function(a,b){var c,d=pa(a,a+1);if(this.isSpreadsheet())c=F.rangeRect(d,b);else{var e=this.findACC(a);if(e&&0<e.length){this.pushShow();for(var f=La(e[0]),h=0;h<e.length;h++){var g=e[h].textRect(d);if(g){var l=La(e[h]);x.unwrap(l)===x.unwrap(f)&&(c?c.union(g):c=g)}}c&&(c.origin=b);this.popShow()}}return c};a.findTextRange=function(a){if("text"===a.type&&a.acc<=this.accend&&a.accend>=this.acc&&this.isLoaded()){var b=[],c=!1;if(this._frames&&"email"!==this.type)for(var d=0;d<this._frames.length;d++){var e=
this._frames[d];if(a.acc<=e.accend&&a.accend>=e.acc)if((e=W.getElementById(e.id))&&0===e.childNodes.length){var f=W.createRange();f.setStart(e,0);f.setEnd(e,0);b.push(f)}else c=!0}else c=!0;c&&(c=a.acc===a.accend?this.findACC(a.acc):this.findRange(a.acc,a.accend))&&aa(c,"findTextRange",null,a,b);if(0<b.length)return b}};a.layer=function(a){if(this.overlay)return this.selectionRect(),this.overlay.layer(a)};a.hasSelectionRect=function(){return!!this._selRect};a.selectionRect=function(){if(!this._selRect){var a=
this.overlay?this.overlay.layer("selection"):void 0;this._selRect=new tb(this.index,a,"oit-sel-rect");this._selRect.hide()}return this._selRect};a.showSelectionRect=function(a){this._selRect&&this._selRect.show(a)};a.findRange=function(a,b,c){var d;c=c||"all";if("all"===c||"page"===c){var e=this.getSpanMap();e&&(d=e.findRange(a,b))}!this._annotationPane||"all"!==c&&"annotations"!==c||(a=this._annotationPane.findRange(a,b))&&(d=d?d.concat(a):a);return d};a.findACC=function(a){var b,c=this.getSpanMap();
c&&(b=c.findACC(a));this._annotationPane&&(a=this._annotationPane.findACC(a))&&(b=b?b.concat(a):a);return b};a.pageContentChanged=function(){delete this._cachedRects;this._spanMap&&(this._spanMap.destroy(),delete this._spanMap)};a.pageLayoutChanged=function(){delete this._cachedRects;this._spanMap&&this._spanMap.discardLayout();if(this._annotationPane)this._annotationPane.onResize(!0)};a.isSpreadsheet=function(){return this._ssmodel||this._dataURL};a.spreadsheetModel=function(){return this._ssmodel};
a.getSpanMap=function(){void 0===this._spanMap&&this.isLoaded()&&(this.isSpreadsheet()?this._spanMap=null:this._spanMap=new Mc(this));return this._spanMap};var n=function(a){if(a.showProgressDialog&&void 0!==a.srcSize&&void 0!==a.dataSize){var b=a.srcSize+a.dataSize;262144<=b&&(b=100*(a.srcLoaded+a.dataLoaded)/b,a.progressDialog||(a.progressDialog=ua.createProgressDialog(U.PLEASE_WAIT_INITIALIZING,!0)),a.progressDialog&&a.progressDialog.update(b))}},r=function(a){if(void 0===a.srcRequest&&void 0===
a.dataRequest&&a.isLoading()){E.resumeIdleTimer("pageload");a.logLoad&&a.logLoad();a.removeClass("oit-loading");a.pageContentChanged();z.touchPage(a.index);a.loadedSize=0;a.dataSize&&(a.loadedSize+=a.dataSize);a.srcSize&&(a.loadedSize+=a.srcSize);z.applyMemoryLimit(a.loadedSize);a.deferredContent&&(b(a,a.deferredContent),delete a.deferredContent,delete a.deferContent);v(a,!0);a.progressDialog&&(a.progressDialog.hide(),delete a.progressDialog);delete a.showProgressDialog;if(a.completionFuncs){for(var c=
0;c<a.completionFuncs.length;c++)a.completionFuncs[c](a);delete a.completionFuncs}delete a.locked;M(a)}},v=function(a,b){var c;a&&"email"==a.type&&(c=a.childByClass("oit-emailheader"),c||(c=a.byId("oit-emailheader"))&&c.addClass("oit-emailheader"),c&&(a.addClass("oit-emailheaderpage"),c=new od(c),a._emailHeader=c));(c=a.childByClass("oit-email_page"))&&!c.firstChildElem()&&c.css("display","none");if("sn"===a.type){c=x.create("div","oit-noteheader");c.html('<span class="oit-notesicon"></span><span class="oit-unselectable"> '+
U.NOTES+"</span>");var d=a.firstChildElem();d.addClass("oit-sn-content");a.insert(c,d)}a.hiddenFromSlideshow&&(c=x.create("div","oit-hiddenpage"),c.attr("title",U.HIDDEN_SLIDE),a.append(c));A(a,a._comments);a.processRevisions();a.processSSRevisions();a.positionAnnotations();z.on.pageload.dispatch(a,!!b)},t=function(a){a=x.wrap(a);if(u.baseURL){a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT);for(var b;b=a.nextNode();)if("IMG"===b.tagName){var c=b.getAttribute("src");c&&("/"!=c.charAt(0)&&(c=Sa(u.baseURL,
c)),b.setAttribute("src",c))}else"image"===b.tagName&&(c=b.getAttribute("xlink:href"))&&("/"!=c.charAt(0)&&(c=Sa(u.baseURL,c)),b.setAttribute("xlink:href",c))}};a.abortLoad=function(){this.isLoading()&&(this.srcRequest&&(eb(this.srcRequest),delete this.srcRequest),this.dataRequest&&(eb(this.dataRequest),delete this.dataRequest),this.removeClass("oit-loading"),this.addClass("oit-pending"))};a.load=function(a,b){var c=this.isPending(),d=this.isLoading();(c||d)&&(this._srcURL||this._dataURL)?d?b&&this.completionFuncs.push(b):
(this.srcLoaded=this.srcSize=this.dataLoaded=this.dataSize=0,this.completionFuncs=[],b&&this.completionFuncs.push(b),this.removeClass("oit-pending"),this.addClass("oit-loading"),this.locked=!0,!0===a&&(this.showProgressDialog=!0),c=u.baseURL,this._dataURL&&(d=this._dataURL,c&&"/"!=d.charAt(0)&&(d=Sa(c,d)),this.dataRequest=ab({url:d,context:this,loading:q,complete:m})),this._srcURL&&(d=this._srcURL,c&&"/"!=d.charAt(0)&&(d=Sa(c,d)),this.srcRequest=ab({url:d,context:this,loading:l,complete:K})),(this.dataRequest||
this.srcRequest)&&E.pauseIdleTimer("pageload")):(c&&(this.removeClass("oit-pending"),v(this,!1)),b&&b(this))};var q=function(a,b,c){this.dataSize=b;c&&(this.dataLoaded=c.length);n(this)},m=function(a,b,c,d){this.dataSize=b;c&&(this.dataLoaded=c.length,n(this));if(200===d)try{var e=JSON.parse(c);this.processData({ssdata:e})}catch(ca){this.logAJAXError(null,"The data for page "+(this.index+1)+" is corrupt",a,d,c)}else this.logAJAXError(null,"Failed to load the data for page "+(this.index+1)+" from the server",
a,d,c);delete this.dataRequest;r(this)},l=function(a,b,c){this.srcSize=b;c&&(this.srcLoaded=c.length);n(this)},K=function(a,b,c,d){this.srcSize=b;c&&(this.srcLoaded=c.length,n(this));200===d?(this.deferContent=!0,ha.isICD(c)?ha.processICD(c,a,d):this.processData({content:c})):this.logAJAXError(null,"Failed to load the content for page "+(this.index+1)+" from the server",a,d,c);delete this.srcRequest;r(this)},M=function(a){var b=ka.infoRaw();if(b&&1557===b.fi){var c=(b=a.firstChildElem())?b.firstChildElem():
null,d=c?c.nextSiblingElem():null,e=d?d.nextSiblingElem():null,f=e?e.nextSiblingElem():null,g=c?c.firstChildElem():null,l=g?g.firstChildElem():null,k=d?d.firstChildElem():null,m=e?e.firstChildElem():null,p=m?m.firstChildElem():null,D=p?p.firstChildElem():null,q=D?D.firstChildElem():null;if(l&&!l.nextSiblingElem()&&k&&!k.nextSiblingElem()&&q&&!q.nextSiblingElem()){var t=m.size(),n=q.size(),r=!0;t&&n&&0<t.width&&0<t.height&&0<n.width&&0<n.height&&(r=n.height/t.height,r=.9<=n.width/t.width&&.9<=r);"DIV"==
b.tagName&&b.hasClass("oit-svg")&&"DIV"==c.tagName&&c.hasClass("oit-svg-layer")&&"DIV"==d.tagName&&d.hasClass("oit-frame")&&"DIV"==e.tagName&&e.hasClass("oit-svg-layer")&&"svg"==g.tagName&&"rect"==l.tagName&&"DIV"==k.tagName&&k.hasClass("oit-svg-text")&&"svg"==m.tagName&&"g"==p.tagName&&p.hasClass("oit-pagescale")&&"g"==D.tagName&&D.hasClass("oit-framescale")&&"image"==q.tagName&&!f&&r&&(a="#"+a.id.replace(".","\\.")+" .oit-svg-text",E.screenCSS(a+" div","color:rgba(0,0,0,0);"),E.screenCSS(a+" span",
"color:rgba(0,0,0,0);"),b.append(d))}}};a.comments=function(){return this._comments};var I=function(a,b){if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)I(a[c],b);else if(a.range&&"text"===a.range.type){if(void 0===b.acc||a.range.acc<b.acc)b.acc=a.range.acc;if(void 0===b.accend||a.range.accend>b.accend)b.accend=a.range.accend}},H=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)H(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=ia.getRawText(a.range.acc,a.range.accend))},
O=function(a){var b="";if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)b+=O(a[c]);else a.range&&"text"===a.range.type&&a.text&&(b=a.text);return b},C=function(a,b){if(a.isEmpty())b._annotationPane.destroy(),delete b._annotationPane;else{b.supportsAnnotationBar()&&z.createAnnotationBar();var c=a.range();c&&(c.acc<b.acc&&(b.acc=c.acc),c.accend>b.accend&&(b.accend=c.accend));w.showAnnotations&&a.layout()}},R=function(a,b){a._annotationPane||(a._annotationPane=new pd(a),w.showAnnotations?a._annotationPane.show():
a._annotationPane.hide(),T.addAutoscrollRoot(a._annotationPane.scrollPane()));a._annotationPane.processAnnotations(b,C,a)},A=function(a,b,c){if(b&&a.supportsAnnotations()){for(var d={},e=0;e<b.length;e++){var f=b[e];I(f.text,d);I(f.author,d);I(f.author_short,d);I(f.last_save_date,d);I(f.create_date,d);I(f.date,d)}void 0!==d.acc?ia.loadRawText(d.acc,d.accend,function(){for(var d=0;d<b.length;d++){var e=b[d];H(e.text);H(e.author);H(e.author_short);H(e.last_save_date);H(e.create_date);H(e.date)}c&&(b=
c(a,b));R(a,b)}):(c&&(b=c(a,b)),R(a,b))}};a.processRevisions=function(){if(this.isLoaded()&&this.supportsAnnotations()){var a=E.revisions();if(a){for(var b=[],d=0;d<a.length;d++){var e=a[d];e.range&&this.findRange(e.range.acc,e.range.accend,"page")&&b.push(e)}b.length&&A(this,b,function(a,b){for(var d=0;d<b.length;d++){var e=b[d],f=b[d-1];if(f&&e.range&&f.range&&("add"===e.type&&"delete"===f.type||"delete"===e.type&&"add"===f.type)){var h=O(e.author),g=O(f.author),l=O(e.last_save_date||e.create_date),
k=O(f.last_save_date||f.create_date);h===g&&l===k&&(f.range.acc==e.range.acc&&f.range.accend==e.range.accend?"add"===f.type?b.splice(d-1,1):b.splice(d,1):(h=O(e.text),g=O(f.text),f.range.accend===e.range.acc&&c.test(h)&&c.test(g)&&(h=b[d-1]={type:"change",id:e.id,author:e.author,last_save_date:e.last_save_date,create_date:e.create_date},"add"===e.type?(h.range=e.range,h.text=e.text,h.oldtext=f.text):(h.range=f.range,h.text=f.text,h.oldtext=e.text),b.splice(d,1))))}}return b})}}};a.processSSRevisions=
function(){var a=z.ssRevisions();this._ssmodel&&a&&!this.processedSSRevisions&&(this.processedSSRevisions=!0,this._ssmodel.processRevisions(a,function(){A(this,this._ssmodel.revisions())},this))};a.positionAnnotations=function(){this._annotationPane&&w.showAnnotations&&this._annotationPane.layout()};a.annotationPane=function(){return this._annotationPane};return e}(),Hc=function(){var c=function(a,b){var c={index:{value:a},length:{get:function(){return this.firstPage?this.lastPage.index-this.firstPage.index+
1:0}}};b.name&&(c.name={value:b.name});b.hidden&&(c.hidden={value:!0},E.hiddenContent("hidden-pages"));Object.defineProperties(this,c);(c=W.getElementById(b.oid))?V.call(this,c):(c="oit-overlay",b.cls&&(c=-1==b.cls.indexOf(c)?c+(" "+b.cls):b.cls),V.call(this,"article",c,b.oid));u.viewNode.append(this);this.undisplay();this.hidden?this.hide():this.show()},e=X(c,V);e.updateCSS=function(){"text"!==w.selectionMode||ua.modalOverlayVisible()?this.addClass("oit-unselectable"):this.removeClass("oit-unselectable");
"rect"===w.selectionMode?this.css("cursor","crosshair"):this.css("cursor",null)};e.item=function(a){if(this.firstPage)return z.page(this.firstPage.index+a)};e.add=function(a){this.append(a);this.firstPage||(this.firstPage=a);this.lastPage=a;if(!this.maxWidth||a.width>this.maxWidth)this.maxWidth=a.width;if(!this.maxHeight||a.height>this.maxHeight)this.maxHeight=a.height;this._pagesHidden&&a.hide()};e.containsPage=function(a){return z.page(a).overlay==this};e.display=function(){if(this.layers){var a=
F.activeOverlay()===this;$a(this.layers,"show",null,a)}this.css("display","block");this.updateCSS()};e.undisplay=function(){this.layers&&$a(this.layers,"hide");this.css("display",null)};e.isDisplayed=function(){return"block"===this.css("display")};e.show=function(){!1!==this._isHidden&&(this._isHidden=!1,z.on.overlayshow.dispatch(this))};e.hide=function(){!0!==this._isHidden&&(this._isHidden=!0,this.undisplay(),z.on.overlayhide.dispatch(this))};e.isHidden=function(){return void 0!==this._isHidden?
this._isHidden:this.hidden};e.showPages=function(a){this.each("show",a);this._pagesHidden=!1};e.hidePages=function(a){this.each("hide",a);this._pagesHidden=!0};e.hasAnnotations=function(a){void 0!==a&&(this._hasAnnotations=!!a);return!!this._hasAnnotations||!!E.revisions()};e.each=function(a,b){yb(this,arguments)};e.layer=function(a){var b;this.layers&&(b=this.layers[a]);b||(b=new ld(u.drawing,a,this.id+"."+a),this.layers||(this.layers={}),this.layers[a]=b);return b};return c}(),cb=function(){var c=
function(a,b){this.id=a;this.range=ga(b.range);this.type=b.type;b.style&&(this._style=b.style);b.cls&&(this._class=b.cls);b.comment&&(this._comment=b.comment);b.label&&(this._label=b.label);b.properties&&(this._properties=b.properties);b.options&&this.setOptions(b.options);if(b.compound&&(this._compound=!0,Array.isArray(b.compound))){this._cRanges=[];for(var c=0;c<b.compound.length;c++){var d=ga(b.compound[c]);"rect"===d.type&&va(d,"px");this._cRanges.push(d)}}this._pageInfo=[];"rect"===this.range.type&&
(void 0!==this.range.embedId?va(this.range,"pct"):va(this.range,"px"));this.range=xa(this.range,!0);Q.map(this)},e=X(c);e.isNote=function(){return!1};e.isRedaction=function(){return!1};e.isCompoundRedaction=function(){return!1};e.isEmptyRedaction=function(){return!1};e.setRange=function(a){return void 0!==a&&0!==Na(a,this.range)?("cell"==this.range.type&&this.eachPage(function(a,b){A(b,z.page(a.index))},null,this),Q.unmap(this),this.range=ga(a),Q.map(this),delete this._cRanges,"text"==a.type&&this._compound&&
(this._cRanges=[a]),this.updateStyle(),Q.alignHighlight(),Q.on.move.dispatch(this),!0):!1};e.updateStyle=function(){this._hidden||this.eachPage(a,null,this)};var a=function(a,b){var c=a.index;b.removeFromPage(a);b.addToPage(c)};e.filter=function(a){if(a){if("string"===typeof a)return this[a]();if(a instanceof nb)return this.isOnPage(a.index);if(a instanceof Hc)return this.isInOverlay(a);if(!a(this.id,this._properties))return!1}return!0};e.properties=function(a){void 0!==a&&(this._properties=a);return this._properties};
e.property=function(a,b){void 0!==b&&(this._properties||(this._properties={}),this._properties[a]=b);if(this._properties)return this._properties[a]};e.style=function(a){a&&(this._style=a,this.updateStyle());return this._style};e.highlightStyle=function(){var a=this.style();this._active||"opacity"!==w.highlightActivationStyle||(a=this.highlightStyleProps(),a=$b(a));return a};e.highlightStyleProps=function(){var a=ib(this.style());if(!this._active&&"opacity"===w.highlightActivationStyle){var b=a["background-color"];
b&&(b=Ga(b))&&(b.a*=.4,a["background-color"]=Ja(b))}return a};e.intervalStyleProps=function(){var a=this.highlightStyleProps()["background-color"];a&&(a=Ga(a));if(a)return a.a*=.25,a=Ja(a),{"background-color":a}};e.fillStyle=function(){if("text"!==this.range.type)return this._style};e.css=function(a){return db(this._style,a)};e.matches=function(a,b,c,d,e){return this._style===a&&0===Na(this.range,b)&&this._properties===c&&this._comment===d&&this._label===e};var b=function(a,b){b&&b.autodpi?va(a,"pct"):
b&&"bitmap"===b.type?va(a,"px"):va(a,"tw")};e.serialize=function(){var a={type:this.type},c,d;a.range=ga(this.range);"rect"===a.range.type&&(void 0!==a.range.embedId?va(a.range,"pct"):(c=z.page(a.range.page),b(a.range,c)));if(this.ttrects){var e=[],f;for(f in this.ttrects){var h=this.ttrects[f];if(h){c=z.page(f);for(var g=0;g<h.length;g++)d=h[g].toRange(c),b(d,c),e.push(d)}}a.ttrects=[].concat.apply([],e)}this._style&&(a.style=this._style);this._properties&&(a.properties=this._properties);"string"===
typeof this._comment&&(a.comment=this._comment);this._label&&(a.label=this._label);this._options&&(a.options=this._options);if(this._cRanges)for(a.compound=[],c=0;c<this._cRanges.length;c++)d=ga(this._cRanges[c]),"rect"===d.type&&(void 0!==d.embedId?va(d,"pct"):va(d,"tw")),a.compound.push(d);return a};e.destroy=function(){this.destroyDialog();this.eachPage(d,null,this);Q.unlink(this);this.deleteAll()};var d=function(a,b){b.removeFromPage(a)};e.getOption=function(a){if("text"==this.range.type){if("enableUserMove"===
a)return!1;if("enableUserResize"===a)for(var b in this._pageInfo){if(z.page(Number(b)).isSpreadsheet())return!1;break}}return(b=this._options)&&void 0!==b[a]?b[a]:!0};e.setOptions=function(a){if(a&&(f(this,"enableUserDelete",a,!0),f(this,"enableUserComment",a,!0),f(this,"enableUserResize",a,!0),"text"!==this.range.type&&f(this,"enableUserMove",a,!0),this._options)){a=!1;for(var b in this._options)if(this._options.hasOwnProperty(b)){a=!0;break}a||delete this._options}};e.comment=function(a){void 0!==
a&&(this._comment=null===a?void 0:String(a),this.updateComment(void 0,this._comment));return this._comment};e.dialog=function(a){var b=this._dialog;b?(b.abortAnimation(),b.show(!0)):b=this._dialog=new qd(this);b.loadComment();b.setMode(a);b.align();return b};e.alignDialog=function(a){this._dialog&&this._dialog.align(a)};e.hideDialog=function(){var a=this._dialog;a&&a.show(!1,{endFn:a.close,context:a})};e.exitDialog=function(){this._dialog&&this._dialog.exit()};e.destroyDialog=function(){this._dialog&&
this._dialog.destroy()};e.onDialogDestroy=function(a){a===this._dialog&&delete this._dialog};e.label=function(a){void 0!==a&&(this._label=null===a||""===a?void 0:String(a),this.eachPage(g,null,this));return this._label};var g=function(a,b){b.applyLabel(a)};e.showLabel=function(a){this._label&&(!1===a?this._labelVisible=!1:delete this._labelVisible,this.eachPage(g,null,this))};e.isOnPage=function(a){return!!this._pageInfo[a]};e.isInOverlay=function(a){var b=a.lastPage.index;for(a=a.firstPage.index;a<=
b;a++)if(this.isOnPage(a))return!0;return!1};var k=function(a,b){var c=a._pageInfo[b];c||(a._pageInfo[b]=c={index:b});return c};e.eachPage=function(a,b){sc(this._pageInfo,arguments)};e.activate=function(a){this.inAnnotation()&&(w.showAnnotations=!0);this.addToDocument();this._hidden&&(this.show(),this._autohide=!0,F.update());this._active=!0;this.eachPage(r,null,this);this.positionAll()};var n=function(a,b){if("text"===b.range.type&&"opacity"===w.highlightActivationStyle){var c=z.page(a.index).spreadsheetModel();
if(c&&!b.inAnnotation())c.updateHighlight(b);else{var d=1,c=-2;b._active&&(d=2,c=-1);var e=b.highlightStyleProps();a.spanList&&Rb(a.spanList,b.id,e,d);a.compoundSpanList&&aa(a.compoundSpanList,function(a,b){Rb(a.spans,b,e,d)},null,b.id);if(a.intervalSpanList){var f=b.intervalStyleProps();f&&aa(a.intervalSpanList,Rb,null,b.id|1E9,f,c)}}}},r=function(a,b){var c=a.drawingRect;b.oldFocusPage=void 0;if("text"===b.range.type)"opacity"===w.highlightActivationStyle?n(a,b):c&&(c.addClass("oit-highlight-active"),
c.setRange(b.range),b.getOption("enableUserResize")?c.ontextmove(b,v).ontextmoveend(b,q).showTextHandles():c.offtextmove(v).offtextmoveend(q).hideTextHandles(),c.activate());else if(c){c.addClass("oit-highlight-active");var d="cell"!==b.range.type;b.updateMoveable(!0,c);b.updateResizable({bindToObject:d,minWidth:10,minHeight:10},c);c.activate()}a.embedRect&&a.embedRect.show()};e.updateMoveable=function(a,b,c){c=c||b;if(!1!==a&&this.getOption("enableUserMove"))b.addClass("oit-moveable").ondragstart(this,
L,c).ondragmove(this,ca,c).ondragend(this,Y,c).ondragcancel(this,ma,c);else b.removeClass("oit-moveable").offdragstart(L).offdragmove(ca).offdragend(Y).offdragcancel(ma)};e.updateResizable=function(a,b,c){c=c||b;if(a&&this.getOption("enableUserResize"))c.resizable(!0,a).onresizemove(this,N).onresizeend(this,J);else c.resizable(!1).offresizemove(N).offresizeend(J)};var v=function(a){var b=a.range;a=a.page;var c=z.pagesForRange(b);a!=this.oldFocusPage&&(this.oldFocusPage=a,this.eachPage(t,null,c,this));
this._pageInfo[a.index]||this.addToPage(a.index,!0);this._cRanges&&(this._cRanges=[b]);R(this,a,this.highlightStyle(),b);this.alignDialog({animate:!1})},t=function(a,b,c){a.spanList&&(a=a.index,bb(b,"index",a)||A(c,z.page(a)))},q=function(a){this.setRange(a.range)};e.deactivate=function(){this._active&&(delete this._active,this.eachPage(m,null,this),this._autohide&&(this.hide(),delete this._autohide,F.update()))};var m=function(a,b){var c=a.drawingRect;c&&c.removeClass("oit-highlight-active").deactivate();
"text"===b.range.type?"opacity"===w.highlightActivationStyle&&n(a,b):c&&(b.updateMoveable(!1,c),b.updateResizable(!1,c));a.embedRect&&a.embedRect.hide()};e.show=function(){if(void 0!==this._hidden){var a=this._hidden;delete this._hidden;if(0<a.length){for(var b=0;b<a.length;b++)this.addToPage(a[b]);Q.link(this)}else this.addToDocument()}delete this._autohide};e.hide=function(){this._hidden||(this._hidden=[],this.eachPage(l,null,this),Q.unlink(this))};var l=function(a,b){b._hidden.push(a.index);b.removeFromPage(a)};
e.collapse=function(){};e.isHidden=function(){return!(!this._hidden&&!this._autohide)};var u=function(a,b){var c,d=a._pageInfo[b.index];if(d){if(!d.boundingRects)if(d.spanList||d.compoundSpanList){var e;if(d.spanList)e=b.textRects(a.range,b,d.spanList);else{var f=[];for(c=0;c<d.compoundSpanList.length;c++)Array.prototype.push.apply(f,d.compoundSpanList[c].spans);for(c=0;c<a._cRanges.length;c++){var h=b.textRects(a._cRanges[c],b,f);e?Array.prototype.push.apply(e,h):e=h}}if(e)for(c=0;c<e.length;c++)for(f=
e[c],h=0;h<f.length;h++){var g=f.item(h).clone();g.readonly(!0);d.boundingRects||(d.boundingRects=[]);d.boundingRects.push(g.clone())}}else"text"===a.range.type&&(c=b.textBoundingRect(a.range)),c||(c=F.rangeRect(a.range,b)),c&&(c=c.clone(),c.readonly(!0),d.boundingRects=[c]);return d.boundingRects}},M=function(a,b,c){var d;if(b){c=c||b;if("text"===a.range.type){var e=u(a,b);if(e){d=e[0].clone();for(var f=1;f<e.length;f++)d.union(e[f]);d.origin=c}}d||(d=F.rangeRect(a.range,c||b))}return d};e.boundingRectList=
function(a){var b=[];this.eachPage(I,null,a,b,this);if(0<b.length)return b};var I=function(a,b,c,d){(a=M(d,z.page(a.index),b))&&c.push(a)};e.addToDocument=function(a){if(!this._hidden){var b=z.pagesForRange(this.range);if(b){for(var c=0;c<b.length;c++)this.addToPage(b[c].index,!1,a);!1!==a&&Q.link(this)}}};var H=function(a){a.highlightLayer||(O(a),a.highlightLayer=a.layer("highlights"));return a.highlightLayer},O=function(a){a.compoundHighlightLayer||(a.compoundHighlightLayer=a.layer("chighlights"));
return a.compoundHighlightLayer};e.addToPage=function(a,b,c){var d=z.page(a),e=this._pageInfo[a];e&&b&&(this.removeFromPage(e),e=null);if(!this._hidden&&(!e||e.needRect||e.needApply)&&d&&d.isLoaded()&&!d.isHidden()&&(b||d.containsRange(this.range))){var f;delete this._inComment;d.pushShow();e&&e.needApply||(e=R(this,d,this.highlightStyle(),this.range));e&&delete e.boundingRects;if(Q.batchMode())e&&(e.needApply=!0);else{b="text"!==this.range.type||"opacity"!==w.highlightActivationStyle;var h=!1;b&&
(f=M(this,d,"overlay"),f||(e&&(e.needRect=!0),h=!0));if(!h){e?(delete e.needRect,delete e.needApply):e=k(this,a);void 0===this.range.embedId||e.embedRect||(e.embedRect=new tb(a,H(d)),e.embedRect.addClass("oit-highlight-embed"),e.embedRect.hide());if(b&&!e.drawingRect&&(e.drawingRect=this.createDrawingRect(d.index,H(d)),e.drawingRect&&(Q.on.addElement(e.drawingRect,this),d.inAnnotation(this.range))))e.drawingRect.onwheel(this,function(a){var b=d.annotationPane();if(b)return b.scrollPane().redirectEvent(a)});
(b=this.fillStyle())?(e.styleDiv||(e.styleDiv=x.create("div","oit-highlight-style"),e.drawingRect&&e.drawingRect.append(e.styleDiv)),e.styleDiv.attr("style",b)):e.styleDiv&&(e.styleDiv.destroy(),delete e.styleDiv);this._label&&this.applyLabel(e);C(this._pageInfo[a],this,f);this.updateComment(e,this._comment)}}!1!==c&&Q.link(this);F.update(!1,!0);d.popShow()}};e.removeFromPage=function(a){"number"==typeof a&&(a=this._pageInfo[a]);if(a){var b=a.index;A(this,z.page(b));a.commentFlag&&(a.commentFlag.destroy(),
delete a.commentFlag);a.drawingRect&&(Q.on.removeElement(a.drawingRect,this),a.drawingRect.destroy());a.embedRect&&a.embedRect.destroy();this._pageInfo[b]=null;F.update(!1,!0)}};e.createDrawingRect=function(a,b){var c;"text"===this.range.type?"opacity"!==w.highlightActivationStyle&&(c=new kd(a,b),c.setRange(this.range)):c=new tb(a,b);return c};e.distanceFromPoint=function(a,b,c,d){var e;a=z.page(a);if(a=u(this,a))for(var f=0;f<a.length;f++){var h=a[f];if(!(h.origin instanceof nb)==d&&(h=h.distanceFrom(b,
c,"nearest","nearest","xy"),void 0===e||h.ay<e.ay||h.ay==e.ay&&h.ax<e.ax)&&(e=h,0===e.x&&0===e.y))break}return e};var C=function(a,b,c){var d;if(a){d=a.index;var e=z.page(d);if(e.isHidden()||!e.isEnabled()){a.drawingRect&&a.drawingRect.hide();a.embedRect&&a.embedRect.hide();if(a.cRects)for(d=0;d<a.cRects.length;d++)a.cRects[d].rect.hide();a.needRect=!0}else if("text"===b.range.type)a.drawingRect&&a.drawingRect.show().changed();else if(c||(c=M(b,e,"overlay")),c){a.drawingRect&&a.drawingRect.show().move(c.left,
c.top,c.width,c.height);a.embedRect&&(c=z.page(d).embeddingRect(b.range.embedId))&&(c.origin="overlay",a.embedRect.show().move(c.left,c.top,c.width,c.height));if(a.cRects)for(d=0;d<a.cRects.length;d++)e=a.cRects[d],(c=F.rangeRect(e.range,"overlay"))&&e.rect.show().move(c.left,c.top,c.width,c.height);b.updateComment(a,b._comment)}}};e.positionAll=function(){this.eachPage(C,null,this)};e.generateKey=function(){var a,b=z.pagesForRange(this.range);if(b&&void 0===this.prevId&&void 0===this.nextId)for(var c=
0;c<b.length;c++){var d=b[c];this.key&&this.key.page!=d.index&&delete this.key;this.key||(this.key={page:d.index,x:0,y:0});if(this.inAnnotation())this.key.x=this.range.acc,this.key.y=9999999;else if(d.isEmailHeader()&&"text"===this.range.type)this.key.x=this.range.acc,this.key.y=0;else if(d.spreadsheetModel()){var e;"cell"===this.range.type?(e=this.range,this.key.x=0,this.key.y=e.r1*d.spreadsheetModel().colCount()+e.c1):"text"===this.range.type?(this.key.x=this.range.acc,this.key.y=-1):delete this.key}else{e=
void 0;if(d&&(d=u(this,d))){e=d[0].left;for(var f=d[0].top,h=1;h<d.length;h++){var g=d[h];if(g.top<f||g.top==f&&g.left<e)e=g.left,f=g.top}e={left:e,top:f}}(d=e)?(this.key.x=d.left,this.key.y=d.top):delete this.key}if(this.key){a=this.key;break}}else delete this.key;return a};e.inAnnotation=function(){void 0===this._inComment&&(this._inComment=z.inAnnotation(this.range));return this._inComment};e.applyLabel=function(a){if(a&&a.drawingRect)if(this._label&&!1!==this._labelVisible){var b=this.css("background-color"),
c;a:{if(b&&(c=Ga(b))){c.r=255-c.r;c.g=255-c.g;c.b=255-c.b;c=Ja(c.r,c.g,c.b);break a}c=void 0}c||(b=null);a.drawingRect.setLabel(this._label,c,b)}else a.drawingRect.setLabel(null)};var R=function(a,b,c,d){var e=null,f=0,h,g,l,p,m,B;a._active?f=2:"opacity"===w.highlightActivationStyle&&(f=1);var y=T.saveSelection();A(a,b);if(a._compound){if(a._cRanges||(a._cRanges=z.decomposeRange(d,!0)),a._cRanges){(p=b.spreadsheetModel())&&p.addHighlight(a)&&(e||(e=k(a,b.index)));var q="rect"===d.type,t;for(p=0;p<
a._cRanges.length;p++){m=a._cRanges[p];if("text"===m.type){if(l||(l=ib(c)),l&&(g=Fb(b,m,l,a.id,void 0,f))){e||(e=k(a,b.index));e.compoundSpanList||(e.compoundSpanList=[]);for(var n=0;n<g.length;n++)if(h=g[n].split(m))for(B=0;B<h.length;B++)Q.on.addElement(h[B],a);e.compoundSpanList.push({spans:g,range:m})}}else if(g=F.rangeRect(m,"overlay"))h=new tb(b.index,O(b)),c&&(B=x.create("div","oit-highlight-style"),B.attr("style",c),h.append(B)),h.move(g.left,g.top,g.width,g.height),e||(e=k(a,b.index)),e.cRects||
(e.cRects=[]),e.cRects.push({range:m,rect:h});q&&(m="text"===d.type?b.textBoundingRect(m):F.rangeRect(m,b))&&(t?t.union(m):t=m)}if(w.highlightTermIntervals&&"text"===a.range.type&&1<a._cRanges.length&&(f=-2,a._active&&(f=-1),d=a.intervalStyleProps())){c=[];g=a.acc;for(p=0;p<a._cRanges.length;p++)m=a._cRanges[p],m.acc>g&&c.push(pa(g,m.acc)),g=m.accend;for(p=0;p<c.length;p++)if(m=c[p],g=Fb(b,m,d,a.id|1E9,void 0,f))e||(e=k(a,b.index)),e.intervalSpanList||(e.intervalSpanList=[]),e.intervalSpanList.push(g)}t&&
(b=F.rangeFromRect(b.index,t.left,t.top,t.right,t.bottom,b,"highlight"))&&(a.range=b)}}else if("text"===d.type&&((p=b.spreadsheetModel())&&p.addHighlight(a)&&(e=k(a,b.index)),l=ib(c))&&(g=Fb(b,d,l,a.id))){e||(e=k(a,b.index));e.spanList=g;for(p=0;p<g.length;p++)if(h=g[p].split(d))for(B=0;B<h.length;B++)Q.on.addElement(h[B],a);if((p=ka.infoRaw())&&1557===p.fi)for(a.ttrects||(a.ttrects=[]),a=a.ttrects[b.index]=[],p=0;p<g.length;p++)g[p].hasClass("oit-tt")&&(b=g[p].textRect(d))&&a.push(b)}y&&T.restoreSelection(y);
return e},A=function(a,b){var c,d=a._pageInfo[b.index];if(d){var e=T.saveSelection(),f=b.spreadsheetModel();f&&("text"===a.range.type||a._compound)&&f.removeHighlight(a);if(d.spanList){for(c=0;c<d.spanList.length;c++)if(f=d.spanList[c].split(a.range))for(var h=0;h<f.length;h++)Q.on.removeElement(f[h],a);Qb(d.spanList,a.id);delete d.spanList;b.pageLayoutChanged()}d.compoundSpanList&&(aa(d.compoundSpanList,function(b,d){var e=b.range,f=b.spans;for(c=0;c<f.length;c++){var h=f[c].split(e);if(h)for(var g=
0;g<h.length;g++)Q.on.removeElement(h[g],a)}Qb(f,d)},null,a.id),delete d.compoundSpanList,b.pageLayoutChanged());d.intervalSpanList&&(aa(d.intervalSpanList,Qb,null,a.id|1E9),delete d.intervalSpanList,b.pageLayoutChanged());if(d.cRects){for(c=0;c<d.cRects.length;c++)if(f=d.cRects[c].rect)Q.on.removeElement(f,a),f.destroy();delete d.cRects}e&&T.restoreSelection(e)}},f=function(a,b,c,d){var e=!1;c=c[b];void 0!==c&&(c==d?(d=a._options)&&void 0!==d[b]&&(delete d[b],e=!0,a.optionChanged(b)):(a._options||
(a._options={}),a._options[b]=!!c,e=!0,a.optionChanged(b)));return e};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.id===Q.active()&&this.activate(!0)}};var h=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?a.drawingRect&&(b?(a.commentFlag||(a.drawingRect.onmouseenter(this,B).onmouseleave(this,y),a.commentFlag||(a.commentFlag=new za(a.drawingRect,{hpos:"right",vpos:"top",margin:2,classList:"oit-comment-flag"}))),a.commentFlag.show()):
a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag)):this.eachPage(h,null,b,this)};var B=function(a){this.id!=Q.active()&&Q.showComment(this.id)},y=function(a){this.id!=Q.active()&&Q.hideComment(this.id)},L=function(a,b){if(this.getOption("enableUserMove")){var c=b.position();this._moveable={startRect:c.clone(),curRect:c.clone()};return!1}return!0},ca=function(a,b){if(this._moveable){var c=this.range,d,e=this._moveable.startRect;d=this._moveable.curRect;var f=a.delta;d.left=e.left+f.x;d.top=
e.top+f.y;"cell"!==c.type||c.offsets?d=F.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId):(this.moveOriginalRect||(this.moveOriginalRect=F.rangeRect(c,d.origin)),e=this.moveOriginalRect.clone(),e.left=d.left,e.top=d.top,d=F.rangeFromRect(c.page,e.left,e.top,e.right,e.bottom,e.origin,"move",c.embedId),e=c.c2-c.c1,f=c.r2-c.r1,d.c2-d.c1<e&&(d.c2=d.c1+e),d.r2-d.r1<f&&(d.r2=d.r1+f),delete d.offsets);0!==Na(d,c)&&(d=F.rangeRect(d,"overlay"),b.move(d.left,d.top,d.width,d.height),
this._active&&this._comment&&this._dialog&&this._dialog.align({rect:d,animate:!1}))}return!1},Y=function(a,b){if(this._moveable){var c=this.range,d=this._moveable.curRect,d=F.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId);if("cell"===d.type&&!c.offsets){delete this.moveOriginalRect;var e=c.c2-c.c1,c=c.r2-c.r1;d.c2-d.c1<e&&(d.c2=d.c1+e);d.r2-d.r1<c&&(d.r2=d.r1+c);delete d.offsets}this.setRange(d);delete this._moveable}return!1},ma=function(a,b){if(this._moveable){var c=
a.center;Q.activateNearest(c.x,c.y,a.srcEvent);delete this._moveable}return!1},N=function(a){var b=this.range,c=a.drawingRect;a=a.newRect;var d=F.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==d.type||b.offsets||delete d.offsets;if(d=xa(d,!0))b=F.rangeRect(d,"overlay"),"rect"===d.type&&(a=b),c.move(b.left,b.top,b.width,b.height);this._active&&this._comment&&this._dialog&&this._dialog.align({rect:a,animate:!1})},J=function(a){var b=this.range;a=a.newRect;a=
F.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==a.type||b.offsets||delete a.offsets;a=xa(a,!0);this.setRange(a)};return c}(),bd=function(){var c=function(a,b){cb.call(this,a,b)},e=X(c,cb);e.isRedaction=function(){return!0};e.isCompoundRedaction=function(){return!0===this._compound};e.isEmptyRedaction=function(){return!0===this._compound&&!this._cRanges};e.style=function(a){a=w.redactionColor;return"color:"+a+";background-color:"+a+";"};e.fillStyle=function(){if("text"!==
this.range.type){var a;if(a=!this._compound||"rect"!==this.range.type&&"cell"!==this.range.type?w.redactionColor:w.redactionFillColor)return"background-color:"+a+";"}};e.css=function(a){if("color"===a||"background-color"===a)return w.redactionColor};return c}(),cd=function(){var c=function(a,b){cb.call(this,a,b);this._newNote=!0;this._state="oit-note-pinned";this._pinned=!0;this._hidden=this._hover=this._active=this._editing=!1},e=X(c,cb);e.isNote=function(){return!0};e.isEditing=function(){return this._editing};
e.isHidden=function(){return this._hidden};e.removeFromPage=function(a){this.endEditText(!1);cb.prototype.removeFromPage.call(this,a)};e.activate=function(a){if(!this._active||a)this._active=!0,this.updateState(a)};e.deactivate=function(){this._active&&(this._active=!1,this.updateState())};e.show=function(){this._hidden&&(this._hidden=!1,this.updateState())};e.hide=function(){this._hidden||(this._hidden=!0,this.updateState())};e.pin=function(){this._pinned||(this._pinned=!0,this.updateState())};e.unpin=
function(){this._pinned&&(this.endEditText(!0),Q.active()==this.id&&Q.deactivate(),this._pinned=!1,this.updateState())};e.beginEditText=function(a){void 0!==a&&(this._newNote=a);this._editing||(this._editing=!0,u.editingComment++,this.updateState())};e.endEditText=function(a){this._editing&&(!1===a&&(this.buttons.textArea.value=Q.comment(this.id)),this._editing=!1,u.editingComment--,this.updateState(),this._newNote&&(a?delete this._newNote:Q.remove(this.id)))};e.ok=function(){this.endEditText(!0);
return!1};e.cancel=function(){this.endEditText(!1);return!1};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.updateState(!0)}};var a=function(){this.addClass("oit-note-expanding")},b=function(){this.removeClass("oit-note-expanding")},d=function(){this.addClass("oit-note-collapsing")},g=function(){this.removeClass("oit-note-collapsing")};e.updateState=function(c){var e;e=this._editing?"oit-note-editing":this._active?this._pinned?"oit-note-active":"oit-note-shown":
this._hidden?"oit-note-hidden":this._pinned?"oit-note-pinned":this._hover?"oit-note-hover":"oit-note-iconic";var k=this.noteRect;if(k){if(e!=this._state||c){var m=this._state;this._state=e;k.removeClass(m).addClass(e);switch(m){case "oit-note-editing":Q.comment(this.id,this.buttons.textArea.value);ua.showModalOverlay(!1);this.buttons.iconBar.focus();k.layer().removeClass("oit-note-layer-edit");k.removeClass("oit-highlight-active").deactivate();break;case "oit-note-hidden":k.show();break;case "oit-note-iconic":"oit-note-hidden"!==
e&&(c=this.originalRect,k.move(c.left,c.top,c.width,c.height,{timems:200,startFn:a,endFn:b}));break;case "oit-note-active":k.removeClass("oit-highlight-active").deactivate();case "oit-note-pinned":"oit-note-active"!==e&&"oit-note-pinned"!==e&&(this.updateMoveable(!1,this.buttons.iconBar,k),this.updateResizable(!1,k))}this.positionAll();switch(e){case "oit-note-hidden":k.hide();break;case "oit-note-iconic":this.originalRect=k.position().clone();c=this.collapsedRect={left:this.originalRect.right-20,
top:this.originalRect.top,width:20,height:20};"oit-note-hidden"===m?k.move(c.left,c.top,c.width,c.height):k.move(c.left,c.top,c.width,c.height,{timems:200,startFn:d,endFn:g});break;case "oit-note-editing":k.layer().addClass("oit-note-layer-edit");k.addClass("oit-highlight-active").activate(!1,!0);Q.activate(this.id);ua.showModalOverlay(!0);e=this.buttons.textArea;e.blur();e.focus();this._newNote&&e.moveCaret(e.value.length||0);break;case "oit-note-active":k.addClass("oit-highlight-active").activate(!1,
!0);case "oit-note-pinned":this.updateMoveable(!0,this.buttons.iconBar,k),this.updateResizable({bindToObject:"cell"!==this.range.type,minWidth:60,minHeight:45,margin:-5},k)}}k.update()}};e.createDrawingRect=function(a,b){var c=new tb(a,b),d={};this.noteRect=c;this.buttons=d;c.addClass("oit-note").addClass("oit-note-pinned");d.iconBar=new za(c,{classList:"oit-note-icons",inheritMoveable:!0});d.iconBar.attr("tabindex","-1");d.cancel=new za(d.iconBar,{classList:"oit-note-cancel",title:U.DISCARD_CHANGES});
d.cancel.onclick(this,this.cancel).ontap(this,this.cancel);d.ok=new za(d.iconBar,{classList:"oit-note-ok",title:U.SAVE_CHANGES});d.ok.onclick(this,this.ok).ontap(this,this.ok);d.pin=new za(c,{classList:"oit-note-pin"});d.pin.onmouseenter(this,k).onmouseleave(this,n).onclick(this,r).ontap(this,r);d.textArea=new lc;d.textArea.onfocus(this,t).ontap(this,v);d.textForm=x.create("form");d.textForm.append(d.textArea);c.append(d.textForm);this.updateState(!0);return c};var k=function(a){this._hover=!0;this.updateState()},
n=function(a){this._hover=!1;this.updateState()},r=function(a){this._pinned?this.unpin():this.pin();return!1},v=function(a){this.buttons.textArea.blur();this.buttons.textArea.focus()},t=function(a){this.getOption("enableUserComment")?this.beginEditText():this.buttons.textArea.blur()},q=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?this._hidden||this._editing||!this.buttons||(this.buttons.textArea.value=b||""):this.eachPage(q,null,b,this)};return c}(),dd=function(){var c=function(c,
a){cb.call(this,c,a);a.name&&(this._name=a.name);a.sizing&&(this._sizing=a.sizing);a.opacity&&(this._opacity=a.opacity);if(!this._style){var b="background:url("+Q.stamp(this._name).url+") no-repeat";1!=this._opacity&&(b+=";opacity:"+this._opacity);"scale"===this._sizing?b+=";background-size:contain":"stretch"===this._sizing&&(b+=";background-size:100% 100%");this._style=b}};X(c,cb).serialize=function(){var c=cb.prototype.serialize.call(this);c.stamp=this._name;c.opacity=this._opacity;c.sizing=this._sizing;
delete c.style;return c};return c}(),qd=function(){var c=200,e=150,a=function(a){var b="#000",c=a.css("background-color");c&&(c=ac(c,"#FFFFFF"));if(c){var e=Ga(c);128>e.r&&128>e.g&&128>e.b&&(b="#FFF")}Lc.call(this,{ok:!0,cancel:!0,className:"oit-dialog-comment",resultFn:d,destroyFn:g,textColor:b,backgroundColor:c});this._highlight=a},b=X(a,Lc),d=function(a,b){"view"!==a._mode&&(c=a.width(),e=a.height(),"new"!==a._mode||b&&a._textarea.value?(b&&a.saveComment(),Q.active()===a._highlight.id?a.setMode("view"):
a._highlight.exitDialog()):(Q.remove(a._highlight.id),T.select(null)))},g=function(a){a.setMode(null);a._highlight.onDialogDestroy(a)};b.setMode=function(a){if(a!==this._mode){if("edit"===this._mode||"new"===this._mode)u.editingComment--,this.removeClass("oit-comment-edit");this._mode=a;switch(a){case "view":this._highlight.comment()?(this._textarea&&(this._textarea.destroy(),delete this._textarea),this._label||(this._label=this.addLabel(null),this._label.onclick(this,k).ontap(this,k).onmouseenter(this,
n).onmouseleave(this,r)),this.resizable(!1),this.modal(!1),this.showFooter(!1),this.maxsize(c,e),this._mode=a,this.loadComment(),this.align(),this.show()):this._highlight.exitDialog();break;case "edit":case "new":u.editingComment++,this.addClass("oit-comment-edit"),this.modal(!0),this.align({endFn:v,context:this})}}};var k=function(){this._highlight.getOption("enableUserComment")&&this.setMode("edit")},n=function(){Q.showComment(this._highlight.id)},r=function(){var a=this._highlight.id,b=Q.active();
a!=b&&(Q.hideComment(a),void 0!==b&&Q.showComment(b))},v=function(){this.show(!0,{endFn:t,context:this})},t=function(){this._label&&(this._label.destroy(),delete this._label);this._textarea||(this.resetForm(),this._textarea=this.addTextArea(null),this._textarea.onfocus(this,q));this.loadComment();this.resizable(!0,180,100);this.showFooter(!0);this.maxsize(0,0);this._textarea&&this._textarea.focus&&this._textarea.focus()},q=function(){var a=this._textarea;a&&("number"==typeof a.selectionStart?a.selectionStart=
a.selectionEnd=a.value.length:"undefined"!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select()))};b.loadComment=function(){var a=this._highlight.comment()||"";this._textarea?this._textarea.value=a:this._label&&this._label.text(a)};b.saveComment=function(){this._textarea&&Q.comment(this._highlight.id,this._textarea.value,!0)};b.align=function(a){var b;a:{var d=a?a.rect:null;if(this){var g=this._highlight,k=g.isNote(),m,q,t;if(d)"view"!==d.origin&&(d=d.clone(),d.origin=
"view"),k?(b=d.left,m=d.top,q=d.right-d.left,t=d.bottom-d.top):(b=d.right+10,m=d.top);else if(d=g.boundingRectList("view"))for(g=0;g<d.length;g++){var n=d[g];k?(b=n.left,m=n.top,q=n.right-n.left,t=n.bottom-n.top):(b=n.right+10,m=n.top);0>m&&0<=n.bottom&&(m=0);if(0<=b&&0<=m)break}if(void 0!=b){10>b&&(b=10);10>m&&(m=10);k=u.viewNode.pos();b+=k.left;m+=k.top;if(q&&t){b={left:b,top:m,width:q,height:t};break a}b={left:b,top:m};break a}}b=void 0}b&&(m=b.width||c,q=b.height||e,"view"===this._mode?this.autoSize(b.left,
b.top,m,q,a):this.move(b.left,b.top,m,q,a))};return a}(),Pb=function(){var c=function(a,b,c,d,e){this.prop("id",a);this._edge=b;this._visible=!1;this._autoSize=!0;this._resizable=this._overlay=!1;this._height=this._width=void 0;switch(this._edge){case "top":this._dimension="height";this._border="borderBottom";this._direction=1;break;case "bottom":this._dimension="height";this._border="borderTop";this._direction=-1;break;case "left":this._dimension="width";this._border="borderRight";this._direction=
1;break;case "right":this._dimension="width",this._border="borderLeft",this._direction=-1}this._frame=x.create("div","oit-toolframe");this._toolbar=x.create("div","oit-toolbar oit-toolbar-"+this._edge);this._toolsParent=x.create("div","oit-toolbar-tool");this._toolsElem=c;this._content=x.create("div","oit-toolcontent");this._toolbar.append(this._toolsParent);this._toolsParent.append(this._toolsElem);this._frame.append(this._toolbar,this._content);d&&(x.unwrap(this._toolbar).style[this._border]=d);
a=e?e._content:u.rootNode;this._content.transferFrom(a);a.append(this._frame)},e=X(c);e.filter=function(a){return a===this.id};e.refresh=function(){this.applySize()};e.isInternal=function(){return 0>this.id};var a=function(a){this._startSize=this.size();return!1},b=function(a){var b=this._startSize;switch(this._edge){case "top":b+=a.delta.y;break;case "bottom":b-=a.delta.y;break;case "left":b+=a.delta.x;break;case "right":b-=a.delta.x}this.setSize(b);return!1},d=function(a){delete this._startSize;
return!1};e.overlay=function(a){"boolean"===typeof a&&((this._overlay=a)?this._toolbar.addClass("oit-toolbar-overlay"):this._toolbar.removeClass("oit-toolbar-overlay"),this._visible&&(this.hide(),this.show()));return this._overlay};e.resizable=function(c,e,n,r){"boolean"===typeof c&&((this._resizable=c)?("number"==typeof e&&"number"==typeof n&&"string"==typeof r&&(this._collapseSize=e,this._minSize=n,this._collapseHeader=x.create("div","oit-toolcollapse"),this._collapseHeader.html(r),this._toolbar.append(this._collapseHeader)),
this._toolbar.addClass("oit-toolbar-resizable"),this._resizeHandle||(this._resizeHandle=x.create("div","oit-toolresize"),this._resizeHandle.html("<div></div>"),this._resizeHandle.ondragstart(this,a),this._resizeHandle.ondragmove(this,b),this._resizeHandle.ondragend(this,d),this._resizeHandle.ondragcancel(this,d),this._resizeHandle.kinetic(!1),this._toolbar.append(this._resizeHandle))):(this._collapseHeader&&this._collapseHeader.destroy(),delete this._collapseSize,delete this._minSize,delete this._collapseHeader,
this._toolbar.removeClass("oit-toolbar-resizable"),this._resizeHandle&&(this._resizeHandle.destroy(),delete this._resizeHandle)),this._visible&&(this.hide(),this.show()));return this._resizable};e.remove=function(){var a=this._frame.parent();a&&(a.transferFrom(this._content),this._frame.destroy());this.isInternal()||ya.on.remove.dispatch(this.id,this._edge)};e.isVisible=function(){return this._visible};e.show=function(a){var b=this._toolbar;a=a||{};if(!this._visible){this._autoSize=this._visible=
!0;this._toolbar.css("display","block");if(void 0===this._borderSize&&(this._borderSize=0,x.unwrap(this._toolbar).style[this._border])){var c=this._toolbar.computedStyle();c&&(this._borderSize=parseInt(c[this._border+"Width"],10))}this.applySize(a.size,!0);this.isInternal()||ya.on.show.dispatch(this.id,this._edge,b.offsetWidth,b.offsetHeight)}this.dispatchSize(a.refresh)};e.hide=function(){this._visible&&(this._visible=!1,this._toolbar.css("display",null),this.applySize(),this.isInternal()||ya.on.hide.dispatch(this.id,
this._edge))};e.size=function(){return"width"===this._dimension?this._toolbar.innerWidth:this._toolbar.innerHeight};e.setSize=function(a){if("auto"===a)this._toolbar.css(this._dimension,null),this._autoSize=!0,this.applySize();else{this._visible&&void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._toolbar.css(this._dimension,a);this._autoSize=!1;switch(this._edge){case "top":case "bottom":this._resizeHandle&&(a-=this._resizeHandle.offsetHeight);break;case "left":case "right":this._resizeHandle&&
(a-=this._resizeHandle.offsetWidth)}this.applySize(a)}};e.applySize=function(a,b,c){if(void 0!==a||void 0===this._startSize){var d=this._toolbar,e=this._content,g=this._toolsElem,k=this._frame;if(this._visible){this._autoSize&&d.removeCSS(["bottom","top","right","left",this._dimension]);if(void 0===a){switch(this._edge){case "top":case "bottom":this._autoSize?this._size=g.offsetHeight:(this._size=d.offsetHeight,this._resizeHandle&&(this._size-=this._resizeHandle.offsetHeight));break;case "left":case "right":this._autoSize?
this._size=g.offsetWidth:(this._size=d.offsetWidth,this._resizeHandle&&(this._size-=this._resizeHandle.offsetWidth))}a=this._size}void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._collapseSize&&(a<this._collapseSize?this._collapsed||(this._collapseHeader.css("display","block"),this._toolsParent.css("display","none"),this._collapsed=!0):this._collapsed&&(this._collapseHeader.css("display",null),this._toolsParent.css("display",null),this._collapsed=!1));void 0!==this._borderSize&&(a+=
this._borderSize);var g=k.clientWidth,k=k.clientHeight,m=u.rootNode.clientWidth-10,l=u.rootNode.clientHeight-10;switch(this._edge){case "top":this._visible&&this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>l&&(a=l));d.css("bottom",k-a+"px");this._overlay||e.css("top",a+"px");break;case "bottom":this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>l&&(a=l));d.css("top",k-a+"px");this._overlay||e.css("bottom",a+"px");break;case "left":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,
a>m&&(a=m));d.css("right",g-a+"px");this._overlay||e.css("left",a+"px");break;case "right":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,a>m&&(a=m)),d.css("left",g-a+"px"),this._overlay||e.css("right",a+"px")}}else if(!this._overlay)switch(this._edge){case "top":e.css("top",0);break;case "bottom":e.css("bottom",0);break;case "left":e.css("left",0);break;case "right":e.css("right",0)}!0!==b&&this.dispatchSize(c)}};e.dispatchSize=function(a){var b=0,c=0;this._visible&&(this._collapsed?(b=this._collapseHeader.clientWidth,
c=this._collapseHeader.clientHeight):(b=this._toolsParent.clientWidth,c=this._toolsParent.clientHeight));if(a||b!=this._width||c!=this._height)this._width=b,this._height=c,ka.dispatchResize(),this.isInternal()?ya.on.resizeinternal.dispatch(this.id,this._edge,b,c,this._collapsed):ya.on.resize.dispatch(this.id,this._edge,b,c)};return c}(),Zc=function(){return function(){var c,e,a,b,d,g=[],k,n,r,v;this.show=function(){c&&c.show()};this.hide=function(){c&&c.hide()};this.length=function(){return g.length};
this.addPrevNext=function(c,g){if(!b){b=new Zb("\u25c4",U.PAGE_UP);c&&(b.onclick(c),b.ontap(c));d=new Zb("\u25ba",U.PAGE_DOWN);g&&(d.onclick(g),d.ontap(g));var k=x.create("div","oit-tab-nextprev");k.append(b,d);e.append(k);(k=k.size())&&k.width&&a.css("right",k.width+"px")}};this.addTab=function(b,c,d,e){var k=x.create("div","oit-tab");k.html("<div>"+b+"</div>");c&&k.addClass("oit-hidden");a.append(k);g.push(k);if(d instanceof Function)k.on("click",null,t,d,e).on("tap",null,t,d,e);return g.length-
1};var t=function(a,b,c){b(c)};this.showTab=function(a){0<=a&&a<g.length&&(g[a].css("display",null),q())};this.hideTab=function(a){0<=a&&a<g.length&&(g[a].css("display","none"),q())};this.tabClass=function(a,b){if(0<=a&&a<g.length){if(g[a].customClass){if(g[a].customClass===b)return;g[a].removeClass(g[a].customClass);delete g[a].customClass}b&&(g[a].addClass(b),g[a].customClass=b)}};this.setActiveTab=function(b){if(0<=b&&b<g.length&&b!=k&&(void 0!=k&&g[k].removeClass("oit-tab-selected"),k=b,g[k].addClass("oit-tab-selected"),
q(),void 0!==k)){b=g[k].rect(e);var c=a.rect(e),d=c.left;b.right>c.right?d-=b.right-c.right:0>b.left&&(d-=b.left);0<=d?a.css("left",null):a.css("left",d+"px")}};this.tabRect=function(a){if(0<=a&&a<g.length){a=g[k].rect(u.rootNode);a=new ba(a,"view");var b=u.viewNode.rect(u.rootNode);a.offset(-b.left,-b.top);return a}};this.destroy=function(){c&&ya.removeInternal(-2);e&&e.destroy();g=d=b=a=e=c=null};var q=function(){if(b){for(var a,c,e=0;e<g.length;e++)"none"!==g[e].css("display")&&(c=e,void 0===a&&
(a=e));b.disabled=k<=a;d.disabled=k>=c}};e=x.create("div","oit-tab-bar");a=x.create("div","oit-tab-list");e.append(a);a.kinetic(!0);a.ondragstart(function(b){b=a.rect(e);n=b.left;r=b.right;v=g[g.length-1].rect(e).right;return!1});a.ondragmove(function(b){var c=b.delta.x;b=n+c;0>b&&(c=v+c,c<r&&(b+=r-c));0<b&&(b=0);a.css("left",b+"px");return!1});c=new Pb(-2,"bottom",e,null,ya.internalParent(-2));ya.addInternal(-2,c);c.show()}}(),rd=function(){return function(){var c,e,a;this.show=function(){c&&c.show()};
this.hide=function(){c&&c.hide()};this.enable=function(){a.attr("disabled",null)};this.disable=function(){a.attr("disabled","disabled")};this.setText=function(b){b?a.attr("value",b):a.attr("value","")};this.destroy=function(){c&&ya.removeInternal(-4);e&&e.destroy();a=e=c=null};e=x.create("div","oit-formula-bar");var b=x.create("div","oit-formula-padding");a=x.create("input","oit-formula-text");a.attr("type","text");a.attr("readonly","readonly");b.append(a);e.append(b);c=new Pb(-4,"top",e,null,ya.internalParent(-4));
ya.addInternal(-4,c);c.show()}}(),Ea=function(){var c=function(a,c,e){this._size=c;this._hidden=!1;a?(this._hidden=!0===a.hidden,void 0!==a.h?this._size=a.h:void 0!==a.w&&(this._size=a.w),this._title=void 0!==a.t?a.t:e,void 0!==a.st&&(this._styleIndex=a.st),this._acc=a.acc,this._accend=a.accend):this._title=e;this._originalHidden=this._hidden;this._originalSize=this._size},e=X(c);e.acc=function(){return this._acc};e.accend=function(){return this._accend};e.clone=function(){var a=new c(null,this._size,
this._title);a._size=this._size;a._originalSize=this._originalSize;a._hidden=this._hidden;a._originalHidden=this._originalHidden;a._title=this._title;void 0!==this._styleIndex&&(a._styleIndex=this._styleIndex);void 0!==this._acc&&(a._acc=this._acc);void 0!==this._accend&&(a._accend=this._accend);void 0!==this._revisions&&(a._revisions=this._revisions);void 0!==this._deleted&&(a._deleted=this._deleted);this._data&&(a._data=this._data.slice(0));a.clonedFrom=this;return a};e.title=function(){return this._title};
e.style=function(){return this._styleIndex};e.revision=function(a){void 0!==a&&(this._revisions||(this._revisions=[],this.clonedFrom&&(this.clonedFrom._revisions=this._revisions)),this._revisions.push(a),"delete_col"===a.type||"delete_row"===a.type)&&(this._deleted=!0);return this._revisions};e.setCellData=function(a){var b;this._data=a;if(void 0===this._acc){for(a=0;a<this._data.length;a++)if((b=this._data[a])&&b.t&&void 0!==b.a){this._acc=b.a;break}if(void 0!=this._acc)for(a=this._data.length-1;0<=
a;a--)if((b=this._data[a])&&b.t&&void 0!==b.a){this._accend=b.a+b.t.length-1;break}}};e.hidden=function(){return this._hidden};e.originalHidden=function(){return this._originalHidden};e.deleted=function(){return!!this._deleted};e.show=function(a){return this._hidden||5>this._size?(this._hidden=!1,5>this._size&&(this._size=a),!0):!1};e.reset=function(){var a=!1;void 0!=this._originalSize&&(this._size=this._originalSize,a=!0);!this._hidden&&this._originalHidden&&(a=this._hidden=!0);return a};e.size=
function(){return this._hidden?0:this._size};e.setSize=function(a){if("number"!==typeof a)throw"Invalid argument to setSize";this._size=a;this._hidden=0===a};e.getCellsForRange=function(a,c){if(this._data&&void 0!==this._acc&&a<=this._accend&&c>=this._acc){for(var b,d=0;d<this._data.length;d++){var e=this._data[d];e&&e.t&&void 0!==e.a&&a<=e.a+e.t.length&&c>=e.a&&(b||(b=[]),b.push(e))}return b}};e.getIndexForCell=function(a){if(this._data){for(var b=0,c=0;c<this._data.length;c++){var e=this._data[c];
if(e&&e==a)break;e&&e.e?b+=e.e:b++}return b}};var a=function(a,c){if(a._data){if(void 0===a._getCellIndex||c<a._getCellIndex)if(a._cellDataIndex=0,a._getCellIndex=0,a._getCellEmpty=0,0<a._data.length){var b=a._data[0];b?b.e&&(a._getCellEmpty=b.e):a._getCellEmpty=1}for(;a._getCellIndex<c;){0<a._getCellEmpty&&a._getCellEmpty--;if(0===a._getCellEmpty){a._cellDataIndex++;if(a._cellDataIndex>=a._data.length){a._getCellIndex=c;return}b=a._data[a._cellDataIndex];a._getCellEmpty=b?b.e||0:1}a._getCellIndex++}if(a._cellDataIndex<
a._data.length)return a._cellDataIndex}};e.getCell=function(b){b=a(this,b);if(void 0!==b)return this._data[b]};e.insertCell=function(b){this._data&&void 0!==a(this,b)&&this._data.splice(this._cellDataIndex,0,null)};return c}(),nd=function(){var c={add_row:!0,delete_row:!0},e={add_col:!0,delete_col:!0},a={add_row:!0,delete_row:!0,add_col:!0,delete_col:!0,new_cell:!0,clear_cell:!0,modify_cell:!0,move_cells:!0},b=function(a,b,c){this._page=c;this._top=this._left=null;this._extRowCount=this._extColCount=
this._bottom=this._right=void 0;this._merged=null;this._ajaxLoading=this._ajaxPending=0;this._hideMsg=!1;this._cellGridChanged=!0;this._showAnnotations=!1;this._fonts=a.sheet.fonts;this._styles=a.styles;a.formulas&&(this._formulas=a.formulas);a.sheet.hasOwnProperty("s")?this._sheetStyle=this.cellStyle(a.sheet.s):this._sheetStyle={};this._colMajor="colmajor"===a.sheet.order;this._defColWidth=a.sheet.defcw||80;this._defRowHeight=a.sheet.defrh||20;a.cols||(a.cols=[]);a.rows||(a.rows=[]);this._colCount=
0<a.sheet.c?a.sheet.c:a.cols.length;this._rowCount=0<a.sheet.r?a.sheet.r:a.rows.length;this._cols=[];for(var d=0;d<a.cols.length;d++){var e=a.cols[d];if(void 0!==e.s)for(var f=e.e||e.s,h=e.s;h<=f;h++)c=Ma(h),this._cols[h]=new Ea(e,this._defColWidth,c);else c=Ma(d),this._cols[d]=new Ea(e,this._defColWidth,c)}this._rows=[];for(d=0;d<a.rows.length;d++)if(e=a.rows[d],void 0!==e.s)for(f=e.e||e.s,h=e.s;h<=f;h++)c=Ya(h),this._rows[h]=new Ea(e,this._defRowHeight,c);else c=Ya(d),this._rows[d]=new Ea(e,this._defRowHeight,
c);var g;a.cells&&(g=k(this,a.cells));if(a.data)for(this._data=a.data,a=0;a<this._data.length;a++)c=this._data[a],c.f&&this._ajaxPending++,c.iend=a+1<this._data.length?this._data[a+1].i-1:this._colMajor?this._colCount:this._rowCount;this._embeds=b;r(this,g)},d=X(b);d.showAnnotations=function(a){if(void 0!==a){var b=!1;!0!==a&&(a=!1);!0===a&&(this._annoRows||this._annoCols)?(this._annoRows&&this._rows!==this._annoRows&&(this._rows=this._annoRows,this._rowCount=this._annoRowCount,b=!0),this._annoCols&&
this._cols!==this._annoCols&&(this._cols=this._annoCols,this._colCount=this._annoColCount,b=!0)):(this._normalRows&&this._rows!==this._normalRows&&(this._rows=this._normalRows,this._rowCount=this._normalRowCount,b=!0),this._normalCols&&this._cols!==this._normalCols&&(this._cols=this._normalCols,this._colCount=this._normalColCount,b=!0));b&&(this._top=this._left=null,this._extRowCount=this._extColCount=this._bottom=this._right=void 0,this._cellGridChanged=!0,this._showAnnotations=a,delete this._accmap)}return this._showAnnotations};
d.cellGridChanged=function(a){void 0!==a&&(this._cellGridChanged=!!a);return this._cellGridChanged};d.getCellText=function(a,b){var c=this.getCell(a,b);return c?c.t||c.v||"":""};d.getCellComments=function(a,b,c){var d,e=this._page.comments();if(e)for(var f=0;f<e.length;f++){var h=e[f];if("cell"===h.type&&h.range&&"cell"===h.range.type){var g=h.range;this._showAnnotations&&h.annoRange&&(g=h.annoRange);a>=g.c1&&a<=g.c2&&b>=g.r1&&b<=g.r2&&(!c||g.c2==a&&g.r1==b)&&(d||(d=[]),d.push(h))}}return d};d.updateDimensions=
function(){this._right=this.colLeft(this._colCount);this._bottom=this.rowTop(this._rowCount);this._extColCount=this._colCount;this._extRowCount=this._rowCount;var a=this.embeddingCount();if(a){for(var b=0;b<a;b++){var c=this.embed(b);if(c){if(!c.expansionApplied){var d=this.embed(b);if(d.node&&!d.originApplied){d.originApplied=!0;d.adjustX=0;d.adjustY=0;var e=d.node.data("origin");e&&(e=e.split(","),2==e.length&&(d.adjustX=Number(e[0]),d.adjustY=Number(e[1])))}}var g=this.colWidth(c.c1),k=this.rowHeight(c.r1),
l=c.x1,m=c.y1;l>g&&(l=g);m>k&&(m=k);d=this.colLeft(c.c1)+l;e=this.rowTop(c.r1)+m;c.position={left:d,top:e};void 0===c.c2?(c.position.right=d+c.w,c.position.bottom=e+c.h):(g=this.colWidth(c.c2),k=this.rowHeight(c.r2),l=c.x2,m=c.y2,l>g&&(l=g),m>k&&(m=k),g=this.colLeft(c.c2)+l,m=this.rowTop(c.r2)+m,g<d&&(g=d),m<e&&(m=e),c.position.right=g,c.position.bottom=m);c.position.right>this._right&&(this._right=c.position.right);c.position.bottom>this._bottom&&(this._bottom=c.position.bottom)}}this._extColCount=
this.colFromX(this._right)+1;this._extRowCount=this.rowFromY(this._bottom)+1;this._right=this.colLeft(this._extColCount);this._bottom=this.rowTop(this._extRowCount)}};d.unload=function(){aa(this._data,function(a){a.ajax&&eb(a.ajax)});this._data=null;this._deferredTimer&&(E.resumeIdleTimer("loadDataForCells"),ta(this._deferredTimer),delete this._deferredTimer);this._embeds=this._styles=this._fonts=this._sheetStyle=this._merged=this._rows=this._cols=null};d.sheetStyle=function(){return this._sheetStyle};
d.webFonts=function(){return this._fonts};d.getFormulaText=function(a,b){var c=this.getCell(a,b);if(c){if(!c.fa&&void 0!==c.fm){var d;a:{if(this._formulas&&(d=this.getCell(a,b))&&"number"==typeof d.fm&&0<=d.fm&&d.fm<this._formulas.length){d=this._formulas[d.fm];break a}d=void 0}if(d){var e,f=b,h=d.f,g=0,k=0;e=a;if(this._showAnnotations)for(var l=0;l<e;l++){var p=this._cols[l];p&&p.title()==U.DEL&&e--}if(this._showAnnotations)for(l=0;l<f;l++)(p=this._rows[l])&&p.title()==U.DEL&&f--;c.fr||(g=e-d.c,
k=f-d.r);d=sd(h,g,k,E.externalLinks());c.fa="="+d;c.fr&&(c.fa="{"+c.fa+"}")}}return c.fa}};d.showHidden=function(a){if(a){this._showHidden||(this._showHidden={columns:!1,rows:!1});if("string"===typeof a)switch(a){case "all":this._showHidden.columns=!0;this._showHidden.rows=!0;break;case "none":this._showHidden.columns=!1;this._showHidden.rows=!1;break;case "columns":this._showHidden.columns=!0;break;case "rows":this._showHidden.rows=!0}else void 0!==a.sheets&&void 0!==a.columns&&void 0!==a.rows&&
(this._showHidden.columns=a.columns,this._showHidden.rows=a.rows);this.cellGridChanged(!0)}return this._showHidden};d.embeddingCount=function(){return this._embeds?this._embeds.length:0};d.embed=function(a){if(this._embeds&&0<=a&&a<this._embeds.length)return(a=this._embeds[a])&&!a.node&&(a.node=x.byId(a.id),!a.node||a.node.hasClass("oit-svg-embed")||a.node.hasClass("oit-image-embed")||(a.node=a.node.parent())),a};d.embedByUID=function(a){return bb(this._embeds,"uid",a)};d.getCell=function(a,b){var c,
d;this._colMajor?(d=this._cols[a])&&(c=d.getCell(b)):((d=this._rows[b])&&(c=d.getCell(a)),!c&&this._showAnnotations&&(d=this._cols[a])&&(c=d.getCell(b)));return c||null};d.cellFromPos=function(a,b,c){this._right&&this._bottom||this.updateDimensions();a=this.colFromX(a);b=this.rowFromY(b);a>=this._extColCount&&(a=this._extColCount-1);b>=this._extRowCount&&(b=this._extRowCount-1);!1!==c&&(c=this.getMergedCell(a,b))&&(a=c.range.c1,b=c.range.r1);return sa(a,b)};d.prevTextCell=function(a,b){var c,d,e,
f=a-50;0>f&&(f=0);if(this._colMajor)for(e=a-1;e>=f;e--){if((d=this._cols[e])&&(d=d.getCell(b))&&(d.t||d.v)){c=e;break}}else{var h=this._rows[b];if(h)for(e=a-1;e>=f;e--)if((d=h.getCell(e))&&(d.t||d.v)){c=e;break}}return c};d.cellStyle=function(a){return this._styles&&void 0!==a&&0<=a&&a<this._styles.length?this._styles[a]:{}};d.rowCount=function(){void 0===this._bottom&&this.updateDimensions();return this._extRowCount};d.colCount=function(){void 0===this._right&&this.updateDimensions();return this._extColCount};
d.eachRow=function(a){for(var b in this._rows)a(Number(b))};d.eachCol=function(a){for(var b in this._cols)a(Number(b))};d.rowHeight=function(a){return(a=this._rows[a])?a.size():this._defRowHeight};d.colWidth=function(a){return(a=this._cols[a])?a.size():this._defColWidth};d.setRowHeight=function(a,b){var c=this._rows[a];c||(c=Ya(a),this._rows[a]=c=new Ea(null,this._defRowHeight,c));c.setSize(b);this._top=null;this._right=void 0;this.cellGridChanged(!0)};d.setColWidth=function(a,b){var c=this._cols[a];
c||(c=Ma(a),this._cols[a]=c=new Ea(null,this._defColWidth,c));c.setSize(b);this._left=null;this._bottom=void 0;this.cellGridChanged(!0)};d.showRow=function(a){return(a=this._rows[a])&&a.show(this._defRowHeight)?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};d.showCol=function(a){return(a=this._cols[a])&&a.show(this._defColWidth)?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};d.resetRow=function(a){return(a=this._rows[a])&&a.reset()?(this._top=null,this._right=
void 0,this.cellGridChanged(!0),!0):!1};d.resetCol=function(a){return(a=this._cols[a])&&a.reset()?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};d.colHidden=function(a){return(a=this._cols[a])?a.hidden():!1};d.colOriginalHidden=function(a){return(a=this._cols[a])?a.originalHidden():!1};d.rowHidden=function(a){return(a=this._rows[a])?a.hidden():!1};d.rowOriginalHidden=function(a){return(a=this._rows[a])?a.originalHidden():!1};d.colDeleted=function(a){return(a=this._cols[a])?
a.deleted():!1};d.rowDeleted=function(a){return(a=this._rows[a])?a.deleted():!1};d.colStyle=function(a){return(a=this._cols[a])?this.cellStyle(a.style()):{}};d.rowTop=function(a){if(!this._top){this._top=[];for(var b=0,c=0;c<=this._rows.length;c++){this._top.push(b);var d=this._rows[c],b=d?b+d.size():b+this._defRowHeight}}if(a<this._top.length)return this._top[a];b=this._top.length-1;return this._top[b]+(a-b)*this._defRowHeight};d.rowBottom=function(a){return this.rowTop(a+1)};d.rowFromY=function(a){for(var b=
0;a>this.rowBottom(b);)b++;for(;!this.rowHeight(b)&&0<b;)b--;return b};d.colLeft=function(a){if(!this._left){this._left=[];for(var b=0,c=0;c<=this._cols.length;c++){this._left.push(b);var d=this._cols[c],b=d?b+d.size():b+this._defColWidth}}if(a<this._left.length)return this._left[a];b=this._left.length-1;return this._left[b]+(a-b)*this._defColWidth};d.colRight=function(a){return this.colLeft(a+1)};d.colFromX=function(a){for(var b=0;a>this.colRight(b);)b++;for(;!this.colWidth(b)&&0<b;)b--;return b};
d.sheetRight=function(){void 0===this._right&&this.updateDimensions();return this._right};d.sheetBottom=function(){void 0===this._bottom&&this.updateDimensions();return this._bottom};d.colTitle=function(a,b){var c,d=this._cols[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedCols&&a>=this._colCount&&(a-=this._deletedCols),!1!==b&&(c=Ma(a)));return c};d.rowTitle=function(a,b){var c,d=this._rows[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedRows&&a>=this._rowCount&&(a-=this._deletedRows),
!1!==b&&(c=Ya(a)));return c};d.colType=function(a){var b;(a=this._cols[a])&&(b=a.type());return b};d.rowType=function(a){var b;(a=this._rows[a])&&(b=a.type());return b};d.getMergedCell=function(a,b){var c;if(this._merged)for(var d=0;d<this._merged.length;d++){var e=this._merged[d].range;if(a>=e.c1&&a<=e.c2&&b>=e.r1&&b<=e.r2){c=this._merged[d];break}}return c};d.containsRange=function(a){var b=!1;if("text"===a.type){var c=a.acc;a=a.accend;var d=this.findCellsForRange(c,a);if(-1!=d)for(var e=this.getACCMap(),
f=this._colMajor?this._cols:this._rows;d<e.length;d++){var g=f[e[d]];if(g){if(g.acc()>a)break;if(g.getCellsForRange(c,a)){b=!0;break}}}}else b=a.page===this._page.index;return b};d.getACCMap=function(){if(!this._accmap){this._accmap=[];var a=this._colMajor?this._cols:this._rows,b;for(b in a){var c=Number(b),d=a[c];d&&void 0!==d.acc()&&this._accmap.push(c)}}return this._accmap};d.findCellsForRange=function(a,b){var c=this.getACCMap(),d=this._colMajor?this._cols:this._rows;if(0==c.length)return-1;for(var e=
0;e<d.length&&!d[e];)e++;for(var f=d.length-1;0<=f&&!d[f];)f--;if(!d[e]||!d[f]||b<d[e].acc()||a>d[f].accend())return-1;for(var e=0,f=c.length-1,g;e<=f;){g=Math.floor((e+f)/2);var h=d[c[g]];if(b<h.acc())f=g-1;else if(a>h.accend())e=g+1;else break}for(;0<g&&d[c[g-1]].accend()>a;)g--;return g};d.getCellsForRange=function(a,b){var c=this.findCellsForRange(a,b);if(-1!=c){for(var d=this.getACCMap(),e=this._colMajor?this._cols:this._rows,f=void 0;c<d.length;c++){var g=e[d[c]];if(g){if(g.acc()>b)break;(g=
g.getCellsForRange(a,b))&&(f?Array.prototype.push.apply(f,g):f=g)}}return f}};d.select=function(a){var b=!1,c,d;if(a&&"text"===a.type){if(0!==Na(a,this._selectedRange)&&(this.select(null),c=this._selectedCells=this.getCellsForRange(a.acc,a.accend))){this._selectedRange=ga(a);for(d=0;d<c.length;d++)b=c[d],b.selection=a,b.highlightsChanged=!0;b=!0}}else if(this._selectedCells){c=this._selectedCells;delete this._selectedCells;delete this._selectedRange;for(d=0;d<c.length;d++)b=c[d],delete b.selection,
b.highlightsChanged=!0;b=!0}return b};d.addHighlight=function(a){var b=!1,c,d;if(a)if("text"===a.range.type){var e=this.getCellsForRange(a.range.acc,a.range.accend);if(e){for(d=0;d<e.length;d++)c=e[d],c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);b=!0}!b&&this.hasPendingContent()&&(b=this._page.containsRange(a.range))}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(e=this.mapToText(a.range)))for(d=0;d<e.length;d++)if(c=
e[d],c=this.getCell(c.cell.c,c.cell.r))c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);return b};d.updateHighlight=function(a){var b;if(a)if("text"===a.range.type){var c=this.getCellsForRange(a.range.acc,a.range.accend);if(c)for(a=0;a<c.length;a++)c[a].highlightsChanged=!0}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(c=this.mapToText(a.range)))for(a=0;a<c.length;a++)if(b=c[a],b=this.getCell(b.cell.c,b.cell.r))b.highlightsChanged=
!0};d.removeHighlight=function(a){if(a){var b,c;if("text"==a.range.type){var d=this.getCellsForRange(a.range.acc,a.range.accend);if(d){for(c=0;c<d.length;c++)b=d[c],b.highlights&&(Ka(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0);return!0}}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(d=this.mapToText(a.range)))for(c=0;c<d.length;c++)b=d[c],(b=this.getCell(b.cell.c,b.cell.r))&&b.highlights&&(Ka(b.highlights,a),0===b.highlights.length&&delete b.highlights,
b.highlightsChanged=!0)}return!1};d.expandRange=function(a){a=ga(a);if(this._merged){var b;do{b=!1;for(var c=0;c<this._merged.length;c++){var d=this._merged[c];a.c1<=d.range.c2&&a.c2>=d.range.c1&&a.r1<=d.range.r2&&a.r2>=d.range.r1&&(d.range.c1<a.c1&&(a.c1=d.range.c1,b=!0),d.range.r1<a.r1&&(a.r1=d.range.r1,b=!0),d.range.c2>a.c2&&(a.c2=d.range.c2,b=!0),d.range.r2>a.r2&&(a.r2=d.range.r2,b=!0))}}while(b)}return a};d.getHoverText=function(){if(!w.showCellTooltips||this.isRangeSelected())return null;var a=
T.cellSelection();return(a=this.getCell(a.c1,a.r1))&&a.clipped?a.t||a.v:null};d.isRangeSelected=function(){var a=!1,b=T.cellSelection();if(b&&(b.c1!=b.c2||b.r1!=b.r2)&&(a=!0,this._merged))for(var c=0;c<this._merged.length;c++){var d=this._merged[c];if(b.c1==d.range.c1&&b.c2==d.range.c2&&b.r1==d.range.r1&&b.r2==d.range.r2){a=!1;break}}return a};d.getSelectedText=function(){var a="",b;switch(T.selectionType()){case "text":if(this._selectedCells){b=T.textSelection();for(var c=this._selectedCells,d=0;d<
c.length;d++){var e=c[d];if(e.t){var g=b.acc-e.a;0>g&&(g=0);var k=b.accend-e.a;k>g&&(a&&(a+="\t"),a+=e.t.substring(g,k))}}}break;case "cell":if(b=T.cellSelection(),this.isRangeSelected())for(c=0,d=b.r1;d<=b.r2;d++){e=0;for(g=b.c1;g<=b.c2;g++){if(k=this.getCellText(g,d)){if(0<c)for(1E3<c&&(c=1E3);0<c;c--)a+="\r\n";if(0<e)for(1E3<e&&(e=1E3);0<e;e--)a+="\t";a+=k}e++}c++}else a=this.getCellText(b.c1,b.r1)||""}return a};d.mapToCells=function(a){if("text"==a.type){var b=[],c=a.acc;a=a.accend;var d=this.getACCMap();
if(this._colMajor){var e=this.findCellsForRange(c,a);if(-1==e)return;for(;e<d.length;e++){var e=d[e],f=this._cols[e];if(f){if(f.acc()>a)break;var g=e,k=b;if(f){var l=f.getCellsForRange(c,a);if(l)for(var m=0;m<l.length;m++){var p=f.getIndexForCell(l[m]),q=this.getMergedCell(g,p);q?k.push(ga(q.range)):k.push(sa(g,p))}}}}}else{e=this.findCellsForRange(c,a);if(-1==e)return;for(;e<d.length;e++)if(e=d[e],f=this._rows[e]){if(f.acc()>a)break;g=e;k=b;if(f&&(l=f.getCellsForRange(c,a)))for(m=0;m<l.length;m++)p=
f.getIndexForCell(l[m]),(q=this.getMergedCell(p,g))?k.push(ga(q.range)):k.push(sa(p,g))}}return b}};d.mapToText=function(a){if("cell"==a.type){var b;a=g(a);for(var c=a.r1;c<=a.r2;c++)for(var d=a.c1;d<=a.c2;d++){var e=this.getCell(d,c);if(e&&e.t&&void 0!==e.a){var f=e.a+e.t.length;b||(b=[]);e=pa(e.a,f);e.cell={c:d,r:c};b.push(e)}}return b}};d.decomposeRange=function(a,b){if("cell"==a.type){a=g(a);var c=this.mapToText(a);if(b)c?c.push(a):c=[a];else{for(var d=[],e=a.r1;e<=a.r2;e++)for(var f=null,h=a.c1;h<=
a.c2;h++){var k=this.getCell(h,e);k&&k.v&&(f&&f.c2==h-1?f.c2=h:(f=sa(a.page,h,e,h,e),d.push(f)))}if(0<d.length)for(c||(c=[]),e=0;e<d.length;e++)if(f=d[e]){for(h=e+1;h<d.length;h++)(k=d[h])&&k.r1==f.r2+1&&k.c1==f.c1&&k.c2==f.c2&&(f.r2=k.r2,d[h]=null);c.push(f)}}return c}};var g=function(a){var b=a;if("cell"==a.type&&a.offsets){var b=a.c1,c=a.c2,d=a.r1,e=a.r2,f;b>c&&(f=b,b=c,c=f);d>e&&(f=d,d=e,e=f);0>a.offsets.left&&0<b&&b--;0<a.offsets.right&&c++;0>a.offsets.top&&0<d&&d--;0<a.offsets.bottom&&e++;b=
sa(a.page,b,d,c,e)}return b},k=function(a,b){var c,d,e,f,g,h,k;delete a._accmap;var l=a._colMajor?a._cols:a._rows;c=0;var p,m=[];for(e=0;e<b.length;e++){var q=b[e];q instanceof Array?p=c:(c=q.i,p=q.e||q.i,q=q.d);var t;a._colMajor?(t=new Ea(null,a._defColWidth,null),void 0===f&&(f=c,g=0,k=a.rowCount())):(t=new Ea(null,a._defRowHeight,null),void 0===g&&(g=c,f=0,h=a.colCount()));for(var n=c;n<=p;n++){a._colMajor?h=n:k=n;l[n]||(l[n]=t);l[n].setCellData(q);for(var r=0,C=0;r<q.length;r++){d=q[r];d.fr&&
m.push(d);if(d.mh||d.mv)a._merged||(a._merged=[]),c=a._colMajor?sa(n,C,n,C):sa(C,n,C,n),d.mh&&(c.c2+=d.mh),d.mv&&(c.r2+=d.mv),a._merged.push({cell:d,range:c});d.e?C+=d.e:C++}}c=p+1}for(e=0;e<m.length;e++)for(d=m[e],c=Ib(d.fr),l=c.c1;l<=c.c2;l++)for(p=c.r1;p<=c.r2;p++)(q=a.getCell(l,p))&&q!==d&&(q.fr=d.fr,q.fm=d.fm);return sa(a._page.index,f,g,h,k)},n=function(a,b,c){for(var d;0<=b&&b<a.length;b+=c){var e=a[b];if(e&&void 0!==e.acc()){d=e;break}}return d},r=function(a,b){if(b){var c,d;a._colMajor?(c=
n(a._cols,b.c1,1),d=n(a._cols,b.c2,-1)):(c=n(a._rows,b.r1,1),d=n(a._rows,b.r2,-1));c&&d&&(Q.each(function(b){a.addHighlight(b);Q.link(b)},function(b){b=Q.highlight(b).range;return"text"!==b.type?b.page===a._page.index:b.acc<d.accend()&&b.accend>c.acc()}),F.update(!0))}},v=function(a,b,c,d,e,g,l){g.loaded=!0;delete g.ajax;0===--e._ajaxLoading&&e._hideMsg&&(ua.hideMessage(),e._hideMsg=!1);if(200===d){var f=JSON.parse(c);f.cells&&(f=k(e,f.cells),r(this,f))}else e.logAJAXError(null,"Failed to load the spreadsheet data for sheet "+
(e._page+1)+" from the server",a,d,c);E.resumeIdleTimer("loadSSDataFromServer");if(l){for(var f=[e],h=7;h<arguments.length;h++)f.push(arguments[h]);l.apply(null,f)}},t=function(a,b,c){if(b.f&&!b.loaded&&!b.ajax){var d=b.f;"/"!=d.charAt(0)&&(d=Sa(u.baseURL,d));E.pauseIdleTimer("loadSSDataFromServer");b.ajax=ab({url:d,context:a,complete:v,args:Array.prototype.slice.call(arguments)});a._ajaxPending--;a._ajaxLoading++;1!=a._ajaxLoading||ua.messageVisible()||(ua.showMessage(U.PLEASE_WAIT_DOWNLOADING),
a._hideMsg=!0)}};d.hasPendingContent=function(){return this._data||0<this._ajaxPending||0<this._ajaxLoading};d.loadRange=function(a,b){if(this._data)switch(a.type){case "text":var c=this.mapToCells(a);c&&0!==c.length||da(q,0,this,this,a,b);break;case "cell":this.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,b)}b&&b(a)};var q=function(a,b,c){var d=a.mapToCells(b);if(d&&0<d.length)c&&c(b);else for(d=0;d<a._data.length;d++){var e=a._data[d];if(e&&!e.loaded&&!e.ajax){t(a,e,q,b,c);break}}};d.loadDataForCells=
function(a,b,c,d,e,g){if(void 0===a||void 0===b||void 0===c||void 0===d)g&&g();else if(this._data){this._colMajor||(a=b,c=d);var f;for(d=0;d<this._data.length;d++)if((b=this._data[d])&&!b.loaded&&!b.ajax){if(b.i>c)break;if(b.iend>=a){var h=!1;if(this._colMajor)for(var k=b.i;k<=b.iend;k++){if(!this.colHidden(k)){h=!0;break}}else for(k=b.i;k<=b.iend;k++)if(!this.rowHidden(k)){h=!0;break}h&&(f||(f=[]),f.push(b))}}f?e?(this._deferredTimer?(ta(this._deferredTimer),delete this._deferredTimer):E.pauseIdleTimer("loadDataForCells"),
this._deferredTimer=da(function(a,b){delete this._deferredTimer;E.resumeIdleTimer("loadDataForCells");m.call(this,a,b)},200,this,f,g)):m.call(this,f,g):g&&g()}else g&&g()};var m=function(a,b){for(var c=0;c<a.length;c++)t(this,a[c],b)},l=function(a){var b;if(a&&void 0!==a.sheet){var c=z.page(a.sheet);if(c&&c.isLoaded()){var d=c.spreadsheetModel();if(d){b=a.c1;var e=a.r1,f=a.c2,g=a.r2,k=a=!1;void 0===b?(b=0,f=d.colCount()-1,a=!0):void 0===f&&(f=b);void 0===e?(e=0,g=d.rowCount()-1,k=!0):void 0===g&&
(g=e);b=sa(c.index,b,e,f,g);a&&(b.selectingRows=!0);k&&(b.selectingCols=!0)}}}return b},K=function(a,b,c){for(a=0;a<b.cells.length;a++){c=b.cells[a];var d=l(c.ref);d&&(delete c.ref,c.range=d)}},M=function(a){for(var b={t:""},c=0;c<a.text.length;c++){var d=a.text[c];if(d.range){var e=ia.getRawText(d.range.acc,d.range.accend);e&&(b.t+=e,b.a||(b.a=d.range.acc))}else d.text&&(b.t+=d.text,delete b.a)}return b},I=function(a,b,c){b.resolved||(b.ref&&(void 0===b.ref.sheet||b.page||(b.page=z.page(b.ref.sheet)),
b.range=l(b.ref),b.range&&delete b.ref),b.oldref&&(b.oldrange=l(b.oldref),b.oldrange&&delete b.oldref),b.user&&(c&&(b.author=c[b.user]),delete b.user),b.ref||b.oldref||(b.resolved=!0));b.resolved&&b.page&&b.page===a._page&&(a._revisions||(a._revisions=[]),-1==a._revisions.indexOf(b)&&(a._revisions.push(b),"delete_row"===b.type?a._deletedRows++:"delete_col"===b.type&&a._deletedCols++))},H=function(a,b){var c=b.indexOf(a);if(-1==c)for(var d in b){var e=b[d];if(e&&e.clonedFrom&&e.clonedFrom===a){c=parseInt(d,
10);break}}return c},O=function(a,b){if(b&&(b.col||b.row)){var c=ga(b),d,e=c.c1==c.c2,f=c.r1==c.r2;b.col&&(a._annoCols&&(d=H(b.col,a._annoCols),-1!=d&&(c.c1=d)),delete b.col);b.col2?(a._annoCols&&(d=H(b.col2,a._annoCols),-1!=d&&(c.c2=d)),delete b.col2):e&&(c.c2=c.c1);b.row&&(a._annoRows&&(d=H(b.row,a._annoRows),-1!=d&&(c.r1=d)),delete b.row);b.row2?(a._annoRows&&(d=H(b.row2,a._annoRows),-1!=d&&(c.r2=d)),delete b.row2):f&&(c.r2=c.r1);return c}};d.processRevisions=function(a,b,c){var d=!1;if(a&&a.revisions){var e=
this,f;e._deletedCols=0;for(f=e._deletedRows=0;f<a.revisions.length;f++)I(e,a.revisions[f],a.users);if(e._revisions){a=sa(e._page.index,0,0,0,0);for(f=0;f<e._revisions.length;f++)d=e._revisions[f],Eb(a,d.range),Eb(a,d.oldrange);e.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,function(){var a,d=e._cols.slice(0),f=e._rows.slice(0);e._normalColCount=e._colCount;e._annoColCount=e._colCount+e._deletedCols;e._normalCols=e._cols;e._annoCols=e._cols.slice(0);e._normalRowCount=e._rowCount;e._annoRowCount=e._rowCount+
e._deletedRows;e._normalRows=e._rows;e._annoRows=e._rows.slice(0);for(a=e._revisions.length-1;0<=a;a--){var g=e._revisions[a],h,k,l,m=e;k=g;g=g.range;h=d;var q=f;if(g)switch(k.type){case "add_row":g.row=q[g.r1];g.row||(l=Ya(g.r1),g.row=q[g.r1]=new Ea(null,m._defRowHeight,l),m._annoRows[g.r1]||(m._annoRows[g.r1]=g.row));g.col=h[g.c1];g.col2=h[g.c2];g.row.revision(k);q.splice(g.r1,1);break;case "add_col":g.col=h[g.c1];g.col||(l=Ma(g.c1),g.col=h[g.c1]=new Ea(null,m._defColWidth,l),m._annoCols[g.c1]||
(m._annoCols[g.c1]=g.col));g.row=q[g.r1];g.row2=q[g.r2];g.col.revision(k);h.splice(g.c1,1);break;case "delete_row":l=g;var t=m,n=k,r=new Ea(null,t._defRowHeight,U.DEL);r.revision(n);n.target=r;K(t,n,r);for(var t=0,C=[],H=0;H<n.cells.length;H++){var I=n.cells[H];I.range.c1>t&&(C.push({e:I.range.c1-t}),t=I.range.c1);C.push(M(I));t++}r.setCellData(C);l.row=r;g.col=h[g.c1];g.col2=h[g.c2];for(g.row.revision(k);g.r1>q.length;)q.push(null);q.splice(g.r1,0,g.row);h=0<g.r1?(h=q[g.r1-1])?m._annoRows.indexOf(h)+
1:g.r1:(h=q[g.r1+1])?m._annoRows.indexOf(h):g.r1;for(;h>m._annoRows.length;)m._annoRows.push(null);m._annoRows.splice(h,0,g.row);if(m._colMajor)for(l=0;l<m._annoCols.length;l++)if(h=m._annoCols[l])k=m._normalCols.indexOf(h),-1!=k&&(k=h,h=k.clone(),m._annoCols[l]=h,k=q.indexOf(k),-1!=k&&(q[k]=h)),h.insertCell(g.r1);break;case "delete_col":l=g;t=m;n=k;r=new Ea(null,t._defColWidth,U.DEL);r.revision(n);n.target=r;K(t,n,r);t=0;C=[];for(H=0;H<n.cells.length;H++)I=n.cells[H],I.range.r1>t&&(C.push({e:I.range.r1-
t}),t=I.range.r1),C.push(M(I)),t++;r.setCellData(C);l.col=r;g.row=q[g.r1];g.row2=q[g.r2];for(g.col.revision(k);g.c1>h.length;)h.push(null);h.splice(g.c1,0,g.col);h=0<g.c1?(h=h[g.c1-1])?m._annoCols.indexOf(h)+1:g.c1:(h=h[g.c1+1])?m._annoCols.indexOf(h):g.c1;for(;h>m._annoCols.length;)m._annoCols.push(null);m._annoCols.splice(h,0,g.col);if(!m._colMajor)for(l=0;l<m._annoRows.length;l++)if(h=m._annoRows[l])k=m._normalRows.indexOf(h),-1!=k&&(k=h,h=k.clone(),m._annoRows[l]=h,k=q.indexOf(k),-1!=k&&(q[k]=
h)),h.insertCell(g.c1);break;case "clear_cell":for(;g.c2>=h.length;)l=Ma(h.length),k=new Ea(null,m._defColWidth,l),h.push(k),m._annoCols.push(k);for(;g.r2>=q.length;)l=Ya(q.length),k=new Ea(null,m._defRowHeight,l),q.push(k),m._annoCols.push(k);case "new_cell":case "modify_cell":case "move_cells":g.col=h[g.c1],g.row=q[g.r1],g.c2!=g.c1&&(g.col2=h[g.c2]),g.r2!=g.r1&&(g.row2=q[g.r2])}}for(a=0;a<e._revisions.length;a++){f=e;d=e._revisions[a];if(m=O(f,d.range))d.annoRange=m;if(f=O(f,d.oldrange))d.oldAnnoRange=
f}if(a=e._page.comments())for(d=0;d<a.length;d++)g=a[d],"cell"===g.type&&g.range&&"cell"===g.range.type&&(f=g,m=e,g=g.range,m._normalCols&&m._normalRows?(g.col=m._normalCols[g.c1],g.row=m._normalRows[g.r1],g.c2!=g.c1&&(g.col2=m._normalCols[g.c2]),g.r2!=g.r1&&(g.row2=m._normalRows[g.r2]),m=O(m,g)):m=void 0,f.annoRange=m);e.showAnnotations(w.showAnnotations);delete e._revisionMap;b&&b.call(c)});d=!0}}return d};d.revisions=function(){return this._revisions};d.rowRevisions=function(a){if(a=this._rows[a])return a.revision()};
d.colRevisions=function(a){if(a=this._cols[a])return a.revision()};var C=function(a,b,c){a[b]?(Array.isArray(a[b])||(a[b]=[a[b]]),a[b].push(c)):a[b]=c},R=function(a,b,c){for(var d=b.r1;d<=b.r2;d++)for(var e=b.c1;e<=b.c2;e++){var f=e,g=c,h=a[d];h||(h=a[d]=[]);h[f]?(Array.isArray(h[f])||(h[f]=[h[f]]),h[f].push(g)):h[f]=g}},A=function(a,b){a&&(b||(b=[]),Array.isArray(a)?Array.prototype.push.apply(b,a):b.push(a));return b};d.getCellRevisions=function(b,d){var f;if(this._revisions){if(!this._revisionMap){for(var g=
this._revisions,h={cols:[],rows:[],cells:[]},k=0;k<g.length;k++){var l=g[k],m=l.annoRange||l.range,q=l.oldAnnoRange||l.oldrange;c[l.type]?(m&&C(h.rows,m.r1,l),q&&C(h.rows,q.r1,l)):e[l.type]?(m&&C(h.rows,m.c1,l),q&&C(h.rows,q.c1,l)):a[l.type]&&(m&&R(h.cells,m,l),q&&R(h.cells,q,l))}this._revisionMap=h}f=A(this._revisionMap.cols[b],f);f=A(this._revisionMap.rows[d],f);(g=this._revisionMap.cells[d])&&(f=A(g[b],f))}return f};return b}(),td=function(){var c={f:"_font",s:"_fontSize",fs:"_fontStyle",fw:"_fontWeight",
d:"_textdec",ba:"_baseline",ta:"_angle",c:"_color",w:"_wrap",a:"_align",i:"_indent",v:"_valign",bdr:"_bdr",b:"_fill",bb:"_fillBg",bh:"_fillHatch"},e=function(a,b,d,e){this._data=a;this._model=b;this._style=a.s?b.cellStyle(a.s):{};a.t?this._text=a.t:a.v&&(this._text=a.v);var g=this._style,k=a.c?b.colStyle(d):{},l=b.sheetStyle();this._font="Arial";this._fontSize=10;this._align="g";this._indent=0;this._valign="b";for(var f in c)if(c.hasOwnProperty(f)){var h=g[f]||k[f]||l[f];void 0!==h&&(this[c[f]]=h)}a.c&&
(this._color=a.c);if(this._angle&&"vertical"!==this._angle){for(;0>this._angle;)this._angle+=360;for(;360<=this._angle;)this._angle-=360;0===this._angle?this._angle=null:(this._angle=(360-this._angle)*Math.PI/180,this._align="l",this._valign="b",this._indent=0)}this._bdr&&(this._topBorder=this._bdr[0],this._rightBorder=this._bdr[1],this._bottomBorder=this._bdr[2],this._leftBorder=this._bdr[3],a.bs&&(-1!=a.bs.indexOf("t")&&(this._topBorder=null),-1!=a.bs.indexOf("r")&&(this._rightBorder=null),-1!=
a.bs.indexOf("b")&&(this._bottomBorder=null),-1!=a.bs.indexOf("l")&&(this._leftBorder=null)),delete this._bdr);2>this._indent&&(this._indent=2);this._clearLeft=this._textRight=this._textLeft=0;this._clearRight=void 0;if(a=b.getCellComments(d,e,!0))this._comments=a;if(b=b.getCellRevisions(d,e))for(a=0;a<b.length;a++)if(g=b[a],g.range&&g.range.c1==d&&g.range.r1==e||g.oldrange&&g.oldrange.c1==d&&g.oldrange.r1==e){this._hasRevision=!0;break}},a=X(e);a.hasText=function(){return this._text&&0<this._text.length};
a.textRight=function(){return this._textRight};a.horizontalMerge=function(){return this._data.mh||0};a.verticalMerge=function(){return this._data.mv||0};a.horizontalAlign=function(){return this._align};a.leftBorder=function(){return this._leftBorder||null};a.topBorder=function(){return this._topBorder||null};a.rightBorder=function(){return this._rightBorder||null};a.bottomBorder=function(){return this._bottomBorder||null};a.rangeRect=function(a){var b=this._wrappedText;if("text"===a.type&&b){var c,
d=a.acc-this._data.a;a=a.accend-this._data.a;0>d&&(d=0);a>this._text.length&&(a=this._text.length);for(var e=0;e<b.length;e++)for(var g=b[e],k=g.x,f=g.y,h=g.o,l=0;l<g.spans.length;l++){var m=g.spans[l],q=h+m.t.length;if(q>d&&h<a){var h=k+m.w,t=f+g.h;c?(k<c.left&&(c.left=k),f<c.top&&(c.top=f),h>c.right&&(c.right=h),t>c.bottom&&(c.bottom=t)):c={left:k,top:f,right:h,bottom:t}}k+=m.w;h=q}return c}};a.drawTextBackground=function(a,b,c,d,e,g,k){if(0>this._textLeft||this._textRight>g)b=d+this._textLeft,
d+=this._textRight,b<this._clearLeft&&(b=this._clearLeft),void 0!==this._clearRight&&d>=this._clearRight&&(d=this._clearRight-1),a.oitrect(b+1,e+1,d-b-1,k-1,"#ffffff")};a.drawBackground=function(a,b,c,d,e,g,k){if(this._fill||this.horizontalMerge()||this.verticalMerge())if(this._fillHatch){b=new kc(8,8);c=b.getContext("2d");this._fillBg&&c.oitrect(0,0,8,8,this._fillBg);c.strokeStyle=this._fill||"#ffffff";c.lineCap="square";"d"==this._fillHatch.charAt(0)?c.lineWidth=2:c.lineWidth=1;switch(this._fillHatch){case "lv":case "dv":c.oitline(1.5,
0,1.5,8);c.oitline(5.5,0,5.5,8);break;case "lh":case "dh":c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "ldd":case "ddd":c.oitline(-.5,-.5,8.5,8.5);break;case "lud":case "dud":c.oitline(8.5,-.5,-.5,8.5);break;case "lg":case "dg":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "lt":case "dt":c.oitline(0,0,8,8),c.oitline(8,0,0,8)}b=a.createPattern(x.unwrap(b),"repeat");a.fillStyle=b;a.globalAlpha=1;a.fillRect(d+.5,e+.5,g+.5,k+.5)}else a.oitrect(d+
.5,e+.5,g+.5,k+.5,this._fill||"#ffffff")};var b=function(a,b,c,d,e){c||(c=1);var g=2*c;switch(b){case "dotted":b=[g,g];break;case "dashed":b=[2*g,g];break;case "dashdot":b=[2*g,g,g,g];break;case "dashdotdot":b=[2*g,g,g,g,g,g];break;case "double":b=[];c=Math.floor(c/3);1>c&&(c=1);break;default:b=[]}for(var k=g=0;k<b.length;k++)g+=b[k];e%=g;a.strokeStyle=d||"black";a.fillStyle=d||"black";a.lineWidth=c;a.setLineDash?(a.setLineDash(b),a.lineDashOffset=e):(a.mozDash=b,a.mozDashOffset=e)},d=function(a){var b=
Math.floor(a.w/3);1>b&&(b=1);a=a.w-(b+b);1>a&&(a=1);b=(b+a)/2;return[-b,b]},g=function(a,b){var c=0,e=0,g;a&&"double"===a.s&&(g=d(a),c=-g[0]);b&&"double"===b.s&&(g=d(b),e=g[1]);return c&&e?c>e?-c:-e:c?c:e},k=function(a,b){var c=0,e=0,g;a&&"double"===a.s&&(g=d(a),c=-g[0]);b&&"double"===b.s&&(g=d(b),e=g[1]);return c&&e?[-c,-e]:c?[-c,c]:[e,-e]},n=function(a,c,e,l,m,q,t,f,h){b(a,m.s,m.w,m.c,c);"double"===m.s?(m=d(m),q=k(q,t),f=k(f,h),q[0]||(q[0]=-.5),q[1]||(q[1]=-.5),f[0]||(f[0]=.5),f[1]||(f[1]=.5),a.beginPath(),
a.moveTo(c-q[0],e+m[0]),a.lineTo(l+f[0],e+m[0]),a.moveTo(c-q[1],e+m[1]),a.lineTo(l+f[1],e+m[1])):(m=g(q,t),f=g(f,h),m||(m=-.5),f||(f=.5),a.beginPath(),a.moveTo(c-m,e+.5),a.lineTo(l+f,e+.5));a.stroke()},r=function(a,c,e,l,m,q,t,f,h){b(a,m.s,m.w,m.c,e);"double"===m.s?(m=d(m),q=k(q,t),f=k(f,h),q[0]||(q[0]=-.5),q[1]||(q[1]=-.5),f[0]||(f[0]=.5),f[1]||(f[1]=.5),a.beginPath(),a.moveTo(c+m[0],e-q[0]),a.lineTo(c+m[0],l+f[0]),a.moveTo(c+m[1],e-q[1]),a.lineTo(c+m[1],l+f[1])):(m=g(q,t),f=g(f,h),m||(m=-.5),f||
(f=.5),a.beginPath(),a.moveTo(c+.5,e-m),a.lineTo(c+.5,l+f));a.stroke()},v=function(a,b){var c=null;a&&(c=a.bottomBorder());if(b){var d=b.topBorder();d&&(!c||d.w>c.w)&&(c=d)}return c},t=function(a,b){var c=null;a&&(c=a.rightBorder());if(b){var d=b.leftBorder();d&&(!c||d.w>c.w)&&(c=d)}return c};a.drawBorder=function(a,c,d,e,g,k,l,f){if(this._topBorder||this._rightBorder||this._bottomBorder||this._leftBorder){var h=e+k;l=g+l;a.lineCap="square";a.lineJoin="miter";a.globalAlpha=1;var m;this._leftBorder&&
0<=this._textLeft&&0<c&&(c=v(f[0][0],f[1][0]),m=v(f[1][0],f[2][0]),r(a,e,g,l,this._leftBorder,c,this._topBorder,m,this._bottomBorder));this._topBorder&&0<d&&(c=t(f[0][0],f[0][1]),d=t(f[0][1],f[0][2]),n(a,e,g,h,this._topBorder,c,this._leftBorder,d,this._rightBorder));this._rightBorder&&this._textRight<=k&&(d=v(f[0][2],f[1][2]),k=v(f[1][2],f[2][2]),r(a,h,g,l,this._rightBorder,this._topBorder,d,this._bottomBorder,k));this._bottomBorder&&(m=t(f[2][0],f[2][1]),k=t(f[2][1],f[2][2]),n(a,e,l,h,this._bottomBorder,
this._leftBorder,m,this._rightBorder,k));b(a,null)}};var q=function(a,b,c,d){if(c||d){var e={s:{},o:-1,oend:-1};"text"===b.type?(e.o=b.acc-a._data.a,0>e.o&&(e.o=0),e.oend=b.accend-a._data.a):(e.o=0,e.oend=a._text.length);c&&(e.s.c=c);d&&(e.s.bg=Ja(d));return e}};a.layoutText=function(a,b,c,d,e,g,k){if(this.hasText()){var f,h,t;c=!1;var n=null;f=this._data.selection;var r=this._data.highlights;if(f||r&&0<r.length){n=[];f&&(t=T.style()||"background-color:#3399FF;",h=db(t,"color"),t=db(t,"background-color"),
(h=q(this,f,h,t))&&n.push(h));if(r)for(f=0;f<r.length;f++){var u=r[f];t=u.highlightStyleProps();h=t.color;t=t["background-color"];(h=q(this,u.range,h,t))&&n.push(h)}delete this._data.highlightsChanged}this._wrappedText&&tc(n,this._highlightSpecs,!0)||(this._highlightSpecs&&!n?delete this._highlightSpecs:this._highlightSpecs=n,this._wrappedText=null);this.horizontalMerge()||this.verticalMerge()?(this._clearLeft=b,this._clearRight=b+d):(this._clearLeft=g,this._clearRight=k);d!=this._layoutWidth&&(this._wrappedText=
null);e!=this._layoutHeight&&(this._wrappedText=null,c=!0);if(!this._wrappedText&&(this._textLeft=0,this._layoutWidth=this._textRight=d,"l"==this._align?this._textLeft=this._indent:"r"==this._align&&(this._textRight=d-this._indent),f=this._textRight-this._textLeft,c=!0,this._wrap||this._angle?this._wrappedText=this.wrapText(a,f,e):this._data.cs||-1!=this._text.indexOf("\n")?this._wrappedText=this.wrapText(a,void 0,e):(b=this.createLine(0,this._text.length,null),m(a,b,this),l(a,b,this),this._wrappedText=
[b]),a=this._wrappedText))if(f=void 0!==this._data.v,f="r"==this._align||"rs"==this._align||f&&"g"==this._align,"c"==this._align||"cs"==this._align)for(f=0;f<a.length;f++)b=a[f],b.x=(d-b.w)/2,g=b.x+b.w,b.x<this._textLeft&&(this._textLeft=b.x),g>this._textRight&&(this._textRight=g);else if(f)for(f=0;f<a.length;f++)b=a[f],b.x=d-2-b.w-this._indent,b.x<this._textLeft&&(this._textLeft=b.x);else for(f=0;f<a.length;f++)b=a[f],b.x=this._indent,g=b.x+b.w,g>this._textRight&&(this._textRight=g);this._layoutHeight=
e;if(c)for(a=this._wrappedText,d=a[a.length-1],d=d.y+d.h-a[0].y,c=0,"c"==this._valign?c=(e-d)/2:"b"==this._valign&&(c=e-d-2),f=0;f<a.length;f++)b=a[f],b.y=c,c+=b.h}};a.drawText=function(a,b,c,d,e,g,k){if(b=this._wrappedText){c=!1;var f=b[b.length-1],f=f.y+f.h-b[0].y;this._data.clipped=!1;if(0>this._textLeft||this._textRight>g||f>k){g=d+this._textLeft;var h=d+this._textRight;if(g<this._clearLeft||void 0!==this._clearRight&&h>this._clearRight||f>k)g<this._clearLeft&&(g=this._clearLeft),void 0!==this._clearRight&&
h>this._clearRight&&(h=this._clearRight),a.save(),c=!0,a.beginPath(),a.fillStyle="black",a.rect(g,e,h-g,k),a.clip(),this._data.clipped=!0}a.globalAlpha=1;a.textAlign="left";a.textBaseline="alphabetic";this._angle&&"vertical"!==this._angle&&0<b.length&&(c||(a.save(),c=!0),a.translate(d+b[0].x,e+b[0].y),d=-b[0].x,e=-b[0].y,a.rotate(this._angle));for(g=0;g<b.length;g++){f=b[g];if(f.y>k)break;for(var h=d+f.x,l=e+f.y,m=0;m<f.spans.length;m++){var q=f.spans[m],t=this._font,n=this._fontSize,r=this._fontStyle,
N=this._fontWeight,u=this._color,p=this._textdec,D=this._baseline,v=null;q.s&&(q.s.f&&(t=q.s.f),q.s.s&&(n=q.s.s),q.s.fs&&(r=q.s.fs),q.s.fw&&(N=q.s.fw),q.s.c&&(u=q.s.c),q.s.d&&(p=q.s.d),q.s.ba&&(D=q.s.ba),q.s.bg&&(v=q.s.bg));q.hs&&(q.hs.c&&(u=q.hs.c),q.hs.bg&&(v=q.hs.bg));var C=P(l+f.a);D&&("sup"===D?(C+=-.35*f.a,n*=.65):"sub"===D&&(C+=.141*f.a,n*=.65));if(v){D=v;v=1;if(0===D.indexOf("rgba(")||0===D.indexOf("rgb(")){var A=Ga(D);A&&(D=Ja(A.r,A.g,A.b),v=A.a)}a.fillStyle=D;a.globalAlpha=v;a.fillRect(h-
1,C-f.a,q.w+2,f.h+2)}a.font=w(t,n,r,N);a.fillStyle=u||"black";a.globalAlpha=1;a.fillText(q.t,h,C);if(p){var x,H,I;switch(p){case "u":I=1;x=C+I;break;case "d":I=1;x=C+I;H=x+I+I;break;case "l":I=1,x=C-.25*q.a}void 0!==x&&(x=P(x)+.5,a.strokeStyle=u,a.lineWidth=I,a.beginPath(),a.moveTo(h,x),a.lineTo(h+q.w,x),void 0!==H&&(H=P(H)+.5,a.moveTo(h,H),a.lineTo(h+q.w,H)),a.stroke(),a.closePath())}h+=q.w}}c&&a.restore()}};a.drawFlags=function(a,c,d,e,g,k,l){void 0!==this._data.fm&&(c=g+l,a.lineCap="square",a.lineJoin=
"miter",a.globalAlpha=1,a.strokeStyle="rgba(52,113,183,0.5)",a.fillStyle="rgba(52,113,183,0.5)",a.lineWidth=1,a.beginPath(),a.moveTo(e,c),a.lineTo(e,c-6),a.lineTo(e+6,c),a.lineTo(e,c),a.fill(),b(a,null));this._comments&&(e+=k,a.lineCap="square",a.lineJoin="miter",a.globalAlpha=1,a.strokeStyle="rgb(255,0,0)",a.fillStyle="rgb(255,0,0)",a.lineWidth=1,a.beginPath(),a.moveTo(e,g),a.lineTo(e,g+6),a.lineTo(e-6,g),a.lineTo(e,g),a.fill(),b(a,null))};a.createLine=function(a,b,c){var d={x:0,y:0,w:0,h:0,spans:[],
o:a},e,g,k,f;if(c){f=a;for(var h,l=0;l<c.length;l++){e=c[l];if(e.o>f&&(g=e.o,g>b&&(g=b),f=this._text.substring(f,g),d.spans.push({t:f,w:0,s:h}),f=g,f>=b))break;h=this._model.cellStyle(e.s)}f<b&&(f=this._text.substring(f,b),d.spans.push({t:f,w:0,s:h}))}else f=this._text.substring(a,b),d.spans.push({t:f,w:0});if(this._highlightSpecs)for(b=0;b<this._highlightSpecs.length;b++)for(c=this._highlightSpecs[b],f=a,h=0;h<d.spans.length;h++)l=d.spans[h],g=f+l.t.length,c.o<g&&c.oend>f&&(e=c.o-f,0<e&&(g=l.t.substring(0,
e),k=l.t.substring(e),e={t:g,w:0},l.s&&(e.s=l.s),l.hs&&(e.hs={},l.hs.c&&(e.hs.c=l.hs.c),l.hs.bg&&(e.hs.bg=l.hs.bg)),d.spans.splice(h,0,e),h++,l.t=k,f+=g.length,g=f+l.t.length),e=c.oend-f,e<l.t.length&&(g=l.t.substring(0,e),k=l.t.substring(e),e={t:k,w:0},l.s&&(e.s=l.s),l.hs&&(e.hs={},l.hs.c&&(e.hs.c=l.hs.c),l.hs.bg&&(e.hs.bg=l.hs.bg)),d.spans.splice(h+1,0,e),l.t=g,g=f+l.t.length),l.hs||(l.hs={}),c.s.c&&(l.hs.c=c.s.c),c.s.bg&&(l.hs.bg=c.s.bg)),f=g;return d};var m=function(a,b,c){for(var d=b.w=0;d<b.spans.length;d++){var e=
b.spans[d],g=c._font,k=c._fontSize,f=c._fontStyle,h=c._fontWeight,l=c._baseline;e.s&&(e.s.f&&(g=e.s.f),e.s.s&&(k=e.s.s),e.s.fs&&(f=e.s.fs),e.s.fw&&(h=e.s.fw),e.s.baseline&&(l=e.s.baseline));l&&("sup"===l?k*=.65:"sub"===l&&(k*=.65));a.font=w(g,k,f,h);e.w=a.measureText(e.t).width;b.w+=e.w}return b.w},l=function(a,b,c){Oa||(Oa=x.create("div","oit-textmeasure"),u.rootNode.append(Oa));b.h=0;b.a=0;Oa.css("display","inline");for(a=0;a<b.spans.length;a++){var d=b.spans[a],e=c._font,g=c._fontSize,k=c._fontStyle,
f=c._fontWeight;d.s&&(d.s.f&&(e=d.s.f),d.s.s&&(g=d.s.s),d.s.fs&&(k=d.s.fs),d.s.fw&&(f=d.s.fw));Oa.text(d.t);var h=x.create("span");Oa.append(h);Oa.css("font",w(e,g,k,f));Oa.offsetHeight>b.h&&(b.h=Oa.offsetHeight);d.a=h.offsetTop+1;d.a>b.h&&(d.a=b.h);d.a>b.a&&(b.a=d.a)}Oa.html("");Oa.attr("style","");Oa.css("display",null)};a.wrapText=function(a,b,c){var d=[];void 0!==b&&(b-=4);var e=0,g=0,k=0;if("vertical"===this._angle)b=0;else if(this._angle)if(this._angle===Math.PI/2||this._angle===3*Math.PI/2)b=
this._layoutHeight;else{var f=Math.tan(this._angle),h=-this._layoutHeight-f,q=2*this._layoutHeight+f,f=Math.min(Math.min(Math.sqrt(h*h),Math.sqrt(f*f+this._layoutHeight*this._layoutHeight)),Math.sqrt(this._layoutHeight*this._layoutHeight+q*q));f<b&&(b=f)}f=this._text;f=this._data.cs||void 0!==b?f.replace(/\s/g,"\ufffd"):f.replace(/\n/g,"\ufffd");for(h=0;e<this._text.length;){k=f.indexOf("\ufffd",k);-1==k&&(k=f.length);q=this.createLine(e,k,this._data.cs);m(a,q,this);var t=void 0!==b&&q.w>b;if(t||
"\n"==this._text[k]||k>=this._text.length){if(t)if(g>e)k=g,q=this.createLine(e,k,this._data.cs),m(a,q,this);else for(t=e+1;k>t&&!(k--,q=this.createLine(e,k,this._data.cs),m(a,q,this),q.w<=b););l(a,q,this);q.y=h;h+=q.h;d.push(q);if(void 0!==c&&h>=c)break;k<this._text.length&&(e=this._text[k]," "!=e&&"\t"!=e&&"\n"!=e||k++);e=k}else g=k++}if(0!==d.length)return d};var w=function(a,b,c,d){0>=b&&(b=10);var e="";c&&"normal"!==c&&(e+=c+" ");d&&"normal"!=d&&(e+=d+" ");return e+(b+"px "+a)};return e}(),Oa=
null,ed=function(){return function(c,e){var a=this,b=c,d=e,g,k,n,r,v,t,q,m,l,K,M,I,H,O,C,R=[],A,f,h,B,y=0,L=0,F=40,Y=22,S,N,J,p,D=w.zoom,ja="database"!==e.type,Z,oa=-1,U=-1,ea=-1,la=-1,wa=!1,ra,qa,Fa;this.unload=function(){Fa&&(E.resumeIdleTimer("update"),ta(Fa),Fa=null);a.hidePopup(!0);ra&&(ra.destroy(),ra=null);E.offscroll(V);T.offselectionchanged(W);z.offpageload(G);ka.offresize(X);O&&O.destroy();for(var c=b.embeddingCount(),e=0;e<c;e++)b.embed(e).node=void 0;K&&(d.append(K),K=void 0);v&&v.destroy();
q&&q.destroy();l&&l.destroy();g&&g.destroy();Oa&&(Oa.destroy(),Oa=null);A=R=C=O=M=K=l=m=q=t=v=r=g=d=b=a=null};this.layoutChanged=function(b){w.zoom!=D&&(a.hidePopup(),X())};var G=function(a){K&&(d.append(K),M=K=void 0);X()};this.maxPageWidth=function(){var a=b.sheetRight();void 0!==Z&&Z>a&&(a=Z);return a};this.maxPageHeight=function(){return b.sheetBottom()};this.padding=function(){return{left:F,top:Y,right:0,bottom:0}};this.visibleRange=function(){return sa(L,y,p,J)};this.visibleHeight=function(){return Ia(J)-
Xa(y)};this.scrollOffset=function(a,c){void 0===a&&(a=L);void 0===c&&(c=y);var d=P(b.colLeft(a)*D)+1,e=P(b.rowTop(c)*D)+1;return{left:d,top:e}};var V=function(c,d,e,f,g){var h=y;f/=D;if(0<e)for(;!(b.rowBottom(h)>=f);)h++;else if(0>e)for(e=y;0<=e;e--)if(b.rowTop(e)<=f){h=e;break}e=L;f=d/D;if(0<c)for(;!(b.colRight(e)>=f);)e++;else if(0>c)for(c=L;0<=c;c--)if(b.colLeft(c)<=f){e=c;break}if(e!=L||h!=y)L=e,y=h,!1!==g&&(a.update(),a.hidePopup())},W=function(a,c){if(c){if(C){var e=b.getSelectedText();C.html(e);
C.select()}if(b.isRangeSelected())ra.disable(),ra.setText(void 0);else if(e=E.cellSelection()){var f=b.getFormulaText(e.c1,e.r1);f||(f=b.getCellText(e.c1,e.r1))&&"="==f[0]&&(f="'"+f);ra.enable();ra.setText(f)}else ra.setText(void 0);if(w.showAnnotations){var g,e=E.cellSelection(),f=d.annotationPane();if(e&&f){g=!b.isRangeSelected();!qa||qa.c==e.c1&&qa.r==e.r1||(qa=null);var h=qa?qa.anno:null,k=null,l=b.getCellComments(e.c1,e.r1),m=b.getCellRevisions(e.c1,e.r1);h&&g&&(l&&(g=l.indexOf(h),-1!=g&&((k=
l[g+1])||(k=m?m[0]:l[0]))),!k&&m&&(g=m.indexOf(h),-1!=g&&((k=m[g+1])||(k=l?l[0]:m[0]))));k||((k=Ha(l,e))||(k=Ha(m,e)),k||(l?k=l[0]:m&&(k=m[0])));k&&(qa={anno:k,c:e.c1,r:e.r1},f.activate(k))}}}fa();ha()};this.showHidden=function(c,e){if(b){var f=!1;!0===c?b.eachCol(function(a){b.showCol(a)&&(f=!0)}):!1===c&&b.eachCol(function(a){b.resetCol(a)&&(f=!0)});!0===e?b.eachRow(function(a){b.showRow(a)&&(f=!0)}):!1===e&&b.eachRow(function(a){b.resetRow(a)&&(f=!0)});f&&(Z=void 0,Q.deactivate(),T.update(),a.update(),
Q.positionAll(d),E.dispatchPageEvents())}};var X=function(c){var d=u.viewNode;r&&k==d.clientWidth&&n==d.clientHeight&&D==w.zoom||(k=d.clientWidth,n=d.clientHeight,D=w.zoom,P(k/D),P(n/D),(d=gb())&&(1==D?d.css("transform",null):d.css("transform","scale("+D+","+D+")")),r&&(r.destroy(),t.destroy(),m.destroy()),v||(v=x.create("div","oit-ssgrid"),q=x.create("div","oit-sscolheader"),q.onmousemove(Ea),q.ondragstart(Pa),q.ondragmove(Ra),q.ondragend(Ja),q.ondragcancel(Ja),q.onpress(Ka),q.onpressup(Qa),l=x.create("div",
"oit-ssrowheader"),l.onmousemove(Sa),l.ondragstart(Wa),l.ondragmove(Ba),l.ondragend(La),l.ondragcancel(La),l.onpress(Ta),l.onpressup(Va),g.append(v,q,l)),g.css({width:k+"px",height:n+"px"}),F=l.offsetWidth,Y=q.offsetHeight,r=v.createCanvas(),t=q.createCanvas(),m=l.createCanvas(),b.updateDimensions(),!1!==c&&a.update())};this.pageRect=function(a,c){if("view"===c||"overlay"===c||c===d){var e=0,f=0,g=b.sheetRight(),h=b.sheetBottom();if("view"===c||"overlay"===c){var k=w.zoom;1!=k&&(e*=k,f*=k,g*=k,h*=
k);"view"===c&&(k=this.scrollOffset(),e+=F-k.left,f+=Y-k.top,g+=F-k.left,h+=Y-k.top)}return new ba(e,f,g,h,c)}};this.rangeRect=function(a,c,e){var g;if("cell"===a.type){g=a.r1;var k=a.r2,l=a.c1,m=a.c2,p=a.offsets;a.offsets?g=new ba(b.colLeft(l)+p.left,b.rowTop(g)+p.top,b.colLeft(m)+p.right,b.rowTop(k)+p.bottom,d):(a.selectingRows&&(l=0,m=b.colCount()-1),a.selectingCols&&(g=0,k=b.rowCount()-1),g=new ba(b.colLeft(l)+1,b.rowTop(g)+1,b.colRight(m),b.rowBottom(k),d))}else if("rect"===a.type)"px"!==a.units&&
(a=ga(a),va(a,"px")),g=new ba(a),void 0!==a.embedId&&(k=b.embedByUID(a.embedId),a=d.embeddingRect(a.embedId),k&&a&&g.offset(a.left,a.top));else if("text"==a.type)for(k=b.mapToCells(a),l=0;l<k.length;l++){var q=k[l],m=b.colLeft(q.c1),p=b.rowTop(q.r1),t;a:{t=q.c1;var n=q.r1;if(t>=A.c1&&t<=A.c2&&n>=A.r1&&n<=A.r2){var N=R[n-A.r1];if(N){t=N[t-A.c1];break a}}t=f&&t==h&&n==B?f:void 0}n=!1;t||(t=Aa(q.c1,q.r1),n=!0);n&&(n=r.getContext("2d"),n.save(),n.font="12px Arial,Helvetica,sans-serif",ya(n,q.c1,q.r1,
t),n.restore());if(q=t.rangeRect(a))q.left+=m,q.right+=m,q.top+=p,q.bottom+=p,g?g.union(q):g=new ba(q,d)}if(g)return!0===e&&(e=u.viewNode,e=new ba(0,0,e.clientWidth,e.clientHeight,"view"),e.origin=g.origin,g.intersect(e.left-100,e.top-100,e.right+100,e.bottom+100),0===g.width||0===g.height)&&(g=void 0),g&&c&&(g.origin=c),g};this.rangeFromRect=function(c,f,g,h,k,l,m,p,q,t){c=new ba(f,g,h,k,l);c.origin=d;if(void 0!==p)return q=e.embeddingRect(p),"move"===m?c.constrain(q):c.intersect(q),c.offset(-q.left,
-q.left),f=c.toRange(),f.embedId=p,va(f,"pct"),f;"move"!==m&&"resize"!==m&&"extend"!==m&&("view"===l&&(f-=F,g-=Y),t|=f<b.colLeft(L),q|=g<b.rowTop(y));p=new ba(0,0,b.sheetRight(),b.sheetBottom(),d);"move"===m?c.constrain(p):c.intersect(p);p=!t&&!q;f=b.cellFromPos(c.left,c.top,p);p=b.cellFromPos(c.right,c.bottom,p);t?(f.c1=0,f.c2=b.colCount()-1,f.selectingRows=!0):f.c2=p.c1;q?(f.r1=0,f.r2=b.rowCount()-1,f.selectingCols=!0):f.r2=p.r1;if("move"===m||"resize"===m)m=a.rangeRect(f,d,!1),c.left-1>m.left&&
f.c1<f.c2&&(f.c1+=1),c.top-1>m.top&&f.r1<f.r2&&(f.r1+=1),c.right<m.right&&f.c1<f.c2&&--f.c2,c.bottom<m.bottom&&f.r1<f.r2&&--f.r2;t||q?(t&&(f.selectingRows=!0),q&&(f.selectingCols=!0)):(f.offsets={left:c.left-b.colLeft(f.c1),top:c.top-b.rowTop(f.r1),right:c.right-b.colLeft(f.c2),bottom:c.bottom-b.rowTop(f.r2)},f=b.expandRange(f));return f};this.extendRange=function(b,c,d,e){var f=a.rangeRect(b,e,!1),g=f.left,f=f.top,g=b.selectingRows?g-F:g+1,f=b.selectingCols?f-Y:f+1;c=a.rangeFromRect(b.page,g,f,c,
d,e,"extend",void 0,b.selectingCols,b.selectingRows);c.offsets&&!b.offsets&&delete c.offsets;return c};this.update=function(a){Fa||(E.pauseIdleTimer("update"),Fa=da(this.doUpdate,0,this,a))};this.doUpdate=function(a){Fa&&(E.resumeIdleTimer("update"),ta(Fa),Fa=null);var c=u.viewNode;if(!wa){wa=!0;var e=b.webFonts();if(e&&0<e.length)for(var f=e.length-1;0<=f;f--)Cc.loadWebFont(e[f])}var g=P(-b.colLeft(L)*D),h=P(-b.rowTop(y)*D);u.drawing.setOrigin(g+F,h+Y);N=L;p=void 0;for(var l=F;N<b.colCount();){if(!b.colHidden(N)&&
(l+=P(b.colWidth(N)*D),l>=c.clientWidth)){l==c.clientWidth?p=N:(p=N-1,p<L&&(p=L));break}N++}void 0===p&&(p=N);S=y;J=void 0;for(var m=Y;S<b.rowCount();){if(!b.rowHidden(S)&&(m+=P(b.rowHeight(S)*D),m>=c.clientHeight)){m==c.clientHeight?J=S:(J=S-1,J<y&&(J=y));break}S++}void 0===J&&(J=S);b.loadDataForCells(L,y,N,S,!0);var q=fb();if(q){var t=u.viewNode,n=t.pos(t.parent());q.css({left:n.left+F+"px",top:n.top+Y+"px",width:t.clientWidth-F+"px",height:t.clientHeight-Y+"px"});gb().css({left:g+"px",top:h+"px"});
for(var v=b.embeddingCount(),x=0;x<v;x++){var C=b.embed(x);if(C&&C.node&&C.position)if(void 0===C.c2)C.node.css({left:C.position.left-C.adjustX+"px",top:C.position.top-C.adjustY+"px"});else if(C.position.left===C.position.right||C.position.top===C.position.bottom)C.node.css("display","none");else{var B=(C.position.right-C.position.left)/C.w,z=(C.position.bottom-C.position.top)/C.h,Nc,K;if(1!=B||1!=z)Nc="scale("+B+","+z+")",K="left top";C.node.css({display:null,left:C.position.left-C.adjustX*B+"px",
top:C.position.top-C.adjustY*z+"px",transform:Nc,"transform-origin":K})}}}var O=r.getContext("2d");O.clearRect(0,0,r.width,r.height);O.save();var G,M=A,ea,la;b.cellGridChanged()?(R=M=A=null,b.cellGridChanged(!1)):!0===a&&(A=null);var ra=L;if(0<L)for(ea=y;ea<=S;ea++)if(!b.rowHidden(ea)&&(G=b.getCell(L,ea),!G||!G.t&&!G.v)){var oa=b.prevTextCell(L,ea);void 0!==oa&&oa<ra&&(ra=oa)}if(A&&(A.c1!=ra||A.c2!=N||A.r1!=y||A.r2!=S)){if(ra>A.c2||N<A.c1||y>A.r2||S<A.r1)R=M=null;A=null}if(!A){A=sa(ra,y,N,S);var Q=
R;R=[];for(ea=A.r1;ea<=A.r2;ea++)b.rowHidden(ea)||(R[ea-A.r1]=[]);var qa=null,U=null;for(ea=A.r1;ea<=A.r2;ea++)if(!b.rowHidden(ea))for(la=A.c1;la<=A.c2;la++){G=b.getCell(la,ea);var V=b.colStyle(la),ca=b.getCellComments(la,ea),Da=b.getCellRevisions(la,ea),W=ca||Da||G!==qa||null!==V?null:U;if(G&&!W){if(M){var ma=ea-M.r1;if(0<=ma&&ma<Q.length&&Q[ma]){var ba=la-M.c1;0<=ba&&ba<Q[ma].length&&(W=Q[ma][ba])}}W||(W=Aa(la,ea,G))}R[ea-A.r1][la-A.c1]=W;qa=G;U=W}}O.font="12px Arial,Helvetica,sans-serif";var Ca=
P((b.colRight(b.colCount()-1)-b.colLeft(L))*D),da=P((b.rowBottom(b.rowCount()-1)-b.rowTop(y))*D),aa=u.viewNode,ga=aa.clientWidth,kb=aa.clientHeight;ja||(ga>Ca&&(ga=Ca),kb>da&&(kb=da));O.oitrect(0,0,ga,kb,"#ffffff");O.fillStyle=ja?"#f3f3f3":"#eaeaea";aa.clientWidth>Ca&&O.fillRect(Ca,0,aa.clientWidth-Ca,aa.clientHeight);aa.clientHeight>da&&O.fillRect(0,da,aa.clientWidth,aa.clientHeight-da);O.oitline(.5,0,.5,kb,"#d0d0d0");for(var ka=!1,na=L+1;;na++){var Db=b.colHidden(na);if(!Db||!ka){var ua=ab(na);
if(ua>ga)break;var xa=ua+.5;O.oitline(xa,0,xa,kb,"#e0e0e0")}ka=Db}O.oitline(0,.5,ga,.5,"#d0d0d0");for(var ka=!1,va=y+1;;va++){var Lb=b.rowHidden(va);if(!Lb||!ka){var za=Xa(va);if(za>kb)break;var Hb=za+.5;O.oitline(0,Hb,ga,Hb,"#e0e0e0")}ka=Lb}var Ga=Z;b.colLeft(L);b.rowTop(y);for(var Ha=0,Ea=0;Ea<R.length;Ea++){var Oa=R[Ea],Pa=Ea+A.r1,Ja=b.rowHeight(Pa);if(0<Ja){var Ia=0;A.c1!=L&&(Ia=b.colLeft(A.c1)-b.colLeft(L));for(var Ra=Ia,Ka=0;Ka<Oa.length;Ka++){var Qa=Ka+A.c1,La=b.colWidth(Qa);if(0<La){var Ma=
Oa[Ka];if(Ma&&Ma.hasText()){ya(O,Qa,Pa,Ma,Ra,Ia,Ha,La,Ja);var Sa=b.colLeft(Qa)+Ma.textRight();if(void 0===Z||Sa>Z)Z=Sa;Ra=Ia+La}Ia+=La}}Ha+=Ja}}var Ua=c.clientWidth,Wa=c.clientHeight,Ba,Na=b.sheetRight(),Ta=b.sheetBottom();void 0!==Z&&Z>Na&&(Na=Z);d.width=Na;d.height=Ta;var Va=u.viewNode,Ya=Va.clientWidth/D,cb=Va.clientHeight/D,Za=20/D,jb=F/D,Mb=Y/D,$a=Na+jb+Za;if($a>Ya){for(var bb=b.colCount()-1;b.colLeft(bb)<Na;)bb++;for(var nb=bb,hb=b.colWidth(nb),ib=nb-1;0<=ib;ib--){var qb=hb+b.colWidth(ib);if(qb>
Ya)break;hb=qb}Ba=Ya-hb;0>Ba&&(Ba=0);Ba+=Za;var rb=b.colRight(bb)+jb+Ba;rb>$a&&($a=rb)}var db=Ta+Mb+Za;if(db>cb){for(var eb=b.rowCount()-1;b.rowTop(eb)<Ta;)eb++;for(var sb=eb,ob=b.rowHeight(sb),pb=sb-1;0<=pb;pb--){var wb=ob+b.rowHeight(pb);if(wb>cb)break;ob=wb}Ba=cb-ob;0>Ba&&(Ba=0);Ba+=Za;var Cb=b.rowBottom(eb)+Mb+Ba;Cb>db&&(db=Cb)}void 0===I&&(I=xc(d),H=yc(d));var ub=Math.ceil($a*D),vb=Math.ceil(db*D);ub>I&&(E.hiddenContent("large-sheet-unsupported"),ub=I);vb>H&&(E.hiddenContent("large-sheet-unsupported"),
vb=H);d.css({width:ub+"px",height:vb+"px"});if(Z!=Ga||Ua!=c.clientWidth||Wa!=c.clientHeight)O.restore(),k=-1,X();else{O.scale(D,D);pa(O,"drawTextBackground");pa(O,"drawBackground");pa(O,"drawBorder",!0);O.restore();O.save();var yb=b.revisions();if(yb&&w.showAnnotations){O.save();for(var Bb=0;Bb<yb.length;Bb++){var mb=yb[Bb],Kb=mb.annoRange||mb.range,Eb=mb.oldAnnoRange||mb.oldrange;switch(mb.type){case "new_cell":lb(O,Kb,null,"rgba(44,156,58,0.5)");break;case "modify_cell":lb(O,Kb,null,"rgba(148,57,174,0.5)");
break;case "clear_cell":lb(O,Kb,null,"rgba(213,61,61,0.5)");break;case "delete_row":var Fb=O,tb=Kb.r1;if(tb<=S&&tb>=y){var Gb=sa(d.index,0,tb,b.colCount()-1,tb),xb=ia(Gb);Fb.oitrect(xb.left,xb.top,xb.width,xb.height,"rgba(234,158,158,0.1)")}break;case "delete_col":var Ib=O,zb=Kb.c1;if(zb<=N&&zb>=L){var Jb=sa(d.index,zb,0,zb,b.rowCount()-1),Ab=ia(Jb);Ib.oitrect(Ab.left,Ab.top,Ab.width,Ab.height,"rgba(234,158,158,0.1)")}break;case "move_cells":lb(O,Eb,null,"rgba(213,61,61,0.5)"),lb(O,Kb,null,"rgba(44,156,58,0.5)")}}O.restore()}O.scale(D,
D);pa(O,"drawText");pa(O,"drawFlags");O.restore();fa();ha();T.update()}};this.hidePopup=function(a){};this.moveto=function(a,c,d){var e=!1;if(fc(a))if("text"===a.type)(a=b.mapToCells(a))&&0<a.length&&(e=this.moveto(a[0],c,d));else if("cell"===a.type){for(e=a.c1;e<=a.c2;e++)if(b.colHidden(e)){w.showHiddenColumns=!0;break}for(e=a.r1;e<=a.r2;e++)if(b.rowHidden(e)){w.showHiddenRows=!0;break}a.selectingRows||a.selectingCols||(a=b.expandRange(a));e=u.viewNode.scroll();this.scrollToRange(a.c1,a.r1,a.c2,
a.r2);a=u.viewNode.scroll();V(a.left-e.left,a.left,a.top-e.top,a.top,!0);c&&c(d);e=!0}return e};this.scrollToRange=function(a,c,d,e){var f=u.viewNode,g,h;if(a<L)g=a;else if(d>p){var k=f.clientWidth-F;for(g=d;0<=g;){k-=P(b.colWidth(g)*D);if(0===k)break;if(0>k){g++;break}if(0===g)break;g--}a<g&&(g=a)}if(c<y)h=c;else if(e>J){a=f.clientHeight-Y;for(h=e+1;0<=h;){a-=P(b.rowHeight(h)*D);if(0===a)break;if(0>a){h++;break}if(0===h)break;h--}c<h&&(h=c)}c=this.scrollOffset(g,h);var l,m;void 0!==g&&(l=c.left);
void 0!==h&&(m=c.top);f.scroll(l,m)};var fa=function(){var a=t.getContext("2d");a.save();a.oitrect(0,0,q.clientWidth,q.clientHeight,"#eaeaea");a.oitrect(0,0,F,Y,"#eaeaea");a.oitrect(F-11.5,Y-11.5,8,8,"#d0d0d0","#e0e0e0");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var c=12;1<=D?a.font="12px Arial,Helvetica,sans-serif":(c*=D,8>c&&(c=8),a.font=c+"px Arial,Helvetica,sans-serif");for(var c=E.cellSelection(),d=Y/2,e=0,f=!1,g=L,h=L;ja||h<=b.colCount();h++){var k=0;b.colHidden(h)?e++:
(k=P(b.colWidth(h)*D),0===k?e++:e&&(e=0,f=!0));if(1>=e){var l=ab(h)+F+.5;if(l>q.clientWidth)break;f&&(l+=2,f=!1);var m=null;if(w.showAnnotations){var p=b.colRevisions(h);if(p){for(var n=!1,r=!1,N=0;N<p.length;N++)"add_col"==p[N].type?n=!0:r=!0;n&&r?m="rgba(201,156,214,0.5)":n?m="rgba(149,205,156,0.5)":r&&(m="rgba(234,158,158,0.5)")}}!m&&c&&h>=c.c1&&h<=c.c2&&(m="#d0d0d0");m&&(a.oitrect(l,0,k,Y,"#FFF"),a.oitrect(l,0,k,Y,m),a.fillStyle="black");a.strokeStyle=c&&h>c.c1&&h<=c.c2?"#c1c1c1":"#d0d0d0";a.oitline(l,
0,l,Y,a.strokeStyle);if(!ja&&h>=b.colCount())break;0<k&&(a.save(),a.beginPath(),a.rect(l,0,k,Y),a.clip(),(m=b.colTitle(h,!1))||(m=Ma(g)),a.measureText(m).width>=k?(k=l+1,a.textAlign="left"):(k=l+k/2,a.textAlign="center"),b.colOriginalHidden(h)?a.fillStyle="#b2b2b2":a.fillStyle="#000",a.fillText(m,k,d),a.restore())}b.colDeleted(h)||g++}c=.5;a.oitline(0,c,q.clientWidth,c,"#d0d0d0");c=Y+.5;a.oitline(0,c,q.clientWidth,c,"#d0d0d0");a.restore()},ha=function(){var a=m.getContext("2d");a.save();a.oitrect(0,
0,l.clientWidth,l.clientHeight,"#eaeaea");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var c=12;1<=D?a.font="12px Arial,Helvetica,sans-serif":(c*=D,8>c&&(c=8),a.font=c+"px Arial,Helvetica,sans-serif");for(var c=E.cellSelection(),d=F/2,e=0,f=!1,g=y,h=y;ja||h<=b.rowCount();h++){var k=0;b.rowHidden(h)?e++:(k=P(b.rowHeight(h)*D),0===k?e++:e&&(e=0,f=!0));if(1>=e){var p=Xa(h)+.5;if(p>l.clientHeight)break;f&&(p+=2,f=!1);var q=null;if(w.showAnnotations){var t=b.rowRevisions(h);if(t){for(var n=
!1,r=!1,N=0;N<t.length;N++)"add_row"==t[N].type?n=!0:r=!0;n&&r?q="rgba(201,156,214,0.5)":n?q="rgba(149,205,156,0.5)":r&&(q="rgba(234,158,158,0.5)")}}!q&&c&&h>=c.r1&&h<=c.r2&&(q="#d0d0d0");q&&(a.oitrect(0,p,F,k,"#FFF"),a.oitrect(0,p,F,k,q),a.fillStyle="black");a.strokeStyle=c&&h>c.r1&&h<=c.r2?"#c1c1c1":"#d0d0d0";a.oitline(0,p,F,p,a.strokeStyle);if(!ja&&h>=b.rowCount())break;0<k&&(a.save(),a.beginPath(),a.rect(0,p,F,k),a.clip(),(q=b.rowTitle(h,!1))||(q=Ya(g)),k=p+k/2,b.rowOriginalHidden(h)?a.fillStyle=
"#b2b2b2":a.fillStyle="#000",a.fillText(q,d,k,F),a.restore())}b.rowDeleted(h)||g++}c=F+.5;a.oitline(c,0,c,l.clientHeight,"#d0d0d0");a.restore()},ia=function(a){var b={left:0,top:0,right:0,bottom:0};b.left=ab(a.c1);b.right=Ua(a.c2);b.top=Xa(a.r1);b.bottom=Ia(a.r2);a=u.viewNode.clientWidth;var c=u.viewNode.clientHeight;b.left=na(b.left,-100,a+100);b.right=na(b.right,-100,a+100);b.top=na(b.top,-100,c+100);b.bottom=na(b.bottom,-100,c+100);b.width=b.right-b.left;b.height=b.bottom-b.top;return b},lb=function(a,
b,c,d){b&&b.c1<=N&&b.c2>=L&&b.r1<=S&&b.r2>=y&&(b=ia(b),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,null,"#FFF",2),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,c,d,2,[1,6]))},aa=function(a,b){return!a||0>b||b>=a.length?null:a[b]},pa=function(a,c,d){var e=0,f,g;d&&(f=[[null,null,null],[null,null,null],[null,null,null]]);for(var h,k=null,l=0<R.length?R[0]:null,m=0;m<R.length;m++){h=k;var k=l,l=m+1<R.length?R[m+1]:null,p=m+A.r1,q=b.rowHeight(p);if(0<q){var t=0;A.c1!=L&&(t=b.colLeft(A.c1)-b.colLeft(L));
for(var n=0;n<k.length;n++){var r=n+A.c1,N=b.colWidth(r),D=k[n];if(0<N&&D){var v=D.horizontalMerge(),u=D.verticalMerge(),y=N,x=q;for(g=1;g<=v;g++)y+=b.colWidth(r+g);for(g=1;g<=u;g++)x+=b.rowHeight(p+g);!0===d&&(f[0][0]=aa(h,n-1),f[0][1]=aa(h,n),f[0][2]=aa(h,n+1),f[1][0]=aa(k,n-1),f[1][1]=D,f[1][2]=aa(k,n+1),f[2][0]=aa(l,n-1),f[2][1]=aa(l,n),f[2][2]=aa(l,n+1));D[c](a,r,p,t,e,y,x,f)}t+=N}e+=q}}},ya=function(a,c,d,e,f,g,h,k,l){var m,p;void 0===g&&(g=b.colLeft(c)-b.colLeft(L));void 0===h&&(h=b.rowTop(d)-
b.rowTop(y));void 0===k&&(k=b.colWidth(c));void 0===l&&(l=b.rowHeight(d));if(void 0===f)for(f=g,m=c-1;0<=m;m--){var q=b.getCell(m,d);if(q&&(q.t||q.v))break;f=b.colLeft(m)-b.colLeft(L)}var q=e.horizontalMerge(),t=e.verticalMerge();if((m="cs"===e.horizontalAlign())||0<q)for(p=1;(m||p<=q)&&!(m&&(m=b.getCell(c+p,d),m=!m||m.t||m.v?!1:"cs"===b.cellStyle(m.s).a,!m&&p>q));)k+=b.colWidth(c+p),p++;for(p=1;p<=t;p++)l+=b.rowHeight(d+p);q=b.colLeft(L);t=b.colRight(N)-q;p=void 0;ja||(p=b.colRight(c)-q);for(c+=
1;;c++){m=b.getCell(c,d);if(!m)break;if(m.t||m.v){p=b.colLeft(c)-q;break}m=b.colRight(c)-q;if(m>t)break;ja||(p=m)}e.layoutText(a,g,h,k,l,f,p)},Aa=function(a,c,d){d||(d=b.getCell(a,c));if(d)return f=d=new td(d,b,a,c),h=a,B=c,d},ua=function(a){var c;if(a>=F){a-=F;for(var d=L;d<b.colCount();){var e=Ua(d),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(c=d,a<=e))break;d++}}return c},xa=function(a){var b;if(a>=F)for(a-=F,b=L;!(a<Ua(b));b++);return b},za=function(a){var c;if(a>=Y){a-=Y;for(var d=y;d<b.rowCount();){var e=
Ia(d),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(c=d,a<=e))break;d++}}return c},Ga=function(a){var b;if(a>=Y)for(a-=Y,b=y;!(a<Ia(b));b++);return b},Ha=function(a,b){var c;if(a)for(var d=0;d<a.length;d++){var e=a[d];if(0===Na(e.range,b)){c=e;break}if(e.oldrange&&0===Na(e.oldrange,b)){c=e;break}}return c},Ea=function(a){-1==la&&-1==U&&(a=u.viewNode.mousePos(a),a=void 0!==ua(a.x)?"col-resize":null,t.css("cursor",a))},Pa=function(a){return-1==la&&(a=ua(a.center.x),void 0!==a)?(U=a,!1):!0},Ra=function(c){if(-1!=
la)c=xa(c.center.x),T.select(sa(d.index,la,0,c,b.rowCount()-1));else if(-1!=U){c=P((c.center.x-F)/D)+b.colLeft(L);var e=b.colLeft(U);c=c>=e?c-e:0;c!=b.colWidth(U)&&(b.setColWidth(U,c),T.update(),a.update(),Q.positionAll(d))}return!1},Ja=function(a){-1!=U&&(U=-1,X(),Q.positionAll(d));return!1},Ka=function(a){la=xa(a.center.x);T.select(sa(d.index,la,0,la,b.rowCount()-1))},Qa=function(a){la=-1},Sa=function(a){-1==ea&&-1==oa&&(a=u.viewNode.mousePos(a),a=void 0!==za(a.y)?"row-resize":null,m.css("cursor",
a))},Wa=function(a){return-1==ea&&(a=za(a.center.y),void 0!==a)?(oa=a,!1):!0},Ba=function(c){if(-1!=ea)c=Ga(c.center.y),T.select(sa(d.index,0,ea,b.colCount()-1,c));else if(-1!==oa){c=P((c.center.y-Y)/D)+b.rowTop(y);var e=b.rowTop(oa);c=c>=e?c-e:0;c!=b.rowHeight(oa)&&(b.setRowHeight(oa,c),T.update(),a.update(),Q.positionAll(d))}return!1},La=function(a){-1!==oa&&(oa=-1,X(),Q.positionAll(d));return!1},Ta=function(a){ea=Ga(a.center.y);T.select(sa(d.index,0,ea,b.colCount()-1,ea))},Va=function(a){ea=-1},
Xa=function(a){return P((b.rowTop(a)-b.rowTop(y))*D)},Ia=function(a){return P((b.rowBottom(a)-b.rowTop(y))*D)},ab=function(a){return P((b.colLeft(a)-b.colLeft(L))*D)},Ua=function(a){return P((b.colRight(a)-b.colLeft(L))*D)},fb=function(){void 0===K&&(K=d.childByClass("oit-sheet-embedpane"))&&u.viewNode.parent().append(K);return K},gb=function(){if(void 0===M){var a=fb();M=a?a.childByClass("oit-sheet-embedlist"):null}return M};(function(){var a=u.viewNode;g=a.parent().childByClass("oit-ssoverlay");
g||(g=x.create("div","oit-ssoverlay"),a.parent().insert(g,a));g.html("");O=d.overlay.childByClass("oit-sel-text");O||(O=x.create("div"),d.overlay.append(O));C=x.create("pre");O.addClass("oit-sel-text");O.html("");O.append(C);ra=new rd;ra.show();E.onscroll(V);T.onselectionchanged(W);z.onpageload(G);ka.onresize(X);a=a.scroll();V(a.left,a.left,a.top,a.top,!1);X(!1);da(function(){Q.eachOnPage(function(a){b.addHighlight(a);Q.link(a)},d)},0)})()}}(),sd=function(){function c(a,b,c){this.value=a;this.type=
b;this.subtype=c}function e(){this.items=[];this.add=function(a,b,d){d||(d="");a=new c(a,b,d);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:
this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function a(){this.items=[];this.pushToken=function(a,b,d){this.items.push(new c(a,b,d))};this.push=function(a){this.items.push(a)};this.pop=function(){var a=this.items.pop();return new c(a.value,a.type,w)};this.token=function(){return 0<this.items.length?this.items[this.items.length-1]:null};this.value=function(){return this.token()?this.token().value:""};this.type=function(){return this.token()?
this.token().type:""};this.subtype=function(){return this.token()?this.token().subtype:""}}function b(a,b,c,d){var e=!1,f=0,g=!1,h=0;a=a.replace(p,"");a=a.replace(ja,"@");a=a.replace(Z,"");var k=a.length,l=a.indexOf("!")+1,m="";0<l&&(m=a.slice(0,l-1));var q=a.slice(l,a.length),t=m.match(D);if(t&&d){var n=""+t[0],t="'";n.charCodeAt(0)==J&&(n=n.slice(1,n.length),t="");n=n.slice(1,n.length-1);n=parseInt(n,10);0<n&&n--;if(n<d.length){d=d[n];d=d.replace(S,"\\");var n=d.lastIndexOf("\\"),r;0<=n?(r=d.slice(n+
1,d.length),d=d.slice(0,n+1)):(r=d,d="");0===d.indexOf("file:\\\\\\")&&(d=d.slice(8,d.length));m="'"+m.replace(D,d+"["+r+"]")+t;m=m.replace(oa," ")}}t=a.charCodeAt(l);l<k&&t==E&&(e=!0,l++,t=a.charCodeAt(l));for((d=l<k&&t>=F&&t<=Q)||(g=e);l<k&&t>=F&&t<=Q;)f=26*f+(t-F+1),l++,t=a.charCodeAt(l);16172<f&&(d=!1);l<k&&t==E&&(g=!0,l++,t=a.charCodeAt(l));for(n=l<k&&t>=P&&t<=N;l<k&&t>=P&&t<=N;)h=10*h+(t-P),l++,t=a.charCodeAt(l);e||(f+=b);g||(h+=c);0<f&&f--;""!==m&&(m+="!");return l==k&&(d||n)?m+(d?(e?"$":"")+
Ma(f):"")+(n?(g?"$":"")+h:""):m+q}function d(b){for(var c=new e,d=new a,N=0,D=function(){return b.substr(N,1)},J="",O=!1,Z=!1,I=!1,K=!1;0<b.length;)if(" "==b.substr(0,1))b=b.substr(1);else{"="==b.substr(0,1)&&(b=b.substr(1));break}for(var E=/^[1-9]{1}(\.[0-9]+)?E{1}$/;!(N>=b.length);)if(O)'"'==D()?'"'==b.substr(N+1,1)?(J+='"',N+=1):(O=!1,c.add('"'+J+'"',k,H),J=""):J+=D(),N+=1;else if(Z)"'"==D()?"'"==b.substr(N+1,1)?(J+="'",N+=1):(J+=D(),Z=!1):J+=D(),N+=1;else if(I)"]"==D()&&(I=!1),J+=D(),N+=1;else if(K)J+=
D(),N+=1,-1!=",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+J+",")&&(K=!1,c.add(J,k,R),J="");else if(-1!="+-".indexOf(D())&&1<J.length&&J.match(E))J+=D(),N+=1;else if('"'==D())0<J.length&&(c.add(J,u),J=""),O=!0,N+=1;else if("'"==D())0<J.length?(c.add(J,u),J=""):J+=D(),Z=!0,N+=1;else if("["==D())I=!0,J+=D(),N+=1;else if("#"==D())0<J.length&&(c.add(J,u),J=""),K=!0,J+=D(),N+=1;else if("{"==D())0<J.length&&(c.add(J,u),J=""),c.add("{",n,x),d.pushToken("}",n,w),c.add("",n,x),d.pushToken("",
n,w),N+=1;else if(";"==D())0<J.length&&(c.add(J,k),J=""),c.addRef(d.pop()),c.add(";",v),c.add("",n,x),d.pushToken("",n,w),N+=1;else if("}"==D())0<J.length&&(c.add(J,k),J=""),c.addRef(d.pop()),c.addRef(d.pop()),N+=1;else if(" "==D())for(0<J.length&&(c.add(J,k),J=""),c.add("",l),N+=1;" "==D()&&!(N>=b.length);)N+=1;else-1!=",>=,<=,<>,".indexOf(","+b.substr(N,2)+",")?(0<J.length&&(c.add(J,k),J=""),c.add(b.substr(N,2),q,C),N+=2):(-1!="+-*/^&=><".indexOf(D())?(0<J.length&&(c.add(J,k),J=""),c.add(D(),q)):
-1!="%".indexOf(D())?(0<J.length&&(c.add(J,k),J=""),c.add(D(),m)):"("==D()?0<J.length?(c.add(J.replace(p,"")+"(",n,x),d.pushToken(")",n,w),J=""):(c.add("(",r,x),d.pushToken(")",r,w)):","==D()?(0<J.length&&(c.add(J,k),J=""),d.type()!=n?c.add(D(),q,y):c.add(D(),v)):")"==D()?(0<J.length&&(c.add(J,k),J=""),c.addRef(d.pop())):J+=D(),N+=1);0<J.length&&c.add(J,k);for(d=new e;c.moveNext();)J=c.current(),J.type==l?c.BOF()||c.EOF()||(c.previous().type==n&&c.previous().subtype==w||c.previous().type==r&&c.previous().subtype==
w||c.previous().type==k)&&(c.next().type==n&&c.next().subtype==x||c.next().type==r&&c.next().subtype==x||c.next().type==k)&&d.add(" ",q,B):d.addRef(J);for(;d.moveNext();)J=d.current(),J.type==q&&"-"==J.value?d.BOF()?J.type=t:d.previous().type==n&&d.previous().subtype==w||d.previous().type==r&&d.previous().subtype==w||d.previous().type==m||d.previous().type==k?J.subtype=f:J.type=t:J.type==q&&"+"==J.value?d.BOF()?J.type=g:d.previous().type==n&&d.previous().subtype==w||d.previous().type==r&&d.previous().subtype==
w||d.previous().type==m||d.previous().type==k?J.subtype=f:J.type=g:J.type==q&&0===J.subtype.length?-1!="<>=".indexOf(J.value.substr(0,1))?J.subtype=C:J.subtype="&"==J.value?h:f:J.type==k&&0===J.subtype.length?isNaN(parseFloat(J.value))?J.subtype="TRUE"==J.value||"FALSE"==J.value?C:A:J.subtype=z:J.type==n&&"@"==J.value.substr(0,1)&&(J.value=J.value.substr(1));d.reset();for(c=new e;d.moveNext();)d.current().type!=g&&c.addRef(d.current());c.reset();return c}var g="noop",k="operand",n="function",r="subexpression",
v="argument",t="operator-prefix",q="operator-infix",m="operator-postfix",l="white-space",u="unknown",x="start",w="stop",H="text",z="number",C="logical",R="error",A="range",f="math",h="concatenate",B="intersect",y="union",E=36,F=65,Q=90,P=48,N=57,J=39,p=/\u005F[^\u002E]*\u002E/,D=/^'?\u005B[0-9]+\u005D/,ja=/\u005B\u0023This Row\u005D/,Z=/\u005B\u005D/,oa=/%20/g,S=/\u002F/g;return function(a,c,e,f){a=d(a);for(var g="",h;a.moveNext();){var k=a.current();if(k.subtype!=y&&k.type!=v||!h||h.subtype!=A||
64!=h.value.charCodeAt(h.value.length-1)){if(k.subtype==A){h=k;var l;l=k.value;var m=c,p=e,q=f,t=l.lastIndexOf(":");l=0<t?b(l.slice(0,t),m,p,q)+":"+b(l.slice(t+1),m,p,q):b(l,m,p,q);h.value=l}g+=k.value}h=k}return g}}(),od=function(){var c={ATTACHMENTS:"ATTACHMENT",BADDRESS:"BUSINESSADDRESS",BPHONE:"BUSINESSPHONE",CALENDAREXCEPTIONS:"CALENDAR_EXCEPTION",CATEGORY:"CATEGORIES",CREATED:"CREATION_TIME",DUEDATE:"DUE_DATE",ENDDATE:"DTEND",ENDTIME:"DTEND",ENTRYTYPE:"ENTRY_TYPE",FAX:"BUSINESSFAX",HADDRESS:"HOMEADDRESS",
HPHONE:"HOMEPHONE",IM:"IMADDRESS",LAST:"FAMILY",NAME:"FULLNAME",MOBILE:"MOBILEPHONE",OPTATTEND:"OPTATTENDEE",PERCENT:"PERCENT_COMPLETE",RECURRANGE:"RECURRENCE_RANGE",RECURTYPE:"RECURRENCE_TYPE",REQATTEND:"REQATTENDEE",STARTDATE:"START_DATE",STARTTIME:"DTSTART",TOPIC:"CONVERSATION_TOPIC"},e={FI_OUTLOOK_MSG_APPT:"calendarentry",FI_OUTLOOK_MSG_CDSMAIL:"msg",FI_OUTLOOK_MSG_CONTACT:"contact",FI_OUTLOOK_MSG_DISTLIST:"contactgroup",FI_OUTLOOK_MSG_JOURNAL:"journal",FI_OUTLOOK_MSG_MAIL:"msg",FI_OUTLOOK_MSG_NDR:"msg",
FI_OUTLOOK_MSG_NOTE:"note",FI_OUTLOOK_MSG_ODSMAIL:"msg",FI_OUTLOOK_MSG_POST:"note",FI_OUTLOOK_MSG_TASK:"task",FI_OUTLOOK_OFT_APPT:"calendarentry",FI_OUTLOOK_OFT_CDSMAIL:"msg",FI_OUTLOOK_OFT_CONTACT:"contact",FI_OUTLOOK_OFT_DISTLIST:"contactgroup",FI_OUTLOOK_OFT_JOURNAL:"journal",FI_OUTLOOK_OFT_MAIL:"msg",FI_OUTLOOK_OFT_NDR:"msg",FI_OUTLOOK_OFT_NOTE:"note",FI_OUTLOOK_OFT_ODSMAIL:"msg",FI_OUTLOOK_OFT_POST:"note",FI_OUTLOOK_OFT_TASK:"task",ai:"vector",bmp:"image",cdr:"vector",cgm:"vector",chtml:"ie",
cur:"image",dcx:"image",dgn:"vector",doc:"doc",docx:"doc",drw:"vector",dwg:"vector",dxf:"vector",emf:"vector",eml:"msg",fft:"text",gdf:"vector",gem:"vector",gif:"image",hdml:"ie",hpgl:"vector",htm:"ie",html:"ie",ico:"image",ics:"calendar",img:"image",indd:"image",jpg:"image",lwp:"text",mhtml:"ie",mpg:"video",mpp:"project",msg:"msg",odg:"vector",odi:"image",odt:"text",oft:"text",pbm:"image",pcd:"image",pct:"image",pcx:"image",pdf:"pdf",pdfi:"image",pgm:"image",pic:"vector",pif:"vector",png:"image",
ppm:"image",ppt:"ppt",pptx:"ppt",ps:"vector",psd:"image",psp:"image",pst:"msg",rtf:"text",sdw:"image",svg:"vector",tga:"image",tif:"image",txt:"text",vsd:"vsd",wbmp:"image",wmf:"vector",wml:"ie",wmv:"video",wpd:"text",wpg:"image",xbm:"image",xhtml:"ie",xlc:"xls",xls:"xls",xlsb:"xls",xlsx:"xls",xml:"ie",xmp:"ie",xpm:"image",yim:"text",zip:"zip"},a=function(a){V.call(this,a);x.attach(this);this._page=z.forNode(a);if(!this._page._fields&&(a=(a=this.byClass("oit-maildata"))?a[0]:x.byId("oit-maildata"))){var b=
this.byClass("oit-emhdrlabel"),C=this.byClass("oit-emhdrvalue"),H=[];if(b&&C&&b.length==C.length)for(var A=0;A<b.length;A++){var f=b[A],h=C[A];if("oit-email_attachments"!=f.id){var B={},y;f.id&&0===f.id.indexOf("oit-email_")&&(y=f.id.substring(10).toUpperCase(),B.id=c[y]||y);if(!B.id)for(y=0;;y++){var I=f.classList.item(y);if(!I)break;if(0===I.indexOf("oit-email_")){y=I.substring(10).toUpperCase();B.id=c[y]||y;break}}B.id||(B.label=f.html());f=h.attr("data-acc");1==h.dom.childElementCount?h=h.firstChildElem():
(y=x.create("div"),y.transferFrom(h),h=y);f&&(h.attr("data-acc",f),"none"===f&&h.addClass("oit-noacc"));B.value=h.dom.outerHTML;H.push(B)}}this._page._fields=H;a.destroy()}this.html('<div class="oit-headerpadding"><table class="oit-maildata"></table><div class="oit_attachments oit-noacc" data-acc="none"></div></div><div class="oit-emextra"><div class="oit-em_allheaders"><table class="oit-emheadervalues"></table></div></div>');this._hdrtable=this.byClass("oit-maildata")[0];a=this.parent().parent();
a.hasClass("oit-emailstream")&&(b=x.create("div","oit-emailbk"),b.transferFrom(a),a.append(b),a.addClass("oit-emailfill"));b=this._page._fields;a=this.byClass("oit-em_allheaders")[0];if(w.removeExtraEmailHeaders||u.isMobile)a.destroy(),a=null;d(b);switch(this.data("subtype")){case "journal":C=w.journalHeader;break;case "contact":C=w.contactHeader;break;case "note":C=w.noteHeader;break;case "appt":C=w.appointmentHeader;break;case "task":C=w.taskHeader;break;case "post":C=w.postHeader;break;case "dist":C=
w.distroHeader;break;default:C=w.emailHeader}H=this._page._fields;if(C.subjectField)if(B=m(H,C.subjectField),A=m(H,C.dateField),!C.subjectField&&!C.dateField||B||!1===C.defaultSubject||(B=new Oc({id:"SUBJECT",value:'<div class="oit-emhdrvalue oit-textfield"><div><span></span></div></div>'})),B){if(B.addedToHeader=!0,h=this.subjectBar=x.create("div","oit-email-subjectbar"),f=B.clone(),f.addContainerClass("oit-email-subject"),f.appendAsDiv(h),f.labelElem.html(""),this.fixedSubjectField=f,f.valueElem.text()||
(f.valueElem.addClass("oit-nosubject"),f.valueElem.text(U.NO_SUBJECT)),f=this._hdrtable.parent(),f.insert(h,f.firstChildElem()),B.hide(),A&&(this.headerDateField=A,B=A.clone(),B.addContainerClass("oit-email-date"),B.appendAsDiv(h),this.fixedDateField=B,A.appendAsRow(this._hdrtable),A.hide()),!u.isMobile&&(A=h.clone(!0)))this.stickyHeader=x.create("div","oit-email-stickyheader"),this.stickyHeader.append(A),this.stickyHeader.onmouseover(this,l),this.stickyHeader.onmouseout(this,K),this.stickyHeader.ontap(this,
E),u.viewNode.parent().append(this.stickyHeader),this.stickyHeaderVisible=!1,this.stickyDateFixedField=this.stickyHeader.byClass("oit-email-date"),Array.isArray(this.stickyDateFixedField)&&(this.stickyDateFixedField=this.stickyDateFixedField[0])}else this.addClass("oit-nosubject");C.photoField&&(A=m(H,C.photoField))&&(A.addContainerClass("oit-email-photo"),A.insertAsDiv(this._hdrtable.parent(),this._hdrtable),A.labelElem.html(""));C.logoField&&(A=m(H,C.logoField))&&(A.addContainerClass("oit-email-logo"),
A.insertAsDiv(this._hdrtable.parent(),this._hdrtable),A.labelElem.html(""));if(C.headerFields)for(h=x.create("tbody"),B=0;B<C.headerFields.length;B++)if(f=C.headerFields[B],"string"==typeof f||Array.isArray(f))(y=m(H,f))&&y.appendAsRow(this._hdrtable);else if(f.fields)if(f.multi){y=[];for(A=0;A<f.fields.length;A++)q(H,f.fields[A],null,y);for(A=0;A<y.length;A++)y[A].appendAsRow(this._hdrtable)}else if(f.title){I=[];for(A=0;A<f.fields.length;A++)if(y=m(H,f.fields[A]))y.showType(!1),I.push(y);if(0<I.length)for(h.html('<tr><td class="oit-emhdrsection" colspan="3"><span data-acc="none" class="oit-noacc">'+
U["EMAIL_"+f.title]+U.LABEL_SEPARATOR+"</span></td></tr>"),this._hdrtable.append(h.firstChildElem()),A=0;A<I.length;A++)I[A].appendAsRow(this._hdrtable)}if(this.stickyHeader){this.stickyHeaderDetail=x.create("div","oit-shdetail");this.stickyHeaderDetailShown=!1;C=x.wrap(this._hdrtable.clone(!0));A=!1;h=0;for(B=C.firstChildElem();B;B=H)H=B.nextSiblingElem(),h++,A||(20<h?A=!0:B.firstChildElem().hasClass("oit-emhdrsection")&&(A=!0)),A&&B.destroy();this.stickyHeaderDetail.append(C);this.stickyHeader.append(this.stickyHeaderDetail);
this.stickyDateHeaderField=C.byClass("DATE");this.stickyDateHeaderField||(this.stickyDateHeaderField=C.byClass("RECEIVED"));Array.isArray(this.stickyDateHeaderField)&&(this.stickyDateHeaderField=this.stickyDateHeaderField[0]);this.stickyDateHeaderField&&(this.stickyDateHeaderField=this.stickyDateHeaderField.parent());t(this.stickyHeader)}g(b)&&(this._emailExpander=x.create("div","oit-showemail"),this._emailExpander.onclick(this,v),this._emailExpander.ontap(this,v),this._hdrtable.parent().insert(this._emailExpander,
this._hdrtable),w.showEmailAddresses?n.call(this):r.call(this));if(a)if(C=a.firstChildElem(),b=k(C,b))for(this.allHeaders=new ud(this,a,"oit-email_gear_icon",18,18,U.SHOWDETAILS,U.HIDEDETAILS),this.byClass("oit-headerpadding")[0].append(this.allHeaders),C=0;C<b.length;C++)b[C].tab=this.allHeaders;else a.destroy(),a=null;a||this.removeExtraEmailHeaders();if((a=this._page._attachments)&&0<a.length){b=this.byClass("oit_attachments")[0];C=x.create("div");for(H=0;H<a.length;H++)A=a[H],A.ext||(h=A.name,
B=h.lastIndexOf("."),A.ext="",-1!=B&&(A.ext=h.substring(B+1).toLowerCase())),(h=e[A.file_id]||e[A.ext])||(h="generic"),h=['<div class="oit-attached-file" data-index="',A.id,'">','<div class="oit-ficon oit-ficon-',h,'"><div></div></div>','<div class="oit-attinfo">',"<div>",A.displayName||A.name,"</div>"],A.size&&(h.push("<div>"),A.size&&h.push(wc(A.size)),h.push("</div>")),h.push("</div></div>"),C.html(h.join("")),h=C.firstChildElem(),b.append(h),ob.on.addElement(h,A.id);C.html('<div style="clear:both;"></div>');
b.append(C.firstChildElem())}this._page.pageContentChanged();this.applyShowEmailAddresses();this.onStyleChanged()},b=X(a,V);b.destroy=function(){ob.on.removeAllElements();this.stickyHeader&&this.stickyHeader.destroy();V.prototype.destroy.call(this)};b.scrollPadding=function(){if(this.stickyHeaderVisible)return{top:this.stickyHeader.offsetHeight}};var d=function(a,b){if(a)for(var c=0;c<a.length;c++){var e=a[c];e.appendAsRow||(a[c]=new Oc(e,b));e.subfields&&d(e.subfields,a[c])}},g=function(a){var b=
!1;if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d.addedToHeader&&d.hasEmailAddresses){b=!0;break}if(d.subfields&&(b=g(d.subfields)))break}return b},k=function(a,b,c){c||(c=[]);if(b){var d,e;for(d=0;d<b.length;d++)e=b[d],e.subfields||e.addedToHeader||!e.hasValue()||(e.appendToExtra(a),e.extra=!0,c.push(e));for(d=0;d<b.length;d++)if(e=b[d],e.subfields){var f=a,g=c,l=e.subfields;if(l)for(var m=!0,q=0;q<l.length;q++){var t=l[q];if(!t.addedToHeader&&(t.hasValue()||t.subfields)){if(e&&m){var n=U["EMAIL_"+
e.fieldId];if(n||e.fieldDef.label){var r,m=[];m.push('<tr><td class="oit-emhdrsection" colspan="2">');e.fieldType&&(r=e.fieldType.substring(1,e.fieldType.length-1));n?m.push('<span data-acc="none" class="oit-noacc">',n):m.push(e.fieldDef.label,'<span data-acc="none" class="oit-noacc">');r&&m.push(" (",r,")");m.push(U.LABEL_SEPARATOR,"</span></td><td></td></tr>");m=m.join("");n=x.create("tbody");n.html(m);f.append(n.firstChildElem())}m=!1}t.appendToExtra(f);g.push(t)}t.subfields&&k(f,t.subfields,g)}}}return 0===
c.length?null:c};b.applyShowEmailAddresses=function(){this._emailExpander&&(w.showEmailAddresses?n.call(this):r.call(this),this.applyViewSize(!0))};var n=function(){this._emailExpander&&(this._page.addClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.addClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-showemail").addClass("oit-hideemail"),z.each("pageLayoutChanged"))},r=function(){this._emailExpander&&(this._page.removeClass("oit-email-addr-visible"),this.stickyHeader&&
this.stickyHeader.removeClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-hideemail").addClass("oit-showemail"),z.each("pageLayoutChanged"))},v=function(){w.showEmailAddresses=!w.showEmailAddresses},t=function(a){a.attr("data-acc")&&a.attr("data-acc","none");for(a=a.firstChildElem();a;a=a.nextSiblingElem())t(a)},q=function(a,b,c,d){if(b&&a){var e,f;if(Array.isArray(b))for(e=0;e<b.length;e++)q(a,b[e],null,d);else if(b.g)for(c=b.t?";"+b.t+";":null,e=0;e<a.length;e++)f=a[e],f.subfields&&
f.fieldId==b.g&&(c?f.fieldType&&-1!=f.fieldType.indexOf(c)&&q(f.subfields,b.id,b.d,d):q(f.subfields,b.id,b.d,d));else if("string"==typeof b)for(e=0;e<a.length;e++)if(f=a[e],f.fieldId==b&&!f.addedToHeader&&(f.hasValue()||f.isCompound())){d.push(f);var g=null;if(c&&"string"==typeof c)for(var k=0;k<a.length;k++){var l=a[k];if(l.hasValue()&&!l.addedToHeader&&l.fieldId==c){g=l;break}}f.setDisplayField(g)}}},m=function(a,b){if(a&&b){var c=[];q(a,b,null,c);if(1<=c.length)return c[0]}},l=function(){if(this.stickyHeaderDetail&&
!T.isSelecting()){var a=this.stickyHeaderDetail.firstChildElem().outerHeight;this.stickyHeaderDetail.css("height",""+a+"px");this.stickyHeaderDetailShown=!0}},K=function(){this.stickyHeaderDetail&&(this.stickyHeaderDetail.css("height",null),this.stickyHeaderDetailShown=!1)},E=function(){this.stickyHeaderDetailShown?K.call(this):l.call(this)};b.applyViewSize=function(a){var b;this.stickyHeader&&this.stickyHeader.css("width",null);this.fixedSubjectField&&(a=this.fixedSubjectField.containerWidth(),this.fixedDateField&&
(this.fixedDateField.show(),a+=this.fixedDateField.containerWidth()),b=u.viewNode.clientWidth,w.nochrome||(b-=42),a>b?(this.fixedDateField&&this.fixedDateField.hide(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display","none"),this.headerDateField&&this.headerDateField.show(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display",null)):(this.fixedDateField&&this.fixedDateField.show(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display",null),this.headerDateField&&
this.headerDateField.hide(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display","none")));this.stickyHeader&&(a=this._page.parent().offsetWidth,b=u.viewNode.clientWidth,w.nochrome||(a-=2,b-=21),a>b&&(a=b),this.stickyHeader.css("width",a+"px"));if(!this._page.isHidden())Q.onEmailHeaderResize(this._page.index);this._page.overlay.each("pageLayoutChanged")};b.finishAnimation=function(){this._page&&this._page.finishAnimation()};b.showStickyHeader=function(){if(this.stickyHeader&&this.subjectBar&&
(this.stickyHeaderVisible||(this.stickyHeader.addClass("oit-email-shvisible"),w.nochrome?this.stickyHeader.addClass("oit-nochrome"):this.stickyHeader.removeClass("oit-nochrome"),this.stickyHeaderVisible=!0),this.stickyHeaderVisible&&!w.nochrome)){var a=u.viewNode.scrollLeft;0===a?this.stickyHeader.css("left",null):this.stickyHeader.css("left",21-a+"px")}};b.hideStickyHeader=function(){this.stickyHeader&&this.subjectBar&&this.stickyHeaderVisible&&(this.stickyHeader.removeClass("oit-email-shvisible"),
this.stickyHeaderVisible=!1)};b.onScroll=function(){this.stickyHeader&&this.subjectBar&&(0>this.subjectBar.pos(this.stickyHeader.parent()).top?this.showStickyHeader():this.hideStickyHeader())};b.beginSelection=function(a){this._selectionPos=null;this.showEmailHeader(a)};b.getEmailFieldForRange=function(a){var b;if(a&&"text"==a.type){var c=this._page._fields,d;for(d in c){var e=c[d];if("custom"===d)for(var f=0;f<e.length;f++){if(b=e[f].subfieldByRange(a))return b}else if(b=e.subfieldByRange(a))return b}}};
b.moveto=function(a,b,c){return(a=this.showEmailHeader(a,b,c))&&a.tab?!0:!1};b.showEmailHeader=function(a,b,c){if(a&&"text"==a.type){var d=this.getEmailFieldForRange(a);if(d)if(d.field&&this.hideStickyHeader(),d.tab)c=c||{},d.tab.activate(null,!0),d.tab.scrollToRange(a),b&&b(c),this._selectionPos="tab";else{for(var e=d.addresses;!e&&d.groupField;)d=d.groupField,e=d.addresses;if(e&&!w.showEmailAddresses)for(var f=0;f<e.length;f++){var g=e[f].address;if(g){var k=g.acc;if(k+g.text.length>=a.acc&&k<=
a.accend){w.showEmailAddresses=!0;break}}}b&&b(c)}return d}};b.onStyleChanged=function(){this.applyEmailHeaderStyles()};b.applyEmailHeaderStyles=function(){try{this._headerStyle&&this.css(this._headerStyle),this.applyViewSize()}catch(H){this.logError("email header style","An error occurred setting email header style")}};var I=function(a,b){var c=!1;if(a.subfields)for(var d=a.subfields.length-1;0<=d;d--)I(a.subfields[d],b)&&a.subfields.splice(d,1);if(!a.addedToHeader||a.extra)a.range&&b.push(a.range),
c=!0;return c};b.removeExtraEmailHeaders=function(){this.allHeaders&&this.allHeaders.activate(null,!1);var a=this._page._fields;if(a){for(var b=[],c=a.length-1;0<=c;c--)I(a[c],b)&&a.splice(c,1);b.length&&(ia.replaceRawText(b),Q.removeFromRange(b))}this.allHeaders&&(this.allHeaders.destroy(),delete this.allHeaders)};return a}(),ud=function(){var c=function(b,c,e,n,r,u,t){V.call(this,"div","oit-button");x.attach(this);e&&this.addClass(e);this._header=b;this._minHeight=this._fullHeight=r;this._clientDiv=
c;this._active=!1;this._utip=u;t&&(this._atip=t);u&&this.attr("title",u);if(this._clientDiv)this._clientDiv.on("scroll",null,a,this);this.on("click",this,this.activate,"toggle");this.on("tap",this,this.activate,"toggle")},e=X(c,V);e.destroy=function(){this._clientDiv&&(this._clientDiv.offscroll(a),delete this._clientDiv);this.offclick(this.activate);this.offtap(this.activate);V.prototype.destroy.call(this)};var a=function(a,b){var c=b._clientDiv.scroll();b._scroll&&c.left==b._scroll.left&&c.top==
b._scroll.top||(b._scroll=c,c=z.page(0),Q.deactivate(),c.pageLayoutChanged(),Q.positionAll(c))};e.isActive=function(){return this._active};e.containsRange=function(a){var b=x.wrap(a.startContainer);a=x.wrap(a.endContainer);var c=x.isDescendantOf(b,this._clientDiv);if(c||x.isDescendantOf(a,this._clientDiv))return{tab:this,rangeElem:c?b:a}};e.scrollToRange=function(b){if(this._clientDiv.childByClass("oit-emheadervalues")&&(b=F.rangeRect(b,"view"))){var c=0,d=0,e=u.viewNode.clientWidth,r=u.viewNode.clientHeight;
0>b.left?c=b.left-10:b.right>e&&(c=b.right+10-e);0>b.top?d=b.top-10:b.bottom>r&&(d=b.bottom+10-r);if(c||d)u.viewNode.dscroll(c,d),a(null,this)}};var b=function(a,b,c){(b=b.getEmailFieldForRange(a.range))&&b.tab&&(a.id==Q.active()&&Q.deactivate(),a.removeFromPage(c))};e.activate=function(a,c){var d=this._active;"toggle"==c?d=!d:"boolean"===typeof c&&(d=c);if(d!==this._active){var e=this._header._page;this._header.finishAnimation();(this._active=d)||"tab"!==this._selectionPos||T.select(null);d||(Q.each(b,
e,this._header,e.index),u.viewNode.scroll(0,0));d?(this.addClass("oit-activetab"),this._clientDiv.parent().addClass("oit-activetab"),this._atip&&this.attr("title",this._atip)):(this.removeClass("oit-activetab"),this._clientDiv.parent().removeClass("oit-activetab"),this._utip&&this.attr("title",this._utip));this._header.applyViewSize()}};return c}(),Oc=function(){var c="TO CC BCC FROM EMAIL EMAIL2 EMAIL3 RCVD_REPRESENTING_ADDRESS RECEIVED_BY_EMAIL_ADDRESS SENDER_EMAIL_ADDRESS SENT_REPRESENTING_EMAIL_ADDRESS".split(" "),
e=["ORGANIZER","ATTENDEES"],a=function(a,b){V.call(this);this.fieldDef=a;a.id&&(this.fieldId=a.id);a.type&&(this.fieldType=";"+a.type+";");a.subfields&&(this.subfields=a.subfields);a.range&&(this.range=a.range);this.container=x.create("div");b&&(this.groupField=b,this.showGroupType=!0);this.addedToHeader=!1},b=X(a,V);b.clone=function(){return new a(this.fieldDef)};b.isCompound=function(){return this.subfields&&0<this.subfields.length&&-1!=e.indexOf(this.fieldId)};b.show=function(){this.container.css("display",
null);this.container.attr("data-acc",null)};b.hide=function(){this.container.css("display","none");this.container.attr("data-acc","none")};b.showType=function(a){this.showGroupType=!!a};b.subfieldById=function(a){var b,c;if(a)if(Array.isArray(a))for(c=0;c<a.length&&!(b=this.subfieldById(a[c]));c++);else for(c=0;c<this.subfields.length;c++){var d=this.subfields[c];if(d.fieldId==a){b=d;break}}return b};b.subfieldByRange=function(a){var b;if(this.subfields)for(var c in this.subfields){var d=this.subfields[c];
if("custom"==c)for(var e=0;e<d.length&&!(b=d[e].subfieldByRange(a));e++);else b=d.subfieldByRange(a);if(b)break}b||this.range&&Fc(this.range,a)&&(b=this);return b};b.toTagName=function(a,b){var c=g(this.container,a);if(this.labelElem){var d=g(this.labelElem,b);d.transferFrom(this.labelElem);c.append(d);this.labelElem=d}this.valueElem&&(d=g(this.valueElem,b),d.transferFrom(this.valueElem),c.append(d),this.valueElem=d);(d=this.container.parent())&&d.insert(c,this.container);this.container.destroy();
this.container=c};b.containerWidth=function(){return this.container.offsetWidth};b.addContainerClass=function(a){this.container.addClass(a)};b.prepForMainHeader=function(){this.addedToHeader||(this.addedToHeader=!0,this.parseEmailAddresses(),this.buildFieldValue())};b.appendAsRow=function(a){this.prepForMainHeader();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(x.create("td","oit-email-pad")));a.append(this.container)};b.appendAsDiv=function(a){this.prepForMainHeader();
"DIV"!==this.container.tagName&&this.toTagName("div","div");a.append(this.container)};b.insertAsDiv=function(a,b){this.prepForMainHeader();"DIV"!==this.container.tagName&&this.toTagName("div","div");a.insert(this.container,b)};b.appendToExtra=function(a){this.addedToHeader=!0;this.buildFieldValue();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(x.create("td","oit-email-pad")));a.append(this.container)};b.parseEmailAddresses=function(){this.addresses||(this.isCompound()?
(this.addresses=[],d(this,this.addresses),0===this.addresses.length&&delete this.addresses):this.fieldDef.value&&-1!=c.indexOf(this.fieldId)&&this.parseStandardEmailAddresses())};b.parseStandardEmailAddresses=function(){if(this.range){var a=x.create("div");a.html(this.fieldDef.value);for(var b,c=a.createTreeWalker(),d=c.firstACCNode(),a=[],e;d;){d=c.currentNode;if(1===d.nodeType)(d=x.data(d,"acc"))&&(b="none"===d?void 0:Number(d));else if(3===d.nodeType&&0<d.nodeValue.length&&void 0!==b){var g=b+
d.nodeValue.length;e&&e.accend!=b&&(e=null);e?e.accend=g:(e={text:d.nodeValue,acc:b,accend:g},a.push(e));b+=d.nodeValue.length}d=c.nextACCNode()}for(c=b=0;c<a.length;c++){e=a[c];d=e.text;e=e.acc;var g=[],k=d.toUpperCase(),n=(d.match(/@/g)||[]).length,v=(k.match(/CN=/g)||[]).length,k=(k.match(/((\[([^\[\]])*\/CN([^\[\]])*\])+)/g)||[]).length,n=0===v?n+k:0===k?n+v:n+Math.min(v,k);if(0===n)d=g;else{var w=u(d,/((?:[^;"']|"[^"]*"|'[^']*')+)/g,n),v=u(d,/((?:[^;"]|"[^"]*")+)/g,n),k=u(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,
n),n=u(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,n);if(!w||v.diff<w.diff)w=v;if(!w||k.diff<w.diff)w=k;if(!w||n.diff<w.diff)w=n;if(w){if(n=w.list)for(var z=0,v=0;v<n.length;v++){k=n[v];z=d.indexOf(k,z);if(-1==z)break;var w=e+z,z=z+k.length,A=null,f=null,h=-1,B=-1,y=k.lastIndexOf("<"),E=k.lastIndexOf(">"),F=k.lastIndexOf("["),Q=k.lastIndexOf("]"),P=void 0,N=void 0;0<=y&&E>y?(P=y,N=E):0<=F&&Q>F&&(P=F,N=Q);void 0!==P&&N+1<k.length&&(P=void 0);void 0!==P?(A=k.substring(0,P),h=w,f=k.substring(P+1,N),B=w+P+1):
(E=k.toUpperCase(),y=E.indexOf("CN="),0<y&&"/"!==E.charAt(y-1)&&(y=-1),0<=y?(f=k,B=w,A=k.indexOf("/",y),-1==A&&(A=k.length),A=k.substring(y+3,A),h=w+y+3):-1!=k.indexOf("@")?(f=k,B=w):(A=k,h=w));A=r(A,h);f=r(f,B);A||(A=f,f=null);(A||f)&&g.push({name:A,address:f})}d=g}else d=void 0}d&&0<d.length&&(b++,this.addresses=this.addresses?this.addresses.concat(d):d)}b!=a.length&&delete this.addresses}};b.markAddedToHeader=function(a){this.addedToHeader=!0;if(a&&this.subfields)for(var b=0;b<this.subfields.length;b++)this.subfields[b].markAddedToHeader(a)};
var d=function(a,b){switch(a.fieldId){case "ORGANIZER":case "ATTENDEE":var c=a.subfieldById("DISPLAYAS"),e=a.subfieldById("EMAIL")||a.subfieldById("ORGANIZER");if(c&&c.fieldDef&&c.fieldDef.value&&c.fieldDef.range&&e&&e.fieldDef&&e.fieldDef.value&&e.fieldDef.range){var g=x.create("div");g.html(c.fieldDef.value);var k=g.text();g.html(e.fieldDef.value);g=g.text();k=r(k,c.fieldDef.range.acc);g=r(g,e.fieldDef.range.acc);k&&g&&(b.push({name:k,address:g}),a.markAddedToHeader(!0))}break;case "ATTENDEES":for(c=
0;c<a.subfields.length;c++)d(a.subfields[c],b)}};b.setDisplayField=function(a){if(a&&this.fieldDef.value&&this.range&&a.fieldDef.value&&a.range){var b=x.create("div");b.html(a.fieldDef.value);var c=r(b.text(),a.range.acc);b.html(this.fieldDef.value);b=r(b.text(),this.range.acc);c&&b&&(this.displayField=a,this.displayField.addedToHeader=!0,this.addresses=[{name:c,address:b}])}else delete this.displayField,delete this.addresses};b.hasValue=function(){return"string"==typeof this.fieldDef.imageurl||"string"==
typeof this.fieldDef.value};b.buildFieldValue=function(){var a=this.fieldDef,b;this.container.html("");if(!this.labelElem){var c;a.id&&(c=U["EMAIL_"+a.id])&&(a.label=c);var d=x.create("div","oit-emhdrlabel");b=[];c||("string"==typeof a.label?b.push(a.label):b.push(U.UNKNOWN_FIELD));b.push('<span data-acc="none" class="oit-noacc">');c&&b.push(a.label);this.groupField&&this.showGroupType&&this.groupField.fieldDef.type&&b.push(" (",this.groupField.fieldDef.type,")");a.label&&-1!=a.label.indexOf(U.LABEL_SEPARATOR)||
b.push(U.LABEL_SEPARATOR);b.push("</span>");d.html(b.join(""));this.labelElem=d}if(!this.valueElem){if("string"==typeof a.imageurl)b='<img src="'+a.imageurl+'"/>',this.valueElem=x.create("div","oit-fieldimage"),this.valueElem.html(b);else if(this.addresses){this.valueElem=x.create("div");this.valueElem.html(a.value);b=[];for(c=0;c<this.addresses.length;c++)d=this.addresses[c],b.push('<span class="oit-email-a">'),0<c&&k(", ",b),d.name&&n(d.name.text,d.name.acc,"oit-email-aname",d.address?d.address.text:
null,null,null,b),d.address&&(n(d.address.text,d.address.acc,"oit-email-aaddr",null," [","]",b),this.hasEmailAddresses=!0),b.push("</span>");this.valueElem.html(b.join(""));this.valueElem.removeData("acc")}else"string"==typeof a.value&&(this.valueElem=x.create("div"),this.valueElem.html(a.value));if(this.valueElem&&(this.valueElem.addClass("oit-emhdrvalue"),a.id&&(a=a.id,this.groupField&&(a=this.groupField.fieldDef.id+"/"+a),this.valueElem.attr("data-fieldid",a)),this.valueElem.hasClass("oit-noacc"))){var e;
this.valueElem.hasClass("oit-datetime-field")?e=Jb(this.valueElem.text()):this.valueElem.hasClass("oit-date-field")?e=uc(this.valueElem.text()):this.valueElem.hasClass("oit-time-field")&&(e=vc(this.valueElem.text()));e&&this.valueElem.text(e)}}this.labelElem&&this.container.append(this.labelElem);this.valueElem&&this.container.append(this.valueElem)};var g=function(a,b){var c=x.create(b);c.addClass(a.attr("class"));var d=a.attr("data-acc");d&&c.attr("data-acc",d);(d=a.attr("data-fieldid"))&&c.attr("data-fieldid",
d);return c},k=function(a,b){b.push('<span class="oit-noacc" data-acc="none">',a,"</span>")},n=function(a,b,c,d,e,g,n){a=zb(a);d=zb(d);n.push("<span");d&&n.push(' title="',d,'"');0>b&&(c=c?c+" oit-noacc":"oit-noacc");c&&n.push(' class="',c,'"');e||g?(n.push(">"),e&&(0>b?n.push(e):k(e,n)),n.push("<span",' data-acc="'),0<b?n.push(b):n.push("none"),n.push('">',a,"</span>"),g&&(0>b?n.push(g):k(g,n))):(n.push(' data-acc="'),0<b?n.push(b):n.push("none"),n.push('">',a));n.push("</span>")},r=function(a,b){if(a){for(var c=
0;c<a.length&&/\s/.test(a[c]);c++)b++;a=a.trim();if(2<=a.length){var c=a.charAt(0),d=a.charAt(a.length-1);'"'!=c&&"'"!=c||c!=d||(b++,a=a.substring(1,a.length-1),(c=r(a,b))?(a=c.text,b=c.acc):a=null)}}return a?{text:a,acc:b}:null},u=function(a,b,c){if(a=a.match(b)){for(b=0;b<a.length;b++);b=0;if(a)for(var d=0;d<a.length;d++)(0<a[d].indexOf("@")||0<=a[d].indexOf("CN="))&&b++;if(0<b)return{list:a,count:b,diff:Math.abs(b-c)}}};return a}(),vd=function(){var c=function(){V.call(this,"div","oit-scrollpane");
this.addClass("oit-scrollpanebar");this.html('<div class="oit-scrollpanecontent"></div><div class="oit-scrollbar"><div></div></div><div class="oit-scrollpaneup oit-fade"></div><div class="oit-scrollpanedn oit-fade"></div><div class="oit-scrollpaneup oit-ellip">&#x2022; &#x2022; &#x2022;</div><div class="oit-scrollpanedn oit-ellip">&#x2022; &#x2022; &#x2022;</div>');this.prop("scrollbar",this.childByClass("oit-scrollbar"),!1,!0);this.prop("scrollthumb",this.scrollbar.firstChildElem(),!1,!0);this.prop("scrollup",
this.byClass("oit-scrollpaneup"),!1,!0);this.prop("scrolldown",this.byClass("oit-scrollpanedn"),!1,!0);u.isMobileOrTablet&&(this.kinetic(!0),this.onpanstart(this,r),this.onpanmove(this,v));this.scrollbar.onclick(this,b);this.scrollbar.ontap(this,b);this.scrollthumb.ondragstart(this,d);this.scrollthumb.ondragmove(this,g);this.scrollthumb.ondragend(this,k);this.scrollthumb.ondragcancel(this,k);this.scrollthumb.onclick(this,n);this.prop("content",this.childByClass("oit-scrollpanecontent"),!1,!0);this.content.onwheel(this,
a);this.onmouseover(this,function(){this.addClass("oit-hover")});this.onmouseout(this,function(){this.removeClass("oit-hover")});x.attach(this)},e=X(c,V);Object.defineProperties(e,{scrollLeft:{get:function(){return 0},set:function(a){}},scrollTop:{get:function(){return-this.content.offsetTop},set:function(a){this.setScrollTop(a,!0)}},minScroll:{get:function(){return 0}},maxScroll:{get:function(){var a=this.content.outerHeight-this.clientHeight;0>a&&(a=0);return a}},contentHeight:{get:function(){return this.content.outerHeight}},
visibleHeight:{get:function(){return this.clientHeight}},enabled:{get:function(){return this.content.outerHeight>this.clientHeight}}});e.setScrollTop=function(a,b){if("number"===typeof a){var c=this.minScroll,d=this.maxScroll;a<c?a=c:a>d&&(a=d);this.content.offsetTop!=-a?(this.content.offsetTop=-a,!1!==b&&this.update(a),"function"===typeof S.UIEvent?c=new UIEvent("scroll"):(c=W.createEvent("UIEvents"))&&c.initUIEvent&&c.initUIEvent("scroll",!0,!1,S,null,2),c&&this.dispatchCustom("scroll",c)):!1!==
b&&this.update(a);return a}};e.scrollIntoView=function(a){var b;a instanceof V?b=a.rect(this.content):a instanceof ba&&(b=a);b&&(a=this.scrollTop,b.bottom>=a+this.visibleHeight&&(a=b.bottom+11-this.visibleHeight),b.top<=a&&(a=b.top-11),this.scrollTop=a)};e.isVisible=function(a){var b;a instanceof ba?b=a:a instanceof V&&(b=a.rect(this.content));return b?(a=this.scrollTop*w.zoom,b.top<a+this.visibleHeight*w.zoom&&b.bottom>a):!1};e.update=function(a){if(void 0===a)this.setScrollTop(this.scrollTop);else{if(this.scrollbar){var b=
this.content.outerHeight,c=this.clientHeight;c>=b?(this.scrollbar.css("display","none"),this.removeClass("oit-scrollable")):(c=100*c/b,1>c&&(c=1),this.scrollthumb.css({top:100*a/b+"%",height:c+"%"}),this.scrollbar.css("display",null),this.addClass("oit-scrollable"))}if(this.scrollup){b=0<a;c=a<this.maxScroll;for(a=0;a<this.scrollup.length;a++)this.scrollup[a].css("opacity",b?null:0);for(a=0;a<this.scrolldown.length;a++)this.scrolldown[a].css("opacity",c?null:0)}}};var a=function(a){if(!a.ctrlKey&&
this.enabled){var b=a.deltaY;if(1==a.deltaMode||2==a.deltaMode)b*=12;this.scrollTop+=b;return!1}},b=function(a){if(a.offsetY){var b=this.content.outerHeight,c=this.clientHeight,d=this.scrollTop/b;a=a.offsetY/this.clientHeight;a<d?this.scrollTop-=c:a>d+c/b&&(this.scrollTop+=c)}},d=function(a){this.scrollthumb._topPercent=100*this.scrollTop/this.content.outerHeight;this.scrollbar.css("opacity",.1);return!1},g=function(a){var b=this.content.outerHeight,c=100*(b-this.clientHeight)/b;a=this.scrollthumb._topPercent+
100*a.delta.y/this.clientHeight;0>a?a=0:a>c&&(a=c);this.scrollTop=a*b/100;return!1},k=function(a){delete this.scrollthumb._topPercent;this.scrollbar.css("opacity",null);return!1},n=function(a){return!1},r=function(a){return!1},v=function(a){this.scrollTop-=a.delta.y;return!1};e.redirectEvent=function(b){var c=!0;"wheel"==b.type&&(a.call(this,b),c=!1);return c};return c}(),Ob={paragraph:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,
title:"COMMENT"},slide:{requireText:!1,skipIfNoText:!1,showIcon:!0,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},page:{requireText:!1,skipIfNoText:!1,showIcon:!0,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},cell:{requireText:!0,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},add:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,
textCls:"oit-anno-add",badgeCls:null,title:"INSERTED_TEXT"},"delete":{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:null,title:"DELETED_TEXT"},change:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!0,checkRanges:!0,textCls:"oit-anno-change",badgeCls:null,title:"CHANGED_TEXT"},hidden:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:"oit-badge-delete",title:"HIDDEN_TEXT"},
add_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_ROW"},delete_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_ROW"},add_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_COLUMN"},delete_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,
textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_COLUMN"},new_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"NEW_CELL"},modify_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MODIFIED_CELL"},clear_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"CLEAR_CELL"},move_cells:{requireText:!1,
skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MOVED_CELLS"},add_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_SHEET"},rename_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"RENAMED_SHEET"}},pd=function(){var c=/\S/,e="#ffbc2b #9439ae #61b34a #de2f40 #43bee6 #ef5f11 #0078ff".split(" "),
a=['<div class="oit-annoblock"><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable oit-annotitle"> ',U.ANNOTATIONS,'</span><span class="oit-sortselect"><span class="oit-unselectable">',U.SORT_BY,'</span><select name="oit-sort" class="oit-sort"><option value="location">',U.LOCATION,'</option><option value="author">',U.AUTHOR_A_TO_Z,'</option><option value="rauthor">',U.AUTHOR_Z_TO_A,'</option><option value="date">',U.OLDEST_FIRST,'</option><option value="rdate">',
U.NEWEST_FIRST,'</option><option value="type">',U.ANNOTATION_TYPE,"</option></select></span></div></div>"].join(""),b=function(b){V.call(this,"div","oit-annopane");this._page=b;this._annos=[];this._groups=[];this._newGroups=[];this._groupOffsets=[];this._badgeColorIndex=0;this._authorColors={};this._showLeader=!0;this._batches=[];this._needLayout=!0;this.html(a);this._block=this.byClass("oit-annoblock")[0];this._header=this.byClass("oit-annoheader")[0];this._title=this.byClass("oit-annotitle")[0];
this._commentIcon=this.byClass("oit-commentsicon")[0];this._sortSpan=this.byClass("oit-sortselect")[0];this._sortSelect=this.byClass("oit-sort")[0];this._scrollPane=new vd;this._block.append(this._scrollPane);this.onclick(z.deactivateAnnotation);this.ontap(z.deactivateAnnotation);this._sortSelect.onchange(this,C);this._scrollPane.onscroll(this,aa);ka.onresize(this,aa);E.onzoom(this,aa);this._isHidden=!0;this.css("display","none");this.attach()},d=X(b,V);d.destroy=function(){this._scrollPane.offscroll(this,
aa);E.offzoom(this,aa);ka.offresize(this,aa);E.offidle(this,q);E.offidle(this,S);for(var a=0;a<this._newGroups.length;a++)this._newGroups[a].groupDiv.destroy();V.prototype.destroy.call(this)};d.update=function(){this.isHidden()||this._resizeTimer||(aa.call(this),this.layout(),this.scrollPane().update())};var g=function(a){var b=100;0<a._batches.length?b=0:0<a._newGroups.length&&(b=a._groups.length/(a._newGroups.length+a._groups.length),b=Math.floor(100*b));100<=b?a._title.text(U.ANNOTATIONS):a._title.text(U.LOADING+
" ("+b+"%)")};d.isLoading=function(){return 0<this._batches.length||0<this._newGroups.length};d.isEmpty=function(){return 0===this._annos.length&&0===this._batches.length&&0===this._newGroups.length};d.toolbarMode=function(a){!0===a?this._toolbarMode=!0:delete this._toolbarMode};d.attach=function(){if(!this.parent()){var a=this._page;if(a.supportsAnnotationPane()){var b=a.parent();b&&(a.nextSiblingElem()?b.insert(this,a.nextSiblingElem()):b.append(this))}}};d.range=function(){return this._range};
var k=function(a,b){var c=!1;if(a)if(Array.isArray(a))for(var d=0;d<a.length&&!(c=k(a[d],b));d++);else a.range&&(c=gb(a.range,b));return c},n=function(a,b){var c=a.anno;return k(c.text,b)||k(c.oldtext,b)||k(c.last_save_date||c.create_date||c.date,b)||k(c.author,b)},r=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)r(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=ia.getRawText(a.range.acc,a.range.accend))},v=function(a,b,c,d){var e=null,f;if("string"===typeof b)e=x.create("p"),
c.append(e),f=x.create("span"),e.append(f),t(a,b,f);else if(Array.isArray(b))for(var g=!0,h=0;h<b.length;h++){var k=b[h];k.range&&d&&(g=a._page.containsRange(k.range));g&&(e||(e=x.create("p"),c.append(e)),r(k),k.text?(f=x.create("span"),e.append(f),t(a,k,f)):e=null)}},t=function(a,b,c){b&&("string"===typeof b?(c.attr("data-acc","none"),c.addClass("oit-noacc"),c.text(b)):b.text&&(b.range&&b.range.acc?(c.attr("data-acc",b.range.acc),a._range?(b.range.acc<a._range.acc&&(a._range.acc=b.range.acc),b.range.accend>
a._range.accend&&(a._range.accend=b.range.accend)):a._range=ga(b.range)):(c.attr("data-acc","none"),c.addClass("oit-noacc")),c.text(b.text),b.b&&c.css("font-weight","bold"),b.i&&c.css("font-style","italic")))},q=function(){if(0<this._batches.length){var a=this._batches.shift();if(a&&0<a.length){for(var b=this._page,d=b.overlay?b.overlay.layer("comments"):void 0,f,k=0;k<a.length;k++){var l=a[k],m=Ob[l.type],n=!!m;if(m&&m.skipIfNoText){var r=l,u=!1;if(r.text)for(f=0;f<r.text.length;f++){var w=r.text[f];
if(w.text&&c.test(w.text)){u=!0;break}}u||(n=!1)}if(n&&l.range){r=n=null;if(l.parentid)for(u=0;u<this._annos.length;u++)if(f=this._annos[u],f.anno.id==l.parentid){n=f;r=f.groupInfo;break}r||(r={groupDiv:x.create("div","oit-annogroup"),annos:[]},this._newGroups.push(r));u=x.create("div","oit-anno");u.attr("id","oita"+l.id);f=x.create("div","oit-anno-text");if(w=m.title)switch(w=U[w],l.type){case "add_row":w+=" "+Ya(l.range.r1);break;case "delete_row":w+=" "+Ya(l.range.r1);break;case "add_col":w+=" "+
Ma(l.range.c1);break;case "delete_col":w+=" "+Ma(l.range.c1);break;case "cell":w+=" "+sb(l.range);break;case "new_cell":w+=" "+sb(l.range);break;case "modify_cell":w+=" "+sb(l.range);break;case "clear_cell":w+=" "+sb(l.range);break;case "move_cells":w+=" "+sb(l.oldrange)+" to "+sb(l.range)}if(l.oldtext){if(m.showFromTo){var z=x.create("div","oit-anno-change-sep oit-noacc");z.attr("data-acc","none");z.text(U.ANNO_CHANGE_FROM);f.append(z)}v(this,l.oldtext,f,m.checkRanges);m.showFromTo&&(z=x.create("div",
"oit-anno-change-sep oit-noacc"),z.attr("data-acc","none"),z.text(U.ANNO_CHANGE_TO),f.append(z))}if(l.text)v(this,l.text,f,m.checkRanges);else if(m.requireText){z=x.create("p","oit-noacc oit-unsupportedcontent");z.attr("data-acc","none");var A=x.create("span");A.text(U.UNSUPPORTED_CONTENT);z.append(A);f.append(z)}z=x.create("div","oit-anno-meta");if(A=l.last_save_date||l.create_date||l.date){var C=null;"string"===typeof A?C=Jb(A):A.text&&(C=Jb(A.text));if(C){var G=x.create("span","oit-anno-date");
C===A.text?t(this,A,G):(G.text(C),G.addClass("oit-noacc"),G.attr("data-acc","none"));z.append(G)}}C="";A=null;l.author&&(C=x.create("span","oit-anno-author"),t(this,l.author,C),z.append(C),C=C.text().trim(),0<C.length&&(A=this._authorColors[C],A||(this._authorColors[C]=A=e[this._badgeColorIndex++],this._badgeColorIndex>=e.length&&(this._badgeColorIndex=0)),C=C.charAt(0).toUpperCase()));if(w){G=x.create("div","oit-anno-type oit-noacc");G.attr("data-acc","none");if(C){var F=x.create("div","oit-badge");
A&&F.css("background",A);F.text(C);G.append(F)}F=x.create("span");F.text(w);G.append(F);u.append(G)}u.append(f,z);r.groupDiv.append(u);f={anno:l,annoDiv:u,groupInfo:r};r.annos.push(f);u.onclick(this,h,f);u.ontap(this,h,f);"text"===l.range.type?(f.spans=Fb(b,l.range,m.textCls,l.id,"page"),n||(f.badge=new jd(b.index,d,m.badgeCls,C),A&&f.badge.css("background",A),f.badge.onclick(this,B,f),f.badge.ontap(this,B,f),f.badge.onmouseover(this,y,f),f.badge.onmouseout(this,L,f),f.badge.hide())):m.showIcon&&
(n?(f.parent=n,f.icon=n.icon,n.icon.removeClass("oit-commenticon"),n.icon.addClass("oit-commenticonmulti"),n.icon.resetDefaultSize(),l=n.icon.defaultSize(),n.icon.move(void 0,void 0,l.width,l.height)):(l=new id(b.index,d,"oit-commenticon"),r.groupDiv.data("commenticon",l),l.data("comment",r.groupDiv),l.onclick(this,B,f),l.ontap(this,B,f),l.onmouseover(this,y,f),l.onmouseout(this,L,f),f.icon=l,l.hide()));f.index=this._annos.length;this._annos.push(f)}}W(this)}P(this,!0);this.update()}0===this._batches.length&&
(E.offidle(this,q),this._processingBatches=!1,this.layout(),this._processBatchCallbackFn&&(this._processBatchCallbackFn(this,this._processBatchCallbackArg),delete this._processBatchCallbackFn,delete this._processBatchCallbackArg));g(this)};d.processAnnotations=function(a,b,c){if(a){if(500>=a.length)this._batches.push(a);else for(var d=0;d<a.length;d+=500){var e=d+500;e>a.length&&(e=a.length);e=a.slice(d,e);this._batches.push(e)}this._processingBatches||(this._processingBatches=!0,b&&(this._processBatchCallbackFn=
b,this._processBatchCallbackArg=c),E.onidle(this,q),q.call(this));g(this)}};d.show=function(){this.attach();if(this.parent()){this._isHidden=!1;this.css("display",null);for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&("slide"!==b.anno.type&&b!==this._activeAnno||b.icon.show());b.badge&&b.badge.show();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.onclick(this,B,b);d.ontap(this,B,b);d.onmouseover(this,y,b);d.onmouseout(this,L,b)}}W(this);P(this);
this.update()}};d.hide=function(){this._isHidden=!0;this.css("display","none");for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&b.icon.hide();b.badge&&b.badge.hide();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.offclick(this,B);d.offtap(this,B);d.offmouseover(this,y);d.offmouseout(this,L)}}A(this)};d.isHidden=function(){return!!this._isHidden};d.panelRect=function(a){return z.elementRect(this._scrollPane,a)};d.contentRect=function(a){return z.elementRect(this._scrollPane.content,
a)};d.getSpanMap=function(){this._spanMap||(this._spanMap=new Mc(this._page,this._scrollPane.content));return this._spanMap};d.scrollPane=function(){return this._scrollPane};d.findACC=function(a){var b=this.getSpanMap();if(b)return b.findACC(a)};d.findRange=function(a,b){var c=this.getSpanMap();if(c)return c.findRange(a,b)};d.mapPointToSpan=function(a,b,c){var d=this.getSpanMap();if(d)return d.mapPointToSpan(a,b,c)};d.containsRange=function(a){var b=!1;"text"===a.type&&this._range&&a.acc<=this._range.accend&&
a.accend>=this._range.acc&&(a.acc===a.accend?b=!!this.findACC(a.acc):(a=this.findRange(a.acc,a.accend),void 0!==a&&0<a.length&&(b=!0)));return b};d.annoRect=function(a,b,c){var d=null,e;c||(c=a.anno.annoRange||a.anno.range);if(a.spans||a.anno.embeds){if(a.spans)for(var f=0;f<a.spans.length;f++)(e=a.spans[f].textRect(c))&&(d?b?e.bottom>d.bottom?d=e:e.bottom==d.bottom&&d.union(e):d.union(e):d=e);if(a.anno.embeds)for(b=0;b<a.anno.embeds.length;b++)(e=this._page.embeddingRect(a.anno.embeds[b].uid))&&
(d?d.union(e):d=e)}else if(a.icon)(e=a.icon.isHidden())&&a.icon.show(),d=new ba(a.icon.rect(u.viewNode),"view"),e&&a.icon.hide();else if("cell"===c.type)switch(a.anno.type){case "add_sheet":case "rename_sheet":d=z.overlayTabRect(this._page.overlay);break;case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":d=F.rangeRect(c,"view");break;default:d=F.expandRange(c),d=F.rangeRect(d,"view")}else d=F.rangeRect(c,"view",
!1,"page"),d||"text"!==c.type||(a=this._page.frameForRange(c))&&(a=a.firstChildElem())&&"DIV"===a.tagName&&(d=a.rect(u.viewNode),d=new ba(d,"view"),d.width=0,d.height=0);return d};d.annoTextHeight=function(a,b){var c=0;if(a.spans){for(var d,e=0;e<a.spans.length;e++){var f=a.spans[e].textRect(a.anno.range);f&&(!d||f.bottom>d.bottom?d=f:f.bottom==d.bottom&&d.union(f))}d&&(d.origin=b,c=d.height)}return c};var m=function(a,b){var c=a.annos[0],d=b.annos[0],c=Na(c.anno.annoRange||c.anno.range,d.anno.annoRange||
d.anno.range);0===c&&(c=K(a,b));return c},l=function(a,b){return-m(a,b)},K=function(a,b){var c=a.annos[0].anno,d=b.annos[0].anno,c=c.last_save_date||c.create_date||c.date,d=d.last_save_date||d.create_date||d.date;c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=a.annos[0].index-b.annos[0].index);return e},M=function(a,b){return-K(a,b)},I=function(a,b){var c=a.annos[0].anno.author,d=b.annos[0].anno.author;c&&c.text&&
(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=K(a,b));return e},H=function(a,b){return-I(a,b)},O=function(a,b){var c=a.annos[0].anno.type,d=b.annos[0].anno.type,e=Ob[c],f=Ob[d];e&&e.title&&(c=U[e.title]);f&&f.title&&(d=U[f.title]);e=0;c&&d&&(e=c.localeCompare(d));0===e&&(e=m(a,b));return e},C=function(){var a=x.unwrap(this._sortSelect),a=a.item(a.selectedIndex);w.annotationSort=a?a.value:"index"};d.applySort=function(a){var b=
w.annotationSort;if(!this.isLoading()&&(a||b!==this._sort)){this._sort=b;switch(b){case "date":a=K;break;case "rdate":a=M;break;case "rlocation":a=l;break;case "author":a=I;break;case "rauthor":a=H;break;case "type":a=O;break;default:a=m}this._groups.sort(a);for(a=this._groups.length-1;0<=a;a--)this._groups[a].groupDiv.detach();for(a=0;a<this._groups.length;a++)this._scrollPane.content.append(this._groups[a].groupDiv);x.unwrap(this._sortSelect).value=b;delete this._spanMap;this._groupOffsets=[];this.update()}};
var P=function(a,b){if(!a.isHidden())if(a.isLoading()||2>a._annos.length)a._showSort=!1,delete a._headerWidth,a._sortSpan.css("display","none");else{var c=a._header.clientWidth;if(b||!a._headerWidth||a._showSort&&c<a._headerWidth||!a._showSort&&c>a._headerWidth){a._sortSpan.css("display",null);var c=a._sortSpan.pos(a._header),d=a._commentIcon.rect(a._header),e=!0;c.top>=d.bottom&&(e=!1);e||a._sortSpan.css("display","none");a._showSort=e}}};d.onResize=function(a){var b=this._header.clientWidth;if(!0===
a||b!=this._headerWidth){this._headerWidth=b;if(this._resizeTimer)ta(this._resizeTimer);else for(a=0;a<this._groups.length;a++)b=this._groups[a],b.visible&&b.groupDiv.css("height",null);this._resizeTimer=da(function(){this._groupOffsets=[];for(var a=0;a<this._groups.length;a++){var b=this._groups[a];b.height&&(b.groupDiv.css("height",null),delete b.height)}this._spanMap&&this._spanMap.discardLayout();P(this);delete this._resizeTimer;this.update()},100,this)}};d.layout=function(){var a=this._page,
b=a.pageRect("overlay");if(!a.parent()||!this.parent()||this.isHidden())this.css("display","none");else if(this&&b){delete this._needLayout;var c,d,e=w.zoom;this._toolbarMode?this.css({top:null,left:null,height:null,display:null}):(this.css({top:b.top/e+"px",left:b.right/e+"px",height:b.height/e+"px",display:null}),150>b.height?(this._header.css("display","none"),this._scrollPane.css("top","0")):(this._header.css("display",null),this._scrollPane.css("top",null)));this._scrollPane.update();a.pagePos("overlay");
for(e=0;e<this._annos.length;e++){var f=this._annos[e];if(f.badge){var g=this.annoRect(f,!1);if(g){g.origin="overlay";c=b.left+5;d=(g.top+g.bottom)/2-10;var g=b.bottom-20-5,h;do{if(d>g)break;for(var k=h=0;k<e;k++)if(k!=e&&this._annos[k].badge){var l=this._annos[k].badge.position(),m=l.bottom- -2;d>l.top-l.height+-2&&d<m&&(d=m,h++)}}while(h&&20>=h);d>g||20<h?(f.badge.destroy(),delete f.badge):(f.badge.show(),f.badge.move(c,d))}else f.badge.hide()}if(f.icon&&!f.parent){if(f.anno.range)switch(f.anno.range.type){case "rect":c=
f.anno.range.left;d=f.anno.range.top;break;case "text":if(g=F.rangeRect(f.anno.range,a))c=g.left,d=g.top,f.icon.css("opacity",.3)}else c=f.anno.x,d=f.anno.y;void 0!==c&&void 0!==d&&(g=new ba(c,d,c+20,d+20,a),0>g.left?g.left=0:g.right>a.width&&(g.right=a.width),0>g.top?g.top=0:g.bottom>a.height&&(g.bottom=a.height),g.origin="overlay",f.icon.move(g.left,g.top),this._isHidden||"slide"!==f.anno.type&&f!==this._activeAnno||f.icon.show())}}}};var A=function(a){a._hasUpdateListener||(ka.onupdate(a,f),a._hasUpdateListener=
!0);ka.invalidateCanvas()};d.showLeader=function(a){!1!==a&&(a=!0);a!==this._showLeader&&(this._showLeader=!1!==a,ka.invalidateCanvas())};var f=function(a){if(!this._isHidden&&w.showAnnotations&&this._activeAnno){var b=this._activeAnno;if(b&&this._showLeader){var c;if(b.anno.oldrange&&"cell"===b.anno.oldrange.type){var d=T.cellSelection(),e=b.anno.annoRange||b.anno.range,f=b.anno.oldrange;d&&!gb(d,e)&&gb(d,f)&&(c=f)}if(d=this.annoRect(b,!0,c)){e=u.rootNode;f=u.viewNode;c=f.rect(e);d.origin="view";
d.offset(c.left,c.top);var g=d.left,h=d.top,k=d.right,l=d.bottom;0>g&&0<k&&(g=0);k>f.clientWidth&&g<f.clientWidth&&(k=f.clientWidth);0>h&&0<l&&(h=0);l>f.clientHeight&&h<f.clientHeight&&(l=f.clientHeight);d.move(g,h,k,l);k=b.annoDiv.rect(e);0===k.height&&(k=b.groupInfo.groupDiv.rect(e));F.padding();var m=10;b.spans&&(m=.7*this.annoTextHeight(b,"view"),10>m?m=10:40<m&&(m=40));var n,q,r;n="cell"===b.anno.range.type;q="add_sheet"===b.anno.type||"rename_sheet"===b.anno.type;var h=!1,l=!0,t=k.top+20,v=
k.bottom-20,f=k.left,g=t,b=f-10;if(n)h=!0,q?(m=(d.right+d.left)/2,n=d.top,q=m,r=n-10,l=!1):(m=d.right+2,n=d.top+d.height/2,q=m+10,q>b&&(q=m),r=n);else{var x=d.top-m;r=d.bottom+m;m=(d.right+d.left)/2;n=d.bottom;q=m;var y=this._page.pageRect("view").clone();y.offset(c.left,c.top);if(r>=y.bottom||g<n&&x>y.top)n=d.top,r=x;g=r>v?v:r<t?t:r}e=this._scrollPane.rect(e);g<e.top?g=e.top:g>e.bottom&&(g=e.bottom);d=!0;g<k.top?(g=e.bottom,d=!1):g>k.bottom&&(g=e.top,d=!1);l&&q>=b&&(q=m,r=n,b=f);if(m<f||!l)a.save(),
e=u.rootNode.rect(),e=e.right-e.left-c.left,a.beginPath(),a.rect(c.left,c.top,e,c.bottom-c.top),a.clip(),a.beginPath(),h&&a.arc(m,n,2,0,2*Math.PI,!0),a.moveTo(m,n),a.lineTo(q,r),a.lineTo(b,g),d&&a.lineTo(f,g),a.strokeStyle="rgba(255,255,255,0.1)",a.lineWidth=9,a.stroke(),a.strokeStyle="rgba(255,255,255,0.3)",a.lineWidth=7,a.stroke(),a.strokeStyle="rgba(255,255,255,0.5)",a.lineWidth=5,a.stroke(),a.strokeStyle="rgba(0,0,0,0.25)",a.lineWidth=3,a.stroke(),a.restore()}}}};d.deactivate=function(a,b){this.activate(null,
!1,!1,a,b)};d.activate=function(a,b,c,d,e){var f=this;if(f._activating)d&&d(e);else if(f._annos){!1!==b&&(b=!0);var g,h,k;if(a)if(h=xa(a))for(k=0;k<f._annos.length;k++){if(n(f._annos[k],h)){g=f._annos[k];break}}else if(a.anno&&a.groupInfo.groupDiv)g=a;else if(a.id)for(k=0;k<f._annos.length;k++)if(f._annos[k].anno===a){g=f._annos[k];break}if(g)z.deactivateAnnotation(),f._activating=g,w.showAnnotations||(w.showAnnotations=!0),z.movetoEx(this._page.index,{animate:!0,callbackFn:function(){z.scrollToAnnotationPane(function(){f._activeAnno=
g;z.activeAnnotationPane(f);if(g.spans||g.anno.embeds){if(g.spans)for(var a=0;a<g.spans.length;a++)g.spans[a].addClass("oit-active")}else g.icon&&(g.icon.show(),g.icon.activate());A(f);g.annoDiv.addClass("oit-active");if(b){var k;h&&(k=f.getSpanMap().findRange(h.acc,h.accend));if(k){for(var l,a=0;a<k.length;a++){var m=k[a].textRect(h);m&&(l?l.union(m):l=m)}l&&(l.origin=f._scrollPane.content,l.scale(1/w.zoom),f._scrollPane.scrollIntoView(l))}else f._scrollPane.scrollIntoView(g.groupInfo.groupDiv),
f._scrollPane.scrollIntoView(g.annoDiv)}if(k=g.anno.annoRange||g.anno.range)if(F.moveto(k),c&&"cell"===k.type&&"add_sheet"!==g.anno.type&&"rename_sheet"!=g.anno.type){k=(l=T.cellSelection())&&g.anno.oldrange&&!gb(l,k)&&gb(l,g.anno.oldrange)?ga(g.anno.oldrange):ga(k);switch(g.anno.type){case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":k.autoExpand=!1}Q.pauseAutoHighlight(!0);T.select(k);Q.pauseAutoHighlight(!1)}d&&
d(e);delete f._activating})}});else{a=f._activeAnno;f._activeAnno=null;if(a){if(a.spans||a.anno.embeds){if(a.spans)for(k=0;k<a.spans.length;k++)a.spans[k].removeClass("oit-active")}else a.icon&&(a.icon.deactivate(),"slide"!==a.anno.type&&a.icon.hide());A(f);a.annoDiv.removeClass("oit-active");z.activeAnnotationPane(null);a=null}d&&d(e)}}};var h=function(a,b){this.activate(b,!1,!0);return!1},B=function(a,b){if(0===x.selectedText().length)return Q.deactivate(),T.reset(),this.activate(b,!0,!0),!1},y=
function(a,b){b.groupInfo.groupDiv.addClass("oit-hover")},L=function(a,b){b.groupInfo.groupDiv.removeClass("oit-hover")},S=function(){if(!this.isHidden()&&!this._needLayout){for(var a=0;30>a;a++){var b=this._newGroups.shift();if(!b)break;this._scrollPane.content.append(b.groupDiv);this._groups.push(b)}this._scrollPane.update();g(this);aa.call(this);0===this._newGroups.length&&(this._processingGroups=!1,E.offidle(this,S),P(this,!0),this.applySort(!0),Q.each("addToPage",null,this._page.index,!0))}},
W=function(a){!a._processingGroups&&0<a._newGroups.length&&!a.isHidden()&&(a._processingGroups=!0,a._addGroupInterval=E.onidle(a,S),g(a),S.call(a))},aa=function(){if(!this._isHidden){var a,b,c;c=-1;for(a=0;a<this._groups.length;a++)if(b=this._groups[a],!b.height&&(-1==c&&(c=a),!b.visible)){b.visible=!0;for(var d=0;d<b.annos.length;d++)b.annos[d].annoDiv.css("display",null)}d=0;if(-1!=c){var e=w.zoom;for(a=c;a<this._groups.length;a++)b=this._groups[a],void 0===b.height&&(c=b.groupDiv.rect(this._scrollPane.content),
this._groupOffsets[a]=c.top,d++,0<c.height&&(b.height=this._toolbarMode?c.height-1:c.height/e-1,b.groupDiv.css("height",b.height+"px")))}if(d<this._groups.length)for(a=0;a<this._groups.length;a++)void 0===this._groupOffsets[a]&&(b=this._groups[a],c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top);this._groupOffsets[this._groups.length]=this._scrollPane.content.outerHeight;c=this.clientHeight;d=this._scrollPane.scrollTop;this._toolbarMode||(c*=w.zoom,d*=w.zoom);for(a=0;a<this._groups.length;a++)if(b=
this._groups[a],e=this._groupOffsets[a]-d,e=0<this._groupOffsets[a+1]-d&&e<c,e!=b.visible)for(var e=(b.visible=e)?null:"none",f=0;f<b.annos.length;f++)b.annos[f].annoDiv.css("display",e);A(this)}};return b}(),$c=function(){return function(){var c='<div><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable"> '+U.ANNOTATIONS+"</span></div></div>",e,a,b;this.show=function(){if(e&&b){var a=w.annoBarWidth;0<a?e.show({size:a}):e.show();b.show()}};this.hide=function(){e&&
(b&&b.hide(),e.hide())};this.destroy=function(){ya.offresizeinternal(this,g);z.offchange(this,d);w.offshowAnnotations(this,d);w.offannoBarWidth(this,d);e&&ya.removeInternal(-3);a&&a.destroy();a=e=null};var d=function(){var c=z.activePage(),c=c?c.annotationPane():null;c!==b&&(b&&(b.css("width",null),b.hide(),z.activeAnnotationPane(null),a.remove(b),b.toolbarMode(!1),b=null),b=c)&&(z.activeAnnotationPane(b),a.append(b),b.toolbarMode(!0),b.scrollPane().setScrollTop(0,!0));c=w.annoBarWidth;0>=c&&(c=void 0);
e.applySize(c,void 0,!0);b&&w.showAnnotations?this.show():this.hide()},g=function(c,d,e,g,t){-3===c&&a&&b&&(0<e&&(w.annoBarWidth=e,e+="px",a.css("width",e),b.css("width",e)),b.showLeader(!t),b.onResize(),ka.invalidateCanvas())};a=x.create("div","oit-annobar");e=new Pb(-3,"right",a,null,ya.internalParent(-3));e.resizable(!0,60,30,c);ya.addInternal(-3,e);ya.onresizeinternal(this,g);z.onchange(this,d);w.onshowAnnotations(this,d);w.onannoBarWidth(this,d);d.call(this)}}(),Dc=function(){var c,e=function(){if(c){var a=
u.viewNode,a=a.offsetHeight-a.clientHeight;0===a?c.css("bottom",null):c.css("bottom",a+"px")}};ka.onresize(e);E.onzoom(e);var a=function(a){a=a||{};V.call(this,"div","oit-toast");a.className&&this.addClass(a.className);var b=[];a.collapseButton&&b.push('<input class="oit-collapsebutton" type="button" value="&#x25bc;">');a.closeButton&&b.push('<input class="oit-closebutton" type="button" value="x">');b.push('<div class="oit-title"></div><div class="oit-body"></div>');this.html(b.join(""));a.collapseButton&&
(this.prop("collapseButton",this.childByClass("oit-collapsebutton")),this.collapseButton.onclick(this,v),this.collapseButton.ontap(this,v));a.closeButton&&(this.prop("closeButton",this.childByClass("oit-closebutton")),this.closeButton.onclick(this,q),this.closeButton.ontap(this,q));this.prop("titletext",this.childByClass("oit-title"));this.prop("messagetext",this.childByClass("oit-body"));this._collapsed=!0;this.onclick(this,t);this.ontap(this,t);this.onmouseenter(this,g);this.onmouseleave(this,k);
x.attach(this);c||(c=x.create("div","oit-toastpane"),u.viewNode.parent().append(c),e());b=c.firstChildElem();a.collapseButton||!b?c.append(this):c.insert(this,b);a.title&&this.title(a.title);a.content&&this.message(a.content)},b=X(a,V);b.customEvent("expand");b.customEvent("collapse");var d=function(a){a._collapsed?a._colSize&&a.css({width:a._colSize.width+"px",height:a._colSize.height+"px"}):a._expSize&&a.css({width:a._expSize.width+"px",height:a._expSize.height+"px"})};b.title=function(a){if(void 0!==
a){this.titletext.html(a);a=this.attr("class");var b=this.css("display");this.attr("class","oit-toast");this.css("display",null);this.css({width:null,height:null});this._colSize={width:this.innerWidth,height:this.innerHeight};d(this);this.attr("class",a);this.css("display",b)}return this.titletext.html()};b.message=function(a){if(void 0!==a){this.messagetext.html(a);a=this.attr("class");var b=this.css("display");this.attr("class","oit-toast oit-expanded");this.css("display",null);this.css({width:null,
height:null});this._expSize={width:this.innerWidth,height:this.innerHeight};d(this);this.attr("class",a);this.css("display",b)}return this.messagetext.html()};b.isCollapsed=function(){return this._collapsed};b.hide=function(a){this._hidden||this._pendingHidden?a&&a():(this._pendingHidden=!0,this._hideCallback=a)};b.hideNow=function(){this._hidden=!0;this._pendingHidden=!1;this.animate({opacity:0,time:300,endCSS:{display:"none"},endFn:this._hideCallback})};b.show=function(){if(this._hidden||this._pendingHidden)this._pendingHidden=
this._hidden=!1,this.css("display",null),delete this._hideCallback};var g=function(){this._mouse=!0},k=function(){this._mouse=!1;this._pendingHidden&&this.hideNow()},n=function(){this.offtransitionend(n);this._tto&&(ta(this._tto),delete this._tto);this.removeClass("oit-collapsing");this.dispatchCustom("collapse",{});fb()};b.collapse=function(a){if(this._collapsed)return!1;this._tto&&ta(this._tto);this._collapsed=!0;!1===a?(this.removeClass("oit-expanded"),d(this),this.dispatchCustom("collapse",{})):
(this.addClass("oit-collapsing"),this.removeClass("oit-expanded"),this.ontransitionend(n),da(function(){d(this)},0,this),this._tto=da(function(){delete this._tto;n.call(this)},400,this));fb();return!0};var r=function(){this.offtransitionend(r);this._tto&&(ta(this._tto),delete this._tto);this.addClass("oit-expanded");this.removeClass("oit-expanding");this.dispatchCustom("expand",{});fb()};b.expand=function(a){if(!this._collapsed)return!1;this._tto&&ta(this._tto);this._collapsed=!1;!1===a?(this.addClass("oit-expanded"),
d(this),this.dispatchCustom("expand",{})):(this.addClass("oit-expanding"),this.ontransitionend(r),d(this),this._tto=da(function(){delete this._tto;r.call(this)},400,this));fb();return!0};var v=function(a){if(this.collapse())return!1},t=function(a){if(this.expand())return!1},q=function(a){this.hideNow()};E.onreset(function(){c&&(c.destroy(),c=null)});return a}();u.libversion="2018.5.0.424";(function(c){Xa.install.dispatch();Xa.install.reset();S.addEventListener("load",function(){Xa.init.dispatch();
Xa.init.reset()})})(!1)})(window,document);
//# sourceURL=oit.js 
