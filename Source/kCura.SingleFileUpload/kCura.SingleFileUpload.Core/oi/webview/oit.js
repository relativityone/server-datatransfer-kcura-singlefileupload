/*
 oit.js 
 Portions (C) 1991, 2016, Oracle Corp, and (C) 2017, Relativity ODA LLC. 
 Version 2018.6.1.6 
*/
(function(R,V){var Tb,Ub;if(R.OIT){var ka=R.OIT.view;ka&&(ka.detach?ka.detach():ka.unload&&ka.unload())}R.OIT=function(){var c={};Object.defineProperties(c,{uninstall:{value:function(){jc&&jc(this)},writable:!0}});return c}();var W=function(c,e){e||(e=Qc);return c.prototype=Object.create(e.prototype)},jc=function(){if(R.OIT){var c=R.OIT.view;c&&c.detach();R.OIT=void 0}},hb=function(c,e,a){Object.defineProperty(OIT,c,{value:e,writable:!!a})},y=function(){var c=/^[.#\w][-_\.\w\d]*$/,e=("oit"+Math.random()).replace(/\W/g,
""),a=[],b=1,d=function(a){if(c.test(a)){if(0===a.lastIndexOf("#",0))return d.byId(a.slice(1));if(0===a.lastIndexOf(".",0))return d.byClass(a.slice(1));if(0===a.indexOf(" "))return d.byTagName(a)}return d.bySelector(a)};Object.defineProperties(d,{html:{get:function(){return d.wrap(V.documentElement)}},body:{get:function(){return d.wrap(V.body)}},head:{get:function(){return d.wrap(d.html.childByTagName("head"))}},expando:{value:e}});d.byId=function(a){return d.wrap(V.getElementById(a))};d.byClass=
function(a){return d.wrap(V.getElementsByClassName(a))};d.byTagName=function(a){return d.wrap(V.getElementsByTagName(a))};d.bySelector=function(a){return d.wrap(V.querySelectorAll(a))};d.attach=function(a){(a=d.wrap(a))&&a.data("_elem",a);return a};d.detach=function(a){a&&d.removeData(a,"_elem")};d.query=function(a){return d.data(a,"_elem")};d.isElement=function(a){return a&&(a.dom||1===a.nodeType)};d.isText=function(a){return a&&3===a.nodeType};d.isDescendantOf=function(a,b){a=d.unwrap(a);if(b=d.unwrap(b))for(;a&&
a.parentNode;){if(a.parentNode===b)return!0;a=a.parentNode}return!1};d.nodeIndex=function(a){a=d.unwrap(a);for(var b=0;;){a=a.previousSibling;if(!a)break;++b}return b};d.unwrap=function(a){a&&a.dom&&(a=a.dom);return a};d.wrap=function(a){if(a){var b;if(!d.isElement(a)&&0<=a.length&&("function"===typeof a.item?b=[]:Array.isArray(a)&&(b=a),b)){for(var c=0;c<a.length;c++)b[c]=d.wrap(a[c]);0===b.length&&(b=null);return b}if(a.tagName&&!a.dom)return(b=d.query(a))||(b=new U(a)),b}return a};d.acceptsData=
function(a){return a&&(1===a.nodeType||9===a.nodeType)};d.data=function(c,g,k){c=d.unwrap(c);if(d.acceptsData(c)&&g){var u=c[e];if(void 0!==k){if(!u){do u=b++;while(void 0!==a[u]);Object.defineProperty(c,e,{value:u})}a[u]||(a[u]={});a[u].domNode=d.nodeToString(c);return a[u][g]=k}var n;u&&(k=a[u])&&(n=k[g]);void 0===n&&c.getAttribute&&(n=c.getAttribute("data-"+g),null===n&&(n=void 0));return n}};d.destroyData=function(c){c=d.unwrap(c);d.acceptsData(c)&&(c=c[e])&&(a[c]=void 0,c<b&&(b=c))};d.removeData=
function(b,c){b=d.unwrap(b);if(d.acceptsData(b)){var g=b[e];if(g)if(c){if(g=a[g]){delete g[c];var u;a:{for(u in g)if(Object.prototype.hasOwnProperty.call(g,u)){u=!0;break a}u=!1}u||d.removeData(b)}}else a[g]=void 0}b&&b.removeAttribute&&b.removeAttribute("data-"+c)};d.removeSubtreeData=function(a){d.removeData(a);for(a=a.firstElementChild;a;a=a.nextElementSibling)d.removeSubtreeData(a)};d.reset=function(){var c,e;for(e in a){var g=a[e];g&&(d.logUnreleasedData&&d.logUnreleasedData(g),c||(c=[]),c[e]=
g)}c?a=c:(a=[],b=1)};d.hasClass=function(a,b){if(Array.isArray(b)){for(var c=0;c<b.length;c++)if(d.hasClass(a,b[c]))return!0;return!1}if(a=d.unwrap(a)){if(a.classList)return a.classList.contains(b);if(a.getAttribute&&(c=a.getAttribute("class")))return c=" "+c+" ",b=" "+b.trim()+" ",-1!=c.indexOf(b)}return!1};var g=function(a,b){if(a.classList)a.classList.add(b);else if(a.getAttribute&&!d.hasClass(a,b)){var c=a.getAttribute("class");a.setAttribute("class",c+(" "+b))}};d.addClass=function(a,b){if((a=
d.unwrap(a))&&b){var c;if(Array.isArray(b))for(c=0;c<b.length;c++)g(a,b[c]);else if(-1!=b.indexOf(" "))for(b=b.split(" "),c=0;c<b.length;c++)g(a,b[c]);else g(a,b)}};var k=function(a,b){if(a.classList)a.classList.remove(b);else if(a.getAttribute){var d=a.getAttribute("class").replace(b,"");a.setAttribute("class",d)}};d.removeClass=function(a,b){if((a=d.unwrap(a))&&b){var c;if(Array.isArray(b))for(c=0;c<b.length;c++)k(a,b[c]);else if(-1!=b.indexOf(" "))for(b=b.split(" "),c=0;c<b.length;c++)k(a,b[c]);
else k(a,b)}};d.create=function(a,b,d,c){return new U(a,b,d,c)};d.createText=function(a){return V.createTextNode(a)};d.listen=function(){return V.addEventListener.apply(V,arguments)};d.unlisten=function(){return V.removeEventListener.apply(V,arguments)};d.cursor=function(a){void 0!==a&&(V.body.style.cursor=a);return V.body.style.cursor};d.clearSelection=function(){R.focus();if(R.getSelection){var a=R.getSelection();null!==a&&a.removeAllRanges()}};d.selectRange=function(a,b,d,c){R.focus();if(R.getSelection){var e;
Ra(a)?e=a:(e=V.createRange(),e.setStart(a,b),e.setEnd(d,c));a=R.getSelection();a.removeAllRanges();a.addRange(e)}};d.selectedText=function(){var a;if(R.getSelection){var b=R.getSelection();b&&(a=b.toString())}else V.selection&&"Control"!=V.selection.type&&(a=V.selection.createRange().text);a||(a="");return a};d.nodeToString=function(a){if((a=d.unwrap(a))&&1===a.nodeType){var b=[];b.push("<",a.tagName.toLowerCase());if(a.classList)for(var c=0;c<a.classList.length;c++)b.push(".",a.classList[c]);a.id&&
b.push("#",a.id);b.push(">");return b.join("")}};return d}(),Qc=function(){var c=function(){},e=c.prototype;e.prop=function(a,b,d,c){"string"===typeof a&&void 0!==b&&Object.defineProperty(this,a,{value:b,writable:!!d})};e.deleteAll=function(){for(var a in this)this.hasOwnProperty(a)&&delete this[a]};e.invalidArg=function(a,b,d,c){var e="",e=b?e+("Invalid value specified for argument '"+b+"'"):e+"Invalid argument";d&&(e+=": '"+vb(d)+"'");c&&(e+=", "+c);this.logError(a,e)};e.logError=function(a,b){var d;
this.publicName&&a&&(d=this.publicName+"."+a+": ");b&&(d=(d?d+": ":"")+String(b));d&&0<d.length&&E.on.error.dispatch(d,!1)&&console.error(d)};e.logFatalError=function(a,b,d,c){var e;this.publicName&&a&&(e=this.publicName+"."+a+": ");b&&(e=(e?e+": ":"")+String(b));d&&(e=(e?e+" ":"")+String(d));e&&0<e.length&&E.on.error.dispatch(e,!0)&&("warn"!==c&&(c="error"),console[c](e),ka.unload(),ka.showDocumentError(b))};e.logAJAXError=function(a,b,d,c,e){c===kc?b+=" (Request aborted)":c===Vb?b+=" (Request timed out)":
void 0!==c&&(b=b+" (HTTP Status "+c+")");c=[];d&&c.push(" [",d,"]");void 0!==e&&c.push(" responseText='",e,"'");this.logFatalError(a,b,c.join(""))};return c}(),U=function(){var c=[];c[0]=c[23]="right";c[5]=c[6]="up";c[11]=c[12]="left";c[17]=c[18]="down";for(var e=function(a){void 0===a&&(a="div");if("string"==typeof a){var b=this.dom=V.createElement(a),d=1;if(d<arguments.length){var c;"string"==typeof arguments[d]?c=arguments[d++]:Array.isArray(arguments[d])&&(c=arguments[d++].join(" "));c&&c.length&&
b.setAttribute("class",c)}d<arguments.length&&"string"==typeof arguments[d]&&(b.id=arguments[d++]);d<arguments.length&&(b=y.wrap(arguments[d++]))&&y.isElement(b)&&b.append(this)}else y.isElement(a)&&(this.dom=y.unwrap(a))},a=W(e),b="clientLeft clientTop clientWidth clientHeight offsetWidth offsetHeight scrollWidth scrollHeight parentNode tagName classList".split(" "),d=function(b){Object.defineProperty(a,b,{get:function(){return this.dom[b]}})},g=0;g<b.length;g++)d(b[g]);Object.defineProperties(a,
{id:{get:function(){return this.dom.id},set:function(a){this.dom.id=a}},opacity:{get:function(){return Number(this.computedStyleProp("opacity"))},set:function(a){this.dom.style.opacity=a}},offsetLeft:{get:function(){return this.dom.offsetLeft},set:function(a){this.dom.style.left=M(a)+"px"}},offsetTop:{get:function(){return this.dom.offsetTop},set:function(a){this.dom.style.top=M(a)+"px"}},scrollLeft:{get:function(){return this.dom.scrollLeft},set:function(a){this.dom.scrollLeft=M(a)}},scrollTop:{get:function(){return this.dom.scrollTop},
set:function(a){this.dom.scrollTop=M(a)}},innerWidth:{get:function(){var a=this.computedStyleProp("width");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientWidth},set:function(a){this.dom.style.width=M(a)+"px"}},innerHeight:{get:function(){var a=this.computedStyleProp("height");return-1!=a.indexOf("px")?parseFloat(a):this.dom.clientHeight},set:function(a){this.dom.style.height=M(a)+"px"}},outerWidth:{get:function(){var a=this.dom.offsetWidth,b=R.getComputedStyle(this.dom);b.marginLeft&&b.marginRight&&
(a+=parseFloat(b.marginLeft)+parseFloat(b.marginRight));return a}},outerHeight:{get:function(){var a=this.dom.offsetHeight,b=R.getComputedStyle(this.dom);b.marginTop&&b.marginBottom&&(a+=parseFloat(b.marginTop)+parseFloat(b.marginBottom));return a}}});a.focus=function(){this.dom.focus()};a.blur=function(){this.dom.blur()};a.toString=function(){return y.nodeToString(this)};a.parent=function(){if(this.dom)return y.wrap(this.dom.parentNode)};a.firstChildElem=function(){if(this.dom)return y.wrap(this.dom.firstElementChild)};
a.nextSiblingElem=function(){if(this.dom)return y.wrap(this.dom.nextElementSibling)};a.detach=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom)}};a.destroy=function(){if(this.dom){var a=this.dom.parentNode;a&&a.removeChild(this.dom);this.destroyChildren();y.destroyData(this.dom);this.deleteAll()}};var k=function(a){for(var b=a.firstElementChild;b;b=a){a=b.nextElementSibling;k(b);var d=y.query(b);d?d.destroy():y.removeData(b)}};a.destroyChildren=function(){k(this.dom)};a.equals=
function(a){return this.dom==y.unwrap(a)};a.html=function(a){void 0!==a&&(this.destroyChildren(),this.dom.innerHTML=a);return this.dom.innerHTML};a.text=function(a){void 0!==a&&(this.destroyChildren(),this.dom.textContent=a);return this.dom.textContent};a.data=function(a,b){return y.data(this.dom,a,b)};a.ancestorData=function(a){for(var b,d=this.dom,c=y.unwrap(w.rootNode);d;){b=y.data(d,a);if(void 0!==b)break;if(d==c)break;d=d.parentNode}return b};a.removeData=function(a){y.removeData(this.dom,a)};
a.hasClass=function(a){return y.hasClass(this.dom,a)};a.addClass=function(a){y.addClass(this.dom,a);return this};a.removeClass=function(a){y.removeClass(this.dom,a);return this};a.attr=function(a,b){var d;if(Array.isArray(a)){for(var c={},f=0;f<a.length;f++)d=a[f],c[d]=this.dom.getAttribute(d);return c}if(void 0===b){if("string"===typeof a)return this.dom.getAttribute(a);for(d in a)a.hasOwnProperty(d)&&this.dom.setAttribute(d,a[d])}else null===b?this.dom.removeAttribute(a):this.dom.setAttribute(a,
b);return this};a.css=function(a,b){var d=this.dom;if(d){var d=d.style,c;try{if(Array.isArray(a)){for(var f={},e=0;e<a.length;e++)c=a[e],f[c]=d.getPropertyValue(Za[c]||c);return f}if(void 0===b)if("string"===typeof a){if(-1==a.indexOf(":"))return d.getPropertyValue(Za[a]||a);(f=ib(a))&&this.css(f)}else for(c in a)a.hasOwnProperty(c)&&(e=a[c],null===e||void 0===e?d.removeProperty(Za[c]||c):d.setProperty(Za[c]||c,e,""));else null===b?d.removeProperty(Za[a]||a):d.setProperty(Za[a]||a,b,"")}catch(wa){}}return this};
a.removeCSS=function(a){var b=this.dom;if(Array.isArray(a))for(var d=0;d<a.length;d++)b.style.removeProperty(a[d]);else if("string"===typeof a)b.style.removeProperty(a);else for(d in a)a.hasOwnProperty(d)&&b.style.removeProperty(d);return this};a.resetStyle=function(){return this.attr("style",null)};a.computedStyle=function(){return R.getComputedStyle(this.dom)};a.computedStyleProp=function(a){return this.computedStyle().getPropertyValue(a)};a.show=function(){this._hidden&&(this.css("display",null),
delete this._hidden);return this};a.hide=function(){this._hidden||(this.css("display","none"),this._hidden=!0);return this};a.isHidden=function(){return this._hidden};a.autoscroll=function(a,b){var d=this.dom;switch(arguments.length){case 0:return{left:d.scrollLeft,top:d.scrollTop};case 1:return this.autoscroll(a.left,a.top);case 2:void 0!==a&&(d.scrollLeft=a),void 0!==b&&(d.scrollTop=b)}return this};a.scroll=function(a,b){void 0===a&&void 0===b||this.cancelKinetic();return this.autoscroll.apply(this,
arguments)};a.dscroll=function(a,b){this.cancelKinetic();a&&(this.scrollLeft+=a);b&&(this.scrollTop+=b);return this};a.animate=function(a){a&&(this.finishAnimation(),this.dom&&new Rc(this,a));return this};a.finishAnimation=function(){var a=this.data("_animation");a&&a.finish();return this};a.abortAnimation=function(){var a=this.data("_animation");a&&a.abort();return this};a.append=function(){if(this.dom)for(var a=arguments,b=0;b<a.length;b++){var d=a[b];Array.isArray(d)?this.append.apply(this,d):
this.dom.appendChild(y.unwrap(d))}return this};a.insert=function(a,b){this.dom&&this.dom.insertBefore(y.unwrap(a),y.unwrap(b));return this};a.insertAfter=function(a,b){this.dom&&(a=y.unwrap(a),b=y.unwrap(b),b=b.nextSibling,this.dom.insertBefore(a,b));return this};a.insertFirst=function(a){this.dom&&this.dom.insertBefore(y.unwrap(a),this.dom.firstChild);return this};a.remove=function(a){this.dom&&this.dom.removeChild(y.unwrap(a));return this};a.clone=function(a){return this.dom?this.dom.cloneNode(!!a):
null};a.transferFrom=function(a){a=y.unwrap(a);if(this.dom&&a)for(;0<a.childNodes.length;)this.dom.appendChild(a.childNodes[0]);return this};a.forElementAndAncestors=function(a){for(var b=this,d=y.unwrap(w.rootNode);b&&!1!==a(b)&&b!=d;)b=b.parent();return this};a.forChildElements=function(a){return m.call(this,a,!1,arguments)};a.queryChildElements=function(a){return m.call(this,a,!0,arguments)};var m=function(a,b,d){for(var c=[null,-1],f=1;f<d.length;f++)c.push(d[f]);d=0;for(var e=this.dom.firstElementChild;e;e=
f,d++)if(f=e.nextElementSibling,e=!0===b?y.query(e):y.wrap(e))if(c[0]=e,c[1]=d,!1===a.apply(null,c))break;return this};a.pos=function(a){var b=this.dom;a=y.unwrap(a);if(a==b)return{left:0,top:0};for(;b&&!b.getBoundingClientRect;)b=b.parentNode;if(b)return b=b.getBoundingClientRect(),b={left:b.left,top:b.top},a&&a!==V.body&&(a=a.getBoundingClientRect(),b.left-=a.left,b.top-=a.top),b};a.size=function(){for(var a=this.dom;a&&!a.getBoundingClientRect;)a=a.parentNode;if(a)return a=a.getBoundingClientRect(),
{width:a.width,height:a.height}};a.rect=function(a){a=y.unwrap(a);for(var b=this.dom;b&&!b.getBoundingClientRect;)b=b.parentNode;if(b){var d=b.getBoundingClientRect(),d={left:d.left,top:d.top,right:d.right,bottom:d.bottom,width:d.width,height:d.height};a&&a!==V.body&&(a==b?(d.right-=d.left,d.bottom-=d.top,d.left=0,d.top=0):(a=a.getBoundingClientRect(),d.left-=a.left,d.top-=a.top,d.right-=a.left,d.bottom-=a.top));return d}};a.inRect=function(a,b){var d=this.dom;return d&&0<=a&&0<=b&&a<=d.clientWidth&&
b<=d.clientHeight};a.ancestorByClass=function(a){for(var b=this.parent(),d=w.rootNode;b&&b.hasClass;){if(b.hasClass(a))return b;if(b.equals(d))break;b=b.parent()}return null};a.childByTagName=function(a){a=a.toUpperCase();for(var b=this.dom.firstElementChild;b;b=b.nextElementSibling)if(b.tagName.toUpperCase()===a)return y.wrap(b);return null};a.childrenByTagName=function(a){var b=null;a=a.toUpperCase();for(var d=this.dom.firstElementChild;d;d=d.nextElementSibling)d.tagName.toUpperCase()===a&&(b||
(b=[]),b.push(y.wrap(d)));return b};a.childByClass=function(a){if(this)for(var b=this.firstChildElem();b;b=b.nextSiblingElem())if(b.hasClass(a))return b;return null};a.byClass=function(a){return y.wrap(this.dom.getElementsByClassName(a))};a.byId=function(a){for(var b=[y.unwrap(this.dom)];0<b.length;)for(var d=b.shift().firstElementChild;d;d=d.nextElementSibling){if(d.id===a)return y.wrap(d);b.push(d)}return null};a.byTag=function(a){a=a.toUpperCase();for(var b=[y.unwrap(this.dom)],d=[];0<b.length;)for(var c=
b.shift().firstElementChild;c;c=c.nextElementSibling)c.tagName.toUpperCase()===a?d.push(y.wrap(c)):b.push(c);if(d.length)return d};a.isDescendantOf=function(a){return y.isDescendantOf(this.dom,a)};a.mousePos=function(a){a||(a=R.event);for(var b={x:0,y:0},d=this.dom;d;d=d.offsetParent)b.x+=d.offsetLeft,b.y+=d.offsetTop;if(a.pageX||a.pageY)b.x=a.pageX-b.x,b.y=a.pageY-b.y;else if(a.clientX||a.clientY)b.x=a.clientX+V.body.scrollLeft+V.documentElement.scrollLeft-b.x,b.y=a.clientY+V.body.scrollTop+V.documentElement.scrollTop-
b.y;return b};a.touchPos=function(a){if(a){var b={identifier:a.identifier,x:0,y:0};if(a.center&&a.target){var d=y.wrap(a.target).pos(this);b.x=a.center.x+d.left;b.y=a.center.y+d.top}else{for(d=this.dom;d;d=d.offsetParent)b.x+=d.offsetLeft,b.y+=d.offsetTop;b.x=a.pageX-b.x;b.y=a.pageY-b.y}return b}};a.select=function(){R.focus();if(R.getSelection){var a=V.createRange();a.selectNodeContents(this.dom);y.selectRange(a)}else V.selection&&V.body.createTextRange&&(a=V.body.createTextRange(),a.moveToElementText(this.dom),
a.select())};var r=function(a){for(var b=!0;b;){var d=a.currentNode;if(1===d.nodeType)if("svg"===d.nodeName)b=a.skipNode();else if(d=y.data(d,"acc"),void 0!==d)if("none"===d)b=a.skipNode();else break;else break;else if(3===d.nodeType)break;else b=a.nextNode()}return b},t=function(){for(var a;!(a=this.nextSibling())&&this.parentNode(););return a},u=function(a){for(;this.currentNode!==a&&this.nextNode(););return this.currentNode===a},n=function(){return r(this)},q=function(){var a=this.nextNode();a&&
(a=r(this));return a};a.createTreeWalker=function(a,b,d){void 0===a&&(a=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);void 0===b&&(b=null);void 0===d&&(d=!1);a=V.createTreeWalker(this.dom,a,b,d);a.skipNode=t;a.skipToNode=u;a.firstACCNode=n;a.nextACCNode=q;return a};a.createCanvas=function(){return new lc(this)};a.on=function(a,b,d){void 0===d&&(d=b,b=void 0);if("function"!==typeof d)this.invalidArg("on"+a,"listener",d,"Must be a function");else{var c=Array.prototype.slice.call(arguments,2);c[0]=null;
b=b||this;var f,e=this.dom;f=a;var p=y.data(e,"_events");p||(p={},y.data(e,"_events",p));(e=p[f])||(e=p[f]=[]);f=e;for(p=0;p<f.length;p++)if(e=f[p],e.fn===d){e.ref=b;e.args=c;d=null;break}d&&(f.push({fn:d,ref:b,args:c}),1==f.length&&(c=this._events[a])&&c.add&&c.add(this,a))}return this};a.off=function(a,b,d){void 0===d&&(d=b);if("function"===typeof d&&(b=l(this.dom,a))){for(var c=0;c<b.length;c++)if(b[c].fn===d){b.splice(c,1);break}0===b.length&&(d=this._events[a])&&d.remove&&d.remove(this,a)}return this};
for(var l=function(a,b){var d=y.data(a,"_events");if(d&&(d=d[b])&&0<d.length)return d},I=function(a,b,d){a["on"+b]=function(a,d){1==arguments.length&&(d=a,a=null);if(2<arguments.length){for(var c=[b,a,d],f=2;f<arguments.length;f++)c.push(arguments[f]);return this.on.apply(this,c)}return this.on(b,a,d)};a["off"+b]=function(a,d){return this.off(b,a,d)};a._events||(a._events={});a._events[b]=d},L=function(a){var b=l(a.currentTarget,a.type);if(b){for(var d=!0,c=0;c<b.length;c++){var f=b[c];f.args[0]=
a;!1===f.fn.apply(f.ref,f.args)&&(d=!1);f.args[0]=null}d||jb(a)}},b="mouseover mouseout mouseenter mouseleave mousedown mousemove mouseup wheel touchstart touchmove touchend touchcancel click dblclick contextmenu keydown keyup keypress blur focus scroll change transitionend".split(" "),d={add:function(a,b){a.dom.addEventListener(b,L)},remove:function(a,b){a.dom.removeEventListener(b,L)}},g=0;g<b.length;g++)I(a,b[g],d);for(var b="tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
K=function(a){return"dragstart"===a||"dragmove"===a||"dragend"===a||"dragcancel"===a},H=function(a,b){var d=a.data("_gestures");!d&&b&&(d={listenerCount:0},a.data("_gestures",d));return d},d={add:function(a,b){var d=H(a,!0);d.touches||(d.touches=[],a.ontouchstart(v));d.listenerCount++;K(b)&&(d.dragCount||(d.dragCount=0,a.onmousedown(ba)),d.dragCount++)},remove:function(a,b){var d=H(a);d&&(d.listenerCount--,0===d.listenerCount&&(a.removeData("_gestures"),a.offtouchstart(v)),K(b)&&0<d.dragCount&&(d.dragCount--,
d.dragCount||a.offmousedown(ba)))}},g=0;g<b.length;g++)I(a,b[g],d);var N={add:function(a,b){},remove:function(a,b){}};a.customEvent=function(a){I(this,a,N)};a.dispatchCustom=function(a,b){var d=!0,c=l(this.dom,a);if(c)for(var f=0;f<c.length;f++){var e=c[f];e.args[0]=b;!1===e.fn.apply(e.ref,e.args)&&(d=!1);d&&b.defaultPrevented&&b.defaultPrevented()&&(d=!1);e.args[0]=null}return d};var C=function(a,b,d,f,e){for(var p=!0;a&&a.dom&&!l(a.dom,b);)a=a.parent();a&&!a.dom&&(a=null);if(a&&a.dom){var p=d.start,
D=d.current,q=p.center,g=D.center,I=d.delta;I||(I=d.delta={x:0,y:0});I.x=g.x-q.x;I.y=g.y-q.y;if(I.x||I.y)d.moved=!0;var n=d.moved||!1,u=d.press?!!d.press.started:!1,ja=M(Wb(q.x,q.y,g.x,g.y)),h=q.x,k=q.y,Y=g.x,B=g.y,h=M(h==Y&&k==B?0:Math.atan2(k-B,Y-h),100),oa;0<ja&&(oa=c[Math.floor((12*h/Math.PI+24)%24)]);k=1;Y=0;d.touches&&1<d.touches.length&&(0<p.distance&&(k=D.distance/p.distance),Y=Yb(D.angle-p.angle));d={type:b,srcEvent:f,target:a.dom,distance:ja,angle:h,scale:k,rotation:Y,start:q,center:g,delta:I,
direction:oa,moved:n,press:u,kinetic:!!e};R.OILogGesture&&R.OILogGesture(b,a,d);p=a.dispatchCustom(b,d);for(a=a.parent();p&&a&&a.dom;a=a.parent())l(a.dom,b)&&(p=a.dispatchCustom(b,d))}return p},Q=function(a,b,d){b.press&&(b.press.started=!0,C(a,"press",b,d))},A=function(a,b,d){b.press&&(b.press.started&&C(a,"pressup",b,d),b.press.timer&&ta(b.press.timer),delete b.press)},f=function(a,b,d,c,e,p){a=d.kinetic;var l=!1,D;if(a){d.start=e;d.current=p;var q=Date.now()-a.frameTime,q=Math.exp(-q/325),g;a.ax&&
(D=-a.ax*q,.5>Math.abs(D)&&(D=0),d.current.center.x=e.center.x+a.tx+D);a.ay&&(g=-a.ay*q,.5>Math.abs(g)&&(g=0),d.current.center.y=e.center.y+a.ty+g);if(D||g)D=d.dragCount?"dragmove":"panmove",C(b,D,d,c,!0),l=!0,a.anim=pb(f,null,b,d,c,e,p)}l||(D=d.dragCount?"dragend":"panend",C(b,D,d,c,!0),delete d.kinetic,delete d.start,delete d.current)},h=function(a,b,d){b.pan&&(C(a,"pancancel",b,d),delete b.pan)},B=function(a){if(a){var b=Date.now();if(1==a.length){var d=a[0];a={x:M(d.x),y:M(d.y)};return{distance:0,
angle:0,center:a,time:b}}if(2<=a.length){for(var c=0,f,e=a.length-1,p=0;p<e;p++)for(var l=a[p],D=p+1;D<a.length;D++){var q=a[D],q=Wb(l.x,l.y,q.x,q.y);q>c&&(c=q,f=l,d=a[D])}a:{if(a){var g,I;if(1==a.length){e=a[0];a={x:e.x,y:e.y};break a}if(2==a.length){e=a[0];g=a[1];a={x:(e.x+g.x)/2,y:(e.y+g.y)/2};break a}if(2<a.length){e={x:0,y:0};p=0;l=a.length-1;for(D=0;D<a.length;D++){g=a[D];I=D<l?a[D+1]:a[0];q=g.x;g=g.y;var n=I.x;I=I.y;var u=q*I-n*g,p=p+u;e.x+=(q+n)*u;e.y+=(g+I)*u}p*=3;e.x/=p;e.y/=p;a=e;break a}}a=
void 0}a.x=M(a.x);a.y=M(a.y);c=M(c);e=f.x;f=f.y;p=d.x;d=d.y;return{distance:c,angle:M(e==p&&f==d?0:Math.atan2(f-d,p-e),100),center:a,time:b}}}};a.kinetic=function(a){!0===a?H(this,!0).enableKinetic=!0:!1===a&&(a=H(this))&&delete a.enableKinetic};a.cancelKinetic=function(){var a=H(this);a&&a.kinetic&&(a.kinetic.anim&&Zb(a.kinetic.anim),delete a.kinetic)};var v=function(a){var b=H(this);if(b){this.cancelKinetic();var d=b.touches,c=a.changedTouches,f=w.viewNode,e=null;b.dragCount||(e=this.pos(f));for(var p=
0;p<c.length;p++){var l=f.touchPos(c[p]);e&&(l.x-=e.left,l.y-=e.top);l.ox=l.x;l.oy=l.y;d.push(l)}b.current=B(b.touches);b.start=b.current;1==d.length?(delete b.tap,b.tap={time:b.current.time},A(this,b,a),a=da(Q,500,null,this,b,a),b.press={timer:a}):1<d.length&&!b.pinch&&(delete b.tap,A(this,b,a),h(this,b,a),delete b.distance,b.pinch||(b.pinch={},C(this,"pinchstart",b,a)));Va.setTouchCapture(J,ca,X,this);return!1}},J=function(a){var b=H(this);if(b){for(var d=b.touches,c,f=a.changedTouches,e=b.dragCount?
w.viewNode:this,p=0;p<f.length;p++)for(var l=e.touchPos(f[p]),D=0;D<d.length;D++)if(c=d[D],c.identifier===l.identifier){c.x=l.x;c.y=l.y;c.dx=l.x-c.ox;c.dy=l.y-c.oy;break}c=b.current;f=B(b.touches);if(f.distance!==c.distance||f.angle!==c.angle||f.center.x!==c.center.x||f.center.y!==c.center.y)if(b.previous=c,b.current=f,1!=d.length||b.multi)1<d.length&&(b.multi=!0,b.pinch&&(d=b.previous,c=b.current,f=b.start,0<f.distance&&(e=M(d.distance/f.distance,100),M(c.distance/f.distance,100)!=e&&C(this,"pinchmove",
b,a)),c.angle!=d.angle&&(b.rotate||(b.rotate={start:b.start.angle},C(this,"rotatestart",b,a)),C(this,"rotatemove",b,a))));else if(c=d[0],d=b.distance=Wb(c.dx,c.dy,0,0),c=f.time-b.start.time,10<d&&50<c&&(delete b.tap,b.press&&b.press.started||A(this,b,a),b.pan||(h(this,b,a),b.pan={startTime:b.current.time},b.enableKinetic&&!b.press&&(b.kinetic={vx:0,vy:0,frameTime:b.current.time,frameX:0,frameY:0}),C(this,b.dragCount?"dragstart":"panstart",b,a)),b.pan&&(C(this,b.dragCount?"dragmove":"panmove",b,a),
a=b.kinetic)))d=b.current.time,c=d-a.frameTime,f=b.delta,b.pan.moveTime=d,b=f.y-a.frameY,a.vx=1E3*(f.x-a.frameX)/(c+1)*.8+.2*a.vx,a.vy=1E3*b/(c+1)*.8+.2*a.vy,a.frameTime=d,a.frameX=f.x,a.frameY=f.y;return!1}},ca=function(a){ma(this,a,!1)},X=function(a){ma(this,a,!0)},ma=function(a,b,d){var c=H(a);if(c){var e=c.touches,p=e.length-b.changedTouches.length;try{if(1==e.length)if(d)delete c.tap,A(a,c,b),h(a,c,b);else{if(c.pan){var l=Date.now(),D=l-c.pan.startTime;d=!1;var q,g=c.kinetic;g&&(150<l-c.pan.moveTime&&
(g.vx=0,g.vy=0),10<Math.abs(g.vx)&&(g.ax=.8*g.vx,g.tx=Math.round(c.delta.x+g.ax)),10<Math.abs(g.vy)&&(g.ay=.8*g.vy,g.ty=Math.round(c.delta.y+g.ay)),g.ax||g.ay?(g.frameTime=l,g.anim=pb(f,null,a,c,b,c.start,c.current),d=!0):delete c.kinetic);d||(q=c.dragCount?"dragend":"panend",C(a,q,c,b));if(!(c.dragCount||c.press&&c.press.started)&&1E3>D){var I=c.touches[0],n=Math.abs(I.dx),u=Math.abs(I.dy);60<=n&&60>u?q=0>I.dx?"swiperight":"swipeleft":60<=u&&60>n&&(q=0>I.dy?"swipeup":"swipedown");q&&C(a,q,c,b)}delete c.pan}A(a,
c,b);c.tap&&(200>Date.now()-c.tap.time&&C(a,"tap",c,b),delete c.tap)}else 1<e.length&&1>=p&&(d?(c.rotate&&(C(a,"rotatecancel",c,b),delete c.rotate),c.pinch&&(C(a,"pinchcancel",c,b),delete c.pinch)):(c.rotate&&(C(a,"rotateend",c,b),delete c.rotate),c.pinch&&(C(a,"pinchend",c,b),delete c.pinch)))}catch(kb){E.logError(null,kb)}a=b.changedTouches;for(b=0;b<a.length;b++)for(l=a[b],D=0;D<e.length;D++)if(e[D].identifier===l.identifier){e.splice(D,1);break}delete c.distance;0===e.length&&(delete c.start,
delete c.current,delete c.previous,delete c.multi,Va.releaseTouchCapture());return!1}},O=function(a){a=w.viewNode.mousePos(a);return{distance:0,angle:0,center:{x:a.x,y:a.y}}},ba=function(a){if(0===(a.button||0)){var b=O(a),d=H(this,!0);d.start=b;d.current=b;if(!C(this,"dragstart",d,a))return Va.setMouseCapture(p,D,this),!1}},p=function(a){var b=O(a),d=H(this,!0);if(d&&d.current){var c=d.current.center;if(b.center.x!=c.x||b.center.y!=c.y)d.current=b,C(this,"dragmove",d,a);return!1}},D=function(a){var b=
H(this,!0);C(this,"dragend",b,a);Va.releaseMouseCapture();return!1};return e}(),$b=function(){var c=function(a,b,d){U.call(this,"input",d);this.dom.type="button";"string"===typeof a&&(this.dom.value=a);"string"===typeof b&&(this.dom.title=b)},e=W(c,U);Object.defineProperties(e,{disabled:{get:function(){return this.dom.disabled},set:function(a){this.dom.disabled=a}}});return c}(),mc=function(){var c=function(a,b){U.call(this,"textarea",b);"string"===typeof a&&(this.dom.value=a)},e=W(c,U);Object.defineProperties(e,
{value:{get:function(){return this.dom.value},set:function(a){this.dom.value=a}}});e.moveCaret=function(a){var b=this.dom;b.createTextRange?(b=b.createTextRange(),b.move("character",a),b.select()):void 0!==b.selectionStart?(b.focus(),b.setSelectionRange(a,a)):b.focus()};return c}(),lc=function(){var c=function(a,b){U.call(this,"canvas");2===arguments.length?(this.dom.width=a,this.dom.height=b):1===arguments.length&&(this.dom.width=a.clientWidth,this.dom.height=a.clientHeight,y.wrap(a).append(this))},
e=W(c,U);Object.defineProperties(e,{width:{get:function(){return this.dom.width}},height:{get:function(){return this.dom.height}}});var a=function(a,b,c,e,r,t,u,n){this.globalAlpha=1;void 0!==r&&(this.fillStyle=r);t?(this.strokeStyle=t,this.lineWidth=u||1,this.lineCap="square",this.beginPath(),this.setLineDash(n||[]),this.rect(a,b,c,e),r&&this.fill(),this.stroke(),this.closePath()):(this.lineWidth=0,this.fillRect(a,b,c,e))},b=function(a,b,c,e,r,t,u){void 0!==r&&(this.strokeStyle=r);this.lineWidth=
t||1;this.lineCap="square";this.globalAlpha=1;this.beginPath();this.setLineDash(u||[]);this.moveTo(a,b);this.lineTo(c,e);this.stroke();this.closePath()};e.getContext=function(d){d=this.dom.getContext(d);d.oitrect=a;d.oitline=b;return d};return c}(),Wa=function(){var c=function(c,a){this.prop("list",c);this.prop("name",a)};W(c);return c}(),qb=function(){var c=function(a){this._createFn=a;this._plugins={}},e=W(c);e.item=function(a){return this._plugins[a]};e.items=function(){return this._plugins};e.extend=
function(a,b){if(Array.isArray(a))for(var d=0;d<a.length;d++)this.extend.call(this,a[d],b);else{if("string"===typeof a)return d=this._plugins[a],d||(d=this._createFn.call(this,a))&&(this._plugins[a]=d),d&&d.extend.call(d,b),d;if("object"===typeof a)for(d in a)this.extend.call(this,d,a[d])}};return c}(),w=function(){var c=new qb(function(e){return new nc(c,e)});c.reset=function(c,a){if("string"===typeof c){"boolean"!==typeof a&&(a=!0);var b=this._plugins[c];b&&b.reset(a)}};c.resetAll=function(c){"boolean"!==
typeof c&&(c=!0);for(var a in this._plugins)this._plugins[a].reset(c)};c.defaultVal=function(c){if(c=this._plugins[c])return c.defaultVal()};c.setProperty=function(c,a,b){(c=this._plugins[c])&&c.setProperty(a,b)};return c}(),nc=function(){var c=function(a,b){Wa.call(this,a,b)},e=W(c,Wa);e.extend=function(a){a=a||{};var b={_v:{value:void 0,writable:!0}};a.init&&(b.init={value:a.init});void 0!==a.def&&(b.def={value:a.def});this.list!==w&&(!0===a.pub&&(b.pub={value:a.pub}),a.legal&&(b.legal={value:a.legal}),
a.validate&&(b.validate={value:a.validate}),a.type&&(b.type={value:a.type||"boolean"},"number"===a.type||Array.isArray(a.type)&&-1!=a.type.indexOf("number")))&&("number"===typeof a.min&&(b.min={value:a.min}),"number"===typeof a.max&&(b.max={value:a.max}));Object.defineProperties(this,b);var d=this;this.list["on"+this.name]=function(a,b){return d.listen(a,b)};this.list["off"+this.name]=function(a,b){return d.unlisten(a,b)};Object.defineProperty(this.list,this.name,{enumerable:!0,get:function(){return void 0===
d._v&&(d.init&&(d._v=d.init()),void 0===d._v)?d.defaultVal():d._v},set:function(a){d.set(a)}})};e.listen=function(a,b){void 0===b&&(b=a,a=void 0);this._listeners||(this._listeners=[]);this._listeners.push({context:a,fn:b})};e.unlisten=function(a,b){if(this._listeners){void 0===b&&(b=a);for(var d=0;d<this._listeners.length;d++)if(this._listeners[d].fn==b){this._listeners.splice(d,1);break}}};e.set=function(a,b){if(a!==this._v){if(void 0!==a){var d=!0;if(this.type){var c=null===a?"null":typeof a,d=
c===this.type;!d&&Array.isArray(this.type)&&(d=-1!=this.type.indexOf(c));d||"string"!==c||(d="color"===this.type,!d&&Array.isArray(this.type)&&(d=-1!=this.type.indexOf("color")),d&&(c="color"));d&&"color"===c?Ga(a)||(this.pub&&E.invalidArg("setOptions",this.name,a,"Must be a CSS color string"),a=this._v):d||("null"===c?a=void 0:(this.pub&&(c=Array.isArray(this.type)?"Must be one of these types: "+JSON.stringify(this.type):"Must be of type "+this.type,E.invalidArg("setOptions",this.name,a,c)),a=this._v))}d&&
(this.legal&&-1==this.legal.indexOf(a)?(this.pub&&E.invalidArg("setOptions",this.name,a,"Must be one of "+JSON.stringify(this.legal)),a=this._v):void 0!==this.min&&a<this.min?(this.pub&&E.invalidArg("setOptions",this.name,a,"Using minimum value of "+this.min,!1),a=this.min):void 0!==this.max&&a>this.max?(this.pub&&E.invalidArg("setOptions",this.name,a,"Using maximum value of "+this.max,!1),a=this.max):this.validate&&(a=this.validate(this.name,a,this._v)))}if(a!==this._v){d=this._v;if("object"===this.type){this._v=
{};for(var e in a)a.hasOwnProperty(e)&&(this._v[e]=a[e])}else this._v=a;if(!1!==b&&this._listeners)for(e=0;e<this._listeners.length;e++)c=this._listeners[e],c.fn.call(c.context,this._v,d,this.name)}}};e.setProperty=function(a,b){if("object"===this.type||Array.isArray(this.type)&&-1!=this.type.indexOf("object")&&(!this._v||this._v[a]!==b))if(this._v||(this._v={}),this._v[a]!==b&&(this._v[a]=b,this._listeners))for(var d=0;d<this._listeners.length;d++){var c=this._listeners[d];c.fn.call(c.context,this._v,
null,this.name)}};e.reset=function(a){this.set(void 0,a)};e.defaultVal=function(){return this.def};return c}();w.extend({URL:{init:function(){return V.URL}},baseURL:{init:function(){return x.outputBaseUrl}},viewNode:{init:function(){var c=w.rootNode;if(c)return y.attach(c.childByClass("oit-view"))}},rootNode:{init:function(){var c=y.byClass("oit-view-root");if(c&&0<c.length)return y.attach(c[0])}},deType:{},drawing:{},libversion:{},documentLoading:{def:!1},documentLoaded:{def:!1},documentComplete:{def:!1},
documentUnloading:{def:!1},dynamicContent:{def:!1},enableRawText:{},guid:{},singlePageIndex:{},isMobile:{init:function(){return oc()}},isMobileOrTablet:{init:function(){return pc()}},editingComment:{def:0},staging:{def:!1},hasHiddenText:{def:!1},hasWorksheetRevisions:{def:!1},httpHeaders:{def:null},withCredentials:{def:!1}});var x=function(){var c=new qb(function(e){return new nc(c,e)});c.isPublic=function(c){return(c=this._plugins[c])&&c.pub};c.reset=function(c){$a(this._plugins,"reset",null,c)};
c.reset=function(c,a){if("string"===typeof c){"boolean"!==typeof a&&(a=!0);var b=this._plugins[c];b&&b.reset(a)}};c.resetAll=function(c){"boolean"!==typeof c&&(c=!0);for(var a in this._plugins)this._plugins[a].reset(c)};c.defaultVal=function(c){if(c=this._plugins[c])return c.defaultVal()};c.setProperty=function(c,a,b){(c=this._plugins[c])&&c.setProperty(a,b)};return c}();x.extend({disableAnimation:{pub:!0,type:"boolean",init:function(){return!1}},memoryModel:{pub:!0,type:"string",legal:["large","small",
"micro","none"],init:function(){return w.isMobileOrTablet?"small":"large"}},detectBaseUrl:{pub:!0,type:"boolean",def:!0},outputBaseUrl:{pub:!0,type:"string",def:""},centerPages:{pub:!0,type:"boolean",def:!0},redactionColor:{pub:!0,type:"color",def:"#000"},redactionFillColor:{pub:!0,type:"color",def:null},showHighlightLabels:{pub:!0,type:"boolean",def:!0},highlightLabelFontFamily:{pub:!0,type:"string",def:null},highlightLabelFontSize:{pub:!0,type:"string",def:null},highlightActivationBoxColor:{pub:!0,
type:["color","null"],def:null},redactionMode:{pub:!0,type:"string",legal:["simple","compound","hybrid"],def:"hybrid"},contentTimeout:{pub:!0,type:"number",min:1,def:2E4},doubleClickInterval:{pub:!0,type:"number",def:500,min:1,max:1E4},removeExtraEmailHeaders:{pub:!0,type:"boolean",def:!1},emailHeaderStyle:{pub:!0,type:"object",def:null},zoom:{type:"number",def:1,min:.1,max:40},zoomMode:{type:["string","null"],legal:[null,"page","pagewidth","pageheight","mobile"],init:function(){return w.isMobileOrTablet?
"mobile":null}},rotation:{type:"number",legal:[0,90,180,270],def:0},selectionMode:{type:"string",legal:["text","rect","cell","none"],def:"text",validate:function(c,e,a){return S.validateMode(e,a)}},nochrome:{pub:!0,type:"boolean",def:!1,init:function(){return!1}},scrollMode:{pub:!0,type:"string",legal:["single","vertical","hswipe","vswipe"],def:"vertical",init:function(){return w.isMobileOrTablet?"hswipe":"vertical"}},showSlideNotes:{pub:!0,type:"boolean",def:!1},showAnnotations:{pub:!0,type:"boolean",
def:!1},presentationMode:{pub:!0,type:"string",legal:["normal","slideshow"],def:"normal"},showEmailAddresses:{pub:!0,type:"boolean",def:!1},showHiddenSheets:{pub:!0,type:"boolean",def:!1},showHiddenRows:{pub:!0,type:"boolean",def:!1},showHiddenColumns:{pub:!0,type:"boolean",def:!1},showCellTooltips:{type:"boolean",def:!1},showHiddenContentNotification:{pub:!0,type:"string",legal:["none","expanded","collapsed"],def:"collapsed"},appointmentHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",headerFields:[["ORGANIZER",
"FROM"],"IMPORTANCE","LOCATION","DTSTART","DTEND","CATEGORIES","ATTENDEES","REQATTENDEE","OPTATTENDEE"]}},contactHeader:{pub:!0,type:"object",def:{subjectField:["SUBJECT","DISPLAYAS","FILEAS","FULLNAME"],defaultSubject:!1,dateField:null,photoField:[{g:"PHOTO",id:"PHOTO"},"PHOTO"],logoField:[{g:"LOGO",id:"LOGO"},"LOGO"],headerFields:["COMPANY",[{g:"NAME",id:"FIRST"},"FIRST"],[{g:"NAME",id:"MIDDLE"},"MIDDLE"],[{g:"NAME",id:"FAMILY"},"FAMILY"],[{g:"NAME",id:"SUFFIX"},"SUFFIX"],[{g:"NAME",id:"TITLE"},
"TITLE","JOBTITLE"],{multi:!0,fields:[{g:"TELENUMBER",t:"Work",id:"TELENUMBER",l:"EMAIL_BUSINESSPHONE"},{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE",l:"EMAIL_BUSINESSPHONE"},"BUSINESSPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Cell",id:"TELENUMBER",l:"EMAIL_MOBILEPHONE"},"MOBILEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Pager",id:"TELENUMBER",l:"EMAIL_PAGERPHONE"},"PAGERPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Home",id:"TELENUMBER",
l:"EMAIL_HOMEPHONE"},{g:"ADDRESS",t:"Home",id:"PHONE",l:"EMAIL_HOMEPHONE"},"HOMEPHONE"]},{multi:!0,fields:[{g:"TELENUMBER",t:"Postal",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},{g:"ADDRESS",t:"Postal",id:"PHONE",l:"EMAIL_OTHERPHONE"},{g:"TELENUMBER",id:"TELENUMBER",l:"EMAIL_OTHERPHONE"},"TELENUMBER","OTHERPHONE"]},{multi:!0,fields:[{g:"EMAIL",id:"EMAIL",d:"DISPLAYAS"},"EMAIL"]},"WEBPAGE","IMADDRESS","DISPLAYAS",{title:"BUSINESSADDRESS",fields:[[{g:"ADDRESS",t:"Work",id:"POBOX"},{g:"BUSINESSADDRESS",id:"BUSINESSPOBOX"},
"BUSINESSPOBOX"],[{g:"ADDRESS",t:"Work",id:"STREET"},{g:"BUSINESSADDRESS",id:"BUSINESSSTREET"},"BUSINESSSTREET"],[{g:"ADDRESS",t:"Work",id:"CITY"},{g:"BUSINESSADDRESS",id:"BUSINESSCITY"},"BUSINESSCITY"],[{g:"ADDRESS",t:"Work",id:"STATE"},{g:"BUSINESSADDRESS",id:"BUSINESSSTATE"},"BUSINESSSTATE"],{g:"ADDRESS",t:"Work",id:"REGION"},[{g:"ADDRESS",t:"Work",id:"POSTALCODE"},{g:"BUSINESSADDRESS",id:"BUSINESSPOSTALCODE"},"BUSINESSPOSTALCODE"],[{g:"ADDRESS",t:"Work",id:"COUNTRY"},{g:"BUSINESSADDRESS",id:"BUSINESSCOUNTRY"},
"BUSINESSCOUNTRY"],[{g:"ADDRESS",t:"Work",id:"BUSINESSPHONE2"},{g:"BUSINESSADDRESS",id:"BUSINESSPHONE2"},"BUSINESSPHONE2"],[{g:"ADDRESS",t:"Work",id:"BUSINESSFAX"},{g:"BUSINESSADDRESS",id:"BUSINESSFAX"},"BUSINESSFAX"]]},{title:"HOMEADDRESS",fields:[[{g:"ADDRESS",t:"Home",id:"POBOX"},"HOMEPOBOX"],[{g:"ADDRESS",t:"Home",id:"STREET"},"HOMESTREET"],[{g:"ADDRESS",t:"Home",id:"CITY"},"HOMECITY"],[{g:"ADDRESS",t:"Home",id:"STATE"},"HOMESTATE"],{g:"ADDRESS",t:"Home",id:"REGION"},[{g:"ADDRESS",t:"Home",id:"POSTALCODE"},
"HOMEPOSTALCODE"],[{g:"ADDRESS",t:"Home",id:"COUNTRY"},"HOMECOUNTRY"],[{g:"ADDRESS",t:"Home",id:"PHONE2"},"HOMEPHONE2"],[{g:"ADDRESS",t:"Home",id:"FAX"},"HOMEFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",t:"Postal",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",t:"Postal",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",t:"Postal",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",t:"Postal",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",t:"Postal",id:"REGION"},[{g:"ADDRESS",t:"Postal",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",
t:"Postal",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",t:"Postal",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",t:"Postal",id:"FAX"},"OTHERFAX"]]},{title:"OTHERADDRESS",fields:[[{g:"ADDRESS",id:"POBOX"},"OTHERPOBOX"],[{g:"ADDRESS",id:"STREET"},"OTHERSTREET"],[{g:"ADDRESS",id:"CITY"},"OTHERCITY"],[{g:"ADDRESS",id:"STATE"},"OTHERSTATE"],{g:"ADDRESS",id:"REGION"},[{g:"ADDRESS",id:"POSTALCODE"},"OTHERPOSTALCODE"],[{g:"ADDRESS",id:"COUNTRY"},"OTHERCOUNTRY"],[{g:"ADDRESS",id:"PHONE2"},"OTHERPHONE2"],[{g:"ADDRESS",
id:"FAX"},"OTHERFAX"]]}]}},distroHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:[]}},journalHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"START",headerFields:["ENTRY_TYPE","COMPANY","DURATION","CATEGORIES"]}},emailHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:["CLIENT_SUBMIT_TIME","DATE"],headerFields:["FROM","TO","CC","BCC"]}},noteHeader:{pub:!0,type:"object",def:{subjectField:null,dateField:null,headerFields:["CREATION_TIME",
"CATEGORIES"]}},postHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:"CREATION_TIME",headerFields:["FROM","CLIENT_SUBMIT_TIME","CONVERSATION_TOPIC"]}},taskHeader:{pub:!0,type:"object",def:{subjectField:"SUBJECT",dateField:null,headerFields:"START_DATE STATUS DUE_DATE PRIORITY OWNER PERCENT_COMPLETE CATEGORIES".split(" ")}},annoBarWidth:{pub:!0,type:"number",init:function(){return Math.min(w.viewNode.clientWidth/2,320)}},highlightTermIntervals:{pub:!0,type:"boolean",def:!0},highlightActivationStyle:{pub:!0,
type:"string",legal:["box","opacity"],def:"opacity"},annotationSort:{pub:!0,type:"string",legal:"location date rdate author rauthor type".split(" "),def:"location"},normalizeAccentsForSearch:{pub:!0,type:"boolean",def:!0}});var Sc=function(){var c=function(a,b,d){Wa.call(this,b,d);this.prop("host",a,!1,!0)},e=W(c,Wa),a=function(a,b,d){var c=a._int;if(c)for(var e=0;e<c.length;e++){var q=c[e];if(!(q.fn!==b||void 0!==d&&q.context!==d||a._xint&&-1!==a._xint.indexOf(e)))return e}return-1},b=function(a,
b){var d=a._pub;return d?d.indexOf(b):-1},d=function(b,d,c,e){void 0===c&&(c=d,d=void 0);if(-1===a(b,c,d)){var l=!b.hasListeners(),q={context:d,fn:c};!0===e&&(q.listenOnce=!0);b.single&&b.hasListeners()?b.logError(null,"Only one listener may be registered for the "+b.name+" event."):(b._int||b.prop("_int",[],!0),b._int.push(q),l&&b.isSystemEvent()&&b.list.addElementListeners(b.name),b.onListen&&b.onListen.call(null,b,c,d))}},g=function(a,b){-1!=b&&(a.dispatching?(a._xint||(a._xint=[]),a._xint.push(b)):
(a._int.splice(b,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onUnlisten&&a.onUnlisten.call(null,a)))},k=function(a,b){-1!=b&&(a.dispatching?(a._xpub||(a._xpub=[]),a._xpub.push(b)):(a._pub.splice(b,1),!a.hasListeners()&&a.isSystemEvent()&&a.list.removeElementListeners(a.name),a.onRemove&&a.onRemove.call(null,a)))},m=function(){var a;this.detail&&(a=this.detail.apply(null,arguments));var b=this.systemEventName||this.name,d=V.createEvent("CustomEvent");d.initCustomEvent(b,
!0,!0,a);return d},r=function(){var a=!0,b,d;this.dispatching=!0;var c=this._int;if(c)for(b=c.length,d=0;d<b;d++){var e=c[d];e.listenOnce&&g(this,d);!1===e.fn.apply(e.context,arguments)&&(a=!1)}c=this._pub;if(a&&c){a=m.apply(this,arguments);b=c.length;for(d=0;d<b;d++)c[d].call(void 0,a);a=!a.defaultPrevented}a&&this._def&&(a=this._def.fn.apply(this._def.context,arguments));this.dispatching=!1;if(this._xint){for(d=this._xint.length-1;0<=d;d--)g(this,this._xint[d]);delete this._xint}if(this._xpub){for(d=
this._xpub.length-1;0<=d;d--)k(this,this._xpub[d]);delete this._xpub}return a};e.extend=function(a){a&&(!0===a.pub&&(this.prop("pub",!0),a.detail&&this.prop("detail",a.detail)),!0===a.systemEvent&&this.prop("systemEventName","_"+this.name),0<a.delay&&this.prop("delay",a.delay),!0===a.single&&this.prop("single",!0),this.prop("onListen",a.onListen),this.prop("onUnlisten",a.onUnlisten),this.prop("onAdd",a.onAdd),this.prop("onRemove",a.onRemove),Object.defineProperty(this.list,this.name,{enumerable:!0,
value:this}))};e.enable=function(){this.disabled=!1};e.disable=function(){this.disabled=!0};e.hasListeners=function(){return!!this._def||this._int&&0<this._int.length||this._pub&&0<this._pub.length};e.isSystemEvent=function(){return!!this.systemEventName};e.setDefaultListener=function(a,b){if(a){this._def&&this.setDefaultListener(null);var d=!this.hasListeners();this._def={context:b,fn:a};d&&this.isSystemEvent()&&this.list.addElementListeners(this.name);this.onListen&&this.onListen.call(null,this,
a,b)}else this._def&&(delete this._def,!this.hasListeners()&&this.isSystemEvent()&&this.list.removeElementListeners(this.name),this.onUnlisten&&this.onUnlisten.call(null,this))};e.listen=function(a,b){d(this,a,b,!1)};e.listenOnce=function(a,b){d(this,a,b,!0)};e.unlisten=function(b,d){void 0===d&&(d=b,b=void 0);g(this,a(this,d,b))};e.addPublicListener=function(a){var d=!1;if(this.pub&&"function"===typeof a)if(-1!==b(this,a))d=!0;else{var c=!this.hasListeners();this.single&&this.hasListeners()?this.logError(null,
"Only one listener may be registered for the "+this.name+" event."):(this._pub||this.prop("_pub",[],!0),this._pub.push(a),c&&this.isSystemEvent()&&this.list.addElementListeners(this.name),this.onAdd&&this.onAdd.call(null,this,a),d=!0)}return d};e.removePublicListener=function(a){a=b(this,a);if(-1==a)return!1;k(this,a);return!0};e.dispatch=function(){this.logDispatch&&this.logDispatch.apply(this,arguments);if(this.hasListeners()&&!this.disabled){if(!this.delay||w.documentUnloading)return r.apply(this,
arguments);this._dispatchTimer&&ta(this._dispatchTimer);this._ddArgs=arguments;this._dispatchTimer=da(t,this.delay,this)}return!0};var t=function(){r.apply(this,this._ddArgs);delete this._ddArgs};e.dispatchTo=function(a,b){var d=m.apply(this,b);a.call(void 0,d);return!d.defaultPrevented};e.reset=function(){this._int&&(this._int=[]);this._pub&&(this._pub=[]);delete this._def};return c}(),qc=function(){var c="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel".split(" "),
e=function(a){for(a=y.unwrap(a);a;){var b=y.data(a,"dispatcherData");if(b)return b;a=a.parentNode}},a=function(a){return new Sc(this._host,this,a)},b=function(b,d){qb.call(this,a);this.name=d;this._host=b;this._eventElements=[];var c=this;this.onSystemEvent=function(a){var b=!0,d=c[a.type];if(d&&d.hasListeners()&&!d.disabled){var g=e(a.currentTarget||a.target);if(g)for(var q=0;b&&q<g.length;q++){var l=g[q];l.args[1]=a;b=d.dispatch.apply(d,l.args);l.args[1]=null}}b||jb(a);return b}},d=W(b,qb);d.enable=
function(){this.disabled=!1};d.disable=function(){this.disabled=!0};d.addElementListeners=function(a){if(this[a])if(-1!==c.indexOf(a))for(var b=0;b<this._eventElements.length;b++){var d=this._eventElements[b];d.addEventListener(a,this.onSystemEvent,!1)}else for(b=0;b<this._eventElements.length;b++)d=this._eventElements[b],y.wrap(d).on(a,this,this.onSystemEvent)};d.removeElementListeners=function(a){if(this[a])if(-1!==c.indexOf(a))for(var b=0;b<this._eventElements.length;b++)this._eventElements[b].removeEventListener(a,
this.onSystemEvent);else for(b=0;b<this._eventElements.length;b++)y.wrap(this._eventElements[b]).off(a,this,this.onSystemEvent)};d.addElement=function(a,b){if((a=y.unwrap(a))&&a.addEventListener){var d;if(-1==this._eventElements.indexOf(a))for(d in this._eventElements.push(a),this._plugins){var g=this[d];if(g.isSystemEvent()&&g.hasListeners())if(-1!==c.indexOf(d))a.addEventListener(d,this.onSystemEvent,!1);else y.wrap(a).on(d,this,this.onSystemEvent)}g={context:b,args:[y.wrap(a),null]};for(d=1;d<
arguments.length;d++)g.args.push(arguments[d]);var k=e(a);k||(k=[],y.data(a,"dispatcherData",k));var u=!1;for(d=0;d<k.length;d++)if(k[d].context===b){k[d]=g;u=!0;break}u||k.push(g)}};d.removeElement=function(a,b){a=y.unwrap(a);var d=this._eventElements.indexOf(a);if(-1!=d){var g=!0;if(void 0===b)y.removeData(a,"dispatcherData");else{var k=e(a);if(k){for(var u=0;u<k.length;u++)if(k[u].context===b){1==k.length?k=null:k.splice(u,1);break}k&&0!==k.length?g=!1:y.removeData(a,"dispatcherData")}}if(g){this._eventElements.splice(d,
1);for(var n in this._plugins)d=this[n],d.isSystemEvent()&&d.hasListeners()&&(-1!==c.indexOf(n)?a.removeEventListener(n,this.onSystemEvent):y.wrap(a).off(n,this,this.onSystemEvent))}}};d.removeAllElements=function(){for(var a=this._eventElements.length-1;0<=a;a--)this.removeElement(this._eventElements[a])};d.eventMessage=function(){if(!this._eventMessage){for(var a in this._plugins)this._eventMessage=this._eventMessage?this._eventMessage+","+a:"Must be one of ["+a;this._eventMessage&&(this._eventMessage+=
"]")}return this._eventMessage};return b}(),Xa=new qc(null,"globalEvents");Xa.extend({install:{},init:{}});var Aa=function(){return new qb(function(c){return new Tc(c)})}(),Tc=function(){var c="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),
e=function(a){Wa.call(this,Aa,a)},a=W(e,Wa),b=function(a,b){a["on"+b.name]=function(a,d){b.listen(a,d)};a["off"+b.name]=function(a,d){b.unlisten(a,d)}};a.extend=function(a){this.def=a;Xa.install.listen(this,this.install);var d=a.events;a=a.userEventDef;if(d||a){this.on||(this.on=new qc(this,this.name));if(d)for(var e in d){var g=d[e],t=this.on.extend.call(this.on,e,g);b(this,t);g&&g.pub&&(this.hasPublicEvents=!0)}a&&(a.systemEvent=!0,this.on.extend.call(this.on,c,a),a.pub&&(this.hasPublicEvents=!0))}};
a.install=function(){var a=this,b=this.def;delete this.def;b.install&&b.install(this);if(a.hasPublicEvents||b.exports&&0<b.exports.length){OIT[a.name]||(hb(a.name,{}),a.publicName="OIT."+a.name);var d={};a.hasPublicEvents&&(a.addEventListener||(d.addEventListener={value:function(b,d){var c=!1,e=a.on[b];e?c=e.addPublicListener(d):a.invalidArg("addEventListener","name",b,a.on.eventMessage());return c}}),a.removeEventListener||(d.removeEventListener={value:function(b,d){var c=!1,e=a.on[b];e?c=e.removePublicListener(d):
a.invalidArg("removeEventListener","name",b,a.on.eventMessage());return c}}));if(b.exports&&0<b.exports.length)for(var c=0;c<b.exports.length;c++){var e=b.exports[c],u=a[e];void 0!==u&&(d||(d={}),d[e]={value:u})}Object.defineProperties(OIT[a.name],d)}};var d=function(a,b){if(Array.isArray(b))for(var c=0;c<b.length;c++){if(d(a,b[c]))return!0}else{if(void 0===a)return!0;switch(b){case "null":if(null===a)return!0;break;case "function":if(null===a||Pa(a))return!0;break;case "DOMRange":if(null===a||Ra(a))return!0;
break;case "DOMSelection":if(null===a||Ba(a))return!0;break;case "RegExp":if(null===a||a instanceof RegExp)return!0;break;case "string":if(null===a||"string"===typeof a)return!0;break;default:if(typeof a===b)return!0}}return!1};a.processArguments=function(a,b,c){for(var e={},g=0,u=0;g<c.length;g++){var n=c[g];e&&n.def&&(e[n.name]=n.def);if(u>=b.length)n.req&&(this.logError(a,"Argument '"+n.name+"' is required"),e=null);else{var q=b[u];if(d(q,n.type)){var l=null;n.val?l=n.val(q):n.legal&&-1==n.legal.indexOf(q)&&
(l="Must be one of "+JSON.stringify(n.legal));l?(this.invalidArg(a,n.name,q,l),e=null):e&&(e[n.name]=q);u++}else n.req&&(this.invalidArg(a,n.name,q,"Must be of type "+JSON.stringify(n.type)),u++,e=null)}}return e};return e}(),wb=function(){return new qb(function(c){return new Uc(c)})}(),Uc=function(){var c=function(a){Wa.call(this,wb,a)},e=W(c,Wa);e.extend=function(a){this.def=a;Xa.install.listen(this,this.install)};e.install=function(){var a=this.def;delete this.def;a.install&&a.install(this)};e.init=
function(a){if(a.isLoaded())this.load(a);else{var b=this;a.load(!0,function(){b.load(a)})}};e.load=function(a){};e.unload=function(){};e.visiblePages=function(){return[z.activePage()]};e.saveScrollPos=function(){};e.restoreScrollPos=function(a){};e.maxPageWidth=function(){return z.maxWidth()};e.maxPageHeight=function(){return z.maxHeight()};e.padding=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollPadding=function(){};e.margin=function(){return{left:0,top:0,right:0,bottom:0}};e.scrollOffset=
function(){return w.viewNode.scroll()};e.startElasticScroll=function(){};e.elasticScroll=function(a,b){};e.endElasticScroll=function(a,b){};e.getSelectedText=function(){return y.selectedText()};e.select=function(a){return!1};e.keydown=function(a){return!0};e.showHidden=function(a){};e.loadRange=function(a,b){b&&b(a)};e.expandRange=function(a){return a};e.moveto=function(a,b,d){return!1};e.pageRange=function(a,b){};e.pageRect=function(a,b,d){return z.elementRect(z.page(a),b)};e.rangeRect=function(a,
b,d,c){};e.rangeFromRect=function(a,b,d,c,e,m,r){};e.extendRange=function(a,b,d,c){};e.moveAnchor=function(a,b,d,c){return!1};e.incrementSelection=function(a,b,d,c,e){return!1};e.layoutChanged=function(a){};e.update=function(a){};return c}(),Ha=function(){var c=new qb(function(c){return new Vc(c)});c.createDisplay=function(e){if(e=c.item(e))return wb.item(e.de)};c.features=function(e){if(e=c.item(e))return e.features};return c}(),Vc=function(){var c="zoom rotate showhidden pages fitpage highlights textselection rectselection rectredaction cellselection customtextselection anchorednotes elasticScroll".split(" "),
e=function(a){Wa.call(this,Ha,a)};W(e,Wa).extend=function(a){this.de=a.de;for(var b=this.features={},d=0;d<c.length;d++){var e=c[d],k=a[e];void 0===k&&(k=!0);b[e]=k}};return e}(),Za,ib,ac,db,Ja,Ga,bc,xb,fa=function(c){return"number"===typeof c},Ia=function(c){return"string"===typeof c};(function(){var c={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",
brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",
darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",
khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",
maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",
paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",
tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:"rgba(0,0,0,0)"},e=1/6,a=1/3,b=2/3,d=function(a,d,c){0>c?c+=1:1<c&&--c;c<e?a+=(d-a)*c*6:.5>c?a=d:c<b&&(a+=(d-a)*(b-c)*6);return 255*a|0},g=[{property:"webkit",css:"-webkit-"},{property:"Moz",css:"-moz-"},{property:"ms",css:"-ms-"},{property:"O",css:"-o-"}],k=function(a,b,d){var c=V.documentElement;
if(Ia(c.style[a]))return b;if(!1!==d)for(a=a.charAt(0).toUpperCase()+a.slice(1),d=0;d<g.length;d++)if(Ia(c.style[g[d].property+a]))return g[d].css+b},m=function(a,b){for(var d,c=V.createElement("div"),e=0;e<b.length;e++)if(c.style[a]=b[e],c.style[a]===b[e]){d=b[e];break}return d};Za={transform:k("transform","transform"),"transform-origin":k("transformOrigin","transform-origin")};Tb=m("cursor",["grab","-webkit-grab","-moz-grab","move"]);Ub=m("cursor",["grabbing","-webkit-grabbing","-moz-grabbing",
"move"]);var r=function(a,b){if(-1!=b)for(var d=a.chars;b<d.length;b++){var c=d[b];if(" "!==c&&"\n"!==c&&"\r"!==c&&"\t"!==c){"/"===c&&"*"===d[b+1]&&(d=a.string.indexOf("*/",b+2),b=-1==d?a.string.length:d+2);break}}return b},t=function(a,b,d){return-1!=b&&a.chars[b]!==d?-1:++b};ib=function(a){var b;if(a){b={};a={string:a,chars:a.split("")};for(var d=0;-1!=d&&d<a.chars.length;){var c=a,e=d,d=b,g={},k=e=r(c,e);if(-1!=k){for(var u=c.chars,e=k;e<u.length;e++){var m=u[e];if(!("a"<=m&&"z">=m||"A"<=m&&"Z">=
m||"0"<=m&&"9">=m)&&"-"!==m&&"_"!==m)break}e>k?(g.name=c.string.substring(k,e),k=e):k=-1}e=k;e=r(c,e);e=t(c,e,":");k=e=r(c,e);if(-1!=k){u=c.chars;for(e=k;e<u.length;e++){m=u[e];if("!"===m||";"===m)break;if('"'===m||"'"===m||"("===m){"("===m&&(m=")");for(var C=e+1;C<u.length;C++){var Q=u[C];if(Q===m){e=C;break}else if("\\"===Q){Q=u[++C];if("0"<=Q&&"9">=Q||"a"<=Q&&"f">=Q||"A"<=Q&&"F">=Q){do Q=u[++C];while("0"<=Q&&"9">=Q||"a"<=Q&&"f">=Q||"A"<=Q&&"F">=Q)}e=C;break}}}}e>k?(g.value=c.string.substring(k,
e),k=e):k=-1}e=k;e=r(c,e);k=g;-1!=e&&"!important"===c.string.substring(e,e+10)&&(k.important=!0,e+=10);e=r(c,e);e<c.chars.length&&(e=t(c,e,";"));-1!=e&&(d[g.name]=g.value);d=e}}return b};ac=function(a,b){var d=[];if(a)for(var c in a)a.hasOwnProperty(c)&&(b?d.push(c,":",a[c]," !important;"):d.push(c,":",a[c],";"));return d.join("")};db=function(a,b){if(a&&Ia(a)&&Ia(b)){for(var d=0;;){d=a.indexOf(b,d);if(-1===d||0===d)break;var c=a.charAt(d-1);if(";"==c||" "==c)break;d++}if(-1!=d){for(d+=b.length;" "===
a.charAt(d);)d++;if(":"===a.charAt(d)){for(d++;" "===a.charAt(d);)d++;c=a.indexOf(";",d);-1===c&&(c=a.length);for(;c>d&&" "===a.charAt(c-1);)c--;return a.substring(d,c)}}}};Ja=function(){var a=arguments;if(1==a.length){a=a[0];if(Ia(a))a=Ga(a);else if(void 0===a.r||void 0===a.g||void 0===a.b)a=void 0;if(a)return Ja(a.r,a.g,a.b,a.a)}else if(3==a.length||4==a.length){var b=M(na(a[0],0,255)),d=M(na(a[1],0,255)),c=M(na(a[2],0,255)),e=1;4==a.length&&void 0!==a[3]&&(e=na(a[3],0,1));if(1!=e)return"rgba("+
b+","+d+","+c+","+e+")";b=b.toString(16);d=d.toString(16);c=c.toString(16);2>b.length&&(b="0"+b);2>d.length&&(d="0"+d);2>c.length&&(c="0"+c);return"#"+b+d+c}};Ga=function(b){if(b){var e,g;if(0===b.indexOf("#")){if(e={r:parseInt(b.substring(1,3),16),g:parseInt(b.substring(3,5),16),b:parseInt(b.substring(5,7),16),a:1},isNaN(e.b)){g=b.substring(1,2);var l=b.substring(2,3);b=b.substring(3,4);l+=l;b+=b;e.r=parseInt(g+g,16);e.g=parseInt(l,16);e.b=parseInt(b,16)}}else if(0===b.indexOf("rgba(")||0===b.indexOf("rgb(")){e=
b.replace(/[^\d.,]/g,"").split(",");for(g=0;g<e.length;g++)e[g]=Number(e[g]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);e={r:e[0],g:e[1],b:e[2],a:e[3]}}else if(0===b.indexOf("hsla(")||0===b.indexOf("hsl(")){e=b.replace(/[^\d.,]/g,"").split(",");for(g=0;g<e.length;g++)e[g]=Number(e[g]);for(;3>e.length;)e.push(0);for(;4>e.length;)e.push(1);g=e[0];b=e[1];l=e[2];g/=360;b/=100;l/=100;if(0===b)l=b=g=255*l|0;else{var I=.5>l?l*(1+b):l+b-l*b,k=2*l-I,l=d(k,I,g+a);b=d(k,I,g);g=d(k,I,g-a)}e={r:l,g:b,
b:g,a:e[3]}}else if(g=c[b.toLowerCase()])return Ga(g);if(e)return e.r=na(e.r,0,255),e.g=na(e.g,0,255),e.b=na(e.b,0,255),e.a=na(e.a,0,1),e}};bc=function(a,b,d,c){1<d||(d=1);var e=Ga(a);b=Ga(b);if(!e||!b)return a;var l;!0===c?(a=(e.r+b.r*d)/(1+d),c=(e.g+b.g*d)/(1+d),l=(e.b+b.b*d)/(1+d),d=(e.a+b.a*d)/(1+d)):(b.a=1-e.a,a=e.r*e.a+b.r*b.a,c=e.g*e.a+b.g*b.a,l=e.b*e.a+b.b*b.a,d=1);return Ja(a,c,l,d)};xb=function(a){if(void 0!==a&&null!==a&&""!==a){var b=Number(a);if(!isNaN(b))return b+"px";if(a.match(/(\d|\.)+(em|ex|px|in|pt|pc|mm|cm|\%)/))return a}else return null}})();
var T;OIT.local||hb("local",{ADDED_COLUMN:"Inserted Column",ADDED_ROW:"Inserted Row",ADDED_SHEET:"Added Sheet",ANNO_CHANGE_FROM:"from",ANNO_CHANGE_TO:"to",ANNOTATIONS:"Annotations",ANNOTATION_TYPE:"Annotation Type",AUTHOR_A_TO_Z:"Author A-Z",AUTHOR_Z_TO_A:"Author Z-A",CANCEL:"Cancel",CHANGED_TEXT:"Changed Text",CLEAR_CELL:"Cleared Cell",COLUMN:"Column",COMMENT:"Comment",DEL:"DEL",DELETED_COLUMN:"Deleted Column",DELETED_ROW:"Deleted Row",DELETED_TEXT:"Deleted Text",DISCARD_CHANGES:"Discard changes",
DOCUMENT_ERROR:"Error occurred, document incomplete.",HIDDEN_SLIDE:"This slide is hidden in presentation mode",HIDDEN_TEXT:"Hidden Text",INSERTED_TEXT:"Inserted Text",LABEL_SEPARATOR:":",LOADING:"Loading",LOCATION:"Location",MODIFIED_CELL:"Modified Cell",MOVED_CELLS:"Moved Cells",NEW_CELL:"New Cell",NEWEST_FIRST:"Newest first",NO:"No",NO_SUBJECT:"(No Subject)",NOTES:"Notes",OK:"OK",OLDEST_FIRST:"Oldest first",PAGE_DOWN:"Next Page",PAGE_UP:"Previous Page",PLEASE_WAIT:"Please wait",PLEASE_WAIT_CONVERTING:"Document conversion in progress...",
PLEASE_WAIT_DOWNLOADING:"Loading document, please wait",PLEASE_WAIT_INITIALIZING:"Please wait while your<br>document is loaded...",PREPARING_TO_PRINT:"Preparing to print...",RENAMED_SHEET:"Renamed Sheet",ROW:"Row",SAVE_CHANGES:"Save changes",SHOWDETAILS:"Show Details",SORT_BY:"Sort by: ",HIDEDETAILS:"Hide Details",UNKNOWN_FIELD:"[Unknown Field]",UNSUPPORTED_CONTENT:"(Unsupported Content)",YES:"Yes",HIDDEN_CONTENT_HIDDEN:"Hidden content (Not Visible)",HIDDEN_CONTENT_PARTIAL:"Hidden content (Partially Visible)",
HIDDEN_CONTENT_VISIBLE:"Hidden content (Visible)",HIDDEN_CONTENT_NOTIFICATION:"This document contains hidden information:",HIDDEN_CONTENT_INVISIBLE:"These items are not currently visible in the viewer.",HIDDEN_CONTENT_SHOWLINK:"Show these items",HIDDEN_CONTENT_ALREADY_VISIBLE:"These items are already visible in the viewer.",HIDDEN_CONTENT_ORIGINAL_APPLICATION:"This document contains information that cannot be displayed in the browser. Open the document in the native application to view the full document content:",
HIDDEN_CONTENT_HIDELINK:"Hide these items",HIDDEN_CONTENT_ANNOTATIONS:"Annotations",HIDDEN_CONTENT_PAGES:"Hidden pages",HIDDEN_CONTENT_COLUMNS:"Hidden columns",HIDDEN_CONTENT_ROWS:"Hidden rows",HIDDEN_CONTENT_COMMENTS:"Comments",HIDDEN_CONTENT_SPEAKER_NOTES:"Speaker Notes",HIDDEN_CONTENT_SLIDES:"Hidden slides",HIDDEN_CONTENT_TEXT:"Hidden text",HIDDEN_CONTENT_TRACKED_CHANGES:"Tracked changes",HIDDEN_CONTENT_LARGE_SHEET:"The worksheet is larger than the browser can display",DOCUMENT_ERRORS:"Document Errors",
DOCUMENT_EXCEPTION_NOTIFICATION:"Errors were encountered while processing this document:",DOCEX_MISSING_MAP:"Some text could not be mapped to displayable characters",DOCEX_VERTICAL_TEXT:"Vertical text was present, but could not be displayed correctly",DOCEX_TEXT_EFFECTS:"Some text had unsupported text effects applied",DOCEX_UNSUPPORTED_COMPRESSION:"An embedded graphic used an unsupported compression",DOCEX_UNSUPPORTED_COLOR_SPACE:"An embedded graphic used an unsupported color space",DOCEX_FORMS:"Forms were present but could not be displayed correctly",
DOCEX_RIGHT_TO_LEFT_TABLES:"A table had right to left columns",DOCEX_ALIASED_FONT:"A required font was missing, but a font alias was used",DOCEX_MISSING_FONT:"A required font was not present on the system",DOCEX_SUBDOC_FAILED:"Part of the document could not be converted",DOCEX_TYPE_THREE_FONT:"An unsupported font was required by the document",DOCEX_UNSUPPORTED_SHADING:"The document used an unsupported shading type",DOCEX_INVALID_HTML:"Invalid HTML was encountered",DOCEX_VECTOR_OBJECT_LIMIT:"Not all of the vector objects could be displayed",
DOCEX_INVALID_ANNOTATIONS_NOT_APPLIED:"An invalid annotation could not be applied",DOCEX_INLINE_IMAGE_FOUND:"An embedded graphic could not be rendered",EMAIL_TO:"To",EMAIL_CC:"CC",EMAIL_BCC:"BCC",EMAIL_SUBJECT:"Subject",EMAIL_MSGFLAG:"Message Flag",EMAIL_FLAGSTS:"Flag Status",EMAIL_EXPIRES:"Expires",EMAIL_CATEGORIES:"Categories",EMAIL_IMPORTANCE:"Importance",EMAIL_SENSITIVITY:"Sensitivity",EMAIL_LOCATION:"Location",EMAIL_FULLNAME:"Full Name",EMAIL_JOBTITLE:"Job Title",EMAIL_COMPANY:"Company",EMAIL_EMAIL:"Email",
EMAIL_WEBPAGE:"Webpage",EMAIL_WORKPHONE:"Work Telephone",EMAIL_HOMEPHONE:"Telephone",EMAIL_FROM:"From",EMAIL_ATTACHMENT:"Attachments",EMAIL_RTFBODY:"RTF Embedded Body",EMAIL_RECEIVED:"Received",EMAIL_SIZE:"Size",EMAIL_LASTMODIFIED:"Last Modified",EMAIL_NEWSGROUPS:"Newsgroups",EMAIL_SUBMITTIME:"Submit Time",EMAIL_CCME:"CC Me",EMAIL_ALTERNATE_RECIPIENT_ALLOWED:"Alternate Recipient Allowed",EMAIL_CLIENT_SUBMIT_TIME:"Sent",EMAIL_CREATION_TIME:"Created",EMAIL_CONVERSATION_INDEX:"Conversation Index",EMAIL_CONVERSATION_TOPIC:"Topic",
EMAIL_MESSAGE_SUBMISSION_ID:"Message Submission ID",EMAIL_MESSAGE_CLASS:"Message Class",EMAIL_ORIGINATOR_DELIVERY_REPORT_REQUESTED:"Originator Delivery Report Requested",EMAIL_READ_RECEIPT_REQUESTED:"Read Receipt Requested",EMAIL_RCVD_REPRESENTING_ADDRTYPE:"Received Representing Address Type",EMAIL_RCVD_REPRESENTING_EMAIL_ADDRESS:"Received Representing Email",EMAIL_RCVD_REPRESENTING_ENTRYID:"Received Representing Entry ID",EMAIL_RCVD_REPRESENTING_NAME:"Received Representing Name",EMAIL_RCVD_REPRESENTING_SEARCH_KEY:"Received Representing Search Key",
EMAIL_RECEIVED_BY_ADDRTYPE:"Received By Address Type",EMAIL_RECEIVED_BY_EMAIL_ADDRESS:"Received By Email",EMAIL_RECEIVED_BY_ENTRYID:"Received By Entry ID",EMAIL_RECEIVED_BY_NAME:"Received By Name",EMAIL_RECEIVED_BY_SEARCH_KEY:"Received By Search Key",EMAIL_RTF_IN_SYNC:"RTF In Sync",EMAIL_RTF_SYNC_BODY_COUNT:"RTF Sync Body Count",EMAIL_RTF_SYNC_BODY_CRC:"RTF Sync Body CRC",EMAIL_RTF_SYNC_BODY_TAG:"RTF Sync Body Tag",EMAIL_RTF_SYNC_PREFIX_COUNT:"RTF Sync Prefix Count",EMAIL_RTF_SYNC_TRAILING_COUNT:"RTF Sync Trailing Count",
EMAIL_SEARCH_KEY:"Search Key",EMAIL_SENDER_ADDRTYPE:"Sender Address",EMAIL_SENDER_EMAIL_ADDRESS:"Sender Email",EMAIL_SENDER_ENTRYID:"Sender Entry ID",EMAIL_SENDER_NAME:"Sender Name",EMAIL_SENDER_SEARCH_KEY:"Sender Search Key",EMAIL_SENT_REPRESENTING_ADDRTYPE:"Sent Representing Addr Type",EMAIL_SENT_REPRESENTING_EMAIL_ADDRESS:"Sent Representing Email",EMAIL_SENT_REPRESENTING_ENTRYID:"Sent Representing Entry ID",EMAIL_SENT_REPRESENTING_SEARCH_KEY:"Sent Representing Search Key",EMAIL_TRANSPORT_MESSAGE_HEADERS:"Transport Message Headers",
EMAIL_PRIORITY:"Priority",EMAIL_AUTO_FORWARDED:"Auto Forwarded",EMAIL_DEFERRED_DELIVERY_TIME:"Deferred Delivery Type",EMAIL_EXPIRY_TIME:"Expiry Time",EMAIL_LATEST_DELIVERY_TIME:"Latest Delivery Time",EMAIL_RECIPIENT_REASSIGNMENT_PROHIBITED:"Recipient Reassignment Prohibited",EMAIL_REPLY_TIME:"Reply Time",EMAIL_REPORT_TAG:"Report Tag",EMAIL_RESPONSE_REQUESTED:"Response Requested",EMAIL_REPLY_REQUESTED:"Reply Requested",EMAIL_DELETE_AFTER_SUBMIT:"Delete After Submit",EMAIL_MESSAGE_LOCALE_ID:"Message Locale ID",
EMAIL_CREATOR_NAME:"Creator Name",EMAIL_CREATOR_ENTRYID:"Creator Entry ID",EMAIL_LAST_MODIFIER_NAME:"Last Modifier Name",EMAIL_LAST_MODIFIER_ENTRYID:"Last Modifier Entry ID",EMAIL_INTERNET_ARTICLE_NUMBER:"Internet Artical Number",EMAIL_NT_SECURITY_DESCRIPTOR:"NT Security Descriptor",EMAIL_TRUST_SENDER:"Trust Sender",EMAIL_INTERNET_MESSAGE_ID:"Internet Message ID",EMAIL_ATTR_HIDDEN:"Hidden",EMAIL_ATTR_SYSTEM:"System",EMAIL_ATTR_READONLY:"Read Only",EMAIL_INTERNET_CPID:"Internet CPID",EMAIL_MESSAGE_CODEPAGE:"Message Codepage",
EMAIL_SENDER_FLAGS:"Sender Flags",EMAIL_SENT_REPRESENTING_FLAGS:"Sent Representing Flags",EMAIL_RCVD_BY_FLAGS:"Recived By Flags",EMAIL_RCVD_REPRESENTING_FLAGS:"Received Representing Flags",EMAIL_INET_MAIL_OVERRIDE_FORMAT:"Internet Mail Override Format",EMAIL_MSG_EDITOR_FORMAT:"MSG Editor Format",EMAIL_PROFILE_CONNECT_FLAGS:"Profile Connect Flags",EMAIL_SENT_REPRESENTING_NAME:"Sent Representing Name",EMAIL_ENTRYID:"Entry ID",EMAIL_NORMALIZED_SUBJECT:"Normalized Subject",EMAIL_ATTENDEES:"Attendees",
EMAIL_REQATTENDEE:"Required Attendees",EMAIL_OPTATTENDEE:"Optional Attendees",EMAIL_FILEAS:"File as",EMAIL_DISPLAYAS:"Display As (E-mail)",EMAIL_TITLE:"Title",EMAIL_SUFFIX:"Suffix",EMAIL_NICKNAME:"Nickname",EMAIL_PROFESSION:"Profession",EMAIL_DEPARTMENT:"Department",EMAIL_OFFICE:"Office",EMAIL_ANNIVERSARY:"Anniversary",EMAIL_BIRTHDATE:"Birth date",EMAIL_ASSISTANTSNAME:"Assistant's Name",EMAIL_SPOUSESNAME:"Spouse's Name",EMAIL_MANAGERSNAME:"Manager's Name",EMAIL_BUSINESSADDRESS:"Business Address",
EMAIL_BUSINESSPHONE:"Telephone",EMAIL_HOMEADDRESS:"Home Address",EMAIL_OTHERADDRESS:"Other Address",EMAIL_MOBILEPHONE:"Mobile",EMAIL_BUSINESSFAX:"Fax",EMAIL_IMADDRESS:"IM",EMAIL_INTERNETFREEBUSYADDR:"Internet Free Busy Address",EMAIL_REMINDERTOPIC:"Reminder Topic",EMAIL_CONTACTS:"Contacts",EMAIL_CALLBACKPHONE:"Callback Telephone",EMAIL_FIRST:"First",EMAIL_FAMILY:"Last",EMAIL_TELENUMBER:"Telephone",EMAIL_BUSINESSPHONE2:"Telephone 2",EMAIL_RADIOPHONE:"Radio Telephone",EMAIL_CARPHONE:"Car Telephone",
EMAIL_OTHERPHONE:"Telephone",EMAIL_PAGERPHONE:"Pager",EMAIL_OTHERFAX:"Fax",EMAIL_HOMEFAX:"Fax",EMAIL_TELEXPHONE:"Telex Telephone",EMAIL_ISDN:"ISDN Telephone",EMAIL_ASSISTANTPHONE:"Assistant Telephone",EMAIL_HOMEPHONE2:"Telephone 2",EMAIL_MIDDLE:"Middle",EMAIL_TTYTTDPHONE:"TTY/TTD Telephone",EMAIL_GENDER:"Gender",EMAIL_PERSONALHOMEPAGE:"Personal Home Page",EMAIL_COMPANYPHONE:"Company Telephone",EMAIL_HOMECITY:"City",EMAIL_HOMECOUNTRY:"Country",EMAIL_POSTALCODE:"Postal Code",EMAIL_HOMESTATE:"State",
EMAIL_HOMESTREET:"Street",EMAIL_HOMEPOBOX:"PO Box",EMAIL_OTHERCITY:"City",EMAIL_OTHERCOUNTRY:"Country",EMAIL_OTHERPOSTALCODE:"Postal Code",EMAIL_OTHERSTATE:"State",EMAIL_OTHERSTREET:"Street",EMAIL_OTHERPOBOX:"PO Box",EMAIL_BUSINESSSTREET:"Street",EMAIL_BUSINESSCITY:"City",EMAIL_BUSINESSSTATE:"State",EMAIL_BUSINESSPOSTALCODE:"Postal Code",EMAIL_BUSINESSCOUNTRY:"Country",EMAIL_BUSINESSPOBOX:"PO Box",EMAIL_DISPLAYAS2:"Display As (E-mail 2)",EMAIL_EMAIL2:"Email 2",EMAIL_DISPLAYAS3:"Display As (E-mail 3)",
EMAIL_EMAIL3:"Email 3",EMAIL_DTSTART:"Start Time",EMAIL_DTEND:"End Time",EMAIL_START:"Start",EMAIL_DURATION:"Duration",EMAIL_ACCUREATTYPE1:"Accurate Type 1",EMAIL_ENTRY_TYPE:"Entry Type",EMAIL_STATUS:"Status",EMAIL_PERCENT_COMPLETE:"Percent Complete",EMAIL_START_DATE:"Start Date",EMAIL_DUE_DATE:"Due Date",EMAIL_COMPLETED:"Completed",EMAIL_ACTUALWORK:"Actual Work",EMAIL_TOTAL_WORK:"Total Work",EMAIL_OWNER:"Owner",EMAIL_BILLING:"Billing",EMAIL_MILEAGE:"Mileage",EMAIL_PROOF_OF_DELIVERY_REQUESTED:"Proof of Delivery Requested",
EMAIL_PROOF_OF_SUBMISSION_REQUESTED:"Proof of Submission Requested",EMAIL_IN_REPLY_TO_ID:"In Reply To ID",EMAIL_TASK_COMPLETE:"Task Complete",EMAIL_APPOINTMENT_DURATION:"Appointment Duration",EMAIL_RECURRENCE_TYPE:"Recurrence Type",EMAIL_RECURRENCE_RANGE:"Recurrence Range",EMAIL_ORGANIZER:"Organizer",EMAIL_CALENDAR_EXCEPTION:"Calendar Exceptions",EMAIL_RSVP:"RSVP",EMAIL_ROLE:"Role",EMAIL_ATTENDEE:"Attendee",EMAIL_ADDRESS:"Address",EMAIL_POBOX:"PO Box",EMAIL_EXTADDRESS:"Ext Address",EMAIL_STREET:"Street",
EMAIL_CITY:"City",EMAIL_REGION:"Region",EMAIL_COUNTRY:"Country",EMAIL_TYPE:"Type",EMAIL_NAME:"Name",EMAIL_LOGO:"Logo",EMAIL_PHOTO:"Photo",EMAIL_ALARM:"Alarm",EMAIL_DESCRIPTION:"Description",EMAIL_DATE:"Date"});T=OIT.local;var ab,eb,kc=598,Vb=599;(function(){var c=[],e=Date.now(),a=function(a){return bb(c,"request",a)},b=function(b){var d=a(this);if(!d)throw"request.start(): Invalid request object";if(!d.aborted){if(void 0!==this.status)throw"request.start(): Request is already completed";if("number"!==
typeof b||0>b)throw"request.start(): fileSize must be a non-negative integer indicating the total size of the requested file in bytes";if(void 0!==d.contentLength)throw"request.start(): start should only be called once per request";d.contentLength=b;n(d,"")}},d=function(b){var d=a(this);if(!d)throw"request.loading(): Invalid request object";if(!d.aborted){if(void 0!==this.status)throw"request.loading(): Request is already completed";if("string"!==typeof b)throw"request.loading(): responseText must be a string containing the partial or complete contents of the requested file";
if(void 0!==this.contentLength&&b.length>this.contentLength)throw"request.loading(): responseText length must not exceed the size specified to request.start";d.responseText=b;void 0!==d.contentLength&&n(d,b)}},g=function(b){var d=a(this);if(!d)throw"request.done(): Invalid request object";if(!d.aborted){if("number"!==typeof b||0>=b)throw"request.done(): status must be a positive integer HTTP status code";if(0===b)d.timeout=!0;else if(200===b){if(void 0===d.responseText)throw"request.done(): request.loading() was never called";
if(void 0!==d.contentLength&&d.responseText.length!==d.contentLength)throw"request.done(): responseText length must be equal to the contentLength passed in to request.start()";}Object.defineProperty(this,"status",{value:b});d.contentLength=d.responseText.length;Object.defineProperty(this,"responseText",{value:d.responseText});Ka(c,d);u(d)}},k=function(){var b=a(this);if(!b)throw"request.abort(): Invalid request object";b.aborted=!0;u(b)},m=function(a,e){var l={};Object.defineProperties(l,{url:{value:a},
start:{value:b},loading:{value:d},done:{value:g},abort:{value:k}});e.request=l;e.isLocal=!0;c.push(e);return l},r=function(a){a.inDispatch=!0;E.on.ajax.dispatch(a.request);a.inDispatch=!1},t=function(a,b){var d=a[b];if(d){var c=Array.prototype.slice.call(arguments,2);a.args&&(c=c.concat(a.args));d.apply(a.context,c)}},u=function(a){var b="unknown"!=typeof a.request.responseText?a.request.responseText:void 0,d=a.request.status;0===d||a.aborted?(d=kc,a.aborted=!0,E.on.ajax.hasListeners()&&E.on.ajaxabort.hasListeners()&&
E.on.ajaxabort.dispatch(this)):a.timeout&&(d=Vb);a.contentLength=b.length;200===d?t(a,"success",a.url,a.contentLength,b,d):t(a,"error",a.url,a.contentLength,b,d);t(a,"complete",a.url,a.contentLength,b,d)},n=function(a,b){t(a,"loading",a.url,a.contentLength,b)};ab=function(a){var b=a.url,d;if("string"===typeof b&&0<b.length){var g={context:null},l;for(l in a)g[l]=a[l];if(E.on.ajax.hasListeners())m(b,g),da(r,0,null,g),d=g;else if(R.XMLHttpRequest){g.request=new XMLHttpRequest;!1===a.cache&&(b=-1!=b.indexOf("?")?
b+"&":b+"?",++e,b+="_="+e);g.request.onreadystatechange=function(){if(!g.aborted)switch(g.request.readyState){case 2:g.contentLength=Number(g.request.getResponseHeader("Content-Length"));n(g,"");break;case 3:n(g,"unknown"!=typeof g.request.responseText?g.request.responseText:void 0);break;case 4:u(g),Ka(c,g)}};g.request.ontimeout=function(){g.timeout=!0;u(g)};w.withCredentials&&(g.request.withCredentials=!0);g.request.open("GET",b,!0);if(a=w.httpHeaders)for(var q in a)a.hasOwnProperty(q)&&g.request.setRequestHeader(q,
a[q]);g.request.send();c.push(g);d=g}}return d};var q=function(a){a.aborted=!0;a.request&&a.request.abort()};eb=function(a){a?(Ka(c,a),q(a)):(Z(c,q),c=[])}})();var M=function(c,e){return e&&1<e?Math.round(c*e)/e:Math.floor(0>c?c-.5:c+.5)},na=function(c,e,a){c<e?c=e:c>a&&(c=a);return c},Wb=function(c,e,a,b){if(c==a&&e==b)return 0;c=a-c;e=b-e;return M(Math.sqrt(c*c+e*e))},Yb=function(c,e){if("deg"===e)c%=360,0>c&&(c+=360);else{var a=Math.PI,b=2*a;c%=b;c<-a?c+=b:c>a&&(c-=b)}return c},cc=function(c,e,
a){void 0===a&&(a=1.01);return(c>e?Math.abs(c/e):Math.abs(e/c))<=a},dc,yb,Qa,da,ta,pb,Zb;(function(){for(var c=[],e=[],a=[],b=R.requestAnimationFrame,d=R.cancelAnimationFrame,g=0,k=["ms","moz","webkit","o"],m=0;m<k.length&&!b;++m)b=R[k[m]+"RequestAnimationFrame"],d=R[k[m]+"CancelAnimationFrame"]||R[k[m]+"CancelRequestAnimationFrame"];b||(b=function(a){var b=(new Date).getTime(),d=Math.max(0,16-(b-g)),c=R.setTimeout(function(){a(b+d)},d);g=b+d;return c});d||(d=function(a){R.clearTimeout(a)});dc=function(){var b;
for(b=0;b<c.length;b++)R.clearInterval(c[b].id);c=[];for(b=0;b<e.length;b++)R.clearTimeout(e[b].id);e=[];for(b=0;b<a.length;b++)d.call(R,a[b].id);a=[]};var r=function(a,b,d,c){var e=0;c={fn:a[e++],remove:!!c};b&&(c.timeout=a[e++]);c.context=a[e++];d&&(c.args=[0],c.ts=!0);a.length>e&&(a=Array.prototype.slice.call(a,e),c.args=c.args?c.args.concat(a):a);return c},t=function(a,b,d){try{a.remove&&Ka(b,a),a.ts&&(a.args[0]=d),a.fn.apply(a.context,a.args)}catch(l){R.OILogDebugError&&R.OILogDebugError("Error in asynchronous timer function: "+
l.message)}};yb=function(a,b,d){var e=r(arguments,!0,!1,!1);c.push(e);e.id=R.setInterval(function(){t(e,c)},e.timeout);return e.id};Qa=function(a){R.clearInterval(a);Hb(c,"id",a)};da=function(a,b,d){var c=r(arguments,!0,!1,!0);e.push(c);c.id=R.setTimeout(function(){t(c,e)},b);return c.id};ta=function(a){R.clearTimeout(a);Hb(e,"id",a)};pb=function(d,c){for(var e,g=0;g<a.length;g++)if(e=a[g],e.fn===d&&e.context===c)return e.id;e=r(arguments,!1,!0,!0);a.push(e);e.id=b.call(R,function(b){t(e,a,b)});return e.id};
Zb=function(b){d.call(R,b);Hb(a,"id",b)};Xa.install.listen(function(){E.onreset(function(){dc();c=[];e=[];a=[]})})})();var La,jb,zb,Ma,Ya,Pa,Ra,Ba,rc,Sa,Ua,Z,Ab,sc,$a,tc,uc,Ka,Hb,bb,ec,vb,Ib,vc,wc,Bb,xc,fb,yc,zc,Ac,oc,pc;(function(){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,a=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d)|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d)/,
b=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,d=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,k=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,
m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},r=Math.pow(2,53),t="oit-emhdrvalue oit-emhdrlabel oit-emhdrsection oit-email oit-rt oit-sn oit-comment-text oit-comment-date oit-comment-author oit-anno-text oit-anno-date oit-anno-author oit-overlay".split(" ");La=function(a){for(a=y.unwrap(a);a&&!y.isElement(a);)a=a.parentNode;var b;a&&(a=y.wrap(a),b=a.hasClass(t)?a:a.ancestorByClass(t));return b?b:null};jb=function(a){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()};
zb=function(a,b,d){var c=a.indexOf(":");if(0<c){var e=zb(a.slice(0,c),b,d);a=zb(a.slice(c+1),b,d);e.c2=a.c1;e.r2=a.r1;return e}var e=!1,c=0,g=!1,l=0,q=0,f=a.length,h=a.charCodeAt(q);q<f&&36==h&&(e=!0,q++,h=a.charCodeAt(q));for(!1===(q<f&&65<=h&&90>=h)&&(g=e);q<f&&65<=h&&90>=h;)c=26*c+(h-65+1),q++,h=a.charCodeAt(q);q<f&&36==h&&(g=!0,q++,h=a.charCodeAt(q));for(;q<f&&48<=h&&57>=h;)l=10*l+(h-48),q++,h=a.charCodeAt(q);0<c&&c--;0<l&&l--;!e&&b&&(c+=b);!g&&d&&(l+=d);return sa(c,l,c,l)};Ma=function(a){if("number"==
typeof a&&!(0>a)){if(26>a)return c[a];var b=a%26,d=(a-b)/26-1;if(702>a)return c[d]+c[b];a=Math.floor(d);d=a%26;return c[(a-d)/26-1]+c[d]+c[b]}};Ya=function(a){if("number"==typeof a&&!(0>a))return(a+1).toString()};Pa=function(a){return"[object Function]"==Object.prototype.toString.call(a)};Ra=function(a){return a&&void 0!==a.startContainer&&void 0!==a.startOffset&&void 0!==a.endContainer&&void 0!==a.endOffset?!0:!1};Ba=function(a){return a&&void 0!==a.anchorNode&&void 0!==a.anchorOffset&&void 0!==
a.focusNode&&void 0!==a.focusOffset?!0:!1};rc=function(a){return!/^(?:[a-z]+:)?\/\//i.test(a)};Sa=function(a,b){return a&&0!==a.length?b&&0!==b.length?"/"==a.charAt(a.length-1)?"/"==b.charAt(0)?a+b.substr(1):a+b:"/"==b.charAt(0)?a+b:a+"/"+b:a:b};Ua=function(a){var b;if(Array.isArray(a)){b=[];for(var d=0;d<a.length;d++)b[d]=Ua(a[d])}else{if(Pa(a))return null;if(null===a)b=null;else switch(typeof a){case "object":b={};for(d in a)a.hasOwnProperty(d)&&!Pa(a[d])&&(b[d]=Ua(a[d]));break;case "string":b=
new String(a);break;case "number":case "boolean":case "undefined":b=a}}return b};Z=function(a,b,d){u(!1,!1,null,arguments)};Ab=function(a,b){u(!1,!1,a,b)};sc=function(a,b,d){u(!1,!0,null,arguments)};$a=function(a,b,d){u(!0,!1,null,arguments)};tc=function(a,b){u(!0,!1,a,b)};var u=function(a,b,d,c){var e=0;d||(d=c[e++]);if(d&&(a||0<d.length)){var g,l=c[e++],k=c[e++],f="string"==typeof l;f||e--;c=c.length>e?Array.prototype.slice.call(c,e):void 0;f?e=q:(e=n,c||(c=[null]));if(a)for(g in d)d.hasOwnProperty(g)&&
e(d[g],l,k,c);else if(b?(g=d.length-1,b=a=-1):(g=0,a=d.length,b=1),d.item)for(;g!=a;g+=b)e(d.item(g),l,k,c);else for(;g!=a;g+=b)e(d[g],l,k,c)}},n=function(a,b,d,c){null===a||void 0===a||null!==d&&void 0!==d&&!a.filter(d)||(c[0]=a,b.apply(null,c))},q=function(a,b,d,c){a&&(null===d||void 0===d||a.filter(d))&&a[b].apply(a,c)};uc=function(a,b,d){if(a===b)return!0;if(null===a||void 0===a)return null===b||void 0===b;if(null===b||void 0===b||"[object Array]"!==Object.prototype.toString.call(a)||"[object Array]"!==
Object.prototype.toString.call(b)||a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])if(!0===d){if(JSON.stringify(a[c])!==JSON.stringify(b[c]))return!1}else return!1;return!0};Ka=function(a,b){var d=a.indexOf(b);-1!=d&&a.splice(d,1)};Hb=function(a,b,d){b=ec(a,b,d);-1!=b&&a.splice(b,1)};bb=function(a,b,d){b=ec(a,b,d);if(-1!=b)return a[b]};ec=function(a,b,d){if(Array.isArray(a)&&"string"===typeof b)for(var c=0;c<a.length;c++){var e=a[c];if(e&&e[b]===d)return c}return-1};vb=function(a){return Ra(a)?
"[DOM Range]":Ba(a)?"[DOM Selection]":y.isElement(a)?y.unwrap(a).outerHTML:y.isText(a)?'"'+a.textContent+'"':JSON.stringify(a)};Ib=function(a){a&&(a=a.replace(/[&<>"']/g,function(a){return m[a]}));return a};var l;a:{try{(new Date).toLocaleDateString("i")}catch(I){l="RangeError"===I.name;break a}l=!1}vc=function(b){if(l&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleDateString()}catch(L){}return b};wc=function(b){if(l&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleTimeString()}catch(L){}return b};
Bb=function(b){if(l&&(b.match(e)||b.match(a)))try{b=(new Date(b)).toLocaleString()}catch(L){}return b};xc=function(a){1073741824<a?(a=Math.floor(a/1073741824*10)/10,a=""+a+" GB"):1048576<a?(a=Math.floor(a/1048576*10)/10,a=""+a+" MB"):1024<a?(a=Math.floor(a/1024*10)/10,a=""+a+" KB"):a=""+Math.floor(a)+" B";return a};fb=function(){if(w.isMobileOrTablet){var a=z.activePage();if(a){var b=y.create("div");a.append(b);da(function(){b.destroy()},10)}}};yc=function(a){for(var b=a.css("width"),d=1,c=r;d<c;){var e=
Math.ceil((d+c)/2);a.css("width",e+"px");a.clientWidth!=e?c=e-1:d=e}a.css("width",b);return d};zc=function(a){for(var b=a.css("height"),d=1,c=r;d<c;){var e=Math.ceil((d+c)/2);a.css("height",e+"px");a.clientHeight!=e?c=e-1:d=e}a.css("height",b);return d};Ac=function(a){var b=!1;switch(a){case "firefox":b=-1!=navigator.userAgent.toLowerCase().indexOf("firefox")}return b};oc=function(){var a=!1,c=navigator.userAgent||navigator.vendor||R.opera;if(b.test(c)||d.test(c.substr(0,4)))a=!0;return a};pc=function(){var a=
!1,b=navigator.userAgent||navigator.vendor||R.opera;if(g.test(b)||k.test(b.substr(0,4)))a=!0;return a}})();var Wc=function(){function c(){}function e(){console.log(Array.prototype.slice.call(arguments).join(" "))}var a={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},b={icate:"ic",ative:"",alize:"al",
iciti:"ic",ical:"ic",ful:"",ness:""};return function(d,g){var k,m,r,t,u,n;n=g?e:c;if(3>d.length)return d;r=d.substr(0,1);"y"==r&&(d=r.toUpperCase()+d.substr(1));t=/^(.+?)(ss|i)es$/;m=/^(.+?)([^s])s$/;t.test(d)?(d=d.replace(t,"$1$2"),n("1a",t,d)):m.test(d)&&(d=d.replace(m,"$1$2"),n("1a",m,d));t=/^(.+?)eed$/;m=/^(.+?)(ed|ing)$/;t.test(d)?(m=t.exec(d),t=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,t.test(m[1])&&(t=/.$/,d=d.replace(t,""),n("1b",t,d))):m.test(d)&&(m=m.exec(d),k=m[1],m=/^([^aeiou][^aeiouy]*)?[aeiouy]/,
m.test(k)&&(d=k,n("1b",m,d),m=/(at|bl|iz)$/,u=/([^aeiouylsz])\1$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,m.test(d)?(d+="e",n("1b",m,d)):u.test(d)?(t=/.$/,d=d.replace(t,""),n("1b",u,d)):k.test(d)&&(d+="e",n("1b",k,d))));t=/^(.*[aeiouy].*)y$/;t.test(d)&&(m=t.exec(d),k=m[1],d=k+"i",n("1c",t,d));t=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;t.test(d)&&(m=t.exec(d),k=m[1],m=m[2],t=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
t.test(k)&&(d=k+a[m],n("2",t,d)));t=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;t.test(d)&&(m=t.exec(d),k=m[1],m=m[2],t=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,t.test(k)&&(d=k+b[m],n("3",t,d)));t=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;m=/^(.+?)(s|t)(ion)$/;t.test(d)?(m=t.exec(d),k=m[1],t=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,t.test(k)&&(d=k,n("4",t,d))):m.test(d)&&(m=m.exec(d),
k=m[1]+m[2],m=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,m.test(k)&&(d=k,n("4",m,d)));t=/^(.+?)e$/;t.test(d)&&(m=t.exec(d),k=m[1],t=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,m=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,u=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,t.test(k)||m.test(k)&&!u.test(k))&&(d=k,n("5",t,m,u,d));t=/ll$/;m=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;
t.test(d)&&m.test(d)&&(t=/.$/,d=d.replace(t,""),n("5",t,m,d));"y"==r&&(d=r.toLowerCase()+d.substr(1));return d}}(),Bc={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u1ea4":"A","\u1eae":"A","\u1eb2":"A","\u1eb4":"A","\u1eb6":"A","\u1ea6":"A","\u1eb0":"A","\u0202":"A","\u00c7":"C","\u1e08":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u1ebe":"E","\u1e16":"E","\u1ec0":"E","\u1e14":"E","\u1e1c":"E","\u0206":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I",
"\u1e2e":"I","\u020a":"I","\u00d0":"D","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u1ed0":"O","\u1e4c":"O","\u1e52":"O","\u020e":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u1ea5":"a","\u1eaf":"a","\u1eb3":"a","\u1eb5":"a","\u1eb7":"a","\u1ea7":"a","\u1eb1":"a","\u0203":"a","\u00e7":"c","\u1e09":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e",
"\u1ebf":"e","\u1e17":"e","\u1ec1":"e","\u1e15":"e","\u1e1d":"e","\u0207":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u1e2f":"i","\u020b":"i","\u00f0":"d","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u1ed1":"o","\u1e4d":"o","\u1e53":"o","\u020f":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00ff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C",
"\u0109":"c","\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0110":"D","\u0111":"d","\u0112":"E","\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u01f4":"G","\u011d":"g","\u01f5":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H","\u0125":"h","\u0126":"H","\u0127":"h","\u1e2a":"H","\u1e2b":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i",
"\u012c":"I","\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u1e30":"K","\u1e31":"k","\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u013f":"L","\u0140":"l","\u0141":"l","\u0142":"l","\u1e3e":"M","\u1e3f":"m","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0149":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0154":"R","\u0155":"r",
"\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","\u0212":"R","\u0213":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s","\u015e":"S","\u0218":"S","\u0219":"s","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u021b":"t","\u021a":"T","\u0164":"T","\u0165":"t","\u0166":"T","\u0167":"t","\u0168":"U","\u0169":"u","\u016a":"U","\u016b":"u","\u016c":"U","\u016d":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0216":"U","\u0217":"u","\u0174":"W",
"\u0175":"w","\u1e82":"W","\u1e83":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u017f":"s","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U","\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u","\u01d9":"U","\u01da":"u","\u01db":"U","\u01dc":"u","\u1ee8":"U","\u1ee9":"u","\u1e78":"U","\u1e79":"u","\u01fa":"A",
"\u01fb":"a","\u01fe":"O","\u01ff":"o","\u1e54":"P","\u1e55":"p","\u1e64":"S","\u1e65":"s","\u0403":"\u0413","\u0453":"\u0433","\u040c":"\u041a","\u045c":"\u043a","\u1ed2":"O","\u1ed3":"o","\u1e50":"O","\u1e51":"o","\u1eea":"U","\u1eeb":"u","\u1e80":"W","\u1e81":"w","\u1ef2":"Y","\u1ef3":"y","\u0200":"A","\u0201":"a","\u0204":"E","\u0205":"e","\u0208":"I","\u0209":"i","\u020c":"O","\u020d":"o","\u0210":"R","\u0211":"r","\u0214":"U","\u0215":"u","\u01e6":"G","\u01e7":"g","\u021e":"H","\u021f":"h",
"\u01e8":"K","\u01e9":"k","\u1e66":"S","\u1e67":"s","\u1e10":"D","\u1e11":"d","\u0228":"E","\u0229":"e","\u1e28":"H","\u1e29":"h"},Xc=Object.keys(Bc).join("|"),Yc=new RegExp(Xc,"g"),fc=function(c){return c.replace(Yc,function(c){return Bc[c]})},Cc=function(){var c=[{rule:/(\S{3})(\S*)(ies)$/,replace:"y"},{rule:/(\S{3})(\S*)(ing)$/,replace:""},{rule:/(\S{4})(\S*)(ness)$/,replace:""},{rule:/(\S{0})(\S*)(ss)$/,replace:"ss"},{rule:/(\S{3})(\S*)(s)$/,replace:""},{rule:/(\S{4})(\S*)(ion)$/,replace:""},
{rule:/(\S{4})(\S*)(ism)$/,replace:""},{rule:/(\S{4})(\S*)(ly)$/,replace:""},{rule:/(\S{3})(\S*)(eed)$/,replace:"ee"},{rule:/(\S{4})(\S*)(ied)$/,replace:"y"},{rule:/(\S{4})(\S*)(ed)$/,replace:""},{rule:/(\S{3})(\S*)(ed)$/,replace:"e"},{rule:/(\S{4})(\S*)(er)$/,replace:""},{rule:/(\S{4})(\S*)(ful)$/,replace:""},{rule:/(\S{4})(\S*)(able)$/,replace:""},{rule:/(\S{4})(\S*)(ible)$/,replace:""},{rule:/(\S{3})(\S*)(v)$/,replace:"f"},{rule:/(\S{4})(\S*)(e)$/,replace:""},{rule:/(\S{3})(\S*)(dd)$/,replace:"d"},
{rule:/(\S{3})(\S*)(gg)$/,replace:"g"},{rule:/(\S{3})(\S*)(ll)$/,replace:"l"},{rule:/(\S{3})(\S*)(mm)$/,replace:"m"},{rule:/(\S{3})(\S*)(nn)$/,replace:"n"},{rule:/(\S{3})(\S*)(pp)$/,replace:"p"},{rule:/(\S{3})(\S*)(rr)$/,replace:"r"},{rule:/(\S{3})(\S*)(ss)$/,replace:"s"},{rule:/(\S{3})(\S*)(tt)$/,replace:"t"}];return function(e,a){for(var b=0,d=e;b<c.length;){var g=c[b].rule.exec(d);if(g)if(rStem=g[1]+g[2]+c[b].replace,rStem===d)break;else b=0,d=rStem;else b++}return d}}(),Dc=Aa.extend("fonts",{events:{fontload:{}},
install:function(c){var e=["serif","sans-serif","monospace","cursive","fantasy"],a={},b=0,d;c.loadWebFont=function(c){var e=a[c];if(void 0===e){var k=w.rootNode;if(k){e=y.create("div","oit-fontpreloader");e.css("font-family",c);var t=y.create("span");e.append(t);t.html("AEIMNOTaeimnot130");k.append(e);a[c]=e}b=0;d||(d=da(g,250))}};var g=function(){var k=!1,m=!1,r,t;d=void 0;for(r in a)if((t=a[r])&&!0!==t){for(var u=!0,n,q=0;q<e.length;q++){t.css("font-family",r+","+e[q]);var l=t.offsetWidth;if(0<
q&&l!=n){u=!1;break}n=l}u?(t.destroy(),m=a[r]=!0):(t.css("font-family",r),k=!0)}if(k)if(b++,20>b)d=da(g,250);else for(r in a)(t=a[r])&&!0!==t&&(t.destroy(),a[r]=!1);m?c.on.fontload.dispatch():0===b%2&&c.on.fontload.dispatch()};E.onreset(function(){for(var c in a){var e=a[c];e&&!0!==e&&e.destroy()}a=[];b=0;d=void 0})}}),ka=Aa.extend("view",{exports:"attach detach fitToContainer height info stage load unload width hasFeature".split(" "),events:{resize:{delay:80},detach:{},update:{}},install:function(c){var e,
a=0,b,d,g,k,m={},r,t=0,u=0,n,q,l,I,L,K,H;c.hasFeature=function(a){var b=!1;switch(a){case "string":case "dtsearch":case "lucene":case "phsterms":case "literal":case "literal*":case "enhancedhighlight":b=!0}return b};var N=function(){r&&(r.hide(),r=null)};c.dispatchResize=function(){var a=w.viewNode;a&&(g&&C(),b!=a.clientWidth||d!=a.clientHeight)&&(b=a.clientWidth,d=a.clientHeight,c.on.resize.dispatch())};var C=function(){if(g){var a=g.computedStyle(),b=g.offsetWidth-parseInt(a.borderLeftWidth,10)-
parseInt(a.borderRightWidth,10),a=g.offsetHeight-parseInt(a.borderTopWidth,10)-parseInt(a.borderBottomWidth,10);w.rootNode.css({width:b+"px",height:a+"px"})}};c.dispatchScroll=function(a){var b=w.viewNode;if(b&&(c.invalidateCanvas(),E.on.scrollupdate.dispatch(),b=b.scroll(),a||b.left!=u||b.top!=t)){a=b.left-u;var d=b.top-t;u=b.left;t=b.top;E.on.scroll.dispatch(a,b.left,d,b.top)}};var Q=function(){},A=function(){},f=function(){x.nochrome?w.viewNode.addClass("oit-nochrome"):w.viewNode.removeClass("oit-nochrome")},
h=function(){var b=w.rootNode;b&&(b.addClass("oit-view-root"),b=w.viewNode,b||(b=y.attach(y.create("div","oit-view")),w.viewNode=b),e="oitview"+a++,b.id=e,f(),b.attr("tabindex","-1"),b.onscroll(c.dispatchScroll),c.fitToContainer());R.matchMedia&&(b=R.matchMedia("print"))&&b.addListener(function(a){});R.addEventListener("beforeprint",Q);R.addEventListener("afterprint",A);R.addEventListener("resize",c.dispatchResize)};Xa.init.listen(function(){var a=w.rootNode;if(a){var b=a.data("json"),d=a.data("icd"),
c=a.data("page");if(b||d)k=a.parent();h();ha.initializeContent(b,d,c);E.initializeDocument()}});c.attach=function(a){a&&a!==y.unwrap(g)&&(c.detach(),g=y.wrap(a),a=w.rootNode,a||(a=w.rootNode=y.attach(y.create("div"))),a.addClass("oit-view-embedded"),g.append(a),h())};c.detach=function(){E.unload();w.viewNode&&(w.viewNode.offscroll(c.dispatchScroll),w.viewNode.removeData("_events"),y.detach(w.viewNode));w.rootNode&&y.detach(w.rootNode);y.reset();c.on.detach.dispatch();var a=w.viewNode;if(a)try{a.destroy()}catch(O){}if(a=
w.rootNode)try{a.destroy()}catch(O){}R.removeEventListener("beforeprint",Q);R.removeEventListener("afterprint",A);R.removeEventListener("resize",c.dispatchResize);w.rootNode=w.viewNode=null;e=g=k=void 0};c.stage=function(a){w.staging=!0;c.load(a)};var B=function(a){c.logAJAXError("load","Timed out waiting for document to load",a)};c.load=function(a,b){g||k?void 0===a?w.staging&&(w.staging=!1,E.showNotifications()):(c.unload(),w.dynamicContent=!0,w.documentLoading=!0,b&&(b.headers&&(w.httpHeaders=
b.headers),b.withCredentials&&(w.withCredentials=!0)),q&&ta(q),q=da(B,3E4,null,a),ab({url:a,loading:v,success:J,error:ca}),r=ua.createProgressDialog(T.PLEASE_WAIT)):c.logError("load","Call OIT.view.attach before OIT.view.load")};var v=function(a,b,d){q&&ta(q);q=da(B,3E4,null,a);a=d?d.length:0;r&&r.update(80*a/b)},J=function(a,b,d,e){b=!0;q&&(ta(q),q=void 0);try{0===d.length?(c.logAJAXError("load","The document is empty or is still being exported",a,e,d),b=!1):b=E.installDocument(a,d)}catch(D){c.logAJAXError("load",
"The document could not be installed ("+D.message+")",a,e,d),b=!1}b||N()},ca=function(a,b,d,e){q&&(ta(q),q=void 0);c.logAJAXError("load","Failed to load the document index file from the server",a,e,d);N()};c.unload=function(){E.unload();w.httpHeaders=null;w.withCredentials=!1;y.reset()};c.fitToContainer=function(){g&&(C(),c.dispatchResize())};c.width=function(a){a=xb(a);null!==a&&(g&&g.css("width",a),w.rootNode.css("width",a),c.dispatchResize());return w.rootNode.offsetWidth};c.height=function(a){a=
xb(a);null!==a&&(g&&g.css("height",a),w.rootNode.css("height",a),c.dispatchResize());return w.rootNode.offsetHeight};c.info=function(){var a=Ua(m);a.libversion=w.libversion?Ua(w.libversion):"Unknown";var b=ha.manifest();b&&(a.manifest=Ua(b));return a};c.infoRaw=function(){return m};c.showDocumentError=function(a){n||(n=new Ec({title:T.DOCUMENT_ERRORS,closeButton:!0,className:"oit-toast-error"}));n.message(a);n.expand(!1)};var X=function(){var a=w.rootNode,b=a.clientWidth,d=a.clientHeight,e;l=void 0;
K&&(I!=b||L!=d?(K.destroy(),K=null):(e=K.getContext("2d"),e.clearRect(0,0,b,d)));K||(H||(H=y.create("div","oit-viewcanvas"),a.insertFirst(H)),I=b,L=d,K=H.createCanvas());e||(e=K.getContext("2d"));c.on.update.dispatch(e)};c.invalidateCanvas=function(){!l&&c.on.update.hasListeners()&&(l=pb(X,this))};w.onviewNode(function(a,b){b&&b.destroy();if(a){for(var d=w.rootNode,c=d.childByClass("oit-toolframe");c;){c=c.childByClass("oit-toolcontent");if(!c)break;d=c;c=d.childByClass("oit-toolframe")}d&&d.append(a)}});
E.onreset(function(){N();n&&(n.destroy(),n=null);K&&(K.destroy(),K=null);H&&(H.destroy(),H=null);l&&(Zb(l),l=void 0);L=I=-1;d=b=void 0;m={};u=t=0});ha.ondata(function(a,b,d){if(a.info){m||(m={});for(var c in a.info)m[c]=a.info[c];m.fi||(m.fi=1999);m.fistring||(m.fistring="Unknown");m.product||(m.product="Outside In Technology");m.version||(m.version="Unknown")}b&&N()});x.onnochrome(f)}}),ua=Aa.extend("dialog",{install:function(c){var e=[],a=null,b=!1,d,g=!1;c.createProgressDialog=function(a,b){var d=
{dialog:null,text:null,ticks:null,spinner:null,percentDone:0,active:!1,suppressed:!1,message:a,showTicks:b,display:m,update:r,hide:u};e.push(d);R.performance&&R.performance.now?(d.startTime=performance.now(),d.interval=yb(k,200,d)):d.display();return d};var k=function(){var a=performance.now()-this.startTime;0<this.percentDone?(a=100*a/this.percentDone,a=1E3<=a):a=500<=a;a&&(Qa(this.interval),this.display())},m=function(){var a=e.indexOf(this);if(!this.active&&0===a&&!this.dialog)if(this.active=!0,
E.on.showmessage.dispatch(this.message,!0,this.showTicks)){this.suppressed=!1;c.showModalOverlay(!0,200);if(a=w.rootNode){this.dialog=y.create("div","oit-dialog oit-progress-dialog");this.text=y.create("div","oit-dialog-text");this.ticks=y.create("div","oit-progress-dialog-ticks");for(var b=0;20>b;b++)this.ticks.append(y.create("div"));this.spinner=y.create("div","oit-pending oit-progress-dialog-ticks");this.dialog.append(this.text,this.ticks,this.spinner);a.append(this.dialog)}!1===this.showTicks?
(this.ticks.css("display",null),this.spinner.css("display","block")):(this.spinner.css("display",null),this.ticks.css("display","block"));this.tickCount=void 0;this.update(this.percentDone);this.text.html(this.message);this.dialog.css({opacity:0,display:"block"});this.dialog.abortAnimation();this.dialog.animate({opacity:1,time:200,startCSS:{display:"block"}})}else this.suppressed=!0},r=function(a){"number"===typeof a&&(0>a?a=0:100<a&&(a=100),this.percentDone=a,this.active&&(E.on.progress.dispatch(a),
this.dialog&&(a=Math.floor(21*a/100),20<a&&(a=20),a!=this.tickCount&&(this.tickCount=a,this.ticks.forChildElements(t,a)))))},t=function(a,b,d){b<d?a.addClass("filled"):a.removeClass("filled")},u=function(){var a=this;a.interval&&(Qa(a.interval),a.interval=void 0);a.active&&E.on.hidemessage.dispatch();a.dialog&&(a.dialog.abortAnimation(),a.dialog.animate({opacity:0,endCSS:{display:"none"},endFn:function(){a.dialog.destroy();a.dialog=null},time:200}),c.showModalOverlay(!1,200));Ka(e,a)};c.showModalOverlay=
function(a,b){b=b||200;var c=g;if(a){if(!d){var e=w.rootNode;e&&(d=y.create("div","oit-screen"),e.append(d))}d&&!g&&(g=!0,d.abortAnimation(),d.animate({opacity:.5,time:b,startCSS:{opacity:0,display:"block"}}))}else g&&(g=!1,d.abortAnimation(),d.animate({opacity:0,time:b,endCSS:{display:null}}));g!=c&&(c=z.activeOverlay())&&c.updateCSS()};c.modalOverlayVisible=function(){return g};c.showMessage=function(d){b&&c.hideMessage();if(E.on.showmessage.dispatch(d,!1,!1)){if(!a){var e=w.rootNode;e&&(a=y.create("div",
"oit-background-message"),e.append(a))}a&&(b||(a.abortAnimation(),a.animate({opacity:.8,time:200,startCSS:{opacity:0,display:"block"}})),a.html(d))}b=!0};c.hideMessage=function(){b&&(E.on.hidemessage.dispatch(),a&&(a.abortAnimation(),a.animate({opacity:0,time:200,endCSS:{display:null}})),b=!1)};c.messageVisible=function(){return b};E.onreset(function(){for(;0<e.length;)e[e.length-1].hide();a&&a.destroy();d&&d.destroy();a=null;b=!1;d=null;g=!1})}}),Fc=function(){function c(a){if(-1===a.indexOf("*"))return!1;
for(var b=0;b<a.length;b++)if("*"!==a.charAt(b))return!1;return!0}function e(a,b,d){this.value=a;this.type=b;this.subtype=d}function a(){this.items=[];this.add=function(a,b,d){d||(d="");a=new e(a,b,d);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=
function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function b(a,b){this.regEx=b;this.type=a}function d(b,c){for(var e=new a,f=b.slice(0);f;){for(var D=0;D<c.length;D++){var g=f.match(c[D].regEx);if(g){var h=c[D].type;if("LUCENE_WITHIN"===h){var l,h=e,q=/\"(.*)\"~(\d+)/.exec(g[0]);if(q){var B=d(q[1],u);if(B&&B.items&&B.items.length){var k=0,v=0;
for(l=0;l<B.items.length;l++){var m=B.items[l];"OPEN_PAREN"===m.type?v++:"CLOSE_PAREN"===m.type&&v--;if(0===v){k=l+1;break}}for(l=0;l<k;l++)h.addRef(B.items[l]);l=Number(q[2]);isNaN(l)||l++;h.add("WI"+l,"WITHIN",0);for(l=k;l<B.items.length;l++)h.addRef(B.items[l])}}}else"CONNECTOR_TILDE"===h?e.add(g[0].substring(0,g[0].length-1),"WORD",0):e.add(g[0],h,0);f=f.slice(g[0].length);break}}D==c.length&&(f=f.slice(1))}return e}function g(a,b,d){a.push("(");!1===d&&a.push("?:");a.push(b);a.push(")")}function k(a,
b,d,c,e){a.push("(");!1===c&&a.push("?:");m(a,b,d,e);a.push(")")}function m(a,b,d,c){var e;e=b.replace(/([\^\$\+\.\|\(\)\{\}\[\]\\])/g,"\\$1");x.normalizeAccentsForSearch&&(e=fc(e));e=e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]");e=e.replace(/[\u0022\u201C\u201D\u030B\u030F]/g,"[\\u0022\\u201C\\u201D\\u030B\\u030F]");e=e.replace(/\s+/g,"\\s+");if(d)d=e.replace(/\?/g,"[\\u003F]"),d=d.replace(/\*/g,"[\\u002A]");else if(d=e.replace(/\?/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]"),
d=d.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),"dtsearch"===c.searchType)if(d=d.replace(/=/g,"[=\\d]"),c.stemAll||"~"===d.substring(d.length-1))b=0,"~"===d.substring(d.length-1)&&(b=1),d=d.substring(0,d.length-b).toLowerCase(),d=c.stemmerFunction(d),c.stems.push(d),d+="\ue000*";else{if(c.fuzzies&&0<=d.indexOf("%")&&(b=d.indexOf("%"),0<=b)){var f=d.lastIndexOf("%")-b+1;d=d.replace(/%/g,"");d=
d.toLowerCase();c.fuzzies.push({searchTerm:d,minMatch:b,maxDistance:f});0<b&&b--;d=d.slice(0,b)+"\ue001+";e.replace(/[\u0027\u0060\u00B4\u2018\u2019]/g,"[\\u0027\\u0060\\u00B4\\u2018\\u2019]")}}else if(c.fuzzies&&"lucene"===c.searchType&&0<=d.indexOf("~")){b=0;f=1;e=d.lastIndexOf("~");if(e+1<d.length){var p=Number(d.slice(e+1,d.length));isNaN(p)||(f=p)}d=d.slice(0,e);d=d.toLowerCase();c.fuzzies.push({searchTerm:d,minMatch:b,maxDistance:f});d=d.slice(0,b)+"\ue001+"}a.push(d)}var r="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",
t=[new b("NUMERICAL_PATTERN",/^(=[=\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]*)/),new b("CONNECTOR_TILDE",/^(\bNOT~(?=\s|$)|\bnot~(?=\s|\)|$))/),new b("CONNECTOR_TILDE",/^(\bAND~(?=\s|$)|\band~(?=\s|\)|$))/),new b("CONNECTOR_TILDE",/^(\bOR~(?=\s|$)|\bor~(?=\s|\)|$))/),new b("NOT_WITHIN",/^(\bNOT\b|\bnot\b)\s+(\bw\/|\bW\/|\bw \/|\bW \/)/),new b("AND_NOT",/^(\bAND\b|\band\b)\s+(\bNOT\b|\bnot\b)/),new b("OR_NOT",/^(\bOR\b|\bor\b)\s+(\bNOT\b|\bnot\b)/),new b("AND",/^(\bAND\b|\band\b)/),new b("OR",/^(\bOR\b|\bor\b)/),
new b("NOT",/^(\bNOT\b|\bnot\b)/),new b("AndAny",/^(\bAndAny\b|\bandany\b)/),new b("XFIRSTWORD",/^(\bxfirstword\b)/),new b("XLASTWORD",/^(\bxlastword\b)/),new b("DATE",/^\b[dD][aA][tT][eE]\(\s*\**\s*\)/),new b("DATE_WITH_PARAM",/^\b[dD][aA][tT][eE]\([^\)]*\)/),new b("MAIL",/^\b[mM][aA][iI][lL]\(\s*\**\s*\)/),new b("MAIL_WITH_PARAM",/^\b[mM][aA][iI][lL]\([^\)]*\)/),new b("CREDITCARD",/^\b[cC][rR][eE][dD][iI][tT][cC][aA][rR][dD]\(\s*\**\s*\)/),new b("CREDITCARD_WITH_PARAM",/^\b[cC][rR][eE][dD][iI][tT][cC][aA][rR][dD]\([^\)]*\)/),
new b("VISA_CREDIT_CARD_REGEX",/^\bvisacreditcard\(\)/),new b("WITHIN",/^(\bw\/|\bW\/|\bw \/|\bW \/|\bWI\d+|\bwi\d+)/),new b("PRE",/^(\bpre\/|\bPRE\/|\bpre \/|\bPRE \/)/),new b("OPEN_PAREN",/^\(/),new b("CLOSE_PAREN",/^\)/),new b("DTSEARCH_REGULAREXPRESSION",/^\"##[^\"]*\"/),new b("WHITESPACE",/^\s+/),new b("PHRASE",/^"[^"]*"/),new b("WORD",/^[^\s)]+/)],u=[new b("AND",/^(\bAND\b|\s*\u0026\u0026\s*|\s*\u002B\s*)/),new b("OR",/^(\bOR\b|\s*\u007C\u007C\s*)/),new b("NOT",/^(\bNOT\b|\s*\u0021\s*|\s*\u002D\s*)/),
new b("LUCENE_WITHIN",/^\"[^\"]*\"~\d+/),new b("OPEN_PAREN",/^\(/),new b("CLOSE_PAREN",/^\)/),new b("LUCENE_REGULAREXPRESSION",/^\/[^\/]*\//),new b("WHITESPACE",/^\s+/),new b("PHRASE",/^"[^"]*"/),new b("WORD",/^[^\s)]+/)],n="(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",r="[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]",n=
"(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])",q=function(a,b,d){var c,e=null;a.lastHit=pa(d,d+b[0].length);var f=b.length;for(c=1;c<b.length;c++)void 0===b[c]&&f--;if(0<f){e={range:a.lastHit,terms:[]};for(f=1;f<b.length;f++)if(b[f]){var g=b[f],h=a.modifier;"\ue010"===g?c="\ue010+":(c=!!g.match(r),g=g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),
c=c?["(",g,")"].join(""):["(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))(",g,")",n].join(""));c=new RegExp(c,h);for(h=null;g=c.exec(b[0]);){h||(h=g);if(0===g.index)break;if(g.index+g[0].length>=b[0].length){h=g;break}}if(h){g=h[0];c=h.index;if(h[1]){var l=h[0].indexOf(h[1]);-1!=l&&(g=h[1],c+=l)}var l=d+c,q=l+g.length,B=!1;for(c=0;c<
e.terms.length;c++){var k=e.terms[c];if(k.range.acc<q&&l<k.range.accend){l<k.range.acc&&(k.range.acc=l);q>k.range.accend&&(k.range.accend=q);B=!0;break}}!B&&(c=pa(l,q),e.terms.push({term:g,range:c}),h=h.index+h[0].length-1,0===a.nextOffset||a.nextOffset>h)&&(a.nextOffset=h)}}if(0===e.terms.length)e=null;else{b=e.terms[0].range;d=e.terms[0].range;e.range=ga(e.terms[0].range);for(c=1;c<e.terms.length;c++)f=e.terms[c].range,f.acc<e.range.acc&&(e.range.acc=f.acc),f.accend>e.range.accend&&(e.range.accend=
f.accend),f.acc<b.acc&&(b=f),f.accend>d.accend&&(d=f);a.lastHit=pa(b.acc,b.accend);e.lastTermACC=d.acc}}return e},l=function(a,b){var d=b.minMatch,c=b.searchTerm,e=b.maxDistance;if(a.length<d||c.length<d)return null;for(var f=0;f<d;f++)if(c.charAt(f)!==a.charAt(f))return null;for(var g=0,h=f,l,q,B,k,v=0;c.length-v>f&&a.length-v>f&&c.charAt(c.length-1-v)===a.charAt(a.length-1-v);)v++;for(var m=a.slice(0,a.length-v),n=c.slice(0,c.length-v);f<n.length;)if(l=n.charAt(f),c=h<m.length?m.charAt(h):0,f++,
h++,l!==c){g++;if(g>e)return null;q=f<n.length?n.charAt(f):0;B=h<m.length?m.charAt(h):0;l===B?(l=f+1<n.length?n.charAt(f+1):0,k=h+1<m.length?m.charAt(h+1):0,q===c&&l===k?(f++,h++):q===c&&l===B?f++:q===k?h++:q===B?(f++,h++):q===c?(f++,h++):(f>=n.length||v)&&h++):q===c?(l=f+1<n.length?n.charAt(f+1):0,h+1<m.length&&m.charAt(h+1),l===B?f++:q===B?(f++,h++):f++):q===B&&(f++,h++)}m.length>h&&(g+=m.length-h);if(g>e)return null;0<d&&d--;e=a.slice(0,d);for(h=d;h<a.length;h++)e+="\ue001";return e},I=new RegExp("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))((?:([1-2][0-9]{3})(?:[[/\\-,\\u0020]+))?(?:(1[0-2]|0?[1-9]|january|jan(?:\\.)?|february|feb(?:\\.)?|march|mar(?:\\.)?|april|apr(?:\\.)?|may|june|jun(?:\\.)?|july|jul(?:\\.)?|august|aug(?:\\.)?|september|sept(?:\\.)?|sep(?:\\.)?|october|oct(?:\\.)?|november|nov(?:\\.)?|december|dec(?:\\.)?)(?:[ \\t]+(?:of|the)[ \\t]+|[/\\-\\u0020]+)((?:3[01]|[12][0-9]|0?[1-9])(?:(?:st|th|rd|nd)?)|(?:(?:thirty[\\- \\t]?)?(?:first|one))|(?:(?:twenty[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:teen)?(?:th)?|seven(?:teen)?(?:th)?|eighth|eight(?:een(?:th)?)?|ninth|nine(?:teen)?(?:th)?))|(?:thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))|((?:3[01]|[12][0-9]|0?[1-9])(?:(?:st|th|rd|nd)?)|(?:(?:thirty[\\- \\t]?)?(?:first|one))|(?:(?:twenty[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:teen)?(?:th)?|seven(?:teen)?(?:th)?|eighth|eight(?:een(?:th)?)?|ninth|nine(?:teen)?(?:th)?))|(?:thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))(?:[ \\t]+(?:of|the)[ \\t]+|[/\\-\\u0020]+)(1[0-2]|0?[1-9]|january|jan(?:\\.)?|february|feb(?:\\.)?|march|mar(?:\\.)?|april|apr(?:\\.)?|may|june|jun(?:\\.)?|july|jul(?:\\.)?|august|aug(?:\\.)?|september|sept(?:\\.)?|sep(?:\\.)?|october|oct(?:\\.)?|november|nov(?:\\.)?|december|dec(?:\\.)?))(?:(?:[ \\t\\-,/]+)(?:((?:[0-9]{2})?[0-9]{2})|((?:(?:(?:(?:(?:twenty|thirty|forty|fifty|sixty|seventy|eighty|ninety)[\\- \\t]?)?(?:first|one|second|two|third|three|four(?:teen)?(?:th)?|fifth|five|six(?:ty)?(?:teen)?(?:th)?|seven(?:ty)?(?:teen)?(?:th)?|eight(?:y)?(?:een)?(?:h)?|ninth|nine(?:ty)?(?:teen)?(?:th)?))|(?:forty|fifty|sixty|seventy|eighty|ninety|thirty|thirtieth|twenty|twentieth|ten(?:th)?|eleven(?:th)?|twelf?th|twelve|thirteen(?:th)?|fifteen(?:th)?))(?:[\\-\\u0020]?(?:hundred|thousand)?(?:and| )*)){1,3})))?)"+
n,"ig"),L=/(\w+)/ig,K=function(a){var b=parseInt(a,10);2==a.length&&(b=50>a?b+2E3:b+1900);return b},H="jan feb mar apr may jun jul aug sep oct nov dec".split(" "),N=function(a){if("0"<=a.charAt(0)&&"9">=a.charAt(0))return parseInt(a);if(2<a.length)return a=a.slice(0,3),a=a.toLowerCase(),H.indexOf(a)+1},C="thousandth hundredth twentieth thirtieth fortieth fiftieth sixtieth seventieth eightieth ninetieth".split(" "),Q="thousand hundred twenty thirty forty fifty sixty seventy eighty ninety".split(" "),
A="zero one two three four five six seven eight nine".split(" "),f="ten eleven twelve thirteen fourteen fifteen sixteen seventeen eighteen nineteen".split(" "),h="zeroth first second third fourth fifth sixth seventh eighth ninth tenth eleventh twelfth thirteenth fourteenth fifteenth sixteenth seventeenth eighteenth nineteenth".split(" "),B=["st","th","rd","nd"],v=function(a,b){for(var d=0;d<b.length;d++)if(0===a.indexOf(b[d]))return d;return-1},J=function(a){result=0;var b,d=0;for(a=a.toLowerCase();a;)if("0"<=
a.charAt(0)&&"9">=a.charAt(0)){for(b=1;b<a.length&&!("0">a.charAt(0)||"9"<a.charAt(0));b++);result=parseInt(a.slice(0,b));a=a.slice(b)}else b=v(a,C),0<=b?a=a.slice(C[b].length):(b=v(a,Q),0<=b&&(a=a.slice(Q[b].length))),0<=b?0==b?(0<d?result-=d:d=1,result+=1E3*d,d=0):1==b?(0<d?result-=d:d=1,result+=100*d,d=0):(result===d&&0<d&&100>d&&(result*=100),d=10*b,result+=d):(b=v(a,h),0<=b?(d=b,result+=b,a=a.slice(h[b].length)):(b=v(a,f),0<=b?(result===d&&0<d&&100>d&&(result*=100),d=b+10,result+=d,a=a.slice(f[b].length)):
(b=v(a,A),0<=b?(d=b,result+=b,a=a.slice(A[b].length)):(b=v(a,B),a=0<=b?a.slice(B[b].length):a.slice(1)))));return result},ca=function(a,b,d,c,e,f,g,h){a=0;b?a=1E4*K(b):g?a=1E4*K(g):h&&(a=1E4*J(h));d&&c?(a+=100*N(d),a+=J(c)):f&&e?(a+=100*N(f),a+=J(e)):a=0;if(1E7>a||2901E4<=a)a=null;return a},w=function(a,b){function d(a,d,c,e){d=d.toLowerCase();if(b.stems)for(e=0;e<b.stems.length;e++)if(d.charAt(0)==b.stems[e].charAt(0)&&(c=b.stemmerFunction(d),c===b.stems[e])){for(a=c.length;a<d.length;a++)c+="\ue000";
return c}if(b.fuzzies)for(e=0;e<b.fuzzies.length;e++)if(c=l(d,b.fuzzies[e]))return c;return a}function c(a,d,c,e,f,p,g,h,l,q,B){if(b.dates)for(c=ca(d,c,e,f,p,g,h,l),i=0;i<b.dates.length;i++)if(c>=b.dates[i].startDate&&c<=b.dates[i].endDate){c="";for(e=0;e<a.length-d.length;e++)c+=a.charAt(e);d=a.length;if(f=a.match(/( and)+$/))d=f.index;for(;e<d;e++)c+="\ue010";for(;e<a.length;e++)c+=a.charAt(e);return c}return a}if(a){if(b.fuzzies&&0<b.fuzzies.length||b.stems&&0<b.stems.length)a=a.replace(L,d);b.dates&&
0<b.dates.length&&(a=a.replace(I,c))}return a};return{findStart:function(a,b,e,f,D,h,l){e=!1===e?"ig":"g";f={type:a,reverse:"up"===f,hits:[],hitIndex:0,lastHit:null,modifier:e,stemAll:!!h,stemmer:l};"number"==typeof D&&(f.startACC=D);if("string"==typeof b)if("dtsearch"===a||"lucene"===a){if(c(b))e=null;else{var p="\\S*(?:\\s+\\S+)",q=!1;D=!1;b.match(r)&&(p="(?:\\s*\\S)",q=!0);b="lucene"===a?d(b,u):d(b,t);var B=null;b&&(B=b.items);var v=[];b={searchType:a,stems:[],fuzzies:[],dates:[],stemAll:f.stemAll,
stemmerFunction:f.stemmer};f.stemmer&&("dtsearch"===f.stemmer?b.stemmerFunction=Cc:"porter"===f.stemmer&&(b.stemmerFunction=Wc));b.stemmerFunction||"dtsearch"!==a||(b.stemmerFunction=Cc);var ja=[],Y=0;l=h=!1;for(var L=!0,J,G,H,K=0;K<B.length;K++)if(G=B[K],0<Y)"OPEN_PAREN"===G.type?Y++:"CLOSE_PAREN"===G.type?(Y--,1===Y&&Y--):1===Y&&"WHITESPACE"!==G.type&&Y--;else{J=!1;if("WORD"===G.type){J=G.value.match(r);v.push("(");v.push("?:");J||v.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))");
v.push("(");!1===L&&v.push("?:");m(v,G.value,!1,b);for(K++;K<B.length;K++)if("WHITESPACE"===B[K].type&&K+1<B.length&&"WORD"===B[K+1].type)"lucene"===a?v.push("|"):v.push("\\s+");else if("WORD"===B[K].type)m(v,B[K].value,!1,b);else{K--;break}v.push(")");J||v.push(n);v.push(")");J=!0}else if("PHRASE"===G.type)J=G.value.match(r),v.push("("),v.push("?:"),J||v.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"),
k(v,G.value.substring(1,G.value.length-1),!0,L,b),J||v.push(n),v.push(")"),J=!0;else if("WHITESPACE"!==G.type)if("WITHIN"===G.type){if(K+1<B.length)if("WI"===G.value.substring(0,2)||"wi"===G.value.substring(0,2))G=Number(G.value.slice(2,G.value.length)),isNaN(G)||(ja.push(v.length),0<G&&G--,G=p+"{0,"+G+"}",q&&(G+="\\s*"),v.push(G));else if("WORD"===B[K+1].type)if(G=Number(B[K+1].value),!isNaN(G))K++,ja.push(v.length),0<G&&G--,G=p+"{0,"+G+"}",q&&(G+="\\s*"),v.push(G);else if("S"===B[K+1].value||"s"===
B[K+1].value)K++,ja.push(v.length),v.push("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)");else if("P"===B[K+1].value||"p"===B[K+1].value)K++,ja.push(v.length),v.push("(?:[^\\u000a\\u000d]*)")}else if("NOT_WITHIN"===G.type)K+1<B.length&&"WORD"===B[K+1].type&&(G=Number(B[K+1].value),isNaN(G)||(K++,ja.push(v.length),L=!1,0<G&&G--,G="(?!("+p+"{0,"+G+"})",q&&(G+="\\s*"),v.push(G)));else if("PRE"===G.type)K+1<B.length&&"WORD"===B[K+1].type&&(G=Number(B[K+1].value),isNaN(G)||(K++,0<G&&G--,G=p+"{0,"+
G+"}",q&&(G+="\\s*"),v.push(G)));else if("MAIL"===G.type)g(v,'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))(@)((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',L),J=!0;else if("MAIL_WITH_PARAM"===G.type)G=G.value.substring(5,G.value.length-1),G=G.replace(/\s+$/,""),1<G.length&&(k(v,G,!1,L,b),J=!0);else if("CREDITCARD"===G.type)g(v,"(?:\\d[ -]*?){13,16}",L),J=!0;else if("CREDITCARD_WITH_PARAM"===G.type)G=G.value.substring(11,G.value.length-
1),G=G.replace(/\s+$/,""),1<G.length&&(k(v,G,!1,L,b),J=!0);else if("VISA_CREDIT_CARD_REGEX"===G.type)g(v,"(4[0-9]{12}(?:[0-9]{3})?)|(4[0-9]{3}-[0-9]{4}-[0-9]{4}-[0-9](?:[0-9]{3})?)",L),J=!0;else if("DATE"===G.type)b.dates.push({startDate:1E7,endDate:2901E4}),v.push("(\ue010+)"),J=!0;else if("DATE_WITH_PARAM"===G.type){var O=G.value.substring(5,G.value.length-1);if(J=I.exec(O))G=J=ca(J[1],J[2],J[3],J[4],J[5],J[6],J[7],J[8]),(O=I.exec(O))&&(G=ca(O[1],O[2],O[3],O[4],O[5],O[6],O[7],O[8])),J&&G&&(J>G&&
(O=J,J=G,G=O),b.dates.push({startDate:J,endDate:G})),v.push("(\ue010+)");J=!0}else"AND"===G.type?v.push("|"):"OR"===G.type?v.push("|"):"NOT"===G.type?Y=1:"AND_NOT"===G.type?Y=1:"OR_NOT"===G.type?Y=1:"AndAny"===G.type?v.push("|"):"XFIRSTWORD"===G.type?(v.push("("),v.push("?:"),v.push("^\\s*"),v.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),v.push(")"),h=J=!0):"XLASTWORD"===G.type?(v.push("("),v.push("?:"),
v.push("\\s*"),v.push("(?:[\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))"),v.push("\\s*$"),v.push(")"),l=J=!0):"DTSEARCH_REGULAREXPRESSION"===G.type?(v.push("("),v.push(G.value.substring(3,G.value.length-1)),v.push(")"),J=!0):"LUCENE_REGULAREXPRESSION"===G.type?(v.push("("),v.push(G.value.substring(1,G.value.length-1)),v.push(")"),J=!0):"OPEN_PAREN"===G.type?(v.push("("),v.push("?:")):"CLOSE_PAREN"===G.type?(v.push(")"),
J=!0):"NUMERICAL_PATTERN"===G.type&&(v.push("("),v.push("?:"),v.push("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]))"),v.push("("),!1===L&&v.push("?:"),J=v,G=G.value.replace(/([\^\(\)\[\]])/g,"\\$1"),G=G.replace(/\s+$/,""),G=G.replace(/[\u0020!@,:;<>\$\+\-\.\\\/\^\{\|\}]+/g,"[\\u0020!@,:;<>\\$\\+\\-\\.\\\\\\/\\^\\{\\|\\}\\(\\)\\*\\?#~\\u2012\\u2013\\u2014\\uFE58\\uFF0D]+"),
G=G.replace(/=/g,"[=\\d]"),J.push("[\\(]?"+G),v.push(")"),v.push(n),v.push(")"),J=!0);if(0<ja.length&&J){O=ja[ja.length-1];H=0;G=O-1;for(var ba=O+1;ba<v.length;ba++)"("===v[ba]?H++:")"===v[ba]&&H--;if(0===H&&")"==v[G])for(;0<=G&&(")"===v[G]?H++:"("===v[G]&&H--,0!==H);G--);J=v[O];if(0===H&&"(?!("===J.substring(0,4))v.push(")");else if(0===H){D=!0;v.push(")");v.push("|");v.push("(");v.push("?:");for(var C=[],L=O+1;L<ba;L++)if(v.push(v[L]),"^\\s*"===v[L])for(C.push("^\\s*"),H=G;H<O;H++)C.push(v[H]);
else if("\\s*$"===v[L]){for(H=G;H<O;H++)C.push(v[H]);C.push("\\s*$")}v.push(v[O]);for(L=G;L<O;L++)if(v.push(v[L]),"^\\s*"===v[L])for(C.push("^\\s*"),H=O+1;H<ba;H++)C.push(v[H]);else if("\\s*$"===v[L]){for(H=O+1;H<ba;H++)C.push(v[H]);C.push("\\s*$")}v.push(")");if(C.length)for(v.push("|"),H=0;H<C.length;H++)v.push(C[H]);v.push(")");v.push(" ");v.push(" ");v.push(" ");v.push(" ");for(L=v.length;L>G+4;L--)v[L-1]=v[L-5];v[G]="(";v[G+1]="?:";v[G+2]="(";v[G+3]="?:";if("(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===
J||"(?:[^\\u000a\\u000d]*)"===J)for(L=G;L<v.length;L++)if(v[L]===J)for(L++;L<v.length;L++)if("(?:^|(?:[\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]{1,256}))"===v[L]){v[L]="(?:[^\\u0021\\u002E\\u003F\\u000a\\u000d\\u3002]*)"===J?"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002D\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))":
"(?:^|(?:[\\u0009\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60]+))";break}ja.pop();L=!0}}}v=v.join("");1==B.length&&(h?v="^\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))":l&&(v="\\s*([\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]|(?:[^\\s\\u2E80-\\uD7AF\\uF900-\\uFAFF\\uFE30-\\uFE4F\\u0E00-\\u0EFF]+))\\s*$"));
a=null;if(0!==v.length)try{a=new RegExp(v,e)}catch(Xb){}p=e=a;h?p=a=null:l&&(e=a=null);0===b.stems.length&&0===b.fuzzies.length&&0===b.dates.length&&(b=null);e={regex:a,first:e,last:p,searchParameters:b,checkForMultipleMatches:D}}f.regex=e}else{D=null;x.normalizeAccentsForSearch&&(b=fc(b));if(!1===c(b)||"literal"===a)b=b.replace(/([\^\$\+\?\.\|\(\)\{\}\[\]\\])/g,"\\$1"),b=b.replace(/^\s+/,""),b=b.replace(/\s+$/,""),b=b.replace(/['\u0060\u00B4\u2018\u2019]/g,"['\\u0060\\u00B4\\u2018\\u2019]"),b=b.replace(/[\"\u201C\u201D\u030B\u030F]/g,
'[\\"\\u201C\\u201D\\u030B\\u030F]'),b=b.replace(/\s+/g,"\\s+"),"phsterms"===a||"string"===a?(a=b.replace(/\*/g,"[^\\s\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122]*"),D=b.replace(/\*/g,r+"*"),D=new RegExp("(?:^|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])("+a+")(?=$|\\s|[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u007F-\\u00BF\\u2000-\\u207F\\u2219\\u2580-\\u25FF\\u2120\\u2122\\u3001\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60])|(?="+
r+")("+D+")",e)):"literal*"===a?(b=b.replace(/\*/g,"[^\\s]*"),D=new RegExp("("+b+")",e)):"literal"===a&&(b=b.replace(/\*/g,"\\*"),D=new RegExp("("+b+")",e));f.regex={regex:D}}else b instanceof RegExp&&(f.regex={regex:b});return f},findNext:function(a,b){if(a.regex){if(void 0===a.blockIndex){if(void 0!==a.startACC){var d;a:{d=a.startACC;for(var c=0;c<b.length;c++){var e=b[c].range;if(d>=e.acc&&d<e.accend){d=c;break a}if(c==b.length-1&&(d=e.accend)){d=c;break a}}d=void 0}a.blockIndex=d}if(void 0===
a.blockIndex)if(a.reverse){if(ha.isPending())return;a.blockIndex=b.length-1}else a.blockIndex=0}for(;;){if(a.hitIndex>=a.hits.length){a.hits=[];a.hitIndex=0;for(d=a.reverse?0:b.length;0===a.hits.length;){c=b[a.blockIndex];if(!c)break;if(!c.text)break;var f,e=0;f=a.regex.searchParameters;var g=a.regex.regex;a.regex.last&&!ha.isPending()&&a.blockIndex==b.length-1&&(g=a.regex.last);a.regex.first&&0===a.blockIndex&&(g=a.regex.first);if(g){var h=c.text;for(f&&(h=w(c.text,f));(f=g.exec(h))&&""!==f[0];){var l=
c.range.acc+f.index;a.nextOffset=0;if(!a.lastHit||l>a.lastHit.acc){var B=q(a,f,l);if(B){if("dtsearch"===a.type||"lucene"===a.type){for(var v=B.lastTermACC-l,k=null;0<v;){var v=f[0].substring(0,v),m=g.source,n="";g.global&&(n+="g");g.ignoreCase&&(n+="i");g.multiline&&(n+="m");v=(new RegExp(m,n)).exec(v);if(!v||""===v[0])break;v=q(a,v,l+v.index);if(!v)break;k||(k=[]);k.push(v);v=v.lastTermACC-l}if(k)for(l=k.length-1;0<=l;l--)a.hits.push(k[l])}a.hits.push(B)}}f.index>e&&(e=f.index);e+=a.nextOffset+1;
g.lastIndex=e}}if(a.blockIndex==d)break;a.blockIndex+=a.reverse?-1:1}a.reverse&&(a.hits=a.hits.reverse())}if(a.hitIndex>=a.hits.length)break;for(;a.hitIndex<a.hits.length;){d=a.hits[a.hitIndex];c=!0;void 0!==a.startACC&&(c=a.reverse?d.range.acc<=a.startACC:d.range.acc>=a.startACC);if(c&&z.isDocumentText(d.range.acc,d.range.accend-1))return a.hitIndex++,d;if(c&&ha.isPending())return;a.hitIndex++}}}}}}(),ia=Aa.extend("rawtext",{events:{add:{}},install:function(c){var e=/(\r\n|\r|\n)/g,a=/\s/g,b=[],
d,g,k=function(){if(void 0===d)for(var a=d=0;a<b.length;a++)b[a].text&&d++;return d};c.findStart=function(a,b,d,c,e,g,k){return Fc.findStart(a,b,d,c,e,g,k)};c.findNext=function(a){return Fc.findNext(a,b)};c.findBoundaryStart=function(d,c){var g;if(0<b.length){var l="line"===c?e:a;l.lastIndex=0;for(var q=r(d);void 0!=q;){var k=b[q];if(!k.text)break;for(var m;m=l.exec(k.text);){m=k.range.acc+m.index;if(m>d)break;g=m+1}if(void 0!==g)break;if(0===q)break;q--}}void 0===g&&(g=d);return g};c.findBoundaryEnd=
function(d,c){var g;if(0<b.length){var l="line"===c?e:a;l.lastIndex=0;for(var q=r(d);void 0!=q;){var k=b[q];if(!k.text)break;for(var m;m=l.exec(k.text);)if(m=k.range.acc+m.index,m>d){g=m;break}if(void 0!==g)break;if(q+1>=b.length)break;q++}}void 0===g&&(g=d);return g};c.firstACC=function(){if(0<b.length)return b[0].range.acc};c.lastACC=function(){if(0<b.length)return b[b.length-1].range.accend};c.hasRawText=function(){if(0<b.length)return!0;if(!ha.isPending())return!1};c.isPending=function(){return ha.isPending()?
!0:k()<b.length};c.getRawTextBlock=function(a){if(0<=a&&a<b.length)return a=b[a],a.text||t(a),a};var m=function(){var a=r(this.acc),d=r(this.accend);if(void 0===a||void 0===d)c.isPending()?(c.onadd(this,m),ha.onadd(this,m)):(c.offadd(this,m),ha.offadd(this,m),this.callback());else{for(var e=0,g=a;g<=d;g++){var k=b[g];!k.text&&k.src?t(k,m,this):e++}e==d-a+1&&(c.offadd(this,m),ha.offadd(this,m),this.callback())}};c.loadRawText=function(a,b,d){m.call({acc:a,accend:b,callback:d})};c.getRawText=function(a,
d){for(var c=r(a),e=r(d),g;c<=e;c++){var l=b[c];if(!l.text){g=void 0;break}var k=a-l.range.acc;0>k&&(k=0);var q=d-l.range.acc;q>l.text.length&&(q=l.text.length);l=l.text.substring(k,q);g=g?g+l:l}return g};var r=function(a){for(var d=0;d<b.length;d++){var c=b[d].range;if(a>=c.acc&&a<c.accend||d==b.length-1&&(a=c.accend))return d}},t=function(a,b,d){if(!a.text&&a.src){if(b){a.callbacks||(a.callbacks=[]);for(var c=!1,e=0;e<a.callbacks.length;e++)if(a.callbacks[e].func==b&&a.callbacks[e].context==d){c=
!0;break}c||a.callbacks.push({func:b,context:d})}a.loading||(b=Sa(w.baseURL,a.src),k(),a.loading=!0,ab({url:b,complete:u,args:[a]}))}else b&&b.call(d,a)},u=function(a,e,g,k,m){m.loading=!1;200==k?ha.isICD(g)?ha.processContentData(g):(m.text=g,n(m)):(m.text="",c.logAJAXError(null,"Failed to load a document text block from the server",a,k,g));d++;e=b.indexOf(m);a=b[e-1];e=b[e+1];a&&a.text&&(m.text=a.text.substr(a.text.length-2048,2048)+m.text,m.range.acc-=2048);e&&e.text&&(e.text=m.text.substr(m.text.length-
2048,2048)+e.text,e.range.acc-=2048);if(m.callbacks){for(a=0;a<m.callbacks.length;a++)m.callbacks[a].func.call(m.callbacks[a].context,m);delete m.callbacks}200==k&&c.on.add.dispatch(m.range.acc,m.range.accend)};c.replaceRawText=function(a){if(a&&(g=g?g.concat(a):a,0<b.length))for(a=0;a<b.length;a++)n(b[a])};var n=function(a){if(g&&g.length&&a.text)for(var b,d=a.range.acc,c=a.range.acc+a.text.length,e=0;e<g.length;e++)if(b=g[e],b.acc<=c&&b.accend>=d){var k=b.acc-d;0>k&&(k=0);b=b.accend-d;b>a.text.length&&
(b=a.text.length);for(var q=b-k,m="";0<q--;)m+=" ";a.text=a.text.substr(0,k)+m+a.text.substr(b)}a.text&&x.normalizeAccentsForSearch&&(a.text=fc(a.text))};E.onreset(function(){g=d=void 0;b=[]});ha.ondata(function(a,d,c){if(a.text)for(d=0;d<a.text.length;d++){c=a.text[d];n(c);for(var e=0;e<b.length;e++)if(0===Na(c.range,b[e].range)){b[e].text=c.text;c=null;break}c&&(b.push(c),t(c))}})}}),gc,xa,pa,Mb,mb,sa,Cb,va,Na,Gc,gb,ga,Hc,hc,Nb,rb,Db;(function(){var c=function(c,a){return c.acc-a.acc};gc=function(c){return!!xa(c,
!1,!1)};xa=function(c,a,b){var d;if(c&&c.type)switch(c.type){case "text":fa(c.acc)&&fa(c.accend)&&(d=c);d&&b&&(c=z.forRange(d,0,!0))&&c.isEmailHeader()&&(c=z.findTextRange(d))&&(c=c[0].startContainer)&&(y.isText(c)||y.isElement(c))&&(c=La(c),c=mb(c))&&(Array.isArray(c)&&(c=pa(c[0].acc,c[c.length-1].accend)),d.acc<c.acc||d.accend>c.accend)&&(d=ga(d),d.acc<c.acc&&(d.acc=c.acc),d.accend>c.accend&&(d.accend=c.accend));break;case "cell":if(fa(c.page)&&fa(c.c1)&&fa(c.r1)&&fa(c.c2)&&fa(c.r2)&&(d=c,0>d.page?
d=void 0:d.page<z.count()?(b=z.page(d.page))&&"worksheet"!==b.type&&"database"!=b.type&&(d=void 0):d.offsets&&(fa(d.offsets.left)&&fa(d.offsets.top)&&fa(d.offsets.right)&&fa(d.offsets.bottom)||(d=void 0)),d&&!0===a&&(b=z.page(c.page)))&&(b=b.spreadsheetModel())){var e=b.colCount()-1;a=b.rowCount()-1;if(c.c1>e||0>c.c2||c.r1>a||0>c.r2)d=void 0;else{b=na(c.c1,0,e);var e=na(c.c2,0,e),k=na(c.r1,0,a);a=na(c.r2,0,a);if(b!==c.c1||e!==c.c2||k!==c.r1||a!==c.r2)d=ga(c),d.c1=b,d.c2=e,d.r1=k,d.r2=a}}break;case "rect":if(fa(c.page)&&
fa(c.left)&&fa(c.top)&&fa(c.right)&&fa(c.bottom)&&Ia(c.units)&&("px"===c.units||"tw"===c.units||"pct"===c.units)&&(d=c,"pct"!==c.units||fa(c.embedId)?0>d.page?d=void 0:void 0===c.embedId&&d.page<z.count()&&(b=z.page(d.page))&&"page"!==b.type&&"drawing"!==b.type&&"slide"!==b.type&&"chart"!==b.type&&"bitmap"!==b.type&&"email"!==b.type&&"html"!==b.type&&"rt"!==b.type&&"sn"!==b.type&&(d=void 0):d=void 0,d&&void 0===c.embedId&&!0===a&&(b=z.page(c.page))&&(a=b.pageRect())))if(c.left>a.right||c.right<a.left||
c.top>a.bottom||c.bottom<a.top)d=void 0;else{var e=na(c.left,a.left,a.right),k=na(c.top,a.top,a.bottom),m=na(c.bottom,k,a.bottom),r=c.right;"html"!==b.type&&(r=na(c.right,e,a.right));if(e!=c.left||r!=c.right||k!=c.top||m!=c.bottom)d=ga(c),d.left=e,d.right=r,d.top=k,d.bottom=m}}return d};pa=function(){var c=arguments,a,b;switch(c.length){case 2:fa(c[0])&&fa(c[1])&&(a=c[0],b=c[1]);break;case 1:if(fa(c[0]))a=c[0],b=c[0];else if(Ra(c[0])||Ba(c[0])){if(c=mb(c[0]))Array.isArray(c)?(a=c[0].acc,b=c[c.length-
1].accend):(a=c.acc,b=c.accend)}else if((c=xa(c[0]))&&"cell"===c.type){var d=z.page(c.page);if(d&&("worksheet"===d.type||"database"===d.type)&&(d=d.spreadsheetModel()))return d.mapToText(c)}}var g;fa(a)&&fa(b)&&(g=new OIT.TextRange(a,b));return g};Mb=function(c,a){c=y.unwrap(c);a=a||0;var b;a:{if(1===c.nodeType&&c.childNodes&&(b=c.childNodes[a]))break a;b=void 0}b&&(c=b,a=0);var d;b=w.viewNode;for(var e=c;e;e=e.parentNode){var k=y.data(e,"acc");if(void 0!==k){"none"!==k&&(d=y.wrap(e));break}if(e===
b)break}if(b=d){d=parseInt(b.data("acc"),10);if(!b.equals(c))for(b=b.createTreeWalker(),e=b.firstACCNode();e;){e=b.currentNode;if(e===c)break;1===e.nodeType?(e=y.data(e,"acc"))&&(d=parseInt(e,10)):3===e.nodeType&&(d+=e.nodeValue.length);e=b.nextACCNode()}return d+a}};mb=function(c){var a;Ra(c)?a=c:Ba(c)&&"number"===typeof c.rangeCount&&0<c.rangeCount?a=c.getRangeAt(0):y.isElement(c)&&(a=V.createRange(),a.selectNode(y.unwrap(c)));if(a){c=a.startContainer;var b=a.startOffset,d=a.endContainer,e=a.endOffset,
k,m;if(c===d){k=Mb(c,b);if(b===e)return pa(k,k);if(y.isText(c))return pa(k,k+e-b)}for(var r=a.commonAncestorContainer;r&&!y.isElement(r);)r=r.parentNode;r=y.wrap(r);a=Mb(r);var t=[],u,r=r.createTreeWalker();k=r.firstACCNode();for(var n=!1,q=!1,l=!1;k;){var I=r.currentNode;I===c&&y.isText(c)?n=!0:n||I.parentNode!==c||(q=!0,0!==b&&y.nodeIndex(I)!=b)||(n=!0);q&&!n&&(y.isDescendantOf(I,c)||(n=!0));if(l&&!y.isDescendantOf(I,d))break;1===I.nodeType?(k=y.data(I,"acc"))&&(a="none"===k?void 0:Number(k)):3===
I.nodeType&&void 0!==a&&(n&&0<I.nodeValue.length&&(k=a,I===c&&(k+=b),m=a+I.nodeValue.length,I===d&&(m=a+e),u&&u.accend!=a&&u.accend!=a-1&&(u=null),u?u.accend=m:(u=pa(k,m),t.push(u))),a+=I.nodeValue.length);if(I===d&&y.isText(d))break;else if(I.parentNode===d&&(l=!0,0===e||y.nodeIndex(I)>=e))break;k=r.nextACCNode()}t=Hc(t);0===t.length?t=void 0:1==t.length&&(t=t[0]);return t}};sa=function(){var c,a,b,d,g,k,m,r=arguments;switch(r.length){case 9:a=r[0];b=r[1];d=r[2];g=r[3];k=r[4];m={left:r[5],top:r[6],
right:r[7],bottom:r[8]};break;case 5:a=r[0];b=r[1];d=r[2];g=r[3];k=r[4];break;case 4:b=r[0];d=r[1];g=r[2];k=r[3];break;case 3:a=r[0];b=r[1];d=r[2];g=r[1];k=r[2];break;case 2:b=r[0];d=r[1];g=r[0];k=r[1];break;case 1:if((r=xa(r[0]))&&"text"===r.type&&(c=z.forRange(r))&&("worksheet"===c.type||"database"===c.type)&&(c=c.spreadsheetModel()))return c.mapToCells(r)}if(void 0===a)a=z.current();else if(Ia(a)){if(c=z.byName(a))a=c.index}else if(fa(a)){if(0>a||a>=z.count())a=void 0}else a=void 0;var t;fa(a)&&
fa(b)&&fa(d)&&fa(g)&&fa(k)?t=new OIT.CellRange(a,b,d,g,k,m):E.invalidArg("cellRange");return t};Cb=function(){var c,a,b,d,g,k,m="px",r=arguments;if(2<=r.length&&6>=r.length){var t=0;if(Ia(r[t])){var u=z.byName(r[t]);u&&(a=u.index,t++)}for(var u=0,n=t;n<r.length;n++)if(fa(r[n]))u++;else break;switch(u){case 6:c=r[t++];case 5:a=r[t++];case 4:b=r[t++];d=r[t++];g=r[t++];k=r[t++];break;case 3:a=r[t++];case 2:b=r[t++],d=r[t++],g=b,k=d}t<r.count&&Ia(r[t])&&(m=r[t++])}if(void 0===a)a=z.current();else if(fa(a)){if(0>
a||a>=z.count())a=void 0}else a=void 0;var q;fa(a)&&fa(b)&&fa(d)&&fa(g)&&fa(k)&&("px"===m||"tw"===m||"pct"===m)?q=new OIT.RectRange(c,a,b,d,g,k,m):E.invalidArg("rectRange");return q};va=function(c,a){if(c&&"rect"===c.type&&c.units!==a){var b,d,e;switch(a){case "px":"tw"===c.units?(b=z.page(c.page))&&b.dpi&&(c.left=M(c.left*b.dpi/1440,1E4),c.top=M(c.top*b.dpi/1440,1E4),c.right=M(c.right*b.dpi/1440,1E4),c.bottom=M(c.bottom*b.dpi/1440,1E4),c.units="px"):"pct"===c.units&&void 0!==c.embedId&&(b=z.page(c.page))&&
(b=b.embeddingRect(c.embedId))&&(d=b.width/100,e=b.height/100,c.left=M(c.left*d,1E4),c.right=M(c.right*d,1E4),c.top=M(c.top*e,1E4),c.bottom=M(c.bottom*e,1E4),c.units="px");break;case "tw":"px"===c.units&&(b=z.page(c.page))&&b.dpi&&(c.left=M(1440*c.left/b.dpi,1E4),c.top=M(1440*c.top/b.dpi,1E4),c.right=M(1440*c.right/b.dpi,1E4),c.bottom=M(1440*c.bottom/b.dpi,1E4),c.units="tw");break;case "pct":if("px"===c.units&&(b=z.page(c.page))){if(void 0!==c.embedId){if(b=b.embeddingRect(c.embedId))d=100/b.width,
e=100/b.height}else e=b.pageRect(),d=100/e.width,e=100/e.height;void 0!==d&&(c.units="pct",c.left=M(c.left*d,1E4),c.right=M(c.right*d,1E4),c.top=M(c.top*e,1E4),c.bottom=M(c.bottom*e,1E4))}}}};Na=function(c,a){if(!c)return a?-1:0;if(!a)return 1;if(c.page<a.page)return-1;if(c.page>a.page)return 1;if(c.type===a.type)switch(c.type){case "text":return c.acc<a.acc?-1:a.acc<c.acc?1:c.accend<a.accend?-1:a.accend<c.accend?1:0;case "cell":if(c.r1<a.r1)return-1;if(a.r1<c.r1)return 1;if(c.c1<a.c1)return-1;if(a.c1<
c.c1)return 1;if(c.r2<a.r2)return-1;if(a.r2<c.r2)return 1;if(c.c2<a.c2)return-1;if(a.c2<c.c2)return 1;if(c.offsets)if(a.offsets){if(c.offsets.top<a.offsets.top)return-1;if(c.offsets.top>a.offsets.top)return 1;if(c.offsets.left<a.offsets.left)return-1;if(c.offsets.left>a.offsets.left)return 1;if(c.offsets.bottom<a.offsets.bottom)return-1;if(c.offsets.bottom>a.offsets.bottom)return 1;if(c.offsets.right<a.offsets.right)return-1;if(c.offsets.right>a.offsets.right)return 1}else return 1;else if(a.offsets)return-1;
return 0;case "rect":return c.units!=a.units&&(a=ga(a),va(a,c.units)),c.top<a.top?-1:a.top<c.top?1:c.left<a.left?-1:a.left<c.left?1:c.bottom<a.bottom?-1:a.bottom<c.bottom?1:c.right<a.right?-1:a.right<c.right?1:0}};Gc=function(c,a){if(c.type===a.type)switch(c.type){case "text":return a.acc>=c.acc&&a.accend<=c.accend}return!1};gb=function(c,a){if(c&&a&&a.type===c.type)switch(a.type){case "text":return c.accend>a.acc&&c.acc<a.accend;case "cell":return c.c2>=a.c1&&c.c1<=a.c2&&c.r2>=a.r1&&c.r1<=a.r2;case "rect":return c.right>=
a.left&&c.left<=a.right&&c.bottom>=a.top&&c.top<=a.bottom}return!1};ga=function(c){var a;if(c)switch(c.type){case "text":a=new OIT.TextRange(c.acc,c.accend);break;case "cell":a=new OIT.CellRange(c.page,c.c1,c.r1,c.c2,c.r2);!0===c.selectingCols&&(a.selectingCols=!0);!0===c.selectingRows&&(a.selectingRows=!0);c.offsets&&(a.offsets={left:c.offsets.left,top:c.offsets.top,right:c.offsets.right,bottom:c.offsets.bottom});break;case "rect":a=new OIT.RectRange(c.embedId,c.page,c.left,c.top,c.right,c.bottom,
c.units,c.section)}return a};Db=function(c,a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)c=Db(a[b],c);else if(!c)c=ga(a);else if(c.type===a.type)switch(c.type){case "cell":a.c1<c.c1&&(c.c1=a.c1);a.r1<c.r1&&(c.r1=a.r1);a.c2>c.c2&&(c.c2=a.c2);a.r2>c.r2&&(c.r2=a.r2);break;case "text":a.acc<c.acc&&(c.acc=a.acc),a.accend>c.accend&&(c.accend=a.accend)}return c};Hc=function(e){if(e&&1<e.length){e.sort(c);for(var a=[],b,d=0;d<e.length;d++){var g=e[d];b&&3>g.acc-b.accend?g.accend>b.accend&&(b.accend=
g.accend):(b=g,a.push(g))}e=a}return e};hc=function(c){if(1===c.length)return c[0];if(1<c.length){var a=c[0],b=V.createRange();b.setStart(a.startContainer,a.startOffset);b.setEnd(a.endContainer,a.endOffset);for(var a=La(a.startContainer),d=1;d<c.length;d++){var e=c[d],k=La(e.endContainer);y.unwrap(k)==y.unwrap(a)&&b.setEnd(e.endContainer,e.endOffset)}return b}};Nb=function(c){if(c=xa(c))switch(c.type){case "text":return c.acc==c.accend;case "cell":return!1;case "rect":return c.left==c.right||c.top==
c.bottom}return!0};rb=function(c){if(c)switch(c.type){case "cell":var a=[];a.push(Ma(c.c1),c.r1+1);c.c2==c.c1&&c.r2==c.r1||a.push(":",Ma(c.c2),c.r2+1);return a.join("")}}})();var F=Aa.extend("display",{events:{displayload:{},displayunload:{}},install:function(c){var e={zoom:!1,rotate:!1,showhidden:!1,pages:!1,fitpage:!1,highlights:!1,textselection:!1,rectselection:!1,rectredaction:!1,cellselection:!1,customtextselection:!1,anchorednotes:!1},a=null,b=null,d=e,g=!1,k;c.loadDisplay=function(e){c.unloadDisplay();
var g=e.type;e.overlay&&e.overlay.firstPage&&(g=e.overlay.firstPage.type);if(a=Ha.createDisplay(g))b=e.overlay,w.deType=g,d=Ha.features(g),w.drawing.resetOrigin(),a.init(e),c.on.displayload.dispatch(b.firstPage,b.lastPage)};c.unloadDisplay=function(){a&&(c.on.displayunload.dispatch(b.firstPage,b.lastPage),a.unload(),b=a=null,w.deType=null);d=e};c.features=function(){var a=d;if("vertical"!==x.scrollMode){var b=z.activePage();b&&(a=Ha.features(b.type))}return a};c.isSelectionModeSupported=function(a){var b=
!1;switch(a){case "none":b=!0;break;case "text":c.features().textselection&&(b=!0);break;case "rect":c.features().rectselection&&(b=!0);break;case "cell":c.features().cellselection&&(b=!0)}return b};c.isHighlightModeSupported=function(a){var b=c.isSelectionModeSupported(a);b||"text"!==a||"worksheet"!==w.deType&&"database"!==w.deType||(b=!0);return b};c.visiblePages=function(){return a?a.visiblePages():[]};c.startElasticScroll=function(){if(a)return a.startElasticScroll()};c.elasticScroll=function(b,
c){if(a)return a.elasticScroll(b,c)};c.endElasticScroll=function(b,c){if(a)return a.endElasticScroll(b,c)};c.saveScrollPos=function(){if(a)return a.saveScrollPos()};c.restoreScrollPos=function(b){a&&a.restoreScrollPos(b)};c.maxPageWidth=function(){if(a)return a.maxPageWidth()};c.maxPageHeight=function(){if(a)return a.maxPageHeight()};c.padding=function(){if(a)return a.padding()};c.scrollPadding=function(){if(a)return a.scrollPadding()};c.margin=function(){if(a)return a.margin()};c.scrollOffset=function(){if(a)return a.scrollOffset()};
c.keydown=function(b){return a?a.keydown(b):!0};c.showHidden=function(b){a&&a.showHidden(b)};c.loadRange=function(b,c){a&&a.loadRange(b,c)};c.expandRange=function(b){a&&(b=a.expandRange(b));return b};c.moveto=function(b,c,d){return a?a.moveto(b,c,d||{}):!1};c.getSelectedText=function(){return a?a.getSelectedText():""};c.select=function(b){return a?a.select(b):!1};c.pageRange=function(c,d){if(a&&b.containsPage(c))return a.pageRange(c,d)};c.pageRect=function(c,d){if(a&&b.containsPage(c))return a.pageRect(c,
d)};c.rangeRect=function(c,d,e,g){if(a&&("text"===c.type||b.containsPage(c.page)))return a.rangeRect(c,d,e,g)};c.rangeFromRect=function(c,d,e,g,k,q,l,I){if(a&&b.containsPage(c))return a.rangeFromRect(c,d,e,g,k,q,l,I)};c.extendRange=function(b,c,d,e){if(a)return a.extendRange(b,c,d,e)};c.moveAnchor=function(b,c,d,e){return a?a.moveAnchor(b,c,d,e):!1};c.incrementSelection=function(b,c,d,e,g){return a?a.incrementSelection(b,c,d,e,g):!1};c.suspendUpdate=function(){g||(g=!0)};c.resumeUpdate=function(){g&&
(g=!1,c.update())};c.layoutChanged=function(b){a&&a.layoutChanged(b)};c.update=function(b,d){if(!g)if(!0===d)k&&ta(k),k=da(c.update,50,this,b,!1);else if(a)return a.update(b);return!1};c.activeOverlay=function(){return b};E.onreset(c.unloadDisplay);Dc.onfontload(function(){c.update(!0)})}}),S=Aa.extend("selection",{events:{beginselection:{},selectionchanged:{}},install:function(c){var e=null,a=!0,b,d=null,g=!0,k=!1,m=!0,r=!1,t,u,n,q,l,I,L,K,H,N,C,Q=0,A,f,h,B=0,v,J,ca=0,X=0,ma,O,ba,p=[],D,ja,Y,oa;
c.reset=function(){c.select(null);x.selectionMode=c.validateMode(x.selectionMode)};c.style=function(a,b){g=!1===b?!1:!0;null!==a&&"string"!==typeof a||a===d||(d=a,e=ib(d),Da(),ea());return d};c.isSelecting=function(){return r};var Da=function(a){if(!a&&e){a="";e.color&&(a+="color:"+e.color+";");var b=e["background-color"];b&&(a+="background-color:"+b+";")}a&&0<a.length?(D||(D=y.create("style"),D.type="text/css",y.byTagName("head")[0].append(D)),D.html(".oit-view ::selection, .oit-annopane ::selection { "+
a+"}")):D&&D.html("")},ea=function(){if(u){var a=u.selectionRect();a.resetStyle();e?(a.removeClass("oit-sel-rect"),a.css(e)):a.addClass("oit-sel-rect");a.update()}};c.textSelection=function(){if(n){if("text"===n.type)return ga(n);if("cell"===n.type)return pa(n)}};c.cellSelection=function(){if(n&&"cell"===n.type)return ga(n)};c.rectSelection=function(){if(n&&"rect"===n.type)return ga(n)};c.selectionType=function(){return n?n.type:"none"};c.hide=function(d){a=!1;b=d;Ac("firefox")?c.select(null):b?Da(b):
Da("background-color: rgba(255,255,255,0);");u&&u.showSelectionRect(!1)};c.select=function(d,f,e,p){var g=!1;a=!0;b=null;if(null===d)g=!!n,la(),c.update();else if(d)if(Ba(d)||Ra(d))g=c.select(pa(d));else if(d=xa(d),!d||d.selectingRows||d.selectingCols||!1===d.autoExpand||(d=F.expandRange(d)),d&&0!==Na(d,n)){var h=z.forRange(d,0,!0);h&&(g=!0,c.on.beginselection.dispatch(d),la(),u=h,n=ga(d),t=ga(d),ea(),c.update())}if(g||f!==oa)c.on.selectionchanged.dispatch(n,!0),oa=f,E.on.select.dispatch(n,e||null,
p||null,Nb(n),f)&&(w.drawing&&w.drawing.update(!0),n&&void 0===f&&(d=F.rangeRect(n,"view"),"text"===n.type&&c.update(),d&&P.activateNearest(d.left,d.top)));return g};c.saveSelection=function(){if(!n)return null;var c={range:ga(n)};a||(c.visible=!1,c.hideStyle=b);return c};c.restoreSelection=function(a){if(a){var b=a.range,d=z.forRange(b,0,!0);d&&(c.on.beginselection.dispatch(b),la(),u=d,n=ga(b),t=ga(b),ea(),c.update(),a.visible||c.hide(a.hideStyle))}};c.startRectSelection=function(d,f,e){la();z.deactivateAnnotation();
r=!0;F.isSelectionModeSupported("text")||P.startSelection();e=z.mapToPage(d,f,null,!0);c.logRect&&c.logRect(e.page,e.x,e.y,!0);q={x:d,y:f};u=e.page;L=e.x;K=e.y;H=d;N=f;a=I=!0;b=null;n=F.rangeFromRect(u.index,L,K,L,K,u,"select");"cell"!==n.type||k||delete n.offsets;t=ga(n);c.on.beginselection.dispatch(n);ea();c.update();c.on.selectionchanged.dispatch(n,!1);return!0};c.extendRectSelection=function(a,b,d){t&&(I&&(d=Math.abs(b-N),2<Math.abs(a-H)||2<d)&&(I=!1,F.isSelectionModeSupported("text")&&P.startSelection()),
wa(l,a,b),a=z.mapToPage(a,b,u,!0),c.logRect&&c.logRect(a.page,a.x,a.y),n=F.extendRange(t,a.x,a.y,a.page),m&&(n=xa(n,!0)),c.update(),c.on.selectionchanged.dispatch(n,!1))};c.endRectSelection=function(a,b,d){qa();r=!1;c.extendRectSelection(a,b);c.on.selectionchanged.dispatch(n,!0);var f={x:a,y:b},e=I;oa=void 0;E.on.select.dispatch(n,q,f,I)&&"rect"===x.selectionMode&&c.select(null);e&&d&&(f=y.wrap(d.target),f.isDescendantOf(z.activeOverlay())||f.isDescendantOf(w.drawing))&&((f=z.activePage())&&f.isSpreadsheet()?
P.activateNearest(a,b,d,!0):(a=P.findNearest(a,b))&&0===a.distance.ax&&0===a.distance.ay||P.deactivate());P.endSelection()};c.cancelRectSelection=function(a,b){qa();c.select(null)};c.startTouchTextSelection=function(d,f){a=!0;b=null;ja&&c.abortTouchTextSelection();r=!0};c.updateTouchTextSelection=function(){var a=R.getSelection();!a.anchorNode||Y&&Y.anchorNode==a.anchorNode&&Y.anchorOffset==a.anchorOffset&&Y.focusNode==a.focusNode&&Y.focusOffset==a.focusOffset||(Y||(Y={}),Y.anchorNode=a.anchorNode,
Y.anchorOffset=a.anchorOffset,Y.focusNode=a.focusNode,Y.focusOffset=a.focusOffset,ja=pa(a))};c.abortTouchTextSelection=function(){ja=null;r=!1};c.startTextSelection=function(d,e,p,g){la();r=!0;h=C=null;l=y.wrap(g.target);a=!0;b=null;q={x:d,y:e};I=!0;H=d;N=e;if(!F.features().customtextselection)return!1;d=z.mapToPage(d,e,null,!0,!0);d.inAnnotation||z.deactivateAnnotation();e=d.page.mapPointToText(d.x,d.y,null,d.inAnnotation);if(!e||!e.overlaps)return!1;J=d;f=La(e.node);var D;if("line"===p||"word"===
p)D=d.page.findTextBoundary(e.node,e.offset,p);D?(v=p,A=D,C=A.startContainer,Q=A.startOffset,h=A.endContainer,B=A.endOffset):(v=void 0,C=e.node,Q=e.offset,h=e.node,B=e.offset);if(C&&h&&(c.update(),y.selectRange(C,Q,h,B),p=R.getSelection(),p.anchorNode&&p.focusNode))if(p=pa(p))c.on.beginselection.dispatch(p);else return h=C=null,!1;return!0};c.extendTextSelection=function(a,b,c){if(!F.features().customtextselection)return!1;I&&(c=Math.abs(b-N),2<Math.abs(a-H)||2<c)&&(I=!1,F.isSelectionModeSupported("text")&&
P.startSelection());wa(l,a,b);c=null;var d=!1;J&&J.inAnnotation&&(c=J.page,d=!0);a=z.mapToPage(a,b,c,!0,!0,d);b=a.page.mapPointToText(a.x,a.y,f,a.inAnnotation);if(!b)return!1;if(b.node!=h||b.offset!=B){if(v){if(b=a.page.findTextBoundary(b.node,b.offset,v))a=b.compareBoundaryPoints(Range.START_TO_START,A),-1==a?(h=b.startContainer,B=b.startOffset,C=A.endContainer,Q=A.endOffset):(C=A.startContainer,Q=A.startOffset,h=b.endContainer,B=b.endOffset)}else h=b.node,B=b.offset;C&&h&&(C==h?Q>B?y.selectRange(h,
B,C,Q):y.selectRange(C,Q,h,B):(a=C.compareDocumentPosition(h),2==a?y.selectRange(h,B,C,Q):y.selectRange(C,Q,h,B)))}return!0};c.endTextSelection=function(a,b,d){qa();r=!1;J=l=null;if("text"==x.selectionMode){var f,e=I;v&&(e=!1);ja?(f=ja,ja=null):(f=R.getSelection(),f=f.anchorNode&&f.focusNode?pa(f):null);if(!f)la(),P.autoHighlight()&&y.clearSelection();else if(0!==Na(f,n)){f.acc!==f.accend&&(e=!1);var p=z.forRange(f);p&&(I=!1,N=H=K=L=void 0,u=p,n=f,t=ga(f),c.on.selectionchanged.dispatch(n,!0),f={x:a,
y:b},oa=void 0,E.on.select.dispatch(n,q,f,Nb(n)))}e&&d&&(d=y.wrap(d.target),d.isDescendantOf(z.activeOverlay())||d.isDescendantOf(w.drawing))&&((a=P.findNearest(a,b))&&0===a.distance.ax&&0===a.distance.ay||P.deactivate());C=void 0;Q=0;h=A=void 0;B=0;v=void 0}P.endSelection()};c.incrementSelection=function(a,b,d){var f=!1;n&&(f=F.incrementSelection(t,n,a,b,d))&&(c.update(),c.on.selectionchanged.dispatch(n,!0));return f};c.moveAnchor=function(a,b,d){var f=!1;t&&(f=F.moveAnchor(t,a,b,d))&&(n=ga(t),c.update(),
c.on.selectionchanged.dispatch(n,!0));return f};c.update=function(){if(n)if("text"===n.type){y.clearSelection();c.logUpdate&&c.logUpdate(n);var b=z.findTextRange(n);b&&y.selectRange(hc(b))}else{if(u)if(b=F.rangeRect(n,"overlay",!0),c.logUpdate&&c.logUpdate(n,b),!b)u.showSelectionRect(!1);else if(u.hasSelectionRect()){var d=u.selectionRect();d.move(b.left,b.top,b.width,b.height);d.show(a&&(!I||g)&&("rect"===n.type||"cell"===n.type))}}else y.clearSelection();F.select(n)&&F.update()};var la=function(){y.clearSelection();
u&&u.showSelectionRect(!1);r=!1;a=!0;b=null;I=!1;N=H=K=L=void 0;n=t=u=null;Da();ea()};c.validateMode=function(a,b){F.isSelectionModeSupported(a)||("rect"===a?F.features().rectredaction&&"redaction"==OIT.highlights.autoHighlight()||(a=void 0):a=void 0);a||(b?a=c.validateMode(b):F.isSelectionModeSupported("text")?a="text":F.isSelectionModeSupported("rect")?a="rect":F.isSelectionModeSupported("cell")&&(a="cell"));return a};c.addAutoscrollRoot=function(a){p.push(y.wrap(a))};var wa=function(a,b,c){if(b!=
ma||c!=O){var d=w.viewNode;ma=b;for(O=c;a&&-1==p.indexOf(a);){if(a===d||!(a instanceof U)){a=null;break}a=a.parent()}var f;a?(f=a.pos(d),b-=f.left,c-=f.top,f=a.clientWidth*x.zoom,d=a.clientHeight*x.zoom):(a=d,f=d.clientWidth,d=d.clientHeight);1>=b?(ca=b-1,-30<ca&&(ca=-30)):b>=f-1?(ca=b-(f-1),30>ca&&(ca=30)):ca=0;1>=c?(X=c-1,-30<X&&(X=-30)):c>=d-1?(X=c-(d-1),30>X&&(X=30)):X=0;ca||X?ba||(ba=yb(ra,100,null,a)):qa()}},ra=function(a){a.dscroll(ca,X);C?c.extendTextSelection(ma,O):c.extendRectSelection(ma,
O)},qa=function(){ba&&(Qa(ba),ba=void 0,X=ca=0)};c.enableCellOffsets=function(a){k=!!a};c.bindSelectionToPage=function(a){m=!!a};la();x.onselectionMode(function(a){c.select(null);(a=z.activeOverlay())&&a.updateCSS()});E.onreset(function(){c.reset();p=[]});F.ondisplayload(c.reset);ka.ondetach(function(){d=e=null;D&&(D.destroy(),D=null)});E.onzoom(function(a,b,d){c.update()})}}),Va=Aa.extend("user",{events:{beginscroll:{},endscroll:{},beginpinchzoom:{},endpinchzoom:{}},install:function(c){var e=!1,
a=!1,b=!1,d=!1,g,k,m=null,r,t,u,n=null,q,l,I,L,K,H,N,C,Q,A=0,f=0,h=0,B=0;E.onload(function(){var a=w.rootNode;a.onmousedown(ca);a.onwheel(ma);R.addEventListener("mouseup",X,!1);R.addEventListener("keydown",v,!1);w.isMobileOrTablet&&(a=w.viewNode,a.kinetic(!0),a.ontap(wa),a.onpress(ra),a.onpressup(qa),a.onpanstart(Fa),a.onpanmove(G),a.onpanend(Ca),a.onpancancel(Ca),a.onpinchstart(Kb),a.onpinchmove(kb),a.onpinchend(M),a.onpinchcancel(M),a.onrotatestart(Lb),a.onrotatemove(T),a.onrotateend(U),a.onrotatecancel(U))});
E.onreset(function(){var a=w.rootNode;a&&(a.offmousedown(ca),a.offwheel(ma));R.removeEventListener("mouseup",X);R.removeEventListener("keydown",v);w.isMobileOrTablet&&(a=w.viewNode)&&(a.offtap(wa),a.offpress(ra),a.offpressup(qa),a.offpanstart(Fa),a.offpanmove(G),a.offpanend(Ca),a.offpancancel(Ca),a.offpinchstart(Kb),a.offpinchmove(kb),a.offpinchend(M),a.offpinchcancel(M),a.offrotatestart(Lb),a.offrotatemove(T),a.offrotateend(U),a.offrotatecancel(U))});var v=function(a){var b,d;c.logKeydown&&c.logKeydown(a);
if(c.isViewEventTarget(a.target)||e&&a.target==V.body){if((d=E.on.keydown.dispatch(a))&&!w.editingComment&&(d=F.keydown(a))){b=w.viewNode;var f=P.active(),p=0,g=0;switch(a.keyCode){case 33:F.features().pages&&(b.finishAnimation(),z.updateActivePage(),0<b.scrollTop?b.dscroll(void 0,-b.clientHeight):z.movetoPrev(),d=!1);break;case 34:F.features().pages&&(b.finishAnimation(),z.updateActivePage(),b.scrollTop<Math.max(b.clientHeight,b.scrollHeight,b.offsetHeight)-b.innerHeight?b.dscroll(void 0,b.clientHeight):
z.movetoNext(),d=!1);break;case 35:b.scroll(b.scrollWidth,b.scrollHeight);d=!1;break;case 36:b.scroll(0,0);d=!1;break;case 37:p=-1;break;case 38:g=-1;break;case 39:p=1;break;case 40:g=1;break;case 45:void 0!==f&&P.getOption(f,"enableUserComment")&&(P.showComment(f,{mode:"edit",removeOnCancel:!1}),d=!1);break;case 46:void 0!==f&&P.getOption(f,"enableUserDelete")&&(P.remove(),f=void 0,d=!1);break;case 48:a.ctrlKey&&(E.zoom(1),d=!1);break;case 187:a.ctrlKey&&(E.zoomIn(),d=!1);break;case 189:a.ctrlKey&&
(E.zoomOut(),d=!1)}if(p||g){var h;void 0!==f&&(b=P.range(f))&&(h=b.type);h||(h=x.selectionMode);if("cell"===h||"rect"===h)if(h=a.ctrlKey,void 0!==f){if(a.shiftKey){var D=b=0,l=0,v=0;d=x.rotation;switch(d){case 0:l=p;v=g;break;case 90:v=p;b=-g;break;case 180:b=-p;D=-g;break;case 270:D=-p,l=g}P.move(f,b,D,l,v,h)}else{d=x.rotation;if(0!==d)switch(b=p,D=g,d){case 90:p=-D;g=b;break;case 180:p=-b;g=-D;break;case 270:p=D,g=-b}P.move(f,p,g,p,g,h)}(b=P.range(f))&&z.moveto(b);d=!1}else d=a.shiftKey?!S.incrementSelection(p,
g,h):!S.moveAnchor(p,g,h)}}!1===d&&jb(a);return d}},J=function(a){(a.button||0)==K&&(c.releaseMouseCapture(),c.on.endscroll.dispatch());K=void 0},ca=function(f){e=!1;c.logMouse&&c.logMouse(f);if(!w.editingComment){var p=w.viewNode,g=p.mousePos(f);if(c.isViewEventTarget(f.target)){var h=f.button||0,D=p.inRect(g.x,g.y);if(1==h||0===h&&!D)c.on.beginscroll.dispatch(),K=h,c.setMouseCapture(null,J);else{D=!0;p.focus();e=!0;if(0===h){p=x.selectionMode;if("rect"===p||"cell"===p)S.startRectSelection(g.x,g.y,
f)&&(b=!0,c.setMouseCapture(Da)),D=!1;else if("text"==p){var v,p=1;if(void 0!==q){var k;if(f.pageX||f.pageY)v=f.pageX,k=f.pageY;else if(f.clientX||f.clientY)v=f.clientX,k=f.clientY;v=Math.abs(v-l.x);k=Math.abs(k-l.y);3>=v&&3>=k&&((new Date).getTime()-q<=x.doubleClickInterval&&(p=I+1),q=void 0)}v=p;var B;2===v?B="word":v=1;if(S.startTextSelection(g.x,g.y,B,f))if(d=!0,c.setMouseCapture(ea),g=v,q=(new Date).getTime(),I=g,f.pageX||f.pageY)l={x:f.pageX,y:f.pageY};else if(f.clientX||f.clientY)l={x:f.clientX,
y:f.clientY};D=!1}a=!0}!1===D&&jb(f);return D}}}},X=function(f){var e;c.logMouse&&c.logMouse(f);if(k)e=k.call(m,f);else if(a){e=!0;if(!w.editingComment){var p=w.viewNode.mousePos(f);0===(f.button||0)&&(b?(b=!1,c.releaseMouseCapture(),S.endRectSelection(p.x,p.y,f)):(d&&(d=!1,c.releaseMouseCapture()),S.endTextSelection(p.x,p.y,f)),e=!1)}a=!1}!1===e&&jb(f);return e},ma=function(a){if(!w.editingComment&&c.isViewEventTarget(a.target))if(a.ctrlKey){if(!x.browserZoom)return 0<a.wheelDelta?OIT.document.zoomIn():
0>a.wheelDelta&&OIT.document.zoomOut(),jb(a),!1}else c.on.beginscroll.dispatch(),void 0!==L&&ta(L),L=da(O,500)},O=function(){L=void 0;c.on.endscroll.dispatch()};c.setMouseCapture=function(a,b,d){c.releaseMouseCapture();"function"===typeof a&&(R.addEventListener("mousemove",ba,!0),g=a);"function"===typeof b&&(k=b);if(g||k)y.body.onmouseover(p),y.body.onmouseout(D);m=d};var ba=function(a){if(g&&!1===g.call(m,a))return jb(a),!1},p=function(a){if(H){var b=la(a);if(b!==H.buttons&&H.buttons&1&&!(b&1)){var b=
H,d;V.createEvent?(d=V.createEvent("MouseEvent"),d.initMouseEvent("mouseup",!0,!0,R,null,b.screenX,b.screenY,b.clientX,b.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.relatedTarget)):d=new MouseEvent("mouseup",{screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:0,buttons:a.buttons,relatedTarget:a.relatedTarget,region:a.region});X(d)}H=void 0}},D=function(a){H={buttons:la(a),screenX:a.screenX,
screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}};c.releaseMouseCapture=function(){g&&(R.removeEventListener("mousemove",g,!1),g=null);k=null;y.body.offmouseover(p);y.body.offmouseout(D)};c.setTouchCapture=function(a,b,d,f){c.releaseTouchCapture();"function"===typeof a&&(y.listen("touchmove",ja,{capture:!0,passive:!1}),r=a);"function"===typeof b&&(y.listen("touchend",Y,{capture:!0,passive:!1}),t=b);"function"===typeof d&&(y.listen("touchcancel",oa,{capture:!0,passive:!1}),u=d);n=f};var ja=function(a){r&&
r.call(n,a)},Y=function(a){t&&t.call(n,a)},oa=function(a){u&&u.call(n,a)};c.releaseTouchCapture=function(){r&&(y.unlisten("touchmove",ja,!1),r=null);n=u=t=null};var Da=function(a){if(b){var d=w.viewNode.mousePos(a);S.extendRectSelection(d.x,d.y,a);return!1}return!0},ea=function(a){if(d){var b=w.viewNode.mousePos(a);S.extendTextSelection(b.x,b.y,a);return!1}return!0};c.isViewEventTarget=function(a){for(var b=w.viewNode;a;){if(b.equals(a))return!0;if("TEXTAREA"===a.tagName||"SELECT"===a.tagName)break;
if("oit-em_allheaders"===a.id)break;if(y.hasClass(a,"oit-emheadervalues")||y.hasClass(a,"oit-em_allheaders")||y.hasClass(a,"oit-note-icons")||y.hasClass(a,"oit-ssoverlay"))return!0;if(y.hasClass(a,"oit-button")||y.hasClass(a,"oit-note")||y.hasClass(a,"oit-expander"))break;a=a.parentNode}return!1};var la=function(a){var b;if(void 0!==a.buttons)b=a.buttons;else switch(a.button){case 0:b=1;break;case 1:b=4;break;case 2:b=2;break;case 3:b=8;break;case 4:b=16}return b},wa=function(a){"text"===S.selectionType()&&
S.select(null);z.deactivateAnnotation();var b=a.center;P.activateNearest(b.x,b.y,a.srcEvent)},ra=function(a){e=!1;if(!w.editingComment){var c=a.center;w.viewNode.focus();e=!0;var f=x.selectionMode;"rect"===f||"cell"===f?(b=!0,S.startRectSelection(c.x,c.y)):"text"==f&&S.startTextSelection(c.x,c.y,"word",a)&&(d=!0)}},qa=function(a){var c;if(b||d)b?(b=!1,c=a.center,S.endRectSelection(c.x,c.y,a.srcEvent)):d&&(d=!1,c=a.center,S.endTextSelection(c.x,c.y,a.srcEvent))},Fa=function(a){a.press||(a=w.viewNode,
N=a.scroll(),f=A=0,h=a.scrollWidth-a.clientWidth,B=a.scrollHeight-a.clientHeight,F.startElasticScroll())},G=function(a){if(a.press)b?(a=a.center,S.extendRectSelection(a.x,a.y)):d&&(a=a.center,S.extendTextSelection(a.x,a.y));else if(N){var c=w.viewNode,e=a.delta,p=N.left-e.x,e=N.top-e.y,g=na(p,0,h),D=na(e,0,B);c.autoscroll(g,D);a.kinetic||(A=p-g,f=e-D,(A||f)&&F.elasticScroll(A,f))}},Ca=function(a){a.press||(N=void 0,F.endElasticScroll(A,f),f=A=0)},Kb=function(a){C=x.zoom;c.on.beginpinchzoom.dispatch()},
kb=function(a){C&&E.zoom(C*a.scale,a.center,!0)},M=function(a){C=void 0;c.on.endpinchzoom.dispatch()},Lb=function(a){Q=x.rotation},T=function(a){if(void 0!==Q){var b=Q;a=Yb(180*a.rotation/Math.PI,"deg");60<a&&300>a&&(b=135>a?b+90:225>a?b+180:b+270);E.rotate(b)}},U=function(a){Q=void 0}}}),ha=Aa.extend("content",{events:{data:{},add:{},first:{},last:{}},install:function(c){var e=!1,a=!0,b=!1,d=[],g=[],k,m,r,t=0,u=!1,n=!1,q=null,l=[],I=function(){k&&(k.hide(),k=null)},L=function(a){a&&(g.push({data:a}),
e&&!r&&(r=da(h,0)),(a=d.shift())&&a.destroy())},K=function(a){a={url:a,cache:!0,retryDelay:0,pendingText:""};a.ajax=ab({url:a.url,cache:a.cache,complete:Q,args:[a]});g.push(a)};c.isPending=function(){return 0<g.length||0<l.length||!w.documentComplete};c.manifest=function(){return q};c.initializeContent=function(a,b,d){OIT.content&&(L(OIT.content),delete OIT.content);d?(w.singlePageIndex=Number(d),b&&w.dynamicContent&&N(b)):b?(w.dynamicContent=!0,N(b)):a&&"none"!==a&&(w.dynamicContent=!0,C(a));e=!0;
0<g.length&&!r&&(r=da(h,0))};var H=function(a){if(!m&&a){if((void 0===x.outputBaseUrl||null===x.outputBaseUrl||""===x.outputBaseUrl)&&x.detectBaseUrl&&"/"!=a[0]&&0!==a.search(/http/i)){var b=w.URL.lastIndexOf("/");if(-1!=b){b=w.URL.substr(0,b+1);if(0===b.search(/http/i)){var d=V.createElement("a");d.href=b;b=d.pathname||d.pathName;"/"!=b[0]&&(b="/"+b)}0!==a.indexOf(b)&&(w.baseURL=b||null)}}m=w.baseURL}return m},N=function(a){if(a){var b=H(a);b&&"/"!=a.charAt(0)&&(a=Sa(b,a));0===w.URL.indexOf("file://")?
(b=y.create("script"),b.attr("src",a),y.head.append(b),d.push(b)):K(a)}},C=function(a){if(a&&"none"!==a){var b=H(a);b&&"/"!=a.charAt(0)&&(a=Sa(b,a));K(a)}},Q=function(b,d,f,e,h){h.status=e;404===e&&(f="");200===e||404==e?0===f.length||0===f.indexOf("%")?(f!==h.pendingText&&(h.pendingText=f,h.retryDelay=0),h.retryDelay>x.contentTimeout?(I(),c.logAJAXError(null,"Timed out while loading the document content data from the server",b,Vb),eb(),g=[]):(a&&(k||(k=ua.createProgressDialog(T.PLEASE_WAIT_INITIALIZING,
!1))),h.cache=!1,h.retryDelay+=200,da(function(){h.ajax=ab({url:h.url,cache:h.cache,complete:Q,args:[h]})},200))):(A(h,f),I()):(I(),c.logAJAXError(null,"Failed to load the document content data from the server",b,e,f),eb(),g=[])};c.isICD=function(a){return"if(window.OIT&&OIT.icd)OIT.icd("==a.substring(0,31)};var A=function(a,b){var d,f=b.indexOf("else OIT.content={");-1!=f?(f+=18,d=b.lastIndexOf("}"),-1!=d&&(b="{"+b.substring(f,d)+"}")):c.isICD(b)&&(f=31,d=b.lastIndexOf(");"),-1!=d&&(b=b.substring(f,
d)));try{var e=JSON.parse(b);a.data=e;r||(r=da(h,0))}catch(O){c.logAJAXError(null,"Document data is corrupt ("+O+")",a.url,a.status,b)}},f=function(a){ab({url:a,complete:function(a,b,d,f){if(200==f)try{q=JSON.parse(d);var e=q.files?q.files.content:null;if(e){for(b=1;b<e.length;b++)l.push(e[b].url);h()}}catch(ba){c.logAJAXError(null,"The document manifest is corrupt ("+ba+")",a,f,d),n=!1,q=null}else c.logAJAXError(null,"Failed to load the document manifest from the server",a,f,d),n=!1,q=null}})},h=
function(){r=void 0;if(e&&!u&&0<g.length&&g[0].data){for(var d=a;0<g.length&&g[0].data;){var h=g.shift();if(h.data.info&&h.data.info.manifest&&w.dynamicContent){var k=h.data.info.manifest,q=H(k);q&&"/"!=k.charAt(0)&&(k=Sa(q,k));f(k);n=!0}B(h.data);a=!1;void 0===w.singlePageIndex?h.data.nextContent?n||N(h.data.nextContent):h.data.nextData?n||C(h.data.nextData):b=!0:b=!0}d&&c.on.first.dispatch();c.on.add.dispatch();b&&c.on.last.dispatch()}for(;20>g.length&&0<l.length;)C(l.shift())},B=function(b){if(b){if(b.info&&
b.info.version){var d=b.info.version.split("."),f=parseInt(d[0],10),e=parseInt(d[1],10),d=parseInt(d[2],10);0<f&&0<=e&&9>=e&&0<=d&&9>=d&&(t=f+e/10+d/100)}c.on.data.dispatch(b,a,t)}};c.processICD=function(a,b,d){if(c.isICD(a)){var f=a.lastIndexOf(");");if(-1!=f){a=a.substring(31,f);try{a=JSON.parse(a),B(a)}catch(ma){c.logAJAXError(null,"ICD data is corrupt ("+ma+")",b,d,a)}}}};E.onreset(function(){r&&ta(r);I();e=!1;a=!0;b=!1;d=[];g=[];r=m=k=void 0;t=0;n=u=!1;q=null;l=[];w.singlePageIndex=void 0;c.on.add.reset()});
Va.onbeginscroll(function(){u=!0});Va.onendscroll(function(){u=!1;h()});hb("icd",L)}}),E=Aa.extend("document",{exports:"cellRange cellSelection externalData externalValue find findAll getOptions getRawText getSelectedText highlight print properties rectRange rectSelection removeExtraEmailHeaders rotate select selection selectionMode selectionStyle selectionType setOptions showHidden textRange textSelection updateViewSize zoom zoomIn zoomOut".split(" "),events:{load:{pub:!0,detail:function(){return{url:w.URL}},
onAdd:function(c,e){w.documentLoaded&&da(function(){c.dispatchTo(e)},0)}},reset:{},unload:{pub:!0},zoom:{pub:!0,detail:function(c,e,a){return{zoom:c,mode:e}}},rotate:{pub:!0,detail:function(c){return{angle:c}}},resize:{},idle:{pub:!0,onListen:function(){E.resetIdleTimer()},onUnlisten:function(){E.resetIdleTimer()},onAdd:function(){E.resetIdleTimer()},onRemove:function(){E.resetIdleTimer()}},error:{pub:!0,detail:function(c,e){return{message:c,fatal:!!e}}},select:{pub:!0,detail:function(c,e,a,b,d){c=
{selection:c,empty:b};e&&a&&(c.start=e,c.end=a);void 0!==d&&(c.highlightid=d);return c}},scroll:{pub:!0,detail:function(c,e,a,b){e=w.viewNode;c=z.mapToPage(0,0);e=z.mapToPage(e.clientWidth,e.clientHeight);return c&&e?{viewUpperLeft:{pageIndex:c.page.index,x:c.x,y:c.y},viewLowerRight:{pageIndex:e.page.index,x:e.x,y:e.y}}:{viewUpperLeft:{pageIndex:0,x:0,y:0},viewLowerRight:{pageIndex:0,x:0,y:0}}}},scrollupdate:{delay:200},keydown:{pub:!0,detail:function(c){return{srcEvent:c}}},optionschanged:{pub:!0,
detail:function(c){return c}},showmessage:{pub:!0,detail:function(c,e,a){return{message:c||"",modal:e||!1,progress:a||!1}}},progress:{pub:!0,detail:function(c){return{percentDone:c||0}}},hidemessage:{pub:!0},done:{pub:!0},hiddencontent:{pub:!0,detail:function(c,e){var a={},b,d;for(d=0;d<e.length;d++)b=e[d],b.supported&&c[b.name]&&(x[b.option]!==b.optionValue?(a.supportedNotVisible||(a.supportedNotVisible=[]),a.supportedNotVisible.push(T[b.message])):(a.supportedVisible||(a.supportedVisible=[]),a.supportedVisible.push(T[b.message])));
for(d=0;d<e.length;d++)b=e[d],!b.supported&&c[b.name]&&(a.unsupported||(a.unsupported=[]),a.unsupported.push(T[b.message]));return a}},ajax:{pub:!0,single:!0,detail:function(c){return{request:c}}},ajaxabort:{pub:!0,single:!0,detail:function(c){return{request:c}}},highlight:{pub:!0,detail:function(c,e,a,b){return{highlights:c,searchTerm:e,style:a,properties:b}}}},install:function(c){var e=[.1,.25,.5,.75,1,1.25,1.5,2,3,5,10,20,40],a=e[0],b=e[e.length-1],d=["rows","columns","all","none"],g=[{name:"hidden-pages",
supported:!0,message:"HIDDEN_CONTENT_PAGES",option:"showHiddenSheets",optionValue:!0},{name:"hidden-columns",supported:!0,message:"HIDDEN_CONTENT_COLUMNS",option:"showHiddenColumns",optionValue:!0},{name:"hidden-rows",supported:!0,message:"HIDDEN_CONTENT_ROWS",option:"showHiddenRows",optionValue:!0},{name:"hidden-text",supported:!0,message:"HIDDEN_CONTENT_TEXT",option:"showAnnotations",optionValue:!0},{name:"comments",supported:!0,message:"HIDDEN_CONTENT_COMMENTS",option:"showAnnotations",optionValue:!0},
{name:"tracked-changes",supported:!0,message:"HIDDEN_CONTENT_TRACKED_CHANGES",option:"showAnnotations",optionValue:!0},{name:"speaker-notes",supported:!0,message:"HIDDEN_CONTENT_SPEAKER_NOTES",option:"showSlideNotes",optionValue:!0},{name:"hidden-slides",supported:!0,message:"HIDDEN_CONTENT_SLIDES",option:"presentationMode",optionValue:"normal"},{name:"comments-unsupported",supported:!1,message:"HIDDEN_CONTENT_COMMENTS"},{name:"hidden-text-unsupported",supported:!1,message:"HIDDEN_CONTENT_TEXT"},
{name:"tracked-changes-unsupported",supported:!1,message:"HIDDEN_CONTENT_TRACKED_CHANGES"},{name:"large-sheet-unsupported",supported:!1,message:"HIDDEN_CONTENT_LARGE_SHEET"}],k=!1,m,r,t,u=!1,n=0,q,l,I={},L={},K,H,N,C={},Q,A=[],f={},h,B=!1,v,J=0,ca;c.properties=function(){if(w.documentLoaded)return Ua(I)};c.externalValue=function(a){if(w.documentLoaded)return L[a]};c.externalData=function(){if(w.documentLoaded)return L};c.revisions=function(){return ca};c.getOptions=function(a){if(void 0===a){a=x.items();
var b={},d;for(d in a)x.isPublic(d)&&(b[d]=x[d]);b.showSlideComments=b.showAnnotations;return b}if(a&&"string"==typeof a&&("showSlideComments"===a&&(a="showAnnotations"),x.isPublic(a)))return x[a]};c.setOptions=function(a){if(a){for(var b in a){"showSlideComments"===b&&(b="showAnnotations");var d=a[b];x.isPublic(b)&&x[b]!=d&&(x[b]=d)}qa()}};Va.onbeginpinchzoom(function(a,b){k=!0});Va.onendpinchzoom(function(){k=!1;c.dispatchPageEvents(!0);fb()});var X=function(d){d<a?d=a:d>b&&(d=b);return d};c.zoom=
function(a,b,d){if("number"===typeof a){var f=X(a);f!=a&&(d||c.invalidArg("zoom","zoom",a,"using fallback zoom factor "+f,!1),a=f);if(x.zoomMode||a!=x.zoom)x.zoom=a,x.zoomMode=null,c.dispatchPageEvents(!1,b)}else"string"===typeof a?a!=x.zoomMode&&(x.zoomMode=a,c.dispatchPageEvents(!1,b)):"undefined"===typeof a||d||c.invalidArg("zoom","zoom",a);return x.zoom};c.zoomIn=function(){for(var a=0;a<e.length;a++)if(e[a]>x.zoom){c.zoom(e[a]);break}return x.zoom};c.zoomOut=function(){for(var a=e.length-1;0<=
a;a--)if(e[a]<x.zoom){c.zoom(e[a]);break}return x.zoom};c.rotate=function(a){"number"===typeof a?x.rotation=Yb(a,"deg"):void 0!==a&&c.invalidArg("rotate","angle",a,"Angle must be an integer multiple of 90 degrees.");return x.rotation};c.showHidden=function(a){w.documentLoaded&&!w.documentUnloading&&F.features().showhidden&&(void 0!==a&&-1==d.indexOf(a)?c.invalidArg("showHidden","mode",a,"Must be one of "+JSON.stringify(d)):F.showHidden(a))};var ma=[{name:"searchTerm",type:["string","RegExp"],req:!0},
{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"direction",type:"string",legal:["up","down"],def:"down"},{name:"startACC",type:"number"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];c.find=function(a,b,d,f,e){if(w.documentLoaded&&!w.documentUnloading){var p=c.processArguments("find",arguments,ma);p&&da(oa,0,{finder:ia.findStart(p.searchType,p.searchTerm,p.caseSensitive,p.direction,
e),callbackFn:p.callbackFn})}};var O=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"callbackFn",type:"function",req:!0},{name:"caseSensitive",type:"boolean",def:!0},{name:"searchType",type:"string",legal:"string dtsearch lucene phsterms literal literal*".split(" "),def:"string"}];c.findAll=function(a,b,d){if(w.documentLoaded&&!w.documentUnloading){var f=c.processArguments("findAll",arguments,O);f&&c.findAllArgs(f)}};c.findAllArgs=function(a){w.documentLoaded&&!w.documentUnloading&&a&&
c.on.idle.listenOnce({finder:ia.findStart(a.searchType,a.searchTerm,a.caseSensitive),callbackFn:function(b){var d=!0;if(!b){if(a.callbackFn)try{a.callbackFn.call(null)}catch(Gb){c.logError("findAll","Exception in callback function: "+Gb)}d=!1}else if(a.callbackFn)try{var f=ia.getRawText(b.range.acc,b.range.accend),d=a.callbackFn.call(null,b.range,f)}catch(Gb){c.logError("findAll","Exception in callback function: "+Gb),d=!1}!1!==d&&(d=!0);return d},startIterationFn:null,endIterationFn:null},Da)};c.getRawText=
function(a){w.documentLoaded&&(Pa(a)?da(ea,0,{callbackFn:a,textBlockIndex:0}):c.invalidArg("getRawText","callbackFunction",a,"must be a function"))};var ba=[{name:"searchTerm",type:["string","RegExp"],req:!0},{name:"style",type:"string",req:!0},{name:"callbackFn",type:"function"},{name:"caseSensitive",type:"boolean",def:!0},{name:"properties",type:"object"},{name:"searchType",type:"string",legal:"string dtsearch lucene literal literal* phsterms".split(" "),def:"string"}];c.highlight=function(a,b,
d,f,e){if(w.documentLoaded)if(!1===ia.hasRawText())c.logError("highlight","Search functionality has been disabled for this document");else if(P)if(!1===F.features().highlights)c.logError("highlight","Highlighting functionality is not available for this document type");else if("object"===typeof b){var p=b,p={searchTerm:a,style:p.style,searchType:p.mode||"string",properties:p.properties,callbackFn:p.callbackFn,caseSensitive:!1!==p.caseSensitive,visible:!1!==p.visible,enableUserDelete:!1!==p.enableUserDelete,
enableUserMove:!1!==p.enableUserMove,enableUserResize:!1!==p.enableUserResize,enableUserComment:!1!==p.enableUserComment,stemAll:!0===p.stemAll,stemmer:p.stemmer};c.highlightArgs(p)}else(p=c.processArguments("highlight",arguments,ba))&&c.highlightArgs(p);else c.logError("highlight","Highlighting functionality has been disabled for this document")};c.highlightArgs=function(a){w.documentLoaded&&a&&(a.batchStarted=!1,a.highlights=[],a.complete=!1,a.iteration=0,R.performance&&"function"===typeof performance.now&&
(a.startTime=performance.now()),c.on.idle.listenOnce({finder:ia.findStart(a.searchType,a.searchTerm,a.caseSensitive,"down",void 0,a.stemAll,a.stemmer),callbackFn:function(b){var d=!0;if(b){var f;if(b.terms){f=[];for(var e=0;e<b.terms.length;e++)f.push(b.terms[e].range);f=P.add(a.style,f,a.properties)}else f=P.add(a.style,b.range,a.properties);if(void 0!==f)for(Array.isArray(f)||(f=[f]),e=0;e<f.length;e++){var p=f[e];if(-1==a.highlights.indexOf(p)){a.highlights.push(p);!1===a.visible&&P.hide(p);if(!1===
a.enableUserDelete||!1===a.enableUserMove||!1===a.enableUserResize||!1===a.enableUserComment){var g={};!1===a.enableUserDelete&&(g.enableUserDelete=!1);!1===a.enableUserMove&&(g.enableUserMove=!1);!1===a.enableUserResize&&(g.enableUserResize=!1);!1===a.enableUserComment&&(g.enableUserComment=!1);P.setOptions(p,g)}if(a.callbackFn)try{var h=ia.getRawText(b.range.acc,b.range.accend),d=a.callbackFn.call(null,b.range,p,a.highlights,a.searchTerm,a.style,a.properties,h)}catch(Eb){c.logError("findAll","Exception in callback function: "+
Eb),d=!1}}}}else{b=["Highlight term '",a.searchTerm,"': ",a.highlights.length," hits, "];R.performance&&"function"===typeof performance.now&&(d=M(performance.now()-a.startTime,10),b.push(d,"ms, "));b.push("searchType='",a.searchType,"', stemAll=",a.stemAll,", stemmer=",a.stemmer,", style='",a.style,"', caseSensitive=",a.caseSensitive,", visible=",a.visible);console.log(b.join(""));if(a.callbackFn)try{a.callbackFn.call(null,null,null,a.highlights,a.searchTerm,a.style,a.properties)}catch(Eb){c.logError("findAll",
"Exception in callback function: "+Eb)}d=!1}!1!==d&&(d=!0);d||(a.batchStarted&&P.endBatch(),a.complete=!0,c.on.highlight.dispatch(a.highlights,a.searchTerm,a.style,a.properties));return d},startIterationFn:function(b){F.suspendUpdate();a.iteration++},endIterationFn:function(){!a.complete&&!a.batchStarted&&2<=a.iteration&&(P.beginBatch(),a.batchStarted=!0);F.resumeUpdate()}},Da))};c.select=function(a,b){if(w.documentLoaded){var d=!1;if(!1===ia.hasRawText())c.logError("select","Javascript selection functionality has been disabled for this document");
else if(null===a)d=S.select(null);else if(Ba(a)||Ra(a))d=S.select(a);else{var f=xa(a,!0,!0);f?(d=c.selection(),d=0!==Na(f,d),!1!==b?z.movetoEx(f,{callbackFn:function(){S.select(f)},animate:!1}):S.select(f)):c.invalidArg("select","range",a,"must be a valid text range, cell range, or rect range")}return d}};c.selectionType=function(){if(w.documentLoaded)return S.selectionType()};c.selectionMode=function(a){a&&(x.selectionMode=a);return x.selectionMode};c.selectionStyle=function(a){var b;void 0!==a&&
null!==a&&"string"!==typeof a?c.invalidArg("selectionStyle","style",a,"Must be a valid CSS string"):b=S.style(a);return b};c.selection=function(){var a;if(w.documentLoaded)switch(S.selectionType()){case "text":a=S.textSelection();break;case "cell":a=S.cellSelection();break;case "rect":a=S.rectSelection()}return a};c.textSelection=function(){if(w.documentLoaded)return S.textSelection()};c.cellSelection=function(){if(w.documentLoaded)return S.cellSelection()};c.rectSelection=function(){if(w.documentLoaded)return S.rectSelection()};
c.getSelectedText=function(){if(w.documentLoaded)return F.getSelectedText()};c.textRange=function(){return pa.apply(this,arguments)};c.cellRange=function(){return sa.apply(this,arguments)};c.rectRange=function(){return Cb.apply(this,arguments)};c.updateViewSize=function(){ka.dispatchResize()};var p=function(){if(F.features().fitpage){var a=90==x.rotation||270==x.rotation,b,d=F.padding();b=F.margin();var c=d.left+d.right+b.left+b.right,d=d.top+d.bottom+b.top+b.bottom;a?(a=F.maxPageHeight(),b=F.maxPageWidth()):
(a=F.maxPageWidth(),b=F.maxPageHeight());var a=a+z.annotationPaneWidth(),f=w.viewNode;return{w:X((f.clientWidth-c)/a),h:X((f.clientHeight-d)/b)}}};c.dispatchPageEvents=function(a,b){!1!==a&&(a=!0);if(w.documentLoaded&&!B){var d;if(x.zoomMode){var f=1;if(d=p()){switch(x.zoomMode){case "page":f=Math.min(d.w,d.h);break;case "pagewidth":f=d.w;break;case "pageheight":f=d.h;break;case "mobile":switch(w.deType){case "page":f=d.h<d.w&&d.h>=.9*d.w?d.h:d.w;break;case "drawing":f=(f=ka.infoRaw())&&1557===f.fi?
d.w:Math.min(d.w,d.h);break;case "slide":case "chart":case "bitmap":f=Math.min(d.w,d.h)}}f=X(f)}x.zoom=f}else if(w.nochrome||w.isMobile)if(d=p())d=Math.min(d.w,d.h),x.zoom<d&&(x.zoom=d);d=x.zoom;var f=K!=d||H!=x.zoomMode,e=N!=x.rotation;if(a||f||e)F.layoutChanged(b),ka.invalidateCanvas(),w.drawing&&w.drawing.update(!0);if(a||f)K=d,H=x.zoomMode,c.on.zoom.dispatch(d,x.zoomMode,k);if(a||e)N=x.rotation,c.on.rotate.dispatch(x.rotation);ka.dispatchScroll(a)}};var D=function(){c.dispatchPageEvents(!0)};
c.pauseIdleTimer=function(a){n++;1==n&&c.resetIdleTimer()};c.resumeIdleTimer=function(a){0<n&&(n--,0==n&&c.resetIdleTimer())};c.resetIdleTimer=function(){var a;m&&(ta(m),m=null);r&&(Qa(r),r=null);c.on.idle.hasListeners()&&w.documentLoaded&&!w.documentUnloading&&0===n?(u||(a=c.resetIdleTimer,y.listen("mousemove",a,!0),y.listen("touchmove",a,!0),y.listen("keydown",a,!0),c.onscroll(a),u=!0),m=da(function(){r=yb(function(){c.on.idle.dispatch(!1)},50,c.on.idle)},200),t||(t=yb(function(){c.on.idle.dispatch(!0)},
200,c.on.idle))):(t&&(Qa(t),t=null),a=c.resetIdleTimer,y.unlisten("mousemove",a),y.unlisten("touchmove",a),y.unlisten("keydown",a),c.offscroll(a))};var ja=function(){var a=F.pageRect(z.count()-1,"overlay");a&&(a=a.bottom-20*(z.count()-1),c.printCSS(".oit-view-root","height:"+a+"px;"));for(;void 0!==J;)if(z.on.change.disable(),a=z.page(J))if(a.overlay&&!a.overlay.isHidden()){a.load(!0,Y);J=void 0;break}else J++;else{if(!w.documentComplete)break;c.logFatalError(null,"No visible pages were found in the document");
J=void 0;break}},Y=function(a){z.moveto(a.index);w.documentLoaded=!0;c.on.load.dispatch();w.documentLoading=!1;z.on.change.enable();z.dispatchChange(void 0,!0);c.dispatchPageEvents(!0);w.documentComplete&&c.on.done.dispatch();c.resetIdleTimer()};c.installDocument=function(a,b){var d=!0,f=y.create("div");f.html(b);(f=f.byClass("oit-view-root"))&&0<f.length&&(f=f[0]);var e,p,g;f&&(e=f.data("icd"),p=f.data("json"),g=f.data("page"));if(!e&&!p||"none"==p)d="This document can't be loaded into the web view.",
ka.logFatalError("load","none"==p?d+" \nThe html file must be created in Ajax mode.":d+" \nThe html file does not appear to have been created by Web View Export.",b),d=!1;else{if(rc(a)){var f=V.URL,h=f.indexOf("//");if(-1===h)w.URL=a;else{var h=h+2,D=f.lastIndexOf("/"),f=-1!=D&&D>h?f.substr(0,D+1):f+"/";"/"===a[0]&&(h=f.indexOf("/",h)+1,f=f.substr(0,h));w.URL=Sa(f,a)}}else w.URL=a;ha.initializeContent(p,e,g);c.initializeDocument()}return d};c.unload=function(){var a=w.documentLoaded;w.documentUnloading=
!0;F.suspendUpdate();c.resetIdleTimer();try{F.unloadDisplay()}catch(Ca){c.logError("unload","Error while unloading display ("+Ca+")")}w.documentLoaded=!1;w.documentComplete=!1;w.hasHiddenText=!1;w.hasWorksheetRevisions=!1;try{S.reset()}catch(Ca){c.logError("unload","Error while resetting selection ("+Ca+")")}try{P.clear()}catch(Ca){c.logError("unload","Error while clearing highlights ("+Ca+")")}try{dc()}catch(Ca){c.logError("unload","Error while aborting timers ("+Ca+")")}try{eb()}catch(Ca){c.logError("unload",
"Error while aborting AJAX requests ("+Ca+")")}try{c.on.reset.dispatch()}catch(Ca){c.logError("unload","Error while resetting view ("+Ca+")")}a&&c.on.unload.dispatch();x.zoom=1;x.zoomMode=null;k=!1;J=0;m&&(Qa(m),m=null);r&&(Qa(r),r=null);t&&(Qa(t),t=null);n=0;I={};L={};A=[];w.documentLoading=!1;f={};B=!1;ca=null;h&&(h.destroy(),h=null);v&&(v.destroy(),v=null);w.drawing&&(w.drawing.destroy(),w.drawing=void 0);q&&(q.destroy(),q=void 0);l&&(l.destroy(),l=void 0);(a=w.viewNode)&&a.html("");w.URL=V.URL;
ha.onadd(ja);w.documentUnloading=!1;F.resumeUpdate()};c.initializeDocument=function(){w.viewNode&&(w.drawing=new Zc(w.viewNode),l=new sb("screen"),0<z.count()&&c.updateViewSize())};c.screenCSS=function(a,b){if(l)if(null===b)l.deleteRule(a);else if("string"==typeof b)l.setRule(a+"{"+b+"}",a);else if("object"==typeof b){var d=a+"{",c;for(c in b)d+=c+":"+b[c]+";";l.setRule(d+"}",a)}};c.printCSS=function(a,b){q||(q=new sb("print"));if(null===b)q.deleteRule(a);else if("string"==typeof b)q.setRule(a+"{"+
b+"}",a);else if("object"==typeof b){var d=a+"{",c;for(c in b)d+=c+":"+b[c]+";";q.setRule(d+"}",a)}};var oa=function(){var a=ia.findNext(this.finder);if(a||!ha.isPending()&&!ia.isPending()){if(a){var b=ia.getRawText(a.range.acc,a.range.accend);this.callbackFn.call(null,a.range,b)}else this.callbackFn.call(null);ha.offadd(oa);ia.offadd(oa)}else ha.onadd(this,oa),ia.onadd(this,oa)},Da=function(){var a=!0,b=!1;if(!this.aborted){this.curACC||(this.curACC=0);if(this.startIterationFn){var d=100*this.curACC/
ia.lastACC();this.startIterationFn(d)}var f;R.performance&&(f=R.performance.now());for(d=0;;d++){var e=ia.findNext(this.finder);if(e){if(this.curACC=e.range.acc,!1===this.callbackFn.call(null,e)){a=!1;b=!0;break}}else{ha.isPending()||ia.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}if(20<=d)if(void 0!==f){if(0==d%20&&50<R.performance.now()-f)break}else if(100<=d)break}if(a)c.on.idle.listenOnce(this,Da);else if(b)ha.offadd(this,Da),ia.offadd(this,Da),this.aborted=!0;else if(ha.isPending()||
ia.isPending())ha.onadd(this,Da),ia.onadd(this,Da);this.endIterationFn&&this.endIterationFn()}},ea=function(){for(var a=!0,b=!1,d=0;10>d;d++){var c=ia.getRawTextBlock(this.textBlockIndex);if(c)if(c.text){var f=c.text,e=c.range.acc;if(void 0!==this.acc){var p=this.acc-c.range.acc;0<p&&(f=f.substring(p),e+=p)}this.acc=c.range.accend;if(!1===this.callbackFn.call(null,f,e)){a=!1;b=!0;break}this.textBlockIndex++}else{a=!1;break}else{ha.isPending()||(this.callbackFn.call(null),b=!0);a=!1;break}}a?da(ea,
50,this):b?(ha.offadd(ea),ia.offadd(ea)):(ha.onadd(this,ea),ia.onadd(this,ea))};c.removeExtraEmailHeaders=function(){x.removeExtraEmailHeaders=!0};c.externalLinks=function(){return A};var la=function(a,b){B=!0;c.setOptions({showHiddenSheets:b,showHiddenColumns:b,showHiddenRows:b,showAnnotations:b,showSlideNotes:b,presentationMode:b?"normal":"slideshow"});B=!1;z.updateShowSlideNotes();c.dispatchPageEvents(!0);wa();h.collapse();return!1};c.supressHiddenContentUpdate=function(){return B};var wa=function(){var a,
b;if("none"===x.showHiddenContentNotification)h&&h.css("display","none");else if(!w.staging&&h&&!B){var d=[],c=!1,e=!1;for(b=0;b<g.length;b++)a=g[b],a.supported&&f[a.name]&&(d.push("<li>",T[a.message],"</li>"),x[a.option]!==a.optionValue?c=!0:e=!0);var p=[];0<d.length&&(p.push(T.HIDDEN_CONTENT_NOTIFICATION,"<div><ul>"),Array.prototype.push.apply(p,d),p.push("</ul>"),c?p.push(T.HIDDEN_CONTENT_INVISIBLE,'</div><div><a class="oit-showhiddenlink">',T.HIDDEN_CONTENT_SHOWLINK,"</a></div>"):p.push(T.HIDDEN_CONTENT_ALREADY_VISIBLE,
'</div><div><a class="oit-hidehiddenlink">',T.HIDDEN_CONTENT_HIDELINK,"</a></div>"));var d=[],D=!1;for(b=0;b<g.length;b++)a=g[b],!a.supported&&f[a.name]&&(d.push("<li>",T[a.message],"</li>"),D=!0);0<d.length&&(0<p.length&&p.push("<div>&nbsp;</div>"),p.push(T.HIDDEN_CONTENT_ORIGINAL_APPLICATION,"<div><ul>"),Array.prototype.push.apply(p,d),p.push("</ul></div>"));p=p.join("");h.message(p);h.css("display",null);c||D?e?h.title(T.HIDDEN_CONTENT_PARTIAL):h.title(T.HIDDEN_CONTENT_HIDDEN):h.title(T.HIDDEN_CONTENT_VISIBLE);
"expanded"===x.showHiddenContentNotification?h.expand(!1):h.collapse(!1);if(c){if(a=h.byClass("oit-showhiddenlink"))a[0].onclick(null,la,!0),a[0].ontap(null,la,!0)}else if(a=h.byClass("oit-hidehiddenlink"))a[0].onclick(null,la,!1),a[0].ontap(null,la,!1)}x.showAnnotations?w.viewNode.addClass("oit-showannotations"):w.viewNode.removeClass("oit-showannotations")};c.hiddenContent=function(a){f[a]||(f[a]=!0,h||(h=new Ec({title:T.HIDDEN_CONTENT_HIDDEN,collapseButton:!0}),h.onexpand(function(){x.showHiddenContentNotification=
"expanded"}),h.oncollapse(function(){x.showHiddenContentNotification="collapsed"})),wa(),c.on.hiddencontent.dispatch(f,g))};c.documentException=function(a){};c.showNotifications=function(){wa()};var ra=function(a,b,d){C[d]=a;Q||(Q=da(qa,50))},qa=function(){if(Q){var a=C;C={};ta(Q);Q=void 0;c.on.optionschanged.dispatch(a)}};c.print=function(){R.print()};ha.onadd(ja);ha.ondata(function(a,b,d){var f;if(a.properties)for(f in a.properties)I[f]=a.properties[f];if(a.external)for(f in a.external)L[f]=a.external[f];
if(a.options){for(var e in a.options)if(b=a.options[e],d=e.indexOf("."),0<d){var p=e.substring(0,d);e=e.substring(d+1);if("glob"==p||"opt"==p)d="glob"==p?w:x,d.hasOwnProperty(e)&&(d[e]=b)}w.hasHiddenText&&c.hiddenContent("hidden-text-unsupported");w.hasWorksheetRevisions&&c.hiddenContent("tracked-changes-unsupported")}if(a.info&&a.info.status)for(f in a.info.status)a.info.status[f]&&c.documentException(f);a.xlinks&&(A=A.concat(a.xlinks));a.revisions&&(ca=ca?ca.concat(a.revisions):a.revisions.slice(0))});
ha.onlast(function(){if(ca){for(var a=!1,b=!1,d=!1,f=!1,e=0;e<ca.length;e++){var p=ca[e],g=!0;b&&f||"add"!==p.type&&"delete"!==p.type?a&&d||"hidden"!=p.type||(g=!1):g=!1;if(!g){var h;p.range&&(h=z.forRange(p.range),h||(g=z.lastPage(),p.range.acc>g.accend&&(h=g)));h&&"page"===h.type?"add"===p.type||"delete"===p.type?b=!0:"hidden"===p.type&&(a=!0):"add"===p.type||"delete"===p.type?f=!0:"hidden"===p.type&&(d=!0)}}a&&c.hiddenContent("hidden-text");b&&c.hiddenContent("tracked-changes");d&&c.hiddenContent("hidden-text-unsupported");
f&&c.hiddenContent("tracked-changes-unsupported")}w.documentComplete=!0;w.documentLoaded&&c.on.done.dispatch()});ka.onresize(function(){w.editingComment?P.alignComment():c.dispatchPageEvents(!0)});z.onchange(function(){1!=z.activeOverlay().length&&"vertical"==x.scrollMode||c.dispatchPageEvents(!0)});x.oncenterPages(D);x.onrotation(D);x.onshowHiddenSheets(wa);x.onshowHiddenColumns(wa);x.onshowHiddenRows(wa);x.onshowAnnotations(wa);x.onshowSlideNotes(wa);x.onpresentationMode(wa);x.onshowHiddenContentNotification(wa);
var D=x.items(),Fa;for(Fa in D)if(x.isPublic(Fa))x["on"+Fa](ra)}}),z=Aa.extend("pages",{exports:"count current info moveto movetoNext movetoPrev pageName ranges isDocumentText".split(" "),events:{change:{pub:!0,detail:function(c){return z.info(c.index)}},add:{pub:!0,detail:function(c){return{startPage:c}}},pageload:{},pageunload:{},overlayshow:{},overlayhide:{}},install:function(c){var e=[],a=[],b=null,d=null,g=null,k=0,m=1,r,t,u,n=0,q=0,l=0,I,L,K,H={},N={},C,Q;c.firstPage=function(){var b,d;for(d in a){b=
a[d];break}return b};c.lastPage=function(){var b,d;for(d in a)b=a[d];return b};c.current=function(){return d?d.index:0};c.pageName=function(b){void 0===b&&(b=c.current());if(b=a[b])return b.name};c.count=function(){return a.length};c.each=function(b,d){Ab(a,arguments)};c.eachOverlay=function(a,b){Ab(e,arguments)};c.moveto=function(a,b){var d;Pa(b)&&(d={callbackFn:b});return c.movetoEx(a,d)};var A=function(a){c.updateActivePage(a.pageIndex);a.callbackFn&&a.callbackFn.call(null,d.index)};c.movetoEx=
function(a,b){b=b||{};w.viewNode.cancelKinetic();if("number"===typeof a)return b.pageIndex=a,h(b);if("object"===typeof a){if(y.isElement(a)||y.isText(a)){b.gotoNode=a;var f=b,e=c.forNode(f.gotoNode);e?(f.pageIndex=J(e.index),f.pageIndex!=e.index&&(f.gotoNode=null),h(f)):(c.logError("moveto","The specified node was not found on any page in the document."),A(f));return d.index}if(f=xa(a))return b.range=ga(f),B(b);if("number"===typeof a.left&&"number"===typeof a.top&&"number"===typeof a.right&&"number"===
typeof a.bottom)return b.rect=a,v(b)}c.logError("moveto","Invalid destination: "+vb(a));return d.index};var f=function(a,d){var f=a.overlay,e=f!==b;if(!d&&!e)return!1;if(e){P.deactivate();S.select(null);F.unloadDisplay();var p=b,g=w.viewNode;p&&(p.saveScroll=g.scroll(),p.undisplay());f.display()}a.load(!1,function(){b=f;c.updateActivePage(a.index);e&&F.loadDisplay(a)});f.show();f.hasClass("oit-pagestream")?w.viewNode.addClass("oit-pagestream"):w.viewNode.removeClass("oit-pagestream");f.hasClass("oit-emailfill")?
w.viewNode.addClass("oit-emailfill"):w.viewNode.removeClass("oit-emailfill");p=a.css("background")||null;w.viewNode.css("background",p);f.saveScroll?(g.scroll(f.saveScroll),delete f.saveScroll):e&&g.scroll(0,0);f.display();c.updateActivePage();return!0},h=function(e){var p=J(e.pageIndex);if(a[p])if(e.force||e.gotoNode||!d||p!=d.index){var g=a[p];c.touchPage(p);if(g.isLoaded()){p=f(g,e.force);"sn"==g.type&&(x.showSlideNotes=!0);if("vertical"!=x.scrollMode||p)e.animate=!1;c.updateActivePage(g.index);
"email"!==g.type&&F.moveto(d.index,A,e)||A(e)}else g.load(!0,function(){e.force=!0;h(e)}),"email"!==g.type&&g.overlay===b?F.moveto(g.index,null,{animate:!1}):b||f(g)}else e.pageIndex=d.index,A(e);else 0<=p&&ha.isPending()?ha.on.add.listenOnce(function(){h(e)}):(c.logError("moveto","Invalid page index: "+p),void 0!==w.singlePageIndex&&(e.pageIndex=w.singlePageIndex),A(e));if(d)return d.index},B=function(a){if(w.documentLoading)da(B,0,null,a);else{var b=c.nearestForRange(a.range);if(b)if(b.isPending())f(b),
b.load(!0,function(){B(a)});else if(!d||b.overlay!==d.overlay||"vertical"!=x.scrollMode&&b!==d)b.overlay.show(),h({pageIndex:b.index,callbackFn:function(){B(a)}});else{if("sn"==b.type){x.showSlideNotes=!0;var e=c.page(b.index-1);"slide"==e.type&&e.hiddenFromSlideshow&&(x.presentationMode="normal")}else"slide"==b.type&&b.hiddenFromSlideshow&&(x.presentationMode="normal");F.loadRange(a.range,function(){if(!F.moveto(a.range,A,a))if(c.inAnnotation(a.range)){var d=b.annotationPane();d&&d.activate(a.range,
!0,!1,a.callbackFn)}else(d=F.rangeRect(a.range,"view"))?(a.rect=d,v(a)):(a.pageIndex=b.index,h(a))})}else ha.isPending()?ha.on.add.listenOnce(function(){B(a)}):(c.logError("moveto","The specified range was not found in the document: "+vb(a.range)),A(a))}return d.index},v=function(a){var b=a.rect,c=w.viewNode,f=c.scroll(),e=F.scrollPadding(),p=b.left+f.left,g=b.right+f.left,h=b.top+f.top,l=b.bottom+f.top,k=f.left,B=f.left+c.clientWidth,v=f.top,q=f.top+c.clientHeight;e&&(e.left&&(k+=e.left),e.right&&
(B-=e.right),e.top&&(v+=e.top),e.bottom&&(q-=e.bottom));var b=f.left,n=f.top;!0===a.moveToTop?n=h:h<v?(l-=c.clientHeight,0>l&&(l=0),v=20,e&&e.top&&(v+=e.top),n=h-v,n<l&&(n=l)):l>q&&(v=20,e&&e.bottom&&(v+=e.bottom),n=l+v-c.clientHeight,n>h&&(n=h));p<k?(g=p-c.clientWidth,0>g&&(g=0),v=20,e&&e.left&&(v+=e.left),b=p-v,b<g&&(b=g)):g>B&&(v=20,e&&e.right&&(v+=e.right),b=g+v-c.clientWidth,b>p&&(b=p));b!=f.left||n!=f.top?(E.on.scrollupdate.disable(),f=w.deType,f=!a.moveToTop&&"worksheet"!=f&&"database"!=f,
a.animate||(f=!1),f=f?150:0,c.abortAnimation(),c.animate({scrollLeft:b,scrollTop:n,time:f,endFn:function(){E.on.scrollupdate.enable();E.on.scrollupdate.dispatch();A(a)}})):A(a);return d.index};c.movetoPrev=function(a){var b=c.prev();b?c.moveto(b.index,a):a&&a.call(null,d.index);return d.index};c.movetoNext=function(a){var b=c.next();b?c.moveto(b.index,a):a&&a.call(null,d.index);return d.index};c.info=function(b){void 0===b&&(b=c.current());if(a[b])return a[b].info()};c.next=function(b,c){var f;void 0===
b&&(b=d.index);var e=b+1;!1!==c&&a[e]&&"email"==a[b].type&&"rt"==a[e].type&&e++;if(a[e])for(;e<a.length;e++){var p=a[e];if(p&&p.isEnabled()&&!p.overlay.isHidden()&&("sn"!=p.type||x.showSlideNotes)){f=p;break}}return f};c.prev=function(b,c){var f;void 0===b&&(b=d.index);var e=b-1;!1!==c&&a[e]&&a[e-1]&&"email"==a[e-1].type&&"rt"==a[e].type&&e--;if(a[e])for(;0<=e;e--){var p=a[e];if(p&&p.isEnabled()&&!p.overlay.isHidden()&&("sn"!=p.type||x.showSlideNotes)){f=p;break}}return f};var J=function(b){var d,
c;for(c=b;c<a.length;c++)if((d=a[c])&&d.isEnabled()&&!d.overlay.isHidden())return c;for(c=b;0<c;c--)if((d=a[c])&&d.isEnabled()&&!d.overlay.isHidden())return c;return 0};c.loadNextPageFromServer=function(){var d,c;c=F.visiblePages();if(0===c.length)return!1;var f=c[0].index,e=c[c.length-1].index;0>m?(f-=3,e+=1):e+=3;0>f&&(f=0);e>=a.length&&(e=a.length-1);if(0>m){if(void 0===r||r>e)r=e;for(;r>=f;r--)(c=a[r])&&c.overlay===b&&c.isPending()&&(c.load(!1),d=!0)}else{if(void 0===r||r<f)r=f;for(;r<=e;r++)(c=
a[r])&&c.overlay===b&&c.isPending()&&(c.load(!1),d=!0)}return d};c.updateActivePage=function(a){if(b){var f=d,e=w.viewNode.scroll().top;void 0!==a?f=c.page(a)||d:1==b.length?f=b.firstPage:"vertical"==x.scrollMode&&void 0===w.singlePageIndex&&e!=k&&(a=c.mapToPage(10,20,void 0,!0))&&(f=a.page);e!=k&&(m=e<k?-1:1,k=e);if(f!=d){d=f;b=d.overlay;f=F.visiblePages();for(e=0;e<f.length;e++)c.touchPage(f[e].index);c.dispatchChange(d)}}};c.page=function(b){return a[b]};c.byName=function(b){var d,c;for(c in a)if(a[c].name===
b){d=a[c];break}return d};c.forNode=function(a){return y.wrap(a).ancestorData("page")};c.nearestForRange=function(b){var d,f,e,p=c.pagesForRange(b);if(!p&&"text"===b.type)for(f=0;f<a.length;f++)if((e=a[f])&&"drawing"===e.type&&b.accend>=e.acc&&b.acc<=e.accend){p=[e];break}if(p)if(1==p.length)d=p[0];else if((f=F.visiblePages())&&0<f.length){var g=f[0].index,h=f[f.length-1].index,l;for(f=0;f<p.length;f++)if(e=p[f],e.isEnabled()){var k=e.index,B=0;k<g?B=g-k:k>h&&(B=k-h);!d||B<l?(d=e,l=B):0===B&&(k=F.rangeRect(b,
"view"))&&0>k.bottom&&(d=e,l=B)}}return d};c.forRange=function(b,d,c){var f;if(b)switch(d=d||0,!0!==c&&(c=!1),b.type){case "text":for(;d<a.length;d++){var e=a[d];if(e&&b.accend>=e.acc&&b.acc<=e.accend&&(!0!==c||"worksheet"!==e.type&&"database"!==e.type&&"email"!==e.type||e.isLoaded()||e.load(),e.containsRange(b))){f=e;break}}break;case "cell":case "rect":b.page>=d&&b.page<a.length&&(f=a[b.page])}return f};c.inAnnotation=function(b){var d=!1;if("text"==b.type)for(var c=0;c<a.length;c++){var f=a[c];
if(f&&b.accend>=f.acc&&b.acc<=f.accend&&f.inAnnotation(b)){d=!0;break}}return d};c.pagesForRange=function(b,d){for(var f,e=0;e<a.length;){e=c.forRange(b,e,d);if(!e)break;f||(f=[]);f.push(e);e=e.index+1}return f};c.top=function(){var a=F.visiblePages();if(a&&0<a.length)return a[0].index};c.bottom=function(){var a=F.visiblePages();if(a&&0<a.length)return a[a.length-1].index};c.mapToPage=function(f,e,g,h,l,k){var p;if(g)p=g.pageRect("view");else if(d){g=d;if(g.isHidden()||"sn"===g.type&&!x.showSlideNotes)(g=
c.next(d.index))||(g=c.prev(d.index));var B=!0;!0!==h&&"email"==g.type&&(B=!1,0===g.index&&(g=2<=a.length?a[1]:null));g&&(p=g.pageRect("view"));if("vertical"==x.scrollMode&&void 0===w.singlePageIndex&&1<b.length)for(;p;)if(e<p.top){h=c.prev(g.index,!1)||g;if(h===g||0===g.index||!B&&0===h.index)break;if(h.overlay!=g.overlay)break;var v=h.pageRect("view");if(e>v.bottom){p.top-e>e-v.bottom&&(g=h,p=v);break}g=h;p=v}else if(e>p.bottom){if(g.index==a.length-1)break;h=c.next(g.index,!1)||g;if(h===g||h.overlay!=
g.overlay)break;v=h.pageRect("view");if(e<v.top){v.top-e<e-p.bottom&&(g=h,p=v);break}g=h;p=v}else break}B=!1;if(g){if(l&&(f>p.right||f>w.viewNode.clientWidth)&&g.annotationPane()){l=w.viewNode;v=l.pos(y.body);h=f+v.left;var v=e+v.top,D=g.annotationPane().contentRect(y.body);D&&(h=h+l.scrollLeft-D.left,v=v+l.scrollTop-D.top,k||0<=h&&0<=v&&h<=D.width&&v<=D.height)&&(f=h,e=v,B=!0)}if(!B&&(p&&(f-=p.left,e-=p.top),F.features().zoom&&(p=x.zoom,1!=p&&(f=M(f/p),e=M(e/p))),F.features().rotate&&(k=x.rotation,
0!==k)))switch(p=g.pageRect(),l=f,h=e,k){case 90:f=p.width-h;e=l;break;case 180:f=p.width-l;e=p.height-h;break;case 270:f=h,e=p.height-l}return{page:g,x:f,y:e,inAnnotation:B}}};c.elementRect=function(a,b){var d;d=new aa(a.rect(w.viewNode),"view");d.origin=b;return d};c.findTextRange=function(c){if("text"===c.type){var f;if("vertical"!=x.scrollMode||void 0!==w.singlePageIndex)void 0!==d.acc&&c.acc<=d.accend&&c.accend>=d.acc&&(f=d.findTextRange(c));else for(var e in a){var g=a[e];if(g.overlay===b&&
g.isLoaded()&&g.isEnabled()&&void 0!==g.acc&&c.acc<=g.accend&&c.accend>=g.acc&&(g=g.findTextRange(c)))if(f)for(var p=0;p<g.length;p++)f.push(g[p]);else f=g}return f}};var ca=function(a,b,d){var c=!1;if(d)if(Array.isArray(d))for(var f=0;f<d.length&&!(c=ca(a,b,d[f]));f++);else d.range&&"text"===d.range.type&&a<=d.range.accend&&b>=d.range.acc&&(c=!0);return c};c.isAnnotationText=function(a,b,d){var f=!1;if(d)for(var e=0;!f&&e<d.length;e++)f=d[e],f=ca(a,b,f.text)||ca(a,b,f.oldtext)||ca(a,b,f.author)||
ca(a,b,f.author_short)||ca(a,b,f.last_save_date)||ca(a,b,f.create_date)||ca(a,b,f.date);else(d=E.revisions())&&(f=c.isAnnotationText(a,b,d)),!f&&Q&&(f=c.isAnnotationText(a,b,Q.revisions));return f};c.isDocumentText=function(a,b){return c.forRange(pa(a,b),0,!0)?!0:c.isAnnotationText(a,b)};c.maxWidth=function(){if(b)return"vertical"!=x.scrollMode||void 0!==w.singlePageIndex?d.width:b.maxWidth};c.maxHeight=function(){if(b)return"vertical"!=x.scrollMode||void 0!==w.singlePageIndex?d.height:b.maxHeight};
c.decomposeRange=function(b,d){var c;if(void 0!==b.page){var f=a[b.page];if(f){if("rect"===b.type)c=f.mapRectRangeToText(b);else if("cell"===b.type){var e=f.spreadsheetModel();e&&(c=e.decomposeRange(b,d))}(f=f.mapRangeToEmbeds(b))&&(c=c?c.concat(f):f)}}return c};c.ranges=function(b){var d={};void 0===b&&(b=c.current());a[b]&&(b=a[b].textRanges())&&0<b.length&&(d.text=b);return d};var X=function(){if(w.dynamicContent){switch(x.memoryModel){case "none":l=q=0;break;case "large":q=5242880;l=100;break;
case "small":q=1048576;l=20;break;case "micro":q=524288;l=10;break;default:w.isMobile?(q=1048576,l=20):(q=5242880,l=100)}c.applyMemoryLimit()}else l=q=0};c.applyMemoryLimit=function(a){var b,d=0;if(I)for(b=I;b;)0<b.loadedSize&&d++,b=b.nextNewer;void 0!==a&&(n+=a,c.logMemory&&c.logMemory(n,q,d,l));if(0<q&&n>q||0<l&&d>l){if(I){b=I;var f=a=-1,e=F.visiblePages();0<e.length&&(a=e[0].index,f=e[e.length-1].index);for(;b;){e=b.nextNewer;if(0<b.loadedSize&&!b.locked&&(b.index<a||b.index>f)&&(n-=b.loadedSize,
b.unload(),d--,n<=q&&d<l))break;b=e}}c.logMemory&&c.logMemory(n,q,d,l)}};c.touchPage=function(b){(b=a[b])&&b!=L&&(void 0===L?I=b:(b==I&&(I=b.nextNewer),b.nextNewer&&(b.nextNewer.nextOlder=b.nextOlder),b.nextOlder&&(b.nextOlder.nextNewer=b.nextNewer),L.nextNewer=b,b.nextOlder=L,b.nextNewer=void 0),L=b)};var ma=function(){var a,d;d=(d=c.firstPage())&&d.isSpreadsheet();if(void 0===w.singlePageIndex&&(d||1<e.length)){t||(t=new $c,t.addPrevNext(function(){c.movetoPrev()},function(){c.movetoNext()}));for(d=
t.length();d<e.length;d++){a=e[d];var f=a.firstPage;if(!f)break;t.addTab(a.name,a.hidden,c.moveto,f.index);a.isHidden()&&t.hideTab(a.index)}t.show();b&&t.setActiveTab(b.index);if(Q){f=[];if(x.showAnnotations)for(d=0;d<Q.revisions.length;d++)a=Q.revisions[d],!a.page&&a.ref&&void 0!==a.ref.sheet&&(a.page=c.page(a.ref.sheet)),a.page&&("add_sheet"==a.type?f[a.page.overlay.index]="oit-anno-add":f[a.page.overlay.index]||(f[a.page.overlay.index]="oit-anno-change"));for(d=0;d<e.length;d++){var g=f[d];g||
(a=e[d],1==a.length&&a.firstPage.comments()&&(g="oit-anno-change"));t.tabClass(d,g)}}}else t&&(t.destroy(),t=null)};c.dispatchChange=function(a,b){a||(a=d);if(a==g&&!b)return!0;g=a;t&&t.setActiveTab(a.overlay.index);a.annotationPane()&&a.supportsAnnotationBar()&&c.createAnnotationBar();return c.on.change.dispatch(a)};c.overlayById=function(a){return bb(e,"id",a)};c.pageById=function(b){return bb(a,"id",b)};c.createAnnotationBar=function(){u||(u=new ad)};c.activeOverlay=function(){return b};c.activePage=
function(){return d};c.ssRevisions=function(){return Q};var O=function(){ma();k=void 0};c.updateShowSlideNotes=function(){if(!E.supressHiddenContentUpdate()){var a=F.saveScrollPos();x.showSlideNotes?E.screenCSS(".oit-sn","display:block;"):(E.screenCSS(".oit-sn",null),d&&"sn"==d.type&&(P.deactivate(),S.select(null)));c.updateActivePage();F.layoutChanged();F.restoreScrollPos(a)}};c.overlayTabRect=function(a){if(t)return t.tabRect(a.index)};c.activeAnnotationPane=function(a){if(void 0!==a&&a!==C){var b=
C;C=null;b&&b.deactivate();C=a}return C};c.deactivateAnnotation=function(){c.activeAnnotationPane(null)};c.scrollToAnnotationPane=function(a){if(x.showAnnotations&&c.activePage()&&c.activePage().supportsAnnotationPane()){var b=w.viewNode;b.animate({scrollLeft:b.scrollWidth-b.clientWidth,endFn:a})}else a&&a()};c.annotationPaneWidth=function(){return x.showAnnotations&&b&&b.hasAnnotations()&&b.firstPage.supportsAnnotationPane()?338:0};var ba=function(){!0===x.showHiddenSheets?c.eachOverlay(function(a){a.firstPage&&
"worksheet"==a.firstPage.type&&a.show()}):!1===x.showHiddenSheets&&c.eachOverlay(function(a){a.hidden&&a.firstPage&&"worksheet"==a.firstPage.type&&a.hide()})};x.onmemoryModel(X);x.onnochrome(O);x.onshowSlideNotes(c.updateShowSlideNotes);x.onscrollMode(function(){k=void 0});x.onshowHiddenSheets(ba);x.onshowSlideNotes(function(){!1===x.showSlideNotes&&"vertical"!==x.scrollMode&&"sn"===c.activePage().type&&c.movetoPrev()});x.onshowAnnotations(ma);x.onannotationSort(function(){b&&b.each(function(a){(a=
a.annotationPane())&&a.applySort()})});E.onreset(function(){for(var c in a){var f=a[c],h=f;n-=h.loadedSize;h.unload();f.destroy()}a=[];Z(e,"destroy");e=[];g=d=b=null;k=0;m=1;t&&(t.destroy(),t=null);u&&(u.destroy(),u=null);K&&(K.destroy(),K=void 0,H={},N={});q=n=0;Q=L=I=r=void 0});ha.ondata(function(b,d,f){var g;if(f=b.style){K||(K=new sb);var h=[],p=[];for(d=0;d<f.length;d++){var l=f[d];if("string"===typeof l)p.push(l);else if(l.s&&l.p){var k=l.s,l=l.p;"@font-face"===k?H.hasOwnProperty(l)||(H[l]=
!0,h.push(k,"{",l,"}")):N.hasOwnProperty(k)||(N[k]=!0,p.push(k,"{",l,"}"))}}0<h.length&&K.addCSSText(h.join(""));0<p.length&&K.addCSSText(p.join(""))}if(b.overlays)for(d=0;d<b.overlays.length;d++)f=b.overlays[d],c.overlayById(f.oid)||e.push(new Ic(e.length,f));if(b.pages){g=a.length;for(d=0;d<b.pages.length;d++){f=b.pages[d];h=null;"email"===f.type&&(w.singlePageIndex=void 0);if(void 0!==f.index){if(p=parseInt(f.index,10),void 0===w.singlePageIndex||w.singlePageIndex===p)a[p]||(a[p]=new nb(p,f.type,
f.id)),h=a[p]}else h=new nb(a.length,f.type,f.id),a.push(h);h&&h.processData(f)}c.applyMemoryLimit()}b.attachments&&(d=c.page(0))&&(d._attachments=b.attachments.slice(0));if(b.ssrevisions&&b.ssrevisions.revisions){Q=b.ssrevisions;Q.revisions.sort(function(a,b){return a.seq-b.seq});f=null;for(d=0;d<Q.revisions.length;d++)if(h=Q.revisions[d],void 0!==Ob[h.type]&&E.hiddenContent("tracked-changes"),h.cells)for(p=0;p<h.cells.length;p++)if(k=h.cells[p],k.text)for(l=0;l<k.text.length;l++)f=Db(f,k.text[l].range);
f?ia.loadRawText(f.acc,f.accend,function(){c.each("processSSRevisions");ma()}):(c.each("processSSRevisions"),ma())}b.revisions&&c.each("processRevisions");ba();ma();void 0!==g&&a.length>g&&c.on.add.dispatch(g)});ha.onadd(function(){c.updateActivePage()});E.onscrollupdate(c.updateActivePage);E.onload(function(){X();O();c.updateShowSlideNotes()});Va.onendscroll(c.updateActivePage);S.onselectionchanged(function(a,b){if(x.showAnnotations){var d=c.activeAnnotationPane();if(a){var f=c.nearestForRange(a);
f&&f.annotationPane()&&(d=f.annotationPane())}d&&b&&d.activate(a,!1,!1)}});c.onoverlayshow(function(a){t&&t.showTab(a.index)});c.onoverlayhide(function(a){t&&t.hideTab(a.index);!d||d.isEnabled()&&!d.overlay.isHidden()||(a=J(d.index),c.moveto(a))})}}),P=Aa.extend("highlights",{exports:"activate active add addMultiple addNote addStamp apply autoHighlight autoHighlightOptions clear comment current deactivate defineStamp first getJSON hide hideComment isHidden label last logVisibleHighlights moveto movetoNext movetoPrev next prev properties property range redact remove serialize setOptions show showComment style type validateStyles".split(" "),
events:{activate:{pub:!0,detail:function(c,e,a){return{highlightid:c?c.id:void 0,before:e,after:a}}},add:{pub:!0,detail:function(c){return{highlightid:c.id}}},remove:{pub:!0,detail:function(c){return{highlightid:c.id}}},move:{pub:!0,detail:function(c){return{highlightid:c.id}}},comment:{pub:!0,detail:function(c){return{highlightid:c.id}}},mode:{pub:!0,detail:function(c){return{autohighlight:c,autooptions:P.autoHighlightOptions(),selectionmode:E.selectionMode()}}}},userEventDef:{pub:!0,detail:function(c,
e,a){return{highlightid:a.id,srcEvent:e}}},install:function(c){var e={},a=function(a){var b=a.toLowerCase();e[a]={w:"border"+a+"Width",c:"border"+a+"Color",wp:"border-"+b+"-width",cp:"border-"+b+"-color",sp:"border-"+b+"-style"}};a("Top");a("Right");a("Bottom");a("Left");var b=0,d=[],g=0,k=0,m,r,t,u,n=-1,q=-1,l,I,L=!1,K=!1,H,N=!1,C=!1,Q,A={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0},f=!0,h=
[],B=!1,v={x:0,y:0},J=[];c.add=function(){var a=arguments,b=1,d={};ta(0,a,d,"add");d.invalid||(b=sa(b,a,d,"add"));d.invalid||(Array.isArray(d.range)?d.type="hl-"+d.range[0].type:Ra(d.range)||Ba(d.range)?d.type="hl-text":d.type="hl-"+d.range.type,Aa(0,a,d,"add"));d.invalid||(b=va(b,a,d,"properties","add"),b=ya(b,a,d,"comment","add"));d.invalid||ua(b,a,d,"add");if(!d.invalid)return qa(d)};c.addMultiple=function(a,b,d,f){var e=arguments,g=1,h={},p,l;ta(0,e,h,"addMultiple");if(!h.invalid){if(Array.isArray(b)){for(l=
0;l<b.length;l++){if(!xa(b[l])){h.invalid=!0;break}if(p&&p!=b[l].type){h.invalid=!0;break}p=b[l].type}g++}else h.invalid=!0;p||(h.invalid=!0);h.invalid&&c.invalidArg("addMultiple","rangeList",null,"Must be an array of ranges")}h.invalid||(h.type="hl-"+p.type,Aa(0,e,h,"addMultiple"));h.invalid||va(g,e,h,"properties","addMultiple");if(!h.invalid){e=[];c.beginBatch();for(l=0;l<b.length;l++)h.range=xa(b[l]),g=qa(h),e.push(g),f&&c.setOptions(g,f);c.endBatch();return e}};c.addNote=function(){var a=arguments,
b=1,d={type:"note"};ta(0,a,d,"addNote");d.invalid||(b=sa(b,a,d,"addNote"));d.invalid||("cell"!==d.range.type&&"rect"!==d.range.type&&(c.invalidArg("addNote","range",d.range,"Anchored notes may only be added to rect or cell ranges"),d.invalid=!0),Aa(0,a,d,"addNote"));d.invalid||(b=va(b,a,d,"properties","addNote"),b=ya(b,a,d,"comment","addNote"));d.invalid||ua(b,a,d,"addNote");if(!d.invalid)return qa(d)};c.redact=function(){var a,b=arguments,c={type:"redaction"};a=sa(0,b,c,"redact");c.invalid||(a=va(a,
b,c,"properties","redact"),a=ya(a,b,c,"label","redact"));c.invalid||ua(a,b,c,"redact");if(!c.invalid){if("compound"===x.redactionMode||"hybrid"===x.redactionMode&&"cell"===c.range.type)c.compound=!0;a:{a=c;b=!1;a.range.embedId?b=!1:"hybrid"===x.redactionMode?b="rect"===a.range.type:"simple"===x.redactionMode&&(b="rect"===a.range.type||"cell"===a.range.type);if(b){var f=z.decomposeRange(a.range);if(f){var c=[],e=a.range,g=z.page(e.page),h=F.rangeRect(e,g),p=a.activate;a.activate=!1;for(b=0;b<f.length;b++){a.range=
f[b];var l=Fa(a);-1==c.indexOf(l)&&c.push(l)}if("drawing"===g.type||"slide"===g.type||"chart"===g.type){f=0===c.length;if(!f)for(b=0;b<c.length;b++)if(l=d[c[b]].range,"rect"!==l.type){f=!0;break}else if(l=F.rangeRect(l,g),!l||!l.equals(h)){f=!0;break}f&&(a.range=e,c.unshift(Fa(a)))}if(0<c.length){p&&da(c[0]);1==c.length&&(c=c[0]);a=c;break a}}}a=qa(a)}return a}};c.apply=function(a,b){if(!Array.isArray(a)){try{a=JSON.parse(a)}catch(bd){c.invalidArg("apply","highlights",a,"Error parsing JSON string: "+
bd.message);return}a&&a.range&&"object"==typeof a.range&&(a=[a])}if(Array.isArray(a))if(w.documentLoaded){b=Pa(b)?b:null;for(var d=0;d<a.length;d++){var f=a[d];if("sdef"==f.type)c.defineStamp(f.stamp,f.url);else{var e=na();if(!b||b(e,f.properties))if(xa(f.range))if(e=[],"stamp"==f.type){var g={name:f.stamp};f.opacity&&(g.opacity=f.opacity);f.sizing&&(g.sizing=f.sizing);e.push(g);e.push(f.range);f.hasOwnProperty("properties")&&e.push(f.properties);f.hasOwnProperty("comment")&&e.push(f.comment);c.addStamp.apply(void 0,
e)}else qa(f);else c.invalidArg("apply","highlight["+d+"]",f)}}}else m=m?a.concat(m):a};c.remove=function(a,b){if(Array.isArray(a)){c.beginBatch();for(var d=0;d<a.length;d++)c.remove(a[d]);c.endBatch()}else(d=aa(a,l,"remove"))&&ca(d,b)};var ca=function(a,b){var f=a.id;void 0===b&&(b=!0);c.on.remove.dispatch(a);var e,h=!1,p=!1;f==l?(lb(b),l=void 0,void 0!=a.prevId?(e=a.prevId,p=!0):void 0!=a.nextId&&(e=a.nextId,h=!0)):b=!1;c.hideComment(f);c.unmap(a);a.destroy();d[f]=null;g--;f<k&&(k=f);void 0!==e&&
da(e,h,p,b,!1,!1)};c.removeFromRange=function(a){Array.isArray(a)?Z(a,c.removeFromRange):"text"===a.type&&c.each(X,null,a)};var X=function(a,b){var d=a.range;"text"===d.type&&d.accend>=b.acc&&d.acc<=b.accend&&c.remove(a.id,!1)};c.count=function(){return g};c.clear=function(a){a=Pa(a)?a:null;lb();c.beginBatch();c.each(ca,a,!1);c.endBatch();a||(l=void 0,d=[],k=g=0,J=[])};a=function(){var a=x.highlightLabelFontFamily,b=x.highlightLabelFontSize,d="";a&&(d+="font-family:"+a+";");b&&(d+="font-size:"+b+
";");E.screenCSS(".oit-highlight-label",d);c.each("showLabel",null,x.showHighlightLabels)};c.setOptions=function(a,b){b&&ia(a,l,"setOptions",null,[b])};c.getOption=function(a,b){return ia(a,l,"getOption",null,[b])};c.style=function(a,b){var d,f=aa(a,l,"style");if(f)if(b){var e=la(b,"hl-text"!=f.type);e?d=f.style(e):c.invalidArg("style","style",b)}else d=f.style();return d};c.comment=function(a,b,d){if(a=aa(a,l,"comment")){var f=a.comment();void 0!==b&&b!==f&&(d||a.id!==c.active()||a.isNote()?f=a.comment(b):
(c.hideComment(),f=a.comment(b),c.showComment()),c.on.comment.dispatch(a));return f}};var ma=function(a){if("scale"==a||"stretch"==a||"image"==a)return a},O=function(a){if(a&&!isNaN(a)&&(a=Number(a),0<=a&&1>=a))return a},ba=function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y))return{x:Math.round(a.x),y:Math.round(a.y)}},p=function(a){a.img=new Image;a.img.src=a.url;a.img.onload=function(){a.height=this.height;a.width=this.width;a.defaultSize&&(this.style.width=a.defaultSize.x,this.style.height=a.defaultSize.y);
delete a.img}};c.stamp=function(a){if(u)return u[a]};c.label=function(a,b){return ia(a,l,"label",null,[b])};c.defineStamp=function(a,b,d){u||(u={});b?(d=d||{},b={url:b},d.sizing&&(b.sizing=ma(d.sizing)),d.opacity&&(b.opacity=O(d.opacity)),d.defaultSize&&(b.defaultSize=ba(d.defaultSize)),u[a]=b,p(u[a])):delete u[a]};var D=function(a){var b;if(a){var d;if(a instanceof String||"string"==typeof a)d={name:a};else{d={};for(var c in a)d[c]=a[c]}d.name&&u&&u[d.name]&&(d.type="stamp",d.stamp=u[d.name],b=d)}return b};
c.addStamp=function(){var a,b=arguments,d=D(b[0]);if(d){d.sizing=ma(d.sizing)||d.stamp.sizing||"scale";d.opacity=O(d.opacity)||d.stamp.opacity||1;d.defaultSize=ba(d.defaultSize)||d.stamp.defaultSize;var f;f=sa(1,b,d,"addStamp");var e=d.range;e&&"rect"!=e.type&&"cell"!=e.type?(c.invalidArg("addStamp","range",e),d.invalid=!0):"rect"===e.type&&Nb(e)?d.range=Da(e.left,e.top,"rect",d):"cell"===e.type&&e.c1==e.c2&&e.r1==e.r2&&(d.range=Da(e.c1,e.r1,"cell",d));d.invalid||(f=va(f,b,d,"properties","addStamp"),
f=ya(f,b,d,"comment","addStamp"));ua(f,b,d,"addStamp");d.invalid||(a=qa(d))}else c.invalidArg("addStamp","stamp",b[0],"Must be the name of a defined stamp");return a};c.getJSON=function(a){if(a=aa(a,l,"getJSON"))return JSON.stringify(a.serialize())};c.serialize=function(a){var b=[],d,f;Pa(a)?d=a:Array.isArray(a)?f=a:"number"===typeof a&&(f=[a]);c.each(ja,d,b,{},f);return JSON.stringify(b,null,!1)};var ja=function(a,b,d,c){c&&-1==c.indexOf(a.id)||(a=a.serialize(),a.stamp&&!d[a.stamp]&&(b.push({type:"sdef",
stamp:a.stamp,url:u[a.stamp].url}),d[a.stamp]=!0),b.push(a))};c.properties=function(a,b){return ia(a,l,"properties",null,[b])};c.property=function(a,b,d){return ia(a,l,"property",null,[b,d])};c.current=function(){return l};c.active=function(){if(!L&&!K)return l};c.moveto=function(a){(a=aa(a,l,"moveto"))&&da(a.id,!1,!1,!0,!0,!0);return l};c.movetoNext=function(a){if(void 0===l)void 0!==r&&c.moveto(r);else{var b=l;if(L&&d[b].filter(a)&&ea(b))return c.moveto(b);for(;;){b=d[b].nextId;if(void 0===b)break;
var f=d[b];if(f.filter(a)&&(f=z.nearestForRange(f.range)))return f.isLoaded()?da(b):z.moveto(f.index,function(){c.movetoNext(a)}),b}}return l};c.movetoPrev=function(a){if(void 0===l)void 0!==t&&c.moveto(t);else{var b=l;if(K&&d[b].filter(a)&&ea(b))return c.moveto(b);for(;;){b=d[b].prevId;if(void 0===b)break;var f=d[b];if(f.filter(a)&&(f=z.nearestForRange(f.range)))return f.isLoaded()?da(b):z.moveto(f.index,function(){c.movetoPrev(a)}),b}}return l};c.type=function(a){if(a=aa(a,l,"type"))switch(a.type){case "note":case "redaction":case "stamp":return a.type;
default:return"highlight"}};c.range=function(a){if(a=aa(a,l,"range"))return a.range};c.show=function(a){if(void 0===a||Pa(a))c.beginBatch(),c.each(function(a){T(a)},a),c.endBatch();else if(Array.isArray(a)){c.beginBatch();for(var b=0;b<a.length;b++){var d=aa(a[b]);d&&T(d)}c.endBatch()}else ia(a,l,"show")};c.hide=function(a){if(void 0===a||Pa(a))c.beginBatch(),c.each(function(a){U(a)},a),c.endBatch();else if(Array.isArray(a)){c.beginBatch();for(var b=0;b<a.length;b++){var d=aa(a[b]);d&&U(d)}c.endBatch()}else ia(a,
l,"hide");c.alignHighlight()};c.isHidden=function(a){return ia(a,l,"isHidden")};c.logVisibleHighlights=function(){var a=c.first();if(void 0===a)console.log("No visible highlights.");else for(;void 0!==a;){var b=d[a];console.log("["+b.id+"]: range="+JSON.stringify(b.range)+", key="+JSON.stringify(b.key));a=c.next(a)}};c.showComment=function(a,b){Array.isArray(a)&&(a=a[0]);var f=aa(a,l,"showComment");if(f){b=b||{};b.mode||(b.mode="view");var e=c.active();if(void 0!==e&&(e=d[e],e.isNote()&&e.isEditing()))return;
if(f.isNote())switch(b.mode){case "view":f.show();f.endEditText(!0);break;case "edit":f.beginEditText(!1);break;case "new":f.beginEditText(!0)}else f.dialog(b.mode)}};c.hideComment=function(a){(a=aa(a,l,"hideComment"))&&(a.isNote()?a.collapse():a.hideDialog())};c.first=function(){return r};c.last=function(){return t};c.next=function(a){if(a=aa(a,l,"next"))return a.nextId};c.prev=function(a){if(a=aa(a,l,"prev"))return a.prevId};c.activate=function(a){(a=aa(a,l,"activate"))&&da(a.id)};c.deactivate=
function(){lb(!0)};var Y=function(a){if(a)for(var b in A)void 0!==a[b]&&(A[b]=a[b]);S.enableCellOffsets("note"===N||"stamp"===N);oa();c.on.mode.dispatch(N)};c.autoHighlightOptions=function(a){void 0!==a&&Y(a);a={};for(var b in A)a[b]=A[b];return a};c.autoHighlight=function(a,b){var d;if(!1===a){S.select(null);if(Q){d=F.features();switch(Q){case "text":d.textselection||(Q=null);break;case "rect":d.rectselection||(Q=null);break;case "cell":d.cellselection||(Q=null);break;default:Q=null}Q&&(E.selectionMode(Q),
Q=null)}N=!1;Y()}else if("selection"===a||"note"===a||"redaction"===a||"stamp"===a){b=b||{};A.comment=null;A.sticky=!1;A.properties=null;S.select(null);if("stamp"===a){if(!D(b.stamp))return c.invalidArg("autoHighlight","options.stamp",b.stamp),N=!1}else if(("selection"===a||"note"===a)&&!la(b.style,!0))return c.invalidArg("autoHighlight","options.style",b.style),N=!1;N=a;Q||(Q=E.selectionMode());if("note"===a||"redaction"===a||"stamp"===a)d=F.features(),d.rectselection||"redaction"===a&&d.rectredaction?
E.selectionMode("rect"):d.cellselection&&E.selectionMode("cell");Y(b)}return N};c.pauseAutoHighlight=function(a){C=!!a};c.beginBatch=function(){b++};c.endBatch=function(){0<b&&b--};c.batchMode=function(){return 0<b};var oa=function(){if("selection"===N||"note"===N)S.style(A.style,!1);else if("redaction"===N){var a;x.redactionFillColor&&"compound"===x.redactionMode&&"rect"===E.selectionMode()?a=x.redactionFillColor:(a=Ga(x.redactionColor),.7<a.a&&(a.a=.7),a=Ja(a.r,a.g,a.b,a.a));S.style("background-color:"+
a+";",!1)}else if("stamp"===N)if(u&&(a=u[A.stamp]),a){var b="background:url("+a.url+") no-repeat";"number"===typeof a.opacity&&1!=a.opacity&&(b+=";opacity:"+a.opacity);"scale"==a.sizing?b+=";background-size:contain":"stretch"==a.sizing&&(b+=";background-size:100% 100%");S.style(b)}else S.style(null);else S.style(null)},Da=function(a,b,d,c){var f,e;c&&(c.defaultSize&&(f=c.defaultSize.x,e=c.defaultSize.y),f||(f=c.width),e||(e=c.height));f||(f=200);e||(e=200);a=z.mapToPage(a,b);c&&(a.x-=Math.floor(f/
2),a.y-=Math.floor(e/2));return F.rangeFromRect(a.page.index,a.x,a.y,a.x+f,a.y+e,a.page,"move")},ea=function(a){return"slideshow"!=x.presentationMode?!0:(a=xa(d[a].range))&&z.nearestForRange(a)?!0:!1};c.startSelection=function(){I=c.active();lb(!1)};c.endSelection=function(){I=void 0};E.onselect(function(a,b,f,e,g){var h=!0;if(a&&N&&!C){var p=a,l="note"===N,k="stamp"===N;if(l&&!F.features().anchorednotes||(l||k)&&"text"===p.type&&!e)return!0;a=l||!0===A.comment;if(e)if((l||k)&&f&&void 0===I){var B;
k&&((b=D(A.stamp))?B=b.stamp:p=null);p&&(b=F.features(),p=b.rectselection?Da(f.x,f.y,"rect",B):b.cellselection?Da(f.x,f.y,"cell",B):null);p||S.select(null)}else S.select(null),p=null;else l&&b&&f&&"rect"===p.type&&(B=p.bottom-p.top,100>p.right-p.left&&(b.x<f.x?p.right=p.left+100:p.left=p.right-100),80>B&&(b.y<f.y?p.bottom=p.top+80:p.top=p.bottom-80));if(p&&void 0===g){var v;"text"===p.type&&(p=V.getSelection());"redaction"===N?v=c.redact(p,A.properties,A.label):k?!D(A.stamp)||"rect"!==p.type&&"cell"!==
p.type?S.select(null):v=c.addStamp(A.stamp,p,A.properties):l?"rect"===p.type||"cell"===p.type?v=c.addNote(A.style,p,A.properties):S.select(null):v=c.add(A.style,p,A.properties);if(void 0!==v){f=Array.isArray(v)?v:[v];g="string"===typeof A.comment?A.comment:void 0;for(h=0;h<f.length;h++)v=d[f[h]],v.setOptions(A),g&&v.comment(g);S.select(null);c.activate(f[0]);a&&c.showComment(f,{mode:"new"});h=!1;A.sticky||c.autoHighlight(!1)}}}return h});c.alignComment=function(){c.each("alignDialog")};F.ondisplayload(function(a,
b){n=a.index;q=b.index;c.eachOnPage("addToPage",z.page(n));q>n&&M(n+1,q)});F.ondisplayunload(function(a,b){c.each("destroyDialog");q=n=-1});z.onpageload(function(a){-1!=q&&a.index>q&&(q=z.activeOverlay().lastPage.index);0<d.length&&a.index>=n&&a.index<=q&&c.eachOnPage(function(b){b.addToPage(a.index)},a)});z.onpageunload(function(a){a.index>=n&&a.index<=q&&(c.each("removeFromPage",null,a.index),a.highlightLayer=void 0)});c.onEmailHeaderResize=function(a){c.each("addToPage",null,a);c.positionAll(z.activeOverlay())};
c.alignHighlight=function(){void 0==l||L||K||da(l,!1,!1,!1,!1,!0)};c.move=function(a,b,d,c,f,e){var g;b=b||0;c=c||0;d=d||0;f=f||0;e=e||!1;if((a=aa(a))&&(b||c||d||f)&&a.getOption("enableUserMove")){var h=ga(a.range);if("rect"===h.type){e=e?1:10;var p=F.pageRange(h.page,h.type);h.left+=b*e;h.top+=d*e;h.right+=c*e;h.bottom+=f*e;e=h.right-h.left;g=h.bottom-h.top;b&&(0>h.left?(h.left=0,c&&(h.right=e)):h.left>=h.right&&(h.left=h.right-1));c&&(h.right<=h.left?h.right=h.left+1:h.right>p.right&&(h.right=p.right,
b&&(h.left=h.right-e,0>h.left&&(h.left=0))));d&&(0>h.top?(h.top=0,f&&(h.bottom=h.top+g)):h.top>=h.bottom&&(h.top=h.bottom-1));f&&(h.bottom<=h.top?h.bottom=h.top+1:h.bottom>p.bottom&&(h.bottom=p.bottom,d&&(h.top=h.bottom-g,0>h.top&&(h.top=0))))}else"cell"===h.type&&(p=F.pageRange(h.page,h.type),h.c1+=b,h.r1+=d,h.c2+=c,h.r2+=f,e=h.c2-h.c1,g=h.r2-h.r1,b&&(h.c1<p.c1?(h.c1=p.c1,c&&(h.c2=h.c1+e)):h.c1>h.c2&&(h.c1=h.c2)),c&&(h.c2<h.c1?h.c2=h.c1:h.c2>p.c2&&(h.c2=p.c2,b&&(h.c1=h.c2-e,h.c1<p.c1&&(h.c1=p.c1)))),
d&&(h.r1<p.r1?(h.r1=p.r1,f&&(h.r2=h.r1+g)):h.r1>h.r2&&(h.r1=h.r2)),f&&(h.r2<h.r1?h.r2=h.r1:h.r2>p.r2&&(h.r2=p.r2,d&&(h.r1=h.r2-g,h.r1<p.r1&&(h.r1=p.r1)))));a.setRange(h)}};var la=function(a,b){if(!f)return a;var d;if("string"==typeof a){d=[];var c=db(a,"color");c&&d.push("color:",c,";");(c=db(a,"background-color"))&&d.push("background-color:",c,";");if(!b)(c=db(a,"text-decoration"))&&d.push("text-decoration:",c,";");else if(b&&-1!=a.indexOf("border")){c=y.create("div");c.attr("style",a);c.css("display",
"none");y.body.append(c);var e=c.computedStyle(c),h=wa(e,"Top"),g=wa(e,"Left"),p=wa(e,"Bottom"),l=wa(e,"Right");h.w&&h.w==p.w&&h.w==g.w&&h.w==l.w&&h.c==p.c&&h.c==g.c&&h.c==l.c?d.push("border:",h.w," solid ",h.c,";"):(ra(e,h,d),ra(e,g,d),ra(e,p,d),ra(e,l,d));c.destroy()}d=0===d.length?void 0:d.join("")}return d},wa=function(a,b){b=e[b];return{e:b,w:a[b.w],c:a[b.c]}},ra=function(a,b,d){b.w&&d.push(b.e.wp,",",b.w,";",b.e.sp,":solid;",b.e.cp,":",b.c,";")};c.map=function(a){if("text"===a.range.type){var b=
J[a.range.acc];void 0!==b?b instanceof Array?b.push(a.id):J[a.range.acc]=[b,a.id]:J[a.range.acc]=a.id}};c.unmap=function(a){if("text"===a.range.type){var b=J[a.range.acc];void 0!==b&&(b instanceof Array?1==b.length&&b[0]==a.id?delete J[a.range.acc]:Ka(b,a.id):b===a.id&&delete J[a.range.acc])}};var qa=function(a){var b,d,c,f,e;if(Array.isArray(a.range)){e=a.range;a.compound=e;f=e[0].acc;d=e[0].accend;for(b=1;b<e.length;b++)c=e[b],c.acc<f&&(f=c.acc),c.accend>d&&(d=c.accend);a.range=pa(f,d)}else if(Ra(a.range)||
Ba(a.range)){e=mb(a.range);if(!e)return;if(!Array.isArray(e))return a.range=e,qa(a);a.compound=e;f=e[0].acc;d=e[0].accend;for(b=1;b<e.length;b++)c=e[b],c.acc<f&&(f=c.acc),c.accend>d&&(d=c.accend);a.range=pa(f,d)}if("text"===a.range.type){if((e=z.pagesForRange(a.range))&&2<=e.length){c=a.range;f=[];var h,g;for(b=0;b<e.length;b++)d=e[b],d.overlay!=g?(h=pa(d.acc,d.accend),f.push(h),g=d.overlay):(d.acc<h.acc&&(h.acc=d.acc),d.accend>h.accend&&(h.accend=d.accend));if(1<f.length){h=[];for(b=0;b<f.length;b++)a.range=
f[b],a.range.acc<c.acc&&(a.range.acc=c.acc),a.range.accend>c.accend&&(a.range.accend=c.accend),g=Fa(a),-1==h.indexOf(g)&&h.push(g);return 0===h.length?void 0:1==h.length?h[0]:h}}}else if("rect"===a.range.type&&(d=z.page(a.range.page))&&d.isEmailHeader())return;return Fa(a)},Fa=function(a){var b;if("text"===a.range.type){var f,e=a.properties,p=a.comment,l=a.label;null===e&&(e=void 0);null===p&&(p=void 0);null===l&&(l=void 0);var k=J[a.range.acc];if(void 0!==k)if(k instanceof Array)for(var B=0;B<k.length;B++){if(f=
d[k[B]],f.matches(a.style,a.range,e,p,l)){b=f;break}}else f=d[k],f.matches(a.style,a.range,e,p,l)&&(b=f)}else b=void 0;if(!b){"text"===S.selectionType()&&S.select(null);f="rect"===a.range.type||"cell"===a.range.type;e=na();switch(a.type){case "redaction":b=new cd(e,a);break;case "note":f&&(b=new dd(e,a));break;case "stamp":f&&(b=new ed(e,a));break;default:b=new cb(e,a)}if(!b)return;d[e]=b;g++;f=!0;c.batchMode()&&(f=(f=z.forRange(b.range))&&f.spreadsheetModel()?f.spreadsheetModel().containsRange(b.range):
!1);if(f){if(f=b,f.addToDocument(),(e=ka.infoRaw())&&1557===e.fi&&"text"==f.range.type)for(e=z.count(),p=0;p<e;p++)(l=z.page(p))&&!l.isLoaded()&&l.containsRange(f.range)&&W(p,!0,f)}else h.push({type:"add",highlight:b}),G();c.link(b)}c.on.add.dispatch(b);!0===a.activate?da(b.id):v&&(c.activateNearest(v.x,v.y,null,!1),v=null);return b.id},G=function(){B||(B=!0,E.onidle(fa))},M=function(a,b){if(0!==d.length&&!c.batchMode())for(var f=a;f<=b;f++){var e=z.page(f);e&&e.isLoaded()&&(h.push({type:"addall",
pageIndex:f,loadPage:!1}),G())}},P=function(a,b){for(var d=h.length-1;0<=d;d--){var c=h[d];c.highlight!==a||b&&-1==b.indexOf(c.type)||h.splice(d,1)}},T=function(a){P(a);h.push({type:"show",highlight:a});G()},U=function(a){P(a);h.push({type:"hide",highlight:a});G()},W=function(a,b,d){h.push({type:"addtopage",pageIndex:a,loadPage:!!b,highlight:d});G()},fa=function(){F.suspendUpdate();var a=[],b;R.performance&&(b=R.performance.now());for(var f=0;0<h.length;f++){var e=h.shift();if(void 0!==e.pageIndex){var g=
z.page(e.pageIndex);if(g.isLoaded())if(void 0===e.highlight){if(g&&g.isLoaded())for(var p=0;p<d.length;p++){var l=d[p];l&&g.containsRange(l.range)&&W(e.pageIndex,!1,l)}}else e.highlight.addToPage(e.pageIndex);else if(!0===e.loadPage){var k=e;g.load(!1,function(){h.unshift(k);G()})}}else void 0!==e.highlight&&("show"===e.type&&e.highlight.isHidden()?e.highlight.show():"hide"===e.type?e.highlight.hide():(e.highlight.addToDocument(!1),a.push(e.highlight)));if(10<=f)if(void 0!==b){if(0==f%10&&50<R.performance.now()-
b)break}else if(20<=f)break}for(b=0;b<a.length;b++)c.link(a[b]);0===h.length&&B&&(B=!1,E.offidle(fa));F.resumeUpdate()};c.findNearest=function(a,b){if(void 0!==r){var c=z.mapToPage(a,b,null,!0,!0);if(c){var f=c.page;a=c.x;b=c.y;for(var e,h,g,p=0;p<d.length;p++){var l=d[p];if(l&&!l.isHidden()&&l.isOnPage(f.index)){var k=l.distanceFromPoint(f.index,a,b,c.inAnnotation);void 0!==k&&(0===k.x&&0===k.y?(e||(e=[]),e.push(l),h=k):!e&&(void 0===h||k.ay<h.ay||k.ay==h.ay&&k.ax<h.ax)&&(h=k,g=l))}}if(e)return{highlights:e,
distance:h};if(g)return{highlights:[g],distance:h}}}};c.activateNearest=function(a,b,f,e){var h=l,g=K,p=L;!1!==e&&(e=!0);if(void 0===r)v&&(v.x=a,v.y=b);else{var k=c.findNearest(a,b);if(k)if(h=void 0,p=g=!1,1<k.highlights.length){var B=c.active();if(void 0!==B)for(var q=0;q<k.highlights.length;q++)if(k.highlights[q].id==B){++q>=k.highlights.length&&(q=0);h=k.highlights[q].id;break}void 0===h&&(h=k.highlights[0].id)}else h=k.highlights[0].id,g=k.distance,p=0>g.y||0===g.y&&0>g.x,g=0<g.y||0===g.y&&0<
g.x;else{if(k=z.mapToPage(a,b,null,!0,!0))for(q=k.page,h=r;void 0!==h;h=d[h].nextId)if((k=z.forRange(d[h].range))&&k.index>=q.index){B=k;break}B||(h=t,B=z.forRange(d[h].range));B.index<q.index?g=!0:p=!0}}if(h!=l||g!=K||p!=L)return!1!==e||p||g?f||p||g||(p=!0):p=!0,da(h,p,g,!0,!1),c.active()};var lb=function(a){da(void 0,!1,!1,a)},da=function(a,b,f,e,h,g){var p;if(!H&&(a=(p=aa(a))?p.id:void 0,!0!==b&&(b=!1),!0!==f&&(f=!1),!1!==h&&(h=!0),(p=a!=l||b!=L||f!=K)&&(g=!1),p||g)){void 0!==a&&c.isHidden(a)&&
(a=void 0);if(!g){if(p=d[l])p.hideDialog(),p.deactivate();p=l;l=a;void 0!==p&&d[p]&&d[p].isEmptyRedaction()&&c.remove(p,!0);L=b;K=f}if(void 0!==l&&!b&&!f&&d[l]){p=d[l];if(h){z.moveto(p.range,function(){da(a,b,f,e,!1,!0)});return}if(p.isNote())S.select(null);else{H=p;S.select(p.range,p.id);h=ib(p.style());var k;h.color&&(k="color:"+h.color+";background-color: rgba(255,255,255,0);");S.hide(k);H=null}w.viewNode.focus();p.activate(g);p.comment()&&!p.isNote()&&c.showComment(p.id,{mode:"view"})}!1!==e&&
(p=aa(l),c.on.activate.dispatch(p,L,K))}};c.highlight=function(a){return d[a]};var ia=function(a,b,d,c,f){c=c||d;if(a=aa(a,b,d))return"string"==typeof c?a[c].apply(a,f):c.apply(null,f)},aa=function(a,b,f){var e;void 0===a&&(a=b);"number"===typeof a&&d[a]?e=d[a]:f&&c.invalidArg(f,"id",a);return e};c.link=function(a){var b=a.id;c.unlink(a,!0);if(!a.isHidden()){var f=a.generateKey();if(f)if(void 0===r)t=r=b;else for(var e=t;;){var h=d[e],g=h.key,p=!1;f.page>g.page?p=!0:f.page==g.page&&(f.y>g.y?p=!0:
f.y==g.y&&(f.x>g.x?p=!0:f.x==g.x&&b>e&&(p=!0)));if(p){e===t?t=b:(a.nextId=h.nextId,d[a.nextId].prevId=b);a.prevId=e;h.nextId=b;break}if(e===r){a.nextId=e;r=h.prevId=b;break}e=h.prevId}}};c.unlink=function(a,b){!0!==b&&a.id==l&&(lb(),l=void 0);if(void 0!==a.prevId||void 0!==a.nextId||r==a.id){var c=void 0!==a.prevId?d[a.prevId]:null,f=void 0!==a.nextId?d[a.nextId]:null;c?c.nextId=a.nextId:r=a.nextId;a.nextId=void 0;f?f.prevId=a.prevId:t=a.prevId;a.prevId=void 0}};c.positionAll=function(a){c.each("positionAll",
a);c.alignHighlight()};c.validateStyles=function(a){void 0!==a&&(f=!1!==a);return f};c.updateHighlights=function(){M(n,q);c.positionAll(z.activeOverlay())};var na=function(){for(;k<d.length&&d[k];)k++;k>=d.length&&(k=d.length,d.push(null));return k};c.each=function(a,b){Ab(d,arguments)};c.eachOnPage=function(a,b){Z(d,a,function(a){return b.containsRange(d[a].range)},b.index)};var sa=function(a,b,d,f){if(a<b.length){b=b[a];if(Array.isArray(b)){d.range=b;for(var e=0;e<b.length;e++)xa(b[e])||(d.range=
null)}else Ra(b)||Ba(b)?d.range=b:d.range=xa(b);d.range&&a++}d.range||("text"===E.selectionType()&&(d.range=V.getSelection(),d.range&&d.range.isCollapsed&&(d.range=void 0)),d.range||(d.range=E.selection()),d.range?d.activate=!0:(c.invalidArg(f,"range",null,"A range was not specified and nothing is currently selected"),d.invalid=!0));return a},ta=function(a,b,d,f){if(1>b.length||"string"!==typeof b[0])c.invalidArg(f,"style",null,"A highlight style must be specified"),d.invalid=!0},Aa=function(a,b,
d,f){var e;a<b.length&&"string"===typeof b[a]&&(e=b[a]);d.style=la(e,"hl-text"!=d.type);d.style?a++:(c.invalidArg(f,"style",e),d.invalid=!0);return a},va=function(a,b,d,c,f){a<b.length&&(b=b[a],b instanceof Object||"object"==typeof b?(d[c]=b,a++):null!==b&&void 0!==b||a++);return a},ya=function(a,b,d,c,f){a<b.length&&(b=b[a],b instanceof String||"string"==typeof b?(d[c]=b,a++):null!==b&&void 0!==b||a++);return a},ua=function(a,b,d,f){for(;a<b.length&&void 0===b[a];)a++;a<b.length&&(c.invalidArg(f,
null,null,"Unexpected argument(s)"),d.invalid=!0);return a},za=function(){c.each("updateStyle","isRedaction");oa()};x.onredactionColor(za);x.onredactionFillColor(za);x.onnochrome(function(){c.positionAll(z.activeOverlay())});x.onshowSlideNotes(c.updateHighlights);x.onshowHighlightLabels(function(a){c.each("showLabel",null,a)});x.onhighlightLabelFontFamily(a);x.onhighlightLabelFontSize(a);x.onhighlightActivationBoxColor(function(a){if(null===a)E.screenCSS(".oit-highlight-active .oit-activation","display:none;"),
E.screenCSS(".oit-highlight-embed","display:none;"),E.screenCSS(".oit-highlight-active .oit-resize div","display:none;"),E.screenCSS(".oit-text-handle div:nth-child(2)","display:none;"),E.screenCSS(".oit-text-handle div:first-child","display:none;"),E.screenCSS(".oit-text-handle",null);else if(a=Ga(a)){var b="rgb("+a.r+","+a.g+","+a.b+")",d="border:2px solid "+b+";opacity:"+a.a+";";E.screenCSS(".oit-highlight-active .oit-activation",d);d="border:1px solid "+b+";opacity:"+a.a+";";E.screenCSS(".oit-highlight-embed",
d);d="background-color:"+b+";";E.screenCSS(".oit-highlight-active .oit-resize div",d);E.screenCSS(".oit-text-handle div:nth-child(2)",d);E.screenCSS(".oit-text-handle div:first-child","border-bottom: 7px solid "+b+";");d="opacity:"+a.a+";";E.screenCSS(".oit-text-handle",d)}});a=function(a,b,d){if((a=z.activePage())&&a.isSpreadsheet()&&!d.inAnnotation())return!0;a="tap"===b.type?w.viewNode.touchPos(b):w.viewNode.mousePos(b);void 0===c.activateNearest(a.x,a.y,b,!0)&&d&&c.activate(d.id);return void 0!==
c.active()?!1:!0};c.on.click.setDefaultListener(a);c.on.tap.setDefaultListener(a);E.onscroll(function(){c.alignComment()});E.onreset(function(){c.on.removeAllElements();c.clear();b=0;d=[];k=g=0;u=t=r=m=void 0;q=n=-1;I=l=void 0;K=L=!1;H=void 0;C=N=!1;Q=void 0;A={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0};h=[];B&&(B=!1,E.offidle(fa));v={x:0,y:0};J=[]});E.onload(function(){if(m){var a=m;m=null;
c.apply(a)}});E.onzoom(function(a,b,d){c.positionAll(z.activeOverlay())});ha.ondata(function(a,b,d){a.highlights&&c.apply(a.highlights);if(a.stamps)for(var f in a.stamps)u[f]=a.stamps[f]})}}),Jc=Aa.extend("hyperlinks",{userEventDef:{pub:!0,detail:function(c,e,a){c={srcEvent:e,url:a.url};a.range&&(c.range=ga(a.range));a.alt&&(c.alt=a.alt);c.external=0!==c.url.indexOf("#");return c}},install:function(c){var e,a,b={},d=0,g=!1,k=null,m=null,r,t=function(a,b,d){if(b){var e=d+10;e>b.length&&(e=b.length);
for(;d<e;d++){var g=b[d],l=g.range;if(l)if("text"===l.type)I(a,g);else if("rect"==l.type&&l.page===a.index){if(!a.linkMap){var k=a.childByClass("oit-svg"),f=k.byClass("oit-svg-text");if(f&&0<f.length){f=f[0];a.linkMap=y.create("div","oit-area-hyperlinks");a.linkMap.attr("style",f.attr("style"));if(f.classList)for(var h=0;h<f.classList.length;h++){var B=f.classList.item(h);"oit-svg-text"!==B&&a.linkMap.addClass(B)}k.append(a.linkMap)}}a.linkMap&&(l="left:"+l.left+"px;top:"+l.top+"px;width:"+(l.right-
l.left)+"px;height:"+(l.bottom-l.top)+"px;",k=y.create("div"),k.attr("style",l),a.linkMap.append(k),c.on.addElement(k,g),l={anchorNode:k,page:a},g.anchors||(g.anchors=[]),g.anchors.push(l))}}}return d},u=function(a,b,d){if(b){var c=d+10;c>b.length&&(c=b.length);for(;d<c;d++){var e=b[d],g=e.range;if(g&&"text"===g.type){var l=a.findRange(g.acc,g.accend);l&&Z(l,"addDataToRange",null,g,e)}}}return d},n=function(a,d,c){a=0;d&&(a=d.button||0);if(0!==a||!c.targetId)return!0;k=null;(d=b[c.targetId])?(c=y.byId(c.targetId)||
d.range||d.page,void 0!==c&&z.movetoEx(c,{force:!0,moveToTop:!0}),g&&(ua.hideMessage(),g=!1)):ha.isPending()?(g||(ua.showMessage(OIT.local.PLEASE_WAIT_INITIALIZING),g=!0),k=c,ha.on.add.listenOnce(function(){k&&n(null,null,k)})):g&&(ua.hideMessage(),g=!1);return!1};c.on.click.setDefaultListener(n);c.on.tap.setDefaultListener(n);ha.ondata(function(c,g,l){var k;if(c.hyperlinks){e=e?e.concat(c.hyperlinks):c.hyperlinks;for(g=0;g<c.hyperlinks.length;g++)l=c.hyperlinks[g],l.type="hyperlink",l.id="oit-hl-"+
++d,k=l.url,0===k.indexOf("#")&&(l.targetId=k.substring(1)+"."+y.expando,l.url="#"+l.targetId);l=z.count();for(k=0;k<l;k++)(g=z.page(k))&&g.isLoaded()&&!g.isHidden()&&t(g,c.hyperlinks,0)}if(c.bookmarks){a=a?a.concat(c.bookmarks):c.bookmarks;for(g=0;g<c.bookmarks.length;g++)l=c.bookmarks[g],k=l.name,l.type="bookmark",l.id=k+"."+y.expando,b[l.id]||(b[l.id]=l);l=z.count();for(k=0;k<l;k++)(g=z.page(k))&&g.isLoaded()&&u(g,c.bookmarks,0)}});var q=function(){if(m){for(var b,d=0;d<m.length;d++){var c=m[d];
if(c.page.isLoaded()){var g=!0;c.page.isHidden()?g=!1:(e&&(c.hindex=t(c.page,e,c.hindex),c.hindex<e.length&&(g=!1)),a&&(c.bindex=u(c.page,a,c.bindex),c.bindex<a.length&&(g=!1)));g||(b||(b=[]),b.push(c))}}m=b}m||(r&&(Qa(r),r=void 0),E.offidle(q))},l=function(a,b,d){a.addDataToRange(b,d);"OIT.ihs(event)"==a.attr("onmouseover")&&a.attr("onmouseover",null);"OIT.ihs(event)"==a.attr("ontouchstart")&&a.attr("ontouchstart",null)},I=function(a,b){var d=b.range,c=a.findRange(d.acc,d.accend);c&&Z(c,l,null,d,
b)};z.onpageload(function(a,b){m||(m=[]);if(-1==m.indexOf(a)&&(m.push({page:a,hindex:0,bindex:0}),1==m.length))if("rt"!=a.type&&"sn"!=a.type||r)r=yb(q,75);else E.onidle(q)});z.onpageunload(function(a){if(e)for(var b=0;b<e.length;b++){var d=e[b];if(d.anchors)for(var g=d.anchors.length-1;0<=g;g--){var l=d.anchors[g];if(l.page===a){c.on.removeElement(l.anchorNode);1==d.anchors.length?d.anchors=void 0:d.anchors.splice(g,1);break}}}delete a.linkMap});E.onreset(function(){c.on.removeAllElements();a=e=void 0;
b={};d=0;m=k=null;r&&(Qa(r),r=void 0)});hb("ihs",function(a){if(e)for(var b=mb(a.currentTarget),d,c=0;c<e.length;c++){var g=e[c];gb(b,g.range)&&(d||(d=z.forNode(a.currentTarget)),d&&I(d,g))}})}}),ob=Aa.extend("attachments",{exports:["describe","setOptions"],userEventDef:{pub:!0,detail:function(c,e,a){(c=ob.describe(a))?c.attachment=a:c={};c.srcEvent=e;return c},onListen:function(){ob.onListen()},onUnlisten:function(){ob.onUnlisten()},onAdd:function(){ob.onListen()},onRemove:function(){ob.onUnlisten()}},
install:function(c){var e=[],a,b=0;c.item=function(a){return e[a]};c.describe=function(a){var b;0===arguments.length?b=Ua(e):isNaN(a)||0<=a&&a<e.length&&(b=Ua(e[a]));return b};c.setOptions=function(b){b&&(a||(a=new sb),b.hasOwnProperty("cursor")&&a.setRule(".oit-attachedFile {cursor:"+b.cursor+"}","cursor"),b.hasOwnProperty("color")&&a.setRule(".oit-attachedFile {color:"+b.color+"}","color"))};c.onListen=function(){0===b&&w.viewNode&&w.viewNode.addClass("oit-attachevents");b++};c.onUnlisten=function(){0<
b&&0===--b&&w.viewNode&&w.viewNode.removeClass("oit-attachevents")};E.onload(function(){0<b?w.viewNode.addClass("oit-attachevents"):w.viewNode.removeClass("oit-attachevents")});E.onreset(function(){e=[];a&&(a.destroy(),a=void 0)});ha.ondata(function(a,b,c){if(a.attachments)for(c=0;c<a.attachments.length;c++)b=a.attachments[c],b.id=e.length,e.push(b);if(a.pages)for(var d=0;d<a.pages.length;d++){var g=a.pages[d].attachments;if(g)for(c=0;c<g.length;c++)b=g[c],b.id=e.length,e[b.id]=b}})}}),Kc=Aa.extend("archive",
{userEventDef:{pub:!0,detail:function(c,e,a){return{nodeid:a,name:c.text(),srcEvent:e}}}}),ya=Aa.extend("toolbars",{exports:["add","hide","remove","setSize","show"],events:{add:{pub:!0,detail:function(c,e){return{id:c,edge:e}}},remove:{pub:!0,detail:function(c,e){return{id:c,edge:e}}},show:{pub:!0,detail:function(c,e,a,b){return{id:c,edge:e,width:a,height:b}}},hide:{pub:!0,detail:function(c,e){return{id:c,edge:e}}},resize:{pub:!0,detail:function(c,e,a,b){return{id:c,edge:e,width:a,height:b}}},resizeinternal:{}},
install:function(c){var e=["left","top","right","bottom"],a=[],b,d,g=function(){$a(a,"refresh");ka.dispatchResize()};ka.onresize(g);z.onchange(function(){var a=z.activeOverlay();a!=d&&(d=a,g())});c.add=function(d,g,k){var m;if(-1===e.indexOf(d))c.invalidArg("add","edge",d,"Must be one of "+JSON.stringify(MEMORY_MODELS));else if(y.isElement(g)){var n,q=!1,l=!1,r=!1,L;k&&(k.size&&((n="auto"===k.size?k.size:xb(k.size))||c.invalidArg("add","options.size",k.size,"Must be a valid CSS length or 'auto'")),
!0===k.visible&&(q=!0),!0===k.overlay&&(l=!0),!0===k.resizable&&(r=!0),k.border&&(L=k.border));var t;b?(t=a[b],m=++b):m=b=1;k=w.viewNode;var H=k.scroll();g=new Pb(m,d,y.wrap(g),L,t);l&&g.overlay(!0);r&&g.resizable(!0);a[m]=g;n&&g.setSize(n);k.scroll(H);c.on.add.dispatch(m,d);q&&c.show(m)}else c.invalidArg("add","elem",g,"Must be a valid DOM Element");return m};c.addInternal=function(b,d){a[b]=d};c.removeInternal=function(b){var d=a[b];d&&(d.remove(),delete a[b])};c.internalParent=function(b){var d,
c;for(c in a)c=Number(c),c>b&&(void 0===d||c<d)&&(d=c);if(void 0!==d)return a[d]};c.remove=function(b){$a(a,k,b);g()};var k=function(d){var c=d.id;d.remove();for(a[c]=void 0;!a[b];)if(0>=--b){b=void 0;break}return!0};c.setSize=function(b,d){b=Number(b);var e=a[b];e&&!e.isInternal()||c.invalidArg("setSize","id",b,"Must be a valid toolbar id returned by OIT.toolbars.add");var k="auto"===d?d:xb(d);k?e&&(e.setSize(k),g()):c.invalidArg("setSize","size",d,"Must be a valid CSS length or 'auto'")};c.show=
function(b,d){$a(a,"show",b,d||{});g()};c.hide=function(b){$a(a,"hide",b);g()}}}),tb,Qb,Rb,Lc;(function(){var c=null,e={},a=0;tb=function(a,d,c,e,m,r){if(c&&"text"===d.type&&d.accend>d.acc&&(m=a.findRange(d.acc,d.accend,m))&&0<m.length)return e={type:"style",id:e,priority:r||0},"string"===typeof c?e.className=c:e.props=c,!c.color&&m[0].hasClass("oit-tt")&&(r=m[0].computedStyle().color,r=Ga(r),r.a=1,c.color=Ja(r)),Z(m,"addDataToRange",null,d,e),a.pageLayoutChanged(),m};Rb=function(a,d,c,e){c&&a&&0<
a.length&&(d={type:"style",id:d,priority:e||0},"string"===typeof c?d.className=c:d.props=c,!c.color&&a[0].hasClass("oit-tt")&&(e=a[0].computedStyle().color,e=Ga(e),e.a=1,c.color=Ja(e)),Z(a,"changeData",null,d))};Qb=function(a,d){Z(a,"removeData",null,"style",d)};Lc=function(b){b=ac(b,!0);var d=e[b];d||(d="oit-ss"+ ++a,e[b]=d,c||(c=new sb),c.addCSSText("."+d+" {"+b+"}"));return d};E.onreset(function(){c&&(c.destroy(),c=null);e={};a=0})})();Ha.extend(["page","drawing","slide","chart"],{de:"page",showhidden:!1,
cellselection:!1});Ha.extend("bitmap",{de:"page",showhidden:!1,textselection:!1,cellselection:!1,customtextselection:!1});Ha.extend("html",{de:"page",rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1,elasticScroll:!1});Ha.extend("email",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,elasticScroll:!1});Ha.extend("rt",{de:"page",rotate:!1,showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1,
elasticScroll:!1});Ha.extend("sn",{de:"page",showhidden:!1,fitpage:!1,cellselection:!1,rectselection:!1,rectredaction:!0,anchorednotes:!1});wb.extend("page",{install:function(c){var e,a=1,b=null,d,g,k,m,r,t=w.isMobileOrTablet?10:20,u=!1,n,q=0,l=0,I;c.load=function(l){e=l.overlay;a=1;b=null;d=l.type;g=void 0;if(!w.isMobile&&void 0===w.singlePageIndex)E.onidle(f);L(l);z.onadd(c,K);z.onchange(c,h);S.onbeginselection(c,p);E.onscroll(c,D);if("email"===d)ka.onresize(c,B);x.onremoveExtraEmailHeaders(c,X);
x.onscrollMode(c,ma);x.onpresentationMode(c,O);x.onnochrome(c,ba);x.onshowEmailAddresses(c,ja);x.onshowAnnotations(c,Y);ba(x.nochrome);A(l.index);Y();h()};c.unload=function(){E.screenCSS(".oit-annopane",null);z.offadd(K);z.offchange(h);S.offbeginselection(p);E.offscroll(D);ka.offresize(B);x.offremoveExtraEmailHeaders(X);x.offscrollMode(ma);x.offpresentationMode(O);x.offnochrome(ba);x.offshowEmailAddresses(ja);x.offshowAnnotations(Y);w.isMobile||E.offidle(f);g&&(g.destroy(),g=void 0);b&&b.hideStickyHeader();
e=null;a=1;b=null;k=g=r=m=d=void 0;t=w.isMobileOrTablet?10:20};c.visiblePages=function(){var a=[];if("email"===d)e.each(function(b){a.push(b)});else if("vertical"==x.scrollMode&&void 0===w.singlePageIndex){var b=z.count(),c,f,h,g=z.current();for(c=g-1;0<=c;c--)if((f=z.page(c))&&f.isEnabled()){if(f.overlay!=e)break;h=f.pageRect("view");if(0>=h.bottom)break;g=c}a.push(z.page(g));var p=w.viewNode.clientHeight-10;for(c=g+1;c<b;c++)if((f=z.page(c))&&f.isEnabled()){if(f.overlay!=e)break;h=f.pageRect("view");
if(h.top>p)break;10<h.bottom&&a.push(f)}}else a.push(z.activePage());return a};c.saveScrollPos=function(){var a=z.page(c.visiblePages()[0]);if(a){var b=a.pageRect("view");return{page:a,offset:b.top/b.height}}};c.restoreScrollPos=function(a){if(a&&a.page&&void 0!==a.offset){var b=a.page.pageRect("view");(a=b.top-a.offset*b.height)&&w.viewNode.dscroll(void 0,a)}};c.scrollPadding=function(){if(b)return b.scrollPadding()};c.margin=function(){return{left:t,top:t,right:t,bottom:t}};var L=function(a){if(a._emailHeader){b=
a._emailHeader;b.applyShowEmailAddresses();var d=a.overlay.firstPage,c=z.page(d.index+1);d&&d.load(!0,function(){c?c.load(!0,function(){c.parent()!=d.parent()&&d.parent().append(c);B()}):B()})}};c.layoutChanged=function(b){if(e){var d=w.viewNode,c=x.zoom;b||(b={x:0,y:0});var f=d.scroll(),g=null,p=null,l;l=t/x.zoom;1!=c&&(g=["scale(",c,",",c,")"].join(""),p="left top");l=2*l+z.annotationPaneWidth();l="vertical"==x.scrollMode?l+e.maxWidth:l+z.activePage().width;e.css({transform:g,"transform-origin":p,
"min-width":l+"px"});H();g=c/a;d.scroll((b.x+f.left)*g-b.x,(b.y+f.top)*g-b.y);a=c;h()}};var K=function(a){I||(I=da(function(){I=void 0;H(!0);A()},500))},H=function(a){if(e){var b=x.rotation,c={yOffset:0,maxWidth:0,height:0},f=z.top(),h=[],p=x.centerPages,l=t/x.zoom;if("email"===d)p=!1,h.push(".oit-emailbk{"),h.push("margin:",l,"px"),h.push("}"),h.push(".oit-email-stickyheader{"),h.push("left:",l,"px"),h.push("}");else if("html"===d||"rt"===d)p=!1;if(p){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");
h.push("margin:",l,"px 0 ",l/2,"px 0");h.push("}");h.push(".oit-sn{");h.push("margin:0 0 ",2*l,"px 0");h.push("}");if(!x.nochrome&&0!==b){h.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");switch(b){case 90:h.push("box-shadow:-1px 1px 5px 0 rgba(0,0,0,.25) !important");break;case 180:h.push("box-shadow:-1px -1px 5px 0 rgba(0,0,0,.25) !important");break;case 270:h.push("box-shadow:1px -1px 5px 0 rgba(0,0,0,.25) !important")}h.push("}")}h.push(".oit-page:last-of-type,.oit-bitmap:last-of-type,.oit-drawing:last-of-type,.oit-slide:last-of-type,.oit-chart:last-of-type,.oit-sn:last-of-type{margin-bottom:",
l,"px;}")}"vertical"==x.scrollMode?e.each(N,null,h,b,p,l,c):N(z.activePage(),h,b,p,l,c);0===c.maxWidth?e.css("width",null):(c.maxWidth+=t+t,e.css("width",c.maxWidth+"px"));0===c.height?e.css("height",null):(c.height+=t,e.css("height",c.height+"px"));h=h.join("");g||(g=new sb);g.setCSSText(h);!f||k||a||"vertical"!=x.scrollMode||void 0!==w.singlePageIndex||(a=x.disableAnimation,x.disableAnimation=!0,z.moveto(f),x.disableAnimation=a);e.each(function(a){a.pageLayoutChanged();a.positionAnnotations()});
P.positionAll(e)}},N=function(a,b,c,f,e,h){var g=0,p=0,l,k=w.viewNode.clientWidth,B=z.annotationPaneWidth();a.resetCache();if("sn"==a.type)f&&(g=(k/x.zoom-(a.offsetWidth+B))/2,g<e&&(g=e)),p=h.yOffset;else{if("email"===d||"html"===d||"rt"===d)c=0;switch(c){case 0:f&&(g=(k/x.zoom-(a.offsetWidth+B))/2,g<e&&(g=e));break;case 90:f&&(p=(k/x.zoom-(a.offsetHeight+B))/2,p<e&&(p=e));g=-h.yOffset-a.offsetWidth;h.yOffset=h.yOffset-a.offsetHeight+a.offsetWidth;a.offsetHeight>h.maxWidth&&(h.maxWidth=a.offsetHeight);
h.height+=a.offsetWidth+t;l="rotate(270deg) ";break;case 180:f&&(g=-((k/x.zoom-(a.offsetWidth+B))/2),g>-e&&(g=-e));g-=a.offsetWidth;p=-a.offsetHeight;l="rotate(180deg) ";break;case 270:f&&(p=-((k/x.zoom-(a.offsetHeight+B))/2),p>-e&&(p=-e)),p-=a.offsetHeight,g=h.yOffset,h.yOffset=h.yOffset-a.offsetHeight+a.offsetWidth,a.offsetHeight>h.maxWidth&&(h.maxWidth=a.offsetHeight),h.height+=a.offsetWidth+t,l="rotate(90deg) "}}g=M(g);p=M(p);if(0!==g||0!==p||l){b.push("#",a.id.replace(/\./g,"\\."));b.push(" {");
if(0!==g||0!==p||l)b.push(Za.transform,":"),l&&b.push(l),0===g&&0===p||b.push("translate(",g,"px,",p,"px)"),b.push(";");b.push("}")}};c.moveto=function(a,c,f){var e=!1,h;f=f||{};if(gc(a))if(b)e=b.moveto(a,c,f);else{if("slide"==d&&(h=z.forRange(a))&&h.annotationPane()){var g=h.annotationPane().range();gb(g,a)&&h.annotationPane().activate(a,!0,!0,c,f)}}else"number"===typeof a&&(e=w.viewNode,h=z.page(a),A(h.index),(a=f.gotoNode)&&a!==h?a=z.elementRect(a,"overlay"):(a=h.pageRect("overlay").clone(),a.top-=
t),h=e.scroll().top,a=h+(a.top-h),0>a&&(a=0),a!=h?(E.on.scrollupdate.disable(),e.abortAnimation(),h=!1!==f.animate?150:0,k=!0,e.animate({scrollTop:a,time:h,endFn:C,args:[c,f]})):c&&c(f),e=!0);return e};var C=function(a,b,d){k=!1;E.on.scrollupdate.enable();E.on.scrollupdate.dispatch();b&&b(d)},Q=function(a){"sn"!=a.type&&(r&&a.hiddenFromSlideshow?a.hide():a.show())},A=function(a){var b=!1;"vertical"===x.scrollMode&&void 0===w.singlePageIndex?w.viewNode.removeClass("oit-single"):w.viewNode.addClass("oit-single");
if("vertical"==x.scrollMode&&void 0===w.singlePageIndex||"email"===d||"html"===d||"rt"===d)void 0!==m&&(e.showPages(),m=void 0,b=!0,r=!1),a="slideshow"==x.presentationMode,a!=r&&(r=a,b=!0,e.each(Q));else if(a=a||z.current(),a!=m){var c=z.page(a);if(c){var f;void 0===m?e.hidePages(c.index):(f=z.page(m),c.addClass("oit-noshadow"));c.show({insertLast:!0,animate:!0,endFn:function(){c.removeClass("oit-noshadow");f&&f.hide()}});m=a;b=!0;w.isMobileOrTablet&&e.css("min-height",c.height+t+t+"px")}}b&&(E.dispatchPageEvents(!0),
P.positionAll(e))};c.pageRange=function(a,b){if("rect"===b){var d=z.page(a);if(d)return d=d.pageRect(),Cb(a,0,0,d.width,d.height)}};c.rangeRect=function(a,b,d,c){var f;if("text"===a.type){var e=z.forRange(a);e&&(f=e.textBoundingRect(a,c))}else"rect"===a.type&&(f=new aa(a),void 0!==a.embedId&&((c=z.page(a.page))&&(e=c.embeddingRect(a.embedId)),e?f.offset(e.left,e.top):f=void 0));f&&(f.origin=b);return f};c.rangeFromRect=function(a,b,d,c,f,e,h,g){var p;if(a=z.page(a))b=new aa(b,d,c,f,e),b.origin=a,
d=void 0!==g?a.embeddingRect(g):a.pageRect(),"html"!==a.type&&"rt"!==a.type&&"sn"!==a.type&&("move"===h?b.constrain(d):"select"!==h&&b.intersect(d)),void 0!==g?(b.offset(-d.left,-d.top),p=b.toRange(a),p.embedId=g,va(p,"pct")):p=b.toRange(a);return p};c.extendRange=function(a,b,d,f){var e=c.rangeRect(a,f);return c.rangeFromRect(a.page,e.left,e.top,b,d,f,"extend")};var f=function(a){if(!a)return z.loadNextPageFromServer()||E.offidle(f),!1},h=function(){if(!w.isMobile&&void 0===w.singlePageIndex)E.onidle(f);
w.viewNode.scroll();for(var a=F.visiblePages(),b=0;b<a.length;b++){var d=a[b];d&&d.isPending()&&d.load(!1)}},B=function(){e.each(ca);b&&b.applyViewSize()},v=function(){if("email"===d){var a=w.viewNode.clientWidth-146;30>a&&(a=30);return a}},J=function(){if(this.hasClass("oit-ximage"))this.css("max-width",null),this.removeClass("oit-ximage"),this.addClass("oit-cimage");else if(this.hasClass("oit-cimage")){var a=v();this.css("max-width",""+a+"px");this.addClass("oit-ximage");this.removeClass("oit-cimage")}B();
z.each("pageLayoutChanged")},ca=function(a){if(a.hasClass("oit-rt")&&a.isLoaded()){var b=v();if(b!==a.pageContentMaxWidth){a.pageContentMaxWidth=b;for(var d,c,f=0;;f++){var e=a.embeddingByIndex(f);if(!e)break;var h=y.byId(e.id);if(h&&(b&&(e.w>b?(h.hasClass("oit-cimage")||(h.css("max-width",""+b+"px"),h.addClass("oit-ximage")),h.onclick(J),h.ontap(J)):(h.css("max-width",null),h.removeClass("oit-ximage"),h.removeClass("oit-cimage"),h.offclick(J),h.offtap(J))),e=z.elementRect(h,a))){if(void 0===d||e.right>
d)d=e.right;if(void 0===c||e.bottom>c)c=e.bottom}}void 0!==d&&a.css("min-width",d+10+"px");void 0!==c&&a.css("min-height",c+10+"px");if(b&&(d=a.childByTagName("div"))&&(d=d.childrenByTagName("TABLE")))for(c=0;c<d.length;c++)d[c].css("max-width",""+b+"px");a.pageLayoutChanged()}}},X=function(a){b&&a&&b.removeExtraEmailHeaders()},ma=function(){e&&(A(),w.viewNode.scroll(0,0),z.updateActivePage())},O=function(){e&&A()},ba=function(a){e&&(t=a?0:w.isMobileOrTablet?10:20,A())},p=function(){b&&b.beginSelection()};
c.startElasticScroll=function(){var a=x.scrollMode;"hswipe"!==a&&"vswipe"!==a||!F.features().elasticScroll||(w.viewNode.css("overflow","hidden"),u=!0,l=q=0)};c.elasticScroll=function(a,b){if(u){var d=x.scrollMode,c="hswipe"===d,d="vswipe"===d,f=0,h=0;void 0!==a&&c&&(q=f=-a,e.css("left",f+"px"));void 0!==b&&d&&(l=h=-b,e.css("top",h+"px"));if(f||h){w.viewNode.cancelKinetic();var d=z.activePage(),g=d.annotationPane();g&&g.hide();var p;if(0<f||0<h)p=z.prev(z.current());else if(0>f||0>h)p=z.next(z.current());
p&&p!==n&&(n&&(n.hide(),n.css({left:null,top:null,position:null}),n=void 0),p.overlay==d.overlay&&(h=f=0,p.index<d.index?c?f=d.pos(e).left/x.zoom-t-p.width:h=d.pos(e).top/x.zoom-t-p.height:c?f=d.rect(e).right/x.zoom+t:h=d.rect(e).bottom/x.zoom+t,p.css({left:f+"px",top:h+"px",position:"absolute",transform:"none"}),p.show({animate:!1}),(g=p.annotationPane())&&g.hide(),n=p))}fb()}};c.endElasticScroll=function(a,b){if(u){u=!1;w.viewNode.css("overflow",null);var d="hswipe"===x.scrollMode;w.viewNode.cancelKinetic();
var c,f=z.activePage();d?(d=a/(f.width*x.zoom),c=a/w.viewNode.clientWidth):(d=b/(f.height*x.zoom),c=b/w.viewNode.clientHeight);c=Math.max(d,c);var h=d=0,g=f;-.25>c?g=z.prev(f.index)||f:.25<c&&(g=z.next(f.index)||f);g!==f&&(d=(w.viewNode.clientWidth-g.width*x.zoom)/2,d<t&&(d=t),c=t,h=g.pos(w.viewNode),d=q+d-h.left,h=l+c-h.top);e.animate({offsetLeft:d,offsetTop:h,time:100,transition:g!==f?"ease-in":"ease-out",endFn:function(){n&&(n!==g&&n.hide(),n.css({left:null,top:null,transform:null}),n=void 0);
e.css({left:null,top:null});g!==f&&(z.deactivateAnnotation(),w.viewNode.scroll(0,0),z.movetoEx(g.index,{animate:!1}),P.eachOnPage("addToPage",g));if(x.showAnnotations){var a=g.annotationPane();a&&a.show()}fb()}});fb()}};var D=function(){if(b)b.onScroll()},ja=function(){b&&b.applyShowEmailAddresses()},Y=function(){var a=x.showAnnotations;if(a){var b=z.activePage();b&&!b.supportsAnnotationBar()&&E.screenCSS(".oit-annopane","width:338px !important;");z.scrollToAnnotationPane(P.updateHighlights)}else z.deactivateAnnotation(),
E.screenCSS(".oit-annopane",null);e.each(function(b){(b=b.annotationPane())&&(a?b.show():b.hide())});E.dispatchPageEvents()}}});Ha.extend(["worksheet","database"],{de:"ss",rotate:!1,textselection:!1,rectselection:!1,customtextselection:!1});wb.extend("ss",{install:function(c){var e,a,b,d,g=!1;c.load=function(g){e=g;d=b=a=null;if(a=g.spreadsheetModel())b=new fd(a,e),(g=a.showHidden())?(g={columns:g.columns,rows:g.rows},c.showHidden(g)):b.showHidden(x.showHiddenColumns,x.showHiddenRows),b.doUpdate();
x.onshowHiddenRows(c,k);x.onshowHiddenColumns(c,m);x.onshowAnnotations(c,r);r()};c.unload=function(){x.offshowHiddenRows(k);x.offshowHiddenColumns(m);x.offshowAnnotations(r);d&&ta(d);b&&b.unload();d=b=a=null};c.maxPageWidth=function(){if(b)return b.maxPageWidth()};c.maxPageHeight=function(){if(b)return b.maxPageHeight()};c.padding=function(){if(b)return b.padding()};c.scrollOffset=function(){if(b)return b.scrollOffset()};c.getSelectedText=function(){return a?a.getSelectedText():""};c.select=function(b){return a?
a.select(b):!1};c.keydown=function(d){var c=!0;if(b)switch(d.keyCode){case 33:w.viewNode.dscroll(0,-(b.visibleHeight()+1));if(d=S.cellSelection())c=b.visibleRange(),c=c.r2-c.r1+1,d.c2=d.c1,d.r1-=c,0>d.r1&&(d.r1=0),d.r2=d.r1,S.select(d);c=!1;break;case 34:w.viewNode.dscroll(0,b.visibleHeight()+1);if(d=S.cellSelection())c=b.visibleRange(),c=c.r2-c.r1+1,d.c2=d.c1,d.r1+=c,c=a.rowCount()-1,d.r1>c&&(d.r1=c),d.r2=d.r1,S.select(d);c=!1;break;case 35:g=!g;c=!1;break;case 36:b.scrollToRange(0,0,0,0);d=sa(e.index,
0,0);S.select(d);c=g=!1;break;case 27:b.hidePopup(!0);c=g=!1;break;case 37:case 38:case 39:case 40:break;default:g=!1}return c};c.loadRange=function(b,d){a&&a.loadRange(b,d)};c.expandRange=function(b){a&&(b=a.expandRange(b));return b};c.moveto=function(a,d,c){return b?b.moveto(a,d,c):!1};c.showHidden=function(d){void 0===d&&(d="all");var c=a.showHidden(d);"string"===typeof d&&(d=c);b&&b.showHidden(d.columns,d.rows)};var k=function(){b&&b.showHidden(void 0,x.showHiddenRows)},m=function(){b&&b.showHidden(x.showHiddenColumns,
void 0)},r=function(){S.select(null);a&&a.showAnnotations(x.showAnnotations);b&&(b.showHidden(x.showHiddenColumns,x.showHiddenRows),b.update())};c.pageRange=function(b,d){if("cell"===d&&b==e.index)return sa(b,0,0,a.colCount()-1,a.rowCount()-1)};c.pageRect=function(a,d){if(b)return b.pageRect(a,d)};c.rangeRect=function(a,d,c){if(b)return b.rangeRect(a,d,c)};c.rangeFromRect=function(a,d,c,e,g,k,m,u){if(b)return b.rangeFromRect(a,d,c,e,g,k,m,u)};c.extendRange=function(a,d,c,e){if(b)return b.extendRange(a,
d,c,e)};var t=function(b,d){var c=na(b+d,0,a.colCount()-1);if(0!==d&&a.colHidden(c)){var e=a.colCount()-1;do if(c+=d,0>c){for(c=0;c<=e&&a.colHidden(c);c++);break}else if(c>e){for(c=e;0<=c&&a.colHidden(c);c--);break}while(a.colHidden(c))}return c},u=function(b,d){var c=na(b+d,0,a.rowCount()-1);if(0!==d&&a.rowHidden(c)){var e=a.rowCount()-1;do if(c+=d,0>c){for(c=0;c<=e&&a.rowHidden(c);c++);break}else if(c>e){for(c=e;0<=c&&a.rowHidden(c);c--);break}while(a.rowHidden(c))}return c};c.moveAnchor=function(d,
c,e,k){k=!1;g&&(0>c?c=-a.colCount():0<c&&(c=a.colCount()),0>e?e=-a.rowCount():0<e&&(e=a.rowCount()),g=!1);c=t(d.c1,c);e=u(d.r1,e);d.c1!=c&&(d.c1=c,k=!0);d.c2!=c&&(d.c2=c,k=!0);d.r1!=e&&(d.r1=e,k=!0);d.r2!=e&&(d.r2=e,k=!0);k&&b.scrollToRange(d.c1,d.r1,d.c1,d.r1);return k};c.incrementSelection=function(d,c,e,k,m){m=!1;g&&(0>e?e=-a.colCount():0<e&&(e=a.colCount()),0>k?k=-a.rowCount():0<k&&(k=a.rowCount()),g=!1);c.c2==d.c1?(e=t(c.c1,e),e!=c.c1&&(e<=c.c2?c.c1=e:(c.c1=c.c2,c.c2=e),m=!0)):(e=t(c.c2,e),e!=
c.c2&&(e>=c.c1?c.c2=e:(c.c2=c.c1,c.c1=e),m=!0));c.r2==d.r1?(k=u(c.r1,k),k!=c.r1&&(k<=c.r2?c.r1=k:(c.r1=c.r2,c.r2=k),m=!0)):(k=u(c.r2,k),k!=c.r2&&(k>=c.r1?c.r2=k:(c.r2=c.r1,c.r1=k),m=!0));m&&(k=c.c2==d.c1?c.c1:c.c2,d=c.r2==d.r1?c.r1:c.r2,b.scrollToRange(k,d,k,d));return m};c.layoutChanged=function(a){b&&b.layoutChanged(a)};c.update=function(a){b&&b.update(a)}}});Ha.extend(["archive","emailarchive"],{de:"arc",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,rectselection:!1,cellselection:!1,anchorednotes:!1});
wb.extend("arc",{install:function(c){var e,a,b,d,g=function(a){a.preventDefault();u(this.parentNode.parentNode.parentNode,this)},k=function(a){u(this.parentNode.parentNode.parentNode,this)},m=function(b){d=a.scroll()},r=function(b){a.autoscroll(d.left-b.delta.x,d.top-b.delta.y)},t=function(){var d=a.scroll().left;d!=b&&(b=d,0===b?e.css("margin-left",null):e.css("margin-left",-b+"px"))};c.load=function(d){e=d.childByClass("oit-tree-head");a=d.childByClass("oit-tree-nodes");b=0;a.kinetic(!0);var c=
y.byClass("oit-open-close");c&&(Z(c,"onclick",null,g),Z(c,"ontap",null,k));if(c=y.byClass("oit-tree-nname"))for(d=0;d<c.length;d++){var l=c[d],q=l.attr("data-nodeid");null!==q&&""!==q&&(q=Number(q),isNaN(q)||Kc.on.addElement(l,q))}if(c=e.byClass("oit-col-header"))for(d=0;d<c.length;d++)c[d].ctrl=new n(c[d],e),c[d].ctrl.colClass="f"+d;d=e;var u;a:{try{for(var L=V.styleSheets,c=0;c<L.length;c++){var I=L[c].cssRules||L[c].rules;if(0<I.length&&"div.f0"==I[0].selectorText){u=c;break a}}}catch(f){}u=null}d.ssIndex=
u;a.onscroll(t);a.onpanstart(m);a.onpanmove(r)};c.unload=function(){Kc.on.removeAllElements()};var u=function(a,b){var d=a.nextElementSibling;"none"!=d.style.display?(d.style.display="none",b&&b.addClass("closed")):(d.style.display="block",b&&b.removeClass("closed"))},n=function(a,b){U.call(this,"div","oit-col-dragger");this.append(y.create("div"));this.headerbar=b;var d=a.nextSiblingElem();d?e.insert(this,d):e.append(this);this.header=a;this.ondragstart(q);this.ondragmove(l);this.ondragend(I);this.ondragcancel(I)};
W(n,U);var q=function(a){this.orgwidth=this.header.clientWidth;this.overlay||(a=w.viewNode,this.overlay=y.create("div","oit-tree-overlay"),this.overlay.css({height:a.clientHeight-this.headerbar.clientHeight+"px",top:this.headerbar.clientHeight+2+"px",left:this.header.offsetLeft-3+"px"}),this.overlay.innerWidth=this.orgwidth+6,this.header.parent().append(this.overlay));return!1},l=function(a){a=this.orgwidth+a.delta.x-3;1>a&&(a=1);this.header.innerWidth=a;this.overlay.innerWidth=a+9;return!1},I=function(a){this.overlay.destroy();
delete this.overlay;this.header.css("width",null);var b=this.orgwidth+a.delta.x-3;1>b&&(b=1);b+="px";if(null!==this.headerbar.ssIndex){var d=V.styleSheets[this.headerbar.ssIndex].cssRules,c="div."+this.colClass;for(a=0;a<d.length;a++)if(d[a].selectorText==c){d[a].style.width=b;break}}else for(d=this.headerbar.parent().byClass(this.colClass),a=0;a<d.length;a++)d[a].css("width",b);return!1}}});var aa=function(){var c=function(){var a=arguments;if(1===a.length)a=a[0],void 0!==a.units?("px"!==a.units&&
(a=ga(a),va(a,"px")),this.l=a.left,this.t=a.top,this.r=a.right,this.b=a.bottom,this.o=z.page(a.page)):a.o&&(this.l=a.l,this.t=a.t,this.r=a.r,this.b=a.b,this.o=a.o);else if(2===a.length){var b=a[0];this.l=b.left;this.t=b.top;this.r=b.right;this.b=b.bottom;this.o=a[1]}else this.l=a[0],this.t=a[1],this.r=a[2],this.b=a[3],this.o=a[4];a=this.o&&("view"===this.o||"overlay"===this.o||this.o instanceof U);if(!(fa(this.l)&&fa(this.t)&&fa(this.r)&&fa(this.b)&&a))throw"Invalid Rectangle";this.l=M(this.l,1E4);
this.t=M(this.t,1E4);this.r=M(this.r,1E4);this.b=M(this.b,1E4);this.l>this.r&&(a=this.l,this.l=this.r,this.r=a);this.t>this.b&&(a=this.t,this.t=this.b,this.b=a);this.w=this.r-this.l;this.h=this.b-this.t},e=W(c);Object.defineProperties(e,{left:{enumerable:!0,get:function(){return this.l},set:function(a){this.verifyMutable();this.l=M(a,1E4);this.r=this.l+this.w}},top:{enumerable:!0,get:function(){return this.t},set:function(a){this.verifyMutable();this.t=M(a,1E4);this.b=this.t+this.h}},right:{enumerable:!0,
get:function(){return this.r},set:function(a){this.verifyMutable();this.r=M(a,1E4);this.l=this.r-this.w}},bottom:{enumerable:!0,get:function(){return this.b},set:function(a){this.verifyMutable();this.b=M(a,1E4);this.t=this.b-this.h}},width:{enumerable:!0,get:function(){return this.w},set:function(a){this.verifyMutable();0>a&&(a=0);this.w=M(a,1E4);this.r=this.l+this.w}},height:{enumerable:!0,get:function(){return this.h},set:function(a){this.verifyMutable();0>a&&(a=0);this.h=M(a,1E4);this.b=this.t+
this.h}},origin:{enumerable:!0,get:function(){return this.o},set:function(a){this.verifyMutable();this.convert(a)}}});var a=function(a,b,c){return"number"===typeof c&&(c=M(c,1E4),c!==a[b])?(a[b]=c,!0):!1};e.move=function(b,c,e,m){this.verifyMutable();b=a(this,"l",b);b|=a(this,"t",c);b|=a(this,"r",e);if(b|=a(this,"b",m))this.w=this.r-this.l,this.h=this.b-this.t;return b};e.movesize=function(b,c,e,m){this.verifyMutable();b=a(this,"l",b);b|=a(this,"t",c);b|=a(this,"w",e);if(b|=a(this,"h",m))this.r=this.l+
this.w,this.b=this.t+this.h;return b};e.offset=function(a,b){this.verifyMutable();void 0!==a&&(this.left+=a);void 0!==b&&(this.top+=b)};e.size=function(a,b){this.verifyMutable();void 0!==a&&(this.width=a);void 0!==b&&(this.height=b)};e.scale=function(a){void 0!==a&&(this.verifyMutable(),this.left*=a,this.top*=a,this.width*=a,this.height*=a)};var b=function(a,b){return a===b?!0:.999<(a>b?b/a:a/b)};e.equals=function(a){return b(this.l,a.left)&&b(this.t,a.top)&&b(this.r,a.right)&&b(this.b,a.bottom)};
e.overlaps=function(a){return this.l<a.right&&this.r>a.left&&this.t<a.bottom&&this.b>a.top};e.contains=function(a){return a.left>=this.l&&a.right<=this.r&&a.top>=this.t&&a.bottom<=this.b};e.containsPoint=function(a,b){return a>=this.l&&a<=this.r&&b>=this.t&&b<=this.b};e.union=function(a,b,c,e){if(1==arguments.length){var d=arguments[0];this.union(d.left,d.top,d.right,d.bottom)}else this.verifyMutable(),a=M(a,1E4),b=M(b,1E4),c=M(c,1E4),e=M(e,1E4),a<this.l&&(this.l=a),b<this.t&&(this.t=b),c>this.r&&
(this.r=c),e>this.b&&(this.b=e),this.w=this.r-this.l,this.h=this.b-this.t};e.intersect=function(a,b,c,e){if(1==arguments.length){var d=arguments[0];this.intersect(d.left,d.top,d.right,d.bottom)}else this.verifyMutable(),a=M(a,1E4),b=M(b,1E4),c=M(c,1E4),e=M(e,1E4),this.l=na(this.l,a,c),this.r=na(this.r,a,c),this.t=na(this.t,b,e),this.b=na(this.b,b,e),this.w=this.r-this.l,this.h=this.b-this.t};e.constrain=function(a,b,c,e){if(1==arguments.length){var d=arguments[0];this.constrain(d.left,d.top,d.right,
d.bottom)}else{this.verifyMutable();a=M(a,1E4);b=M(b,1E4);c=M(c,1E4);e=M(e,1E4);var d=c-a,g=e-b;this.width>=d?(this.l=a,this.r=c,this.w=d):this.left<a?this.left=a:this.right>c&&(this.right=c);this.height>=g?(this.t=b,this.b=e,this.h=g):this.t<b?this.top=b:this.b>e&&(this.bottom=e)}};e.clone=function(){return new c(this.left,this.top,this.right,this.bottom,this.origin)};e.toRange=function(a){var b=this;this.o!==a&&(b=this.clone(),b.origin=a);return Cb(a.index,b.left,b.top,b.right,b.bottom)};e.readonly=
function(a){"boolean"===typeof a&&(this._readonly=a);return!!this._readonly};e.verifyMutable=function(){if(this._readonly)throw"Attempted to modify a read-only Rectangle";};e.distanceFrom=function(a,b,c,e,r){a=M(a,1E4);b=M(b,1E4);switch(c){case "left":a-=this.l;break;case "center":a-=(this.l+this.r)/2;break;case "right":a-=this.r;break;case "none":a=0;break;default:a=a<this.l?a-this.l:a>this.r?a-this.r:0}switch(e){case "top":b-=this.t;break;case "middle":b-=(this.t+this.b)/2;break;case "bottom":b-=
this.b;break;case "none":b=0;break;default:b=b<this.t?b-this.t:b>this.b?b-this.b:0}if("xy"===r)r={x:a,y:b,ax:Math.abs(a),ay:Math.abs(b)};else if(0===a&&0===b)r=0;else if(r=M(Math.sqrt(a*a+b*b),10),0>b||0===b&&0>a)r=-r;return r};e.convert=function(a){var b=this.o;if(a!==b){var d,c=x.rotation,e=x.zoom;if(a instanceof nb)if("view"===b||"overlay"===b){if(d=a,(b=d.pagePos(b))&&this.offset(-b.left,-b.top),d.features().zoom&&1!=e&&this.move(this.l/e,this.t/e,this.r/e,this.b/e),d.features().rotate&&0!==c)switch(c){case 90:this.move(d.width-
this.b,this.l,d.width-this.t,this.r);break;case 180:this.move(d.width-this.r,d.height-this.b,d.width-this.l,d.height-this.t);break;case 270:this.move(this.t,d.height-this.r,this.b,d.height-this.l)}}else if(b instanceof nb)b=b.pageRect(),d=a.pageRect(),this.offset(d.left-b.left,d.top-b.top);else throw"Unsupported Rectangle conversion";else if(b instanceof nb)if("view"===a||"overlay"===a){d=b;if(d.features().rotate&&0!==c)switch(c){case 90:this.move(this.t,d.width-this.r,this.b,d.width-this.l);break;
case 180:this.move(d.width-this.r,d.height-this.b,d.width-this.l,d.height-this.t);break;case 270:this.move(d.height-this.b,this.l,d.height-this.t,this.r)}d.features().zoom&&"email"!==d.type&&"rt"!==d.type&&1!=e&&this.move(this.l*e,this.t*e,this.r*e,this.b*e);(b=d.pagePos(a))&&this.offset(b.left,b.top)}else throw"Unsupported Rectangle conversion";else if("view"===a||"overlay"===a||a instanceof U)if("view"===b)b=F.padding(),d=F.scrollOffset(),this.left=this.left-b.left+d.left,this.top=this.top-b.top+
d.top,a instanceof U&&(b=(d=a.ancestorByClass("oit-overlay"))?a.pos(d):a.pos(w.viewNode),this.left-=b.left,this.top-=b.top);else{if("overlay"===b||b instanceof U)b instanceof U&&(b=(d=b.ancestorByClass("oit-overlay"))?b.pos(d):b.pos(w.viewNode),this.left+=b.left,this.top+=b.top),"view"===a&&(b=F.padding(),d=F.scrollOffset(),this.left=this.left+b.left-d.left,this.top=this.top+b.top-d.top)}else throw"Unsupported Rectangle conversion";this.o=a}return this};return c}(),ic=function(){var c=function(a){this._rects=
[];this.add(a)},e=W(c);Object.defineProperties(e,{length:{enumerable:!0,get:function(){return this._rects.length}},left:{enumerable:!0,get:function(){return this.boundingRectangle().left}},top:{enumerable:!0,get:function(){return this.boundingRectangle().top}},right:{enumerable:!0,get:function(){return this.boundingRectangle().right}},bottom:{enumerable:!0,get:function(){return this.boundingRectangle().bottom}},width:{enumerable:!0,get:function(){return this.boundingRectangle().width}},height:{enumerable:!0,
get:function(){return this.boundingRectangle().height}}});e.item=function(a){return this._rects[a]};e.add=function(a){if(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._rects.push(a[b]);else this._rects.push(a);this._boundingRect=null}return this};e.convert=function(a){Z(this._rects,"convert",null,a);this._boundingRect=null;return this};e.boundingRect=function(){if(!this._boundingRect){for(var a=this._rects,b=a[0],d=b.left,c=b.top,e=b.right,m=b.bottom,r=1;r<a.length;r++)b=a[r],b.left<d&&(d=
b.left),b.top<c&&(c=b.top),b.right>e&&(e=b.right),b.bottom>m&&(m=b.bottom);this._boundingRect=new aa(d,c,e,m,a[0].origin)}return this._boundingRect};e.interiorRect=function(a,b){for(var d=this._rects,c=null,e=0,m=0;m<d.length;m++){var r=d[m];if(r.width>=a.width&&r.height>=a.height){c=r;break}else if(!c||r.width>c.width||r.height>c.height){var t=r.width/a.width,u=r.height/a.height,n=Math.min(t,u);b&&(t=r.height/a.width,u=r.width/a.height,n=Math.max(n,Math.min(t,u)));if(!c||n>e)c=r,e=n}}if(c)return c.clone()};
return c}(),sb=function(){var c=function(a){U.call(this,"style");a&&this.attr("media",a);this.append(y.createText(""));y.head.append(this);this.rulecount=0;this.indexLookup={};Object.defineProperty(this,"sheet",{get:function(){return this.dom.sheet}})},e=W(c,U);e.addCSSText=function(a){this.html(this.html()+a)};e.setCSSText=function(a){this.html(a)};e.setRule=function(a,b){if(b&&this.indexLookup.hasOwnProperty(b))return this.updateRuleByIndex(a,this.indexLookup[b]);try{return this.sheet.insertRule(a,
this.rulecount),b&&(this.indexLookup[b]=this.rulecount),this.rulecount++}catch(d){this.logError("setRule","Error inserting style rule: "+d.message)}};e.updateRuleByIndex=function(a,b){if(!isNaN(b)){try{this.sheet.deleteRule(b),this.sheet.insertRule(a,b)}catch(d){this.logError("updateRuleByIndex","Error updating style rule: "+d.message)}return b}};e.updateRule=function(a,b){this.indexLookup.hasOwnProperty(b)?this.updateRuleByIndex(a,this.indexLookup[b]):this.updateRuleByIndex(a,b)};e.removeFromNames=
function(a){for(var b in this.indexLookup)this.indexLookup[b]==a?delete this.indexLookup[b]:this.indexLookup[b]>a&&--this.indexLookup[b]};e.deleteRule=function(a){a=this.indexLookup.hasOwnProperty(a)?this.indexLookup[a]:a;!isNaN(a)&&a<this.rulecount&&(this.sheet.deleteRule(a),this.removeFromNames(a),this.rulecount--)};e.hasRule=function(a){return this.indexLookup.hasOwnProperty(a)};return c}(),Rc=function(){var c=function(a,b){a/=b/2;if(1>a)return.5*a*a;a--;return-.5*(a*(a-2)-1)},e={ease:c,"ease-in-out":c,
"ease-in":function(a,b){a/=b;return a*a*a},"ease-out":function(a,b){a/=b;a--;return a*a*a+1},linear:function(a,b){return a/b}},a="opacity offsetLeft offsetTop innerWidth innerHeight scrollLeft scrollTop".split(" "),b={scrollLeft:!1,scrollTop:!1},d=[],g=function(a){sc(d,"step",null,a);0<d.length&&pb(g)},k=function(a){var b=a.elem;b&&b.dom&&(b.data("_animation")===a&&b.removeData("_animation"),b.removeClass("oit-animating"));Ka(d,a)};E.onreset(function(){Z(d,"finish");d=[];for(var a in b)b.hasOwnProperty(a)&&
(b[a]=!1)});var m=function(a,b,d){b=b[a];void 0!==b&&(d[a]=b)},r=function(a,b,d){b=b[a];Pa(b)&&(d[a]=b)},t=function(a,b){var d=a[b];d&&(a.args?d.apply(a.context,a.args):d.call(a.context,a.elem))},u=function(a,b){var d=a[b];d&&a.elem&&a.elem.dom&&a.elem.css(d)},n=function(l,k){this.elem=l;this.time=void 0!==k.time?k.time:120;r("startFn",k,this);r("stepFn",k,this);r("endFn",k,this);m("context",k,this);k.args&&(this.args=Array.prototype.slice.call(k.args,0),this.args.unshift(l));m("startCSS",k,this);
m("endCSS",k,this);this.transFn=e[k.transition]||c;for(var q=x.disableAnimation||0>=this.time,u=0;u<a.length;u++){var n=a[u],t=k[n];if(void 0!==t){var C=l[n];C!=t&&(this.props||(this.props={}),this.props[n]={start:C,end:t},q|=b[n])}}q||!this.props?this.finish():(d.push(this),l.data("_animation",this),l.addClass("oit-animating"),pb(g))},q=W(n);q.isEmpty=function(){return 0>=this.time||!this.props};q.step=function(a){var b=!1,d=this.elem;d&&d.dom&&void 0===this.startTime&&(u(this,"startCSS"),t(this,
"startFn"),this.startTime=a,this.steps=0,d=this.elem);if(d&&d.dom&&(this.steps++,a-=this.startTime,a=a>=this.time?1:this.transFn(a,this.time),1>a)){var b=this.props,c;for(c in b){var e=b[c];d[c]=e.start+(e.end-e.start)*a}t(this,"stepFn");b=!0}b||this.finish();return b};q.finish=function(){var a=this.elem;if(a){var d=this.props,c;if(this.steps&&4>this.steps)for(c in d)b.hasOwnProperty(c)&&(b[c]=!0);k(this);void 0===this.startTime&&(u(this,"startCSS"),t(this,"startFn"));if(a.dom)for(c in d)a[c]=d[c].end;
u(this,"endCSS");t(this,"endFn");this.deleteAll()}};q.abort=function(){this.elem&&(k(this),this.deleteAll())};return n}(),Mc=function(){var c=[],e=OIT.DialogBox=function(a){U.call(this,"div","oit-dialog");a=a||{};this._resizable=this._moveable=this._modal=this._visible=!1;c.push(this);this.css("opacity",0);this._form=y.create("form",this);this.move(a.x,a.y,a.width,a.height);void 0!==a.className&&this.addClass(a.className);void 0!==a.moveable&&this.moveable(a.moveable);void 0!==a.resizable&&this.resizable(a.resizable);
void 0!==a.modal&&this.modal(a.modal);void 0!==a.resultFn&&(this._resultFn=a.resultFn);void 0!==a.destroyFn&&(this._destroyFn=a.destroyFn);void 0!==a.title&&this.title(a.title);void 0!==a.textColor&&this.css("color",a.textColor);void 0!==a.backgroundColor&&this._form.css("background-color",a.backgroundColor);a.cancel&&(k(this,T.CANCEL,this.cancel),this.onkeydown(m));a.ok&&k(this,T.OK,this.ok);a.no&&k(this,T.NO,this.no);a.yes&&k(this,T.YES,this.yes);w.rootNode.append(this)},a=W(e,U),b=function(a){a=
this.pos();this._dragX=a.left;this._dragY=a.top;this._header.css("cursor",Ub);return!1},d=function(a){this.move(this._dragX+a.delta.x,this._dragY+a.delta.y);this._header.css("cursor",Ub);return!1},g=function(a){this._header.css("cursor",Tb);return!1},k=function(a,b,d){a._footer||(a._footer=y.create("footer",a),a._footerVisible=!0);b=new $b(b);a._footer.append(b);b.onclick(a,d);b.ontap(a,d)},m=function(a){return 27==a.keyCode?!1:!0},r=function(a){var b=0;a._header&&(a._header.css("cursor",a._moveable?
Tb:null),b=a._header.offsetHeight);if(a._footer&&a._footerVisible)a._footer.css("display",null),a._form.css({height:null,position:"absolute",top:b+"px",left:"0px",right:"0px",bottom:a._footer.offsetHeight+"px"});else{a._footer&&a._footer.css("display","none");var d=null;0<b&&(d=a.clientHeight-b+"px");a._form.css({position:null,left:null,right:null,top:null,bottom:null,height:d})}};a.destroy=function(){this.cancel();this.show(!1,{animate:!1});this._destroyFn&&this._destroyFn(this);Ka(c,this);U.prototype.destroy.call(this)};
a.exit=function(){this.cancel();this.show(!1,{endFn:this.destroy,context:this})};a.moveable=function(a){if(!0===a||!1===a)this._moveable=a,r(this);return this._moveable};a.resizable=function(a,b,d){if((!0===a||!1===a)&&a!=this._resizable){this._resizable=a;var c,e;this._resizable?(this.addClass("oit-dialog-resizable"),void 0!==b&&(c=b+"px"),void 0!==d&&(e=d+"px")):this.removeClass("oit-dialog-resizable");this.css({"min-width":c,"min-height":e})}return this._resizable};a.modal=function(a){!0!==a&&
!1!==a||a===this._modal||(this._modal=a,ua.showModalOverlay(this._modal));return this._modal};a.title=function(a){if(a){var c;this._header||(this._header=y.create("header"),this.insert(this._header,this.firstChildElem()),this._header.ondragstart(this,b),this._header.ondragmove(this,d),this._header.ondragend(this,g),this._header.ondragcancel(this,g));c=this._header;this._title||(this._title=y.create(),c.append(this._title));this._title.html(a);this._title.css("display",null);c.addClass("oit-dialog-header-shaded");
r(this)}else null===a&&(this._title&&(this._title.destroy(),delete this._title),this._header&&(this._header.destroy(),delete this._header),r(this));return this._title?this._title.text():void 0};a.resetForm=function(){this._form.html("")};a.addLabel=function(a,b){var d=y.create("label",this._form);d.html(a);b&&b.style&&d.css(b.style);return d};a.addTextArea=function(a,b){a&&(this.addLabel(a),y.create("br",this._form));var d=new mc;this._form.append(d);b&&(b.style&&d.css(b.style),b.placeholder&&d.attr("placeholder",
b.placeholder));return d};a.show=function(a,b){!1!==a&&(a=!0);a&&(this._result=void 0);this.finishAnimation();if(this._visible==a)b&&(b.startFn&&b.startFn.call(b.context,this),b.endFn&&b.endFn.call(b.context,this));else{b=b||{};var d=0;!1!==b.animate&&(d=200);a?(this.startFn=b.startFn,this.startContext=b.context,this.animate({opacity:1,time:d,startCSS:{opacity:0,display:"block"},startFn:t,endFn:b.endFn,context:this}),this._visible=!0,this._modal&&ua.showModalOverlay(!0,d)):(this.animate({opacity:0,
time:d,startFn:b.startFn,endCSS:{display:null},endFn:b.endFn,context:b.context}),this._visible=!1,this._modal&&ua.showModalOverlay(!1,d))}return this._visible};var t=function(){r(this);this.startFn&&this.call(this.startContext,this);delete this.startFn;delete this.startContext};a.showFooter=function(a){!0!==a&&!1!==a||a===this._footerVisible||(this._footerVisible=!1!==a,r(this));return this._footerVisible};a.move=function(a,b,d,c,e){var g=w.viewNode,k=g.size(),g=g.pos();void 0===d&&(d=this.offsetWidth);
var l=k.width-10-10;d>l&&(d=l);void 0===c&&(c=this.offsetHeight);l=k.height-10-10;c>l&&(c=l);void 0!==a&&(l=g.left+k.width-10-d,a>l&&(a=l),a=M(a));void 0!==b&&(k=g.top+k.height-10-c,b>k&&(b=k),b=M(b));this._visible&&a!==this.offsetLeft||b!==this.offsetTop||d!==this.innerWidth||c!=this.innerHeight?(k=e&&!0===e.animate?200:0,e&&(this.moveOptions=e),this.css("overflow","hidden"),this.animate({offsetLeft:a,offsetTop:b,innerWidth:d,innerHeight:c,time:k,endCSS:{overflow:null},endFn:u,context:this})):e&&
e.endFn&&e.endFn.call(e.context,this)};var u=function(){r(this);var a=this.moveOptions;a&&a.endFn&&a.endFn.call(a.context,this);delete this.moveOptions};a.autoSize=function(a,b,d,c,e){(d=this.hasClass("oit-animating"))&&this.removeClass("oit-animating");var g=["width","height","display","opacity"];c=this.css(g);this.removeCSS(g);this.css("display","block");this.css("opacity","1");var g=this.offsetWidth,k=this.offsetHeight;this.css(c);d&&this.addClass("oit-animating");this.move(a,b,g,k,e)};a.maxsize=
function(a,b){var d={};void 0!=a&&(d["max-width"]=0===a?null:a+"px");void 0!=b&&(d["max-height"]=0===b?null:b+"px");this.css(d)};var n=function(a,b){a._visible||a.css("display","block");var d=a[b];a._visible||a.css("display",null);return d};a.width=function(){return n(this,"offsetWidth")};a.height=function(){return n(this,"offsetHeight")};var q=function(a,b){void 0===a._result&&(a._result=b,a._resultFn&&a._resultFn(a,b))};a.cancel=function(){q(this,!1)};a.ok=function(){q(this,!0)};a.no=function(){q(this,
0)};a.yes=function(){q(this,1)};a.result=function(){return this._result};E.onreset(function(){for(;0<c.length;)c.shift().destroy()});return e}();hb("TextRange",function(c,e){if(c>e){var a=c;c=e;e=a}this.type="text";this.acc=c;this.accend=e});hb("CellRange",function(c,e,a,b,d,g,k,m,r){var t;e>b&&(t=e,e=b,b=t);a>d&&(t=a,a=d,d=t);this.type="cell";this.page=c;this.section=z.page(c).section;this.c1=e;this.r1=a;this.c2=b;this.r2=d;void 0!==g&&(this.offsets="number"===typeof g?{left:g,top:k,right:m,bottom:r}:
{left:g.left,top:g.top,right:g.right,bottom:g.bottom})});hb("RectRange",function(c,e,a,b,d,g,k,m){var r;a>d&&(r=a,a=d,d=r);b>g&&(r=b,b=g,g=r);this.type="rect";void 0!==c&&(this.embedId=c);this.page=e;this.left=a;this.top=b;this.right=d;this.bottom=g;this.units=k;if(void 0!==m)this.section=m;else if(c=z.page(e))this.section=c.section});var Sb=function(){var c=function(a,d,c){U.call(this,"div",d);this._layer=a;this._visible=!0;c?c.append(this):a.append(this);y.attach(this);"none"===this.computedStyleProp("display")&&
(this._visible=!1);this.changed()},e=W(c,U);e.createChild=function(a){return new za(this,a)};e.layer=function(){return this._layer};e.moveToTop=function(){this.parent().append(this)};e.addClass=function(a){this.hasClass(a)||(U.prototype.addClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.removeClass=function(a){this.hasClass(a)&&(U.prototype.removeClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};e.defaultSize=function(){if(!this._defaultSize){var a=
["transform","display","width","height"],d=this.css(a);this.removeCSS(a);this._defaultSize={width:this.offsetWidth,height:this.offsetHeight};this.css(d)}return this._defaultSize};e.setDefaultSize=function(a){this._defaultSize=a};e.resetDefaultSize=function(){this._defaultSize&&(this._defaultSize=null)};e.setTitle=function(a){this.attr("title",a)};e.show=function(a){!1!==a&&(a=!0);a!==this._visible&&((this._visible=a)?(this.css("display","block"),this.changed()):this.css("display","none"));return this};
e.hide=function(){return this.show(!1)};e.visible=function(){return this._visible&&this._layer.visible()};e.layoutObject=function(){if(!this._animating&&this.visible()){var a=this.position();if(a){var d={};d.left=a.left;this._borderOffset&&(d.left-=this._borderOffset.left);d.left+="px";d.top=a.top;this._borderOffset&&(d.top-=this._borderOffset.top);d.top+="px";d.width=a.width+"px";d.height=a.height+"px";this.css(d);this._borderOffset||(this._borderOffset={left:this.clientLeft,top:this.clientTop},
this._borderOffset.left&&this.css("left",a.left-this._borderOffset.left+"px"),this._borderOffset.top&&this.css("top",a.top-this._borderOffset.top+"px"))}}return this};e.changed=function(){this._dirty||(this._dirty=!0,this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.childChanged=function(a){this._dirty||(this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};e.update=function(b){this._dirty&&(b=!0,this._dirty=
!1);b&&this.layoutObject();this.queryChildElements(a,b);return this};var a=function(a,d,c){a.update&&a.update(c)};return c}(),za=function(){var c=function(a,b){b=b||{};Sb.call(this,a.layer(),b.classList,a);this._parentObject=a;b.title&&this.setTitle(b.title);var d=b.margin||0;this._margin={left:d,top:d,right:d,bottom:d};void 0!==b.hpos&&(this._hpos=b.hpos);void 0!==b.vpos&&(this._vpos=b.vpos);!0===b.inheritMoveable&&(this.inheritMoveable=!0)},e=W(c,Sb);e.resize=function(a,b){void 0!==a||void 0!==
b?this._size&&this._size.width===a&&this._size.height===b||(this._size={width:a,height:b},this.changed()):this._size&&(delete this._size,this.changed());return this};e.setMargin=function(a,b,d,c){var e=!1;void 0!==a&&a!==this._margin.left&&(this._margin.left=a,e=!0);void 0!==b&&b!==this._margin.top&&(this._margin.top=b,e=!0);void 0!==d&&d!==this._margin.right&&(this._margin.right=d,e=!0);void 0!==c&&c!==this._margin.bottom&&(this._margin.bottom=c,e=!0);e&&(this._pos&&(this._pos=void 0),this.changed());
return this};e.position=function(){if(this._parentObject){var a=this._parentObject.position()||this._parentObject.defaultSize();if(this._pos&&a.width!=this._parentWidth||a.height!=this._parentHeight)this._pos=void 0;if(void 0===this._pos){this._parentWidth=a.width;this._parentHeight=a.height;var b,d,c,e;if("fill"===this._hpos)b=this._margin.left,c=a.width-this._margin.left-this._margin.right;else if(void 0!==this._hpos)if(c=this._size&&0<this._size.width?this._size.width:this.defaultSize().width,
"number"===typeof this._hpos)b=0<=this._hpos?this._margin.left+this._hpos:a.width-this._margin.right-c+this._hpos;else switch(this._hpos){case "left":b=this._margin.left;break;case "center":b=(a.width-c)/2;break;case "right":b=a.width-this._margin.right-c}if("fill"===this._vpos)d=this._margin.top,e=a.height-this._margin.top-this._margin.bottom;else if(void 0!==this._vpos)if(e=this._size&&0<this._size.height?this._size.height:this.defaultSize().height,"number"===typeof this._vpos)d=0<=this._vpos?this._margin.top+
this._vpos:a.height-this._margin.bottom-e+this._vpos;else switch(this._vpos){case "top":d=this._margin.top;break;case "middle":d=(a.height-e)/2;break;case "bottom":d=a.height-this._margin.bottom-e}void 0!==b||void 0!==d||void 0!==c||void 0!==e?(void 0===b&&(b=0),void 0===d&&(d=0),void 0===c&&(c=this.defaultSize().width),void 0===e&&(e=this.defaultSize().height),this._pos=new aa(b,d,b+c,d+e,"overlay")):this._pos=null}}return this._pos};return c}(),gd=function(){var c=function(a){za.call(this,a,{hpos:"center",
vpos:"middle",classList:"oit-highlight-label",inheritMoveable:!0})},e=W(c,za);e.destroy=function(){this._parentObject&&this._parentObject.attr("title",null);za.prototype.destroy.call(this)};e.setText=function(a){this._labelText=a=a||"";this.html(a);this.setTitle(a);this.resetDefaultSize();this.changed()};e.setColor=function(a,b){this.css("color",a)};e.setBoundingRect=function(a){a?this._parentRect=a.clone():delete this._parentRect;this.show()};e.position=function(){if(this._parentObject){var a=this._parentRect||
this._parentObject.position();this.css("transform",null);this.showLabelText=!0;this.html(this._labelText);var b="",d=this.defaultSize(),c=d.width+4,e=d.height+4,m=!1;if(c>a.width||e>a.height){if(c>e&&a.width<a.height||c<e&&a.width>a.height)d={width:d.height,height:d.width},c=d.width+4,e=d.height+4,b="rotate(270deg)",m=!0;if(c>a.width||e>a.height){var r=M(Math.min(a.width/c,a.height/e),1E3);.4>r?(b="",this.html(""),this.showLabelText=!1):(b+="scale("+r+","+r+")",c=d.width*r+4,e=d.height*r+4)}}this.css("transform",
b);if(this.showLabelText)return b=a.left+(a.width-c)/2,a=a.top+(a.height-e)/2,m&&(a+=e),c=b+c,e=a+e,this.show(),new aa(b,a,c,e,"overlay");this.hide()}};return c}(),hd=function(){var c=function(a){za.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation",inheritMoveable:!0})},e=W(c,za);e.setResizable=function(b){if(b){this._resizable||(this.addClass("oit-resize"),a(this,"oit-resize-n",!1,!0,!1,!1),a(this,"oit-resize-s",!1,!1,!1,!0),a(this,"oit-resize-e",!1,!1,!0,!1),a(this,"oit-resize-w",
!0,!1,!1,!1),a(this,"oit-resize-ne",!1,!0,!0,!1),a(this,"oit-resize-nw",!0,!0,!1,!1),a(this,"oit-resize-se",!1,!1,!0,!0),a(this,"oit-resize-sw",!0,!1,!1,!0));var d=b.margin||0;0>d&&this.setMargin(d,d,d,d);this._resizable=b}else this._resizable&&(this._resizeHandles&&(Z(this._resizeHandles,"destroy"),delete this._resizeHandles),delete this._resizable,this.removeClass("oit-resize"))};var a=function(a,b,c,e,n,q){b=y.create("div",b);b.ondragstart(a,d,c,e,n,q);b.ondragmove(a,g);b.ondragend(a,k);b.ondragcancel(a,
k);a.append(b);a._resizeHandles||(a._resizeHandles=[]);a._resizeHandles.push(b)},b=function(a,b,d){b=b._parentObject;b.dispatchCustom(a,{drawingRect:b,newRect:d.curRect,moved:d.resized})},d=function(a,d,c,e,g){a=this._parentObject.position();this.resizeInfo=d={left:d,top:c,right:e,bottom:g,startRect:a.clone(),curRect:a.clone(),resized:!1};b("resizestart",this,d);return!1},g=function(a){var d=this.resizeInfo;this.calculateResize(d,a);d.resized=!0;b("resizemove",this,d);if(!this._resizable.bindToObject){a=
this._parentObject.position();var c=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(c+d.curRect.left-a.left,c+d.curRect.top-a.top,c+a.right-d.curRect.right,c+a.bottom-d.curRect.bottom)}return!1},k=function(a){a=this.resizeInfo;if(!this._resizable.bindToObject){var d=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(d,d,d,d)}b("resizeend",this,a);delete this.resizeInfo;return!1};e.calculateResize=function(a,b){var d=b.delta.x,c=b.delta.y,
e=a.startRect.left,g=a.startRect.top,k=a.startRect.right,m=a.startRect.bottom;a.left?(e+=d,k-e<this._resizable.minWidth&&(e=k-this._resizable.minWidth)):a.right&&(k+=d,k-e<this._resizable.minWidth&&(k=e+this._resizable.minWidth));a.top?(g+=c,m-g<this._resizable.minHeight&&(g=m-this._resizable.minHeight)):a.bottom&&(m+=c,m-g<this._resizable.minHeight&&(m=g+this._resizable.minHeight));return e!=a.curRect.left||g!=a.curRect.top||k!=a.curRect.right||m!=a.curRect.bottom?(a.curRect.move(e,g,k,m),!0):!1};
return c}(),id=function(){var c,e=function(a){za.call(this,a,{hpos:"fill",vpos:"fill",classList:"oit-activation"});this._range=ga(a._range);this._startHandle=b(this,d);this._endHandle=b(this,g)},a=W(e,za),b=function(a,b){var d=new za(a,{hpos:0,vpos:0,classList:"oit-text-handle"});d.append(y.create("div")).append(y.create("div")).ondragstart(a,b).ondragmove(a,m).ondragend(a,r).ondragcancel(a,r);return d};a.showHandles=function(a){a=!1!==a?null:"none";this._startHandle.css("display",a);this._endHandle.css("display",
a)};var d=function(a){var b=this._range;return k(this,this._startHandle,a,b.accend,b.acc)},g=function(a){var b=this._range;return k(this,this._endHandle,a,b.acc,b.accend)},k=function(a,b,d,c,e){a._anchor=c;a._focus=e;b=b.pos(w.viewNode);d=d.center;a._adjust={x:16-(d.x-b.left),y:-(d.y-b.top)};return!1},m=function(a){var b=a.center;if(b&&(a=this._parentObject,b=z.mapToPage(b.x+this._adjust.x,b.y+this._adjust.y,null,!0,!0))){if(void 0===this._textAnchorRoot){var d=b.page.findACC(a._range.acc);this._textAnchorRoot=
d?La(d[0]):null}if(d=b.page.mapPointToText(b.x,b.y,this._textAnchorRoot))d=d.acc,d!=this._focus&&(this._focus=d,this._focus>=this._anchor?(this._range.acc=this._anchor,this._range.accend=this._focus):(this._range.acc=this._focus,this._range.accend=this._anchor),this.changed(),a.setRange(this._range),a.dispatchCustom("textmove",{range:this._range,page:b.page}))}return!1},r=function(a){a=this._parentObject;a.setRange(this._range);a.dispatchCustom("textmoveend",{range:this._range});delete this._anchor;
delete this._focus;delete this._adjust;return!1};a.layoutObject=function(){if(this.visible()){var a=this._parentObject;za.prototype.layoutObject.call(this);c||(c=this._startHandle.defaultSize());var b=this._parentObject.position();if(b){this.show();var d=t(this._startHandle,b,a.startHandleRect()),b=t(this._endHandle,b,a.endHandleRect());d||b||(d=z.pagesForRange(a._range),this.show(d&&-1!=d.indexOf(a._page)))}else this.hide()}};var t=function(a,b,d){d?(a.setMargin(d.left-b.left-c.width/2,d.bottom-
b.top-1),a.resize(c.width,c.height),a.show()):a.hide();return d};return e}(),Ta=function(){var c=function(a,b,c){Sb.call(this,b,c);this._pos=new aa(0,0,0,0,"overlay")},e=W(c,Sb);e.setLabel=function(a,b,c){if(a){if(c=c||"#FFF",a!==this._labelText||b!=this._labelColor||c!=this._backgroundColor)if(this._labelText=a,this._labelColor=b||"#000",this._labelBackground=c||"#FFF",this.setTitle(this._labelText),this._labels)for(a=0;a<this._labels.length;a++)b=this._labels[a],b.setText(this._labelText),b.setColor(this._labelColor,
this._labelBackground)}else this._labelText&&(delete this._labelText,delete this._labelColor,delete this._labelBackground,this.setTitle(""),this._labels&&(Z(this._labels,"destroy"),delete this._labels));this.changed()};e.allocateLabelChildren=function(a){this._labels||(this._labels=[]);for(;this._labels.length<a;){var b=new gd(this);this._labels.push(b);b.setText(this._labelText);b.setColor(this._labelColor,this._labelBackground)}for(;this._labels.length>a;)this._labels.pop().destroy();return this._labels};
e.labelChildCount=function(){return this._labels?this._labels.length:0};e.getLabelChild=function(a){if(this._labels)return this._labels[a]};e.move=function(d,c,e,m,r){this._pos.movesize(d,c,e,m)&&(this.changed(),this.finishAnimation(),r&&(d=this.position(),r.stepFn&&(this.stepMoveFn=r.stepFn),r.endFn&&(this.endMoveFn=r.endFn),r={offsetLeft:d.left,offsetTop:d.top,innerWidth:d.width,innerHeight:d.height,transition:r.transition||"ease",time:r.timems,startFn:r.startFn,stepFn:a,endFn:b,context:this},this._animating=
!0,this.animate(r)));return this};var a=function(a){this.update(!0);this.stepMoveFn&&this.stepMoveFn(this)},b=function(a){delete this._animating;this.changed();this.endMoveFn&&this.endMoveFn(this);delete this.stepMoveFn;delete this.endMoveFn};e.resize=function(a,b){return this.move(void 0,void 0,a,b)};e.position=function(){return this._pos};return c}(),Fb=function(){var c=function(a,b,d){Ta.call(this,a,b,d)},e=W(c,Ta);e.customEvent("resizestart");e.customEvent("resizemove");e.customEvent("resizeend");
e.activate=function(a,b){this._rectActivation||(this._rectActivation=new hd(this),b&&this.insertFirst(this._rectActivation),this._resizable&&this._rectActivation.setResizable(this._resizable));this.moveToTop();return this};e.deactivate=function(){this._rectActivation&&(this._rectActivation.destroy(),delete this._rectActivation);return this};e.resizable=function(a,b){if(!0===a){b=b||{};var d=!0,c=b.minWidth||0,e=b.minHeight||0,m=b.margin||0;!1===b.bindToObject&&(d=!1);this._resizable&&this._resizable.bindToObject==
d&&this._resizable.onResizeStart==b.onResizeStart&&this._resizable.onResize==b.onResize&&this._resizable.onResizeEnd==b.onResizeEnd&&this._resizable.onResizeCancel==b.onResizeCancel&&this._resizable.context===b.context&&this._resizable.minWidth==c&&this._resizable.minHeight==e&&this._resizable.margin==m||(this._resizable={bindToObject:d,minWidth:c,minHeight:e,margin:m},b.onResizeStart&&(this._resizable.onResizeStart=b.onResizeStart),b.onResize&&(this._resizable.onResize=b.onResize),b.onResizeEnd&&
(this._resizable.onResizeEnd=b.onResizeEnd),b.onResizeCancel&&(this._resizable.onResizeCancel=b.onResizeCancel),this._resizable.context=b.context||this,this._rectActivation&&this._rectActivation.setResizable(this._resizable))}else this._resizable&&!1===a&&(delete this._resizable,this._rectActivation&&this._rectActivation.setResizable(null));return this};e.layoutObject=function(){if(this.visible()&&!this._animating&&(Ta.prototype.layoutObject.call(this),this._labelText)){var a=this.position().clone();
a.left=0;a.top=0;this.allocateLabelChildren(1)[0].setBoundingRect(a)}return this};return c}(),jd=function(){var c=function(a,b,d){Ta.call(this,a,b,d);a=this.defaultSize();this.move(void 0,void 0,a.width,a.height)},e=W(c,Ta);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return c}(),kd=function(){var c=function(a,b,d,c){var e=["oit-badge"];d&&e.push(d);Ta.call(this,a,b,e);this.resize(20,20);this.text(c)},
e=W(c,Ta);e.activate=function(){this.addClass("oit-active");this.moveToTop();return this};e.deactivate=function(){this.removeClass("oit-active");return this};return c}(),ld=function(){var c=function(a,d,c){Ta.call(this,a,d,c);this._page=z.page(a)},e=W(c,Ta);e.customEvent("textmove");e.customEvent("textmoveend");e.activate=function(a){this._textActivation||(this._textActivation=new id(this));this._textActivation.showHandles(this._showHandles);this.moveToTop();return this};e.deactivate=function(){this._textActivation&&
(this._textActivation.destroy(),delete this._textActivation);return this};e.setRange=function(a){if(a&&"text"===a.type)if(!this._range)this._range=ga(a),this.changed();else if(this._range.acc!=a.acc||this._range.accend!==a.accend)this._range.acc=a.acc,this._range.accend=a.accend,this.changed();return this};e.showTextHandles=function(){this._showHandles=!0;this._textActivation&&this._textActivation.showHandles(!0);return this};e.hideTextHandles=function(){this._showHandles=!1;this._textActivation&&
this._textActivation.showHandles(!1);return this};e.layoutObject=function(){if(this.visible()&&!this._animating){var a=this._page.textBoundingRect(this._range);a&&(a.origin="overlay",this.move(a.left,a.top,a.width,a.height));Ta.prototype.layoutObject.call(this);if(this._labelText){var d=this._page.textRects(this._range,"overlay"),a=this._page.textBoundingRect(this._range);if(d&&a&&(a.origin="overlay",this.allocateLabelChildren(d.length),0<this._labels.length))for(var c=this.getLabelChild(0).defaultSize(),
e=0;e<this._labels.length;e++){var m=this.getLabelChild(e);m.setDefaultSize(c);this._moveable?m.addClass("oit-moveable"):m.removeClass("oit-moveable");var r=d[e].interiorRect(c,!0);r&&r.offset(-a.left,-a.top);m.setBoundingRect(r)}}}return this};var a=function(a,d,c){var b=a._page.accRect(d,"overlay");if(!b)for(var e=0<c?1:-1,g=e;!(b=a._page.accRect(d+g,"overlay"))&&g!=c;g+=e);b&&(b.width=0);return b};e.startHandleRect=function(){if(this._range)return a(this,this._range.acc,1)};e.endHandleRect=function(){if(this._range)return a(this,
this._range.accend,-2)};return c}(),md=function(){var c=function(a,d,c){U.call(this,"div","oit-drawinglayer oit-drawinglayer-"+d,c);this._drawing=a;this._name=d;this._visible=!0;y.attach(this);a.append(this);this.show()},e=W(c,U);e.drawing=function(){return this._drawing};e.show=function(a,d){void 0===a&&(a=!0);a!==this._visible&&(!0===a?(this._visible=!0,this.css("display",null),!1!==d&&this.update(!0)):!1===a&&(this._visible=!1,this.css("display","none")))};e.hide=function(){this.show(!1)};e.visible=
function(){return this._visible};e.update=function(b){this.queryChildElements(a,b)};var a=function(a,d,c){a.update&&a.update(c)};e.changed=function(){this._drawing.changed()};return c}(),Zc=function(){var c=function(a){U.call(this,"div","oit-drawingpanel");y.attach(this);this._origin=null;a.append(this);a.onscroll(this,this.updateScroll)},e=W(c,U);e.destroy=function(){var a=this.parent();a&&a.offscroll(this.updateScroll);U.prototype.destroy.call(this)};e.update=function(b){!0!==b&&(b=!1);this._animationFrame&&
(this._animationFrame=null);this.queryChildElements(a,b)};var a=function(a,d,c){a.update&&a.update(c)};e.changed=function(){this._animationFrame||(this._animationFrame=pb(this.update,this))};e.setOrigin=function(a,d){if(!this._origin)this._origin={x:a,y:d},this.updateScroll();else if(this._origin.x!=a||this._origin.y!=d)this._origin.x=a,this._origin.y=d,this.updateScroll()};e.resetOrigin=function(){this._origin&&(this._origin=null,this.css({left:null,top:null}))};e.updateScroll=function(){if(this._origin){var a=
this.parent().scroll();this.css({left:this._origin.x+a.left+"px",top:this._origin.y+a.top+"px"})}};return c}(),ub=function(){var c=function(a,b,c){U.call(this,a);this.acc=b;this.accend=c;void 0===this.accend&&(a=y.data(this,"accend"))&&(this.accend=Number(a));void 0===this.accend&&(this.accend=b+this.text().length)},e=W(c,U);e.destroy=function(){this.unload();U.prototype.destroy.call(this)};e.unload=function(){b(this,null,null)};e.text=function(a){if(void 0!==a){var b=this._anchor||this;b.destroyChildren();
b.dom.textContent=a}return this.dom.textContent};e.textNode=function(){return(this._anchor||this).dom.firstChild};e.createSplit=function(a){var b=new c("span",this.acc,a);this.copyDataTo(b);var d=this.text(),e=a-this.acc;b.text(d.substring(0,e));this.text(d.substring(e));this.acc=a;this._changed=!0;return b};e.mergeSplit=function(a){var b=this.text()+a.text();this.text(b);this.accend=a.accend;this._changed=!0;a.destroy()};e.dataEquals=function(a){var b=!1,d=this._data;a=a._data;if(!d)b=!a;else if(a&&
d.length==a.length)for(var b=!0,c=0;c<d.length;c++){var e=d[c],t=a[c];if(e.type!==t.type||e.id!==t.id){b=!1;break}}return b};e.addData=function(a){this._data||(this._data=[]);"hyperlink"===a.type?this._data.unshift(a):this._data.push(a);this._changed=!0};e.changeData=function(a){if(this._data)for(var b=0;b<this._data.length;b++){var d=this._data[b];if(d.type===a.type&&d.id===a.id){this._data[b]=a;this._changed=!0;break}}};e.removeData=function(a,b){if(this._data)for(var d=0;d<this._data.length;d++){var c=
this._data[d];if(c.type===a&&c.id===b){this._data.splice(d,1);0===this._data.length&&delete this._data;this._changed=!0;break}}};e.copyDataTo=function(a){this._data&&(a._data=a._data?a._data.concat(this._data):this._data.slice(0),a._changed=!0)};e.moveDataTo=function(b){this._data&&(a(this,null,null,null,null),b._data=b._data?b._data.concat(this._data):this._data,delete this._data,this._changed=!0,b._changed=!0)};e.updateData=function(){if(this._changed){var b=null,c=null,e=null,m=null,r=void 0;if(this._data)for(var t=
0,u=0;u<this._data.length;u++){var n=this._data[u];if("style"===n.type){if(n.className&&(m||(m=[]),m.push(n.className)),n.props)for(var q in n.props)if(n.props.hasOwnProperty(q)){var l=n.props[q];if("background-color"==q){var w=n.priority||0;void 0===r||w>r?(r=w,t=1,e||(e={}),e[q]=l):w==r&&(e[q]=bc(l,e[q],t,!0),t++)}else e||(e={}),e[q]=l}}else"hyperlink"===n.type?b=n:"bookmark"===n.type&&(c=n)}a(this,e,m,b,c);this._changed=!1}};var a=function(a,c,e,m,r){c?(c=Lc(c),c!=a._splitClass&&(a._splitClass&&
a.removeClass(a._splitClass),a.addClass(c),a._splitClass=c)):a._splitClass&&(a.removeClass(a._splitClass),delete a._splitClass);a._appliedClasses&&(a.removeClass(a._appliedClasses),delete a._appliedClasses);e&&(a.addClass(e),a._appliedClasses=e);b(a,m,r)},b=function(a,b,c){var d=a._anchor;if(b){var e=b&&0===b.url.indexOf("#");d||(d=e?a._anchor=y.create("span"):a._anchor=y.create("a"),d.text(a.text()),a.html(""),a.append(d));b&&(a.addClass("oit-hyperlink"),e||d.attr("href",b.url),Jc.on.addElement(d,
b));c&&d.attr("id",c.id)}else c?a.attr("id",c.id):d&&(Jc.on.removeElement(d),b=d.text(),d.destroy(),delete a._anchor,a.removeClass("oit-hyperlink"),a.html(b))};return c}(),nd=function(){var c=RegExp("^[^\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]*?[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]"),e=function(a,b,d){ub.call(this,a,b);this._origin=d},a=W(e,ub);a.unload=function(){this.discardLayout();Z(this._splits,"unload");ub.prototype.unload.call(this)};a.discardLayout=
function(){delete this._charRects;delete this._spanRect};a.distanceFromPoint=function(a,b){var d=this.findClosestChar(a,b);if(d)return d.distance};a.overlapRange=function(a){var b=this.spanRect();if(b.overlaps(a)){if(a.contains(b))return pa(this.acc,this.accend);if(b=g(this)){for(var d,c,e=0;e<b.length;e++)a.overlaps(b[e])&&(c=this.acc+e,void 0===d&&(d=c),c+=1);if(void 0!==d)return pa(d,c)}}};a.spanRect=function(){var a=this._spanRect;a||(a=z.elementRect(this,this._origin),0<a.width&&0<a.height&&
(this._spanRect=a));return a};a.textAngle=function(){void 0===this._angle&&(this._angle=this.ancestorData("angle"),this._angle=void 0!==this._angle?Number(this._angle)*Math.PI/180:0);return this._angle};a.rtl=function(){void 0===this._rtl&&(this._rtl=!!c.test(this.text()));return this._rtl};a.findClosestChar=function(a,b){var d=g(this),c,e,k;for(c=0;c<d.length;c++){var q=Math.abs(d[c].distanceFrom(a,b,"left","middle"));if(void 0===e||q<k)e=c,k=q,c==d.length-1&&(q=d[c].distanceFrom(a,b,"center","none"),
0<q&&e++)}var l,m;if(this._splits){d=this._splits;for(c=q=0;c<d.length;c++){var L=d[c].textNode(),K=q+L.textContent.length;if(e>=q&&e<K){l=L;m=e-q;break}q=K}l||(l=d[d.length-1].textNode(),m=l.textContent.length)}else l=this.textNode(),m=e;return{node:l,offset:m,acc:this.acc+e,distance:k}};a.textRect=function(a){var b=this.spanRect();if(this.hasClass("oit-hiddentext"))return new aa(b);if(0===b.width||0===b.height)return null;if(!a||a.acc<=this.acc&&a.accend>=this.accend)return new aa(b);if(a.acc<this.accend&&
a.accend>this.acc){var d=this.text(),b=a.acc-this.acc;0>b&&(b=0);a=a.accend-this.acc;a>d.length&&(a=d.length);if(d=g(this,b,a)){var c;c=new aa(d[b],this._origin);a==b&&(c.width=0);for(b+=1;b<a;b++)c.union(d[b]);return c}}};a.findTextRange=function(a,b){var d,c,e,g,k=this._splits;if(k){if(a.acc<=this.acc&&(d=k[0].textNode(),c=0),a.accend>=this.accend&&(e=k[k.length-1].textNode(),g=e.textContent.length),!d||!e)for(var l=0;l<k.length;l++){var m=k[l];if(a.accend<m.acc)break;if(!d&&a.acc<m.accend&&(d=
m.textNode(),c=a.acc-m.acc,0>c&&(c=0),e))break;if(d&&!e&&a.accend<=m.accend){e=m.textNode();g=a.accend-m.acc;0>g&&(g=0);break}}}else d=e=this.textNode(),c=0,a.acc>this.acc&&(c+=a.acc-this.acc),g=this.text().length,a.accend<this.accend&&(g-=this.accend-a.accend);k=V.createRange();k.setStart(d,c);k.setEnd(e,g);b.push(k)};var b=function(a,b,d,c){d._charRects.push(new aa(a.rect(c),c))},d=function(a,b,c,e,g,n,q,l,w){var k;a=y.unwrap(a);if(3==a.nodeType){if(k=a.textContent.length,b<=w&&b+k>=l)for(l-=b,
0>l&&(l=0),w-=b,w>k&&(w=k),k=l;k<w;k++)q[k+b]||(n.setStart(a,k),n.setEnd(a,k+1),l=n.getBoundingClientRect(),l=new aa(l.left-g.left,l.top-g.top,l.right-g.left,l.bottom-g.top,e),l.origin=c._origin,q[k+b]=l)}else for(k=0;k<a.childNodes.length&&b<=w;k++){var m=a.childNodes[k],u=b+m.textContent.length;l<=u&&b<=w&&d(m,b,c,e,g,n,q,l,w);b=u}},g=function(a,c,e){c||(c=0);e||(e=a.text().length);var g=V.createRange?V.createRange():null;if(g&&g.getBoundingClientRect)try{var k,n;a._origin instanceof U&&!(a._origin instanceof
nb)?(k=a._origin,n=k.rect()):(k="view",n=w.viewNode.rect());var q=a._charRects||[];d(a,0,a,k,n,g,q,c,e);a._charRects=q}catch(l){}else if(!a._charRects){g=a.text();e=new U;e.transferFrom(a);k=[];for(c=0;c<g.length;c++)k.push("<span>"),k.push(g[c]),c+1<g.length&&(n=g.charCodeAt(c),q=g.charCodeAt(c+1),1536<=n&&1791>=n&&1536<=q&&1791>=q&&k.push("&zwj;")),k.push("</span>");a.html(k.join(""));a._charRects=[];a.forChildElements(b,a,a._origin);c=new aa(a.rect(a._origin),a._origin);a.html("");a.transferFrom(e);
g=a.spanRect();if(g.width!=c.width&&(e=g.width/c.width,!cc(e,1)))for(g=g.left,c=0;c<a._charRects.length;c++)k=a._charRects[c],n=(k.left-g)*e+g,k.move(n,void 0,n+k.width*e,void 0)}return a._charRects};a.createSplit=function(){var a=new ub("span",this.acc,this.accend);this.moveDataTo(a);a.transferFrom(this);return a};a.updateData=function(){var a=this._splits;a?Z(a,"updateData"):ub.prototype.updateData.call(this)};a.split=function(a){if(!a)return this._splits;if(!this._splits){if(a.acc<=this.acc&&a.accend>=
this.accend||this.hasClass("oit-hiddentext"))return[this];var b=this.createSplit();this.append(b);this._splits=[b]}for(var b=this._splits,d=[],c=0;c<b.length;c++){var e=b[c],g;if(!(a.acc>=e.accend)){if(a.accend<=e.acc)break;a.acc>e.acc&&(g=e.createSplit(a.acc),b.splice(c++,0,g),this.insert(g,e));a.accend<e.accend&&(g=e.createSplit(a.accend),b.splice(c++,0,g),this.insert(g,e),e=g);d.push(e)}}return d};a.join=function(){var a=this._splits;if(a){for(var b,d=a[a.length-1],c=a.length-2;0<=c;c--)b=a[c],
b.dataEquals(d)&&(b.mergeSplit(d),a.splice(c+1,1)),d=b;1==a.length&&(b=a[0],b.moveDataTo(this),this.text(b.text()),b.destroy(),delete this._splits)}};a.addDataToRange=function(a,b){var d=this.split(a);d&&(Z(d,"addData",null,b),this.join(),this.updateData(),"hyperlink"===b.type&&g(this))};a.changeData=function(a){ub.prototype.changeData.call(this,a);Z(this._splits,"changeData",null,a);this.updateData()};a.removeData=function(a,b){ub.prototype.removeData.call(this,a,b);Z(this._splits,"removeData",null,
a,b);this.join();this.updateData()};return e}(),Nc=function(){var c=function(a,b){this._page=a;this._contentRoot=b||a;this._spans=[];if(1024<this._contentRoot.text().length)for(var d=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),c=d.firstACCNode();c;){for(var e=d.currentNode,m=!0,c=e.firstChild;c;c=c.nextSibling)if(3!==c.nodeType){m=!1;break}if(m&&1024<e.textContent.length){(c=d.skipNode())&&(c=d.firstACCNode());for(var m=e.textContent,r=[],t=0;t<m.length;t+=1024){var u=m.substring(t,
t+1024),u=Ib(u);r.push("<span>",u,"</span>")}e.innerHTML=r.join("");e.textContent.length!=m.length&&(e.textContent=m)}else c=d.nextACCNode()}for(var n,d=this._contentRoot.createTreeWalker(NodeFilter.SHOW_ELEMENT),c=d.firstACCNode();c;){e=d.currentNode;(c=y.data(e,"acc"))&&(n=Number(c));m=!0;for(c=e.firstChild;c;c=c.nextSibling)if(3==c.nodeType){m=!1;break}m||void 0===n?c=d.nextACCNode():(e=new nd(e,n,this._contentRoot),this._spans.push(e),n=e.accend,(c=d.skipNode())&&(c=d.firstACCNode()))}this._layoutSettings=
{};if(!a.checkedACCRange){if(d=this.getTextRange())d.acc<a.acc&&(a.acc=d.acc),d.accend>a.accend&&(a.accend=d.accend);a.checkedACCRange=!0}},e=W(c);e.destroy=function(){Z(this._spans,"unload");this.deleteAll()};e.discardLayout=function(){Z(this._spans,"discardLayout")};e.getTextRange=function(){for(var a,b=0;b<this._spans.length;b++){var c=this._spans[b];a?(c.acc<a.acc&&(a.acc=c.acc),c.accend>a.accend&&(a.accend=c.accend)):a=pa(c.acc,c.accend)}return a};e.textRanges=function(){for(var a=[],b,c=this._page.isEmailHeader(),
e=0;e<this._spans.length;e++){var k=this._spans[e];!c&&b&&b.accend+1>=k.acc?k.accend>b.accend&&(b.accend=k.accend):(b=pa(k.acc,k.accend),a.push(b))}return a};e.mapPointToSpan=function(a,b,c){if(0<this._spans.length){var d,e,m,r;this._page.pushShow();var t=[],u;for(r=0;r<this._spans.length;r++)if(m=this._spans[r],!m.hasClass("oit-hiddentext")&&(!c||m.equals(c)||m.isDescendantOf(c))&&(e=m.spanRect())&&0<e.width&&0<e.height){e=b<e.top?e.top-b:b>e.bottom?b-e.bottom:0;if(void 0===u||e<u)t.length=0,u=e;
e==u&&t.push(m)}u=void 0;if(1==t.length)d=t[0];else for(r=0;r<t.length;r++)if(m=t[r],e=Math.abs(m.distanceFromPoint(a,b)),void 0===u||e<u)d=m,u=e;this._page.popShow();return d}};e.findOverlappingText=function(a){if(0<this._spans.length){var b=[];this._page.pushShow();for(var c=0;c<this._spans.length;c++){var e=this._spans[c].overlapRange(a);e&&b.push(e)}this._page.popShow();if(0<b.length)return b}};e.findRange=function(a,b){for(var c=[],e=0;e<this._spans.length;e++){var k=this._spans[e];k.acc<=b&&
k.accend>a&&c.push(k)}if(0<c.length)return c};e.findACC=function(a){for(var b=[],c=0;c<this._spans.length;c++){var e=this._spans[c];a>=e.acc&&a<e.accend&&b.push(e)}if(0<b.length)return b};return c}(),nb=function(){var c=/\S/,e=function(a,b,c){var d=V.getElementById(c);d?U.call(this,d):U.call(this,"div","oit-section oit-"+b+" oit-pending",c);this.prop("index",a);this.data("page",this);this._needArrange=!0;this._staticContent=!!this.firstChildElem()},a=W(e,U);a.processData=function(a){var c=this.isEmailHeader(),
d={},e=!1,f=!1,g;for(g in a){var l=a[g],k=null,q=!1;switch(g){case "embeds":case "frames":case "fields":case "attachments":case "comments":k="_"+g;break;case "data":case "src":k="_"+g+"URL";break;case "section":case "name":case "type":case "dpi":case "autodpi":case "hiddenFromSlideshow":k=g;break;case "acc":case "accend":k=g;q=!0;break;case "w":c||this.css("width",l);k="width";l=parseInt(l,10);q=!0;break;case "h":c||this.css("height",l);k="height";l=parseInt(l,10);q=!0;break;case "oid":(l=z.overlayById(a.oid))&&
l!==this.overlay&&(k="overlay",f=!0);break;case "background":this.css("background",l)}k&&!this.hasOwnProperty(k)&&(d[k]={value:l,writable:q,enumerable:!1},e=!0)}"sn"!==this.type||this.width||(c=z.page(this.index-1))&&c.width&&(d.width={value:c.width,writable:!1,enumerable:!1},e=!0,this.css("width",c.css("width")),F.layoutChanged());e&&Object.defineProperties(this,d);f&&this.overlay.add(this);a.content&&!this.isLoaded()&&(!0===this.deferContent?this.deferredContent=a.content:b(this,a.content));!this._ssmodel&&
a.ssdata&&(this._ssmodel=new od(a.ssdata,this._embeds,this));if(a.comments){if(this.supportsAnnotations()){e=d=!1;ka.infoRaw();for(f=0;f<a.comments.length;f++)c=a.comments[f],c.range&&c.text?d=!0:e=!0;d&&E.hiddenContent("comments");e&&E.hiddenContent("comments-unsupported")}else E.hiddenContent("comments-unsupported");this.overlay.hasAnnotations(!0)}"sn"===a.type&&E.hiddenContent("speaker-notes");a.hiddenFromSlideshow&&E.hiddenContent("hidden-slides");a.hidden_columns&&E.hiddenContent("hidden-columns");
a.hidden_rows&&E.hiddenContent("hidden-rows");this._staticContent&&(t(this,!1),L(this))};a.supportsAnnotations=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":case "worksheet":case "database":return!0}return!1};a.supportsAnnotationPane=function(){switch(this.type){case "page":case "drawing":case "chart":case "bitmap":case "slide":return!0}return!1};a.supportsAnnotationBar=function(){switch(this.type){case "worksheet":case "database":return!0}return!1};
var b=function(a,b){var c=y.create("div");c.html(b);var d=c.byClass("oit-view");if(d&&0<d.length)for(c=0;c<d.length;c++){var e=d[c].byClass("oit-section");if(e)for(var f=0;f<e.length;f++){var h=e[f],g=z.pageById(h.id);g&&!g.firstChildElem()&&(w.baseURL&&u(h),g.transferFrom(h),g.addClass(h.attr("class")))}}else w.baseURL&&u(c),a.transferFrom(c),a._needArrange=!0};a.destroy=function(){this.unload();U.prototype.destroy.call(this)};a.unload=function(){var a=this.isLoaded();this.abortLoad();this._needArrange=
!0;this._selRect&&(this._selRect.destroy(),delete this._selRect);this._ssmodel&&(this._ssmodel.unload(),delete this._ssmodel);this._spanMap&&(this._spanMap.destroy(),delete this._spanMap);this._annotationPane&&(this._annotationPane.destroy(),delete this._annotationPane);0<this.loadedSize&&(this.pageContentChanged(),this.html(""),this.addClass("oit-pending"),this.loadedSize=0);this.logUnload&&this.logUnload();a&&z.on.pageunload.dispatch(this)};a.show=function(a){var b;if(this.isHidden()){a=a||{};this.finishAnimation();
a.animate&&this.css("opacity",0);if(!this.parent()){var c;if(!a.insertLast)for(var d=this.index+1;;d++){b=z.page(d);if(!b||b.overlay!==this.overlay)break;if(!b.isHidden()){c=b;break}}c?this.overlay.insert(this,c):this.overlay.append(this);this._annotationPane&&this._annotationPane.show()}a.animate?(void 0===a.time&&(a.time=a.animate?150:0),a.opacity=1,this.animate(a)):a&&a.endFn&&a.endFn();"vertical"===x.scrollMode&&(b=z.page(this.index+1))&&"sn"===b.type&&x.showSlideNotes&&b.show()}else a&&a.endFn&&
a.endFn();return this};a.hide=function(){var a=y.unwrap(this).parentNode;a&&(this.finishAnimation(),a.removeChild(this.dom),this._annotationPane&&this._annotationPane.hide(),"vertical"===x.scrollMode&&(a=z.page(this.index+1))&&"sn"===a.type&&a.hide());return this};a.pushShow=function(){this._showState?this._showState.count++:(this._showState={count:1},this.parent()||(this._showState.pageHidden=!0,this.show(),this._annotationPane&&this._annotationPane.show()),this.overlay.isDisplayed()||(this._showState.overlayUndisplayed=
!0,this.overlay.display()),this.overlay.isHidden()&&(this._showState.overlayHidden=!0,this.overlay.show()),"none"===this.computedStyle().display&&(this._showState.pageDisplayNone=!0,this.css("display","block")))};a.popShow=function(){this._showState&&(this._showState.count--,0>=this._showState.count&&(this._showState.pageDisplayNone&&this.css("display",null),this._showState.overlayHidden&&this.overlay.hide(),this._showState.overlayUndisplayed&&this.overlay.undisplay(),this._showState.pageHidden&&
(this.hide(),this._annotationPane&&this._annotationPane.hide()),delete this._showState))};a.isHidden=function(){return this._hidden||!this.parent()||!this.overlay||this.overlay.isHidden()||!this.overlay.isDisplayed()};a.filter=function(a){return a!==this.index};a.info=function(){var a={page:this.index,type:this.type,typeEx:this.type,features:Ha.features(this.type),comments:!!this._annotationPane};if("slide"==a.type){var b=z.page(this.index+1);b&&"sn"===b.type?a.notes=!0:y.byId(this.id+".note")?a.notes=
!0:a.notes=!1}else"rt"==a.type?(0<this.index&&"email"==z.page(this.index-1).type&&(a.type="email"),"rt"==a.type&&(a.type="html")):"sn"==a.type&&(a.type="slide",a.notes=!0);void 0!=this.hiddenFromSlideshow&&(a.hiddenFromSlideshow=this.hiddenFromSlideshow);void 0!==this.acc&&(a.acc=this.acc,void 0!==this.accend&&(a.accend=this.accend));this.width&&this.height&&(a.width=this.width,a.height=this.height);return a};a.features=function(){return Ha.features(this.type)};a.isEmailHeader=function(){return this.hasClass("oit-emailheaderpage")||
"emailheader"===this.id||"emailheader.1"===this.id};a.isPending=function(){return this.hasClass("oit-pending")};a.isLoading=function(){return this.hasClass("oit-loading")};a.isLoaded=function(){return!this.hasClass("oit-pending")&&!this.hasClass("oit-loading")};a.isEnabled=function(){return"slideshow"!=x.presentationMode?!0:"slide"!=this.type||!this.hiddenFromSlideshow};a.mapPointToText=function(a,b,c,d){var e;d?e=this.annotationPane().mapPointToSpan(a,b,c):(d=this.getSpanMap())&&(e=d.mapPointToSpan(a,
b,c));if(e){var f=e.textAngle();c=e.spanRect();d=c.left;var h=c.top,g=c.right,B=c.bottom;if(0!==f){c=[{x:d,y:h},{x:g,y:h},{x:g,y:B},{x:d,y:B}];d=Math.cos(f);h=Math.sin(f);for(g=0;g<c.length;g++)B=c[g].x-a,f=c[g].y-b,c[g].x=a+B*d+f*h,c[g].y=b+-B*h+f*d;d=g=c[0].x;h=B=c[0].y;for(f=1;4>f;f++){var v=c[f];v.x<d?d=v.x:v.x>g&&(g=v.x);v.y<h?h=v.y:v.y>B&&(B=v.y)}}e=e.findClosestChar(a,b);e.overlaps=a>=d-2&&a<=g+2&&b>=h-2&&b<=B+2;return e}};a.findTextBoundary=function(a,b,c){a=Mb(a);if(ia&&void 0!==a&&(a+=b,
b=ia.findBoundaryStart(a,c),c=ia.findBoundaryEnd(b,c),void 0!==b&&void 0!==c)){c=pa(b,c);if(this._frames){var d,e;for(b=0;b<this._frames.length;b++){var f=this._frames[b];a>=f.acc&&a<f.accend&&(void 0===d?(d=f.acc,e=f.accend):(f.acc<d&&(d=f.acc),f.accend>e&&(e=f.accend)))}c.acc<d&&(c.acc=d);c.accend>e&&(c.accend=e)}if(d=this.findTextRange(c))return hc(d)}};a.resetCache=function(){delete this._cachedRects;if(this._annotationPane)this._annotationPane.onResize(!0)};var d=function(a){var b=a._cachedRects;
b||(b=a._cachedRects={});var c=w.viewNode,d=c.clientWidth,e=c.clientHeight,f=c.scroll(),c=f.left,f=f.top,g=a.offsetLeft;a=a.offsetTop;var l=x.zoom,k=x.rotation;if(b.viewWidth!=d||b.viewHeight!=e||b.scrollLeft!=c||b.scrollTop!=f||b.offsetLeft!=g||b.offsetTop!=a||b.zoom!=l||b.rotation!=k)b.view=null,b.overlay=null,b.pos=null,b.viewWidth=d,b.viewHeight=e,b.scrollLeft=c,b.scrollTop=f,b.offsetLeft=g,b.offsetTop=a,b.zoom=l,b.rotation=k;return b};a.pageRect=function(a){var b=d(this);if("view"===a||"overlay"===
a){var c=b[a];c||((c=F.pageRect(this.index,a))&&c.readonly(!0),b[a]=c);return c}b.page||(b.page=F.pageRect(this.index,this));return b.page};a.pagePos=function(a){if("overlay"===a)return a=d(this),a.pos||(a.pos=this.pos(this.overlay)),a.pos;if("view"===a){a=this.pagePos("overlay");a={left:a.left,top:a.top};var b=F.padding();b&&(a.left+=b.left,a.top+=b.top);if(b=F.scrollOffset())a.left-=b.left,a.top-=b.top;return a}};a.inAnnotation=function(a){var b=!1;if("text"===a.type&&!this.findRange(a.acc,a.accend,
"page")){var c;this._annotationPane&&(c=this._annotationPane.findRange(a.acc,a.accend));if(c)b=!0;else if(this._comments)for(c=0;c<this._comments.length;c++){var d=this._comments[c];if(d.text){for(var e=0;e<d.text.length;e++){var f=d.text[e].range;if(f&&gb(a,f)){b=!0;break}}if(b)break}}}return b};a.containsRange=function(a){if("text"!==a.type)return a.page==this.index;var b=!1,c;if(a.acc<=this.accend&&a.accend>=this.acc){switch(this.type){case "worksheet":case "database":(b=this.spreadsheetModel())&&
!b.hasPendingContent()?(b=b.containsRange(a),b||(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)))):b=!0;break;default:if(this._frames)for(c=0;c<this._frames.length;c++){var d=this._frames[c];if(a.acc<=d.accend&&a.accend>=d.acc){b=!0;break}}!b&&this.isLoaded()&&(a.acc===a.accend?b=!!this.findACC(a.acc):(c=this.findRange(a.acc,a.accend),void 0!==c&&0<c.length&&(b=!0)));b||this._frames||this.isLoaded()||(b=!0)}!b&&this._comments&&(b=z.isAnnotationText(a.acc,
a.accend,this._comments))}return b};var g=function(a,b){return a.acc-b.acc},k=function(a,b){if(b&&0<b.length){b.sort(g);for(var c=[],d,e=a.isEmailHeader(),f=0;f<b.length;f++){var h=b[f];void 0!==h.acc&&(!e&&d&&d.accend+1>=h.acc?h.accend>d.accend&&(d.accend=h.accend):(d=pa(h.acc,h.accend),c.push(d)))}return c}};a.mapRectRangeToText=function(a){if("rect"===a.type){var b=this.getSpanMap();if(b)return a=new aa(a,this),k(this,b.findOverlappingText(a))}};a.textRanges=function(){var a=this.getSpanMap();
if(a)return k(this,a.textRanges())};a.mapRangeToEmbeds=function(a){var b;if(this._embeds&&("rect"===a.type||"cell"===a.type)&&(a=F.rangeRect(a,this)))for(var c=0;c<this._embeds.length;c++){var d=this._embeds[c],e=this.embeddingRect(d.uid);if(e&&e.overlaps(a)){var f=e.left,g=e.top;e.intersect(a);e.offset(-f,-g);b||(b=[]);d=Cb(d.uid,this.index,e.left,e.top,e.right,e.bottom);va(d,"pct");b.push(d)}}return b};a.embeddingByIndex=function(a){var b;this._embeds&&0<=a&&a<this._embeds.length&&(b=this._embeds[a]);
return b};a.embeddingByUID=function(a){var b;this._embeds&&(b=bb(this._embeds,"uid",a));return b};a.embeddingRect=function(a){if(this._embeds&&(a=bb(this._embeds,"uid",a))){var b;if(a.position)b=a.position,b=new aa(b.left,b.top,b.right,b.bottom,this);else{var c=a.x,d=a.y;if(void 0===c||void 0===d){var e=y.byId(a.id);e&&(e=z.elementRect(e,this),void 0===c&&(c=e.left),void 0===d&&(d=e.top))}void 0!=c&&void 0!=d&&(b=new aa(c,d,c+a.w,d+a.h,this))}return b}};a.textBoundingRect=function(a,b){if(this.isLoaded()&&
"text"===a.type){var c;if(this.isSpreadsheet())z.activeOverlay()==this.overlay&&(c=F.rangeRect(a,this));else{this.pushShow();var d=this.findRange(a.acc,a.accend,b);if(d&&0<d.length){for(var e=La(d[0]),f=0;f<d.length;f++){var h=d[f].textRect(a);if(h){var g=La(d[f]);y.unwrap(g)===y.unwrap(e)&&(c?c.union(h):c=h)}}c||1!=d.length||(c=d[0],e=ga(a),e.accend==c.acc&&e.accend++,c=d[0].textRect(e))}this.popShow()}return c}};a.frameForRange=function(a){var b;if(this.isLoaded()&&this._frames&&"text"===a.type)for(var c=
0;c<this._frames.length;c++){var d=this._frames[c];if(a.accend>=d.acc&&a.acc<d.accend){b=y.byId(d.id);break}}return b};a.textRects=function(a,b,c){if(c||"text"!==a.type)Array.isArray(c)&&(c=c.slice());else{if(this.isSpreadsheet()&&z.activeOverlay()==this.overlay){var d=F.rangeRect(a,b);d&&(e=[new ic(d)])}c=this.findRange(a.acc,a.accend)}if(c&&0<c.length){var e;this.pushShow();c.sort(function(a,b){var c=a.spanRect(),d=b.spanRect(),e=c.top-d.top;e||(e=c.left-d.left);return e});for(var f,h=[],d=0;d<
c.length;d++){var g=c[d].textRect(a);g&&(f&&cc(g.top,f.top)&&cc(g.bottom,f.bottom)&&g.left<=f.right+1?f.union(g):(f=g,h.push(f)))}this.popShow();if(0<h.length)for(e||(e=[]),a=new ic(h[0]),e.push(a),d=1;d<h.length;d++)if(c=h[d],8>c.width||8>c.height)a.add(c);else{for(var g=c.left-5,l=c.right+5,B=c.top-2,p=c.bottom+2,k=a.length-1;0<=k;k--)if(f=a.item(k),l>=f.left&&g<=f.right&&p>=f.top&&B<=f.bottom){a.add(c);c=null;break}c&&(a=new ic(c),e.push(a))}e&&("overlay"!==b&&"view"!==b||Z(e,"convert",null,b));
return e}};a.accRect=function(a,b){var c,d=pa(a,a+1);if(this.isSpreadsheet())c=F.rangeRect(d,b);else{var e=this.findACC(a);if(e&&0<e.length){this.pushShow();for(var f=La(e[0]),h=0;h<e.length;h++){var g=e[h].textRect(d);if(g){var l=La(e[h]);y.unwrap(l)===y.unwrap(f)&&(c?c.union(g):c=g)}}c&&(c.origin=b);this.popShow()}}return c};a.findTextRange=function(a){if("text"===a.type&&a.acc<=this.accend&&a.accend>=this.acc&&this.isLoaded()){var b=[],c=!1;if(this._frames&&"email"!==this.type)for(var d=0;d<this._frames.length;d++){var e=
this._frames[d];if(a.acc<=e.accend&&a.accend>=e.acc)if((e=V.getElementById(e.id))&&0===e.childNodes.length){var f=V.createRange();f.setStart(e,0);f.setEnd(e,0);b.push(f)}else c=!0}else c=!0;c&&(c=a.acc===a.accend?this.findACC(a.acc):this.findRange(a.acc,a.accend))&&Z(c,"findTextRange",null,a,b);if(0<b.length)return b}};a.layer=function(a){if(this.overlay)return this.selectionRect(),this.overlay.layer(a)};a.hasSelectionRect=function(){return!!this._selRect};a.selectionRect=function(){if(!this._selRect){var a=
this.overlay?this.overlay.layer("selection"):void 0;this._selRect=new Fb(this.index,a,"oit-sel-rect");this._selRect.hide()}return this._selRect};a.showSelectionRect=function(a){this._selRect&&this._selRect.show(a)};a.findRange=function(a,b,c){var d;c=c||"all";if("all"===c||"page"===c){var e=this.getSpanMap();e&&(d=e.findRange(a,b))}!this._annotationPane||"all"!==c&&"annotations"!==c||(a=this._annotationPane.findRange(a,b))&&(d=d?d.concat(a):a);return d};a.findACC=function(a){var b,c=this.getSpanMap();
c&&(b=c.findACC(a));this._annotationPane&&(a=this._annotationPane.findACC(a))&&(b=b?b.concat(a):a);return b};a.pageContentChanged=function(){delete this._cachedRects;this._spanMap&&(this._spanMap.destroy(),delete this._spanMap)};a.pageLayoutChanged=function(){delete this._cachedRects;this._spanMap&&this._spanMap.discardLayout();if(this._annotationPane)this._annotationPane.onResize(!0)};a.isSpreadsheet=function(){return this._ssmodel||this._dataURL};a.spreadsheetModel=function(){return this._ssmodel};
a.getSpanMap=function(){void 0===this._spanMap&&this.isLoaded()&&(this.isSpreadsheet()?this._spanMap=null:this._spanMap=new Nc(this));return this._spanMap};var m=function(a){if(a.showProgressDialog&&void 0!==a.srcSize&&void 0!==a.dataSize){var b=a.srcSize+a.dataSize;262144<=b&&(b=100*(a.srcLoaded+a.dataLoaded)/b,a.progressDialog||(a.progressDialog=ua.createProgressDialog(T.PLEASE_WAIT_INITIALIZING,!0)),a.progressDialog&&a.progressDialog.update(b))}},r=function(a){if(void 0===a.srcRequest&&void 0===
a.dataRequest&&a.isLoading()){E.resumeIdleTimer("pageload");a.logLoad&&a.logLoad();a.removeClass("oit-loading");a.pageContentChanged();z.touchPage(a.index);a.loadedSize=0;a.dataSize&&(a.loadedSize+=a.dataSize);a.srcSize&&(a.loadedSize+=a.srcSize);z.applyMemoryLimit(a.loadedSize);a.deferredContent&&(b(a,a.deferredContent),delete a.deferredContent,delete a.deferContent);t(a,!0);a.progressDialog&&(a.progressDialog.hide(),delete a.progressDialog);delete a.showProgressDialog;if(a.completionFuncs){for(var c=
0;c<a.completionFuncs.length;c++)a.completionFuncs[c](a);delete a.completionFuncs}delete a.locked;L(a)}},t=function(a,b){var c;a&&"email"==a.type&&(c=a.childByClass("oit-emailheader"),c||(c=a.byId("oit-emailheader"))&&c.addClass("oit-emailheader"),c&&(a.addClass("oit-emailheaderpage"),c=new pd(c),a._emailHeader=c));(c=a.childByClass("oit-email_page"))&&!c.firstChildElem()&&c.css("display","none");if("sn"===a.type){c=y.create("div","oit-noteheader");c.html('<span class="oit-notesicon"></span><span class="oit-unselectable"> '+
T.NOTES+"</span>");var d=a.firstChildElem();d.addClass("oit-sn-content");a.insert(c,d)}a.hiddenFromSlideshow&&(c=y.create("div","oit-hiddenpage"),c.attr("title",T.HIDDEN_SLIDE),a.append(c));A(a,a._comments);a.processRevisions();a.processSSRevisions();a.positionAnnotations();z.on.pageload.dispatch(a,!!b)},u=function(a){a=y.wrap(a);if(w.baseURL){a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT);for(var b;b=a.nextNode();)if("IMG"===b.tagName){var c=b.getAttribute("src");c&&("/"!=c.charAt(0)&&(c=Sa(w.baseURL,
c)),b.setAttribute("src",c))}else"image"===b.tagName&&(c=b.getAttribute("xlink:href"))&&("/"!=c.charAt(0)&&(c=Sa(w.baseURL,c)),b.setAttribute("xlink:href",c))}};a.abortLoad=function(){this.isLoading()&&(this.srcRequest&&(eb(this.srcRequest),delete this.srcRequest),this.dataRequest&&(eb(this.dataRequest),delete this.dataRequest),this.removeClass("oit-loading"),this.addClass("oit-pending"))};a.load=function(a,b){var c=this.isPending(),d=this.isLoading();(c||d)&&(this._srcURL||this._dataURL)?d?b&&this.completionFuncs.push(b):
(this.srcLoaded=this.srcSize=this.dataLoaded=this.dataSize=0,this.completionFuncs=[],b&&this.completionFuncs.push(b),this.removeClass("oit-pending"),this.addClass("oit-loading"),this.locked=!0,!0===a&&(this.showProgressDialog=!0),c=w.baseURL,this._dataURL&&(d=this._dataURL,c&&"/"!=d.charAt(0)&&(d=Sa(c,d)),this.dataRequest=ab({url:d,context:this,loading:n,complete:q})),this._srcURL&&(d=this._srcURL,c&&"/"!=d.charAt(0)&&(d=Sa(c,d)),this.srcRequest=ab({url:d,context:this,loading:l,complete:I})),(this.dataRequest||
this.srcRequest)&&E.pauseIdleTimer("pageload")):(c&&(this.removeClass("oit-pending"),t(this,!1)),b&&b(this))};var n=function(a,b,c){this.dataSize=b;c&&(this.dataLoaded=c.length);m(this)},q=function(a,b,c,d){this.dataSize=b;c&&(this.dataLoaded=c.length,m(this));if(200===d)try{var e=JSON.parse(c);this.processData({ssdata:e})}catch(ca){this.logAJAXError(null,"The data for page "+(this.index+1)+" is corrupt",a,d,c)}else this.logAJAXError(null,"Failed to load the data for page "+(this.index+1)+" from the server",
a,d,c);delete this.dataRequest;r(this)},l=function(a,b,c){this.srcSize=b;c&&(this.srcLoaded=c.length);m(this)},I=function(a,b,c,d){this.srcSize=b;c&&(this.srcLoaded=c.length,m(this));200===d?(this.deferContent=!0,ha.isICD(c)?ha.processICD(c,a,d):this.processData({content:c})):this.logAJAXError(null,"Failed to load the content for page "+(this.index+1)+" from the server",a,d,c);delete this.srcRequest;r(this)},L=function(a){var b=ka.infoRaw();if(b&&1557===b.fi){var c=(b=a.firstChildElem())?b.firstChildElem():
null,d=c?c.nextSiblingElem():null,e=d?d.nextSiblingElem():null,f=e?e.nextSiblingElem():null,g=c?c.firstChildElem():null,l=g?g.firstChildElem():null,k=d?d.firstChildElem():null,q=e?e.firstChildElem():null,p=q?q.firstChildElem():null,D=p?p.firstChildElem():null,n=D?D.firstChildElem():null;if(l&&!l.nextSiblingElem()&&k&&!k.nextSiblingElem()&&n&&!n.nextSiblingElem()){var u=q.size(),m=n.size(),r=!0;u&&m&&0<u.width&&0<u.height&&0<m.width&&0<m.height&&(r=m.height/u.height,r=.9<=m.width/u.width&&.9<=r);"DIV"==
b.tagName&&b.hasClass("oit-svg")&&"DIV"==c.tagName&&c.hasClass("oit-svg-layer")&&"DIV"==d.tagName&&d.hasClass("oit-frame")&&"DIV"==e.tagName&&e.hasClass("oit-svg-layer")&&"svg"==g.tagName&&"rect"==l.tagName&&"DIV"==k.tagName&&k.hasClass("oit-svg-text")&&"svg"==q.tagName&&"g"==p.tagName&&p.hasClass("oit-pagescale")&&"g"==D.tagName&&D.hasClass("oit-framescale")&&"image"==n.tagName&&!f&&r&&(a="#"+a.id.replace(".","\\.")+" .oit-svg-text",E.screenCSS(a+" div","color:rgba(0,0,0,0);"),E.screenCSS(a+" span",
"color:rgba(0,0,0,0);"),b.append(d))}}};a.comments=function(){return this._comments};var K=function(a,b){if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)K(a[c],b);else if(a.range&&"text"===a.range.type){if(void 0===b.acc||a.range.acc<b.acc)b.acc=a.range.acc;if(void 0===b.accend||a.range.accend>b.accend)b.accend=a.range.accend}},H=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)H(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=ia.getRawText(a.range.acc,a.range.accend))},
N=function(a){var b="";if(a)if(Array.isArray(a))for(var c=0;c<a.length;c++)b+=N(a[c]);else a.range&&"text"===a.range.type&&a.text&&(b=a.text);return b},C=function(a,b){if(a.isEmpty())b._annotationPane.destroy(),delete b._annotationPane;else{b.supportsAnnotationBar()&&z.createAnnotationBar();var c=a.range();c&&(c.acc<b.acc&&(b.acc=c.acc),c.accend>b.accend&&(b.accend=c.accend));x.showAnnotations&&a.layout()}},Q=function(a,b){a._annotationPane||(a._annotationPane=new qd(a),x.showAnnotations?a._annotationPane.show():
a._annotationPane.hide(),S.addAutoscrollRoot(a._annotationPane.scrollPane()));a._annotationPane.processAnnotations(b,C,a)},A=function(a,b,c){if(b&&a.supportsAnnotations()){for(var d={},e=0;e<b.length;e++){var f=b[e];K(f.text,d);K(f.author,d);K(f.author_short,d);K(f.last_save_date,d);K(f.create_date,d);K(f.date,d)}void 0!==d.acc?ia.loadRawText(d.acc,d.accend,function(){for(var d=0;d<b.length;d++){var e=b[d];H(e.text);H(e.author);H(e.author_short);H(e.last_save_date);H(e.create_date);H(e.date)}c&&(b=
c(a,b));Q(a,b)}):(c&&(b=c(a,b)),Q(a,b))}};a.processRevisions=function(){if(this.isLoaded()&&this.supportsAnnotations()){var a=E.revisions();if(a){for(var b=[],d=0;d<a.length;d++){var e=a[d];e.range&&this.findRange(e.range.acc,e.range.accend,"page")&&b.push(e)}b.length&&A(this,b,function(a,b){for(var d=0;d<b.length;d++){var e=b[d],f=b[d-1];if(f&&e.range&&f.range&&("add"===e.type&&"delete"===f.type||"delete"===e.type&&"add"===f.type)){var g=N(e.author),h=N(f.author),l=N(e.last_save_date||e.create_date),
k=N(f.last_save_date||f.create_date);g===h&&l===k&&(f.range.acc==e.range.acc&&f.range.accend==e.range.accend?"add"===f.type?b.splice(d-1,1):b.splice(d,1):(g=N(e.text),h=N(f.text),f.range.accend===e.range.acc&&c.test(g)&&c.test(h)&&(g=b[d-1]={type:"change",id:e.id,author:e.author,last_save_date:e.last_save_date,create_date:e.create_date},"add"===e.type?(g.range=e.range,g.text=e.text,g.oldtext=f.text):(g.range=f.range,g.text=f.text,g.oldtext=e.text),b.splice(d,1))))}}return b})}}};a.processSSRevisions=
function(){var a=z.ssRevisions();this._ssmodel&&a&&!this.processedSSRevisions&&(this.processedSSRevisions=!0,this._ssmodel.processRevisions(a,function(){A(this,this._ssmodel.revisions())},this))};a.positionAnnotations=function(){this._annotationPane&&x.showAnnotations&&this._annotationPane.layout()};a.annotationPane=function(){return this._annotationPane};return e}(),Ic=function(){var c=function(a,b){var c={index:{value:a},length:{get:function(){return this.firstPage?this.lastPage.index-this.firstPage.index+
1:0}}};b.name&&(c.name={value:b.name});b.hidden&&(c.hidden={value:!0},E.hiddenContent("hidden-pages"));Object.defineProperties(this,c);(c=V.getElementById(b.oid))?U.call(this,c):(c="oit-overlay",b.cls&&(c=-1==b.cls.indexOf(c)?c+(" "+b.cls):b.cls),U.call(this,"article",c,b.oid));w.viewNode.append(this);this.undisplay();this.hidden?this.hide():this.show()},e=W(c,U);e.updateCSS=function(){"text"!==x.selectionMode||ua.modalOverlayVisible()?this.addClass("oit-unselectable"):this.removeClass("oit-unselectable");
"rect"===x.selectionMode?this.css("cursor","crosshair"):this.css("cursor",null)};e.item=function(a){if(this.firstPage)return z.page(this.firstPage.index+a)};e.add=function(a){this.append(a);this.firstPage||(this.firstPage=a);this.lastPage=a;if(!this.maxWidth||a.width>this.maxWidth)this.maxWidth=a.width;if(!this.maxHeight||a.height>this.maxHeight)this.maxHeight=a.height;this._pagesHidden&&a.hide()};e.containsPage=function(a){return z.page(a).overlay==this};e.display=function(){if(this.layers){var a=
F.activeOverlay()===this;$a(this.layers,"show",null,a)}this.css("display","block");this.updateCSS()};e.undisplay=function(){this.layers&&$a(this.layers,"hide");this.css("display",null)};e.isDisplayed=function(){return"block"===this.css("display")};e.show=function(){!1!==this._isHidden&&(this._isHidden=!1,z.on.overlayshow.dispatch(this))};e.hide=function(){!0!==this._isHidden&&(this._isHidden=!0,this.undisplay(),z.on.overlayhide.dispatch(this))};e.isHidden=function(){return void 0!==this._isHidden?
this._isHidden:this.hidden};e.showPages=function(a){this.each("show",a);this._pagesHidden=!1};e.hidePages=function(a){this.each("hide",a);this._pagesHidden=!0};e.hasAnnotations=function(a){void 0!==a&&(this._hasAnnotations=!!a);return!!this._hasAnnotations||!!E.revisions()};e.each=function(a,b){Ab(this,arguments)};e.layer=function(a){var b;this.layers&&(b=this.layers[a]);b||(b=new md(w.drawing,a,this.id+"."+a),this.layers||(this.layers={}),this.layers[a]=b);return b};return c}(),cb=function(){var c=
function(a,b){this.id=a;this.range=ga(b.range);this.type=b.type;b.style&&(this._style=b.style);b.cls&&(this._class=b.cls);b.comment&&(this._comment=b.comment);b.label&&(this._label=b.label);b.properties&&(this._properties=b.properties);b.options&&this.setOptions(b.options);if(b.compound&&(this._compound=!0,Array.isArray(b.compound))){this._cRanges=[];for(var c=0;c<b.compound.length;c++){var d=ga(b.compound[c]);"rect"===d.type&&va(d,"px");this._cRanges.push(d)}}this._pageInfo=[];"rect"===this.range.type&&
(void 0!==this.range.embedId?va(this.range,"pct"):va(this.range,"px"));this.range=xa(this.range,!0);P.map(this)},e=W(c);e.isNote=function(){return!1};e.isRedaction=function(){return!1};e.isCompoundRedaction=function(){return!1};e.isEmptyRedaction=function(){return!1};e.setRange=function(a){return void 0!==a&&0!==Na(a,this.range)?("cell"==this.range.type&&this.eachPage(function(a,b){A(b,z.page(a.index))},null,this),P.unmap(this),this.range=ga(a),P.map(this),delete this._cRanges,"text"==a.type&&this._compound&&
(this._cRanges=[a]),this.updateStyle(),P.alignHighlight(),P.on.move.dispatch(this),!0):!1};e.updateStyle=function(){this._hidden||this.eachPage(a,null,this)};var a=function(a,b){var c=a.index;b.removeFromPage(a);b.addToPage(c)};e.filter=function(a){if(a){if("string"===typeof a)return this[a]();if(a instanceof nb)return this.isOnPage(a.index);if(a instanceof Ic)return this.isInOverlay(a);if(!a(this.id,this._properties))return!1}return!0};e.properties=function(a){void 0!==a&&(this._properties=a);return this._properties};
e.property=function(a,b){void 0!==b&&(this._properties||(this._properties={}),this._properties[a]=b);if(this._properties)return this._properties[a]};e.style=function(a){a&&(this._style=a,this.updateStyle());return this._style};e.highlightStyle=function(){var a=this.style();this._active||"opacity"!==x.highlightActivationStyle||(a=this.highlightStyleProps(),a=ac(a));return a};e.highlightStyleProps=function(){var a=ib(this.style());if(!this._active&&a&&"opacity"===x.highlightActivationStyle){var b=a["background-color"];
b&&(b=Ga(b))&&(b.a*=.4,a["background-color"]=Ja(b))}return a};e.intervalStyleProps=function(){var a=this.highlightStyleProps()["background-color"];a&&(a=Ga(a));if(a)return a.a*=.25,a=Ja(a),{"background-color":a}};e.fillStyle=function(){if("text"!==this.range.type)return this._style};e.css=function(a){return db(this._style,a)};e.matches=function(a,b,c,d,e){return this._style===a&&0===Na(this.range,b)&&this._properties===c&&this._comment===d&&this._label===e};var b=function(a,b){b&&b.autodpi?va(a,"pct"):
b&&"bitmap"===b.type?va(a,"px"):va(a,"tw")};e.serialize=function(){var a={type:this.type},c,d;a.range=ga(this.range);"rect"===a.range.type&&(void 0!==a.range.embedId?va(a.range,"pct"):(c=z.page(a.range.page),b(a.range,c)));if(this.ttrects){var e=[],f;for(f in this.ttrects){var g=this.ttrects[f];if(g){c=z.page(f);for(var h=0;h<g.length;h++)d=g[h].toRange(c),b(d,c),e.push(d)}}a.ttrects=[].concat.apply([],e)}this._style&&(a.style=this._style);this._properties&&(a.properties=this._properties);"string"===
typeof this._comment&&(a.comment=this._comment);this._label&&(a.label=this._label);this._options&&(a.options=this._options);if(this._cRanges)for(a.compound=[],c=0;c<this._cRanges.length;c++)d=ga(this._cRanges[c]),"rect"===d.type&&(void 0!==d.embedId?va(d,"pct"):va(d,"tw")),a.compound.push(d);return a};e.destroy=function(){this.destroyDialog();this.eachPage(d,null,this);P.unlink(this);this.deleteAll()};var d=function(a,b){b.removeFromPage(a)};e.getOption=function(a){if("text"==this.range.type){if("enableUserMove"===
a)return!1;if("enableUserResize"===a)for(var b in this._pageInfo){if(z.page(Number(b)).isSpreadsheet())return!1;break}}return(b=this._options)&&void 0!==b[a]?b[a]:!0};e.setOptions=function(a){if(a&&(f(this,"enableUserDelete",a,!0),f(this,"enableUserComment",a,!0),f(this,"enableUserResize",a,!0),"text"!==this.range.type&&f(this,"enableUserMove",a,!0),this._options)){a=!1;for(var b in this._options)if(this._options.hasOwnProperty(b)){a=!0;break}a||delete this._options}};e.comment=function(a){void 0!==
a&&(this._comment=null===a?void 0:String(a),this.updateComment(void 0,this._comment));return this._comment};e.dialog=function(a){var b=this._dialog;b?(b.abortAnimation(),b.show(!0)):b=this._dialog=new rd(this);b.loadComment();b.setMode(a);b.align();return b};e.alignDialog=function(a){this._dialog&&this._dialog.align(a)};e.hideDialog=function(){var a=this._dialog;a&&a.show(!1,{endFn:a.close,context:a})};e.exitDialog=function(){this._dialog&&this._dialog.exit()};e.destroyDialog=function(){this._dialog&&
this._dialog.destroy()};e.onDialogDestroy=function(a){a===this._dialog&&delete this._dialog};e.label=function(a){void 0!==a&&(this._label=null===a||""===a?void 0:String(a),this.eachPage(g,null,this));return this._label};var g=function(a,b){b.applyLabel(a)};e.showLabel=function(a){this._label&&(!1===a?this._labelVisible=!1:delete this._labelVisible,this.eachPage(g,null,this))};e.isOnPage=function(a){return!!this._pageInfo[a]};e.isInOverlay=function(a){var b=a.lastPage.index;for(a=a.firstPage.index;a<=
b;a++)if(this.isOnPage(a))return!0;return!1};var k=function(a,b){var c=a._pageInfo[b];c||(a._pageInfo[b]=c={index:b});return c};e.eachPage=function(a,b){tc(this._pageInfo,arguments)};e.activate=function(a){this.inAnnotation()&&(x.showAnnotations=!0);this.addToDocument();this._hidden&&(this.show(),this._autohide=!0,F.update());this._active=!0;this.eachPage(r,null,this);this.positionAll()};var m=function(a,b){if("text"===b.range.type&&"opacity"===x.highlightActivationStyle){var c=z.page(a.index).spreadsheetModel();
if(c&&!b.inAnnotation())c.updateHighlight(b);else{var d=1,c=-2;b._active&&(d=2,c=-1);var e=b.highlightStyleProps();a.spanList&&Rb(a.spanList,b.id,e,d);a.compoundSpanList&&Z(a.compoundSpanList,function(a,b){Rb(a.spans,b,e,d)},null,b.id);if(a.intervalSpanList){var f=b.intervalStyleProps();f&&Z(a.intervalSpanList,Rb,null,b.id|1E9,f,c)}}}},r=function(a,b){var c=a.drawingRect;b.oldFocusPage=void 0;if("text"===b.range.type)"opacity"===x.highlightActivationStyle?m(a,b):c&&(c.addClass("oit-highlight-active"),
c.setRange(b.range),b.getOption("enableUserResize")?c.ontextmove(b,t).ontextmoveend(b,n).showTextHandles():c.offtextmove(t).offtextmoveend(n).hideTextHandles(),c.activate());else if(c){c.addClass("oit-highlight-active");var d="cell"!==b.range.type;b.updateMoveable(!0,c);b.updateResizable({bindToObject:d,minWidth:10,minHeight:10},c);c.activate()}a.embedRect&&a.embedRect.show()};e.updateMoveable=function(a,b,c){c=c||b;if(!1!==a&&this.getOption("enableUserMove"))b.addClass("oit-moveable").ondragstart(this,
J,c).ondragmove(this,ca,c).ondragend(this,X,c).ondragcancel(this,ma,c);else b.removeClass("oit-moveable").offdragstart(J).offdragmove(ca).offdragend(X).offdragcancel(ma)};e.updateResizable=function(a,b,c){c=c||b;if(a&&this.getOption("enableUserResize"))c.resizable(!0,a).onresizemove(this,O).onresizeend(this,ba);else c.resizable(!1).offresizemove(O).offresizeend(ba)};var t=function(a){var b=a.range;a=a.page;var c=z.pagesForRange(b);a!=this.oldFocusPage&&(this.oldFocusPage=a,this.eachPage(u,null,c,
this));this._pageInfo[a.index]||this.addToPage(a.index,!0);this._cRanges&&(this._cRanges=[b]);Q(this,a,this.highlightStyle(),b);this.alignDialog({animate:!1})},u=function(a,b,c){a.spanList&&(a=a.index,bb(b,"index",a)||A(c,z.page(a)))},n=function(a){this.setRange(a.range)};e.deactivate=function(){this._active&&(delete this._active,this.eachPage(q,null,this),this._autohide&&(this.hide(),delete this._autohide,F.update()))};var q=function(a,b){var c=a.drawingRect;c&&c.removeClass("oit-highlight-active").deactivate();
"text"===b.range.type?"opacity"===x.highlightActivationStyle&&m(a,b):c&&(b.updateMoveable(!1,c),b.updateResizable(!1,c));a.embedRect&&a.embedRect.hide()};e.show=function(){if(void 0!==this._hidden){var a=this._hidden;delete this._hidden;if(0<a.length){for(var b=0;b<a.length;b++)this.addToPage(a[b]);P.link(this)}else this.addToDocument()}delete this._autohide};e.hide=function(){this._hidden||(this._hidden=[],this.eachPage(l,null,this),P.unlink(this))};var l=function(a,b){b._hidden.push(a.index);b.removeFromPage(a)};
e.collapse=function(){};e.isHidden=function(){return!(!this._hidden&&!this._autohide)};var w=function(a,b){var c,d=a._pageInfo[b.index];if(d){if(!d.boundingRects)if(d.spanList||d.compoundSpanList){var e;if(d.spanList)e=b.textRects(a.range,b,d.spanList);else{var f=[];for(c=0;c<d.compoundSpanList.length;c++)Array.prototype.push.apply(f,d.compoundSpanList[c].spans);for(c=0;c<a._cRanges.length;c++){var g=b.textRects(a._cRanges[c],b,f);e?Array.prototype.push.apply(e,g):e=g}}if(e)for(c=0;c<e.length;c++)for(f=
e[c],g=0;g<f.length;g++){var h=f.item(g).clone();h.readonly(!0);d.boundingRects||(d.boundingRects=[]);d.boundingRects.push(h.clone())}}else if(b.isSpreadsheet()||"text"!==a.range.type)"text"===a.range.type&&(c=b.textBoundingRect(a.range)),c||(c=F.rangeRect(a.range,b)),c&&(c=c.clone(),c.readonly(!0),d.boundingRects=[c]);return d.boundingRects}},L=function(a,b,c){var d;if(b){c=c||b;if("text"===a.range.type){var e=w(a,b);if(e){d=e[0].clone();for(var f=1;f<e.length;f++)d.union(e[f]);d.origin=c}}d||(d=
F.rangeRect(a.range,c||b))}return d};e.boundingRectList=function(a){var b=[];this.eachPage(K,null,a,b,this);if(0<b.length)return b};var K=function(a,b,c,d){(a=L(d,z.page(a.index),b))&&c.push(a)};e.addToDocument=function(a){if(!this._hidden){var b=z.pagesForRange(this.range);if(b){for(var c=0;c<b.length;c++)this.addToPage(b[c].index,!1,a);!1!==a&&P.link(this)}}};var H=function(a){a.highlightLayer||(N(a),a.highlightLayer=a.layer("highlights"));return a.highlightLayer},N=function(a){a.compoundHighlightLayer||
(a.compoundHighlightLayer=a.layer("chighlights"));return a.compoundHighlightLayer};e.addToPage=function(a,b,c){var d=z.page(a),e=this._pageInfo[a];e&&b&&(this.removeFromPage(e),e=null);if(!this._hidden&&(!e||e.needRect||e.needApply)&&d&&d.isLoaded()&&!d.isHidden()&&(b||d.containsRange(this.range))){var f;delete this._inComment;d.pushShow();e&&e.needApply||(e=Q(this,d,this.highlightStyle(),this.range));e&&delete e.boundingRects;if(P.batchMode())e&&(e.needApply=!0);else{b="text"!==this.range.type||
"opacity"!==x.highlightActivationStyle;var g=!1;b&&(f=L(this,d,"overlay"),f||(e&&(e.needRect=!0),g=!0));if(!g){e?(delete e.needRect,delete e.needApply):e=k(this,a);void 0===this.range.embedId||e.embedRect||(e.embedRect=new Fb(a,H(d)),e.embedRect.addClass("oit-highlight-embed"),e.embedRect.hide());if(b&&!e.drawingRect&&(e.drawingRect=this.createDrawingRect(d.index,H(d)),e.drawingRect&&(P.on.addElement(e.drawingRect,this),d.inAnnotation(this.range))))e.drawingRect.onwheel(this,function(a){var b=d.annotationPane();
if(b)return b.scrollPane().redirectEvent(a)});(b=this.fillStyle())?(e.styleDiv||(e.styleDiv=y.create("div","oit-highlight-style"),e.drawingRect&&e.drawingRect.append(e.styleDiv)),e.styleDiv.attr("style",b)):e.styleDiv&&(e.styleDiv.destroy(),delete e.styleDiv);this._label&&this.applyLabel(e);C(this._pageInfo[a],this,f);this.updateComment(e,this._comment)}}!1!==c&&P.link(this);F.update(!1,!0);d.popShow()}};e.removeFromPage=function(a){"number"==typeof a&&(a=this._pageInfo[a]);if(a){var b=a.index;A(this,
z.page(b));a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag);a.drawingRect&&(P.on.removeElement(a.drawingRect,this),a.drawingRect.destroy());a.embedRect&&a.embedRect.destroy();this._pageInfo[b]=null;F.update(!1,!0)}};e.createDrawingRect=function(a,b){var c;"text"===this.range.type?"opacity"!==x.highlightActivationStyle&&(c=new ld(a,b),c.setRange(this.range)):c=new Fb(a,b);return c};e.distanceFromPoint=function(a,b,c,d){var e;a=z.page(a);if(a=w(this,a))for(var f=0;f<a.length;f++){var g=
a[f];if(!(g.origin instanceof nb)==d&&(g=g.distanceFrom(b,c,"nearest","nearest","xy"),void 0===e||g.ay<e.ay||g.ay==e.ay&&g.ax<e.ax)&&(e=g,0===e.x&&0===e.y))break}return e};var C=function(a,b,c){var d;if(a){d=a.index;var e=z.page(d);if(e.isHidden()||!e.isEnabled()){a.drawingRect&&a.drawingRect.hide();a.embedRect&&a.embedRect.hide();if(a.cRects)for(d=0;d<a.cRects.length;d++)a.cRects[d].rect.hide();a.needRect=!0}else if("text"===b.range.type)a.drawingRect&&a.drawingRect.show().changed();else if(c||(c=
L(b,e,"overlay")),c){a.drawingRect&&a.drawingRect.show().move(c.left,c.top,c.width,c.height);a.embedRect&&(c=z.page(d).embeddingRect(b.range.embedId))&&(c.origin="overlay",a.embedRect.show().move(c.left,c.top,c.width,c.height));if(a.cRects)for(d=0;d<a.cRects.length;d++)e=a.cRects[d],(c=F.rangeRect(e.range,"overlay"))&&e.rect.show().move(c.left,c.top,c.width,c.height);b.updateComment(a,b._comment)}}};e.positionAll=function(){this.eachPage(C,null,this)};e.generateKey=function(){var a,b=z.pagesForRange(this.range);
if(b&&void 0===this.prevId&&void 0===this.nextId)for(var c=0;c<b.length;c++){var d=b[c];this.key&&this.key.page!=d.index&&delete this.key;this.key||(this.key={page:d.index,x:0,y:0});if(this.inAnnotation())this.key.x=this.range.acc,this.key.y=9999999;else if(d.isEmailHeader()&&"text"===this.range.type)this.key.x=this.range.acc,this.key.y=0;else if(d.spreadsheetModel()){var e;"cell"===this.range.type?(e=this.range,this.key.x=0,this.key.y=e.r1*d.spreadsheetModel().colCount()+e.c1):"text"===this.range.type?
(this.key.x=this.range.acc,this.key.y=-1):delete this.key}else{e=void 0;if(d&&(d=w(this,d))){e=d[0].left;for(var f=d[0].top,g=1;g<d.length;g++){var h=d[g];if(h.top<f||h.top==f&&h.left<e)e=h.left,f=h.top}e={left:e,top:f}}(d=e)?(this.key.x=d.left,this.key.y=d.top):delete this.key}if(this.key){a=this.key;break}}else delete this.key;return a};e.inAnnotation=function(){void 0===this._inComment&&(this._inComment=z.inAnnotation(this.range));return this._inComment};e.applyLabel=function(a){if(a&&a.drawingRect)if(this._label&&
!1!==this._labelVisible){var b=this.css("background-color"),c;a:{if(b&&(c=Ga(b))){c.r=255-c.r;c.g=255-c.g;c.b=255-c.b;c=Ja(c.r,c.g,c.b);break a}c=void 0}c||(b=null);a.drawingRect.setLabel(this._label,c,b)}else a.drawingRect.setLabel(null)};var Q=function(a,b,c,d){var e=null,f=0,g,h,p,l,v,q;a._active?f=2:"opacity"===x.highlightActivationStyle&&(f=1);var B=S.saveSelection();B&&B.range&&"text"===B.range.type&&b.isSpreadsheet()&&(S.select(null),B=null);A(a,b);if(a._compound){if(a._cRanges||(a._cRanges=
z.decomposeRange(d,!0)),a._cRanges){(l=b.spreadsheetModel())&&l.addHighlight(a)&&(e||(e=k(a,b.index)));var n="rect"===d.type,u;for(l=0;l<a._cRanges.length;l++){v=a._cRanges[l];if("text"===v.type){if(p||(p=ib(c)),p&&(h=tb(b,v,p,a.id,void 0,f))){e||(e=k(a,b.index));e.compoundSpanList||(e.compoundSpanList=[]);for(var m=0;m<h.length;m++)if(g=h[m].split(v))for(q=0;q<g.length;q++)P.on.addElement(g[q],a);e.compoundSpanList.push({spans:h,range:v})}}else if(h=F.rangeRect(v,"overlay"))g=new Fb(b.index,N(b)),
c&&(q=y.create("div","oit-highlight-style"),q.attr("style",c),g.append(q)),g.move(h.left,h.top,h.width,h.height),e||(e=k(a,b.index)),e.cRects||(e.cRects=[]),e.cRects.push({range:v,rect:g});n&&(v="text"===d.type?b.textBoundingRect(v):F.rangeRect(v,b))&&(u?u.union(v):u=v)}if(x.highlightTermIntervals&&"text"===a.range.type&&1<a._cRanges.length&&(f=-2,a._active&&(f=-1),d=a.intervalStyleProps())){c=[];h=a.acc;for(l=0;l<a._cRanges.length;l++)v=a._cRanges[l],v.acc>h&&c.push(pa(h,v.acc)),h=v.accend;for(l=
0;l<c.length;l++)if(v=c[l],h=tb(b,v,d,a.id|1E9,void 0,f))e||(e=k(a,b.index)),e.intervalSpanList||(e.intervalSpanList=[]),e.intervalSpanList.push(h)}u&&(b=F.rangeFromRect(b.index,u.left,u.top,u.right,u.bottom,b,"highlight"))&&(a.range=b)}}else if("text"===d.type&&((l=b.spreadsheetModel())&&l.addHighlight(a)&&(e=k(a,b.index)),p=ib(c))&&(h=tb(b,d,p,a.id))){e||(e=k(a,b.index));e.spanList=h;for(l=0;l<h.length;l++)if(g=h[l].split(d))for(q=0;q<g.length;q++)P.on.addElement(g[q],a);if((l=ka.infoRaw())&&1557===
l.fi)for(a.ttrects||(a.ttrects=[]),a=a.ttrects[b.index]=[],l=0;l<h.length;l++)h[l].hasClass("oit-tt")&&(b=h[l].textRect(d))&&a.push(b)}B&&S.restoreSelection(B);return e},A=function(a,b){var c,d=a._pageInfo[b.index];if(d){var e=S.saveSelection();e&&e.range&&"text"===e.range.type&&b.isSpreadsheet()&&(S.select(null),e=null);var f=b.spreadsheetModel();f&&("text"===a.range.type||a._compound)&&f.removeHighlight(a);if(d.spanList){for(c=0;c<d.spanList.length;c++)if(f=d.spanList[c].split(a.range))for(var g=
0;g<f.length;g++)P.on.removeElement(f[g],a);Qb(d.spanList,a.id);delete d.spanList;b.pageLayoutChanged()}d.compoundSpanList&&(Z(d.compoundSpanList,function(b,d){var e=b.range,f=b.spans;for(c=0;c<f.length;c++){var g=f[c].split(e);if(g)for(var h=0;h<g.length;h++)P.on.removeElement(g[h],a)}Qb(f,d)},null,a.id),delete d.compoundSpanList,b.pageLayoutChanged());d.intervalSpanList&&(Z(d.intervalSpanList,Qb,null,a.id|1E9),delete d.intervalSpanList,b.pageLayoutChanged());if(d.cRects){for(c=0;c<d.cRects.length;c++)if(f=
d.cRects[c].rect)P.on.removeElement(f,a),f.destroy();delete d.cRects}e&&S.restoreSelection(e)}},f=function(a,b,c,d){var e=!1;c=c[b];void 0!==c&&(c==d?(d=a._options)&&void 0!==d[b]&&(delete d[b],e=!0,a.optionChanged(b)):(a._options||(a._options={}),a._options[b]=!!c,e=!0,a.optionChanged(b)));return e};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.id===P.active()&&this.activate(!0)}};var h=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?
a.drawingRect&&(b?(a.commentFlag||(a.drawingRect.onmouseenter(this,B).onmouseleave(this,v),a.commentFlag||(a.commentFlag=new za(a.drawingRect,{hpos:"right",vpos:"top",margin:2,classList:"oit-comment-flag"}))),a.commentFlag.show()):a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag)):this.eachPage(h,null,b,this)};var B=function(a){this.id!=P.active()&&P.showComment(this.id)},v=function(a){this.id!=P.active()&&P.hideComment(this.id)},J=function(a,b){if(this.getOption("enableUserMove")){var c=
b.position();this._moveable={startRect:c.clone(),curRect:c.clone()};return!1}return!0},ca=function(a,b){if(this._moveable){var c=this.range,d,e=this._moveable.startRect;d=this._moveable.curRect;var f=a.delta;d.left=e.left+f.x;d.top=e.top+f.y;"cell"!==c.type||c.offsets?d=F.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId):(this.moveOriginalRect||(this.moveOriginalRect=F.rangeRect(c,d.origin)),e=this.moveOriginalRect.clone(),e.left=d.left,e.top=d.top,d=F.rangeFromRect(c.page,
e.left,e.top,e.right,e.bottom,e.origin,"move",c.embedId),e=c.c2-c.c1,f=c.r2-c.r1,d.c2-d.c1<e&&(d.c2=d.c1+e),d.r2-d.r1<f&&(d.r2=d.r1+f),delete d.offsets);0!==Na(d,c)&&(d=F.rangeRect(d,"overlay"),b.move(d.left,d.top,d.width,d.height),this._active&&this._comment&&this._dialog&&this._dialog.align({rect:d,animate:!1}))}return!1},X=function(a,b){if(this._moveable){var c=this.range,d=this._moveable.curRect,d=F.rangeFromRect(c.page,d.left,d.top,d.right,d.bottom,d.origin,"move",c.embedId);if("cell"===d.type&&
!c.offsets){delete this.moveOriginalRect;var e=c.c2-c.c1,c=c.r2-c.r1;d.c2-d.c1<e&&(d.c2=d.c1+e);d.r2-d.r1<c&&(d.r2=d.r1+c);delete d.offsets}this.setRange(d);delete this._moveable}return!1},ma=function(a,b){if(this._moveable){var c=a.center;P.activateNearest(c.x,c.y,a.srcEvent);delete this._moveable}return!1},O=function(a){var b=this.range,c=a.drawingRect;a=a.newRect;var d=F.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==d.type||b.offsets||delete d.offsets;
if(d=xa(d,!0))b=F.rangeRect(d,"overlay"),"rect"===d.type&&(a=b),c.move(b.left,b.top,b.width,b.height);this._active&&this._comment&&this._dialog&&this._dialog.align({rect:a,animate:!1})},ba=function(a){var b=this.range;a=a.newRect;a=F.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"!==a.type||b.offsets||delete a.offsets;a=xa(a,!0);this.setRange(a)};return c}(),cd=function(){var c=function(a,b){cb.call(this,a,b)},e=W(c,cb);e.isRedaction=function(){return!0};e.isCompoundRedaction=
function(){return!0===this._compound};e.isEmptyRedaction=function(){return!0===this._compound&&!this._cRanges};e.style=function(a){a=x.redactionColor;return"color:"+a+";background-color:"+a+";"};e.fillStyle=function(){if("text"!==this.range.type){var a;if(a=!this._compound||"rect"!==this.range.type&&"cell"!==this.range.type?x.redactionColor:x.redactionFillColor)return"background-color:"+a+";"}};e.css=function(a){if("color"===a||"background-color"===a)return x.redactionColor};return c}(),dd=function(){var c=
function(a,b){cb.call(this,a,b);this._newNote=!0;this._state="oit-note-pinned";this._pinned=!0;this._hidden=this._hover=this._active=this._editing=!1},e=W(c,cb);e.isNote=function(){return!0};e.isEditing=function(){return this._editing};e.isHidden=function(){return this._hidden};e.removeFromPage=function(a){this.endEditText(!1);cb.prototype.removeFromPage.call(this,a)};e.activate=function(a){if(!this._active||a)this._active=!0,this.updateState(a)};e.deactivate=function(){this._active&&(this._active=
!1,this.updateState())};e.show=function(){this._hidden&&(this._hidden=!1,this.updateState())};e.hide=function(){this._hidden||(this._hidden=!0,this.updateState())};e.pin=function(){this._pinned||(this._pinned=!0,this.updateState())};e.unpin=function(){this._pinned&&(this.endEditText(!0),P.active()==this.id&&P.deactivate(),this._pinned=!1,this.updateState())};e.beginEditText=function(a){void 0!==a&&(this._newNote=a);this._editing||(this._editing=!0,w.editingComment++,this.updateState())};e.endEditText=
function(a){this._editing&&(!1===a&&(this.buttons.textArea.value=P.comment(this.id)),this._editing=!1,w.editingComment--,this.updateState(),this._newNote&&(a?delete this._newNote:P.remove(this.id)))};e.ok=function(){this.endEditText(!0);return!1};e.cancel=function(){this.endEditText(!1);return!1};e.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.updateState(!0)}};var a=function(){this.addClass("oit-note-expanding")},b=function(){this.removeClass("oit-note-expanding")},
d=function(){this.addClass("oit-note-collapsing")},g=function(){this.removeClass("oit-note-collapsing")};e.updateState=function(c){var e;e=this._editing?"oit-note-editing":this._active?this._pinned?"oit-note-active":"oit-note-shown":this._hidden?"oit-note-hidden":this._pinned?"oit-note-pinned":this._hover?"oit-note-hover":"oit-note-iconic";var k=this.noteRect;if(k){if(e!=this._state||c){var q=this._state;this._state=e;k.removeClass(q).addClass(e);switch(q){case "oit-note-editing":P.comment(this.id,
this.buttons.textArea.value);ua.showModalOverlay(!1);this.buttons.iconBar.focus();k.layer().removeClass("oit-note-layer-edit");k.removeClass("oit-highlight-active").deactivate();break;case "oit-note-hidden":k.show();break;case "oit-note-iconic":"oit-note-hidden"!==e&&(c=this.originalRect,k.move(c.left,c.top,c.width,c.height,{timems:200,startFn:a,endFn:b}));break;case "oit-note-active":k.removeClass("oit-highlight-active").deactivate();case "oit-note-pinned":"oit-note-active"!==e&&"oit-note-pinned"!==
e&&(this.updateMoveable(!1,this.buttons.iconBar,k),this.updateResizable(!1,k))}this.positionAll();switch(e){case "oit-note-hidden":k.hide();break;case "oit-note-iconic":this.originalRect=k.position().clone();c=this.collapsedRect={left:this.originalRect.right-20,top:this.originalRect.top,width:20,height:20};"oit-note-hidden"===q?k.move(c.left,c.top,c.width,c.height):k.move(c.left,c.top,c.width,c.height,{timems:200,startFn:d,endFn:g});break;case "oit-note-editing":k.layer().addClass("oit-note-layer-edit");
k.addClass("oit-highlight-active").activate(!1,!0);P.activate(this.id);ua.showModalOverlay(!0);e=this.buttons.textArea;e.blur();e.focus();this._newNote&&e.moveCaret(e.value.length||0);break;case "oit-note-active":k.addClass("oit-highlight-active").activate(!1,!0);case "oit-note-pinned":this.updateMoveable(!0,this.buttons.iconBar,k),this.updateResizable({bindToObject:"cell"!==this.range.type,minWidth:60,minHeight:45,margin:-5},k)}}k.update()}};e.createDrawingRect=function(a,b){var c=new Fb(a,b),d=
{};this.noteRect=c;this.buttons=d;c.addClass("oit-note").addClass("oit-note-pinned");d.iconBar=new za(c,{classList:"oit-note-icons",inheritMoveable:!0});d.iconBar.attr("tabindex","-1");d.cancel=new za(d.iconBar,{classList:"oit-note-cancel",title:T.DISCARD_CHANGES});d.cancel.onclick(this,this.cancel).ontap(this,this.cancel);d.ok=new za(d.iconBar,{classList:"oit-note-ok",title:T.SAVE_CHANGES});d.ok.onclick(this,this.ok).ontap(this,this.ok);d.pin=new za(c,{classList:"oit-note-pin"});d.pin.onmouseenter(this,
k).onmouseleave(this,m).onclick(this,r).ontap(this,r);d.textArea=new mc;d.textArea.onfocus(this,u).ontap(this,t);d.textForm=y.create("form");d.textForm.append(d.textArea);c.append(d.textForm);this.updateState(!0);return c};var k=function(a){this._hover=!0;this.updateState()},m=function(a){this._hover=!1;this.updateState()},r=function(a){this._pinned?this.unpin():this.pin();return!1},t=function(a){this.buttons.textArea.blur();this.buttons.textArea.focus()},u=function(a){this.getOption("enableUserComment")?
this.beginEditText():this.buttons.textArea.blur()},n=function(a,b,c){c.updateComment(a,b)};e.updateComment=function(a,b){a?this._hidden||this._editing||!this.buttons||(this.buttons.textArea.value=b||""):this.eachPage(n,null,b,this)};return c}(),ed=function(){var c=function(c,a){cb.call(this,c,a);a.name&&(this._name=a.name);a.sizing&&(this._sizing=a.sizing);a.opacity&&(this._opacity=a.opacity);if(!this._style){var b="background:url("+P.stamp(this._name).url+") no-repeat";1!=this._opacity&&(b+=";opacity:"+
this._opacity);"scale"===this._sizing?b+=";background-size:contain":"stretch"===this._sizing&&(b+=";background-size:100% 100%");this._style=b}};W(c,cb).serialize=function(){var c=cb.prototype.serialize.call(this);c.stamp=this._name;c.opacity=this._opacity;c.sizing=this._sizing;delete c.style;return c};return c}(),rd=function(){var c=200,e=150,a=function(a){var b="#000",c=a.css("background-color");c&&(c=bc(c,"#FFFFFF"));if(c){var e=Ga(c);128>e.r&&128>e.g&&128>e.b&&(b="#FFF")}Mc.call(this,{ok:!0,cancel:!0,
className:"oit-dialog-comment",resultFn:d,destroyFn:g,textColor:b,backgroundColor:c});this._highlight=a},b=W(a,Mc),d=function(a,b){"view"!==a._mode&&(c=a.width(),e=a.height(),"new"!==a._mode||b&&a._textarea.value?(b&&a.saveComment(),P.active()===a._highlight.id?a.setMode("view"):a._highlight.exitDialog()):(P.remove(a._highlight.id),S.select(null)))},g=function(a){a.setMode(null);a._highlight.onDialogDestroy(a)};b.setMode=function(a){if(a!==this._mode){if("edit"===this._mode||"new"===this._mode)w.editingComment--,
this.removeClass("oit-comment-edit");this._mode=a;switch(a){case "view":this._highlight.comment()?(this._textarea&&(this._textarea.destroy(),delete this._textarea),this._label||(this._label=this.addLabel(null),this._label.onclick(this,k).ontap(this,k).onmouseenter(this,m).onmouseleave(this,r)),this.resizable(!1),this.modal(!1),this.showFooter(!1),this.maxsize(c,e),this._mode=a,this.loadComment(),this.align(),this.show()):this._highlight.exitDialog();break;case "edit":case "new":w.editingComment++,
this.addClass("oit-comment-edit"),this.modal(!0),this.align({endFn:t,context:this})}}};var k=function(){this._highlight.getOption("enableUserComment")&&this.setMode("edit")},m=function(){P.showComment(this._highlight.id)},r=function(){var a=this._highlight.id,b=P.active();a!=b&&(P.hideComment(a),void 0!==b&&P.showComment(b))},t=function(){this.show(!0,{endFn:u,context:this})},u=function(){this._label&&(this._label.destroy(),delete this._label);this._textarea||(this.resetForm(),this._textarea=this.addTextArea(null),
this._textarea.onfocus(this,n));this.loadComment();this.resizable(!0,180,100);this.showFooter(!0);this.maxsize(0,0);this._textarea&&this._textarea.focus&&this._textarea.focus()},n=function(){var a=this._textarea;a&&("number"==typeof a.selectionStart?a.selectionStart=a.selectionEnd=a.value.length:"undefined"!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select()))};b.loadComment=function(){var a=this._highlight.comment()||"";this._textarea?this._textarea.value=a:this._label&&
this._label.text(a)};b.saveComment=function(){this._textarea&&P.comment(this._highlight.id,this._textarea.value,!0)};b.align=function(a){var b;a:{var d=a?a.rect:null;if(this){var g=this._highlight,k=g.isNote(),q,n,u;if(d)"view"!==d.origin&&(d=d.clone(),d.origin="view"),k?(b=d.left,q=d.top,n=d.right-d.left,u=d.bottom-d.top):(b=d.right+10,q=d.top);else if(d=g.boundingRectList("view"))for(g=0;g<d.length;g++){var m=d[g];k?(b=m.left,q=m.top,n=m.right-m.left,u=m.bottom-m.top):(b=m.right+10,q=m.top);0>q&&
0<=m.bottom&&(q=0);if(0<=b&&0<=q)break}if(void 0!=b){10>b&&(b=10);10>q&&(q=10);k=w.viewNode.pos();b+=k.left;q+=k.top;if(n&&u){b={left:b,top:q,width:n,height:u};break a}b={left:b,top:q};break a}}b=void 0}b&&(q=b.width||c,n=b.height||e,"view"===this._mode?this.autoSize(b.left,b.top,q,n,a):this.move(b.left,b.top,q,n,a))};return a}(),Pb=function(){var c=function(a,b,c,d,e){this.prop("id",a);this._edge=b;this._visible=!1;this._autoSize=!0;this._resizable=this._overlay=!1;this._height=this._width=void 0;
switch(this._edge){case "top":this._dimension="height";this._border="borderBottom";this._direction=1;break;case "bottom":this._dimension="height";this._border="borderTop";this._direction=-1;break;case "left":this._dimension="width";this._border="borderRight";this._direction=1;break;case "right":this._dimension="width",this._border="borderLeft",this._direction=-1}this._frame=y.create("div","oit-toolframe");this._toolbar=y.create("div","oit-toolbar oit-toolbar-"+this._edge);this._toolsParent=y.create("div",
"oit-toolbar-tool");this._toolsElem=c;this._content=y.create("div","oit-toolcontent");this._toolbar.append(this._toolsParent);this._toolsParent.append(this._toolsElem);this._frame.append(this._toolbar,this._content);d&&(y.unwrap(this._toolbar).style[this._border]=d);a=e?e._content:w.rootNode;this._content.transferFrom(a);a.append(this._frame)},e=W(c);e.filter=function(a){return a===this.id};e.refresh=function(){this.applySize()};e.isInternal=function(){return 0>this.id};var a=function(a){this._startSize=
this.size();return!1},b=function(a){var b=this._startSize;switch(this._edge){case "top":b+=a.delta.y;break;case "bottom":b-=a.delta.y;break;case "left":b+=a.delta.x;break;case "right":b-=a.delta.x}this.setSize(b);return!1},d=function(a){delete this._startSize;return!1};e.overlay=function(a){"boolean"===typeof a&&((this._overlay=a)?this._toolbar.addClass("oit-toolbar-overlay"):this._toolbar.removeClass("oit-toolbar-overlay"),this._visible&&(this.hide(),this.show()));return this._overlay};e.resizable=
function(c,e,m,r){"boolean"===typeof c&&((this._resizable=c)?("number"==typeof e&&"number"==typeof m&&"string"==typeof r&&(this._collapseSize=e,this._minSize=m,this._collapseHeader=y.create("div","oit-toolcollapse"),this._collapseHeader.html(r),this._toolbar.append(this._collapseHeader)),this._toolbar.addClass("oit-toolbar-resizable"),this._resizeHandle||(this._resizeHandle=y.create("div","oit-toolresize"),this._resizeHandle.html("<div></div>"),this._resizeHandle.ondragstart(this,a),this._resizeHandle.ondragmove(this,
b),this._resizeHandle.ondragend(this,d),this._resizeHandle.ondragcancel(this,d),this._resizeHandle.kinetic(!1),this._toolbar.append(this._resizeHandle))):(this._collapseHeader&&this._collapseHeader.destroy(),delete this._collapseSize,delete this._minSize,delete this._collapseHeader,this._toolbar.removeClass("oit-toolbar-resizable"),this._resizeHandle&&(this._resizeHandle.destroy(),delete this._resizeHandle)),this._visible&&(this.hide(),this.show()));return this._resizable};e.remove=function(){var a=
this._frame.parent();a&&(a.transferFrom(this._content),this._frame.destroy());this.isInternal()||ya.on.remove.dispatch(this.id,this._edge)};e.isVisible=function(){return this._visible};e.show=function(a){var b=this._toolbar;a=a||{};if(!this._visible){this._autoSize=this._visible=!0;this._toolbar.css("display","block");if(void 0===this._borderSize&&(this._borderSize=0,y.unwrap(this._toolbar).style[this._border])){var c=this._toolbar.computedStyle();c&&(this._borderSize=parseInt(c[this._border+"Width"],
10))}this.applySize(a.size,!0);this.isInternal()||ya.on.show.dispatch(this.id,this._edge,b.offsetWidth,b.offsetHeight)}this.dispatchSize(a.refresh)};e.hide=function(){this._visible&&(this._visible=!1,this._toolbar.css("display",null),this.applySize(),this.isInternal()||ya.on.hide.dispatch(this.id,this._edge))};e.size=function(){return"width"===this._dimension?this._toolbar.innerWidth:this._toolbar.innerHeight};e.setSize=function(a){if("auto"===a)this._toolbar.css(this._dimension,null),this._autoSize=
!0,this.applySize();else{this._visible&&void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._toolbar.css(this._dimension,a);this._autoSize=!1;switch(this._edge){case "top":case "bottom":this._resizeHandle&&(a-=this._resizeHandle.offsetHeight);break;case "left":case "right":this._resizeHandle&&(a-=this._resizeHandle.offsetWidth)}this.applySize(a)}};e.applySize=function(a,b,c){if(void 0!==a||void 0===this._startSize){var d=this._toolbar,e=this._content,g=this._toolsElem,k=this._frame;if(this._visible){this._autoSize&&
d.removeCSS(["bottom","top","right","left",this._dimension]);if(void 0===a){switch(this._edge){case "top":case "bottom":this._autoSize?this._size=g.offsetHeight:(this._size=d.offsetHeight,this._resizeHandle&&(this._size-=this._resizeHandle.offsetHeight));break;case "left":case "right":this._autoSize?this._size=g.offsetWidth:(this._size=d.offsetWidth,this._resizeHandle&&(this._size-=this._resizeHandle.offsetWidth))}a=this._size}void 0!==this._minSize&&a<this._minSize&&(a=this._minSize);this._collapseSize&&
(a<this._collapseSize?this._collapsed||(this._collapseHeader.css("display","block"),this._toolsParent.css("display","none"),this._collapsed=!0):this._collapsed&&(this._collapseHeader.css("display",null),this._toolsParent.css("display",null),this._collapsed=!1));void 0!==this._borderSize&&(a+=this._borderSize);var g=k.clientWidth,k=k.clientHeight,q=w.rootNode.clientWidth-10,l=w.rootNode.clientHeight-10;switch(this._edge){case "top":this._visible&&this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,
a>l&&(a=l));d.css("bottom",k-a+"px");this._overlay||e.css("top",a+"px");break;case "bottom":this._resizeHandle&&(a+=this._resizeHandle.offsetHeight,a>l&&(a=l));d.css("top",k-a+"px");this._overlay||e.css("bottom",a+"px");break;case "left":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,a>q&&(a=q));d.css("right",g-a+"px");this._overlay||e.css("left",a+"px");break;case "right":this._resizeHandle&&(a+=this._resizeHandle.offsetWidth,a>q&&(a=q)),d.css("left",g-a+"px"),this._overlay||e.css("right",
a+"px")}}else if(!this._overlay)switch(this._edge){case "top":e.css("top",0);break;case "bottom":e.css("bottom",0);break;case "left":e.css("left",0);break;case "right":e.css("right",0)}!0!==b&&this.dispatchSize(c)}};e.dispatchSize=function(a){var b=0,c=0;this._visible&&(this._collapsed?(b=this._collapseHeader.clientWidth,c=this._collapseHeader.clientHeight):(b=this._toolsParent.clientWidth,c=this._toolsParent.clientHeight));if(a||b!=this._width||c!=this._height)this._width=b,this._height=c,ka.dispatchResize(),
this.isInternal()?ya.on.resizeinternal.dispatch(this.id,this._edge,b,c,this._collapsed):ya.on.resize.dispatch(this.id,this._edge,b,c)};return c}(),$c=function(){return function(){var c,e,a,b,d,g=[],k,m,r,t;this.show=function(){c&&c.show()};this.hide=function(){c&&c.hide()};this.length=function(){return g.length};this.addPrevNext=function(c,g){if(!b){b=new $b("\u25c4",T.PAGE_UP);c&&(b.onclick(c),b.ontap(c));d=new $b("\u25ba",T.PAGE_DOWN);g&&(d.onclick(g),d.ontap(g));var k=y.create("div","oit-tab-nextprev");
k.append(b,d);e.append(k);(k=k.size())&&k.width&&a.css("right",k.width+"px")}};this.addTab=function(b,c,d,e){var k=y.create("div","oit-tab");k.html("<div>"+b+"</div>");c&&k.addClass("oit-hidden");a.append(k);g.push(k);if(d instanceof Function)k.on("click",null,u,d,e).on("tap",null,u,d,e);return g.length-1};var u=function(a,b,c){b(c)};this.showTab=function(a){0<=a&&a<g.length&&(g[a].css("display",null),n())};this.hideTab=function(a){0<=a&&a<g.length&&(g[a].css("display","none"),n())};this.tabClass=
function(a,b){if(0<=a&&a<g.length){if(g[a].customClass){if(g[a].customClass===b)return;g[a].removeClass(g[a].customClass);delete g[a].customClass}b&&(g[a].addClass(b),g[a].customClass=b)}};this.setActiveTab=function(b){if(0<=b&&b<g.length&&b!=k&&(void 0!=k&&g[k].removeClass("oit-tab-selected"),k=b,g[k].addClass("oit-tab-selected"),n(),void 0!==k)){b=g[k].rect(e);var c=a.rect(e),d=c.left;b.right>c.right?d-=b.right-c.right:0>b.left&&(d-=b.left);0<=d?a.css("left",null):a.css("left",d+"px")}};this.tabRect=
function(a){if(0<=a&&a<g.length){a=g[k].rect(w.rootNode);a=new aa(a,"view");var b=w.viewNode.rect(w.rootNode);a.offset(-b.left,-b.top);return a}};this.destroy=function(){c&&ya.removeInternal(-2);e&&e.destroy();g=d=b=a=e=c=null};var n=function(){if(b){for(var a,c,e=0;e<g.length;e++)"none"!==g[e].css("display")&&(c=e,void 0===a&&(a=e));b.disabled=k<=a;d.disabled=k>=c}};e=y.create("div","oit-tab-bar");a=y.create("div","oit-tab-list");e.append(a);a.kinetic(!0);a.ondragstart(function(b){b=a.rect(e);m=
b.left;r=b.right;t=g[g.length-1].rect(e).right;return!1});a.ondragmove(function(b){var c=b.delta.x;b=m+c;0>b&&(c=t+c,c<r&&(b+=r-c));0<b&&(b=0);a.css("left",b+"px");return!1});c=new Pb(-2,"bottom",e,null,ya.internalParent(-2));ya.addInternal(-2,c);c.show()}}(),sd=function(){return function(){var c,e,a;this.show=function(){c&&c.show()};this.hide=function(){c&&c.hide()};this.enable=function(){a.attr("disabled",null)};this.disable=function(){a.attr("disabled","disabled")};this.setText=function(b){b?a.attr("value",
b):a.attr("value","")};this.destroy=function(){c&&ya.removeInternal(-4);e&&e.destroy();a=e=c=null};e=y.create("div","oit-formula-bar");var b=y.create("div","oit-formula-padding");a=y.create("input","oit-formula-text");a.attr("type","text");a.attr("readonly","readonly");b.append(a);e.append(b);c=new Pb(-4,"top",e,null,ya.internalParent(-4));ya.addInternal(-4,c);c.show()}}(),Ea=function(){var c=function(a,c,e){this._size=c;this._hidden=!1;a?(this._hidden=!0===a.hidden,void 0!==a.h?this._size=a.h:void 0!==
a.w&&(this._size=a.w),this._title=void 0!==a.t?a.t:e,void 0!==a.st&&(this._styleIndex=a.st),this._acc=a.acc,this._accend=a.accend):this._title=e;this._originalHidden=this._hidden;this._originalSize=this._size},e=W(c);e.acc=function(){return this._acc};e.accend=function(){return this._accend};e.clone=function(){var a=new c(null,this._size,this._title);a._size=this._size;a._originalSize=this._originalSize;a._hidden=this._hidden;a._originalHidden=this._originalHidden;a._title=this._title;void 0!==this._styleIndex&&
(a._styleIndex=this._styleIndex);void 0!==this._acc&&(a._acc=this._acc);void 0!==this._accend&&(a._accend=this._accend);void 0!==this._revisions&&(a._revisions=this._revisions);void 0!==this._deleted&&(a._deleted=this._deleted);this._data&&(a._data=this._data.slice(0));a.clonedFrom=this;return a};e.title=function(){return this._title};e.style=function(){return this._styleIndex};e.revision=function(a){void 0!==a&&(this._revisions||(this._revisions=[],this.clonedFrom&&(this.clonedFrom._revisions=this._revisions)),
this._revisions.push(a),"delete_col"===a.type||"delete_row"===a.type)&&(this._deleted=!0);return this._revisions};e.setCellData=function(a){var b;this._data=a;if(void 0===this._acc){for(a=0;a<this._data.length;a++)if((b=this._data[a])&&b.t&&void 0!==b.a){this._acc=b.a;break}if(void 0!=this._acc)for(a=this._data.length-1;0<=a;a--)if((b=this._data[a])&&b.t&&void 0!==b.a){this._accend=b.a+b.t.length-1;break}}};e.hidden=function(){return this._hidden};e.originalHidden=function(){return this._originalHidden};
e.deleted=function(){return!!this._deleted};e.show=function(a){return this._hidden||5>this._size?(this._hidden=!1,5>this._size&&(this._size=a),!0):!1};e.reset=function(){var a=!1;void 0!=this._originalSize&&(this._size=this._originalSize,a=!0);!this._hidden&&this._originalHidden&&(a=this._hidden=!0);return a};e.size=function(){return this._hidden?0:this._size};e.setSize=function(a){if("number"!==typeof a)throw"Invalid argument to setSize";this._size=a;this._hidden=0===a};e.getCellsForRange=function(a,
c){if(this._data&&void 0!==this._acc&&a<=this._accend&&c>=this._acc){for(var b,d=0;d<this._data.length;d++){var e=this._data[d];e&&e.t&&void 0!==e.a&&a<=e.a+e.t.length&&c>=e.a&&(b||(b=[]),b.push(e))}return b}};e.getIndexForCell=function(a){if(this._data){for(var b=0,c=0;c<this._data.length;c++){var e=this._data[c];if(e&&e==a)break;e&&e.e?b+=e.e:b++}return b}};var a=function(a,c){if(a._data){if(void 0===a._getCellIndex||c<a._getCellIndex)if(a._cellDataIndex=0,a._getCellIndex=0,a._getCellEmpty=0,0<
a._data.length){var b=a._data[0];b?b.e&&(a._getCellEmpty=b.e):a._getCellEmpty=1}for(;a._getCellIndex<c;){0<a._getCellEmpty&&a._getCellEmpty--;if(0===a._getCellEmpty){a._cellDataIndex++;if(a._cellDataIndex>=a._data.length){a._getCellIndex=c;return}b=a._data[a._cellDataIndex];a._getCellEmpty=b?b.e||0:1}a._getCellIndex++}if(a._cellDataIndex<a._data.length)return a._cellDataIndex}};e.getCell=function(b){b=a(this,b);if(void 0!==b)return this._data[b]};e.insertCell=function(b){this._data&&void 0!==a(this,
b)&&this._data.splice(this._cellDataIndex,0,null)};return c}(),od=function(){var c={add_row:!0,delete_row:!0},e={add_col:!0,delete_col:!0},a={add_row:!0,delete_row:!0,add_col:!0,delete_col:!0,new_cell:!0,clear_cell:!0,modify_cell:!0,move_cells:!0},b=function(a,b,c){this._page=c;this._top=this._left=null;this._extRowCount=this._extColCount=this._bottom=this._right=void 0;this._merged=null;this._ajaxLoading=this._ajaxPending=0;this._hideMsg=!1;this._cellGridChanged=!0;this._showAnnotations=!1;this._fonts=
a.sheet.fonts;this._styles=a.styles;a.formulas&&(this._formulas=a.formulas);a.sheet.hasOwnProperty("s")?this._sheetStyle=this.cellStyle(a.sheet.s):this._sheetStyle={};this._colMajor="colmajor"===a.sheet.order;this._defColWidth=a.sheet.defcw||80;this._defRowHeight=a.sheet.defrh||20;a.cols||(a.cols=[]);a.rows||(a.rows=[]);this._colCount=0<a.sheet.c?a.sheet.c:a.cols.length;this._rowCount=0<a.sheet.r?a.sheet.r:a.rows.length;this._cols=[];for(var d=0;d<a.cols.length;d++){var e=a.cols[d];if(void 0!==e.s)for(var f=
e.e||e.s,h=e.s;h<=f;h++)c=Ma(h),this._cols[h]=new Ea(e,this._defColWidth,c);else c=Ma(d),this._cols[d]=new Ea(e,this._defColWidth,c)}this._rows=[];for(d=0;d<a.rows.length;d++)if(e=a.rows[d],void 0!==e.s)for(f=e.e||e.s,h=e.s;h<=f;h++)c=Ya(h),this._rows[h]=new Ea(e,this._defRowHeight,c);else c=Ya(d),this._rows[d]=new Ea(e,this._defRowHeight,c);var g;a.cells&&(g=k(this,a.cells));if(a.data)for(this._data=a.data,a=0;a<this._data.length;a++)c=this._data[a],c.f&&this._ajaxPending++,c.iend=a+1<this._data.length?
this._data[a+1].i-1:this._colMajor?this._colCount:this._rowCount;this._embeds=b;r(this,g)},d=W(b);d.showAnnotations=function(a){if(void 0!==a){var b=!1;!0!==a&&(a=!1);!0===a&&(this._annoRows||this._annoCols)?(this._annoRows&&this._rows!==this._annoRows&&(this._rows=this._annoRows,this._rowCount=this._annoRowCount,b=!0),this._annoCols&&this._cols!==this._annoCols&&(this._cols=this._annoCols,this._colCount=this._annoColCount,b=!0)):(this._normalRows&&this._rows!==this._normalRows&&(this._rows=this._normalRows,
this._rowCount=this._normalRowCount,b=!0),this._normalCols&&this._cols!==this._normalCols&&(this._cols=this._normalCols,this._colCount=this._normalColCount,b=!0));b&&(this._top=this._left=null,this._extRowCount=this._extColCount=this._bottom=this._right=void 0,this._cellGridChanged=!0,this._showAnnotations=a,delete this._accmap)}return this._showAnnotations};d.cellGridChanged=function(a){void 0!==a&&(this._cellGridChanged=!!a);return this._cellGridChanged};d.getCellText=function(a,b){var c=this.getCell(a,
b);return c?c.t||c.v||"":""};d.getCellComments=function(a,b,c){var d,e=this._page.comments();if(e)for(var f=0;f<e.length;f++){var h=e[f];if("cell"===h.type&&h.range&&"cell"===h.range.type){var g=h.range;this._showAnnotations&&h.annoRange&&(g=h.annoRange);a>=g.c1&&a<=g.c2&&b>=g.r1&&b<=g.r2&&(!c||g.c2==a&&g.r1==b)&&(d||(d=[]),d.push(h))}}return d};d.updateDimensions=function(){this._right=this.colLeft(this._colCount);this._bottom=this.rowTop(this._rowCount);this._extColCount=this._colCount;this._extRowCount=
this._rowCount;var a=this.embeddingCount();if(a){for(var b=0;b<a;b++){var c=this.embed(b);if(c){if(!c.expansionApplied){var d=this.embed(b);if(d.node&&!d.originApplied){d.originApplied=!0;d.adjustX=0;d.adjustY=0;var e=d.node.data("origin");e&&(e=e.split(","),2==e.length&&(d.adjustX=Number(e[0]),d.adjustY=Number(e[1])))}}var g=this.colWidth(c.c1),k=this.rowHeight(c.r1),l=c.x1,q=c.y1;l>g&&(l=g);q>k&&(q=k);d=this.colLeft(c.c1)+l;e=this.rowTop(c.r1)+q;c.position={left:d,top:e};void 0===c.c2?(c.position.right=
d+c.w,c.position.bottom=e+c.h):(g=this.colWidth(c.c2),k=this.rowHeight(c.r2),l=c.x2,q=c.y2,l>g&&(l=g),q>k&&(q=k),g=this.colLeft(c.c2)+l,q=this.rowTop(c.r2)+q,g<d&&(g=d),q<e&&(q=e),c.position.right=g,c.position.bottom=q);c.position.right>this._right&&(this._right=c.position.right);c.position.bottom>this._bottom&&(this._bottom=c.position.bottom)}}this._extColCount=this.colFromX(this._right)+1;this._extRowCount=this.rowFromY(this._bottom)+1;this._right=this.colLeft(this._extColCount);this._bottom=this.rowTop(this._extRowCount)}};
d.unload=function(){Z(this._data,function(a){a.ajax&&eb(a.ajax)});this._data=null;this._deferredTimer&&(E.resumeIdleTimer("loadDataForCells"),ta(this._deferredTimer),delete this._deferredTimer);this._embeds=this._styles=this._fonts=this._sheetStyle=this._merged=this._rows=this._cols=null};d.sheetStyle=function(){return this._sheetStyle};d.webFonts=function(){return this._fonts};d.getFormulaText=function(a,b){var c=this.getCell(a,b);if(c){if(!c.fa&&void 0!==c.fm){var d;a:{if(this._formulas&&(d=this.getCell(a,
b))&&"number"==typeof d.fm&&0<=d.fm&&d.fm<this._formulas.length){d=this._formulas[d.fm];break a}d=void 0}if(d){var e,f=b,h=d.f,g=0,k=0;e=a;if(this._showAnnotations)for(var l=0;l<e;l++){var p=this._cols[l];p&&p.title()==T.DEL&&e--}if(this._showAnnotations)for(l=0;l<f;l++)(p=this._rows[l])&&p.title()==T.DEL&&f--;c.fr||(g=e-d.c,k=f-d.r);d=td(h,g,k,E.externalLinks());c.fa="="+d;c.fr&&(c.fa="{"+c.fa+"}")}}return c.fa}};d.showHidden=function(a){if(a){this._showHidden||(this._showHidden={columns:!1,rows:!1});
if("string"===typeof a)switch(a){case "all":this._showHidden.columns=!0;this._showHidden.rows=!0;break;case "none":this._showHidden.columns=!1;this._showHidden.rows=!1;break;case "columns":this._showHidden.columns=!0;break;case "rows":this._showHidden.rows=!0}else void 0!==a.sheets&&void 0!==a.columns&&void 0!==a.rows&&(this._showHidden.columns=a.columns,this._showHidden.rows=a.rows);this.cellGridChanged(!0)}return this._showHidden};d.embeddingCount=function(){return this._embeds?this._embeds.length:
0};d.embed=function(a){if(this._embeds&&0<=a&&a<this._embeds.length)return(a=this._embeds[a])&&!a.node&&(a.node=y.byId(a.id),!a.node||a.node.hasClass("oit-svg-embed")||a.node.hasClass("oit-image-embed")||(a.node=a.node.parent())),a};d.embedByUID=function(a){return bb(this._embeds,"uid",a)};d.getCell=function(a,b){var c,d;this._colMajor?(d=this._cols[a])&&(c=d.getCell(b)):((d=this._rows[b])&&(c=d.getCell(a)),!c&&this._showAnnotations&&(d=this._cols[a])&&(c=d.getCell(b)));return c||null};d.cellFromPos=
function(a,b,c){this._right&&this._bottom||this.updateDimensions();a=this.colFromX(a);b=this.rowFromY(b);a>=this._extColCount&&(a=this._extColCount-1);b>=this._extRowCount&&(b=this._extRowCount-1);!1!==c&&(c=this.getMergedCell(a,b))&&(a=c.range.c1,b=c.range.r1);return sa(a,b)};d.prevTextCell=function(a,b){var c,d,e,f=a-50;0>f&&(f=0);if(this._colMajor)for(e=a-1;e>=f;e--){if((d=this._cols[e])&&(d=d.getCell(b))&&(d.t||d.v)){c=e;break}}else{var g=this._rows[b];if(g)for(e=a-1;e>=f;e--)if((d=g.getCell(e))&&
(d.t||d.v)){c=e;break}}return c};d.cellStyle=function(a){return this._styles&&void 0!==a&&0<=a&&a<this._styles.length?this._styles[a]:{}};d.rowCount=function(){void 0===this._bottom&&this.updateDimensions();return this._extRowCount};d.colCount=function(){void 0===this._right&&this.updateDimensions();return this._extColCount};d.eachRow=function(a){for(var b in this._rows)a(Number(b))};d.eachCol=function(a){for(var b in this._cols)a(Number(b))};d.rowHeight=function(a){return(a=this._rows[a])?a.size():
this._defRowHeight};d.colWidth=function(a){return(a=this._cols[a])?a.size():this._defColWidth};d.setRowHeight=function(a,b){var c=this._rows[a];c||(c=Ya(a),this._rows[a]=c=new Ea(null,this._defRowHeight,c));c.setSize(b);this._top=null;this._right=void 0;this.cellGridChanged(!0)};d.setColWidth=function(a,b){var c=this._cols[a];c||(c=Ma(a),this._cols[a]=c=new Ea(null,this._defColWidth,c));c.setSize(b);this._left=null;this._bottom=void 0;this.cellGridChanged(!0)};d.showRow=function(a){return(a=this._rows[a])&&
a.show(this._defRowHeight)?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};d.showCol=function(a){return(a=this._cols[a])&&a.show(this._defColWidth)?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};d.resetRow=function(a){return(a=this._rows[a])&&a.reset()?(this._top=null,this._right=void 0,this.cellGridChanged(!0),!0):!1};d.resetCol=function(a){return(a=this._cols[a])&&a.reset()?(this._left=null,this._bottom=void 0,this.cellGridChanged(!0),!0):!1};d.colHidden=
function(a){return(a=this._cols[a])?a.hidden():!1};d.colOriginalHidden=function(a){return(a=this._cols[a])?a.originalHidden():!1};d.rowHidden=function(a){return(a=this._rows[a])?a.hidden():!1};d.rowOriginalHidden=function(a){return(a=this._rows[a])?a.originalHidden():!1};d.colDeleted=function(a){return(a=this._cols[a])?a.deleted():!1};d.rowDeleted=function(a){return(a=this._rows[a])?a.deleted():!1};d.colStyle=function(a){return(a=this._cols[a])?this.cellStyle(a.style()):{}};d.rowTop=function(a){if(!this._top){this._top=
[];for(var b=0,c=0;c<=this._rows.length;c++){this._top.push(b);var d=this._rows[c],b=d?b+d.size():b+this._defRowHeight}}if(a<this._top.length)return this._top[a];b=this._top.length-1;return this._top[b]+(a-b)*this._defRowHeight};d.rowBottom=function(a){return this.rowTop(a+1)};d.rowFromY=function(a){for(var b=0;a>this.rowBottom(b);)b++;for(;!this.rowHeight(b)&&0<b;)b--;return b};d.colLeft=function(a){if(!this._left){this._left=[];for(var b=0,c=0;c<=this._cols.length;c++){this._left.push(b);var d=
this._cols[c],b=d?b+d.size():b+this._defColWidth}}if(a<this._left.length)return this._left[a];b=this._left.length-1;return this._left[b]+(a-b)*this._defColWidth};d.colRight=function(a){return this.colLeft(a+1)};d.colFromX=function(a){for(var b=0;a>this.colRight(b);)b++;for(;!this.colWidth(b)&&0<b;)b--;return b};d.sheetRight=function(){void 0===this._right&&this.updateDimensions();return this._right};d.sheetBottom=function(){void 0===this._bottom&&this.updateDimensions();return this._bottom};d.colTitle=
function(a,b){var c,d=this._cols[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedCols&&a>=this._colCount&&(a-=this._deletedCols),!1!==b&&(c=Ma(a)));return c};d.rowTitle=function(a,b){var c,d=this._rows[a];d&&(c=d.title());c||(this._showAnnotations&&this._deletedRows&&a>=this._rowCount&&(a-=this._deletedRows),!1!==b&&(c=Ya(a)));return c};d.colType=function(a){var b;(a=this._cols[a])&&(b=a.type());return b};d.rowType=function(a){var b;(a=this._rows[a])&&(b=a.type());return b};d.getMergedCell=
function(a,b){var c;if(this._merged)for(var d=0;d<this._merged.length;d++){var e=this._merged[d].range;if(a>=e.c1&&a<=e.c2&&b>=e.r1&&b<=e.r2){c=this._merged[d];break}}return c};d.containsRange=function(a){var b=!1;if("text"===a.type){var c=a.acc;a=a.accend;var d=this.findCellsForRange(c,a);if(-1!=d)for(var e=this.getACCMap(),f=this._colMajor?this._cols:this._rows;d<e.length;d++){var g=f[e[d]];if(g){if(g.acc()>a)break;if(g.getCellsForRange(c,a)){b=!0;break}}}}else b=a.page===this._page.index;return b};
d.getACCMap=function(){if(!this._accmap){this._accmap=[];var a=this._colMajor?this._cols:this._rows,b;for(b in a){var c=Number(b),d=a[c];d&&void 0!==d.acc()&&this._accmap.push(c)}}return this._accmap};d.findCellsForRange=function(a,b){var c=this.getACCMap(),d=this._colMajor?this._cols:this._rows;if(0==c.length)return-1;for(var e=0;e<d.length&&!d[e];)e++;for(var f=d.length-1;0<=f&&!d[f];)f--;if(!d[e]||!d[f]||b<d[e].acc()||a>d[f].accend())return-1;for(var e=0,f=c.length-1,g;e<=f;){g=Math.floor((e+f)/
2);var h=d[c[g]];if(b<h.acc())f=g-1;else if(a>h.accend())e=g+1;else break}for(;0<g&&d[c[g-1]].accend()>a;)g--;return g};d.getCellsForRange=function(a,b){var c=this.findCellsForRange(a,b);if(-1!=c){for(var d=this.getACCMap(),e=this._colMajor?this._cols:this._rows,f=void 0;c<d.length;c++){var g=e[d[c]];if(g){if(g.acc()>b)break;(g=g.getCellsForRange(a,b))&&(f?Array.prototype.push.apply(f,g):f=g)}}return f}};d.select=function(a){var b=!1,c,d;if(a&&"text"===a.type){if(0!==Na(a,this._selectedRange)&&(this.select(null),
c=this._selectedCells=this.getCellsForRange(a.acc,a.accend))){this._selectedRange=ga(a);for(d=0;d<c.length;d++)b=c[d],b.selection=a,b.highlightsChanged=!0;b=!0}}else if(this._selectedCells){c=this._selectedCells;delete this._selectedCells;delete this._selectedRange;for(d=0;d<c.length;d++)b=c[d],delete b.selection,b.highlightsChanged=!0;b=!0}return b};d.addHighlight=function(a){var b=!1,c,d;if(a)if("text"===a.range.type){var e=this.getCellsForRange(a.range.acc,a.range.accend);if(e){for(d=0;d<e.length;d++)c=
e[d],c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);b=!0}!b&&this.hasPendingContent()&&(b=this._page.containsRange(a.range))}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(e=this.mapToText(a.range)))for(d=0;d<e.length;d++)if(c=e[d],c=this.getCell(c.cell.c,c.cell.r))c.highlights?-1==c.highlights.indexOf(a)&&(c.highlights.push(a),c.highlightsChanged=!0):(c.highlights=[a],c.highlightsChanged=!0);return b};d.updateHighlight=
function(a){var b;if(a)if("text"===a.range.type){var c=this.getCellsForRange(a.range.acc,a.range.accend);if(c)for(a=0;a<c.length;a++)c[a].highlightsChanged=!0}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(c=this.mapToText(a.range)))for(a=0;a<c.length;a++)if(b=c[a],b=this.getCell(b.cell.c,b.cell.r))b.highlightsChanged=!0};d.removeHighlight=function(a){if(a){var b,c;if("text"==a.range.type){var d=this.getCellsForRange(a.range.acc,a.range.accend);if(d){for(c=0;c<d.length;c++)b=d[c],b.highlights&&
(Ka(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0);return!0}}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(d=this.mapToText(a.range)))for(c=0;c<d.length;c++)b=d[c],(b=this.getCell(b.cell.c,b.cell.r))&&b.highlights&&(Ka(b.highlights,a),0===b.highlights.length&&delete b.highlights,b.highlightsChanged=!0)}return!1};d.expandRange=function(a){a=ga(a);if(this._merged){var b;do{b=!1;for(var c=0;c<this._merged.length;c++){var d=this._merged[c];a.c1<=d.range.c2&&
a.c2>=d.range.c1&&a.r1<=d.range.r2&&a.r2>=d.range.r1&&(d.range.c1<a.c1&&(a.c1=d.range.c1,b=!0),d.range.r1<a.r1&&(a.r1=d.range.r1,b=!0),d.range.c2>a.c2&&(a.c2=d.range.c2,b=!0),d.range.r2>a.r2&&(a.r2=d.range.r2,b=!0))}}while(b)}return a};d.getHoverText=function(){if(!x.showCellTooltips||this.isRangeSelected())return null;var a=S.cellSelection();return(a=this.getCell(a.c1,a.r1))&&a.clipped?a.t||a.v:null};d.isRangeSelected=function(){var a=!1,b=S.cellSelection();if(b&&(b.c1!=b.c2||b.r1!=b.r2)&&(a=!0,
this._merged))for(var c=0;c<this._merged.length;c++){var d=this._merged[c];if(b.c1==d.range.c1&&b.c2==d.range.c2&&b.r1==d.range.r1&&b.r2==d.range.r2){a=!1;break}}return a};d.getSelectedText=function(){var a="",b;switch(S.selectionType()){case "text":if(this._selectedCells){b=S.textSelection();for(var c=this._selectedCells,d=0;d<c.length;d++){var e=c[d];if(e.t){var g=b.acc-e.a;0>g&&(g=0);var k=b.accend-e.a;k>g&&(a&&(a+="\t"),a+=e.t.substring(g,k))}}}break;case "cell":if(b=S.cellSelection(),this.isRangeSelected())for(c=
0,d=b.r1;d<=b.r2;d++){e=0;for(g=b.c1;g<=b.c2;g++){if(k=this.getCellText(g,d)){if(0<c)for(1E3<c&&(c=1E3);0<c;c--)a+="\r\n";if(0<e)for(1E3<e&&(e=1E3);0<e;e--)a+="\t";a+=k}e++}c++}else a=this.getCellText(b.c1,b.r1)||""}return a};d.mapToCells=function(a){if("text"==a.type){var b=[],c=a.acc;a=a.accend;var d=this.getACCMap();if(this._colMajor){var e=this.findCellsForRange(c,a);if(-1==e)return;for(;e<d.length;e++){var e=d[e],f=this._cols[e];if(f){if(f.acc()>a)break;var g=e,k=b;if(f){var l=f.getCellsForRange(c,
a);if(l)for(var q=0;q<l.length;q++){var p=f.getIndexForCell(l[q]),n=this.getMergedCell(g,p);n?k.push(ga(n.range)):k.push(sa(g,p))}}}}}else{e=this.findCellsForRange(c,a);if(-1==e)return;for(;e<d.length;e++)if(e=d[e],f=this._rows[e]){if(f.acc()>a)break;g=e;k=b;if(f&&(l=f.getCellsForRange(c,a)))for(q=0;q<l.length;q++)p=f.getIndexForCell(l[q]),(n=this.getMergedCell(p,g))?k.push(ga(n.range)):k.push(sa(p,g))}}return b}};d.mapToText=function(a){if("cell"==a.type){var b;a=g(a);for(var c=a.r1;c<=a.r2;c++)for(var d=
a.c1;d<=a.c2;d++){var e=this.getCell(d,c);if(e&&e.t&&void 0!==e.a){var f=e.a+e.t.length;b||(b=[]);e=pa(e.a,f);e.cell={c:d,r:c};b.push(e)}}return b}};d.decomposeRange=function(a,b){if("cell"==a.type){a=g(a);var c=this.mapToText(a);if(b)c?c.push(a):c=[a];else{for(var d=[],e=a.r1;e<=a.r2;e++)for(var f=null,h=a.c1;h<=a.c2;h++){var k=this.getCell(h,e);k&&k.v&&(f&&f.c2==h-1?f.c2=h:(f=sa(a.page,h,e,h,e),d.push(f)))}if(0<d.length)for(c||(c=[]),e=0;e<d.length;e++)if(f=d[e]){for(h=e+1;h<d.length;h++)(k=d[h])&&
k.r1==f.r2+1&&k.c1==f.c1&&k.c2==f.c2&&(f.r2=k.r2,d[h]=null);c.push(f)}}return c}};var g=function(a){var b=a;if("cell"==a.type&&a.offsets){var b=a.c1,c=a.c2,d=a.r1,e=a.r2,f;b>c&&(f=b,b=c,c=f);d>e&&(f=d,d=e,e=f);0>a.offsets.left&&0<b&&b--;0<a.offsets.right&&c++;0>a.offsets.top&&0<d&&d--;0<a.offsets.bottom&&e++;b=sa(a.page,b,d,c,e)}return b},k=function(a,b){var c,d,e,f,g,h,k;delete a._accmap;var l=a._colMajor?a._cols:a._rows;c=0;var p,q=[];for(e=0;e<b.length;e++){var n=b[e];n instanceof Array?p=c:(c=
n.i,p=n.e||n.i,n=n.d);var u;a._colMajor?(u=new Ea(null,a._defColWidth,null),void 0===f&&(f=c,g=0,k=a.rowCount())):(u=new Ea(null,a._defRowHeight,null),void 0===g&&(g=c,f=0,h=a.colCount()));for(var m=c;m<=p;m++){a._colMajor?h=m:k=m;l[m]||(l[m]=u);l[m].setCellData(n);for(var r=0,C=0;r<n.length;r++){d=n[r];d.fr&&q.push(d);if(d.mh||d.mv)a._merged||(a._merged=[]),c=a._colMajor?sa(m,C,m,C):sa(C,m,C,m),d.mh&&(c.c2+=d.mh),d.mv&&(c.r2+=d.mv),a._merged.push({cell:d,range:c});d.e?C+=d.e:C++}}c=p+1}for(e=0;e<
q.length;e++)for(d=q[e],c=zb(d.fr),l=c.c1;l<=c.c2;l++)for(p=c.r1;p<=c.r2;p++)(n=a.getCell(l,p))&&n!==d&&(n.fr=d.fr,n.fm=d.fm);return sa(a._page.index,f,g,h,k)},m=function(a,b,c){for(var d;0<=b&&b<a.length;b+=c){var e=a[b];if(e&&void 0!==e.acc()){d=e;break}}return d},r=function(a,b){if(b){var c,d;a._colMajor?(c=m(a._cols,b.c1,1),d=m(a._cols,b.c2,-1)):(c=m(a._rows,b.r1,1),d=m(a._rows,b.r2,-1));c&&d&&(P.each(function(b){b.addToPage(a._page.index)},function(b){b=P.highlight(b).range;return"text"!==b.type?
b.page===a._page.index:b.acc<d.accend()&&b.accend>c.acc()}),F.update(!0))}},t=function(a,b,c,d,e,g,l){g.loaded=!0;delete g.ajax;0===--e._ajaxLoading&&e._hideMsg&&(ua.hideMessage(),e._hideMsg=!1);if(200===d){var f=JSON.parse(c);f.cells&&(f=k(e,f.cells),r(this,f))}else e.logAJAXError(null,"Failed to load the spreadsheet data for sheet "+(e._page+1)+" from the server",a,d,c);E.resumeIdleTimer("loadSSDataFromServer");if(l){for(var f=[e],h=7;h<arguments.length;h++)f.push(arguments[h]);l.apply(null,f)}},
u=function(a,b,c){if(b.f&&!b.loaded&&!b.ajax){var d=b.f;"/"!=d.charAt(0)&&(d=Sa(w.baseURL,d));E.pauseIdleTimer("loadSSDataFromServer");b.ajax=ab({url:d,context:a,complete:t,args:Array.prototype.slice.call(arguments)});a._ajaxPending--;a._ajaxLoading++;1!=a._ajaxLoading||ua.messageVisible()||(ua.showMessage(T.PLEASE_WAIT_DOWNLOADING),a._hideMsg=!0)}};d.hasPendingContent=function(){return this._data||0<this._ajaxPending||0<this._ajaxLoading};d.loadRange=function(a,b){if(this._data)switch(a.type){case "text":var c=
this.mapToCells(a);c&&0!==c.length||da(n,0,this,this,a,b);break;case "cell":this.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,b)}b&&b(a)};var n=function(a,b,c){var d=a.mapToCells(b);if(d&&0<d.length)c&&c(b);else for(d=0;d<a._data.length;d++){var e=a._data[d];if(e&&!e.loaded&&!e.ajax){u(a,e,n,b,c);break}}};d.loadDataForCells=function(a,b,c,d,e,g){if(void 0===a||void 0===b||void 0===c||void 0===d)g&&g();else if(this._data){this._colMajor||(a=b,c=d);var f;for(d=0;d<this._data.length;d++)if((b=this._data[d])&&
!b.loaded&&!b.ajax){if(b.i>c)break;if(b.iend>=a){var h=!1;if(this._colMajor)for(var k=b.i;k<=b.iend;k++){if(!this.colHidden(k)){h=!0;break}}else for(k=b.i;k<=b.iend;k++)if(!this.rowHidden(k)){h=!0;break}h&&(f||(f=[]),f.push(b))}}f?e?(this._deferredTimer?(ta(this._deferredTimer),delete this._deferredTimer):E.pauseIdleTimer("loadDataForCells"),this._deferredTimer=da(function(a,b){delete this._deferredTimer;E.resumeIdleTimer("loadDataForCells");q.call(this,a,b)},200,this,f,g)):q.call(this,f,g):g&&g()}else g&&
g()};var q=function(a,b){for(var c=0;c<a.length;c++)u(this,a[c],b)},l=function(a){var b;if(a&&void 0!==a.sheet){var c=z.page(a.sheet);if(c&&c.isLoaded()){var d=c.spreadsheetModel();if(d){b=a.c1;var e=a.r1,f=a.c2,g=a.r2,k=a=!1;void 0===b?(b=0,f=d.colCount()-1,a=!0):void 0===f&&(f=b);void 0===e?(e=0,g=d.rowCount()-1,k=!0):void 0===g&&(g=e);b=sa(c.index,b,e,f,g);a&&(b.selectingRows=!0);k&&(b.selectingCols=!0)}}}return b},I=function(a,b,c){for(a=0;a<b.cells.length;a++){c=b.cells[a];var d=l(c.ref);d&&
(delete c.ref,c.range=d)}},L=function(a){for(var b={t:""},c=0;c<a.text.length;c++){var d=a.text[c];if(d.range){var e=ia.getRawText(d.range.acc,d.range.accend);e&&(b.t+=e,b.a||(b.a=d.range.acc))}else d.text&&(b.t+=d.text,delete b.a)}return b},K=function(a,b,c){b.resolved||(b.ref&&(void 0===b.ref.sheet||b.page||(b.page=z.page(b.ref.sheet)),b.range=l(b.ref),b.range&&delete b.ref),b.oldref&&(b.oldrange=l(b.oldref),b.oldrange&&delete b.oldref),b.user&&(c&&(b.author=c[b.user]),delete b.user),b.ref||b.oldref||
(b.resolved=!0));b.resolved&&b.page&&b.page===a._page&&(a._revisions||(a._revisions=[]),-1==a._revisions.indexOf(b)&&(a._revisions.push(b),"delete_row"===b.type?a._deletedRows++:"delete_col"===b.type&&a._deletedCols++))},H=function(a,b){var c=b.indexOf(a);if(-1==c)for(var d in b){var e=b[d];if(e&&e.clonedFrom&&e.clonedFrom===a){c=parseInt(d,10);break}}return c},N=function(a,b){if(b&&(b.col||b.row)){var c=ga(b),d,e=c.c1==c.c2,f=c.r1==c.r2;b.col&&(a._annoCols&&(d=H(b.col,a._annoCols),-1!=d&&(c.c1=d)),
delete b.col);b.col2?(a._annoCols&&(d=H(b.col2,a._annoCols),-1!=d&&(c.c2=d)),delete b.col2):e&&(c.c2=c.c1);b.row&&(a._annoRows&&(d=H(b.row,a._annoRows),-1!=d&&(c.r1=d)),delete b.row);b.row2?(a._annoRows&&(d=H(b.row2,a._annoRows),-1!=d&&(c.r2=d)),delete b.row2):f&&(c.r2=c.r1);return c}};d.processRevisions=function(a,b,c){var d=!1;if(a&&a.revisions){var e=this,f;e._deletedCols=0;for(f=e._deletedRows=0;f<a.revisions.length;f++)K(e,a.revisions[f],a.users);if(e._revisions){a=sa(e._page.index,0,0,0,0);
for(f=0;f<e._revisions.length;f++)d=e._revisions[f],Db(a,d.range),Db(a,d.oldrange);e.loadDataForCells(a.c1,a.r1,a.c2,a.r2,!1,function(){var a,d=e._cols.slice(0),f=e._rows.slice(0);e._normalColCount=e._colCount;e._annoColCount=e._colCount+e._deletedCols;e._normalCols=e._cols;e._annoCols=e._cols.slice(0);e._normalRowCount=e._rowCount;e._annoRowCount=e._rowCount+e._deletedRows;e._normalRows=e._rows;e._annoRows=e._rows.slice(0);for(a=e._revisions.length-1;0<=a;a--){var g=e._revisions[a],h,k,l,q=e;k=g;
g=g.range;h=d;var n=f;if(g)switch(k.type){case "add_row":g.row=n[g.r1];g.row||(l=Ya(g.r1),g.row=n[g.r1]=new Ea(null,q._defRowHeight,l),q._annoRows[g.r1]||(q._annoRows[g.r1]=g.row));g.col=h[g.c1];g.col2=h[g.c2];g.row.revision(k);n.splice(g.r1,1);break;case "add_col":g.col=h[g.c1];g.col||(l=Ma(g.c1),g.col=h[g.c1]=new Ea(null,q._defColWidth,l),q._annoCols[g.c1]||(q._annoCols[g.c1]=g.col));g.row=n[g.r1];g.row2=n[g.r2];g.col.revision(k);h.splice(g.c1,1);break;case "delete_row":l=g;var u=q,m=k,v=new Ea(null,
u._defRowHeight,T.DEL);v.revision(m);m.target=v;I(u,m,v);for(var u=0,r=[],C=0;C<m.cells.length;C++){var H=m.cells[C];H.range.c1>u&&(r.push({e:H.range.c1-u}),u=H.range.c1);r.push(L(H));u++}v.setCellData(r);l.row=v;g.col=h[g.c1];g.col2=h[g.c2];for(g.row.revision(k);g.r1>n.length;)n.push(null);n.splice(g.r1,0,g.row);h=0<g.r1?(h=n[g.r1-1])?q._annoRows.indexOf(h)+1:g.r1:(h=n[g.r1+1])?q._annoRows.indexOf(h):g.r1;for(;h>q._annoRows.length;)q._annoRows.push(null);q._annoRows.splice(h,0,g.row);if(q._colMajor)for(l=
0;l<q._annoCols.length;l++)if(h=q._annoCols[l])k=q._normalCols.indexOf(h),-1!=k&&(k=h,h=k.clone(),q._annoCols[l]=h,k=n.indexOf(k),-1!=k&&(n[k]=h)),h.insertCell(g.r1);break;case "delete_col":l=g;u=q;m=k;v=new Ea(null,u._defColWidth,T.DEL);v.revision(m);m.target=v;I(u,m,v);u=0;r=[];for(C=0;C<m.cells.length;C++)H=m.cells[C],H.range.r1>u&&(r.push({e:H.range.r1-u}),u=H.range.r1),r.push(L(H)),u++;v.setCellData(r);l.col=v;g.row=n[g.r1];g.row2=n[g.r2];for(g.col.revision(k);g.c1>h.length;)h.push(null);h.splice(g.c1,
0,g.col);h=0<g.c1?(h=h[g.c1-1])?q._annoCols.indexOf(h)+1:g.c1:(h=h[g.c1+1])?q._annoCols.indexOf(h):g.c1;for(;h>q._annoCols.length;)q._annoCols.push(null);q._annoCols.splice(h,0,g.col);if(!q._colMajor)for(l=0;l<q._annoRows.length;l++)if(h=q._annoRows[l])k=q._normalRows.indexOf(h),-1!=k&&(k=h,h=k.clone(),q._annoRows[l]=h,k=n.indexOf(k),-1!=k&&(n[k]=h)),h.insertCell(g.c1);break;case "clear_cell":for(;g.c2>=h.length;)l=Ma(h.length),k=new Ea(null,q._defColWidth,l),h.push(k),q._annoCols.push(k);for(;g.r2>=
n.length;)l=Ya(n.length),k=new Ea(null,q._defRowHeight,l),n.push(k),q._annoCols.push(k);case "new_cell":case "modify_cell":case "move_cells":g.col=h[g.c1],g.row=n[g.r1],g.c2!=g.c1&&(g.col2=h[g.c2]),g.r2!=g.r1&&(g.row2=n[g.r2])}}for(a=0;a<e._revisions.length;a++){f=e;d=e._revisions[a];if(q=N(f,d.range))d.annoRange=q;if(f=N(f,d.oldrange))d.oldAnnoRange=f}if(a=e._page.comments())for(d=0;d<a.length;d++)g=a[d],"cell"===g.type&&g.range&&"cell"===g.range.type&&(f=g,q=e,g=g.range,q._normalCols&&q._normalRows?
(g.col=q._normalCols[g.c1],g.row=q._normalRows[g.r1],g.c2!=g.c1&&(g.col2=q._normalCols[g.c2]),g.r2!=g.r1&&(g.row2=q._normalRows[g.r2]),q=N(q,g)):q=void 0,f.annoRange=q);e.showAnnotations(x.showAnnotations);delete e._revisionMap;b&&b.call(c)});d=!0}}return d};d.revisions=function(){return this._revisions};d.rowRevisions=function(a){if(a=this._rows[a])return a.revision()};d.colRevisions=function(a){if(a=this._cols[a])return a.revision()};var C=function(a,b,c){a[b]?(Array.isArray(a[b])||(a[b]=[a[b]]),
a[b].push(c)):a[b]=c},Q=function(a,b,c){for(var d=b.r1;d<=b.r2;d++)for(var e=b.c1;e<=b.c2;e++){var f=e,g=c,h=a[d];h||(h=a[d]=[]);h[f]?(Array.isArray(h[f])||(h[f]=[h[f]]),h[f].push(g)):h[f]=g}},A=function(a,b){a&&(b||(b=[]),Array.isArray(a)?Array.prototype.push.apply(b,a):b.push(a));return b};d.getCellRevisions=function(b,d){var f;if(this._revisions){if(!this._revisionMap){for(var g=this._revisions,h={cols:[],rows:[],cells:[]},k=0;k<g.length;k++){var l=g[k],q=l.annoRange||l.range,n=l.oldAnnoRange||
l.oldrange;c[l.type]?(q&&C(h.rows,q.r1,l),n&&C(h.rows,n.r1,l)):e[l.type]?(q&&C(h.rows,q.c1,l),n&&C(h.rows,n.c1,l)):a[l.type]&&(q&&Q(h.cells,q,l),n&&Q(h.cells,n,l))}this._revisionMap=h}f=A(this._revisionMap.cols[b],f);f=A(this._revisionMap.rows[d],f);(g=this._revisionMap.cells[d])&&(f=A(g[b],f))}return f};return b}(),ud=function(){var c={f:"_font",s:"_fontSize",fs:"_fontStyle",fw:"_fontWeight",d:"_textdec",ba:"_baseline",ta:"_angle",c:"_color",w:"_wrap",a:"_align",i:"_indent",v:"_valign",bdr:"_bdr",
b:"_fill",bb:"_fillBg",bh:"_fillHatch"},e=function(a,b,d,e){this._data=a;this._model=b;this._style=a.s?b.cellStyle(a.s):{};a.t?this._text=a.t:a.v&&(this._text=a.v);var g=this._style,k=a.c?b.colStyle(d):{},l=b.sheetStyle();this._font="Arial";this._fontSize=10;this._align="g";this._indent=0;this._valign="b";for(var f in c)if(c.hasOwnProperty(f)){var h=g[f]||k[f]||l[f];void 0!==h&&(this[c[f]]=h)}a.c&&(this._color=a.c);if(this._angle&&"vertical"!==this._angle){for(;0>this._angle;)this._angle+=360;for(;360<=
this._angle;)this._angle-=360;0===this._angle?this._angle=null:(this._angle=(360-this._angle)*Math.PI/180,this._align="l",this._valign="b",this._indent=0)}this._bdr&&(this._topBorder=this._bdr[0],this._rightBorder=this._bdr[1],this._bottomBorder=this._bdr[2],this._leftBorder=this._bdr[3],a.bs&&(-1!=a.bs.indexOf("t")&&(this._topBorder=null),-1!=a.bs.indexOf("r")&&(this._rightBorder=null),-1!=a.bs.indexOf("b")&&(this._bottomBorder=null),-1!=a.bs.indexOf("l")&&(this._leftBorder=null)),delete this._bdr);
2>this._indent&&(this._indent=2);this._clearLeft=this._textRight=this._textLeft=0;this._clearRight=void 0;if(a=b.getCellComments(d,e,!0))this._comments=a;if(b=b.getCellRevisions(d,e))for(a=0;a<b.length;a++)if(g=b[a],g.range&&g.range.c1==d&&g.range.r1==e||g.oldrange&&g.oldrange.c1==d&&g.oldrange.r1==e){this._hasRevision=!0;break}},a=W(e);a.hasText=function(){return this._text&&0<this._text.length};a.textRight=function(){return this._textRight};a.horizontalMerge=function(){return this._data.mh||0};
a.verticalMerge=function(){return this._data.mv||0};a.horizontalAlign=function(){return this._align};a.leftBorder=function(){return this._leftBorder||null};a.topBorder=function(){return this._topBorder||null};a.rightBorder=function(){return this._rightBorder||null};a.bottomBorder=function(){return this._bottomBorder||null};a.rangeRect=function(a){var b=this._wrappedText;if("text"===a.type&&b){var c,d=a.acc-this._data.a;a=a.accend-this._data.a;0>d&&(d=0);a>this._text.length&&(a=this._text.length);
for(var e=0;e<b.length;e++)for(var g=b[e],k=g.x,f=g.y,h=g.o,l=0;l<g.spans.length;l++){var q=g.spans[l],n=h+q.t.length;if(n>d&&h<a){var h=k+q.w,u=f+g.h;c?(k<c.left&&(c.left=k),f<c.top&&(c.top=f),h>c.right&&(c.right=h),u>c.bottom&&(c.bottom=u)):c={left:k,top:f,right:h,bottom:u}}k+=q.w;h=n}return c}};a.drawTextBackground=function(a,b,c,d,e,g,k){if(0>this._textLeft||this._textRight>g)b=d+this._textLeft,d+=this._textRight,b<this._clearLeft&&(b=this._clearLeft),void 0!==this._clearRight&&d>=this._clearRight&&
(d=this._clearRight-1),a.oitrect(b+1,e+1,d-b-1,k-1,"#ffffff")};a.drawBackground=function(a,b,c,d,e,g,k){if(this._fill||this.horizontalMerge()||this.verticalMerge())if(this._fillHatch){b=new lc(8,8);c=b.getContext("2d");this._fillBg&&c.oitrect(0,0,8,8,this._fillBg);c.strokeStyle=this._fill||"#ffffff";c.lineCap="square";"d"==this._fillHatch.charAt(0)?c.lineWidth=2:c.lineWidth=1;switch(this._fillHatch){case "lv":case "dv":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);break;case "lh":case "dh":c.oitline(0,
1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "ldd":case "ddd":c.oitline(-.5,-.5,8.5,8.5);break;case "lud":case "dud":c.oitline(8.5,-.5,-.5,8.5);break;case "lg":case "dg":c.oitline(1.5,0,1.5,8);c.oitline(5.5,0,5.5,8);c.oitline(0,1.5,8,1.5);c.oitline(0,5.5,8,5.5);break;case "lt":case "dt":c.oitline(0,0,8,8),c.oitline(8,0,0,8)}b=a.createPattern(y.unwrap(b),"repeat");a.fillStyle=b;a.globalAlpha=1;a.fillRect(d+.5,e+.5,g+.5,k+.5)}else a.oitrect(d+.5,e+.5,g+.5,k+.5,this._fill||"#ffffff")};var b=function(a,
b,c,d,e){c||(c=1);var g=2*c;switch(b){case "dotted":b=[g,g];break;case "dashed":b=[2*g,g];break;case "dashdot":b=[2*g,g,g,g];break;case "dashdotdot":b=[2*g,g,g,g,g,g];break;case "double":b=[];c=Math.floor(c/3);1>c&&(c=1);break;default:b=[]}for(var k=g=0;k<b.length;k++)g+=b[k];e%=g;a.strokeStyle=d||"black";a.fillStyle=d||"black";a.lineWidth=c;a.setLineDash?(a.setLineDash(b),a.lineDashOffset=e):(a.mozDash=b,a.mozDashOffset=e)},d=function(a){var b=Math.floor(a.w/3);1>b&&(b=1);a=a.w-(b+b);1>a&&(a=1);
b=(b+a)/2;return[-b,b]},g=function(a,b){var c=0,e=0,g;a&&"double"===a.s&&(g=d(a),c=-g[0]);b&&"double"===b.s&&(g=d(b),e=g[1]);return c&&e?c>e?-c:-e:c?c:e},k=function(a,b){var c=0,e=0,g;a&&"double"===a.s&&(g=d(a),c=-g[0]);b&&"double"===b.s&&(g=d(b),e=g[1]);return c&&e?[-c,-e]:c?[-c,c]:[e,-e]},m=function(a,c,e,l,q,n,u,f,h){b(a,q.s,q.w,q.c,c);"double"===q.s?(q=d(q),n=k(n,u),f=k(f,h),n[0]||(n[0]=-.5),n[1]||(n[1]=-.5),f[0]||(f[0]=.5),f[1]||(f[1]=.5),a.beginPath(),a.moveTo(c-n[0],e+q[0]),a.lineTo(l+f[0],
e+q[0]),a.moveTo(c-n[1],e+q[1]),a.lineTo(l+f[1],e+q[1])):(q=g(n,u),f=g(f,h),q||(q=-.5),f||(f=.5),a.beginPath(),a.moveTo(c-q,e+.5),a.lineTo(l+f,e+.5));a.stroke()},r=function(a,c,e,l,q,n,u,f,h){b(a,q.s,q.w,q.c,e);"double"===q.s?(q=d(q),n=k(n,u),f=k(f,h),n[0]||(n[0]=-.5),n[1]||(n[1]=-.5),f[0]||(f[0]=.5),f[1]||(f[1]=.5),a.beginPath(),a.moveTo(c+q[0],e-n[0]),a.lineTo(c+q[0],l+f[0]),a.moveTo(c+q[1],e-n[1]),a.lineTo(c+q[1],l+f[1])):(q=g(n,u),f=g(f,h),q||(q=-.5),f||(f=.5),a.beginPath(),a.moveTo(c+.5,e-q),
a.lineTo(c+.5,l+f));a.stroke()},t=function(a,b){var c=null;a&&(c=a.bottomBorder());if(b){var d=b.topBorder();d&&(!c||d.w>c.w)&&(c=d)}return c},u=function(a,b){var c=null;a&&(c=a.rightBorder());if(b){var d=b.leftBorder();d&&(!c||d.w>c.w)&&(c=d)}return c};a.drawBorder=function(a,c,d,e,g,k,l,f){if(this._topBorder||this._rightBorder||this._bottomBorder||this._leftBorder){var h=e+k;l=g+l;a.lineCap="square";a.lineJoin="miter";a.globalAlpha=1;var q;this._leftBorder&&0<=this._textLeft&&0<c&&(c=t(f[0][0],
f[1][0]),q=t(f[1][0],f[2][0]),r(a,e,g,l,this._leftBorder,c,this._topBorder,q,this._bottomBorder));this._topBorder&&0<d&&(c=u(f[0][0],f[0][1]),d=u(f[0][1],f[0][2]),m(a,e,g,h,this._topBorder,c,this._leftBorder,d,this._rightBorder));this._rightBorder&&this._textRight<=k&&(d=t(f[0][2],f[1][2]),k=t(f[1][2],f[2][2]),r(a,h,g,l,this._rightBorder,this._topBorder,d,this._bottomBorder,k));this._bottomBorder&&(q=u(f[2][0],f[2][1]),k=u(f[2][1],f[2][2]),m(a,e,l,h,this._bottomBorder,this._leftBorder,q,this._rightBorder,
k));b(a,null)}};var n=function(a,b,c,d){if(c||d){var e={s:{},o:-1,oend:-1};"text"===b.type?(e.o=b.acc-a._data.a,0>e.o&&(e.o=0),e.oend=b.accend-a._data.a):(e.o=0,e.oend=a._text.length);c&&(e.s.c=c);d&&(e.s.bg=Ja(d));return e}};a.layoutText=function(a,b,c,d,e,g,k){if(this.hasText()){var f,h,u;c=!1;var m=null;f=this._data.selection;var r=this._data.highlights;if(f||r&&0<r.length){m=[];f&&(u=S.style()||"background-color:#3399FF;",h=db(u,"color"),u=db(u,"background-color"),(h=n(this,f,h,u))&&m.push(h));
if(r)for(f=0;f<r.length;f++){var w=r[f];if(u=w.highlightStyleProps())h=u.color,u=u["background-color"],(h=n(this,w.range,h,u))&&m.push(h)}delete this._data.highlightsChanged}this._wrappedText&&uc(m,this._highlightSpecs,!0)||(this._highlightSpecs&&!m?delete this._highlightSpecs:this._highlightSpecs=m,this._wrappedText=null);this.horizontalMerge()||this.verticalMerge()?(this._clearLeft=b,this._clearRight=b+d):(this._clearLeft=g,this._clearRight=k);d!=this._layoutWidth&&(this._wrappedText=null);e!=this._layoutHeight&&
(this._wrappedText=null,c=!0);if(!this._wrappedText&&(this._textLeft=0,this._layoutWidth=this._textRight=d,"l"==this._align?this._textLeft=this._indent:"r"==this._align&&(this._textRight=d-this._indent),f=this._textRight-this._textLeft,c=!0,this._wrap||this._angle?this._wrappedText=this.wrapText(a,f,e):this._data.cs||-1!=this._text.indexOf("\n")?this._wrappedText=this.wrapText(a,void 0,e):(b=this.createLine(0,this._text.length,null),q(a,b,this),l(a,b,this),this._wrappedText=[b]),a=this._wrappedText))if(f=
void 0!==this._data.v,f="r"==this._align||"rs"==this._align||f&&"g"==this._align,"c"==this._align||"cs"==this._align)for(f=0;f<a.length;f++)b=a[f],b.x=(d-b.w)/2,g=b.x+b.w,b.x<this._textLeft&&(this._textLeft=b.x),g>this._textRight&&(this._textRight=g);else if(f)for(f=0;f<a.length;f++)b=a[f],b.x=d-2-b.w-this._indent,b.x<this._textLeft&&(this._textLeft=b.x);else for(f=0;f<a.length;f++)b=a[f],b.x=this._indent,g=b.x+b.w,g>this._textRight&&(this._textRight=g);this._layoutHeight=e;if(c)for(a=this._wrappedText,
d=a[a.length-1],d=d.y+d.h-a[0].y,c=0,"c"==this._valign?c=(e-d)/2:"b"==this._valign&&(c=e-d-2),f=0;f<a.length;f++)b=a[f],b.y=c,c+=b.h}};a.drawText=function(a,b,c,d,e,g,k){if(b=this._wrappedText){c=!1;var f=b[b.length-1],f=f.y+f.h-b[0].y;this._data.clipped=!1;if(0>this._textLeft||this._textRight>g||f>k){g=d+this._textLeft;var h=d+this._textRight;if(g<this._clearLeft||void 0!==this._clearRight&&h>this._clearRight||f>k)g<this._clearLeft&&(g=this._clearLeft),void 0!==this._clearRight&&h>this._clearRight&&
(h=this._clearRight),a.save(),c=!0,a.beginPath(),a.fillStyle="black",a.rect(g,e,h-g,k),a.clip(),this._data.clipped=!0}a.globalAlpha=1;a.textAlign="left";a.textBaseline="alphabetic";this._angle&&"vertical"!==this._angle&&0<b.length&&(c||(a.save(),c=!0),a.translate(d+b[0].x,e+b[0].y),d=-b[0].x,e=-b[0].y,a.rotate(this._angle));for(g=0;g<b.length;g++){f=b[g];if(f.y>k)break;for(var h=d+f.x,l=e+f.y,q=0;q<f.spans.length;q++){var n=f.spans[q],u=this._font,m=this._fontSize,r=this._fontStyle,O=this._fontWeight,
w=this._color,p=this._textdec,D=this._baseline,t=null;n.s&&(n.s.f&&(u=n.s.f),n.s.s&&(m=n.s.s),n.s.fs&&(r=n.s.fs),n.s.fw&&(O=n.s.fw),n.s.c&&(w=n.s.c),n.s.d&&(p=n.s.d),n.s.ba&&(D=n.s.ba),n.s.bg&&(t=n.s.bg));n.hs&&(n.hs.c&&(w=n.hs.c),n.hs.bg&&(t=n.hs.bg));var C=M(l+f.a);D&&("sup"===D?(C+=-.35*f.a,m*=.65):"sub"===D&&(C+=.141*f.a,m*=.65));if(t){D=t;t=1;if(0===D.indexOf("rgba(")||0===D.indexOf("rgb(")){var A=Ga(D);A&&(D=Ja(A.r,A.g,A.b),t=A.a)}a.fillStyle=D;a.globalAlpha=t;a.fillRect(h-1,C-f.a,n.w+2,f.h+
2)}a.font=x(u,m,r,O);a.fillStyle=w||"black";a.globalAlpha=1;a.fillText(n.t,h,C);if(p){var y,H,z;switch(p){case "u":z=1;y=C+z;break;case "d":z=1;y=C+z;H=y+z+z;break;case "l":z=1,y=C-.25*n.a}void 0!==y&&(y=M(y)+.5,a.strokeStyle=w,a.lineWidth=z,a.beginPath(),a.moveTo(h,y),a.lineTo(h+n.w,y),void 0!==H&&(H=M(H)+.5,a.moveTo(h,H),a.lineTo(h+n.w,H)),a.stroke(),a.closePath())}h+=n.w}}c&&a.restore()}};a.drawFlags=function(a,c,d,e,g,k,l){void 0!==this._data.fm&&(c=g+l,a.lineCap="square",a.lineJoin="miter",a.globalAlpha=
1,a.strokeStyle="rgba(52,113,183,0.5)",a.fillStyle="rgba(52,113,183,0.5)",a.lineWidth=1,a.beginPath(),a.moveTo(e,c),a.lineTo(e,c-6),a.lineTo(e+6,c),a.lineTo(e,c),a.fill(),b(a,null));this._comments&&(e+=k,a.lineCap="square",a.lineJoin="miter",a.globalAlpha=1,a.strokeStyle="rgb(255,0,0)",a.fillStyle="rgb(255,0,0)",a.lineWidth=1,a.beginPath(),a.moveTo(e,g),a.lineTo(e,g+6),a.lineTo(e-6,g),a.lineTo(e,g),a.fill(),b(a,null))};a.createLine=function(a,b,c){var d={x:0,y:0,w:0,h:0,spans:[],o:a},e,g,k,f;if(c){f=
a;for(var h,l=0;l<c.length;l++){e=c[l];if(e.o>f&&(g=e.o,g>b&&(g=b),f=this._text.substring(f,g),d.spans.push({t:f,w:0,s:h}),f=g,f>=b))break;h=this._model.cellStyle(e.s)}f<b&&(f=this._text.substring(f,b),d.spans.push({t:f,w:0,s:h}))}else f=this._text.substring(a,b),d.spans.push({t:f,w:0});if(this._highlightSpecs)for(b=0;b<this._highlightSpecs.length;b++)for(c=this._highlightSpecs[b],f=a,h=0;h<d.spans.length;h++)l=d.spans[h],g=f+l.t.length,c.o<g&&c.oend>f&&(e=c.o-f,0<e&&(g=l.t.substring(0,e),k=l.t.substring(e),
e={t:g,w:0},l.s&&(e.s=l.s),l.hs&&(e.hs={},l.hs.c&&(e.hs.c=l.hs.c),l.hs.bg&&(e.hs.bg=l.hs.bg)),d.spans.splice(h,0,e),h++,l.t=k,f+=g.length,g=f+l.t.length),e=c.oend-f,e<l.t.length&&(g=l.t.substring(0,e),k=l.t.substring(e),e={t:k,w:0},l.s&&(e.s=l.s),l.hs&&(e.hs={},l.hs.c&&(e.hs.c=l.hs.c),l.hs.bg&&(e.hs.bg=l.hs.bg)),d.spans.splice(h+1,0,e),l.t=g,g=f+l.t.length),l.hs||(l.hs={}),c.s.c&&(l.hs.c=c.s.c),c.s.bg&&(l.hs.bg=c.s.bg)),f=g;return d};var q=function(a,b,c){for(var d=b.w=0;d<b.spans.length;d++){var e=
b.spans[d],g=c._font,k=c._fontSize,f=c._fontStyle,h=c._fontWeight,l=c._baseline;e.s&&(e.s.f&&(g=e.s.f),e.s.s&&(k=e.s.s),e.s.fs&&(f=e.s.fs),e.s.fw&&(h=e.s.fw),e.s.baseline&&(l=e.s.baseline));l&&("sup"===l?k*=.65:"sub"===l&&(k*=.65));a.font=x(g,k,f,h);e.w=a.measureText(e.t).width;b.w+=e.w}return b.w},l=function(a,b,c){Oa||(Oa=y.create("div","oit-textmeasure"),w.rootNode.append(Oa));b.h=0;b.a=0;Oa.css("display","inline");for(a=0;a<b.spans.length;a++){var d=b.spans[a],e=c._font,g=c._fontSize,k=c._fontStyle,
f=c._fontWeight;d.s&&(d.s.f&&(e=d.s.f),d.s.s&&(g=d.s.s),d.s.fs&&(k=d.s.fs),d.s.fw&&(f=d.s.fw));Oa.text(d.t);var h=y.create("span");Oa.append(h);Oa.css("font",x(e,g,k,f));Oa.offsetHeight>b.h&&(b.h=Oa.offsetHeight);d.a=h.offsetTop+1;d.a>b.h&&(d.a=b.h);d.a>b.a&&(b.a=d.a)}Oa.html("");Oa.attr("style","");Oa.css("display",null)};a.wrapText=function(a,b,c){var d=[];void 0!==b&&(b-=4);var e=0,g=0,k=0;if("vertical"===this._angle)b=0;else if(this._angle)if(this._angle===Math.PI/2||this._angle===3*Math.PI/2)b=
this._layoutHeight;else{var f=Math.tan(this._angle),h=-this._layoutHeight-f,n=2*this._layoutHeight+f,f=Math.min(Math.min(Math.sqrt(h*h),Math.sqrt(f*f+this._layoutHeight*this._layoutHeight)),Math.sqrt(this._layoutHeight*this._layoutHeight+n*n));f<b&&(b=f)}f=this._text;f=this._data.cs||void 0!==b?f.replace(/\s/g,"\ufffd"):f.replace(/\n/g,"\ufffd");for(h=0;e<this._text.length;){k=f.indexOf("\ufffd",k);-1==k&&(k=f.length);n=this.createLine(e,k,this._data.cs);q(a,n,this);var u=void 0!==b&&n.w>b;if(u||
"\n"==this._text[k]||k>=this._text.length){if(u)if(g>e)k=g,n=this.createLine(e,k,this._data.cs),q(a,n,this);else for(u=e+1;k>u&&!(k--,n=this.createLine(e,k,this._data.cs),q(a,n,this),n.w<=b););l(a,n,this);n.y=h;h+=n.h;d.push(n);if(void 0!==c&&h>=c)break;k<this._text.length&&(e=this._text[k]," "!=e&&"\t"!=e&&"\n"!=e||k++);e=k}else g=k++}if(0!==d.length)return d};var x=function(a,b,c,d){0>=b&&(b=10);var e="";c&&"normal"!==c&&(e+=c+" ");d&&"normal"!=d&&(e+=d+" ");return e+(b+"px "+a)};return e}(),Oa=
null,fd=function(){return function(c,e){var a=this,b=c,d=e,g,k,m,r,t,u,n,q,l,I,L,K,H,N,C,Q=[],A,f,h,B,v=0,J=0,F=40,X=22,R,O,ba,p,D=x.zoom,ja="database"!==e.type,Y,oa=-1,T=-1,ea=-1,la=-1,wa=!1,ra,qa,Fa;this.unload=function(){Fa&&(E.resumeIdleTimer("update"),ta(Fa),Fa=null);a.hidePopup(!0);ra&&(ra.destroy(),ra=null);E.offscroll(U);S.offselectionchanged(V);z.offpageload(G);ka.offresize(W);N&&N.destroy();for(var c=b.embeddingCount(),e=0;e<c;e++)b.embed(e).node=void 0;I&&(d.append(I),I=void 0);t&&t.destroy();
n&&n.destroy();l&&l.destroy();g&&g.destroy();Oa&&(Oa.destroy(),Oa=null);A=Q=C=N=L=I=l=q=n=u=t=r=g=d=b=a=null};this.layoutChanged=function(b){x.zoom!=D&&(a.hidePopup(),W())};var G=function(a){I&&(d.append(I),L=I=void 0);W()};this.maxPageWidth=function(){var a=b.sheetRight();void 0!==Y&&Y>a&&(a=Y);return a};this.maxPageHeight=function(){return b.sheetBottom()};this.padding=function(){return{left:F,top:X,right:0,bottom:0}};this.visibleRange=function(){return sa(J,v,p,ba)};this.visibleHeight=function(){return Ia(ba)-
Xa(v)};this.scrollOffset=function(a,c){void 0===a&&(a=J);void 0===c&&(c=v);var d=M(b.colLeft(a)*D)+1,e=M(b.rowTop(c)*D)+1;return{left:d,top:e}};var U=function(c,d,e,f,g){var h=v;f/=D;if(0<e)for(;!(b.rowBottom(h)>=f);)h++;else if(0>e)for(e=v;0<=e;e--)if(b.rowTop(e)<=f){h=e;break}e=J;f=d/D;if(0<c)for(;!(b.colRight(e)>=f);)e++;else if(0>c)for(c=J;0<=c;c--)if(b.colLeft(c)<=f){e=c;break}if(e!=J||h!=v)J=e,v=h,!1!==g&&(a.update(),a.hidePopup())},V=function(a,c){if(c){if(C){var e=b.getSelectedText();C.html(e);
C.select()}if(b.isRangeSelected())ra.disable(),ra.setText(void 0);else if(e=E.cellSelection()){var f=b.getFormulaText(e.c1,e.r1);f||(f=b.getCellText(e.c1,e.r1))&&"="==f[0]&&(f="'"+f);ra.enable();ra.setText(f)}else ra.setText(void 0);if(x.showAnnotations){var g,e=E.cellSelection(),f=d.annotationPane();if(e&&f){g=!b.isRangeSelected();!qa||qa.c==e.c1&&qa.r==e.r1||(qa=null);var h=qa?qa.anno:null,k=null,l=b.getCellComments(e.c1,e.r1),p=b.getCellRevisions(e.c1,e.r1);h&&g&&(l&&(g=l.indexOf(h),-1!=g&&((k=
l[g+1])||(k=p?p[0]:l[0]))),!k&&p&&(g=p.indexOf(h),-1!=g&&((k=p[g+1])||(k=l?l[0]:p[0]))));k||((k=Ha(l,e))||(k=Ha(p,e)),k||(l?k=l[0]:p&&(k=p[0])));k&&(qa={anno:k,c:e.c1,r:e.r1},f.activate(k))}}}fa();ha()};this.showHidden=function(c,e){if(b){var f=!1;!0===c?b.eachCol(function(a){b.showCol(a)&&(f=!0)}):!1===c&&b.eachCol(function(a){b.resetCol(a)&&(f=!0)});!0===e?b.eachRow(function(a){b.showRow(a)&&(f=!0)}):!1===e&&b.eachRow(function(a){b.resetRow(a)&&(f=!0)});f&&(Y=void 0,P.deactivate(),S.update(),a.update(),
P.positionAll(d),E.dispatchPageEvents())}};var W=function(c){var d=w.viewNode;r&&k==d.clientWidth&&m==d.clientHeight&&D==x.zoom||(k=d.clientWidth,m=d.clientHeight,D=x.zoom,M(k/D),M(m/D),(d=gb())&&(1==D?d.css("transform",null):d.css("transform","scale("+D+","+D+")")),r&&(r.destroy(),u.destroy(),q.destroy()),t||(t=y.create("div","oit-ssgrid"),n=y.create("div","oit-sscolheader"),n.onmousemove(Ea),n.ondragstart(Pa),n.ondragmove(Ra),n.ondragend(Ja),n.ondragcancel(Ja),n.onpress(Ka),n.onpressup(Qa),l=y.create("div",
"oit-ssrowheader"),l.onmousemove(Sa),l.ondragstart(Wa),l.ondragmove(Ba),l.ondragend(La),l.ondragcancel(La),l.onpress(Ta),l.onpressup(Va),g.append(t,n,l)),g.css({width:k+"px",height:m+"px"}),F=l.offsetWidth,X=n.offsetHeight,r=t.createCanvas(),u=n.createCanvas(),q=l.createCanvas(),b.updateDimensions(),!1!==c&&a.update())};this.pageRect=function(a,c){if("view"===c||"overlay"===c||c===d){var e=0,f=0,g=b.sheetRight(),h=b.sheetBottom();if("view"===c||"overlay"===c){var k=x.zoom;1!=k&&(e*=k,f*=k,g*=k,h*=
k);"view"===c&&(k=this.scrollOffset(),e+=F-k.left,f+=X-k.top,g+=F-k.left,h+=X-k.top)}return new aa(e,f,g,h,c)}};this.rangeRect=function(a,c,e){var g;if("cell"===a.type){g=a.r1;var k=a.r2,l=a.c1,p=a.c2,q=a.offsets;a.offsets?g=new aa(b.colLeft(l)+q.left,b.rowTop(g)+q.top,b.colLeft(p)+q.right,b.rowTop(k)+q.bottom,d):(a.selectingRows&&(l=0,p=b.colCount()-1),a.selectingCols&&(g=0,k=b.rowCount()-1),g=new aa(b.colLeft(l)+1,b.rowTop(g)+1,b.colRight(p),b.rowBottom(k),d))}else if("rect"===a.type)"px"!==a.units&&
(a=ga(a),va(a,"px")),g=new aa(a),void 0!==a.embedId&&(k=b.embedByUID(a.embedId),a=d.embeddingRect(a.embedId),k&&a&&g.offset(a.left,a.top));else if("text"==a.type&&(k=b.mapToCells(a)))for(l=0;l<k.length;l++){var n=k[l],p=b.colLeft(n.c1),q=b.rowTop(n.r1),u;a:{u=n.c1;var m=n.r1;if(u>=A.c1&&u<=A.c2&&m>=A.r1&&m<=A.r2){var v=Q[m-A.r1];if(v){u=v[u-A.c1];break a}}u=f&&u==h&&m==B?f:void 0}m=!1;u||(u=Aa(n.c1,n.r1),m=!0);m&&(m=r.getContext("2d"),m.save(),m.font="12px Arial,Helvetica,sans-serif",ya(m,n.c1,n.r1,
u),m.restore());if(n=u.rangeRect(a))n.left+=p,n.right+=p,n.top+=q,n.bottom+=q,g?g.union(n):g=new aa(n,d)}if(g)return!0===e&&(e=w.viewNode,e=new aa(0,0,e.clientWidth,e.clientHeight,"view"),e.origin=g.origin,g.intersect(e.left-100,e.top-100,e.right+100,e.bottom+100),0===g.width||0===g.height)&&(g=void 0),g&&c&&(g.origin=c),g};this.rangeFromRect=function(c,f,g,h,k,l,p,n,q,u){c=new aa(f,g,h,k,l);c.origin=d;if(void 0!==n)return q=e.embeddingRect(n),"move"===p?c.constrain(q):c.intersect(q),c.offset(-q.left,
-q.left),f=c.toRange(),f.embedId=n,va(f,"pct"),f;"move"!==p&&"resize"!==p&&"extend"!==p&&("view"===l&&(f-=F,g-=X),u|=f<b.colLeft(J),q|=g<b.rowTop(v));n=new aa(0,0,b.sheetRight(),b.sheetBottom(),d);"move"===p?c.constrain(n):c.intersect(n);n=!u&&!q;f=b.cellFromPos(c.left,c.top,n);n=b.cellFromPos(c.right,c.bottom,n);u?(f.c1=0,f.c2=b.colCount()-1,f.selectingRows=!0):f.c2=n.c1;q?(f.r1=0,f.r2=b.rowCount()-1,f.selectingCols=!0):f.r2=n.r1;if("move"===p||"resize"===p)p=a.rangeRect(f,d,!1),c.left-1>p.left&&
f.c1<f.c2&&(f.c1+=1),c.top-1>p.top&&f.r1<f.r2&&(f.r1+=1),c.right<p.right&&f.c1<f.c2&&--f.c2,c.bottom<p.bottom&&f.r1<f.r2&&--f.r2;u||q?(u&&(f.selectingRows=!0),q&&(f.selectingCols=!0)):(f.offsets={left:c.left-b.colLeft(f.c1),top:c.top-b.rowTop(f.r1),right:c.right-b.colLeft(f.c2),bottom:c.bottom-b.rowTop(f.r2)},f=b.expandRange(f));return f};this.extendRange=function(b,c,d,e){var f=a.rangeRect(b,e,!1),g=f.left,f=f.top,g=b.selectingRows?g-F:g+1,f=b.selectingCols?f-X:f+1;c=a.rangeFromRect(b.page,g,f,c,
d,e,"extend",void 0,b.selectingCols,b.selectingRows);c.offsets&&!b.offsets&&delete c.offsets;return c};this.update=function(a){Fa||(E.pauseIdleTimer("update"),Fa=da(this.doUpdate,0,this,a))};this.doUpdate=function(a){Fa&&(E.resumeIdleTimer("update"),ta(Fa),Fa=null);var c=w.viewNode;if(!wa){wa=!0;var e=b.webFonts();if(e&&0<e.length)for(var f=e.length-1;0<=f;f--)Dc.loadWebFont(e[f])}var g=M(-b.colLeft(J)*D),h=M(-b.rowTop(v)*D);w.drawing.setOrigin(g+F,h+X);O=J;p=void 0;for(var l=F;O<b.colCount();){if(!b.colHidden(O)&&
(l+=M(b.colWidth(O)*D),l>=c.clientWidth)){l==c.clientWidth?p=O:(p=O-1,p<J&&(p=J));break}O++}void 0===p&&(p=O);R=v;ba=void 0;for(var n=X;R<b.rowCount();){if(!b.rowHidden(R)&&(n+=M(b.rowHeight(R)*D),n>=c.clientHeight)){n==c.clientHeight?ba=R:(ba=R-1,ba<v&&(ba=v));break}R++}void 0===ba&&(ba=R);b.loadDataForCells(J,v,O,R,!0);var q=fb();if(q){var u=w.viewNode,m=u.pos(u.parent());q.css({left:m.left+F+"px",top:m.top+X+"px",width:u.clientWidth-F+"px",height:u.clientHeight-X+"px"});gb().css({left:g+"px",top:h+
"px"});for(var t=b.embeddingCount(),y=0;y<t;y++){var C=b.embed(y);if(C&&C.node&&C.position)if(void 0===C.c2)C.node.css({left:C.position.left-C.adjustX+"px",top:C.position.top-C.adjustY+"px"});else if(C.position.left===C.position.right||C.position.top===C.position.bottom)C.node.css("display","none");else{var B=(C.position.right-C.position.left)/C.w,z=(C.position.bottom-C.position.top)/C.h,Oc,I;if(1!=B||1!=z)Oc="scale("+B+","+z+")",I="left top";C.node.css({display:null,left:C.position.left-C.adjustX*
B+"px",top:C.position.top-C.adjustY*z+"px",transform:Oc,"transform-origin":I})}}}var N=r.getContext("2d");N.clearRect(0,0,r.width,r.height);N.save();var G,L=A,ea,la;b.cellGridChanged()?(Q=L=A=null,b.cellGridChanged(!1)):!0===a&&(A=null);var ra=J;if(0<J)for(ea=v;ea<=R;ea++)if(!b.rowHidden(ea)&&(G=b.getCell(J,ea),!G||!G.t&&!G.v)){var oa=b.prevTextCell(J,ea);void 0!==oa&&oa<ra&&(ra=oa)}if(A&&(A.c1!=ra||A.c2!=O||A.r1!=v||A.r2!=R)){if(ra>A.c2||O<A.c1||v>A.r2||R<A.r1)Q=L=null;A=null}if(!A){A=sa(ra,v,O,
R);var qa=Q;Q=[];for(ea=A.r1;ea<=A.r2;ea++)b.rowHidden(ea)||(Q[ea-A.r1]=[]);var P=null,T=null;for(ea=A.r1;ea<=A.r2;ea++)if(!b.rowHidden(ea))for(la=A.c1;la<=A.c2;la++){G=b.getCell(la,ea);var U=b.colStyle(la),ca=b.getCellComments(la,ea),Da=b.getCellRevisions(la,ea),V=ca||Da||G!==P||null!==U?null:T;if(G&&!V){if(L){var ma=ea-L.r1;if(0<=ma&&ma<qa.length&&qa[ma]){var aa=la-L.c1;0<=aa&&aa<qa[ma].length&&(V=qa[ma][aa])}}V||(V=Aa(la,ea,G))}Q[ea-A.r1][la-A.c1]=V;P=G;T=V}}N.font="12px Arial,Helvetica,sans-serif";
var Ca=M((b.colRight(b.colCount()-1)-b.colLeft(J))*D),da=M((b.rowBottom(b.rowCount()-1)-b.rowTop(v))*D),Z=w.viewNode,ga=Z.clientWidth,kb=Z.clientHeight;ja||(ga>Ca&&(ga=Ca),kb>da&&(kb=da));N.oitrect(0,0,ga,kb,"#ffffff");N.fillStyle=ja?"#f3f3f3":"#eaeaea";Z.clientWidth>Ca&&N.fillRect(Ca,0,Z.clientWidth-Ca,Z.clientHeight);Z.clientHeight>da&&N.fillRect(0,da,Z.clientWidth,Z.clientHeight-da);N.oitline(.5,0,.5,kb,"#d0d0d0");for(var ka=!1,na=J+1;;na++){var Xb=b.colHidden(na);if(!Xb||!ka){var ua=ab(na);if(ua>
ga)break;var xa=ua+.5;N.oitline(xa,0,xa,kb,"#e0e0e0")}ka=Xb}N.oitline(0,.5,ga,.5,"#d0d0d0");for(var ka=!1,va=v+1;;va++){var Kb=b.rowHidden(va);if(!Kb||!ka){var za=Xa(va);if(za>kb)break;var Gb=za+.5;N.oitline(0,Gb,ga,Gb,"#e0e0e0")}ka=Kb}var Ga=Y;b.colLeft(J);b.rowTop(v);for(var Ha=0,Ea=0;Ea<Q.length;Ea++){var Oa=Q[Ea],Pa=Ea+A.r1,Ja=b.rowHeight(Pa);if(0<Ja){var Ia=0;A.c1!=J&&(Ia=b.colLeft(A.c1)-b.colLeft(J));for(var Ra=Ia,Ka=0;Ka<Oa.length;Ka++){var Qa=Ka+A.c1,La=b.colWidth(Qa);if(0<La){var Ma=Oa[Ka];
if(Ma&&Ma.hasText()){ya(N,Qa,Pa,Ma,Ra,Ia,Ha,La,Ja);var Sa=b.colLeft(Qa)+Ma.textRight();if(void 0===Y||Sa>Y)Y=Sa;Ra=Ia+La}Ia+=La}}Ha+=Ja}}var Ua=c.clientWidth,Wa=c.clientHeight,Ba,Na=b.sheetRight(),Ta=b.sheetBottom();void 0!==Y&&Y>Na&&(Na=Y);d.width=Na;d.height=Ta;var Va=w.viewNode,Ya=Va.clientWidth/D,cb=Va.clientHeight/D,Za=20/D,jb=F/D,Lb=X/D,$a=Na+jb+Za;if($a>Ya){for(var bb=b.colCount()-1;b.colLeft(bb)<Na;)bb++;for(var nb=bb,hb=b.colWidth(nb),ib=nb-1;0<=ib;ib--){var pb=hb+b.colWidth(ib);if(pb>Ya)break;
hb=pb}Ba=Ya-hb;0>Ba&&(Ba=0);Ba+=Za;var qb=b.colRight(bb)+jb+Ba;qb>$a&&($a=qb)}var db=Ta+Lb+Za;if(db>cb){for(var eb=b.rowCount()-1;b.rowTop(eb)<Ta;)eb++;for(var rb=eb,Eb=b.rowHeight(rb),ob=rb-1;0<=ob;ob--){var ub=Eb+b.rowHeight(ob);if(ub>cb)break;Eb=ub}Ba=cb-Eb;0>Ba&&(Ba=0);Ba+=Za;var yb=b.rowBottom(eb)+Lb+Ba;yb>db&&(db=yb)}void 0===K&&(K=yc(d),H=zc(d));var sb=Math.ceil($a*D),wb=Math.ceil(db*D);sb>K&&(E.hiddenContent("large-sheet-unsupported"),sb=K);wb>H&&(E.hiddenContent("large-sheet-unsupported"),
wb=H);d.css({width:sb+"px",height:wb+"px"});if(Y!=Ga||Ua!=c.clientWidth||Wa!=c.clientHeight)N.restore(),k=-1,W();else{N.scale(D,D);pa(N,"drawTextBackground");pa(N,"drawBackground");pa(N,"drawBorder",!0);N.restore();N.save();var xb=b.revisions();if(xb&&x.showAnnotations){N.save();for(var Ab=0;Ab<xb.length;Ab++){var mb=xb[Ab],Jb=mb.annoRange||mb.range,Cb=mb.oldAnnoRange||mb.oldrange;switch(mb.type){case "new_cell":lb(N,Jb,null,"rgba(44,156,58,0.5)");break;case "modify_cell":lb(N,Jb,null,"rgba(148,57,174,0.5)");
break;case "clear_cell":lb(N,Jb,null,"rgba(213,61,61,0.5)");break;case "delete_row":var Db=N,tb=Jb.r1;if(tb<=R&&tb>=v){var Fb=sa(d.index,0,tb,b.colCount()-1,tb),vb=ia(Fb);Db.oitrect(vb.left,vb.top,vb.width,vb.height,"rgba(234,158,158,0.1)")}break;case "delete_col":var Hb=N,zb=Jb.c1;if(zb<=O&&zb>=J){var Ib=sa(d.index,zb,0,zb,b.rowCount()-1),Bb=ia(Ib);Hb.oitrect(Bb.left,Bb.top,Bb.width,Bb.height,"rgba(234,158,158,0.1)")}break;case "move_cells":lb(N,Cb,null,"rgba(213,61,61,0.5)"),lb(N,Jb,null,"rgba(44,156,58,0.5)")}}N.restore()}N.scale(D,
D);pa(N,"drawText");pa(N,"drawFlags");N.restore();fa();ha();S.update()}};this.hidePopup=function(a){};this.moveto=function(a,c,d){var e=!1;if(gc(a))if("text"===a.type)(a=b.mapToCells(a))&&0<a.length&&(e=this.moveto(a[0],c,d));else if("cell"===a.type){for(e=a.c1;e<=a.c2;e++)if(b.colHidden(e)){x.showHiddenColumns=!0;break}for(e=a.r1;e<=a.r2;e++)if(b.rowHidden(e)){x.showHiddenRows=!0;break}a.selectingRows||a.selectingCols||(a=b.expandRange(a));e=w.viewNode.scroll();this.scrollToRange(a.c1,a.r1,a.c2,
a.r2);a=w.viewNode.scroll();U(a.left-e.left,a.left,a.top-e.top,a.top,!0);c&&c(d);e=!0}return e};this.scrollToRange=function(a,c,d,e){var f=w.viewNode,g,h;if(a<J)g=a;else if(d>p){var k=f.clientWidth-F;for(g=d;0<=g;){k-=M(b.colWidth(g)*D);if(0===k)break;if(0>k){g++;break}if(0===g)break;g--}a<g&&(g=a)}if(c<v)h=c;else if(e>ba){a=f.clientHeight-X;for(h=e+1;0<=h;){a-=M(b.rowHeight(h)*D);if(0===a)break;if(0>a){h++;break}if(0===h)break;h--}c<h&&(h=c)}c=this.scrollOffset(g,h);var l,n;void 0!==g&&(l=c.left);
void 0!==h&&(n=c.top);f.scroll(l,n)};var fa=function(){var a=u.getContext("2d");a.save();a.oitrect(0,0,n.clientWidth,n.clientHeight,"#eaeaea");a.oitrect(0,0,F,X,"#eaeaea");a.oitrect(F-11.5,X-11.5,8,8,"#d0d0d0","#e0e0e0");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var c=12;1<=D?a.font="12px Arial,Helvetica,sans-serif":(c*=D,8>c&&(c=8),a.font=c+"px Arial,Helvetica,sans-serif");for(var c=E.cellSelection(),d=X/2,e=0,f=!1,g=J,h=J;ja||h<=b.colCount();h++){var k=0;b.colHidden(h)?e++:
(k=M(b.colWidth(h)*D),0===k?e++:e&&(e=0,f=!0));if(1>=e){var l=ab(h)+F+.5;if(l>n.clientWidth)break;f&&(l+=2,f=!1);var p=null;if(x.showAnnotations){var q=b.colRevisions(h);if(q){for(var m=!1,r=!1,v=0;v<q.length;v++)"add_col"==q[v].type?m=!0:r=!0;m&&r?p="rgba(201,156,214,0.5)":m?p="rgba(149,205,156,0.5)":r&&(p="rgba(234,158,158,0.5)")}}!p&&c&&h>=c.c1&&h<=c.c2&&(p="#d0d0d0");p&&(a.oitrect(l,0,k,X,"#FFF"),a.oitrect(l,0,k,X,p),a.fillStyle="black");a.strokeStyle=c&&h>c.c1&&h<=c.c2?"#c1c1c1":"#d0d0d0";a.oitline(l,
0,l,X,a.strokeStyle);if(!ja&&h>=b.colCount())break;0<k&&(a.save(),a.beginPath(),a.rect(l,0,k,X),a.clip(),(p=b.colTitle(h,!1))||(p=Ma(g)),a.measureText(p).width>=k?(k=l+1,a.textAlign="left"):(k=l+k/2,a.textAlign="center"),b.colOriginalHidden(h)?a.fillStyle="#b2b2b2":a.fillStyle="#000",a.fillText(p,k,d),a.restore())}b.colDeleted(h)||g++}c=.5;a.oitline(0,c,n.clientWidth,c,"#d0d0d0");c=X+.5;a.oitline(0,c,n.clientWidth,c,"#d0d0d0");a.restore()},ha=function(){var a=q.getContext("2d");a.save();a.oitrect(0,
0,l.clientWidth,l.clientHeight,"#eaeaea");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var c=12;1<=D?a.font="12px Arial,Helvetica,sans-serif":(c*=D,8>c&&(c=8),a.font=c+"px Arial,Helvetica,sans-serif");for(var c=E.cellSelection(),d=F/2,e=0,f=!1,g=v,h=v;ja||h<=b.rowCount();h++){var k=0;b.rowHidden(h)?e++:(k=M(b.rowHeight(h)*D),0===k?e++:e&&(e=0,f=!0));if(1>=e){var p=Xa(h)+.5;if(p>l.clientHeight)break;f&&(p+=2,f=!1);var n=null;if(x.showAnnotations){var u=b.rowRevisions(h);if(u){for(var m=
!1,r=!1,O=0;O<u.length;O++)"add_row"==u[O].type?m=!0:r=!0;m&&r?n="rgba(201,156,214,0.5)":m?n="rgba(149,205,156,0.5)":r&&(n="rgba(234,158,158,0.5)")}}!n&&c&&h>=c.r1&&h<=c.r2&&(n="#d0d0d0");n&&(a.oitrect(0,p,F,k,"#FFF"),a.oitrect(0,p,F,k,n),a.fillStyle="black");a.strokeStyle=c&&h>c.r1&&h<=c.r2?"#c1c1c1":"#d0d0d0";a.oitline(0,p,F,p,a.strokeStyle);if(!ja&&h>=b.rowCount())break;0<k&&(a.save(),a.beginPath(),a.rect(0,p,F,k),a.clip(),(n=b.rowTitle(h,!1))||(n=Ya(g)),k=p+k/2,b.rowOriginalHidden(h)?a.fillStyle=
"#b2b2b2":a.fillStyle="#000",a.fillText(n,d,k,F),a.restore())}b.rowDeleted(h)||g++}c=F+.5;a.oitline(c,0,c,l.clientHeight,"#d0d0d0");a.restore()},ia=function(a){var b={left:0,top:0,right:0,bottom:0};b.left=ab(a.c1);b.right=Ua(a.c2);b.top=Xa(a.r1);b.bottom=Ia(a.r2);a=w.viewNode.clientWidth;var c=w.viewNode.clientHeight;b.left=na(b.left,-100,a+100);b.right=na(b.right,-100,a+100);b.top=na(b.top,-100,c+100);b.bottom=na(b.bottom,-100,c+100);b.width=b.right-b.left;b.height=b.bottom-b.top;return b},lb=function(a,
b,c,d){b&&b.c1<=O&&b.c2>=J&&b.r1<=R&&b.r2>=v&&(b=ia(b),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,null,"#FFF",2),a.oitrect(b.left+1,b.top+1,b.width-2,b.height-2,c,d,2,[1,6]))},Z=function(a,b){return!a||0>b||b>=a.length?null:a[b]},pa=function(a,c,d){var e=0,f,g;d&&(f=[[null,null,null],[null,null,null],[null,null,null]]);for(var h,k=null,l=0<Q.length?Q[0]:null,p=0;p<Q.length;p++){h=k;var k=l,l=p+1<Q.length?Q[p+1]:null,n=p+A.r1,q=b.rowHeight(n);if(0<q){var u=0;A.c1!=J&&(u=b.colLeft(A.c1)-b.colLeft(J));
for(var m=0;m<k.length;m++){var r=m+A.c1,v=b.colWidth(r),O=k[m];if(0<v&&O){var D=O.horizontalMerge(),t=O.verticalMerge(),w=v,y=q;for(g=1;g<=D;g++)w+=b.colWidth(r+g);for(g=1;g<=t;g++)y+=b.rowHeight(n+g);!0===d&&(f[0][0]=Z(h,m-1),f[0][1]=Z(h,m),f[0][2]=Z(h,m+1),f[1][0]=Z(k,m-1),f[1][1]=O,f[1][2]=Z(k,m+1),f[2][0]=Z(l,m-1),f[2][1]=Z(l,m),f[2][2]=Z(l,m+1));O[c](a,r,n,u,e,w,y,f)}u+=v}e+=q}}},ya=function(a,c,d,e,f,g,h,k,l){var p,n;void 0===g&&(g=b.colLeft(c)-b.colLeft(J));void 0===h&&(h=b.rowTop(d)-b.rowTop(v));
void 0===k&&(k=b.colWidth(c));void 0===l&&(l=b.rowHeight(d));if(void 0===f)for(f=g,p=c-1;0<=p;p--){var q=b.getCell(p,d);if(q&&(q.t||q.v))break;f=b.colLeft(p)-b.colLeft(J)}var q=e.horizontalMerge(),u=e.verticalMerge();if((p="cs"===e.horizontalAlign())||0<q)for(n=1;(p||n<=q)&&!(p&&(p=b.getCell(c+n,d),p=!p||p.t||p.v?!1:"cs"===b.cellStyle(p.s).a,!p&&n>q));)k+=b.colWidth(c+n),n++;for(n=1;n<=u;n++)l+=b.rowHeight(d+n);q=b.colLeft(J);u=b.colRight(O)-q;n=void 0;ja||(n=b.colRight(c)-q);for(c+=1;;c++){p=b.getCell(c,
d);if(!p)break;if(p.t||p.v){n=b.colLeft(c)-q;break}p=b.colRight(c)-q;if(p>u)break;ja||(n=p)}e.layoutText(a,g,h,k,l,f,n)},Aa=function(a,c,d){d||(d=b.getCell(a,c));if(d)return f=d=new ud(d,b,a,c),h=a,B=c,d},ua=function(a){var c;if(a>=F){a-=F;for(var d=J;d<b.colCount();){var e=Ua(d),f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(c=d,a<=e))break;d++}}return c},xa=function(a){var b;if(a>=F)for(a-=F,b=J;!(a<Ua(b));b++);return b},za=function(a){var c;if(a>=X){a-=X;for(var d=v;d<b.rowCount();){var e=Ia(d),
f=e-3;if(f>a)break;var g=e+3;if(a>=f&&a<=g&&(c=d,a<=e))break;d++}}return c},Ga=function(a){var b;if(a>=X)for(a-=X,b=v;!(a<Ia(b));b++);return b},Ha=function(a,b){var c;if(a)for(var d=0;d<a.length;d++){var e=a[d];if(0===Na(e.range,b)){c=e;break}if(e.oldrange&&0===Na(e.oldrange,b)){c=e;break}}return c},Ea=function(a){-1==la&&-1==T&&(a=w.viewNode.mousePos(a),a=void 0!==ua(a.x)?"col-resize":null,u.css("cursor",a))},Pa=function(a){return-1==la&&(a=ua(a.center.x),void 0!==a)?(T=a,!1):!0},Ra=function(c){if(-1!=
la)c=xa(c.center.x),S.select(sa(d.index,la,0,c,b.rowCount()-1));else if(-1!=T){c=M((c.center.x-F)/D)+b.colLeft(J);var e=b.colLeft(T);c=c>=e?c-e:0;c!=b.colWidth(T)&&(b.setColWidth(T,c),S.update(),a.update(),P.positionAll(d))}return!1},Ja=function(a){-1!=T&&(T=-1,W(),P.positionAll(d));return!1},Ka=function(a){la=xa(a.center.x);S.select(sa(d.index,la,0,la,b.rowCount()-1))},Qa=function(a){la=-1},Sa=function(a){-1==ea&&-1==oa&&(a=w.viewNode.mousePos(a),a=void 0!==za(a.y)?"row-resize":null,q.css("cursor",
a))},Wa=function(a){return-1==ea&&(a=za(a.center.y),void 0!==a)?(oa=a,!1):!0},Ba=function(c){if(-1!=ea)c=Ga(c.center.y),S.select(sa(d.index,0,ea,b.colCount()-1,c));else if(-1!==oa){c=M((c.center.y-X)/D)+b.rowTop(v);var e=b.rowTop(oa);c=c>=e?c-e:0;c!=b.rowHeight(oa)&&(b.setRowHeight(oa,c),S.update(),a.update(),P.positionAll(d))}return!1},La=function(a){-1!==oa&&(oa=-1,W(),P.positionAll(d));return!1},Ta=function(a){ea=Ga(a.center.y);S.select(sa(d.index,0,ea,b.colCount()-1,ea))},Va=function(a){ea=-1},
Xa=function(a){return M((b.rowTop(a)-b.rowTop(v))*D)},Ia=function(a){return M((b.rowBottom(a)-b.rowTop(v))*D)},ab=function(a){return M((b.colLeft(a)-b.colLeft(J))*D)},Ua=function(a){return M((b.colRight(a)-b.colLeft(J))*D)},fb=function(){void 0===I&&(I=d.childByClass("oit-sheet-embedpane"))&&w.viewNode.parent().append(I);return I},gb=function(){if(void 0===L){var a=fb();L=a?a.childByClass("oit-sheet-embedlist"):null}return L};(function(){var a=w.viewNode;g=a.parent().childByClass("oit-ssoverlay");
g||(g=y.create("div","oit-ssoverlay"),a.parent().insert(g,a));g.html("");N=d.overlay.childByClass("oit-sel-text");N||(N=y.create("div"),d.overlay.append(N));C=y.create("pre");N.addClass("oit-sel-text");N.html("");N.append(C);ra=new sd;ra.show();E.onscroll(U);S.onselectionchanged(V);z.onpageload(G);ka.onresize(W);a=a.scroll();U(a.left,a.left,a.top,a.top,!1);W(!1);da(function(){P.eachOnPage(function(a){b.addHighlight(a);P.link(a)},d)},0)})()}}(),td=function(){function c(a,b,c){this.value=a;this.type=
b;this.subtype=c}function e(){this.items=[];this.add=function(a,b,d){d||(d="");a=new c(a,b,d);this.addRef(a);return a};this.addRef=function(a){this.items.push(a)};this.index=-1;this.reset=function(){this.index=-1};this.BOF=function(){return 0>=this.index};this.EOF=function(){return this.index>=this.items.length-1};this.moveNext=function(){if(this.EOF())return!1;this.index++;return!0};this.current=function(){return-1==this.index?null:this.items[this.index]};this.next=function(){return this.EOF()?null:
this.items[this.index+1]};this.previous=function(){return 1>this.index?null:this.items[this.index-1]}}function a(){this.items=[];this.pushToken=function(a,b,d){this.items.push(new c(a,b,d))};this.push=function(a){this.items.push(a)};this.pop=function(){var a=this.items.pop();return new c(a.value,a.type,z)};this.token=function(){return 0<this.items.length?this.items[this.items.length-1]:null};this.value=function(){return this.token()?this.token().value:""};this.type=function(){return this.token()?
this.token().type:""};this.subtype=function(){return this.token()?this.token().subtype:""}}function b(a,b,c,d){var e=!1,f=0,g=!1,h=0;a=a.replace(p,"");a=a.replace(ja,"@");a=a.replace(Y,"");var k=a.length,l=a.indexOf("!")+1,n="";0<l&&(n=a.slice(0,l-1));var q=a.slice(l,a.length),u=n.match(D);if(u&&d){var m=""+u[0],u="'";m.charCodeAt(0)==ba&&(m=m.slice(1,m.length),u="");m=m.slice(1,m.length-1);m=parseInt(m,10);0<m&&m--;if(m<d.length){d=d[m];d=d.replace(R,"\\");var m=d.lastIndexOf("\\"),r;0<=m?(r=d.slice(m+
1,d.length),d=d.slice(0,m+1)):(r=d,d="");0===d.indexOf("file:\\\\\\")&&(d=d.slice(8,d.length));n="'"+n.replace(D,d+"["+r+"]")+u;n=n.replace(oa," ")}}u=a.charCodeAt(l);l<k&&u==E&&(e=!0,l++,u=a.charCodeAt(l));for((d=l<k&&u>=F&&u<=P)||(g=e);l<k&&u>=F&&u<=P;)f=26*f+(u-F+1),l++,u=a.charCodeAt(l);16172<f&&(d=!1);l<k&&u==E&&(g=!0,l++,u=a.charCodeAt(l));for(m=l<k&&u>=M&&u<=O;l<k&&u>=M&&u<=O;)h=10*h+(u-M),l++,u=a.charCodeAt(l);e||(f+=b);g||(h+=c);0<f&&f--;""!==n&&(n+="!");return l==k&&(d||m)?n+(d?(e?"$":"")+
Ma(f):"")+(m?(g?"$":"")+h:""):n+q}function d(b){for(var c=new e,d=new a,O=0,D=function(){return b.substr(O,1)},t="",ba=!1,Y=!1,I=!1,E=!1;0<b.length;)if(" "==b.substr(0,1))b=b.substr(1);else{"="==b.substr(0,1)&&(b=b.substr(1));break}for(var K=/^[1-9]{1}(\.[0-9]+)?E{1}$/;!(O>=b.length);)if(ba)'"'==D()?'"'==b.substr(O+1,1)?(t+='"',O+=1):(ba=!1,c.add('"'+t+'"',k,H),t=""):t+=D(),O+=1;else if(Y)"'"==D()?"'"==b.substr(O+1,1)?(t+="'",O+=1):(t+=D(),Y=!1):t+=D(),O+=1;else if(I)"]"==D()&&(I=!1),t+=D(),O+=1;
else if(E)t+=D(),O+=1,-1!=",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+t+",")&&(E=!1,c.add(t,k,Q),t="");else if(-1!="+-".indexOf(D())&&1<t.length&&t.match(K))t+=D(),O+=1;else if('"'==D())0<t.length&&(c.add(t,y),t=""),ba=!0,O+=1;else if("'"==D())0<t.length?(c.add(t,y),t=""):t+=D(),Y=!0,O+=1;else if("["==D())I=!0,t+=D(),O+=1;else if("#"==D())0<t.length&&(c.add(t,y),t=""),E=!0,t+=D(),O+=1;else if("{"==D())0<t.length&&(c.add(t,y),t=""),c.add("{",m,x),d.pushToken("}",m,z),c.add("",m,
x),d.pushToken("",m,z),O+=1;else if(";"==D())0<t.length&&(c.add(t,k),t=""),c.addRef(d.pop()),c.add(";",w),c.add("",m,x),d.pushToken("",m,z),O+=1;else if("}"==D())0<t.length&&(c.add(t,k),t=""),c.addRef(d.pop()),c.addRef(d.pop()),O+=1;else if(" "==D())for(0<t.length&&(c.add(t,k),t=""),c.add("",l),O+=1;" "==D()&&!(O>=b.length);)O+=1;else-1!=",>=,<=,<>,".indexOf(","+b.substr(O,2)+",")?(0<t.length&&(c.add(t,k),t=""),c.add(b.substr(O,2),n,C),O+=2):(-1!="+-*/^&=><".indexOf(D())?(0<t.length&&(c.add(t,k),
t=""),c.add(D(),n)):-1!="%".indexOf(D())?(0<t.length&&(c.add(t,k),t=""),c.add(D(),q)):"("==D()?0<t.length?(c.add(t.replace(p,"")+"(",m,x),d.pushToken(")",m,z),t=""):(c.add("(",r,x),d.pushToken(")",r,z)):","==D()?(0<t.length&&(c.add(t,k),t=""),d.type()!=m?c.add(D(),n,v):c.add(D(),w)):")"==D()?(0<t.length&&(c.add(t,k),t=""),c.addRef(d.pop())):t+=D(),O+=1);0<t.length&&c.add(t,k);for(d=new e;c.moveNext();)t=c.current(),t.type==l?c.BOF()||c.EOF()||(c.previous().type==m&&c.previous().subtype==z||c.previous().type==
r&&c.previous().subtype==z||c.previous().type==k)&&(c.next().type==m&&c.next().subtype==x||c.next().type==r&&c.next().subtype==x||c.next().type==k)&&d.add(" ",n,B):d.addRef(t);for(;d.moveNext();)t=d.current(),t.type==n&&"-"==t.value?d.BOF()?t.type=u:d.previous().type==m&&d.previous().subtype==z||d.previous().type==r&&d.previous().subtype==z||d.previous().type==q||d.previous().type==k?t.subtype=f:t.type=u:t.type==n&&"+"==t.value?d.BOF()?t.type=g:d.previous().type==m&&d.previous().subtype==z||d.previous().type==
r&&d.previous().subtype==z||d.previous().type==q||d.previous().type==k?t.subtype=f:t.type=g:t.type==n&&0===t.subtype.length?-1!="<>=".indexOf(t.value.substr(0,1))?t.subtype=C:t.subtype="&"==t.value?h:f:t.type==k&&0===t.subtype.length?isNaN(parseFloat(t.value))?t.subtype="TRUE"==t.value||"FALSE"==t.value?C:A:t.subtype=N:t.type==m&&"@"==t.value.substr(0,1)&&(t.value=t.value.substr(1));d.reset();for(c=new e;d.moveNext();)d.current().type!=g&&c.addRef(d.current());c.reset();return c}var g="noop",k="operand",
m="function",r="subexpression",w="argument",u="operator-prefix",n="operator-infix",q="operator-postfix",l="white-space",y="unknown",x="start",z="stop",H="text",N="number",C="logical",Q="error",A="range",f="math",h="concatenate",B="intersect",v="union",E=36,F=65,P=90,M=48,O=57,ba=39,p=/\u005F[^\u002E]*\u002E/,D=/^'?\u005B[0-9]+\u005D/,ja=/\u005B\u0023This Row\u005D/,Y=/\u005B\u005D/,oa=/%20/g,R=/\u002F/g;return function(a,c,e,f){a=d(a);for(var g="",h;a.moveNext();){var k=a.current();if(k.subtype!=
v&&k.type!=w||!h||h.subtype!=A||64!=h.value.charCodeAt(h.value.length-1)){if(k.subtype==A){h=k;var l;l=k.value;var p=c,n=e,q=f,u=l.lastIndexOf(":");l=0<u?b(l.slice(0,u),p,n,q)+":"+b(l.slice(u+1),p,n,q):b(l,p,n,q);h.value=l}g+=k.value}h=k}return g}}(),pd=function(){var c={ATTACHMENTS:"ATTACHMENT",BADDRESS:"BUSINESSADDRESS",BPHONE:"BUSINESSPHONE",CALENDAREXCEPTIONS:"CALENDAR_EXCEPTION",CATEGORY:"CATEGORIES",CREATED:"CREATION_TIME",DUEDATE:"DUE_DATE",ENDDATE:"DTEND",ENDTIME:"DTEND",ENTRYTYPE:"ENTRY_TYPE",
FAX:"BUSINESSFAX",HADDRESS:"HOMEADDRESS",HPHONE:"HOMEPHONE",IM:"IMADDRESS",LAST:"FAMILY",NAME:"FULLNAME",MOBILE:"MOBILEPHONE",OPTATTEND:"OPTATTENDEE",PERCENT:"PERCENT_COMPLETE",RECURRANGE:"RECURRENCE_RANGE",RECURTYPE:"RECURRENCE_TYPE",REQATTEND:"REQATTENDEE",STARTDATE:"START_DATE",STARTTIME:"DTSTART",TOPIC:"CONVERSATION_TOPIC"},e={FI_OUTLOOK_MSG_APPT:"calendarentry",FI_OUTLOOK_MSG_CDSMAIL:"msg",FI_OUTLOOK_MSG_CONTACT:"contact",FI_OUTLOOK_MSG_DISTLIST:"contactgroup",FI_OUTLOOK_MSG_JOURNAL:"journal",
FI_OUTLOOK_MSG_MAIL:"msg",FI_OUTLOOK_MSG_NDR:"msg",FI_OUTLOOK_MSG_NOTE:"note",FI_OUTLOOK_MSG_ODSMAIL:"msg",FI_OUTLOOK_MSG_POST:"note",FI_OUTLOOK_MSG_TASK:"task",FI_OUTLOOK_OFT_APPT:"calendarentry",FI_OUTLOOK_OFT_CDSMAIL:"msg",FI_OUTLOOK_OFT_CONTACT:"contact",FI_OUTLOOK_OFT_DISTLIST:"contactgroup",FI_OUTLOOK_OFT_JOURNAL:"journal",FI_OUTLOOK_OFT_MAIL:"msg",FI_OUTLOOK_OFT_NDR:"msg",FI_OUTLOOK_OFT_NOTE:"note",FI_OUTLOOK_OFT_ODSMAIL:"msg",FI_OUTLOOK_OFT_POST:"note",FI_OUTLOOK_OFT_TASK:"task",ai:"vector",
bmp:"image",cdr:"vector",cgm:"vector",chtml:"ie",cur:"image",dcx:"image",dgn:"vector",doc:"doc",docx:"doc",drw:"vector",dwg:"vector",dxf:"vector",emf:"vector",eml:"msg",fft:"text",gdf:"vector",gem:"vector",gif:"image",hdml:"ie",hpgl:"vector",htm:"ie",html:"ie",ico:"image",ics:"calendar",img:"image",indd:"image",jpg:"image",lwp:"text",mhtml:"ie",mpg:"video",mpp:"project",msg:"msg",odg:"vector",odi:"image",odt:"text",oft:"text",pbm:"image",pcd:"image",pct:"image",pcx:"image",pdf:"pdf",pdfi:"image",
pgm:"image",pic:"vector",pif:"vector",png:"image",ppm:"image",ppt:"ppt",pptx:"ppt",ps:"vector",psd:"image",psp:"image",pst:"msg",rtf:"text",sdw:"image",svg:"vector",tga:"image",tif:"image",txt:"text",vsd:"vsd",wbmp:"image",wmf:"vector",wml:"ie",wmv:"video",wpd:"text",wpg:"image",xbm:"image",xhtml:"ie",xlc:"xls",xls:"xls",xlsb:"xls",xlsx:"xls",xml:"ie",xmp:"ie",xpm:"image",yim:"text",zip:"zip"},a=function(a){U.call(this,a);y.attach(this);this._page=z.forNode(a);if(!this._page._fields&&(a=(a=this.byClass("oit-maildata"))?
a[0]:y.byId("oit-maildata"))){var b=this.byClass("oit-emhdrlabel"),C=this.byClass("oit-emhdrvalue"),H=[];if(b&&C&&b.length==C.length)for(var A=0;A<b.length;A++){var f=b[A],h=C[A];if("oit-email_attachments"!=f.id){var B={},v;f.id&&0===f.id.indexOf("oit-email_")&&(v=f.id.substring(10).toUpperCase(),B.id=c[v]||v);if(!B.id)for(v=0;;v++){var K=f.classList.item(v);if(!K)break;if(0===K.indexOf("oit-email_")){v=K.substring(10).toUpperCase();B.id=c[v]||v;break}}B.id||(B.label=f.html());f=h.attr("data-acc");
1==h.dom.childElementCount?h=h.firstChildElem():(v=y.create("div"),v.transferFrom(h),h=v);f&&(h.attr("data-acc",f),"none"===f&&h.addClass("oit-noacc"));B.value=h.dom.outerHTML;H.push(B)}}this._page._fields=H;a.destroy()}this.html('<div class="oit-headerpadding"><table class="oit-maildata"></table><div class="oit_attachments oit-noacc" data-acc="none"></div></div><div class="oit-emextra"><div class="oit-em_allheaders"><table class="oit-emheadervalues"></table></div></div>');this._hdrtable=this.byClass("oit-maildata")[0];
a=this.parent().parent();a.hasClass("oit-emailstream")&&(b=y.create("div","oit-emailbk"),b.transferFrom(a),a.append(b),a.addClass("oit-emailfill"));b=this._page._fields;a=this.byClass("oit-em_allheaders")[0];if(x.removeExtraEmailHeaders||w.isMobile)a.destroy(),a=null;d(b);switch(this.data("subtype")){case "journal":C=x.journalHeader;break;case "contact":C=x.contactHeader;break;case "note":C=x.noteHeader;break;case "appt":C=x.appointmentHeader;break;case "task":C=x.taskHeader;break;case "post":C=x.postHeader;
break;case "dist":C=x.distroHeader;break;default:C=x.emailHeader}H=this._page._fields;if(C.subjectField)if(B=q(H,C.subjectField),A=q(H,C.dateField),!C.subjectField&&!C.dateField||B||!1===C.defaultSubject||(B=new Pc({id:"SUBJECT",value:'<div class="oit-emhdrvalue oit-textfield"><div><span></span></div></div>'})),B){if(B.addedToHeader=!0,h=this.subjectBar=y.create("div","oit-email-subjectbar"),f=B.clone(),f.addContainerClass("oit-email-subject"),f.appendAsDiv(h),f.labelElem.html(""),this.fixedSubjectField=
f,f.valueElem.text()||(f.valueElem.addClass("oit-nosubject"),f.valueElem.text(T.NO_SUBJECT)),f=this._hdrtable.parent(),f.insert(h,f.firstChildElem()),B.hide(),A&&(this.headerDateField=A,B=A.clone(),B.addContainerClass("oit-email-date"),B.appendAsDiv(h),this.fixedDateField=B,A.appendAsRow(this._hdrtable),A.hide()),!w.isMobile&&(A=h.clone(!0)))this.stickyHeader=y.create("div","oit-email-stickyheader"),this.stickyHeader.append(A),this.stickyHeader.onmouseover(this,l),this.stickyHeader.onmouseout(this,
I),this.stickyHeader.ontap(this,E),w.viewNode.parent().append(this.stickyHeader),this.stickyHeaderVisible=!1,this.stickyDateFixedField=this.stickyHeader.byClass("oit-email-date"),Array.isArray(this.stickyDateFixedField)&&(this.stickyDateFixedField=this.stickyDateFixedField[0])}else this.addClass("oit-nosubject");C.photoField&&(A=q(H,C.photoField))&&(A.addContainerClass("oit-email-photo"),A.insertAsDiv(this._hdrtable.parent(),this._hdrtable),A.labelElem.html(""));C.logoField&&(A=q(H,C.logoField))&&
(A.addContainerClass("oit-email-logo"),A.insertAsDiv(this._hdrtable.parent(),this._hdrtable),A.labelElem.html(""));if(C.headerFields)for(h=y.create("tbody"),B=0;B<C.headerFields.length;B++)if(f=C.headerFields[B],"string"==typeof f||Array.isArray(f))(v=q(H,f))&&v.appendAsRow(this._hdrtable);else if(f.fields)if(f.multi){v=[];for(A=0;A<f.fields.length;A++)n(H,f.fields[A],null,v);for(A=0;A<v.length;A++)v[A].appendAsRow(this._hdrtable)}else if(f.title){K=[];for(A=0;A<f.fields.length;A++)if(v=q(H,f.fields[A]))v.showType(!1),
K.push(v);if(0<K.length)for(h.html('<tr><td class="oit-emhdrsection" colspan="3"><span data-acc="none" class="oit-noacc">'+T["EMAIL_"+f.title]+T.LABEL_SEPARATOR+"</span></td></tr>"),this._hdrtable.append(h.firstChildElem()),A=0;A<K.length;A++)K[A].appendAsRow(this._hdrtable)}if(this.stickyHeader){this.stickyHeaderDetail=y.create("div","oit-shdetail");this.stickyHeaderDetailShown=!1;C=y.wrap(this._hdrtable.clone(!0));A=!1;h=0;for(B=C.firstChildElem();B;B=H)H=B.nextSiblingElem(),h++,A||(20<h?A=!0:B.firstChildElem().hasClass("oit-emhdrsection")&&
(A=!0)),A&&B.destroy();this.stickyHeaderDetail.append(C);this.stickyHeader.append(this.stickyHeaderDetail);this.stickyDateHeaderField=C.byClass("DATE");this.stickyDateHeaderField||(this.stickyDateHeaderField=C.byClass("RECEIVED"));Array.isArray(this.stickyDateHeaderField)&&(this.stickyDateHeaderField=this.stickyDateHeaderField[0]);this.stickyDateHeaderField&&(this.stickyDateHeaderField=this.stickyDateHeaderField.parent());u(this.stickyHeader)}g(b)&&(this._emailExpander=y.create("div","oit-showemail"),
this._emailExpander.onclick(this,t),this._emailExpander.ontap(this,t),this._hdrtable.parent().insert(this._emailExpander,this._hdrtable),x.showEmailAddresses?m.call(this):r.call(this));if(a)if(C=a.firstChildElem(),b=k(C,b))for(this.allHeaders=new vd(this,a,"oit-email_gear_icon",18,18,T.SHOWDETAILS,T.HIDEDETAILS),this.byClass("oit-headerpadding")[0].append(this.allHeaders),C=0;C<b.length;C++)b[C].tab=this.allHeaders;else a.destroy(),a=null;a||this.removeExtraEmailHeaders();if((a=this._page._attachments)&&
0<a.length){b=this.byClass("oit_attachments")[0];C=y.create("div");for(H=0;H<a.length;H++)A=a[H],A.ext||(h=A.name,B=h.lastIndexOf("."),A.ext="",-1!=B&&(A.ext=h.substring(B+1).toLowerCase())),(h=e[A.file_id]||e[A.ext])||(h="generic"),h=['<div class="oit-attached-file" data-index="',A.id,'">','<div class="oit-ficon oit-ficon-',h,'"><div></div></div>','<div class="oit-attinfo">',"<div>",A.displayName||A.name,"</div>"],A.size&&(h.push("<div>"),A.size&&h.push(xc(A.size)),h.push("</div>")),h.push("</div></div>"),
C.html(h.join("")),h=C.firstChildElem(),b.append(h),ob.on.addElement(h,A.id);C.html('<div style="clear:both;"></div>');b.append(C.firstChildElem())}this._page.pageContentChanged();this.applyShowEmailAddresses();this.onStyleChanged()},b=W(a,U);b.destroy=function(){ob.on.removeAllElements();this.stickyHeader&&this.stickyHeader.destroy();U.prototype.destroy.call(this)};b.scrollPadding=function(){if(this.stickyHeaderVisible)return{top:this.stickyHeader.offsetHeight}};var d=function(a,b){if(a)for(var c=
0;c<a.length;c++){var e=a[c];e.appendAsRow||(a[c]=new Pc(e,b));e.subfields&&d(e.subfields,a[c])}},g=function(a){var b=!1;if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d.addedToHeader&&d.hasEmailAddresses){b=!0;break}if(d.subfields&&(b=g(d.subfields)))break}return b},k=function(a,b,c){c||(c=[]);if(b){var d,e;for(d=0;d<b.length;d++)e=b[d],e.subfields||e.addedToHeader||!e.hasValue()||(e.appendToExtra(a),e.extra=!0,c.push(e));for(d=0;d<b.length;d++)if(e=b[d],e.subfields){var f=a,g=c,l=e.subfields;if(l)for(var n=
!0,q=0;q<l.length;q++){var u=l[q];if(!u.addedToHeader&&(u.hasValue()||u.subfields)){if(e&&n){var m=T["EMAIL_"+e.fieldId];if(m||e.fieldDef.label){var r,n=[];n.push('<tr><td class="oit-emhdrsection" colspan="2">');e.fieldType&&(r=e.fieldType.substring(1,e.fieldType.length-1));m?n.push('<span data-acc="none" class="oit-noacc">',m):n.push(e.fieldDef.label,'<span data-acc="none" class="oit-noacc">');r&&n.push(" (",r,")");n.push(T.LABEL_SEPARATOR,"</span></td><td></td></tr>");n=n.join("");m=y.create("tbody");
m.html(n);f.append(m.firstChildElem())}n=!1}u.appendToExtra(f);g.push(u)}u.subfields&&k(f,u.subfields,g)}}}return 0===c.length?null:c};b.applyShowEmailAddresses=function(){this._emailExpander&&(x.showEmailAddresses?m.call(this):r.call(this),this.applyViewSize(!0))};var m=function(){this._emailExpander&&(this._page.addClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.addClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-showemail").addClass("oit-hideemail"),z.each("pageLayoutChanged"))},
r=function(){this._emailExpander&&(this._page.removeClass("oit-email-addr-visible"),this.stickyHeader&&this.stickyHeader.removeClass("oit-email-addr-visible"),this._emailExpander.removeClass("oit-hideemail").addClass("oit-showemail"),z.each("pageLayoutChanged"))},t=function(){x.showEmailAddresses=!x.showEmailAddresses},u=function(a){a.attr("data-acc")&&a.attr("data-acc","none");for(a=a.firstChildElem();a;a=a.nextSiblingElem())u(a)},n=function(a,b,c,d){if(b&&a){var e,f;if(Array.isArray(b))for(e=0;e<
b.length;e++)n(a,b[e],null,d);else if(b.g)for(c=b.t?";"+b.t+";":null,e=0;e<a.length;e++)f=a[e],f.subfields&&f.fieldId==b.g&&(c?f.fieldType&&-1!=f.fieldType.indexOf(c)&&n(f.subfields,b.id,b.d,d):n(f.subfields,b.id,b.d,d));else if("string"==typeof b)for(e=0;e<a.length;e++)if(f=a[e],f.fieldId==b&&!f.addedToHeader&&(f.hasValue()||f.isCompound())){d.push(f);var g=null;if(c&&"string"==typeof c)for(var k=0;k<a.length;k++){var l=a[k];if(l.hasValue()&&!l.addedToHeader&&l.fieldId==c){g=l;break}}f.setDisplayField(g)}}},
q=function(a,b){if(a&&b){var c=[];n(a,b,null,c);if(1<=c.length)return c[0]}},l=function(){if(this.stickyHeaderDetail&&!S.isSelecting()){var a=this.stickyHeaderDetail.firstChildElem().outerHeight;this.stickyHeaderDetail.css("height",""+a+"px");this.stickyHeaderDetailShown=!0}},I=function(){this.stickyHeaderDetail&&(this.stickyHeaderDetail.css("height",null),this.stickyHeaderDetailShown=!1)},E=function(){this.stickyHeaderDetailShown?I.call(this):l.call(this)};b.applyViewSize=function(a){var b;this.stickyHeader&&
this.stickyHeader.css("width",null);this.fixedSubjectField&&(a=this.fixedSubjectField.containerWidth(),this.fixedDateField&&(this.fixedDateField.show(),a+=this.fixedDateField.containerWidth()),b=w.viewNode.clientWidth,x.nochrome||(b-=42),a>b?(this.fixedDateField&&this.fixedDateField.hide(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display","none"),this.headerDateField&&this.headerDateField.show(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display",null)):(this.fixedDateField&&
this.fixedDateField.show(),this.stickyDateFixedField&&this.stickyDateFixedField.css("display",null),this.headerDateField&&this.headerDateField.hide(),this.stickyDateHeaderField&&this.stickyDateHeaderField.css("display","none")));this.stickyHeader&&(a=this._page.parent().offsetWidth,b=w.viewNode.clientWidth,x.nochrome||(a-=2,b-=21),a>b&&(a=b),this.stickyHeader.css("width",a+"px"));if(!this._page.isHidden())P.onEmailHeaderResize(this._page.index);this._page.overlay.each("pageLayoutChanged")};b.finishAnimation=
function(){this._page&&this._page.finishAnimation()};b.showStickyHeader=function(){if(this.stickyHeader&&this.subjectBar&&(this.stickyHeaderVisible||(this.stickyHeader.addClass("oit-email-shvisible"),x.nochrome?this.stickyHeader.addClass("oit-nochrome"):this.stickyHeader.removeClass("oit-nochrome"),this.stickyHeaderVisible=!0),this.stickyHeaderVisible&&!x.nochrome)){var a=w.viewNode.scrollLeft;0===a?this.stickyHeader.css("left",null):this.stickyHeader.css("left",21-a+"px")}};b.hideStickyHeader=function(){this.stickyHeader&&
this.subjectBar&&this.stickyHeaderVisible&&(this.stickyHeader.removeClass("oit-email-shvisible"),this.stickyHeaderVisible=!1)};b.onScroll=function(){this.stickyHeader&&this.subjectBar&&(0>this.subjectBar.pos(this.stickyHeader.parent()).top?this.showStickyHeader():this.hideStickyHeader())};b.beginSelection=function(a){this._selectionPos=null;this.showEmailHeader(a)};b.getEmailFieldForRange=function(a){var b;if(a&&"text"==a.type){var c=this._page._fields,d;for(d in c){var e=c[d];if("custom"===d)for(var f=
0;f<e.length;f++){if(b=e[f].subfieldByRange(a))return b}else if(b=e.subfieldByRange(a))return b}}};b.moveto=function(a,b,c){return(a=this.showEmailHeader(a,b,c))&&a.tab?!0:!1};b.showEmailHeader=function(a,b,c){if(a&&"text"==a.type){var d=this.getEmailFieldForRange(a);if(d)if(d.field&&this.hideStickyHeader(),d.tab)c=c||{},d.tab.activate(null,!0),d.tab.scrollToRange(a),b&&b(c),this._selectionPos="tab";else{for(var e=d.addresses;!e&&d.groupField;)d=d.groupField,e=d.addresses;if(e&&!x.showEmailAddresses)for(var f=
0;f<e.length;f++){var g=e[f].address;if(g){var k=g.acc;if(k+g.text.length>=a.acc&&k<=a.accend){x.showEmailAddresses=!0;break}}}b&&b(c)}return d}};b.onStyleChanged=function(){this.applyEmailHeaderStyles()};b.applyEmailHeaderStyles=function(){try{this._headerStyle&&this.css(this._headerStyle),this.applyViewSize()}catch(H){this.logError("email header style","An error occurred setting email header style")}};var K=function(a,b){var c=!1;if(a.subfields)for(var d=a.subfields.length-1;0<=d;d--)K(a.subfields[d],
b)&&a.subfields.splice(d,1);if(!a.addedToHeader||a.extra)a.range&&b.push(a.range),c=!0;return c};b.removeExtraEmailHeaders=function(){this.allHeaders&&this.allHeaders.activate(null,!1);var a=this._page._fields;if(a){for(var b=[],c=a.length-1;0<=c;c--)K(a[c],b)&&a.splice(c,1);b.length&&(ia.replaceRawText(b),P.removeFromRange(b))}this.allHeaders&&(this.allHeaders.destroy(),delete this.allHeaders)};return a}(),vd=function(){var c=function(b,c,e,m,r,t,u){U.call(this,"div","oit-button");y.attach(this);
e&&this.addClass(e);this._header=b;this._minHeight=this._fullHeight=r;this._clientDiv=c;this._active=!1;this._utip=t;u&&(this._atip=u);t&&this.attr("title",t);if(this._clientDiv)this._clientDiv.on("scroll",null,a,this);this.on("click",this,this.activate,"toggle");this.on("tap",this,this.activate,"toggle")},e=W(c,U);e.destroy=function(){this._clientDiv&&(this._clientDiv.offscroll(a),delete this._clientDiv);this.offclick(this.activate);this.offtap(this.activate);U.prototype.destroy.call(this)};var a=
function(a,b){var c=b._clientDiv.scroll();b._scroll&&c.left==b._scroll.left&&c.top==b._scroll.top||(b._scroll=c,c=z.page(0),P.deactivate(),c.pageLayoutChanged(),P.positionAll(c))};e.isActive=function(){return this._active};e.containsRange=function(a){var b=y.wrap(a.startContainer);a=y.wrap(a.endContainer);var c=y.isDescendantOf(b,this._clientDiv);if(c||y.isDescendantOf(a,this._clientDiv))return{tab:this,rangeElem:c?b:a}};e.scrollToRange=function(b){if(this._clientDiv.childByClass("oit-emheadervalues")&&
(b=F.rangeRect(b,"view"))){var c=0,d=0,e=w.viewNode.clientWidth,r=w.viewNode.clientHeight;0>b.left?c=b.left-10:b.right>e&&(c=b.right+10-e);0>b.top?d=b.top-10:b.bottom>r&&(d=b.bottom+10-r);if(c||d)w.viewNode.dscroll(c,d),a(null,this)}};var b=function(a,b,c){(b=b.getEmailFieldForRange(a.range))&&b.tab&&(a.id==P.active()&&P.deactivate(),a.removeFromPage(c))};e.activate=function(a,c){var d=this._active;"toggle"==c?d=!d:"boolean"===typeof c&&(d=c);if(d!==this._active){var e=this._header._page;this._header.finishAnimation();
(this._active=d)||"tab"!==this._selectionPos||S.select(null);d||(P.each(b,e,this._header,e.index),w.viewNode.scroll(0,0));d?(this.addClass("oit-activetab"),this._clientDiv.parent().addClass("oit-activetab"),this._atip&&this.attr("title",this._atip)):(this.removeClass("oit-activetab"),this._clientDiv.parent().removeClass("oit-activetab"),this._utip&&this.attr("title",this._utip));this._header.applyViewSize()}};return c}(),Pc=function(){var c="TO CC BCC FROM EMAIL EMAIL2 EMAIL3 RCVD_REPRESENTING_ADDRESS RECEIVED_BY_EMAIL_ADDRESS SENDER_EMAIL_ADDRESS SENT_REPRESENTING_EMAIL_ADDRESS".split(" "),
e=["ORGANIZER","ATTENDEES"],a=function(a,b){U.call(this);this.fieldDef=a;a.id&&(this.fieldId=a.id);a.type&&(this.fieldType=";"+a.type+";");a.subfields&&(this.subfields=a.subfields);a.range&&(this.range=a.range);this.container=y.create("div");b&&(this.groupField=b,this.showGroupType=!0);this.addedToHeader=!1},b=W(a,U);b.clone=function(){return new a(this.fieldDef)};b.isCompound=function(){return this.subfields&&0<this.subfields.length&&-1!=e.indexOf(this.fieldId)};b.show=function(){this.container.css("display",
null);this.container.attr("data-acc",null)};b.hide=function(){this.container.css("display","none");this.container.attr("data-acc","none")};b.showType=function(a){this.showGroupType=!!a};b.subfieldById=function(a){var b,c;if(a)if(Array.isArray(a))for(c=0;c<a.length&&!(b=this.subfieldById(a[c]));c++);else for(c=0;c<this.subfields.length;c++){var d=this.subfields[c];if(d.fieldId==a){b=d;break}}return b};b.subfieldByRange=function(a){var b;if(this.subfields)for(var c in this.subfields){var d=this.subfields[c];
if("custom"==c)for(var e=0;e<d.length&&!(b=d[e].subfieldByRange(a));e++);else b=d.subfieldByRange(a);if(b)break}b||this.range&&Gc(this.range,a)&&(b=this);return b};b.toTagName=function(a,b){var c=g(this.container,a);if(this.labelElem){var d=g(this.labelElem,b);d.transferFrom(this.labelElem);c.append(d);this.labelElem=d}this.valueElem&&(d=g(this.valueElem,b),d.transferFrom(this.valueElem),c.append(d),this.valueElem=d);(d=this.container.parent())&&d.insert(c,this.container);this.container.destroy();
this.container=c};b.containerWidth=function(){return this.container.offsetWidth};b.addContainerClass=function(a){this.container.addClass(a)};b.prepForMainHeader=function(){this.addedToHeader||(this.addedToHeader=!0,this.parseEmailAddresses(),this.buildFieldValue())};b.appendAsRow=function(a){this.prepForMainHeader();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};b.appendAsDiv=function(a){this.prepForMainHeader();
"DIV"!==this.container.tagName&&this.toTagName("div","div");a.append(this.container)};b.insertAsDiv=function(a,b){this.prepForMainHeader();"DIV"!==this.container.tagName&&this.toTagName("div","div");a.insert(this.container,b)};b.appendToExtra=function(a){this.addedToHeader=!0;this.buildFieldValue();"TR"!==this.container.tagName&&(this.toTagName("tr","td"),this.container.append(y.create("td","oit-email-pad")));a.append(this.container)};b.parseEmailAddresses=function(){this.addresses||(this.isCompound()?
(this.addresses=[],d(this,this.addresses),0===this.addresses.length&&delete this.addresses):this.fieldDef.value&&-1!=c.indexOf(this.fieldId)&&this.parseStandardEmailAddresses())};b.parseStandardEmailAddresses=function(){if(this.range){var a=y.create("div");a.html(this.fieldDef.value);for(var b,c=a.createTreeWalker(),d=c.firstACCNode(),a=[],e;d;){d=c.currentNode;if(1===d.nodeType)(d=y.data(d,"acc"))&&(b="none"===d?void 0:Number(d));else if(3===d.nodeType&&0<d.nodeValue.length&&void 0!==b){var g=b+
d.nodeValue.length;e&&e.accend!=b&&(e=null);e?e.accend=g:(e={text:d.nodeValue,acc:b,accend:g},a.push(e));b+=d.nodeValue.length}d=c.nextACCNode()}for(c=b=0;c<a.length;c++){e=a[c];d=e.text;e=e.acc;var g=[],k=d.toUpperCase(),m=(d.match(/@/g)||[]).length,w=(k.match(/CN=/g)||[]).length,k=(k.match(/((\[([^\[\]])*\/CN([^\[\]])*\])+)/g)||[]).length,m=0===w?m+k:0===k?m+w:m+Math.min(w,k);if(0===m)d=g;else{var x=t(d,/((?:[^;"']|"[^"]*"|'[^']*')+)/g,m),w=t(d,/((?:[^;"]|"[^"]*")+)/g,m),k=t(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,
m),m=t(d,/((?:[^,"']|"[^"]*"|'[^']*')+)/g,m);if(!x||w.diff<x.diff)x=w;if(!x||k.diff<x.diff)x=k;if(!x||m.diff<x.diff)x=m;if(x){if(m=x.list)for(var z=0,w=0;w<m.length;w++){k=m[w];z=d.indexOf(k,z);if(-1==z)break;var x=e+z,z=z+k.length,A=null,f=null,h=-1,B=-1,v=k.lastIndexOf("<"),E=k.lastIndexOf(">"),F=k.lastIndexOf("["),P=k.lastIndexOf("]"),M=void 0,O=void 0;0<=v&&E>v?(M=v,O=E):0<=F&&P>F&&(M=F,O=P);void 0!==M&&O+1<k.length&&(M=void 0);void 0!==M?(A=k.substring(0,M),h=x,f=k.substring(M+1,O),B=x+M+1):
(E=k.toUpperCase(),v=E.indexOf("CN="),0<v&&"/"!==E.charAt(v-1)&&(v=-1),0<=v?(f=k,B=x,A=k.indexOf("/",v),-1==A&&(A=k.length),A=k.substring(v+3,A),h=x+v+3):-1!=k.indexOf("@")?(f=k,B=x):(A=k,h=x));A=r(A,h);f=r(f,B);A||(A=f,f=null);(A||f)&&g.push({name:A,address:f})}d=g}else d=void 0}d&&0<d.length&&(b++,this.addresses=this.addresses?this.addresses.concat(d):d)}b!=a.length&&delete this.addresses}};b.markAddedToHeader=function(a){this.addedToHeader=!0;if(a&&this.subfields)for(var b=0;b<this.subfields.length;b++)this.subfields[b].markAddedToHeader(a)};
var d=function(a,b){switch(a.fieldId){case "ORGANIZER":case "ATTENDEE":var c=a.subfieldById("DISPLAYAS"),e=a.subfieldById("EMAIL")||a.subfieldById("ORGANIZER");if(c&&c.fieldDef&&c.fieldDef.value&&c.fieldDef.range&&e&&e.fieldDef&&e.fieldDef.value&&e.fieldDef.range){var g=y.create("div");g.html(c.fieldDef.value);var k=g.text();g.html(e.fieldDef.value);g=g.text();k=r(k,c.fieldDef.range.acc);g=r(g,e.fieldDef.range.acc);k&&g&&(b.push({name:k,address:g}),a.markAddedToHeader(!0))}break;case "ATTENDEES":for(c=
0;c<a.subfields.length;c++)d(a.subfields[c],b)}};b.setDisplayField=function(a){if(a&&this.fieldDef.value&&this.range&&a.fieldDef.value&&a.range){var b=y.create("div");b.html(a.fieldDef.value);var c=r(b.text(),a.range.acc);b.html(this.fieldDef.value);b=r(b.text(),this.range.acc);c&&b&&(this.displayField=a,this.displayField.addedToHeader=!0,this.addresses=[{name:c,address:b}])}else delete this.displayField,delete this.addresses};b.hasValue=function(){return"string"==typeof this.fieldDef.imageurl||"string"==
typeof this.fieldDef.value};b.buildFieldValue=function(){var a=this.fieldDef,b;this.container.html("");if(!this.labelElem){var c;a.id&&(c=T["EMAIL_"+a.id])&&(a.label=c);var d=y.create("div","oit-emhdrlabel");b=[];c||("string"==typeof a.label?b.push(a.label):b.push(T.UNKNOWN_FIELD));b.push('<span data-acc="none" class="oit-noacc">');c&&b.push(a.label);this.groupField&&this.showGroupType&&this.groupField.fieldDef.type&&b.push(" (",this.groupField.fieldDef.type,")");a.label&&-1!=a.label.indexOf(T.LABEL_SEPARATOR)||
b.push(T.LABEL_SEPARATOR);b.push("</span>");d.html(b.join(""));this.labelElem=d}if(!this.valueElem){if("string"==typeof a.imageurl)b='<img src="'+a.imageurl+'"/>',this.valueElem=y.create("div","oit-fieldimage"),this.valueElem.html(b);else if(this.addresses){this.valueElem=y.create("div");this.valueElem.html(a.value);b=[];for(c=0;c<this.addresses.length;c++)d=this.addresses[c],b.push('<span class="oit-email-a">'),0<c&&k(", ",b),d.name&&m(d.name.text,d.name.acc,"oit-email-aname",d.address?d.address.text:
null,null,null,b),d.address&&(m(d.address.text,d.address.acc,"oit-email-aaddr",null," [","]",b),this.hasEmailAddresses=!0),b.push("</span>");this.valueElem.html(b.join(""));this.valueElem.removeData("acc")}else"string"==typeof a.value&&(this.valueElem=y.create("div"),this.valueElem.html(a.value));if(this.valueElem&&(this.valueElem.addClass("oit-emhdrvalue"),a.id&&(a=a.id,this.groupField&&(a=this.groupField.fieldDef.id+"/"+a),this.valueElem.attr("data-fieldid",a)),this.valueElem.hasClass("oit-noacc"))){var e;
this.valueElem.hasClass("oit-datetime-field")?e=Bb(this.valueElem.text()):this.valueElem.hasClass("oit-date-field")?e=vc(this.valueElem.text()):this.valueElem.hasClass("oit-time-field")&&(e=wc(this.valueElem.text()));e&&this.valueElem.text(e)}}this.labelElem&&this.container.append(this.labelElem);this.valueElem&&this.container.append(this.valueElem)};var g=function(a,b){var c=y.create(b);c.addClass(a.attr("class"));var d=a.attr("data-acc");d&&c.attr("data-acc",d);(d=a.attr("data-fieldid"))&&c.attr("data-fieldid",
d);return c},k=function(a,b){b.push('<span class="oit-noacc" data-acc="none">',a,"</span>")},m=function(a,b,c,d,e,g,m){a=Ib(a);d=Ib(d);m.push("<span");d&&m.push(' title="',d,'"');0>b&&(c=c?c+" oit-noacc":"oit-noacc");c&&m.push(' class="',c,'"');e||g?(m.push(">"),e&&(0>b?m.push(e):k(e,m)),m.push("<span",' data-acc="'),0<b?m.push(b):m.push("none"),m.push('">',a,"</span>"),g&&(0>b?m.push(g):k(g,m))):(m.push(' data-acc="'),0<b?m.push(b):m.push("none"),m.push('">',a));m.push("</span>")},r=function(a,b){if(a){for(var c=
0;c<a.length&&/\s/.test(a[c]);c++)b++;a=a.trim();if(2<=a.length){var c=a.charAt(0),d=a.charAt(a.length-1);'"'!=c&&"'"!=c||c!=d||(b++,a=a.substring(1,a.length-1),(c=r(a,b))?(a=c.text,b=c.acc):a=null)}}return a?{text:a,acc:b}:null},t=function(a,b,c){if(a=a.match(b)){for(b=0;b<a.length;b++);b=0;if(a)for(var d=0;d<a.length;d++)(0<a[d].indexOf("@")||0<=a[d].toUpperCase().indexOf("CN="))&&b++;if(0<b)return{list:a,count:b,diff:Math.abs(b-c)}}};return a}(),wd=function(){var c=function(){U.call(this,"div",
"oit-scrollpane");this.addClass("oit-scrollpanebar");this.html('<div class="oit-scrollpanecontent"></div><div class="oit-scrollbar"><div></div></div><div class="oit-scrollpaneup oit-fade"></div><div class="oit-scrollpanedn oit-fade"></div><div class="oit-scrollpaneup oit-ellip">&#x2022; &#x2022; &#x2022;</div><div class="oit-scrollpanedn oit-ellip">&#x2022; &#x2022; &#x2022;</div>');this.prop("scrollbar",this.childByClass("oit-scrollbar"),!1,!0);this.prop("scrollthumb",this.scrollbar.firstChildElem(),
!1,!0);this.prop("scrollup",this.byClass("oit-scrollpaneup"),!1,!0);this.prop("scrolldown",this.byClass("oit-scrollpanedn"),!1,!0);w.isMobileOrTablet&&(this.kinetic(!0),this.onpanstart(this,r),this.onpanmove(this,t));this.scrollbar.onclick(this,b);this.scrollbar.ontap(this,b);this.scrollthumb.ondragstart(this,d);this.scrollthumb.ondragmove(this,g);this.scrollthumb.ondragend(this,k);this.scrollthumb.ondragcancel(this,k);this.scrollthumb.onclick(this,m);this.prop("content",this.childByClass("oit-scrollpanecontent"),
!1,!0);this.content.onwheel(this,a);this.onmouseover(this,function(){this.addClass("oit-hover")});this.onmouseout(this,function(){this.removeClass("oit-hover")});y.attach(this)},e=W(c,U);Object.defineProperties(e,{scrollLeft:{get:function(){return 0},set:function(a){}},scrollTop:{get:function(){return-this.content.offsetTop},set:function(a){this.setScrollTop(a,!0)}},minScroll:{get:function(){return 0}},maxScroll:{get:function(){var a=this.content.outerHeight-this.clientHeight;0>a&&(a=0);return a}},
contentHeight:{get:function(){return this.content.outerHeight}},visibleHeight:{get:function(){return this.clientHeight}},enabled:{get:function(){return this.content.outerHeight>this.clientHeight}}});e.setScrollTop=function(a,b){if("number"===typeof a){var c=this.minScroll,d=this.maxScroll;a<c?a=c:a>d&&(a=d);this.content.offsetTop!=-a?(this.content.offsetTop=-a,!1!==b&&this.update(a),"function"===typeof R.UIEvent?c=new UIEvent("scroll"):(c=V.createEvent("UIEvents"))&&c.initUIEvent&&c.initUIEvent("scroll",
!0,!1,R,null,2),c&&this.dispatchCustom("scroll",c)):!1!==b&&this.update(a);return a}};e.scrollIntoView=function(a){var b;a instanceof U?b=a.rect(this.content):a instanceof aa&&(b=a);b&&(a=this.scrollTop,b.bottom>=a+this.visibleHeight&&(a=b.bottom+11-this.visibleHeight),b.top<=a&&(a=b.top-11),this.scrollTop=a)};e.isVisible=function(a){var b;a instanceof aa?b=a:a instanceof U&&(b=a.rect(this.content));return b?(a=this.scrollTop*x.zoom,b.top<a+this.visibleHeight*x.zoom&&b.bottom>a):!1};e.update=function(a){if(void 0===
a)this.setScrollTop(this.scrollTop);else{if(this.scrollbar){var b=this.content.outerHeight,c=this.clientHeight;c>=b?(this.scrollbar.css("display","none"),this.removeClass("oit-scrollable")):(c=100*c/b,1>c&&(c=1),this.scrollthumb.css({top:100*a/b+"%",height:c+"%"}),this.scrollbar.css("display",null),this.addClass("oit-scrollable"))}if(this.scrollup){b=0<a;c=a<this.maxScroll;for(a=0;a<this.scrollup.length;a++)this.scrollup[a].css("opacity",b?null:0);for(a=0;a<this.scrolldown.length;a++)this.scrolldown[a].css("opacity",
c?null:0)}}};var a=function(a){if(!a.ctrlKey&&this.enabled){var b=a.deltaY;if(1==a.deltaMode||2==a.deltaMode)b*=12;this.scrollTop+=b;return!1}},b=function(a){if(a.offsetY){var b=this.content.outerHeight,c=this.clientHeight,d=this.scrollTop/b;a=a.offsetY/this.clientHeight;a<d?this.scrollTop-=c:a>d+c/b&&(this.scrollTop+=c)}},d=function(a){this.scrollthumb._topPercent=100*this.scrollTop/this.content.outerHeight;this.scrollbar.css("opacity",.1);return!1},g=function(a){var b=this.content.outerHeight,c=
100*(b-this.clientHeight)/b;a=this.scrollthumb._topPercent+100*a.delta.y/this.clientHeight;0>a?a=0:a>c&&(a=c);this.scrollTop=a*b/100;return!1},k=function(a){delete this.scrollthumb._topPercent;this.scrollbar.css("opacity",null);return!1},m=function(a){return!1},r=function(a){return!1},t=function(a){this.scrollTop-=a.delta.y;return!1};e.redirectEvent=function(b){var c=!0;"wheel"==b.type&&(a.call(this,b),c=!1);return c};return c}(),Ob={paragraph:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,
checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},slide:{requireText:!1,skipIfNoText:!1,showIcon:!0,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},page:{requireText:!1,skipIfNoText:!1,showIcon:!0,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},cell:{requireText:!0,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"COMMENT"},add:{requireText:!1,
skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-add",badgeCls:null,title:"INSERTED_TEXT"},"delete":{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-delete",badgeCls:null,title:"DELETED_TEXT"},change:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!0,checkRanges:!0,textCls:"oit-anno-change",badgeCls:null,title:"CHANGED_TEXT"},hidden:{requireText:!1,skipIfNoText:!0,showIcon:!1,showFromTo:!1,checkRanges:!0,textCls:"oit-anno-delete",
badgeCls:"oit-badge-delete",title:"HIDDEN_TEXT"},add_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_ROW"},delete_row:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_ROW"},add_col:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_COLUMN"},delete_col:{requireText:!1,
skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"DELETED_COLUMN"},new_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"NEW_CELL"},modify_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MODIFIED_CELL"},clear_cell:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",
badgeCls:null,title:"CLEAR_CELL"},move_cells:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"MOVED_CELLS"},add_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!1,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"ADDED_SHEET"},rename_sheet:{requireText:!1,skipIfNoText:!1,showIcon:!1,showFromTo:!0,checkRanges:!1,textCls:"oit-anno-comment",badgeCls:null,title:"RENAMED_SHEET"}},qd=function(){var c=/\S/,
e="#ffbc2b #9439ae #61b34a #de2f40 #43bee6 #ef5f11 #0078ff".split(" "),a=['<div class="oit-annoblock"><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable oit-annotitle"> ',T.ANNOTATIONS,'</span><span class="oit-sortselect"><span class="oit-unselectable">',T.SORT_BY,'</span><select name="oit-sort" class="oit-sort"><option value="location">',T.LOCATION,'</option><option value="author">',T.AUTHOR_A_TO_Z,'</option><option value="rauthor">',T.AUTHOR_Z_TO_A,'</option><option value="date">',
T.OLDEST_FIRST,'</option><option value="rdate">',T.NEWEST_FIRST,'</option><option value="type">',T.ANNOTATION_TYPE,"</option></select></span></div></div>"].join(""),b=function(b){U.call(this,"div","oit-annopane");this._page=b;this._annos=[];this._groups=[];this._newGroups=[];this._groupOffsets=[];this._badgeColorIndex=0;this._authorColors={};this._showLeader=!0;this._batches=[];this._needLayout=!0;this.html(a);this._block=this.byClass("oit-annoblock")[0];this._header=this.byClass("oit-annoheader")[0];
this._title=this.byClass("oit-annotitle")[0];this._commentIcon=this.byClass("oit-commentsicon")[0];this._sortSpan=this.byClass("oit-sortselect")[0];this._sortSelect=this.byClass("oit-sort")[0];this._scrollPane=new wd;this._block.append(this._scrollPane);this.onclick(z.deactivateAnnotation);this.ontap(z.deactivateAnnotation);this._sortSelect.onchange(this,C);this._scrollPane.onscroll(this,Z);ka.onresize(this,Z);E.onzoom(this,Z);this._isHidden=!0;this.css("display","none");this.attach()},d=W(b,U);d.destroy=
function(){this._scrollPane.offscroll(this,Z);E.offzoom(this,Z);ka.offresize(this,Z);E.offidle(this,n);E.offidle(this,R);for(var a=0;a<this._newGroups.length;a++)this._newGroups[a].groupDiv.destroy();U.prototype.destroy.call(this)};d.update=function(){this.isHidden()||this._resizeTimer||(Z.call(this),this.layout(),this.scrollPane().update())};var g=function(a){var b=100;0<a._batches.length?b=0:0<a._newGroups.length&&(b=a._groups.length/(a._newGroups.length+a._groups.length),b=Math.floor(100*b));100<=
b?a._title.text(T.ANNOTATIONS):a._title.text(T.LOADING+" ("+b+"%)")};d.isLoading=function(){return 0<this._batches.length||0<this._newGroups.length};d.isEmpty=function(){return 0===this._annos.length&&0===this._batches.length&&0===this._newGroups.length};d.toolbarMode=function(a){!0===a?this._toolbarMode=!0:delete this._toolbarMode};d.attach=function(){if(!this.parent()){var a=this._page;if(a.supportsAnnotationPane()){var b=a.parent();b&&(a.nextSiblingElem()?b.insert(this,a.nextSiblingElem()):b.append(this))}}};
d.range=function(){return this._range};var k=function(a,b){var c=!1;if(a)if(Array.isArray(a))for(var d=0;d<a.length&&!(c=k(a[d],b));d++);else a.range&&(c=gb(a.range,b));return c},m=function(a,b){var c=a.anno;return k(c.text,b)||k(c.oldtext,b)||k(c.last_save_date||c.create_date||c.date,b)||k(c.author,b)},r=function(a){if(a)if(Array.isArray(a))for(var b=0;b<a.length;b++)r(a[b]);else a.range&&"text"===a.range.type&&!a.text&&(a.text=ia.getRawText(a.range.acc,a.range.accend))},t=function(a,b,c,d){var e=
null,f;if("string"===typeof b)e=y.create("p"),c.append(e),f=y.create("span"),e.append(f),u(a,b,f);else if(Array.isArray(b))for(var g=!0,k=0;k<b.length;k++){var h=b[k];h.range&&d&&(g=a._page.containsRange(h.range));g&&(e||(e=y.create("p"),c.append(e)),r(h),h.text?(f=y.create("span"),e.append(f),u(a,h,f)):e=null)}},u=function(a,b,c){b&&("string"===typeof b?(c.attr("data-acc","none"),c.addClass("oit-noacc"),c.text(b)):b.text&&(b.range&&b.range.acc?(c.attr("data-acc",b.range.acc),a._range?(b.range.acc<
a._range.acc&&(a._range.acc=b.range.acc),b.range.accend>a._range.accend&&(a._range.accend=b.range.accend)):a._range=ga(b.range)):(c.attr("data-acc","none"),c.addClass("oit-noacc")),c.text(b.text),b.b&&c.css("font-weight","bold"),b.i&&c.css("font-style","italic")))},n=function(){if(0<this._batches.length){var a=this._batches.shift();if(a&&0<a.length){for(var b=this._page,d=b.overlay?b.overlay.layer("comments"):void 0,f,k=0;k<a.length;k++){var l=a[k],m=Ob[l.type],q=!!m;if(m&&m.skipIfNoText){var r=l,
w=!1;if(r.text)for(f=0;f<r.text.length;f++){var x=r.text[f];if(x.text&&c.test(x.text)){w=!0;break}}w||(q=!1)}if(q&&l.range){r=q=null;if(l.parentid)for(w=0;w<this._annos.length;w++)if(f=this._annos[w],f.anno.id==l.parentid){q=f;r=f.groupInfo;break}r||(r={groupDiv:y.create("div","oit-annogroup"),annos:[]},this._newGroups.push(r));w=y.create("div","oit-anno");w.attr("id","oita"+l.id);f=y.create("div","oit-anno-text");if(x=m.title)switch(x=T[x],l.type){case "add_row":x+=" "+Ya(l.range.r1);break;case "delete_row":x+=
" "+Ya(l.range.r1);break;case "add_col":x+=" "+Ma(l.range.c1);break;case "delete_col":x+=" "+Ma(l.range.c1);break;case "cell":x+=" "+rb(l.range);break;case "new_cell":x+=" "+rb(l.range);break;case "modify_cell":x+=" "+rb(l.range);break;case "clear_cell":x+=" "+rb(l.range);break;case "move_cells":x+=" "+rb(l.oldrange)+" to "+rb(l.range)}if(l.oldtext){if(m.showFromTo){var z=y.create("div","oit-anno-change-sep oit-noacc");z.attr("data-acc","none");z.text(T.ANNO_CHANGE_FROM);f.append(z)}t(this,l.oldtext,
f,m.checkRanges);m.showFromTo&&(z=y.create("div","oit-anno-change-sep oit-noacc"),z.attr("data-acc","none"),z.text(T.ANNO_CHANGE_TO),f.append(z))}if(l.text)t(this,l.text,f,m.checkRanges);else if(m.requireText){z=y.create("p","oit-noacc oit-unsupportedcontent");z.attr("data-acc","none");var A=y.create("span");A.text(T.UNSUPPORTED_CONTENT);z.append(A);f.append(z)}z=y.create("div","oit-anno-meta");if(A=l.last_save_date||l.create_date||l.date){var C=null;"string"===typeof A?C=Bb(A):A.text&&(C=Bb(A.text));
if(C){var G=y.create("span","oit-anno-date");C===A.text?u(this,A,G):(G.text(C),G.addClass("oit-noacc"),G.attr("data-acc","none"));z.append(G)}}C="";A=null;l.author&&(C=y.create("span","oit-anno-author"),u(this,l.author,C),z.append(C),C=C.text().trim(),0<C.length&&(A=this._authorColors[C],A||(this._authorColors[C]=A=e[this._badgeColorIndex++],this._badgeColorIndex>=e.length&&(this._badgeColorIndex=0)),C=C.charAt(0).toUpperCase()));if(x){G=y.create("div","oit-anno-type oit-noacc");G.attr("data-acc",
"none");if(C){var F=y.create("div","oit-badge");A&&F.css("background",A);F.text(C);G.append(F)}F=y.create("span");F.text(x);G.append(F);w.append(G)}w.append(f,z);r.groupDiv.append(w);f={anno:l,annoDiv:w,groupInfo:r};r.annos.push(f);w.onclick(this,h,f);w.ontap(this,h,f);"text"===l.range.type?(f.spans=tb(b,l.range,m.textCls,l.id,"page"),q||(f.badge=new kd(b.index,d,m.badgeCls,C),A&&f.badge.css("background",A),f.badge.onclick(this,B,f),f.badge.ontap(this,B,f),f.badge.onmouseover(this,v,f),f.badge.onmouseout(this,
J,f),f.badge.hide())):m.showIcon&&(q?(f.parent=q,f.icon=q.icon,q.icon.removeClass("oit-commenticon"),q.icon.addClass("oit-commenticonmulti"),q.icon.resetDefaultSize(),l=q.icon.defaultSize(),q.icon.move(void 0,void 0,l.width,l.height)):(l=new jd(b.index,d,"oit-commenticon"),r.groupDiv.data("commenticon",l),l.data("comment",r.groupDiv),l.onclick(this,B,f),l.ontap(this,B,f),l.onmouseover(this,v,f),l.onmouseout(this,J,f),f.icon=l,l.hide()));f.index=this._annos.length;this._annos.push(f)}}V(this)}M(this,
!0);this.update()}0===this._batches.length&&(E.offidle(this,n),this._processingBatches=!1,this.layout(),this._processBatchCallbackFn&&(this._processBatchCallbackFn(this,this._processBatchCallbackArg),delete this._processBatchCallbackFn,delete this._processBatchCallbackArg));g(this)};d.processAnnotations=function(a,b,c){if(a){if(500>=a.length)this._batches.push(a);else for(var d=0;d<a.length;d+=500){var e=d+500;e>a.length&&(e=a.length);e=a.slice(d,e);this._batches.push(e)}this._processingBatches||
(this._processingBatches=!0,b&&(this._processBatchCallbackFn=b,this._processBatchCallbackArg=c),E.onidle(this,n),n.call(this));g(this)}};d.show=function(){this.attach();if(this.parent()){this._isHidden=!1;this.css("display",null);for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&("slide"!==b.anno.type&&b!==this._activeAnno||b.icon.show());b.badge&&b.badge.show();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.onclick(this,B,b);d.ontap(this,B,b);d.onmouseover(this,
v,b);d.onmouseout(this,J,b)}}V(this);M(this);this.update()}};d.hide=function(){this._isHidden=!0;this.css("display","none");for(var a=0;a<this._annos.length;a++){var b=this._annos[a];b.icon&&b.icon.hide();b.badge&&b.badge.hide();if(b.spans&&!b.anno.parentid)for(var c=0;c<b.spans.length;c++){var d=b.spans[c];d.offclick(this,B);d.offtap(this,B);d.offmouseover(this,v);d.offmouseout(this,J)}}A(this)};d.isHidden=function(){return!!this._isHidden};d.panelRect=function(a){return z.elementRect(this._scrollPane,
a)};d.contentRect=function(a){return z.elementRect(this._scrollPane.content,a)};d.getSpanMap=function(){this._spanMap||(this._spanMap=new Nc(this._page,this._scrollPane.content));return this._spanMap};d.scrollPane=function(){return this._scrollPane};d.findACC=function(a){var b=this.getSpanMap();if(b)return b.findACC(a)};d.findRange=function(a,b){var c=this.getSpanMap();if(c)return c.findRange(a,b)};d.mapPointToSpan=function(a,b,c){var d=this.getSpanMap();if(d)return d.mapPointToSpan(a,b,c)};d.containsRange=
function(a){var b=!1;"text"===a.type&&this._range&&a.acc<=this._range.accend&&a.accend>=this._range.acc&&(a.acc===a.accend?b=!!this.findACC(a.acc):(a=this.findRange(a.acc,a.accend),void 0!==a&&0<a.length&&(b=!0)));return b};d.annoRect=function(a,b,c){var d=null,e;c||(c=a.anno.annoRange||a.anno.range);if(a.spans||a.anno.embeds){if(a.spans)for(var f=0;f<a.spans.length;f++)(e=a.spans[f].textRect(c))&&(d?b?e.bottom>d.bottom?d=e:e.bottom==d.bottom&&d.union(e):d.union(e):d=e);if(a.anno.embeds)for(b=0;b<
a.anno.embeds.length;b++)(e=this._page.embeddingRect(a.anno.embeds[b].uid))&&(d?d.union(e):d=e)}else if(a.icon)(e=a.icon.isHidden())&&a.icon.show(),d=new aa(a.icon.rect(w.viewNode),"view"),e&&a.icon.hide();else if("cell"===c.type)switch(a.anno.type){case "add_sheet":case "rename_sheet":d=z.overlayTabRect(this._page.overlay);break;case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":d=F.rangeRect(c,"view");break;default:d=
F.expandRange(c),d=F.rangeRect(d,"view")}else d=F.rangeRect(c,"view",!1,"page"),d||"text"!==c.type||(a=this._page.frameForRange(c))&&(a=a.firstChildElem())&&"DIV"===a.tagName&&(d=a.rect(w.viewNode),d=new aa(d,"view"),d.width=0,d.height=0);return d};d.annoTextHeight=function(a,b){var c=0;if(a.spans){for(var d,e=0;e<a.spans.length;e++){var f=a.spans[e].textRect(a.anno.range);f&&(!d||f.bottom>d.bottom?d=f:f.bottom==d.bottom&&d.union(f))}d&&(d.origin=b,c=d.height)}return c};var q=function(a,b){var c=
a.annos[0],d=b.annos[0],c=Na(c.anno.annoRange||c.anno.range,d.anno.annoRange||d.anno.range);0===c&&(c=I(a,b));return c},l=function(a,b){return-q(a,b)},I=function(a,b){var c=a.annos[0].anno,d=b.annos[0].anno,c=c.last_save_date||c.create_date||c.date,d=d.last_save_date||d.create_date||d.date;c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=a.annos[0].index-b.annos[0].index);return e},L=function(a,b){return-I(a,b)},
K=function(a,b){var c=a.annos[0].anno.author,d=b.annos[0].anno.author;c&&c.text&&(c=c.text);d&&d.text&&(d=d.text);var e;c&&d&&c.localeCompare&&d.localeCompare?e=c.localeCompare(d):c?e=1:d&&(e=-1);0===e&&(e=I(a,b));return e},H=function(a,b){return-K(a,b)},N=function(a,b){var c=a.annos[0].anno.type,d=b.annos[0].anno.type,e=Ob[c],f=Ob[d];e&&e.title&&(c=T[e.title]);f&&f.title&&(d=T[f.title]);e=0;c&&d&&(e=c.localeCompare(d));0===e&&(e=q(a,b));return e},C=function(){var a=y.unwrap(this._sortSelect),a=a.item(a.selectedIndex);
x.annotationSort=a?a.value:"index"};d.applySort=function(a){var b=x.annotationSort;if(!this.isLoading()&&(a||b!==this._sort)){this._sort=b;switch(b){case "date":a=I;break;case "rdate":a=L;break;case "rlocation":a=l;break;case "author":a=K;break;case "rauthor":a=H;break;case "type":a=N;break;default:a=q}this._groups.sort(a);for(a=this._groups.length-1;0<=a;a--)this._groups[a].groupDiv.detach();for(a=0;a<this._groups.length;a++)this._scrollPane.content.append(this._groups[a].groupDiv);y.unwrap(this._sortSelect).value=
b;delete this._spanMap;this._groupOffsets=[];this.update()}};var M=function(a,b){if(!a.isHidden())if(a.isLoading()||2>a._annos.length)a._showSort=!1,delete a._headerWidth,a._sortSpan.css("display","none");else{var c=a._header.clientWidth;if(b||!a._headerWidth||a._showSort&&c<a._headerWidth||!a._showSort&&c>a._headerWidth){a._sortSpan.css("display",null);var c=a._sortSpan.pos(a._header),d=a._commentIcon.rect(a._header),e=!0;c.top>=d.bottom&&(e=!1);e||a._sortSpan.css("display","none");a._showSort=e}}};
d.onResize=function(a){var b=this._header.clientWidth;if(!0===a||b!=this._headerWidth){this._headerWidth=b;if(this._resizeTimer)ta(this._resizeTimer);else for(a=0;a<this._groups.length;a++)b=this._groups[a],b.visible&&b.groupDiv.css("height",null);this._resizeTimer=da(function(){this._groupOffsets=[];for(var a=0;a<this._groups.length;a++){var b=this._groups[a];b.height&&(b.groupDiv.css("height",null),delete b.height)}this._spanMap&&this._spanMap.discardLayout();M(this);delete this._resizeTimer;this.update()},
100,this)}};d.layout=function(){var a=this._page,b=a.pageRect("overlay");if(!a.parent()||!this.parent()||this.isHidden())this.css("display","none");else if(this&&b){delete this._needLayout;var c,d,e=x.zoom;this._toolbarMode?this.css({top:null,left:null,height:null,display:null}):(this.css({top:b.top/e+"px",left:b.right/e+"px",height:b.height/e+"px",display:null}),150>b.height?(this._header.css("display","none"),this._scrollPane.css("top","0")):(this._header.css("display",null),this._scrollPane.css("top",
null)));this._scrollPane.update();a.pagePos("overlay");for(e=0;e<this._annos.length;e++){var f=this._annos[e];if(f.badge){var g=this.annoRect(f,!1);if(g){g.origin="overlay";c=b.left+5;d=(g.top+g.bottom)/2-10;var g=b.bottom-20-5,k;do{if(d>g)break;for(var h=k=0;h<e;h++)if(h!=e&&this._annos[h].badge){var l=this._annos[h].badge.position(),q=l.bottom- -2;d>l.top-l.height+-2&&d<q&&(d=q,k++)}}while(k&&20>=k);d>g||20<k?(f.badge.destroy(),delete f.badge):(f.badge.show(),f.badge.move(c,d))}else f.badge.hide()}if(f.icon&&
!f.parent){if(f.anno.range)switch(f.anno.range.type){case "rect":c=f.anno.range.left;d=f.anno.range.top;break;case "text":if(g=F.rangeRect(f.anno.range,a))c=g.left,d=g.top,f.icon.css("opacity",.3)}else c=f.anno.x,d=f.anno.y;void 0!==c&&void 0!==d&&(g=new aa(c,d,c+20,d+20,a),0>g.left?g.left=0:g.right>a.width&&(g.right=a.width),0>g.top?g.top=0:g.bottom>a.height&&(g.bottom=a.height),g.origin="overlay",f.icon.move(g.left,g.top),this._isHidden||"slide"!==f.anno.type&&f!==this._activeAnno||f.icon.show())}}}};
var A=function(a){a._hasUpdateListener||(ka.onupdate(a,f),a._hasUpdateListener=!0);ka.invalidateCanvas()};d.showLeader=function(a){!1!==a&&(a=!0);a!==this._showLeader&&(this._showLeader=!1!==a,ka.invalidateCanvas())};var f=function(a){if(!this._isHidden&&x.showAnnotations&&this._activeAnno){var b=this._activeAnno;if(b&&this._showLeader){var c;if(b.anno.oldrange&&"cell"===b.anno.oldrange.type){var d=S.cellSelection(),e=b.anno.annoRange||b.anno.range,f=b.anno.oldrange;d&&!gb(d,e)&&gb(d,f)&&(c=f)}if(d=
this.annoRect(b,!0,c)){e=w.rootNode;f=w.viewNode;c=f.rect(e);d.origin="view";d.offset(c.left,c.top);var g=d.left,k=d.top,h=d.right,l=d.bottom;0>g&&0<h&&(g=0);h>f.clientWidth&&g<f.clientWidth&&(h=f.clientWidth);0>k&&0<l&&(k=0);l>f.clientHeight&&k<f.clientHeight&&(l=f.clientHeight);d.move(g,k,h,l);h=b.annoDiv.rect(e);0===h.height&&(h=b.groupInfo.groupDiv.rect(e));F.padding();var q=10;b.spans&&(q=.7*this.annoTextHeight(b,"view"),10>q?q=10:40<q&&(q=40));var m,n,r;m="cell"===b.anno.range.type;n="add_sheet"===
b.anno.type||"rename_sheet"===b.anno.type;var k=!1,l=!0,t=h.top+20,u=h.bottom-20,f=h.left,g=t,b=f-10;if(m)k=!0,n?(q=(d.right+d.left)/2,m=d.top,n=q,r=m-10,l=!1):(q=d.right+2,m=d.top+d.height/2,n=q+10,n>b&&(n=q),r=m);else{var v=d.top-q;r=d.bottom+q;q=(d.right+d.left)/2;m=d.bottom;n=q;var y=this._page.pageRect("view").clone();y.offset(c.left,c.top);if(r>=y.bottom||g<m&&v>y.top)m=d.top,r=v;g=r>u?u:r<t?t:r}e=this._scrollPane.rect(e);g<e.top?g=e.top:g>e.bottom&&(g=e.bottom);d=!0;g<h.top?(g=e.bottom,d=!1):
g>h.bottom&&(g=e.top,d=!1);l&&n>=b&&(n=q,r=m,b=f);if(q<f||!l)a.save(),e=w.rootNode.rect(),e=e.right-e.left-c.left,a.beginPath(),a.rect(c.left,c.top,e,c.bottom-c.top),a.clip(),a.beginPath(),k&&a.arc(q,m,2,0,2*Math.PI,!0),a.moveTo(q,m),a.lineTo(n,r),a.lineTo(b,g),d&&a.lineTo(f,g),a.strokeStyle="rgba(255,255,255,0.1)",a.lineWidth=9,a.stroke(),a.strokeStyle="rgba(255,255,255,0.3)",a.lineWidth=7,a.stroke(),a.strokeStyle="rgba(255,255,255,0.5)",a.lineWidth=5,a.stroke(),a.strokeStyle="rgba(0,0,0,0.25)",
a.lineWidth=3,a.stroke(),a.restore()}}}};d.deactivate=function(a,b){this.activate(null,!1,!1,a,b)};d.activate=function(a,b,c,d,e){var f=this;if(f._activating)d&&d(e);else if(f._annos){!1!==b&&(b=!0);var g,k,h;if(a)if(k=xa(a))for(h=0;h<f._annos.length;h++){if(m(f._annos[h],k)){g=f._annos[h];break}}else if(a.anno&&a.groupInfo.groupDiv)g=a;else if(a.id)for(h=0;h<f._annos.length;h++)if(f._annos[h].anno===a){g=f._annos[h];break}if(g)z.deactivateAnnotation(),f._activating=g,x.showAnnotations||(x.showAnnotations=
!0),z.movetoEx(this._page.index,{animate:!0,callbackFn:function(){z.scrollToAnnotationPane(function(){f._activeAnno=g;z.activeAnnotationPane(f);if(g.spans||g.anno.embeds){if(g.spans)for(var a=0;a<g.spans.length;a++)g.spans[a].addClass("oit-active")}else g.icon&&(g.icon.show(),g.icon.activate());A(f);g.annoDiv.addClass("oit-active");if(b){var h;k&&(h=f.getSpanMap().findRange(k.acc,k.accend));if(h){for(var l,a=0;a<h.length;a++){var q=h[a].textRect(k);q&&(l?l.union(q):l=q)}l&&(l.origin=f._scrollPane.content,
l.scale(1/x.zoom),f._scrollPane.scrollIntoView(l))}else f._scrollPane.scrollIntoView(g.groupInfo.groupDiv),f._scrollPane.scrollIntoView(g.annoDiv)}if(h=g.anno.annoRange||g.anno.range)if(F.moveto(h),c&&"cell"===h.type&&"add_sheet"!==g.anno.type&&"rename_sheet"!=g.anno.type){h=(l=S.cellSelection())&&g.anno.oldrange&&!gb(l,h)&&gb(l,g.anno.oldrange)?ga(g.anno.oldrange):ga(h);switch(g.anno.type){case "add_row":case "delete_row":case "add_col":case "delete_col":case "new_cell":case "modify_cell":case "clear_cell":case "move_cells":h.autoExpand=
!1}P.pauseAutoHighlight(!0);S.select(h);P.pauseAutoHighlight(!1)}d&&d(e);delete f._activating})}});else{a=f._activeAnno;f._activeAnno=null;if(a){if(a.spans||a.anno.embeds){if(a.spans)for(h=0;h<a.spans.length;h++)a.spans[h].removeClass("oit-active")}else a.icon&&(a.icon.deactivate(),"slide"!==a.anno.type&&a.icon.hide());A(f);a.annoDiv.removeClass("oit-active");z.activeAnnotationPane(null);a=null}d&&d(e)}}};var h=function(a,b){this.activate(b,!1,!0);return!1},B=function(a,b){if(0===y.selectedText().length)return P.deactivate(),
S.reset(),this.activate(b,!0,!0),!1},v=function(a,b){b.groupInfo.groupDiv.addClass("oit-hover")},J=function(a,b){b.groupInfo.groupDiv.removeClass("oit-hover")},R=function(){if(!this.isHidden()&&!this._needLayout){for(var a=0;30>a;a++){var b=this._newGroups.shift();if(!b)break;this._scrollPane.content.append(b.groupDiv);this._groups.push(b)}this._scrollPane.update();g(this);Z.call(this);0===this._newGroups.length&&(this._processingGroups=!1,E.offidle(this,R),M(this,!0),this.applySort(!0),P.each("addToPage",
null,this._page.index,!0))}},V=function(a){!a._processingGroups&&0<a._newGroups.length&&!a.isHidden()&&(a._processingGroups=!0,a._addGroupInterval=E.onidle(a,R),g(a),R.call(a))},Z=function(){if(!this._isHidden){var a,b,c;c=-1;for(a=0;a<this._groups.length;a++)if(b=this._groups[a],!b.height&&(-1==c&&(c=a),!b.visible)){b.visible=!0;for(var d=0;d<b.annos.length;d++)b.annos[d].annoDiv.css("display",null)}d=0;if(-1!=c){var e=x.zoom;for(a=c;a<this._groups.length;a++)b=this._groups[a],void 0===b.height&&
(c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top,d++,0<c.height&&(b.height=this._toolbarMode?c.height-1:c.height/e-1,b.groupDiv.css("height",b.height+"px")))}if(d<this._groups.length)for(a=0;a<this._groups.length;a++)void 0===this._groupOffsets[a]&&(b=this._groups[a],c=b.groupDiv.rect(this._scrollPane.content),this._groupOffsets[a]=c.top);this._groupOffsets[this._groups.length]=this._scrollPane.content.outerHeight;c=this.clientHeight;d=this._scrollPane.scrollTop;this._toolbarMode||
(c*=x.zoom,d*=x.zoom);for(a=0;a<this._groups.length;a++)if(b=this._groups[a],e=this._groupOffsets[a]-d,e=0<this._groupOffsets[a+1]-d&&e<c,e!=b.visible)for(var e=(b.visible=e)?null:"none",f=0;f<b.annos.length;f++)b.annos[f].annoDiv.css("display",e);A(this)}};return b}(),ad=function(){return function(){var c='<div><div class="oit-annoheader"><span class="oit-commentsicon"></span><span class="oit-unselectable"> '+T.ANNOTATIONS+"</span></div></div>",e,a,b;this.show=function(){if(e&&b){var a=x.annoBarWidth;
0<a?e.show({size:a}):e.show();b.show()}};this.hide=function(){e&&(b&&b.hide(),e.hide())};this.destroy=function(){ya.offresizeinternal(this,g);z.offchange(this,d);x.offshowAnnotations(this,d);x.offannoBarWidth(this,d);e&&ya.removeInternal(-3);a&&a.destroy();a=e=null};var d=function(){var c=z.activePage(),c=c?c.annotationPane():null;c!==b&&(b&&(b.css("width",null),b.hide(),z.activeAnnotationPane(null),a.remove(b),b.toolbarMode(!1),b=null),b=c)&&(z.activeAnnotationPane(b),a.append(b),b.toolbarMode(!0),
b.scrollPane().setScrollTop(0,!0));c=x.annoBarWidth;0>=c&&(c=void 0);e.applySize(c,void 0,!0);b&&x.showAnnotations?this.show():this.hide()},g=function(c,d,e,g,u){-3===c&&a&&b&&(0<e&&(x.annoBarWidth=e,e+="px",a.css("width",e),b.css("width",e)),b.showLeader(!u),b.onResize(),ka.invalidateCanvas())};a=y.create("div","oit-annobar");e=new Pb(-3,"right",a,null,ya.internalParent(-3));e.resizable(!0,60,30,c);ya.addInternal(-3,e);ya.onresizeinternal(this,g);z.onchange(this,d);x.onshowAnnotations(this,d);x.onannoBarWidth(this,
d);d.call(this)}}(),Ec=function(){var c,e=function(){if(c){var a=w.viewNode,a=a.offsetHeight-a.clientHeight;0===a?c.css("bottom",null):c.css("bottom",a+"px")}};ka.onresize(e);E.onzoom(e);var a=function(a){a=a||{};U.call(this,"div","oit-toast");a.className&&this.addClass(a.className);var b=[];a.collapseButton&&b.push('<input class="oit-collapsebutton" type="button" value="&#x25bc;">');a.closeButton&&b.push('<input class="oit-closebutton" type="button" value="x">');b.push('<div class="oit-title"></div><div class="oit-body"></div>');
this.html(b.join(""));a.collapseButton&&(this.prop("collapseButton",this.childByClass("oit-collapsebutton")),this.collapseButton.onclick(this,t),this.collapseButton.ontap(this,t));a.closeButton&&(this.prop("closeButton",this.childByClass("oit-closebutton")),this.closeButton.onclick(this,n),this.closeButton.ontap(this,n));this.prop("titletext",this.childByClass("oit-title"));this.prop("messagetext",this.childByClass("oit-body"));this._collapsed=!0;this.onclick(this,u);this.ontap(this,u);this.onmouseenter(this,
g);this.onmouseleave(this,k);y.attach(this);c||(c=y.create("div","oit-toastpane"),w.viewNode.parent().append(c),e());b=c.firstChildElem();a.collapseButton||!b?c.append(this):c.insert(this,b);a.title&&this.title(a.title);a.content&&this.message(a.content)},b=W(a,U);b.customEvent("expand");b.customEvent("collapse");var d=function(a){a._collapsed?a._colSize&&a.css({width:a._colSize.width+"px",height:a._colSize.height+"px"}):a._expSize&&a.css({width:a._expSize.width+"px",height:a._expSize.height+"px"})};
b.title=function(a){if(void 0!==a){this.titletext.html(a);a=this.attr("class");var b=this.css("display");this.attr("class","oit-toast");this.css("display",null);this.css({width:null,height:null});this._colSize={width:this.innerWidth,height:this.innerHeight};d(this);this.attr("class",a);this.css("display",b)}return this.titletext.html()};b.message=function(a){if(void 0!==a){this.messagetext.html(a);a=this.attr("class");var b=this.css("display");this.attr("class","oit-toast oit-expanded");this.css("display",
null);this.css({width:null,height:null});this._expSize={width:this.innerWidth,height:this.innerHeight};d(this);this.attr("class",a);this.css("display",b)}return this.messagetext.html()};b.isCollapsed=function(){return this._collapsed};b.hide=function(a){this._hidden||this._pendingHidden?a&&a():(this._pendingHidden=!0,this._hideCallback=a)};b.hideNow=function(){this._hidden=!0;this._pendingHidden=!1;this.animate({opacity:0,time:300,endCSS:{display:"none"},endFn:this._hideCallback})};b.show=function(){if(this._hidden||
this._pendingHidden)this._pendingHidden=this._hidden=!1,this.css("display",null),delete this._hideCallback};var g=function(){this._mouse=!0},k=function(){this._mouse=!1;this._pendingHidden&&this.hideNow()},m=function(){this.offtransitionend(m);this._tto&&(ta(this._tto),delete this._tto);this.removeClass("oit-collapsing");this.dispatchCustom("collapse",{});fb()};b.collapse=function(a){if(this._collapsed)return!1;this._tto&&ta(this._tto);this._collapsed=!0;!1===a?(this.removeClass("oit-expanded"),d(this),
this.dispatchCustom("collapse",{})):(this.addClass("oit-collapsing"),this.removeClass("oit-expanded"),this.ontransitionend(m),da(function(){d(this)},0,this),this._tto=da(function(){delete this._tto;m.call(this)},400,this));fb();return!0};var r=function(){this.offtransitionend(r);this._tto&&(ta(this._tto),delete this._tto);this.addClass("oit-expanded");this.removeClass("oit-expanding");this.dispatchCustom("expand",{});fb()};b.expand=function(a){if(!this._collapsed)return!1;this._tto&&ta(this._tto);
this._collapsed=!1;!1===a?(this.addClass("oit-expanded"),d(this),this.dispatchCustom("expand",{})):(this.addClass("oit-expanding"),this.ontransitionend(r),d(this),this._tto=da(function(){delete this._tto;r.call(this)},400,this));fb();return!0};var t=function(a){if(this.collapse())return!1},u=function(a){if(this.expand())return!1},n=function(a){this.hideNow()};E.onreset(function(){c&&(c.destroy(),c=null)});return a}();w.libversion="2018.6.1.6";(function(c){Xa.install.dispatch();Xa.install.reset();
R.addEventListener("load",function(){Xa.init.dispatch();Xa.init.reset()})})(!1)})(window,document);
//# sourceURL=oit.js 
