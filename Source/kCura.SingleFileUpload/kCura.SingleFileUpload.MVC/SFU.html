﻿<!DOCTYPE html>
<html style="width: 100%; height: 100%;">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Simple File Upload</title>
    <script src="Scripts/polyfill.js"></script>
    <script type="text/javascript">
        function go() {
            setTimeout(redirectToController);
        }
        function redirectToController() {

            var url_string = location.href.replace('.html', '');

            var parameters = {
                "fdv": getQueryString(url_string, "fdv"),
                "image": getQueryString(url_string, "image"),
                "newImage": getQueryString(url_string, "newImage"),
                "docID": getQueryString(url_string, "docID"),
                "profileID": getQueryString(url_string, "profileID"),
                "errorFile": getQueryString(url_string, "errorFile")
            }

            if (!parameters.fdv) {

                url_string = url_string.split('&')[0];
            }
            else {
                url_string = url_string.split('&')[0] + "&parameters=" + JSON.stringify(parameters);
            }

            location.href = url_string;

        }

        function dialogChanges() {
            var externalFrame = window.parent.$(window.parent.$(window.parent.parent.document).find('#_externalPage'));
            if (externalFrame.length > 0)
                window.parent.$(externalFrame[0].contentDocument).find('.dynamic-content-modal-close').hide();
            go();
        }

        try {
            dialogChanges();
        } catch (e) {
            go();
        }

        function getQueryString(url, parameter) {
            var key = false, res = {}, itm = null;
            var qs = url.substring(1);
            if (arguments.length > 0 && arguments[0].length > 1)
                key = arguments[0];
            var pattern = /([^&=]+)=([^&]*)/g;
            while (itm = pattern.exec(qs)) {
                if (key !== false && decodeURIComponent(itm[1]) === key)
                    return decodeURIComponent(itm[2]);
                else if (key === false)
                    res[decodeURIComponent(itm[1])] = decodeURIComponent(itm[2]);
            }

            return key === false ? res : null;
        }

    </script>
</head>
<body onload="dialogChanges()">
    <div style="width:240px;margin-left:auto;margin-right:auto;margin-top:40%;margin-top:25%;text-align:center">
        <img src="/relativity/custompages/1738ceb6-9546-44a7-8b9b-e64c88e47320/Content/Images/loading.gif?v=3" alt="loading" />
    </div>
</body>

</html>