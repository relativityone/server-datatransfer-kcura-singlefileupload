<?xml version="1.0" ?>

<project name="Assembly">
	<property name="CompanyName" value="kCura LLC" unless="${property::exists('CompanyName')}" /> 
	<property name="ProductDescription" value="Tools to help build source code for kCura repositories." unless="${property::exists('ProductDescription')}"/>
	<property name="Product" value="Template" unless="${property::exists('Product')}"/>
	
	<tstamp property="current.year" pattern="yyyy" />
	
	<target name="update_assembly_info" depends="update_version_files">
		<echo message="Successfully updated AssemblyInfo files in ${root}." />
	</target>

	
	<!-- Update AssemblyInfo files -->
	<target name="update_version_files" description="Update AssemblyInfo files">
		<echo message="Updating ${version.directory}\AssemblyInfo.vb" />
		<asminfo output="${version.directory}\AssemblyInfo.vb" language="VB">
		<imports>
			<import namespace="System" />
			<import namespace="System.Reflection" />
			<import namespace="System.Runtime.InteropServices" />
		  </imports>
		  <attributes>
			<attribute type="ComVisibleAttribute" value="false" />
			<attribute type="CLSCompliantAttribute" value="false" />
			<attribute type="AssemblyVersionAttribute" value="${version}" />
			<attribute type="AssemblyFileVersionAttribute" value="${version}" />
			<attribute type="AssemblyCopyrightAttribute" value="Copyright (c) ${current.year}, ${CompanyName}" />
			<attribute type="AssemblyTitleAttribute" value="${Product}" />
			<attribute type="AssemblyDescriptionAttribute" value="${ProductDescription}" />
			<attribute type="AssemblyCompanyAttribute" value="${CompanyName}" />
			<attribute type="AssemblyProductAttribute" value="${Product}" />
			</attributes>
		</asminfo>
				
		<echo message="Updating ${version.directory}\AssemblyInfo.cs" />
		<asminfo output="${version.directory}\AssemblyInfo.cs" language="CSharp">
			<imports>
				<import namespace="System" />
				<import namespace="System.Reflection" />
				<import namespace="System.Runtime.InteropServices" />
			</imports>
			<attributes>
				<attribute type="ComVisibleAttribute" value="false" />
				<attribute type="CLSCompliantAttribute" value="false" />
				<attribute type="AssemblyVersionAttribute" value="${version}" />
				<attribute type="AssemblyFileVersionAttribute" value="${version}" />
				<attribute type="AssemblyCopyrightAttribute" value="Copyright (c) ${current.year}, ${CompanyName}" />
				<attribute type="AssemblyTitleAttribute" value="${Product}" />
				<attribute type="AssemblyDescriptionAttribute" value="${ProductDescription}" />
				<attribute type="AssemblyCompanyAttribute" value="${CompanyName}" />
				<attribute type="AssemblyProductAttribute" value="${Product}" />
			</attributes>
		</asminfo>	
		
	</target>	
			
	<target name="revert_assembly_info" description="Revert AssemblyInfo files">

    <!-- Revert the AssemblyInfo files that belong to Relativity -->
    <exec program="hg" failonerror="false" append="false">
      <arg value='revert "${version.directory}\AssemblyInfo.vb"' />
      <arg value='--no-backup' />
    </exec> 

    <exec program="hg" failonerror="false" append="false">
      <arg value='revert "${version.directory}\AssemblyInfo.cs"' />
      <arg value='--no-backup' />
    </exec> 
    <echo message="AssemblyInfo revert completed successfully." />
	</target>

</project>
